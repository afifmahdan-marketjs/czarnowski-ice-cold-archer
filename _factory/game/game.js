!function(b,c){"object"==typeof module&&"object"==typeof module.exports?module.exports=b.document?c(b,!0):function(b){if(!b.document)throw Error("jQuery requires a window with a document");return c(b)}:c(b)}("undefined"!=typeof window?window:this,function(b,c){function e(b,c){c=c||G;var d=c.createElement("script");d.text=b;c.head.appendChild(d).parentNode.removeChild(d)}function d(b){var c=!!b&&"length"in b&&b.length,d=q.type(b);return"function"!==d&&!q.isWindow(b)&&("array"===d||0===c||"number"==
typeof c&&0<c&&c-1 in b)}function j(b,c){return b.nodeName&&b.nodeName.toLowerCase()===c.toLowerCase()}function f(b,c,d){return q.isFunction(c)?q.grep(b,function(b,Y){return!!c.call(b,Y,b)!==d}):c.nodeType?q.grep(b,function(b){return b===c!==d}):"string"!=typeof c?q.grep(b,function(b){return-1<Va.call(c,b)!==d}):Gc.test(c)?q.filter(c,b,d):(c=q.filter(c,b),q.grep(b,function(b){return-1<Va.call(c,b)!==d&&1===b.nodeType}))}function n(b,c){for(;(b=b[c])&&1!==b.nodeType;);return b}function l(b){return b}
function g(b){throw b;}function m(b,c,d,g){var e;try{b&&q.isFunction(e=b.promise)?e.call(b).done(c).fail(d):b&&q.isFunction(e=b.then)?e.call(b,c,d):c.apply(void 0,[b].slice(g))}catch(f){d.apply(void 0,[f])}}function p(){G.removeEventListener("DOMContentLoaded",p);b.removeEventListener("load",p);q.ready()}function r(){this.expando=q.expando+r.uid++}function s(b,c,d){var g;if(void 0===d&&1===b.nodeType)if(g="data-"+c.replace(Hc,"-$&").toLowerCase(),d=b.getAttribute(g),"string"==typeof d){try{d="true"===
d||"false"!==d&&("null"===d?null:d===+d+""?+d:Ic.test(d)?JSON.parse(d):d)}catch(e){}ra.set(b,c,d)}else d=void 0;return d}function t(b,c,d,g){var e,f=1,p=20,m=g?function(){return g.cur()}:function(){return q.css(b,c,"")},j=m(),l=d&&d[3]||(q.cssNumber[c]?"":"px"),r=(q.cssNumber[c]||"px"!==l&&+j)&&kb.exec(q.css(b,c));if(r&&r[3]!==l){l=l||r[3];d=d||[];r=+j||1;do f=f||".5",r/=f,q.style(b,c,r+l);while(f!==(f=m()/j)&&1!==f&&--p)}return d&&(r=+r||+j||0,e=d[1]?r+(d[1]+1)*d[2]:+d[2],g&&(g.unit=l,g.start=r,
g.end=e)),e}function u(b,c){for(var d,g,e=[],f=0,p=b.length;f<p;f++)if(g=b[f],g.style)if(d=g.style.display,c){if("none"===d&&(e[f]=P.get(g,"display")||null,e[f]||(g.style.display="")),""===g.style.display&&sb(g)){d=e;var m=f,j,l=void 0;j=g.ownerDocument;var r=g.nodeName;j=(g=Wb[r])?g:(l=j.body.appendChild(j.createElement(r)),g=q.css(l,"display"),l.parentNode.removeChild(l),"none"===g&&(g="block"),Wb[r]=g,g);d[m]=j}}else"none"!==d&&(e[f]="none",P.set(g,"display",d));for(f=0;f<p;f++)null!=e[f]&&(b[f].style.display=
e[f]);return b}function v(b,c){var d;return d="undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(c||"*"):"undefined"!=typeof b.querySelectorAll?b.querySelectorAll(c||"*"):[],void 0===c||c&&j(b,c)?q.merge([b],d):d}function z(b,c){for(var d=0,g=b.length;d<g;d++)P.set(b[d],"globalEval",!c||P.get(c[d],"globalEval"))}function x(b,c,d,g,e){for(var f,p,m,j,l=c.createDocumentFragment(),r=[],s=0,n=b.length;s<n;s++)if(f=b[s],f||0===f)if("object"===q.type(f))q.merge(r,f.nodeType?[f]:f);else if(Jc.test(f)){p=
p||l.appendChild(c.createElement("div"));m=(Xb.exec(f)||["",""])[1].toLowerCase();m=ta[m]||ta._default;p.innerHTML=m[1]+q.htmlPrefilter(f)+m[2];for(m=m[0];m--;)p=p.lastChild;q.merge(r,p.childNodes);p=l.firstChild;p.textContent=""}else r.push(c.createTextNode(f));l.textContent="";for(s=0;f=r[s++];)if(g&&-1<q.inArray(f,g))e&&e.push(f);else if(j=q.contains(f.ownerDocument,f),p=v(l.appendChild(f),"script"),j&&z(p),d)for(m=0;f=p[m++];)Yb.test(f.type||"")&&d.push(f);return l}function B(){return!0}function A(){return!1}
function D(){try{return G.activeElement}catch(b){}}function I(b,c,d,g,e,f){var p,m;if("object"==typeof c){"string"!=typeof d&&(g=g||d,d=void 0);for(m in c)I(b,m,d,g,c[m],f);return b}if(null==g&&null==e?(e=d,g=d=void 0):null==e&&("string"==typeof d?(e=g,g=void 0):(e=g,g=d,d=void 0)),!1===e)e=A;else if(!e)return b;return 1===f&&(p=e,e=function(b){return q().off(b),p.apply(this,arguments)},e.guid=p.guid||(p.guid=q.guid++)),b.each(function(){q.event.add(this,c,e,g,d)})}function y(b,c){return j(b,"table")&&
j(11!==c.nodeType?c:c.firstChild,"tr")?q(">tbody",b)[0]||b:b}function C(b){return b.type=(null!==b.getAttribute("type"))+"/"+b.type,b}function J(b){var c=Kc.exec(b.type);return c?b.type=c[1]:b.removeAttribute("type"),b}function M(b,c){var d,g,e,f,p,m;if(1===c.nodeType){if(P.hasData(b)&&(d=P.access(b),g=P.set(c,d),m=d.events))for(e in delete g.handle,g.events={},m){d=0;for(g=m[e].length;d<g;d++)q.event.add(c,e,m[e][d])}ra.hasData(b)&&(f=ra.access(b),p=q.extend({},f),ra.set(c,p))}}function O(b,c,d,
g){c=Ia.apply([],c);var f,p,m,j,l=0,r=b.length,s=r-1,n=c[0],E=q.isFunction(n);if(E||1<r&&"string"==typeof n&&!ba.checkClone&&Lc.test(n))return b.each(function(e){var f=b.eq(e);E&&(c[0]=n.call(this,e,f.html()));O(f,c,d,g)});if(r&&(f=x(c,b[0].ownerDocument,!1,b,g),p=f.firstChild,1===f.childNodes.length&&(f=p),p||g)){p=q.map(v(f,"script"),C);for(m=p.length;l<r;l++)j=f,l!==s&&(j=q.clone(j,!0,!0),m&&q.merge(p,v(j,"script"))),d.call(b[l],j,l);if(m){f=p[p.length-1].ownerDocument;q.map(p,J);for(l=0;l<m;l++)j=
p[l],Yb.test(j.type||"")&&!P.access(j,"globalEval")&&q.contains(f,j)&&(j.src?q._evalUrl&&q._evalUrl(j.src):e(j.textContent.replace(Nc,""),f))}}return b}function N(b,c,d){for(var g=c?q.filter(c,b):b,e=0;null!=(c=g[e]);e++)d||1!==c.nodeType||q.cleanData(v(c)),c.parentNode&&(d&&q.contains(c.ownerDocument,c)&&z(v(c,"script")),c.parentNode.removeChild(c));return b}function K(b,c,d){var g,e,f,p,m=b.style;return d=d||tb(b),d&&(p=d.getPropertyValue(c)||d[c],""!==p||q.contains(b.ownerDocument,b)||(p=q.style(b,
c)),!ba.pixelMarginRight()&&Jb.test(p)&&Zb.test(c)&&(g=m.width,e=m.minWidth,f=m.maxWidth,m.minWidth=m.maxWidth=m.width=p,p=d.width,m.width=g,m.minWidth=e,m.maxWidth=f)),void 0!==p?p+"":p}function V(b,c){return{get:function(){return b()?void delete this.get:(this.get=c).apply(this,arguments)}}}function da(b){var c=q.cssProps[b];if(!c){var c=q.cssProps,d;a:if(d=b,!(d in $b)){for(var g=d[0].toUpperCase()+d.slice(1),e=ac.length;e--;)if(d=ac[e]+g,d in $b)break a;d=void 0}c=c[b]=d||b}return c}function F(b,
c,d){return(b=kb.exec(c))?Math.max(0,b[2]-(d||0))+(b[3]||"px"):c}function H(b,c,d,g,e){var f=0;for(c=d===(g?"border":"content")?4:"width"===c?1:0;4>c;c+=2)"margin"===d&&(f+=q.css(b,d+Wa[c],!0,e)),g?("content"===d&&(f-=q.css(b,"padding"+Wa[c],!0,e)),"margin"!==d&&(f-=q.css(b,"border"+Wa[c]+"Width",!0,e))):(f+=q.css(b,"padding"+Wa[c],!0,e),"padding"!==d&&(f+=q.css(b,"border"+Wa[c]+"Width",!0,e)));return f}function ia(b,c,d){var g,e=tb(b),f=K(b,c,e),p="border-box"===q.css(b,"boxSizing",!1,e);return Jb.test(f)?
f:(g=p&&(ba.boxSizingReliable()||f===b.style[c]),"auto"===f&&(f=b["offset"+c[0].toUpperCase()+c.slice(1)]),f=parseFloat(f)||0,f+H(b,c,d||(p?"border":"content"),g,e)+"px")}function R(b,c,d,g,e){return new R.prototype.init(b,c,d,g,e)}function L(){ub&&(!1===G.hidden&&b.requestAnimationFrame?b.requestAnimationFrame(L):b.setTimeout(L,q.fx.interval),q.fx.tick())}function T(){return b.setTimeout(function(){bb=void 0}),bb=q.now()}function Q(b,c){var d,g=0,e={height:b};for(c=c?1:0;4>g;g+=2-c)d=Wa[g],e["margin"+
d]=e["padding"+d]=b;return c&&(e.opacity=e.width=b),e}function Z(b,c,d){for(var g,e=(aa.tweeners[c]||[]).concat(aa.tweeners["*"]),f=0,p=e.length;f<p;f++)if(g=e[f].call(d,c,b))return g}function aa(b,c,d){var g,e,f=0,p=aa.prefilters.length,m=q.Deferred().always(function(){delete j.elem}),j=function(){if(e)return!1;for(var c=bb||T(),c=Math.max(0,l.startTime+l.duration-c),d=1-(c/l.duration||0),g=0,f=l.tweens.length;g<f;g++)l.tweens[g].run(d);return m.notifyWith(b,[l,d,c]),1>d&&f?c:(f||m.notifyWith(b,
[l,1,0]),m.resolveWith(b,[l]),!1)},l=m.promise({elem:b,props:q.extend({},c),opts:q.extend(!0,{specialEasing:{},easing:q.easing._default},d),originalProperties:c,originalOptions:d,startTime:bb||T(),duration:d.duration,tweens:[],createTween:function(c,d){var g=q.Tween(b,l.opts,c,d,l.opts.specialEasing[c]||l.opts.easing);return l.tweens.push(g),g},stop:function(c){var d=0,g=c?l.tweens.length:0;if(e)return this;for(e=!0;d<g;d++)l.tweens[d].run(1);return c?(m.notifyWith(b,[l,1,0]),m.resolveWith(b,[l,c])):
m.rejectWith(b,[l,c]),this}});c=l.props;d=l.opts.specialEasing;var r,s,n,E;for(g in c)if(r=q.camelCase(g),s=d[r],n=c[g],Array.isArray(n)&&(s=n[1],n=c[g]=n[0]),g!==r&&(c[r]=n,delete c[g]),E=q.cssHooks[r],E&&"expand"in E)for(g in n=E.expand(n),delete c[r],n)g in c||(c[g]=n[g],d[g]=s);else d[r]=s;for(;f<p;f++)if(g=aa.prefilters[f].call(l,b,c,l.opts))return q.isFunction(g.stop)&&(q._queueHooks(l.elem,l.opts.queue).stop=q.proxy(g.stop,g)),g;return q.map(c,Z,l),q.isFunction(l.opts.start)&&l.opts.start.call(b,
l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),q.fx.timer(q.extend(j,{elem:b,anim:l,queue:l.opts.queue})),l}function la(b){return(b.match(ua)||[]).join(" ")}function qa(b){return b.getAttribute&&b.getAttribute("class")||""}function ea(b,c,d,g){var e;if(Array.isArray(c))q.each(c,function(c,e){d||Oc.test(b)?g(b,e):ea(b+"["+("object"==typeof e&&null!=e?c:"")+"]",e,d,g)});else if(d||"object"!==q.type(c))g(b,c);else for(e in c)ea(b+"["+e+"]",c[e],
d,g)}function oa(b){return function(c,d){"string"!=typeof c&&(d=c,c="*");var g,e=0,f=c.toLowerCase().match(ua)||[];if(q.isFunction(d))for(;g=f[e++];)"+"===g[0]?(g=g.slice(1)||"*",(b[g]=b[g]||[]).unshift(d)):(b[g]=b[g]||[]).push(d)}}function E(b,c,d,g){function e(m){var j;return f[m]=!0,q.each(b[m]||[],function(b,Y){var m=Y(c,d,g);return"string"!=typeof m||p||f[m]?p?!(j=m):void 0:(c.dataTypes.unshift(m),e(m),!1)}),j}var f={},p=b===Kb;return e(c.dataTypes[0])||!f["*"]&&e("*")}function U(b,c){var d,
g,e=q.ajaxSettings.flatOptions||{};for(d in c)void 0!==c[d]&&((e[d]?b:g||(g={}))[d]=c[d]);return g&&q.extend(!0,b,g),b}var ga=[],G=b.document,Xa=Object.getPrototypeOf,pa=ga.slice,Ia=ga.concat,Oa=ga.push,Va=ga.indexOf,cb={},vb=cb.toString,db=cb.hasOwnProperty,wb=db.toString,Lb=wb.call(Object),ba={},q=function(b,c){return new q.fn.init(b,c)},Mb=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Nb=/^-ms-/,Da=/-([a-z])/g,Ja=function(b,c){return c.toUpperCase()};q.fn=q.prototype={jquery:"3.2.1",constructor:q,length:0,
toArray:function(){return pa.call(this)},get:function(b){return null==b?pa.call(this):0>b?this[b+this.length]:this[b]},pushStack:function(b){b=q.merge(this.constructor(),b);return b.prevObject=this,b},each:function(b){return q.each(this,b)},map:function(b){return this.pushStack(q.map(this,function(c,d){return b.call(c,d,c)}))},slice:function(){return this.pushStack(pa.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(b){var c=this.length;b=
+b+(0>b?c:0);return this.pushStack(0<=b&&b<c?[this[b]]:[])},end:function(){return this.prevObject||this.constructor()},push:Oa,sort:ga.sort,splice:ga.splice};q.extend=q.fn.extend=function(){var b,c,d,g,e,f,p=arguments[0]||{},m=1,j=arguments.length,l=!1;"boolean"==typeof p&&(l=p,p=arguments[m]||{},m++);"object"==typeof p||q.isFunction(p)||(p={});for(m===j&&(p=this,m--);m<j;m++)if(null!=(b=arguments[m]))for(c in b)d=p[c],g=b[c],p!==g&&(l&&g&&(q.isPlainObject(g)||(e=Array.isArray(g)))?(e?(e=!1,f=d&&
Array.isArray(d)?d:[]):f=d&&q.isPlainObject(d)?d:{},p[c]=q.extend(l,f,g)):void 0!==g&&(p[c]=g));return p};q.extend({expando:"jQuery"+("3.2.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(b){throw Error(b);},noop:function(){},isFunction:function(b){return"function"===q.type(b)},isWindow:function(b){return null!=b&&b===b.window},isNumeric:function(b){var c=q.type(b);return("number"===c||"string"===c)&&!isNaN(b-parseFloat(b))},isPlainObject:function(b){var c,d;return!(!b||"[object Object]"!==
vb.call(b))&&(!(c=Xa(b))||(d=db.call(c,"constructor")&&c.constructor,"function"==typeof d&&wb.call(d)===Lb))},isEmptyObject:function(b){for(var c in b)return!1;return!0},type:function(b){return null==b?b+"":"object"==typeof b||"function"==typeof b?cb[vb.call(b)]||"object":typeof b},globalEval:function(b){e(b)},camelCase:function(b){return b.replace(Nb,"ms-").replace(Da,Ja)},each:function(b,c){var g,e=0;if(d(b))for(g=b.length;e<g&&!1!==c.call(b[e],e,b[e]);e++);else for(e in b)if(!1===c.call(b[e],e,
b[e]))break;return b},trim:function(b){return null==b?"":(b+"").replace(Mb,"")},makeArray:function(b,c){var g=c||[];return null!=b&&(d(Object(b))?q.merge(g,"string"==typeof b?[b]:b):Oa.call(g,b)),g},inArray:function(b,c,d){return null==c?-1:Va.call(c,b,d)},merge:function(b,c){for(var d=+c.length,g=0,e=b.length;g<d;g++)b[e++]=c[g];return b.length=e,b},grep:function(b,c,d){for(var g=[],e=0,f=b.length,p=!d;e<f;e++)d=!c(b[e],e),d!==p&&g.push(b[e]);return g},map:function(b,c,g){var e,f,p=0,m=[];if(d(b))for(e=
b.length;p<e;p++)f=c(b[p],p,g),null!=f&&m.push(f);else for(p in b)f=c(b[p],p,g),null!=f&&m.push(f);return Ia.apply([],m)},guid:1,proxy:function(b,c){var d,g,e;if("string"==typeof c&&(d=b[c],c=b,b=d),q.isFunction(b))return g=pa.call(arguments,2),e=function(){return b.apply(c||this,g.concat(pa.call(arguments)))},e.guid=b.guid=b.guid||q.guid++,e},now:Date.now,support:ba});"function"==typeof Symbol&&(q.fn[Symbol.iterator]=ga[Symbol.iterator]);q.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),
function(b,c){cb["[object "+c+"]"]=c.toLowerCase()});var va,lb=b,X=function(b,c,d,g){var e,f,p,m,j,l=c&&c.ownerDocument,r=c?c.nodeType:9;if(d=d||[],"string"!=typeof b||!b||1!==r&&9!==r&&11!==r)return d;if(!g&&((c?c.ownerDocument||c:wa)!==W&&Pa(c),c=c||W,xa)){if(11!==r&&(m=Pc.exec(b)))if(e=m[1])if(9===r){if(!(f=c.getElementById(e)))return d;if(f.id===e)return d.push(f),d}else{if(l&&(f=l.getElementById(e))&&mb(c,f)&&f.id===e)return d.push(f),d}else{if(m[2])return Qa.apply(d,c.getElementsByTagName(b)),
d;if((e=m[3])&&fa.getElementsByClassName&&c.getElementsByClassName)return Qa.apply(d,c.getElementsByClassName(e)),d}if(fa.qsa&&!xb[b+" "]&&(!ma||!ma.test(b))){if(1!==r)l=c,j=b;else if("object"!==c.nodeName.toLowerCase()){(p=c.getAttribute("id"))?p=p.replace(bc,cc):c.setAttribute("id",p=ca);f=nb(b);for(e=f.length;e--;)f[e]="#"+p+" "+za(f[e]);j=f.join(",");l=Ob.test(b)&&Ea(c.parentNode)||c}if(j)try{return Qa.apply(d,l.querySelectorAll(j)),d}catch(s){}finally{p===ca&&c.removeAttribute("id")}}}return dc(b.replace(yb,
"$1"),c,d,g)},Ra=function(){function b(d,g){return c.push(d+" ")>S.cacheLength&&delete b[c.shift()],b[d+" "]=g}var c=[];return b},ja=function(b){return b[ca]=!0,b},sa=function(b){var c=W.createElement("fieldset");try{return!!b(c)}catch(d){return!1}finally{c.parentNode&&c.parentNode.removeChild(c)}},Sa=function(b,c){for(var d=b.split("|"),g=d.length;g--;)S.attrHandle[d[g]]=c},Ka=function(b,c){var d=c&&b,g=d&&1===b.nodeType&&1===c.nodeType&&b.sourceIndex-c.sourceIndex;if(g)return g;if(d)for(;d=d.nextSibling;)if(d===
c)return-1;return b?1:-1},zb=function(b){return function(c){return"input"===c.nodeName.toLowerCase()&&c.type===b}},Ta=function(b){return function(c){var d=c.nodeName.toLowerCase();return("input"===d||"button"===d)&&c.type===b}},eb=function(b){return function(c){return"form"in c?c.parentNode&&!1===c.disabled?"label"in c?"label"in c.parentNode?c.parentNode.disabled===b:c.disabled===b:c.isDisabled===b||c.isDisabled!==!b&&Qc(c)===b:c.disabled===b:"label"in c&&c.disabled===b}},Fa=function(b){return ja(function(c){return c=
+c,ja(function(d,g){for(var e,f=b([],d.length,c),p=f.length;p--;)d[e=f[p]]&&(d[e]=!(g[e]=d[e]))})})},Ea=function(b){return b&&"undefined"!=typeof b.getElementsByTagName&&b},Ga=function(){},za=function(b){for(var c=0,d=b.length,g="";c<d;c++)g+=b[c].value;return g},Ya=function(b,c,d){var g=c.dir,e=c.next,f=e||g,p=d&&"parentNode"===f,m=Rc++;return c.first?function(c,d,e){for(;c=c[g];)if(1===c.nodeType||p)return b(c,d,e);return!1}:function(c,d,j){var l,r,ha,s=[Ha,m];if(j)for(;c=c[g];){if((1===c.nodeType||
p)&&b(c,d,j))return!0}else for(;c=c[g];)if(1===c.nodeType||p)if(ha=c[ca]||(c[ca]={}),r=ha[c.uniqueID]||(ha[c.uniqueID]={}),e&&e===c.nodeName.toLowerCase())c=c[g]||c;else{if((l=r[f])&&l[0]===Ha&&l[1]===m)return s[2]=l[2];if(r[f]=s,s[2]=b(c,d,j))return!0}return!1}},Aa=function(b){return 1<b.length?function(c,d,g){for(var e=b.length;e--;)if(!b[e](c,d,g))return!1;return!0}:b[0]},Ba=function(b,c,d,g,e){for(var f,p=[],m=0,j=b.length,l=null!=c;m<j;m++)(f=b[m])&&(d&&!d(f,g,e)||(p.push(f),l&&c.push(m)));return p},
na=function(b,c,d,g,e,f){return g&&!g[ca]&&(g=na(g)),e&&!e[ca]&&(e=na(e,f)),ja(function(f,p,m,j){var l,r,s=[],n=[],q=p.length,E;if(!(E=f)){E=c||"*";for(var t=m.nodeType?[m]:m,u=[],v=0,U=t.length;v<U;v++)X(E,t[v],u);E=u}E=!b||!f&&c?E:Ba(E,s,b,m,j);t=d?e||(f?b:q||g)?[]:p:E;if(d&&d(E,t,m,j),g){l=Ba(t,n);g(l,[],m,j);for(m=l.length;m--;)(r=l[m])&&(t[n[m]]=!(E[n[m]]=r))}if(f){if(e||b){if(e){l=[];for(m=t.length;m--;)(r=t[m])&&l.push(E[m]=r);e(null,t=[],l,j)}for(m=t.length;m--;)(r=t[m])&&-1<(l=e?Za(f,r):
s[m])&&(f[l]=!(p[l]=r))}}else t=Ba(t===p?t.splice(q,t.length):t),e?e(null,p,t,j):Qa.apply(p,t)})},Pb=function(b){var c,d,g,e=b.length,f=S.relative[b[0].type];d=f||S.relative[" "];for(var p=f?1:0,m=Ya(function(b){return b===c},d,!0),j=Ya(function(b){return-1<Za(c,b)},d,!0),l=[function(b,d,g){b=!f&&(g||d!==fb)||((c=d).nodeType?m(b,d,g):j(b,d,g));return c=null,b}];p<e;p++)if(d=S.relative[b[p].type])l=[Ya(Aa(l),d)];else{if(d=S.filter[b[p].type].apply(null,b[p].matches),d[ca]){for(g=++p;g<e&&!S.relative[b[g].type];g++);
return na(1<p&&Aa(l),1<p&&za(b.slice(0,p-1).concat({value:" "===b[p-2].type?"*":""})).replace(yb,"$1"),d,p<g&&Pb(b.slice(p,g)),g<e&&Pb(b=b.slice(g)),g<e&&za(b))}l.push(d)}return Aa(l)},gb,fa,S,Ab,ec,nb,Qb,dc,fb,Ua,hb,Pa,W,ya,xa,ma,$a,Bb,mb,ca="sizzle"+1*new Date,wa=lb.document,Ha=0,Rc=0,fc=Ra(),gc=Ra(),xb=Ra(),Rb=function(b,c){return b===c&&(hb=!0),0},Sc={}.hasOwnProperty,ab=[],Tc=ab.pop,Uc=ab.push,Qa=ab.push,hc=ab.slice,Za=function(b,c){for(var d=0,g=b.length;d<g;d++)if(b[d]===c)return d;return-1},
Vc=/[\x20\t\r\n\f]+/g,yb=/^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g,Wc=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,Xc=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,Yc=/=[\x20\t\r\n\f]*([^\]'"]*?)[\x20\t\r\n\f]*\]/g,Zc=RegExp(":((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),
$c=/^(?:\\.|[\w-]|[^\x00-\xa0])+$/,Cb={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:/^((?:\\.|[\w-]|[^\x00-\xa0])+|[*])/,ATTR:RegExp("^\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\]"),PSEUDO:RegExp("^:((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),
CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)",
"i")},ad=/^(?:input|select|textarea|button)$/i,bd=/^h\d$/i,ob=/^[^{]+\{\s*\[native \w/,Pc=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Ob=/[+~]/,La=/\\([\da-f]{1,6}[\x20\t\r\n\f]?|([\x20\t\r\n\f])|.)/ig,Ma=function(b,c,d){b="0x"+c-65536;return b!==b||d?c:0>b?String.fromCharCode(b+65536):String.fromCharCode(b>>10|55296,1023&b|56320)},bc=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,cc=function(b,c){return c?"\x00"===b?"\ufffd":b.slice(0,-1)+"\\"+b.charCodeAt(b.length-1).toString(16)+" ":"\\"+b},ic=function(){Pa()},
Qc=Ya(function(b){return!0===b.disabled&&("form"in b||"label"in b)},{dir:"parentNode",next:"legend"});try{Qa.apply(ab=hc.call(wa.childNodes),wa.childNodes),ab[wa.childNodes.length].nodeType}catch(Ed){Qa={apply:ab.length?function(b,c){Uc.apply(b,hc.call(c))}:function(b,c){for(var d=b.length,g=0;b[d++]=c[g++];);b.length=d-1}}}fa=X.support={};ec=X.isXML=function(b){b=b&&(b.ownerDocument||b).documentElement;return!!b&&"HTML"!==b.nodeName};Pa=X.setDocument=function(b){var c,d;b=b?b.ownerDocument||b:wa;
return b!==W&&9===b.nodeType&&b.documentElement?(W=b,ya=W.documentElement,xa=!ec(W),wa!==W&&(d=W.defaultView)&&d.top!==d&&(d.addEventListener?d.addEventListener("unload",ic,!1):d.attachEvent&&d.attachEvent("onunload",ic)),fa.attributes=sa(function(b){return b.className="i",!b.getAttribute("className")}),fa.getElementsByTagName=sa(function(b){return b.appendChild(W.createComment("")),!b.getElementsByTagName("*").length}),fa.getElementsByClassName=ob.test(W.getElementsByClassName),fa.getById=sa(function(b){return ya.appendChild(b).id=
ca,!W.getElementsByName||!W.getElementsByName(ca).length}),fa.getById?(S.filter.ID=function(b){var c=b.replace(La,Ma);return function(b){return b.getAttribute("id")===c}},S.find.ID=function(b,c){if("undefined"!=typeof c.getElementById&&xa){var d=c.getElementById(b);return d?[d]:[]}}):(S.filter.ID=function(b){var c=b.replace(La,Ma);return function(b){return(b="undefined"!=typeof b.getAttributeNode&&b.getAttributeNode("id"))&&b.value===c}},S.find.ID=function(b,c){if("undefined"!=typeof c.getElementById&&
xa){var d,g,e,f=c.getElementById(b);if(f){if(d=f.getAttributeNode("id"),d&&d.value===b)return[f];e=c.getElementsByName(b);for(g=0;f=e[g++];)if(d=f.getAttributeNode("id"),d&&d.value===b)return[f]}return[]}}),S.find.TAG=fa.getElementsByTagName?function(b,c){return"undefined"!=typeof c.getElementsByTagName?c.getElementsByTagName(b):fa.qsa?c.querySelectorAll(b):void 0}:function(b,c){var d,g=[],e=0,f=c.getElementsByTagName(b);if("*"===b){for(;d=f[e++];)1===d.nodeType&&g.push(d);return g}return f},S.find.CLASS=
fa.getElementsByClassName&&function(b,c){if("undefined"!=typeof c.getElementsByClassName&&xa)return c.getElementsByClassName(b)},$a=[],ma=[],(fa.qsa=ob.test(W.querySelectorAll))&&(sa(function(b){ya.appendChild(b).innerHTML="<a id='"+ca+"'></a><select id='"+ca+"-\r\\' msallowcapture=''><option selected=''></option></select>";b.querySelectorAll("[msallowcapture^='']").length&&ma.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");b.querySelectorAll("[selected]").length||ma.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");
b.querySelectorAll("[id~="+ca+"-]").length||ma.push("~=");b.querySelectorAll(":checked").length||ma.push(":checked");b.querySelectorAll("a#"+ca+"+*").length||ma.push(".#.+[+~]")}),sa(function(b){b.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var c=W.createElement("input");c.setAttribute("type","hidden");b.appendChild(c).setAttribute("name","D");b.querySelectorAll("[name=d]").length&&ma.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?=");2!==b.querySelectorAll(":enabled").length&&
ma.push(":enabled",":disabled");ya.appendChild(b).disabled=!0;2!==b.querySelectorAll(":disabled").length&&ma.push(":enabled",":disabled");b.querySelectorAll("*,:x");ma.push(",.*:")})),(fa.matchesSelector=ob.test(Bb=ya.matches||ya.webkitMatchesSelector||ya.mozMatchesSelector||ya.oMatchesSelector||ya.msMatchesSelector))&&sa(function(b){fa.disconnectedMatch=Bb.call(b,"*");Bb.call(b,"[s!='']:x");$a.push("!=",":((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)")}),
ma=ma.length&&RegExp(ma.join("|")),$a=$a.length&&RegExp($a.join("|")),c=ob.test(ya.compareDocumentPosition),mb=c||ob.test(ya.contains)?function(b,c){var d=9===b.nodeType?b.documentElement:b,g=c&&c.parentNode;return b===g||!(!g||1!==g.nodeType||!(d.contains?d.contains(g):b.compareDocumentPosition&&16&b.compareDocumentPosition(g)))}:function(b,c){if(c)for(;c=c.parentNode;)if(c===b)return!0;return!1},Rb=c?function(b,c){if(b===c)return hb=!0,0;var d=!b.compareDocumentPosition-!c.compareDocumentPosition;
return d?d:(d=(b.ownerDocument||b)===(c.ownerDocument||c)?b.compareDocumentPosition(c):1,1&d||!fa.sortDetached&&c.compareDocumentPosition(b)===d?b===W||b.ownerDocument===wa&&mb(wa,b)?-1:c===W||c.ownerDocument===wa&&mb(wa,c)?1:Ua?Za(Ua,b)-Za(Ua,c):0:4&d?-1:1)}:function(b,c){if(b===c)return hb=!0,0;var d,g=0;d=b.parentNode;var e=c.parentNode,f=[b],p=[c];if(!d||!e)return b===W?-1:c===W?1:d?-1:e?1:Ua?Za(Ua,b)-Za(Ua,c):0;if(d===e)return Ka(b,c);for(d=b;d=d.parentNode;)f.unshift(d);for(d=c;d=d.parentNode;)p.unshift(d);
for(;f[g]===p[g];)g++;return g?Ka(f[g],p[g]):f[g]===wa?-1:p[g]===wa?1:0},W):W};X.matches=function(b,c){return X(b,null,null,c)};X.matchesSelector=function(b,c){if((b.ownerDocument||b)!==W&&Pa(b),c=c.replace(Yc,"='$1']"),fa.matchesSelector&&xa&&!xb[c+" "]&&(!$a||!$a.test(c))&&(!ma||!ma.test(c)))try{var d=Bb.call(b,c);if(d||fa.disconnectedMatch||b.document&&11!==b.document.nodeType)return d}catch(g){}return 0<X(c,W,null,[b]).length};X.contains=function(b,c){return(b.ownerDocument||b)!==W&&Pa(b),mb(b,
c)};X.attr=function(b,c){(b.ownerDocument||b)!==W&&Pa(b);var d=S.attrHandle[c.toLowerCase()],d=d&&Sc.call(S.attrHandle,c.toLowerCase())?d(b,c,!xa):void 0;return void 0!==d?d:fa.attributes||!xa?b.getAttribute(c):(d=b.getAttributeNode(c))&&d.specified?d.value:null};X.escape=function(b){return(b+"").replace(bc,cc)};X.error=function(b){throw Error("Syntax error, unrecognized expression: "+b);};X.uniqueSort=function(b){var c,d=[],g=0,e=0;if(hb=!fa.detectDuplicates,Ua=!fa.sortStable&&b.slice(0),b.sort(Rb),
hb){for(;c=b[e++];)c===b[e]&&(g=d.push(e));for(;g--;)b.splice(d[g],1)}return Ua=null,b};Ab=X.getText=function(b){var c,d="",g=0;if(c=b.nodeType)if(1===c||9===c||11===c){if("string"==typeof b.textContent)return b.textContent;for(b=b.firstChild;b;b=b.nextSibling)d+=Ab(b)}else{if(3===c||4===c)return b.nodeValue}else for(;c=b[g++];)d+=Ab(c);return d};S=X.selectors={cacheLength:50,createPseudo:ja,match:Cb,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",
first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(b){return b[1]=b[1].replace(La,Ma),b[3]=(b[3]||b[4]||b[5]||"").replace(La,Ma),"~="===b[2]&&(b[3]=" "+b[3]+" "),b.slice(0,4)},CHILD:function(b){return b[1]=b[1].toLowerCase(),"nth"===b[1].slice(0,3)?(b[3]||X.error(b[0]),b[4]=+(b[4]?b[5]+(b[6]||1):2*("even"===b[3]||"odd"===b[3])),b[5]=+(b[7]+b[8]||"odd"===b[3])):b[3]&&X.error(b[0]),b},PSEUDO:function(b){var c,d=!b[6]&&b[2];return Cb.CHILD.test(b[0])?null:(b[3]?b[2]=b[4]||b[5]||"":d&&Zc.test(d)&&
(c=nb(d,!0))&&(c=d.indexOf(")",d.length-c)-d.length)&&(b[0]=b[0].slice(0,c),b[2]=d.slice(0,c)),b.slice(0,3))}},filter:{TAG:function(b){var c=b.replace(La,Ma).toLowerCase();return"*"===b?function(){return!0}:function(b){return b.nodeName&&b.nodeName.toLowerCase()===c}},CLASS:function(b){var c=fc[b+" "];return c||(c=RegExp("(^|[\\x20\\t\\r\\n\\f])"+b+"([\\x20\\t\\r\\n\\f]|$)"))&&fc(b,function(b){return c.test("string"==typeof b.className&&b.className||"undefined"!=typeof b.getAttribute&&b.getAttribute("class")||
"")})},ATTR:function(b,c,d){return function(g){g=X.attr(g,b);return null==g?"!="===c:!c||(g+="","="===c?g===d:"!="===c?g!==d:"^="===c?d&&0===g.indexOf(d):"*="===c?d&&-1<g.indexOf(d):"$="===c?d&&g.slice(-d.length)===d:"~="===c?-1<(" "+g.replace(Vc," ")+" ").indexOf(d):"|="===c&&(g===d||g.slice(0,d.length+1)===d+"-"))}},CHILD:function(b,c,d,g,e){var f="nth"!==b.slice(0,3),p="last"!==b.slice(-4),m="of-type"===c;return 1===g&&0===e?function(b){return!!b.parentNode}:function(c,d,j){var l,r,s,n,ha,q;d=
f!==p?"nextSibling":"previousSibling";var E=c.parentNode,t=m&&c.nodeName.toLowerCase();j=!j&&!m;var ka=!1;if(E){if(f){for(;d;){for(n=c;n=n[d];)if(m?n.nodeName.toLowerCase()===t:1===n.nodeType)return!1;q=d="only"===b&&!q&&"nextSibling"}return!0}if(q=[p?E.firstChild:E.lastChild],p&&j){n=E;s=n[ca]||(n[ca]={});r=s[n.uniqueID]||(s[n.uniqueID]={});l=r[b]||[];ka=(ha=l[0]===Ha&&l[1])&&l[2];for(n=ha&&E.childNodes[ha];n=++ha&&n&&n[d]||(ka=ha=0)||q.pop();)if(1===n.nodeType&&++ka&&n===c){r[b]=[Ha,ha,ka];break}}else if(j&&
(n=c,s=n[ca]||(n[ca]={}),r=s[n.uniqueID]||(s[n.uniqueID]={}),l=r[b]||[],ha=l[0]===Ha&&l[1],ka=ha),!1===ka)for(;(n=++ha&&n&&n[d]||(ka=ha=0)||q.pop())&&(!(m?n.nodeName.toLowerCase()===t:1===n.nodeType)||!++ka||!(j&&(s=n[ca]||(n[ca]={}),r=s[n.uniqueID]||(s[n.uniqueID]={}),r[b]=[Ha,ka]),n===c)););return ka-=e,ka===g||0===ka%g&&0<=ka/g}}},PSEUDO:function(b,c){var d,g=S.pseudos[b]||S.setFilters[b.toLowerCase()]||X.error("unsupported pseudo: "+b);return g[ca]?g(c):1<g.length?(d=[b,b,"",c],S.setFilters.hasOwnProperty(b.toLowerCase())?
ja(function(b,d){for(var e,f=g(b,c),p=f.length;p--;)e=Za(b,f[p]),b[e]=!(d[e]=f[p])}):function(b){return g(b,0,d)}):g}},pseudos:{not:ja(function(b){var c=[],d=[],g=Qb(b.replace(yb,"$1"));return g[ca]?ja(function(b,c,d,e){var f;d=g(b,null,e,[]);for(e=b.length;e--;)(f=d[e])&&(b[e]=!(c[e]=f))}):function(b,e,f){return c[0]=b,g(c,null,f,d),c[0]=null,!d.pop()}}),has:ja(function(b){return function(c){return 0<X(b,c).length}}),contains:ja(function(b){return b=b.replace(La,Ma),function(c){return-1<(c.textContent||
c.innerText||Ab(c)).indexOf(b)}}),lang:ja(function(b){return $c.test(b||"")||X.error("unsupported lang: "+b),b=b.replace(La,Ma).toLowerCase(),function(c){var d;do if(d=xa?c.lang:c.getAttribute("xml:lang")||c.getAttribute("lang"))return d=d.toLowerCase(),d===b||0===d.indexOf(b+"-");while((c=c.parentNode)&&1===c.nodeType);return!1}}),target:function(b){var c=lb.location&&lb.location.hash;return c&&c.slice(1)===b.id},root:function(b){return b===ya},focus:function(b){return b===W.activeElement&&(!W.hasFocus||
W.hasFocus())&&!(!b.type&&!b.href&&!~b.tabIndex)},enabled:eb(!1),disabled:eb(!0),checked:function(b){var c=b.nodeName.toLowerCase();return"input"===c&&!!b.checked||"option"===c&&!!b.selected},selected:function(b){return b.parentNode&&b.parentNode.selectedIndex,!0===b.selected},empty:function(b){for(b=b.firstChild;b;b=b.nextSibling)if(6>b.nodeType)return!1;return!0},parent:function(b){return!S.pseudos.empty(b)},header:function(b){return bd.test(b.nodeName)},input:function(b){return ad.test(b.nodeName)},
button:function(b){var c=b.nodeName.toLowerCase();return"input"===c&&"button"===b.type||"button"===c},text:function(b){var c;return"input"===b.nodeName.toLowerCase()&&"text"===b.type&&(null==(c=b.getAttribute("type"))||"text"===c.toLowerCase())},first:Fa(function(){return[0]}),last:Fa(function(b,c){return[c-1]}),eq:Fa(function(b,c,d){return[0>d?d+c:d]}),even:Fa(function(b,c){for(var d=0;d<c;d+=2)b.push(d);return b}),odd:Fa(function(b,c){for(var d=1;d<c;d+=2)b.push(d);return b}),lt:Fa(function(b,c,
d){for(c=0>d?d+c:d;0<=--c;)b.push(c);return b}),gt:Fa(function(b,c,d){for(d=0>d?d+c:d;++d<c;)b.push(d);return b})}};S.pseudos.nth=S.pseudos.eq;for(gb in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})S.pseudos[gb]=zb(gb);for(gb in{submit:!0,reset:!0})S.pseudos[gb]=Ta(gb);Ga.prototype=S.filters=S.pseudos;S.setFilters=new Ga;nb=X.tokenize=function(b,c){var d,g,e,f,p,m,j;if(p=gc[b+" "])return c?0:p.slice(0);p=b;m=[];for(j=S.preFilter;p;){d&&!(g=Wc.exec(p))||(g&&(p=p.slice(g[0].length)||p),m.push(e=
[]));d=!1;(g=Xc.exec(p))&&(d=g.shift(),e.push({value:d,type:g[0].replace(yb," ")}),p=p.slice(d.length));for(f in S.filter)!(g=Cb[f].exec(p))||j[f]&&!(g=j[f](g))||(d=g.shift(),e.push({value:d,type:f,matches:g}),p=p.slice(d.length));if(!d)break}return c?p.length:p?X.error(b):gc(b,m).slice(0)};va=(Qb=X.compile=function(b,c){var d,g=[],e=[],f=xb[b+" "];if(!f){c||(c=nb(b));for(d=c.length;d--;)f=Pb(c[d]),f[ca]?g.push(f):e.push(f);d=xb;var p=0<g.length,m=0<e.length,f=function(b,c,d,f,j){var Y,l,r,s=0,n=
"0",ha=b&&[],q=[],E=fb,t=b||m&&S.find.TAG("*",j),ka=Ha+=null==E?1:Math.random()||0.1,u=t.length;for(j&&(fb=c===W||c||j);n!==u&&null!=(Y=t[n]);n++){if(m&&Y){l=0;for(c||Y.ownerDocument===W||(Pa(Y),d=!xa);r=e[l++];)if(r(Y,c||W,d)){f.push(Y);break}j&&(Ha=ka)}p&&((Y=!r&&Y)&&s--,b&&ha.push(Y))}if(s+=n,p&&n!==s){for(l=0;r=g[l++];)r(ha,q,c,d);if(b){if(0<s)for(;n--;)ha[n]||q[n]||(q[n]=Tc.call(f));q=Ba(q)}Qa.apply(f,q);j&&!b&&0<q.length&&1<s+g.length&&X.uniqueSort(f)}return j&&(Ha=ka,fb=E),ha},f=p?ja(f):f,
f=d(b,f);f.selector=b}return f},dc=X.select=function(b,c,d,g){var e,f,p,m,j,l="function"==typeof b&&b,r=!g&&nb(b=l.selector||b);if(d=d||[],1===r.length){if(f=r[0]=r[0].slice(0),2<f.length&&"ID"===(p=f[0]).type&&9===c.nodeType&&xa&&S.relative[f[1].type]){if(c=(S.find.ID(p.matches[0].replace(La,Ma),c)||[])[0],!c)return d;l&&(c=c.parentNode);b=b.slice(f.shift().value.length)}for(e=Cb.needsContext.test(b)?0:f.length;e--&&!(p=f[e],S.relative[m=p.type]);)if((j=S.find[m])&&(g=j(p.matches[0].replace(La,Ma),
Ob.test(f[0].type)&&Ea(c.parentNode)||c))){if(f.splice(e,1),b=g.length&&za(f),!b)return Qa.apply(d,g),d;break}}return(l||Qb(b,r))(g,c,!xa,d,!c||Ob.test(b)&&Ea(c.parentNode)||c),d},fa.sortStable=ca.split("").sort(Rb).join("")===ca,fa.detectDuplicates=!!hb,Pa(),fa.sortDetached=sa(function(b){return 1&b.compareDocumentPosition(W.createElement("fieldset"))}),sa(function(b){return b.innerHTML="<a href='#'></a>","#"===b.firstChild.getAttribute("href")})||Sa("type|href|height|width",function(b,c,d){if(!d)return b.getAttribute(c,
"type"===c.toLowerCase()?1:2)}),fa.attributes&&sa(function(b){return b.innerHTML="<input/>",b.firstChild.setAttribute("value",""),""===b.firstChild.getAttribute("value")})||Sa("value",function(b,c,d){if(!d&&"input"===b.nodeName.toLowerCase())return b.defaultValue}),sa(function(b){return null==b.getAttribute("disabled")})||Sa("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(b,c,d){var g;if(!d)return!0===b[c]?c.toLowerCase():
(g=b.getAttributeNode(c))&&g.specified?g.value:null}),X);q.find=va;q.expr=va.selectors;q.expr[":"]=q.expr.pseudos;q.uniqueSort=q.unique=va.uniqueSort;q.text=va.getText;q.isXMLDoc=va.isXML;q.contains=va.contains;q.escapeSelector=va.escape;var ib=function(b,c,d){for(var g=[],e=void 0!==d;(b=b[c])&&9!==b.nodeType;)if(1===b.nodeType){if(e&&q(b).is(d))break;g.push(b)}return g},jc=function(b,c){for(var d=[];b;b=b.nextSibling)1===b.nodeType&&b!==c&&d.push(b);return d},kc=q.expr.match.needsContext,lc=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,
Gc=/^.[^:#\[\.,]*$/;q.filter=function(b,c,d){var g=c[0];return d&&(b=":not("+b+")"),1===c.length&&1===g.nodeType?q.find.matchesSelector(g,b)?[g]:[]:q.find.matches(b,q.grep(c,function(b){return 1===b.nodeType}))};q.fn.extend({find:function(b){var c,d,g=this.length,e=this;if("string"!=typeof b)return this.pushStack(q(b).filter(function(){for(c=0;c<g;c++)if(q.contains(e[c],this))return!0}));d=this.pushStack([]);for(c=0;c<g;c++)q.find(b,e[c],d);return 1<g?q.uniqueSort(d):d},filter:function(b){return this.pushStack(f(this,
b||[],!1))},not:function(b){return this.pushStack(f(this,b||[],!0))},is:function(b){return!!f(this,"string"==typeof b&&kc.test(b)?q(b):b||[],!1).length}});var mc,cd=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(q.fn.init=function(b,c,d){var g,e;if(!b)return this;if(d=d||mc,"string"==typeof b){if(g="<"===b[0]&&">"===b[b.length-1]&&3<=b.length?[null,b,null]:cd.exec(b),!g||!g[1]&&c)return!c||c.jquery?(c||d).find(b):this.constructor(c).find(b);if(g[1]){if(c=c instanceof q?c[0]:c,q.merge(this,q.parseHTML(g[1],
c&&c.nodeType?c.ownerDocument||c:G,!0)),lc.test(g[1])&&q.isPlainObject(c))for(g in c)q.isFunction(this[g])?this[g](c[g]):this.attr(g,c[g]);return this}return e=G.getElementById(g[2]),e&&(this[0]=e,this.length=1),this}return b.nodeType?(this[0]=b,this.length=1,this):q.isFunction(b)?void 0!==d.ready?d.ready(b):b(q):q.makeArray(b,this)}).prototype=q.fn;mc=q(G);var dd=/^(?:parents|prev(?:Until|All))/,ed={children:!0,contents:!0,next:!0,prev:!0};q.fn.extend({has:function(b){var c=q(b,this),d=c.length;
return this.filter(function(){for(var b=0;b<d;b++)if(q.contains(this,c[b]))return!0})},closest:function(b,c){var d,g=0,e=this.length,f=[],p="string"!=typeof b&&q(b);if(!kc.test(b))for(;g<e;g++)for(d=this[g];d&&d!==c;d=d.parentNode)if(11>d.nodeType&&(p?-1<p.index(d):1===d.nodeType&&q.find.matchesSelector(d,b))){f.push(d);break}return this.pushStack(1<f.length?q.uniqueSort(f):f)},index:function(b){return b?"string"==typeof b?Va.call(q(b),this[0]):Va.call(this,b.jquery?b[0]:b):this[0]&&this[0].parentNode?
this.first().prevAll().length:-1},add:function(b,c){return this.pushStack(q.uniqueSort(q.merge(this.get(),q(b,c))))},addBack:function(b){return this.add(null==b?this.prevObject:this.prevObject.filter(b))}});q.each({parent:function(b){return(b=b.parentNode)&&11!==b.nodeType?b:null},parents:function(b){return ib(b,"parentNode")},parentsUntil:function(b,c,d){return ib(b,"parentNode",d)},next:function(b){return n(b,"nextSibling")},prev:function(b){return n(b,"previousSibling")},nextAll:function(b){return ib(b,
"nextSibling")},prevAll:function(b){return ib(b,"previousSibling")},nextUntil:function(b,c,d){return ib(b,"nextSibling",d)},prevUntil:function(b,c,d){return ib(b,"previousSibling",d)},siblings:function(b){return jc((b.parentNode||{}).firstChild,b)},children:function(b){return jc(b.firstChild)},contents:function(b){return j(b,"iframe")?b.contentDocument:(j(b,"template")&&(b=b.content||b),q.merge([],b.childNodes))}},function(b,c){q.fn[b]=function(d,g){var e=q.map(this,c,d);return"Until"!==b.slice(-5)&&
(g=d),g&&"string"==typeof g&&(e=q.filter(g,e)),1<this.length&&(ed[b]||q.uniqueSort(e),dd.test(b)&&e.reverse()),this.pushStack(e)}});var ua=/[^\x20\t\r\n\f]+/g;q.Callbacks=function(b){var c;if("string"==typeof b){var d={};c=(q.each(b.match(ua)||[],function(b,c){d[c]=!0}),d)}else c=q.extend({},b);b=c;var g,e,f,p,m=[],j=[],l=-1,r=function(){p=p||b.once;for(f=g=!0;j.length;l=-1)for(e=j.shift();++l<m.length;)!1===m[l].apply(e[0],e[1])&&b.stopOnFalse&&(l=m.length,e=!1);b.memory||(e=!1);g=!1;p&&(m=e?[]:
"")},s={add:function(){return m&&(e&&!g&&(l=m.length-1,j.push(e)),function Mc(c){q.each(c,function(c,d){q.isFunction(d)?b.unique&&s.has(d)||m.push(d):d&&d.length&&"string"!==q.type(d)&&Mc(d)})}(arguments),e&&!g&&r()),this},remove:function(){return q.each(arguments,function(b,c){for(var d;-1<(d=q.inArray(c,m,d));)m.splice(d,1),d<=l&&l--}),this},has:function(b){return b?-1<q.inArray(b,m):0<m.length},empty:function(){return m&&(m=[]),this},disable:function(){return p=j=[],m=e="",this},disabled:function(){return!m},
lock:function(){return p=j=[],e||g||(m=e=""),this},locked:function(){return!!p},fireWith:function(b,c){return p||(c=c||[],c=[b,c.slice?c.slice():c],j.push(c),g||r()),this},fire:function(){return s.fireWith(this,arguments),this},fired:function(){return!!f}};return s};q.extend({Deferred:function(c){var d=[["notify","progress",q.Callbacks("memory"),q.Callbacks("memory"),2],["resolve","done",q.Callbacks("once memory"),q.Callbacks("once memory"),0,"resolved"],["reject","fail",q.Callbacks("once memory"),
q.Callbacks("once memory"),1,"rejected"]],e="pending",f={state:function(){return e},always:function(){return p.done(arguments).fail(arguments),this},"catch":function(b){return f.then(null,b)},pipe:function(){var b=arguments;return q.Deferred(function(c){q.each(d,function(d,g){var e=q.isFunction(b[g[4]])&&b[g[4]];p[g[1]](function(){var b=e&&e.apply(this,arguments);b&&q.isFunction(b.promise)?b.promise().progress(c.notify).done(c.resolve).fail(c.reject):c[g[0]+"With"](this,e?[b]:arguments)})});b=null}).promise()},
then:function(c,e,f){function p(c,d,e,f){return function(){var j=this,r=arguments,Y=function(){var b,Y;if(!(c<m)){if(b=e.apply(j,r),b===d.promise())throw new TypeError("Thenable self-resolution");Y=b&&("object"==typeof b||"function"==typeof b)&&b.then;q.isFunction(Y)?f?Y.call(b,p(m,d,l,f),p(m,d,g,f)):(m++,Y.call(b,p(m,d,l,f),p(m,d,g,f),p(m,d,l,d.notifyWith))):(e!==l&&(j=void 0,r=[b]),(f||d.resolveWith)(j,r))}},s=f?Y:function(){try{Y()}catch(b){q.Deferred.exceptionHook&&q.Deferred.exceptionHook(b,
s.stackTrace),c+1>=m&&(e!==g&&(j=void 0,r=[b]),d.rejectWith(j,r))}};c?s():(q.Deferred.getStackHook&&(s.stackTrace=q.Deferred.getStackHook()),b.setTimeout(s))}}var m=0;return q.Deferred(function(b){d[0][3].add(p(0,b,q.isFunction(f)?f:l,b.notifyWith));d[1][3].add(p(0,b,q.isFunction(c)?c:l));d[2][3].add(p(0,b,q.isFunction(e)?e:g))}).promise()},promise:function(b){return null!=b?q.extend(b,f):f}},p={};return q.each(d,function(b,c){var g=c[2],m=c[5];f[c[1]]=g.add;m&&g.add(function(){e=m},d[3-b][2].disable,
d[0][2].lock);g.add(c[3].fire);p[c[0]]=function(){return p[c[0]+"With"](this===p?void 0:this,arguments),this};p[c[0]+"With"]=g.fireWith}),f.promise(p),c&&c.call(p,p),p},when:function(b){var c=arguments.length,d=c,g=Array(d),e=pa.call(arguments),f=q.Deferred(),p=function(b){return function(d){g[b]=this;e[b]=1<arguments.length?pa.call(arguments):d;--c||f.resolveWith(g,e)}};if(1>=c&&(m(b,f.done(p(d)).resolve,f.reject,!c),"pending"===f.state()||q.isFunction(e[d]&&e[d].then)))return f.then();for(;d--;)m(e[d],
p(d),f.reject);return f.promise()}});var fd=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;q.Deferred.exceptionHook=function(c,d){b.console&&b.console.warn&&c&&fd.test(c.name)&&b.console.warn("jQuery.Deferred exception: "+c.message,c.stack,d)};q.readyException=function(c){b.setTimeout(function(){throw c;})};var Sb=q.Deferred();q.fn.ready=function(b){return Sb.then(b)["catch"](function(b){q.readyException(b)}),this};q.extend({isReady:!1,readyWait:1,ready:function(b){(!0===b?--q.readyWait:
q.isReady)||(q.isReady=!0,!0!==b&&0<--q.readyWait||Sb.resolveWith(G,[q]))}});q.ready.then=Sb.then;"complete"===G.readyState||"loading"!==G.readyState&&!G.documentElement.doScroll?b.setTimeout(q.ready):(G.addEventListener("DOMContentLoaded",p),b.addEventListener("load",p));var Na=function(b,c,d,g,e,f,p){var m=0,j=b.length,l=null==d;if("object"===q.type(d))for(m in e=!0,d)Na(b,c,m,d[m],!0,f,p);else if(void 0!==g&&(e=!0,q.isFunction(g)||(p=!0),l&&(p?(c.call(b,g),c=null):(l=c,c=function(b,c,d){return l.call(q(b),
d)})),c))for(;m<j;m++)c(b[m],d,p?g:g.call(b[m],m,c(b[m],d)));return e?b:l?c.call(b):j?c(b[0],d):f},Db=function(b){return 1===b.nodeType||9===b.nodeType||!+b.nodeType};r.uid=1;r.prototype={cache:function(b){var c=b[this.expando];return c||(c={},Db(b)&&(b.nodeType?b[this.expando]=c:Object.defineProperty(b,this.expando,{value:c,configurable:!0}))),c},set:function(b,c,d){var g;b=this.cache(b);if("string"==typeof c)b[q.camelCase(c)]=d;else for(g in c)b[q.camelCase(g)]=c[g];return b},get:function(b,c){return void 0===
c?this.cache(b):b[this.expando]&&b[this.expando][q.camelCase(c)]},access:function(b,c,d){return void 0===c||c&&"string"==typeof c&&void 0===d?this.get(b,c):(this.set(b,c,d),void 0!==d?d:c)},remove:function(b,c){var d,g=b[this.expando];if(void 0!==g){if(void 0!==c){Array.isArray(c)?c=c.map(q.camelCase):(c=q.camelCase(c),c=c in g?[c]:c.match(ua)||[]);for(d=c.length;d--;)delete g[c[d]]}(void 0===c||q.isEmptyObject(g))&&(b.nodeType?b[this.expando]=void 0:delete b[this.expando])}},hasData:function(b){b=
b[this.expando];return void 0!==b&&!q.isEmptyObject(b)}};var P=new r,ra=new r,Ic=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Hc=/[A-Z]/g;q.extend({hasData:function(b){return ra.hasData(b)||P.hasData(b)},data:function(b,c,d){return ra.access(b,c,d)},removeData:function(b,c){ra.remove(b,c)},_data:function(b,c,d){return P.access(b,c,d)},_removeData:function(b,c){P.remove(b,c)}});q.fn.extend({data:function(b,c){var d,g,e,f=this[0],p=f&&f.attributes;if(void 0===b){if(this.length&&(e=ra.get(f),1===f.nodeType&&!P.get(f,
"hasDataAttrs"))){for(d=p.length;d--;)p[d]&&(g=p[d].name,0===g.indexOf("data-")&&(g=q.camelCase(g.slice(5)),s(f,g,e[g])));P.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof b?this.each(function(){ra.set(this,b)}):Na(this,function(c){var d;if(f&&void 0===c){if((d=ra.get(f,b),void 0!==d)||(d=s(f,b),void 0!==d))return d}else this.each(function(){ra.set(this,b,c)})},null,c,1<arguments.length,null,!0)},removeData:function(b){return this.each(function(){ra.remove(this,b)})}});q.extend({queue:function(b,
c,d){var g;if(b)return c=(c||"fx")+"queue",g=P.get(b,c),d&&(!g||Array.isArray(d)?g=P.access(b,c,q.makeArray(d)):g.push(d)),g||[]},dequeue:function(b,c){c=c||"fx";var d=q.queue(b,c),g=d.length,e=d.shift(),f=q._queueHooks(b,c),p=function(){q.dequeue(b,c)};"inprogress"===e&&(e=d.shift(),g--);e&&("fx"===c&&d.unshift("inprogress"),delete f.stop,e.call(b,p,f));!g&&f&&f.empty.fire()},_queueHooks:function(b,c){var d=c+"queueHooks";return P.get(b,d)||P.access(b,d,{empty:q.Callbacks("once memory").add(function(){P.remove(b,
[c+"queue",d])})})}});q.fn.extend({queue:function(b,c){var d=2;return"string"!=typeof b&&(c=b,b="fx",d--),arguments.length<d?q.queue(this[0],b):void 0===c?this:this.each(function(){var d=q.queue(this,b,c);q._queueHooks(this,b);"fx"===b&&"inprogress"!==d[0]&&q.dequeue(this,b)})},dequeue:function(b){return this.each(function(){q.dequeue(this,b)})},clearQueue:function(b){return this.queue(b||"fx",[])},promise:function(b,c){var d,g=1,e=q.Deferred(),f=this,p=this.length,m=function(){--g||e.resolveWith(f,
[f])};"string"!=typeof b&&(c=b,b=void 0);for(b=b||"fx";p--;)(d=P.get(f[p],b+"queueHooks"))&&d.empty&&(g++,d.empty.add(m));return m(),e.promise(c)}});var nc=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,kb=RegExp("^(?:([+-])=|)("+nc+")([a-z%]*)$","i"),Wa=["Top","Right","Bottom","Left"],sb=function(b,c){return b=c||b,"none"===b.style.display||""===b.style.display&&q.contains(b.ownerDocument,b)&&"none"===q.css(b,"display")},oc=function(b,c,d,g){var e,f={};for(e in c)f[e]=b.style[e],b.style[e]=c[e];d=
d.apply(b,g||[]);for(e in c)b.style[e]=f[e];return d},Wb={};q.fn.extend({show:function(){return u(this,!0)},hide:function(){return u(this)},toggle:function(b){return"boolean"==typeof b?b?this.show():this.hide():this.each(function(){sb(this)?q(this).show():q(this).hide()})}});var pc=/^(?:checkbox|radio)$/i,Xb=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Yb=/^$|\/(?:java|ecma)script/i,ta={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],
tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ta.optgroup=ta.option;ta.tbody=ta.tfoot=ta.colgroup=ta.caption=ta.thead;ta.th=ta.td;var Jc=/<|&#?\w+;/,Eb=G.createDocumentFragment().appendChild(G.createElement("div")),Fb=G.createElement("input");Fb.setAttribute("type","radio");Fb.setAttribute("checked","checked");Fb.setAttribute("name","t");Eb.appendChild(Fb);ba.checkClone=Eb.cloneNode(!0).cloneNode(!0).lastChild.checked;Eb.innerHTML=
"<textarea>x</textarea>";ba.noCloneChecked=!!Eb.cloneNode(!0).lastChild.defaultValue;!0;var Gb=G.documentElement,gd=/^key/,hd=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,qc=/^([^.]*)(?:\.(.+)|)/;q.event={global:{},add:function(b,c,d,g,e){var f,p,m,j,l,r,s,n,E,t;if(l=P.get(b)){d.handler&&(f=d,d=f.handler,e=f.selector);e&&q.find.matchesSelector(Gb,e);d.guid||(d.guid=q.guid++);(j=l.events)||(j=l.events={});(p=l.handle)||(p=l.handle=function(c){return"undefined"!=typeof q&&q.event.triggered!==c.type?
q.event.dispatch.apply(b,arguments):void 0});c=(c||"").match(ua)||[""];for(l=c.length;l--;)m=qc.exec(c[l])||[],E=t=m[1],m=(m[2]||"").split(".").sort(),E&&(s=q.event.special[E]||{},E=(e?s.delegateType:s.bindType)||E,s=q.event.special[E]||{},r=q.extend({type:E,origType:t,data:g,handler:d,guid:d.guid,selector:e,needsContext:e&&q.expr.match.needsContext.test(e),namespace:m.join(".")},f),(n=j[E])||(n=j[E]=[],n.delegateCount=0,s.setup&&!1!==s.setup.call(b,g,m,p)||b.addEventListener&&b.addEventListener(E,
p)),s.add&&(s.add.call(b,r),r.handler.guid||(r.handler.guid=d.guid)),e?n.splice(n.delegateCount++,0,r):n.push(r),q.event.global[E]=!0)}},remove:function(b,c,d,g,e){var f,p,m,j,l,r,s,n,E,t,u,v=P.hasData(b)&&P.get(b);if(v&&(j=v.events)){c=(c||"").match(ua)||[""];for(l=c.length;l--;)if(m=qc.exec(c[l])||[],E=u=m[1],t=(m[2]||"").split(".").sort(),E){s=q.event.special[E]||{};E=(g?s.delegateType:s.bindType)||E;n=j[E]||[];m=m[2]&&RegExp("(^|\\.)"+t.join("\\.(?:.*\\.|)")+"(\\.|$)");for(p=f=n.length;f--;)r=
n[f],!e&&u!==r.origType||d&&d.guid!==r.guid||m&&!m.test(r.namespace)||g&&g!==r.selector&&("**"!==g||!r.selector)||(n.splice(f,1),r.selector&&n.delegateCount--,s.remove&&s.remove.call(b,r));p&&!n.length&&(s.teardown&&!1!==s.teardown.call(b,t,v.handle)||q.removeEvent(b,E,v.handle),delete j[E])}else for(E in j)q.event.remove(b,E+c[l],d,g,!0);q.isEmptyObject(j)&&P.remove(b,"handle events")}},dispatch:function(b){var c=q.event.fix(b),d,g,e,f,p,m,j=Array(arguments.length);g=(P.get(this,"events")||{})[c.type]||
[];var l=q.event.special[c.type]||{};j[0]=c;for(d=1;d<arguments.length;d++)j[d]=arguments[d];if(c.delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,c)){m=q.event.handlers.call(this,c,g);for(d=0;(f=m[d++])&&!c.isPropagationStopped();){c.currentTarget=f.elem;for(g=0;(p=f.handlers[g++])&&!c.isImmediatePropagationStopped();)c.rnamespace&&!c.rnamespace.test(p.namespace)||(c.handleObj=p,c.data=p.data,e=((q.event.special[p.origType]||{}).handle||p.handler).apply(f.elem,j),void 0!==e&&!1===
(c.result=e)&&(c.preventDefault(),c.stopPropagation()))}return l.postDispatch&&l.postDispatch.call(this,c),c.result}},handlers:function(b,c){var d,g,e,f,p,m=[],j=c.delegateCount,l=b.target;if(j&&l.nodeType&&!("click"===b.type&&1<=b.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==b.type||!0!==l.disabled)){f=[];p={};for(d=0;d<j;d++)g=c[d],e=g.selector+" ",void 0===p[e]&&(p[e]=g.needsContext?-1<q(e,this).index(l):q.find(e,this,null,[l]).length),p[e]&&f.push(g);f.length&&m.push({elem:l,
handlers:f})}return l=this,j<c.length&&m.push({elem:l,handlers:c.slice(j)}),m},addProp:function(b,c){Object.defineProperty(q.Event.prototype,b,{enumerable:!0,configurable:!0,get:q.isFunction(c)?function(){if(this.originalEvent)return c(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[b]},set:function(c){Object.defineProperty(this,b,{enumerable:!0,configurable:!0,writable:!0,value:c})}})},fix:function(b){return b[q.expando]?b:new q.Event(b)},special:{load:{noBubble:!0},
focus:{trigger:function(){if(this!==D()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===D()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&j(this,"input"))return this.click(),!1},_default:function(b){return j(b.target,"a")}},beforeunload:{postDispatch:function(b){void 0!==b.result&&b.originalEvent&&(b.originalEvent.returnValue=b.result)}}}};q.removeEvent=function(b,c,d){b.removeEventListener&&
b.removeEventListener(c,d)};q.Event=function(b,c){return this instanceof q.Event?(b&&b.type?(this.originalEvent=b,this.type=b.type,this.isDefaultPrevented=b.defaultPrevented||void 0===b.defaultPrevented&&!1===b.returnValue?B:A,this.target=b.target&&3===b.target.nodeType?b.target.parentNode:b.target,this.currentTarget=b.currentTarget,this.relatedTarget=b.relatedTarget):this.type=b,c&&q.extend(this,c),this.timeStamp=b&&b.timeStamp||q.now(),void(this[q.expando]=!0)):new q.Event(b,c)};q.Event.prototype=
{constructor:q.Event,isDefaultPrevented:A,isPropagationStopped:A,isImmediatePropagationStopped:A,isSimulated:!1,preventDefault:function(){var b=this.originalEvent;this.isDefaultPrevented=B;b&&!this.isSimulated&&b.preventDefault()},stopPropagation:function(){var b=this.originalEvent;this.isPropagationStopped=B;b&&!this.isSimulated&&b.stopPropagation()},stopImmediatePropagation:function(){var b=this.originalEvent;this.isImmediatePropagationStopped=B;b&&!this.isSimulated&&b.stopImmediatePropagation();
this.stopPropagation()}};q.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(b){var c=b.button;return null==b.which&&gd.test(b.type)?null!=b.charCode?b.charCode:b.keyCode:!b.which&&void 0!==c&&hd.test(b.type)?
1&c?1:2&c?3:4&c?2:0:b.which}},q.event.addProp);q.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(b,c){q.event.special[b]={delegateType:c,bindType:c,handle:function(b){var d,g=b.relatedTarget,e=b.handleObj;return g&&(g===this||q.contains(this,g))||(b.type=e.origType,d=e.handler.apply(this,arguments),b.type=c),d}}});q.fn.extend({on:function(b,c,d,g){return I(this,b,c,d,g)},one:function(b,c,d,g){return I(this,b,c,d,g,1)},off:function(b,
c,d){var g,e;if(b&&b.preventDefault&&b.handleObj)return g=b.handleObj,q(b.delegateTarget).off(g.namespace?g.origType+"."+g.namespace:g.origType,g.selector,g.handler),this;if("object"==typeof b){for(e in b)this.off(e,c,b[e]);return this}return!1!==c&&"function"!=typeof c||(d=c,c=void 0),!1===d&&(d=A),this.each(function(){q.event.remove(this,b,d,c)})}});var id=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,jd=/<script|<style|<link/i,Lc=/checked\s*(?:[^=]|=\s*.checked.)/i,
Kc=/^true\/(.*)/,Nc=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;q.extend({htmlPrefilter:function(b){return b.replace(id,"<$1></$2>")},clone:function(b,c,d){var g,e,f,p,m=b.cloneNode(!0),j=q.contains(b.ownerDocument,b);if(!ba.noCloneChecked&&!(1!==b.nodeType&&11!==b.nodeType||q.isXMLDoc(b))){p=v(m);f=v(b);g=0;for(e=f.length;g<e;g++){var l=f[g],r=p[g],s=r.nodeName.toLowerCase();"input"===s&&pc.test(l.type)?r.checked=l.checked:"input"!==s&&"textarea"!==s||(r.defaultValue=l.defaultValue)}}if(c)if(d){f=
f||v(b);p=p||v(m);g=0;for(e=f.length;g<e;g++)M(f[g],p[g])}else M(b,m);return p=v(m,"script"),0<p.length&&z(p,!j&&v(b,"script")),m},cleanData:function(b){for(var c,d,g,e=q.event.special,f=0;void 0!==(d=b[f]);f++)if(Db(d)){if(c=d[P.expando]){if(c.events)for(g in c.events)e[g]?q.event.remove(d,g):q.removeEvent(d,g,c.handle);d[P.expando]=void 0}d[ra.expando]&&(d[ra.expando]=void 0)}}});q.fn.extend({detach:function(b){return N(this,b,!0)},remove:function(b){return N(this,b)},text:function(b){return Na(this,
function(b){return void 0===b?q.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=b)})},null,b,arguments.length)},append:function(){return O(this,arguments,function(b){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&y(this,b).appendChild(b)})},prepend:function(){return O(this,arguments,function(b){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var c=y(this,b);c.insertBefore(b,c.firstChild)}})},before:function(){return O(this,
arguments,function(b){this.parentNode&&this.parentNode.insertBefore(b,this)})},after:function(){return O(this,arguments,function(b){this.parentNode&&this.parentNode.insertBefore(b,this.nextSibling)})},empty:function(){for(var b,c=0;null!=(b=this[c]);c++)1===b.nodeType&&(q.cleanData(v(b,!1)),b.textContent="");return this},clone:function(b,c){return b=null!=b&&b,c=null==c?b:c,this.map(function(){return q.clone(this,b,c)})},html:function(b){return Na(this,function(b){var c=this[0]||{},d=0,g=this.length;
if(void 0===b&&1===c.nodeType)return c.innerHTML;if("string"==typeof b&&!jd.test(b)&&!ta[(Xb.exec(b)||["",""])[1].toLowerCase()]){b=q.htmlPrefilter(b);try{for(;d<g;d++)c=this[d]||{},1===c.nodeType&&(q.cleanData(v(c,!1)),c.innerHTML=b);c=0}catch(e){}}c&&this.empty().append(b)},null,b,arguments.length)},replaceWith:function(){var b=[];return O(this,arguments,function(c){var d=this.parentNode;0>q.inArray(this,b)&&(q.cleanData(v(this)),d&&d.replaceChild(c,this))},b)}});q.each({appendTo:"append",prependTo:"prepend",
insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(b,c){q.fn[b]=function(b){for(var d=[],g=q(b),e=g.length-1,f=0;f<=e;f++)b=f===e?this:this.clone(!0),q(g[f])[c](b),Oa.apply(d,b.get());return this.pushStack(d)}});var Zb=/^margin/,Jb=RegExp("^("+nc+")(?!px)[a-z%]+$","i"),tb=function(c){var d=c.ownerDocument.defaultView;return d&&d.opener||(d=b),d.getComputedStyle(c)},Ib=function(){if(Ca){Ca.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%";
Ca.innerHTML="";Gb.appendChild(Hb);var c=b.getComputedStyle(Ca);rc="1%"!==c.top;sc="2px"===c.marginLeft;tc="4px"===c.width;Ca.style.marginRight="50%";uc="4px"===c.marginRight;Gb.removeChild(Hb);Ca=null}},rc,tc,uc,sc,Hb=G.createElement("div"),Ca=G.createElement("div");Ca.style&&(Ca.style.backgroundClip="content-box",Ca.cloneNode(!0).style.backgroundClip="",ba.clearCloneStyle="content-box"===Ca.style.backgroundClip,Hb.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",
Hb.appendChild(Ca),q.extend(ba,{pixelPosition:function(){return Ib(),rc},boxSizingReliable:function(){return Ib(),tc},pixelMarginRight:function(){return Ib(),uc},reliableMarginLeft:function(){return Ib(),sc}}));!0;var kd=/^(none|table(?!-c[ea]).+)/,vc=/^--/,ld={position:"absolute",visibility:"hidden",display:"block"},wc={letterSpacing:"0",fontWeight:"400"},ac=["Webkit","Moz","ms"],$b=G.createElement("div").style;q.extend({cssHooks:{opacity:{get:function(b,c){if(c){var d=K(b,"opacity");return""===
d?"1":d}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(b,c,d,g){if(b&&3!==b.nodeType&&8!==b.nodeType&&b.style){var e,f,p,m=q.camelCase(c),j=vc.test(c),l=b.style;return j||(c=da(m)),p=q.cssHooks[c]||q.cssHooks[m],void 0===d?p&&"get"in p&&void 0!==(e=p.get(b,!1,g))?e:l[c]:(f=typeof d,"string"===f&&(e=kb.exec(d))&&e[1]&&
(d=t(b,c,e),f="number"),null!=d&&d===d&&("number"===f&&(d+=e&&e[3]||(q.cssNumber[m]?"":"px")),ba.clearCloneStyle||""!==d||0!==c.indexOf("background")||(l[c]="inherit"),p&&"set"in p&&void 0===(d=p.set(b,d,g))||(j?l.setProperty(c,d):l[c]=d)),void 0)}},css:function(b,c,d,g){var e,f,p,m=q.camelCase(c);return vc.test(c)||(c=da(m)),p=q.cssHooks[c]||q.cssHooks[m],p&&"get"in p&&(e=p.get(b,!0,d)),void 0===e&&(e=K(b,c,g)),"normal"===e&&c in wc&&(e=wc[c]),""===d||d?(f=parseFloat(e),!0===d||isFinite(f)?f||0:
e):e}});q.each(["height","width"],function(b,c){q.cssHooks[c]={get:function(b,d,g){if(d)return!kd.test(q.css(b,"display"))||b.getClientRects().length&&b.getBoundingClientRect().width?ia(b,c,g):oc(b,ld,function(){return ia(b,c,g)})},set:function(b,d,g){var e,f=g&&tb(b);g=g&&H(b,c,g,"border-box"===q.css(b,"boxSizing",!1,f),f);return g&&(e=kb.exec(d))&&"px"!==(e[3]||"px")&&(b.style[c]=d,d=q.css(b,c)),F(b,d,g)}}});q.cssHooks.marginLeft=V(ba.reliableMarginLeft,function(b,c){if(c)return(parseFloat(K(b,
"marginLeft"))||b.getBoundingClientRect().left-oc(b,{marginLeft:0},function(){return b.getBoundingClientRect().left}))+"px"});q.each({margin:"",padding:"",border:"Width"},function(b,c){q.cssHooks[b+c]={expand:function(d){var g=0,e={};for(d="string"==typeof d?d.split(" "):[d];4>g;g++)e[b+Wa[g]+c]=d[g]||d[g-2]||d[0];return e}};Zb.test(b)||(q.cssHooks[b+c].set=F)});q.fn.extend({css:function(b,c){return Na(this,function(b,c,d){var g,e={},f=0;if(Array.isArray(c)){d=tb(b);for(g=c.length;f<g;f++)e[c[f]]=
q.css(b,c[f],!1,d);return e}return void 0!==d?q.style(b,c,d):q.css(b,c)},b,c,1<arguments.length)}});q.Tween=R;R.prototype={constructor:R,init:function(b,c,d,g,e,f){this.elem=b;this.prop=d;this.easing=e||q.easing._default;this.options=c;this.start=this.now=this.cur();this.end=g;this.unit=f||(q.cssNumber[d]?"":"px")},cur:function(){var b=R.propHooks[this.prop];return b&&b.get?b.get(this):R.propHooks._default.get(this)},run:function(b){var c,d=R.propHooks[this.prop];return this.options.duration?this.pos=
c=q.easing[this.easing](b,this.options.duration*b,0,1,this.options.duration):this.pos=c=b,this.now=(this.end-this.start)*c+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),d&&d.set?d.set(this):R.propHooks._default.set(this),this}};R.prototype.init.prototype=R.prototype;R.propHooks={_default:{get:function(b){var c;return 1!==b.elem.nodeType||null!=b.elem[b.prop]&&null==b.elem.style[b.prop]?b.elem[b.prop]:(c=q.css(b.elem,b.prop,""),c&&"auto"!==c?c:0)},set:function(b){q.fx.step[b.prop]?
q.fx.step[b.prop](b):1!==b.elem.nodeType||null==b.elem.style[q.cssProps[b.prop]]&&!q.cssHooks[b.prop]?b.elem[b.prop]=b.now:q.style(b.elem,b.prop,b.now+b.unit)}}};R.propHooks.scrollTop=R.propHooks.scrollLeft={set:function(b){b.elem.nodeType&&b.elem.parentNode&&(b.elem[b.prop]=b.now)}};q.easing={linear:function(b){return b},swing:function(b){return 0.5-Math.cos(b*Math.PI)/2},_default:"swing"};q.fx=R.prototype.init;q.fx.step={};var bb,ub,md=/^(?:toggle|show|hide)$/,nd=/queueHooks$/;q.Animation=q.extend(aa,
{tweeners:{"*":[function(b,c){var d=this.createTween(b,c);return t(d.elem,b,kb.exec(c),d),d}]},tweener:function(b,c){q.isFunction(b)?(c=b,b=["*"]):b=b.match(ua);for(var d,g=0,e=b.length;g<e;g++)d=b[g],aa.tweeners[d]=aa.tweeners[d]||[],aa.tweeners[d].unshift(c)},prefilters:[function(b,c,d){var g,e,f,p,m,j,l,r,s="width"in c||"height"in c,n=this,E={},t=b.style,v=b.nodeType&&sb(b),U=P.get(b,"fxshow");d.queue||(p=q._queueHooks(b,"fx"),null==p.unqueued&&(p.unqueued=0,m=p.empty.fire,p.empty.fire=function(){p.unqueued||
m()}),p.unqueued++,n.always(function(){n.always(function(){p.unqueued--;q.queue(b,"fx").length||p.empty.fire()})}));for(g in c)if(e=c[g],md.test(e)){if(delete c[g],f=f||"toggle"===e,e===(v?"hide":"show")){if("show"!==e||!U||void 0===U[g])continue;v=!0}E[g]=U&&U[g]||q.style(b,g)}if(j=!q.isEmptyObject(c),j||!q.isEmptyObject(E))for(g in s&&1===b.nodeType&&(d.overflow=[t.overflow,t.overflowX,t.overflowY],l=U&&U.display,null==l&&(l=P.get(b,"display")),r=q.css(b,"display"),"none"===r&&(l?r=l:(u([b],!0),
l=b.style.display||l,r=q.css(b,"display"),u([b]))),("inline"===r||"inline-block"===r&&null!=l)&&"none"===q.css(b,"float")&&(j||(n.done(function(){t.display=l}),null==l&&(r=t.display,l="none"===r?"":r)),t.display="inline-block")),d.overflow&&(t.overflow="hidden",n.always(function(){t.overflow=d.overflow[0];t.overflowX=d.overflow[1];t.overflowY=d.overflow[2]})),j=!1,E)j||(U?"hidden"in U&&(v=U.hidden):U=P.access(b,"fxshow",{display:l}),f&&(U.hidden=!v),v&&u([b],!0),n.done(function(){v||u([b]);P.remove(b,
"fxshow");for(g in E)q.style(b,g,E[g])})),j=Z(v?U[g]:0,g,n),g in U||(U[g]=j.start,v&&(j.end=j.start,j.start=0))}],prefilter:function(b,c){c?aa.prefilters.unshift(b):aa.prefilters.push(b)}});q.speed=function(b,c,d){var g=b&&"object"==typeof b?q.extend({},b):{complete:d||!d&&c||q.isFunction(b)&&b,duration:b,easing:d&&c||c&&!q.isFunction(c)&&c};return q.fx.off?g.duration=0:"number"!=typeof g.duration&&(g.duration in q.fx.speeds?g.duration=q.fx.speeds[g.duration]:g.duration=q.fx.speeds._default),null!=
g.queue&&!0!==g.queue||(g.queue="fx"),g.old=g.complete,g.complete=function(){q.isFunction(g.old)&&g.old.call(this);g.queue&&q.dequeue(this,g.queue)},g};q.fn.extend({fadeTo:function(b,c,d,g){return this.filter(sb).css("opacity",0).show().end().animate({opacity:c},b,d,g)},animate:function(b,c,d,g){var e=q.isEmptyObject(b),f=q.speed(c,d,g);c=function(){var c=aa(this,q.extend({},b),f);(e||P.get(this,"finish"))&&c.stop(!0)};return c.finish=c,e||!1===f.queue?this.each(c):this.queue(f.queue,c)},stop:function(b,
c,d){var g=function(b){var c=b.stop;delete b.stop;c(d)};return"string"!=typeof b&&(d=c,c=b,b=void 0),c&&!1!==b&&this.queue(b||"fx",[]),this.each(function(){var c=!0,e=null!=b&&b+"queueHooks",f=q.timers,p=P.get(this);if(e)p[e]&&p[e].stop&&g(p[e]);else for(e in p)p[e]&&p[e].stop&&nd.test(e)&&g(p[e]);for(e=f.length;e--;)f[e].elem!==this||null!=b&&f[e].queue!==b||(f[e].anim.stop(d),c=!1,f.splice(e,1));!c&&d||q.dequeue(this,b)})},finish:function(b){return!1!==b&&(b=b||"fx"),this.each(function(){var c,
d=P.get(this),g=d[b+"queue"];c=d[b+"queueHooks"];var e=q.timers,f=g?g.length:0;d.finish=!0;q.queue(this,b,[]);c&&c.stop&&c.stop.call(this,!0);for(c=e.length;c--;)e[c].elem===this&&e[c].queue===b&&(e[c].anim.stop(!0),e.splice(c,1));for(c=0;c<f;c++)g[c]&&g[c].finish&&g[c].finish.call(this);delete d.finish})}});q.each(["toggle","show","hide"],function(b,c){var d=q.fn[c];q.fn[c]=function(b,g,e){return null==b||"boolean"==typeof b?d.apply(this,arguments):this.animate(Q(c,!0),b,g,e)}});q.each({slideDown:Q("show"),
slideUp:Q("hide"),slideToggle:Q("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(b,c){q.fn[b]=function(b,d,g){return this.animate(c,b,d,g)}});q.timers=[];q.fx.tick=function(){var b,c=0,d=q.timers;for(bb=q.now();c<d.length;c++)b=d[c],b()||d[c]!==b||d.splice(c--,1);d.length||q.fx.stop();bb=void 0};q.fx.timer=function(b){q.timers.push(b);q.fx.start()};q.fx.interval=13;q.fx.start=function(){ub||(ub=!0,L())};q.fx.stop=function(){ub=null};q.fx.speeds={slow:600,
fast:200,_default:400};q.fn.delay=function(c,d){return c=q.fx?q.fx.speeds[c]||c:c,d=d||"fx",this.queue(d,function(d,g){var e=b.setTimeout(d,c);g.stop=function(){b.clearTimeout(e)}})};var jb=G.createElement("input"),od=G.createElement("select").appendChild(G.createElement("option"));jb.type="checkbox";ba.checkOn=""!==jb.value;ba.optSelected=od.selected;jb=G.createElement("input");jb.value="t";jb.type="radio";ba.radioValue="t"===jb.value;var xc,pb=q.expr.attrHandle;q.fn.extend({attr:function(b,c){return Na(this,
q.attr,b,c,1<arguments.length)},removeAttr:function(b){return this.each(function(){q.removeAttr(this,b)})}});q.extend({attr:function(b,c,d){var g,e,f=b.nodeType;if(3!==f&&8!==f&&2!==f)return"undefined"==typeof b.getAttribute?q.prop(b,c,d):(1===f&&q.isXMLDoc(b)||(e=q.attrHooks[c.toLowerCase()]||(q.expr.match.bool.test(c)?xc:void 0)),void 0!==d?null===d?void q.removeAttr(b,c):e&&"set"in e&&void 0!==(g=e.set(b,d,c))?g:(b.setAttribute(c,d+""),d):e&&"get"in e&&null!==(g=e.get(b,c))?g:(g=q.find.attr(b,
c),null==g?void 0:g))},attrHooks:{type:{set:function(b,c){if(!ba.radioValue&&"radio"===c&&j(b,"input")){var d=b.value;return b.setAttribute("type",c),d&&(b.value=d),c}}}},removeAttr:function(b,c){var d,g=0,e=c&&c.match(ua);if(e&&1===b.nodeType)for(;d=e[g++];)b.removeAttribute(d)}});xc={set:function(b,c,d){return!1===c?q.removeAttr(b,d):b.setAttribute(d,d),d}};q.each(q.expr.match.bool.source.match(/\w+/g),function(b,c){var d=pb[c]||q.find.attr;pb[c]=function(b,c,g){var e,f,p=c.toLowerCase();return g||
(f=pb[p],pb[p]=e,e=null!=d(b,c,g)?p:null,pb[p]=f),e}});var pd=/^(?:input|select|textarea|button)$/i,qd=/^(?:a|area)$/i;q.fn.extend({prop:function(b,c){return Na(this,q.prop,b,c,1<arguments.length)},removeProp:function(b){return this.each(function(){delete this[q.propFix[b]||b]})}});q.extend({prop:function(b,c,d){var g,e,f=b.nodeType;if(3!==f&&8!==f&&2!==f)return 1===f&&q.isXMLDoc(b)||(c=q.propFix[c]||c,e=q.propHooks[c]),void 0!==d?e&&"set"in e&&void 0!==(g=e.set(b,d,c))?g:b[c]=d:e&&"get"in e&&null!==
(g=e.get(b,c))?g:b[c]},propHooks:{tabIndex:{get:function(b){var c=q.find.attr(b,"tabindex");return c?parseInt(c,10):pd.test(b.nodeName)||qd.test(b.nodeName)&&b.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}});ba.optSelected||(q.propHooks.selected={get:function(b){b=b.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null},set:function(b){b=b.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex)}});q.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),
function(){q.propFix[this.toLowerCase()]=this});q.fn.extend({addClass:function(b){var c,d,g,e,f,p,m=0;if(q.isFunction(b))return this.each(function(c){q(this).addClass(b.call(this,c,qa(this)))});if("string"==typeof b&&b)for(c=b.match(ua)||[];d=this[m++];)if(e=qa(d),g=1===d.nodeType&&" "+la(e)+" "){for(p=0;f=c[p++];)0>g.indexOf(" "+f+" ")&&(g+=f+" ");g=la(g);e!==g&&d.setAttribute("class",g)}return this},removeClass:function(b){var c,d,g,e,f,p,m=0;if(q.isFunction(b))return this.each(function(c){q(this).removeClass(b.call(this,
c,qa(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof b&&b)for(c=b.match(ua)||[];d=this[m++];)if(e=qa(d),g=1===d.nodeType&&" "+la(e)+" "){for(p=0;f=c[p++];)for(;-1<g.indexOf(" "+f+" ");)g=g.replace(" "+f+" "," ");g=la(g);e!==g&&d.setAttribute("class",g)}return this},toggleClass:function(b,c){var d=typeof b;return"boolean"==typeof c&&"string"===d?c?this.addClass(b):this.removeClass(b):q.isFunction(b)?this.each(function(d){q(this).toggleClass(b.call(this,d,qa(this),c),
c)}):this.each(function(){var c,g,e,f;if("string"===d){g=0;e=q(this);for(f=b.match(ua)||[];c=f[g++];)e.hasClass(c)?e.removeClass(c):e.addClass(c)}else void 0!==b&&"boolean"!==d||(c=qa(this),c&&P.set(this,"__className__",c),this.setAttribute&&this.setAttribute("class",c||!1===b?"":P.get(this,"__className__")||""))})},hasClass:function(b){var c,d=0;for(b=" "+b+" ";c=this[d++];)if(1===c.nodeType&&-1<(" "+la(qa(c))+" ").indexOf(b))return!0;return!1}});var rd=/\r/g;q.fn.extend({val:function(b){var c,d,
g,e=this[0];if(arguments.length)return g=q.isFunction(b),this.each(function(d){var e;1===this.nodeType&&(e=g?b.call(this,d,q(this).val()):b,null==e?e="":"number"==typeof e?e+="":Array.isArray(e)&&(e=q.map(e,function(b){return null==b?"":b+""})),c=q.valHooks[this.type]||q.valHooks[this.nodeName.toLowerCase()],c&&"set"in c&&void 0!==c.set(this,e,"value")||(this.value=e))});if(e)return c=q.valHooks[e.type]||q.valHooks[e.nodeName.toLowerCase()],c&&"get"in c&&void 0!==(d=c.get(e,"value"))?d:(d=e.value,
"string"==typeof d?d.replace(rd,""):null==d?"":d)}});q.extend({valHooks:{option:{get:function(b){var c=q.find.attr(b,"value");return null!=c?c:la(q.text(b))}},select:{get:function(b){var c,d,g=b.options,e=b.selectedIndex,f="select-one"===b.type,p=f?null:[],m=f?e+1:g.length;for(d=0>e?m:f?e:0;d<m;d++)if(c=g[d],(c.selected||d===e)&&!c.disabled&&(!c.parentNode.disabled||!j(c.parentNode,"optgroup"))){if(b=q(c).val(),f)return b;p.push(b)}return p},set:function(b,c){for(var d,g,e=b.options,f=q.makeArray(c),
p=e.length;p--;)g=e[p],(g.selected=-1<q.inArray(q.valHooks.option.get(g),f))&&(d=!0);return d||(b.selectedIndex=-1),f}}}});q.each(["radio","checkbox"],function(){q.valHooks[this]={set:function(b,c){if(Array.isArray(c))return b.checked=-1<q.inArray(q(b).val(),c)}};ba.checkOn||(q.valHooks[this].get=function(b){return null===b.getAttribute("value")?"on":b.value})});var yc=/^(?:focusinfocus|focusoutblur)$/;q.extend(q.event,{trigger:function(c,d,g,e){var f,p,m,j,l,r,s,n=[g||G],E=db.call(c,"type")?c.type:
c;f=db.call(c,"namespace")?c.namespace.split("."):[];if(p=m=g=g||G,3!==g.nodeType&&8!==g.nodeType&&!yc.test(E+q.event.triggered)&&(-1<E.indexOf(".")&&(f=E.split("."),E=f.shift(),f.sort()),l=0>E.indexOf(":")&&"on"+E,c=c[q.expando]?c:new q.Event(E,"object"==typeof c&&c),c.isTrigger=e?2:3,c.namespace=f.join("."),c.rnamespace=c.namespace?RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,c.result=void 0,c.target||(c.target=g),d=null==d?[c]:q.makeArray(d,[c]),s=q.event.special[E]||{},e||!s.trigger||
!1!==s.trigger.apply(g,d))){if(!e&&!s.noBubble&&!q.isWindow(g)){j=s.delegateType||E;for(yc.test(j+E)||(p=p.parentNode);p;p=p.parentNode)n.push(p),m=p;m===(g.ownerDocument||G)&&n.push(m.defaultView||m.parentWindow||b)}for(f=0;(p=n[f++])&&!c.isPropagationStopped();)c.type=1<f?j:s.bindType||E,(r=(P.get(p,"events")||{})[c.type]&&P.get(p,"handle"))&&r.apply(p,d),(r=l&&p[l])&&r.apply&&Db(p)&&(c.result=r.apply(p,d),!1===c.result&&c.preventDefault());return c.type=E,e||c.isDefaultPrevented()||s._default&&
!1!==s._default.apply(n.pop(),d)||!Db(g)||l&&q.isFunction(g[E])&&!q.isWindow(g)&&(m=g[l],m&&(g[l]=null),q.event.triggered=E,g[E](),q.event.triggered=void 0,m&&(g[l]=m)),c.result}},simulate:function(b,c,d){b=q.extend(new q.Event,d,{type:b,isSimulated:!0});q.event.trigger(b,null,c)}});q.fn.extend({trigger:function(b,c){return this.each(function(){q.event.trigger(b,c,this)})},triggerHandler:function(b,c){var d=this[0];if(d)return q.event.trigger(b,c,d,!0)}});q.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),
function(b,c){q.fn[c]=function(b,d){return 0<arguments.length?this.on(c,null,b,d):this.trigger(c)}});q.fn.extend({hover:function(b,c){return this.mouseenter(b).mouseleave(c||b)}});ba.focusin="onfocusin"in b;ba.focusin||q.each({focus:"focusin",blur:"focusout"},function(b,c){var d=function(b){q.event.simulate(c,b.target,q.event.fix(b))};q.event.special[c]={setup:function(){var g=this.ownerDocument||this,e=P.access(g,c);e||g.addEventListener(b,d,!0);P.access(g,c,(e||0)+1)},teardown:function(){var g=
this.ownerDocument||this,e=P.access(g,c)-1;e?P.access(g,c,e):(g.removeEventListener(b,d,!0),P.remove(g,c))}}});var qb=b.location,zc=q.now(),Tb=/\?/;q.parseXML=function(c){var d;if(!c||"string"!=typeof c)return null;try{d=(new b.DOMParser).parseFromString(c,"text/xml")}catch(g){d=void 0}return d&&!d.getElementsByTagName("parsererror").length||q.error("Invalid XML: "+c),d};var Oc=/\[\]$/,Ac=/\r?\n/g,sd=/^(?:submit|button|image|reset|file)$/i,td=/^(?:input|select|textarea|keygen)/i;q.param=function(b,
c){var d,g=[],e=function(b,c){var d=q.isFunction(c)?c():c;g[g.length]=encodeURIComponent(b)+"="+encodeURIComponent(null==d?"":d)};if(Array.isArray(b)||b.jquery&&!q.isPlainObject(b))q.each(b,function(){e(this.name,this.value)});else for(d in b)ea(d,b[d],c,e);return g.join("&")};q.fn.extend({serialize:function(){return q.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var b=q.prop(this,"elements");return b?q.makeArray(b):this}).filter(function(){var b=this.type;return this.name&&
!q(this).is(":disabled")&&td.test(this.nodeName)&&!sd.test(b)&&(this.checked||!pc.test(b))}).map(function(b,c){var d=q(this).val();return null==d?null:Array.isArray(d)?q.map(d,function(b){return{name:c.name,value:b.replace(Ac,"\r\n")}}):{name:c.name,value:d.replace(Ac,"\r\n")}}).get()}});var ud=/%20/g,vd=/#.*$/,wd=/([?&])_=[^&]*/,xd=/^(.*?):[ \t]*([^\r\n]*)$/gm,yd=/^(?:GET|HEAD)$/,zd=/^\/\//,Bc={},Kb={},Cc="*/".concat("*"),Ub=G.createElement("a");Ub.href=qb.href;q.extend({active:0,lastModified:{},
etag:{},ajaxSettings:{url:qb.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(qb.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Cc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,
"text html":!0,"text json":JSON.parse,"text xml":q.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(b,c){return c?U(U(b,q.ajaxSettings),c):U(q.ajaxSettings,b)},ajaxPrefilter:oa(Bc),ajaxTransport:oa(Kb),ajax:function(c,d){function g(c,d,m,l){var n,E,t,ga,na=d;if(!r){r=!0;j&&b.clearTimeout(j);e=void 0;p=l||"";y.readyState=0<c?4:0;l=200<=c&&300>c||304===c;if(m){t=u;for(var x=y,L,K,M,G,S=t.contents,H=t.dataTypes;"*"===H[0];)H.shift(),void 0===L&&(L=t.mimeType||x.getResponseHeader("Content-Type"));
if(L)for(K in S)if(S[K]&&S[K].test(L)){H.unshift(K);break}if(H[0]in m)M=H[0];else{for(K in m){if(!H[0]||t.converters[K+" "+H[0]]){M=K;break}G||(G=K)}M=M||G}m=M?(M!==H[0]&&H.unshift(M),m[M]):void 0;t=m}var Y;a:{m=u;L=t;K=y;M=l;var F,Z,B;t={};x=m.dataTypes.slice();if(x[1])for(F in m.converters)t[F.toLowerCase()]=m.converters[F];for(G=x.shift();G;)if(m.responseFields[G]&&(K[m.responseFields[G]]=L),!B&&M&&m.dataFilter&&(L=m.dataFilter(L,m.dataType)),B=G,G=x.shift())if("*"===G)G=B;else if("*"!==B&&B!==
G){if(F=t[B+" "+G]||t["* "+G],!F)for(Y in t)if(Z=Y.split(" "),Z[1]===G&&(F=t[B+" "+Z[0]]||t["* "+Z[0]])){!0===F?F=t[Y]:!0!==t[Y]&&(G=Z[0],x.unshift(Z[1]));break}if(!0!==F)if(F&&m["throws"])L=F(L);else try{L=F(L)}catch(fb){Y={state:"parsererror",error:F?fb:"No conversion from "+B+" to "+G};break a}}Y={state:"success",data:L}}t=Y;l?(u.ifModified&&(ga=y.getResponseHeader("Last-Modified"),ga&&(q.lastModified[f]=ga),ga=y.getResponseHeader("etag"),ga&&(q.etag[f]=ga)),204===c||"HEAD"===u.type?na="nocontent":
304===c?na="notmodified":(na=t.state,n=t.data,E=t.error,l=!E)):(E=na,!c&&na||(na="error",0>c&&(c=0)));y.status=c;y.statusText=(d||na)+"";l?z.resolveWith(v,[n,na,y]):z.rejectWith(v,[y,na,E]);y.statusCode(Q);Q=void 0;s&&U.trigger(l?"ajaxSuccess":"ajaxError",[y,u,l?n:E]);T.fireWith(v,[y,na]);s&&(U.trigger("ajaxComplete",[y,u]),--q.active||q.event.trigger("ajaxStop"))}}"object"==typeof c&&(d=c,c=void 0);d=d||{};var e,f,p,m,j,l,r,s,n,t,u=q.ajaxSetup({},d),v=u.context||u,U=u.context&&(v.nodeType||v.jquery)?
q(v):q.event,z=q.Deferred(),T=q.Callbacks("once memory"),Q=u.statusCode||{},ga={},na={},x="canceled",y={readyState:0,getResponseHeader:function(b){var c;if(r){if(!m)for(m={};c=xd.exec(p);)m[c[1].toLowerCase()]=c[2];c=m[b.toLowerCase()]}return null==c?null:c},getAllResponseHeaders:function(){return r?p:null},setRequestHeader:function(b,c){return null==r&&(b=na[b.toLowerCase()]=na[b.toLowerCase()]||b,ga[b]=c),this},overrideMimeType:function(b){return null==r&&(u.mimeType=b),this},statusCode:function(b){var c;
if(b)if(r)y.always(b[y.status]);else for(c in b)Q[c]=[Q[c],b[c]];return this},abort:function(b){b=b||x;return e&&e.abort(b),g(0,b),this}};if(z.promise(y),u.url=((c||u.url||qb.href)+"").replace(zd,qb.protocol+"//"),u.type=d.method||d.type||u.method||u.type,u.dataTypes=(u.dataType||"*").toLowerCase().match(ua)||[""],null==u.crossDomain){l=G.createElement("a");try{l.href=u.url,l.href=l.href,u.crossDomain=Ub.protocol+"//"+Ub.host!=l.protocol+"//"+l.host}catch(L){u.crossDomain=!0}}if(u.data&&u.processData&&
"string"!=typeof u.data&&(u.data=q.param(u.data,u.traditional)),E(Bc,u,d,y),r)return y;(s=q.event&&u.global)&&0===q.active++&&q.event.trigger("ajaxStart");u.type=u.type.toUpperCase();u.hasContent=!yd.test(u.type);f=u.url.replace(vd,"");u.hasContent?u.data&&u.processData&&0===(u.contentType||"").indexOf("application/x-www-form-urlencoded")&&(u.data=u.data.replace(ud,"+")):(t=u.url.slice(f.length),u.data&&(f+=(Tb.test(f)?"&":"?")+u.data,delete u.data),!1===u.cache&&(f=f.replace(wd,"$1"),t=(Tb.test(f)?
"&":"?")+"_="+zc++ +t),u.url=f+t);u.ifModified&&(q.lastModified[f]&&y.setRequestHeader("If-Modified-Since",q.lastModified[f]),q.etag[f]&&y.setRequestHeader("If-None-Match",q.etag[f]));(u.data&&u.hasContent&&!1!==u.contentType||d.contentType)&&y.setRequestHeader("Content-Type",u.contentType);y.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+Cc+"; q=0.01":""):u.accepts["*"]);for(n in u.headers)y.setRequestHeader(n,u.headers[n]);
if(u.beforeSend&&(!1===u.beforeSend.call(v,y,u)||r))return y.abort();if(x="abort",T.add(u.complete),y.done(u.success),y.fail(u.error),e=E(Kb,u,d,y)){if(y.readyState=1,s&&U.trigger("ajaxSend",[y,u]),r)return y;u.async&&0<u.timeout&&(j=b.setTimeout(function(){y.abort("timeout")},u.timeout));try{r=!1,e.send(ga,g)}catch(K){if(r)throw K;g(-1,K)}}else g(-1,"No Transport");return y},getJSON:function(b,c,d){return q.get(b,c,d,"json")},getScript:function(b,c){return q.get(b,void 0,c,"script")}});q.each(["get",
"post"],function(b,c){q[c]=function(b,d,g,e){return q.isFunction(d)&&(e=e||g,g=d,d=void 0),q.ajax(q.extend({url:b,type:c,dataType:e,data:d,success:g},q.isPlainObject(b)&&b))}});q._evalUrl=function(b){return q.ajax({url:b,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})};q.fn.extend({wrapAll:function(b){var c;return this[0]&&(q.isFunction(b)&&(b=b.call(this[0])),c=q(b,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&c.insertBefore(this[0]),c.map(function(){for(var b=
this;b.firstElementChild;)b=b.firstElementChild;return b}).append(this)),this},wrapInner:function(b){return q.isFunction(b)?this.each(function(c){q(this).wrapInner(b.call(this,c))}):this.each(function(){var c=q(this),d=c.contents();d.length?d.wrapAll(b):c.append(b)})},wrap:function(b){var c=q.isFunction(b);return this.each(function(d){q(this).wrapAll(c?b.call(this,d):b)})},unwrap:function(b){return this.parent(b).not("body").each(function(){q(this).replaceWith(this.childNodes)}),this}});q.expr.pseudos.hidden=
function(b){return!q.expr.pseudos.visible(b)};q.expr.pseudos.visible=function(b){return!(!b.offsetWidth&&!b.offsetHeight&&!b.getClientRects().length)};q.ajaxSettings.xhr=function(){try{return new b.XMLHttpRequest}catch(c){}};var Ad={"0":200,1223:204},rb=q.ajaxSettings.xhr();ba.cors=!!rb&&"withCredentials"in rb;ba.ajax=rb=!!rb;q.ajaxTransport(function(c){var d,g;if(ba.cors||rb&&!c.crossDomain)return{send:function(e,f){var p,m=c.xhr();if(m.open(c.type,c.url,c.async,c.username,c.password),c.xhrFields)for(p in c.xhrFields)m[p]=
c.xhrFields[p];c.mimeType&&m.overrideMimeType&&m.overrideMimeType(c.mimeType);c.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(p in e)m.setRequestHeader(p,e[p]);d=function(b){return function(){d&&(d=g=m.onload=m.onerror=m.onabort=m.onreadystatechange=null,"abort"===b?m.abort():"error"===b?"number"!=typeof m.status?f(0,"error"):f(m.status,m.statusText):f(Ad[m.status]||m.status,m.statusText,"text"!==(m.responseType||"text")||"string"!=typeof m.responseText?{binary:m.response}:
{text:m.responseText},m.getAllResponseHeaders()))}};m.onload=d();g=m.onerror=d("error");void 0!==m.onabort?m.onabort=g:m.onreadystatechange=function(){4===m.readyState&&b.setTimeout(function(){d&&g()})};d=d("abort");try{m.send(c.hasContent&&c.data||null)}catch(j){if(d)throw j;}},abort:function(){d&&d()}}});q.ajaxPrefilter(function(b){b.crossDomain&&(b.contents.script=!1)});q.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},
converters:{"text script":function(b){return q.globalEval(b),b}}});q.ajaxPrefilter("script",function(b){void 0===b.cache&&(b.cache=!1);b.crossDomain&&(b.type="GET")});q.ajaxTransport("script",function(b){if(b.crossDomain){var c,d;return{send:function(g,e){c=q("<script>").prop({charset:b.scriptCharset,src:b.url}).on("load error",d=function(b){c.remove();d=null;b&&e("error"===b.type?404:200,b.type)});G.head.appendChild(c[0])},abort:function(){d&&d()}}}});var Dc=[],Vb=/(=)\?(?=&|$)|\?\?/;q.ajaxSetup({jsonp:"callback",
jsonpCallback:function(){var b=Dc.pop()||q.expando+"_"+zc++;return this[b]=!0,b}});q.ajaxPrefilter("json jsonp",function(c,d,g){var e,f,p,m=!1!==c.jsonp&&(Vb.test(c.url)?"url":"string"==typeof c.data&&0===(c.contentType||"").indexOf("application/x-www-form-urlencoded")&&Vb.test(c.data)&&"data");if(m||"jsonp"===c.dataTypes[0])return e=c.jsonpCallback=q.isFunction(c.jsonpCallback)?c.jsonpCallback():c.jsonpCallback,m?c[m]=c[m].replace(Vb,"$1"+e):!1!==c.jsonp&&(c.url+=(Tb.test(c.url)?"&":"?")+c.jsonp+
"="+e),c.converters["script json"]=function(){return p||q.error(e+" was not called"),p[0]},c.dataTypes[0]="json",f=b[e],b[e]=function(){p=arguments},g.always(function(){void 0===f?q(b).removeProp(e):b[e]=f;c[e]&&(c.jsonpCallback=d.jsonpCallback,Dc.push(e));p&&q.isFunction(f)&&f(p[0]);p=f=void 0}),"script"});var Bd=ba,Ec,Fc=G.implementation.createHTMLDocument("").body;Ec=(Fc.innerHTML="<form></form><form></form>",2===Fc.childNodes.length);Bd.createHTMLDocument=Ec;q.parseHTML=function(b,c,d){if("string"!=
typeof b)return[];"boolean"==typeof c&&(d=c,c=!1);var g,e,f;return c||(ba.createHTMLDocument?(c=G.implementation.createHTMLDocument(""),g=c.createElement("base"),g.href=G.location.href,c.head.appendChild(g)):c=G),e=lc.exec(b),f=!d&&[],e?[c.createElement(e[1])]:(e=x([b],c,f),f&&f.length&&q(f).remove(),q.merge([],e.childNodes))};q.fn.load=function(b,c,d){var g,e,f,p=this,m=b.indexOf(" ");return-1<m&&(g=la(b.slice(m)),b=b.slice(0,m)),q.isFunction(c)?(d=c,c=void 0):c&&"object"==typeof c&&(e="POST"),0<
p.length&&q.ajax({url:b,type:e||"GET",dataType:"html",data:c}).done(function(b){f=arguments;p.html(g?q("<div>").append(q.parseHTML(b)).find(g):b)}).always(d&&function(b,c){p.each(function(){d.apply(this,f||[b.responseText,c,b])})}),this};q.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(b,c){q.fn[c]=function(b){return this.on(c,b)}});q.expr.pseudos.animated=function(b){return q.grep(q.timers,function(c){return b===c.elem}).length};q.offset={setOffset:function(b,
c,d){var g,e,f,p,m,j,l=q.css(b,"position"),r=q(b),s={};"static"===l&&(b.style.position="relative");m=r.offset();f=q.css(b,"top");j=q.css(b,"left");("absolute"===l||"fixed"===l)&&-1<(f+j).indexOf("auto")?(g=r.position(),p=g.top,e=g.left):(p=parseFloat(f)||0,e=parseFloat(j)||0);q.isFunction(c)&&(c=c.call(b,d,q.extend({},m)));null!=c.top&&(s.top=c.top-m.top+p);null!=c.left&&(s.left=c.left-m.left+e);"using"in c?c.using.call(b,s):r.css(s)}};q.fn.extend({offset:function(b){if(arguments.length)return void 0===
b?this:this.each(function(c){q.offset.setOffset(this,b,c)});var c,d,g,e,f=this[0];if(f)return f.getClientRects().length?(g=f.getBoundingClientRect(),c=f.ownerDocument,d=c.documentElement,e=c.defaultView,{top:g.top+e.pageYOffset-d.clientTop,left:g.left+e.pageXOffset-d.clientLeft}):{top:0,left:0}},position:function(){if(this[0]){var b,c,d=this[0],g={top:0,left:0};return"fixed"===q.css(d,"position")?c=d.getBoundingClientRect():(b=this.offsetParent(),c=this.offset(),j(b[0],"html")||(g=b.offset()),g={top:g.top+
q.css(b[0],"borderTopWidth",!0),left:g.left+q.css(b[0],"borderLeftWidth",!0)}),{top:c.top-g.top-q.css(d,"marginTop",!0),left:c.left-g.left-q.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var b=this.offsetParent;b&&"static"===q.css(b,"position");)b=b.offsetParent;return b||Gb})}});q.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d="pageYOffset"===c;q.fn[b]=function(g){return Na(this,function(b,g,e){var f;return q.isWindow(b)?f=b:9===b.nodeType&&
(f=b.defaultView),void 0===e?f?f[c]:b[g]:void(f?f.scrollTo(d?f.pageXOffset:e,d?e:f.pageYOffset):b[g]=e)},b,g,arguments.length)}});q.each(["top","left"],function(b,c){q.cssHooks[c]=V(ba.pixelPosition,function(b,d){if(d)return d=K(b,c),Jb.test(d)?q(b).position()[c]+"px":d})});q.each({Height:"height",Width:"width"},function(b,c){q.each({padding:"inner"+b,content:c,"":"outer"+b},function(d,g){q.fn[g]=function(e,f){var p=arguments.length&&(d||"boolean"!=typeof e),m=d||(!0===e||!0===f?"margin":"border");
return Na(this,function(c,d,e){var f;return q.isWindow(c)?0===g.indexOf("outer")?c["inner"+b]:c.document.documentElement["client"+b]:9===c.nodeType?(f=c.documentElement,Math.max(c.body["scroll"+b],f["scroll"+b],c.body["offset"+b],f["offset"+b],f["client"+b])):void 0===e?q.css(c,d,m):q.style(c,d,e,m)},c,p?e:void 0,p)}})});q.fn.extend({bind:function(b,c,d){return this.on(b,null,c,d)},unbind:function(b,c){return this.off(b,null,c)},delegate:function(b,c,d,g){return this.on(c,b,d,g)},undelegate:function(b,
c,d){return 1===arguments.length?this.off(b,"**"):this.off(c,b||"**",d)}});q.holdReady=function(b){b?q.readyWait++:q.ready(!0)};q.isArray=Array.isArray;q.parseJSON=JSON.parse;q.nodeName=j;"function"==typeof define&&define.amd&&define("jquery",[],function(){return q});var Cd=b.jQuery,Dd=b.$;return q.noConflict=function(c){return b.$===q&&(b.$=Dd),c&&b.jQuery===q&&(b.jQuery=Cd),q},c||(b.jQuery=b.$=q),q});!function(b,c){"object"==typeof exports&&"undefined"!=typeof module?module.exports=c():"function"==typeof define&&define.amd?define(c):b.PointerEventsPolyfill=c()}(this,function(){function b(b,c){c=c||Object.create(null);var d=document.createEvent("Event");d.initEvent(b,c.bubbles||!1,c.cancelable||!1);for(var e,f=2;f<g.length;f++)e=g[f],d[e]=c[e]||m[f];d.buttons=c.buttons||0;e=0;return e=c.pressure&&d.buttons?c.pressure:d.buttons?0.5:0,d.x=d.clientX,d.y=d.clientY,d.pointerId=c.pointerId||0,d.width=
c.width||0,d.height=c.height||0,d.pressure=e,d.tiltX=c.tiltX||0,d.tiltY=c.tiltY||0,d.twist=c.twist||0,d.tangentialPressure=c.tangentialPressure||0,d.pointerType=c.pointerType||"",d.hwTimestamp=c.hwTimestamp||0,d.isPrimary=c.isPrimary||!1,d}function c(){this.array=[];this.size=0}function e(b,c,d,g){this.addCallback=b.bind(g);this.removeCallback=c.bind(g);this.changedCallback=d.bind(g);I&&(this.observer=new I(this.mutationWatcher.bind(this)))}function d(b){return"body /shadow-deep/ "+j(b)}function j(b){return'[touch-action="'+
b+'"]'}function f(b){return"{ -ms-touch-action: "+b+"; touch-action: "+b+"; }"}function n(b){if(!v.pointermap.has(b))throw b=Error("InvalidPointerId"),b.name="InvalidPointerId",b;}function l(b){for(var c=b.parentNode;c&&c!==b.ownerDocument;)c=c.parentNode;if(!c)throw b=Error("InvalidStateError"),b.name="InvalidStateError",b;}var g="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget pageX pageY".split(" "),m=[!1,!1,null,null,0,0,0,0,
!1,!1,!1,!1,0,null,0,0],p=window.Map&&window.Map.prototype.forEach?Map:c;c.prototype={set:function(b,c){return void 0===c?this["delete"](b):(this.has(b)||this.size++,void(this.array[b]=c))},has:function(b){return void 0!==this.array[b]},"delete":function(b){this.has(b)&&(delete this.array[b],this.size--)},get:function(b){return this.array[b]},clear:function(){this.size=this.array.length=0},forEach:function(b,c){return this.array.forEach(function(d,g){b.call(c,d,g,this)},this)}};var r="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget buttons pointerId width height pressure tiltX tiltY pointerType hwTimestamp isPrimary type target currentTarget which pageX pageY timeStamp".split(" "),
s=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],t={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},u="undefined"!=typeof SVGElementInstance,v={pointermap:new p,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(b,c){var d=c.events;d&&(d.forEach(function(b){c[b]&&(this.eventMap[b]=c[b].bind(c))},this),this.eventSources[b]=c,this.eventSourceList.push(c))},register:function(b){for(var c,
d=this.eventSourceList.length,g=0;g<d&&(c=this.eventSourceList[g]);g++)c.register.call(c,b)},unregister:function(b){for(var c,d=this.eventSourceList.length,g=0;g<d&&(c=this.eventSourceList[g]);g++)c.unregister.call(c,b)},contains:function(b,c){try{return b.contains(c)}catch(d){return!1}},down:function(b){b.bubbles=!0;this.fireEvent("pointerdown",b)},move:function(b){b.bubbles=!0;this.fireEvent("pointermove",b)},up:function(b){b.bubbles=!0;this.fireEvent("pointerup",b)},enter:function(b){b.bubbles=
!1;this.fireEvent("pointerenter",b)},leave:function(b){b.bubbles=!1;this.fireEvent("pointerleave",b)},over:function(b){b.bubbles=!0;this.fireEvent("pointerover",b)},out:function(b){b.bubbles=!0;this.fireEvent("pointerout",b)},cancel:function(b){b.bubbles=!0;this.fireEvent("pointercancel",b)},leaveOut:function(b){this.out(b);this.propagate(b,this.leave,!1)},enterOver:function(b){this.over(b);this.propagate(b,this.enter,!0)},eventHandler:function(b){if(!b._handledByPE){var c=b.type;(c=this.eventMap&&
this.eventMap[c])&&c(b);b._handledByPE=!0}},listen:function(b,c){c.forEach(function(c){this.addEvent(b,c)},this)},unlisten:function(b,c){c.forEach(function(c){this.removeEvent(b,c)},this)},addEvent:function(b,c){b.addEventListener(c,this.boundHandler)},removeEvent:function(b,c){b.removeEventListener(c,this.boundHandler)},makeEvent:function(c,d){this.captureInfo[d.pointerId]&&(d.relatedTarget=null);var g=new b(c,d);return d.preventDefault&&(g.preventDefault=d.preventDefault),g._target=g._target||d.target,
g},fireEvent:function(b,c){var d=this.makeEvent(b,c);return this.dispatchEvent(d)},cloneEvent:function(b){for(var c,d=Object.create(null),g=0;g<r.length;g++)c=r[g],d[c]=b[c]||s[g],!u||"target"!==c&&"relatedTarget"!==c||d[c]instanceof SVGElementInstance&&(d[c]=d[c].correspondingUseElement);return b.preventDefault&&(d.preventDefault=function(){b.preventDefault()}),d},getTarget:function(b){var c=this.captureInfo[b.pointerId];return c?b._target!==c&&b.type in t?void 0:c:b._target},propagate:function(b,
c,d){for(var g=b.target,e=[];g!==document&&!g.contains(b.relatedTarget);)if(e.push(g),g=g.parentNode,!g)return;d&&e.reverse();e.forEach(function(d){b.target=d;c.call(this,b)},this)},setCapture:function(c,d,g){this.captureInfo[c]&&this.releaseCapture(c,g);this.captureInfo[c]=d;this.implicitRelease=this.releaseCapture.bind(this,c,g);document.addEventListener("pointerup",this.implicitRelease);document.addEventListener("pointercancel",this.implicitRelease);var e=new b("gotpointercapture");e.pointerId=
c;e._target=d;g||this.asyncDispatchEvent(e)},releaseCapture:function(c,d){var g=this.captureInfo[c];if(g){this.captureInfo[c]=void 0;document.removeEventListener("pointerup",this.implicitRelease);document.removeEventListener("pointercancel",this.implicitRelease);var e=new b("lostpointercapture");e.pointerId=c;e._target=g;d||this.asyncDispatchEvent(e)}},dispatchEvent:function(b){var c=this.getTarget(b);if(c)return c.dispatchEvent(b)},asyncDispatchEvent:function(b){requestAnimationFrame(this.dispatchEvent.bind(this,
b))}};v.boundHandler=v.eventHandler.bind(v);var z={shadow:function(b){if(b)return b.shadowRoot||b.webkitShadowRoot},canTarget:function(b){return b&&Boolean(b.elementFromPoint)},targetingShadow:function(b){b=this.shadow(b);if(this.canTarget(b))return b},olderShadow:function(b){var c=b.olderShadowRoot;c||(b=b.querySelector("shadow"))&&(c=b.olderShadowRoot);return c},allShadows:function(b){var c=[];for(b=this.shadow(b);b;)c.push(b),b=this.olderShadow(b);return c},searchRoot:function(b,c,d){if(b){var g,
e=b.elementFromPoint(c,d);for(g=this.targetingShadow(e);g;){if(b=g.elementFromPoint(c,d))return g=this.targetingShadow(b),this.searchRoot(g,c,d)||b;g=this.olderShadow(g)}return e}},owner:function(b){for(;b.parentNode;)b=b.parentNode;return b.nodeType!==Node.DOCUMENT_NODE&&b.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(b=document),b},findTarget:function(b){var c=b.clientX,d=b.clientY;b=this.owner(b.target);return b.elementFromPoint(c,d)||(b=document),this.searchRoot(b,c,d)}},x=Array.prototype.forEach.call.bind(Array.prototype.forEach),
B=Array.prototype.map.call.bind(Array.prototype.map),A=Array.prototype.slice.call.bind(Array.prototype.slice),D=Array.prototype.filter.call.bind(Array.prototype.filter),I=window.MutationObserver||window.WebKitMutationObserver,y={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};e.prototype={watchSubtree:function(b){this.observer&&z.canTarget(b)&&this.observer.observe(b,y)},enableOnSubtree:function(b){this.watchSubtree(b);b===document&&"complete"!==document.readyState?
this.installOnLoad():this.installNewSubtree(b)},installNewSubtree:function(b){x(this.findElements(b),this.addElement,this)},findElements:function(b){return b.querySelectorAll?b.querySelectorAll("[touch-action]"):[]},removeElement:function(b){this.removeCallback(b)},addElement:function(b){this.addCallback(b)},elementChanged:function(b,c){this.changedCallback(b,c)},concatLists:function(b,c){return b.concat(A(c))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===
document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(b){return b.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(b){var c=B(b,this.findElements,this);return c.push(D(b,this.isElement)),c.reduce(this.concatLists,[])},mutationWatcher:function(b){b.forEach(this.mutationHandler,this)},mutationHandler:function(b){"childList"===b.type?(this.flattenMutationTree(b.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(b.removedNodes).forEach(this.removeElement,
this)):"attributes"===b.type&&this.elementChanged(b.target,b.oldValue)}};var C=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],J="",M=window.PointerEvent||window.MSPointerEvent,O=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,N=v.pointermap,K=[1,4,2,8,16],V=!1;try{V=1===(new MouseEvent("test",{buttons:1})).buttons}catch(da){}var F,H={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(b){v.listen(b,
this.events)},unregister:function(b){v.unlisten(b,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(b){var c,d=this.lastTouches,g=b.clientX;b=b.clientY;for(var e=0,f=d.length;e<f&&(c=d[e]);e++){var p=Math.abs(g-c.x),m=Math.abs(b-c.y);if(25>=p&&25>=m)return!0}},prepareEvent:function(b){var c=v.cloneEvent(b),d=c.preventDefault;return c.preventDefault=function(){b.preventDefault();d()},c.pointerId=this.POINTER_ID,c.isPrimary=!0,c.pointerType=this.POINTER_TYPE,c},prepareButtonsForMove:function(b,
c){var d=N.get(this.POINTER_ID);0!==c.which&&d?b.buttons=d.buttons:b.buttons=0;c.buttons=b.buttons},mousedown:function(b){if(!this.isEventSimulatedFromTouch(b)){var c=N.get(this.POINTER_ID),d=this.prepareEvent(b);V||(d.buttons=K[d.button],c&&(d.buttons|=c.buttons),b.buttons=d.buttons);N.set(this.POINTER_ID,b);c&&0!==c.buttons?v.move(d):v.down(d)}},mousemove:function(b){if(!this.isEventSimulatedFromTouch(b)){var c=this.prepareEvent(b);V||this.prepareButtonsForMove(c,b);c.button=-1;N.set(this.POINTER_ID,
b);v.move(c)}},mouseup:function(b){if(!this.isEventSimulatedFromTouch(b)){var c=N.get(this.POINTER_ID),d=this.prepareEvent(b);if(!V){var g=K[d.button];d.buttons=c?c.buttons&~g:0;b.buttons=d.buttons}N.set(this.POINTER_ID,b);d.buttons&=~K[d.button];0===d.buttons?v.up(d):v.move(d)}},mouseover:function(b){if(!this.isEventSimulatedFromTouch(b)){var c=this.prepareEvent(b);V||this.prepareButtonsForMove(c,b);c.button=-1;N.set(this.POINTER_ID,b);v.enterOver(c)}},mouseout:function(b){if(!this.isEventSimulatedFromTouch(b)){var c=
this.prepareEvent(b);V||this.prepareButtonsForMove(c,b);c.button=-1;v.leaveOut(c)}},cancel:function(b){b=this.prepareEvent(b);v.cancel(b);this.deactivateMouse()},deactivateMouse:function(){N["delete"](this.POINTER_ID)}},ia=v.captureInfo,R=z.findTarget.bind(z),L=z.allShadows.bind(z),T=v.pointermap,Q={events:["touchstart","touchmove","touchend","touchcancel"],register:function(b){F.enableOnSubtree(b)},unregister:function(){},elementAdded:function(b){var c=b.getAttribute("touch-action"),d=this.touchActionToScrollType(c);
d&&(b._scrollType=d,v.listen(b,this.events),L(b).forEach(function(b){b._scrollType=d;v.listen(b,this.events)},this))},elementRemoved:function(b){b._scrollType=void 0;v.unlisten(b,this.events);L(b).forEach(function(b){b._scrollType=void 0;v.unlisten(b,this.events)},this)},elementChanged:function(b,c){var d=b.getAttribute("touch-action"),g=this.touchActionToScrollType(d),d=this.touchActionToScrollType(c);g&&d?(b._scrollType=g,L(b).forEach(function(b){b._scrollType=g},this)):d?this.elementRemoved(b):
g&&this.elementAdded(b)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(b){var c=this.scrollTypes;return"none"===b?"none":b===c.XSCROLLER?"X":b===c.YSCROLLER?"Y":c.SCROLLER.exec(b)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(b){return this.firstTouch===b.identifier},setPrimaryTouch:function(b){(0===T.size||1===T.size&&T.has(1))&&(this.firstTouch=b.identifier,this.firstXY=
{X:b.clientX,Y:b.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(b){b.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var b=function(){this.clickCount=0;this.resetId=null}.bind(this);this.resetId=setTimeout(b,200)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(b){return 0},touchToPointer:function(b){var c=this.currentTouchEvent,
d=v.cloneEvent(b),g=d.pointerId=b.identifier+2;d.target=ia[g]||R(d);d.bubbles=!0;d.cancelable=!0;d.detail=this.clickCount;d.button=0;d.buttons=this.typeToButtons(c.type);d.width=2*(b.radiusX||b.webkitRadiusX||0);d.height=2*(b.radiusY||b.webkitRadiusY||0);d.pressure=b.force||b.webkitForce||0.5;d.isPrimary=this.isPrimaryTouch(b);d.pointerType=this.POINTER_TYPE;d.altKey=c.altKey;d.ctrlKey=c.ctrlKey;d.metaKey=c.metaKey;d.shiftKey=c.shiftKey;var e=this;return d.preventDefault=function(){e.scrolling=!1;
e.firstXY=null;c.preventDefault()},d},processTouches:function(b,c){var d=b.changedTouches;this.currentTouchEvent=b;for(var g,e=0;e<d.length;e++)g=d[e],c.call(this,this.touchToPointer(g))},shouldScroll:function(b){if(this.firstXY){var c;c=b.currentTarget._scrollType;if("none"===c)c=!1;else if("XY"===c)c=!0;else{b=b.changedTouches[0];var d="Y"===c?"X":"Y";c=Math.abs(b["client"+c]-this.firstXY[c]);b=Math.abs(b["client"+d]-this.firstXY[d]);c=c>=b}return this.firstXY=null,c}},findTouch:function(b,c){for(var d,
g=0,e=b.length;g<e&&(d=b[g]);g++)if(d.identifier===c)return!0},vacuumTouches:function(b){var c=b.touches;if(T.size>=c.length){var d=[];T.forEach(function(b,g){1!==g&&!this.findTouch(c,g-2)&&d.push(b.out)},this);d.forEach(this.cancelOut,this)}},touchstart:function(b){this.vacuumTouches(b);this.setPrimaryTouch(b.changedTouches[0]);this.dedupSynthMouse(b);this.scrolling||(this.clickCount++,this.processTouches(b,this.overDown))},overDown:function(b){T.set(b.pointerId,{target:b.target,out:b,outTarget:b.target});
v.enterOver(b);v.down(b)},touchmove:function(b){this.scrolling||(this.shouldScroll(b)?(this.scrolling=!0,this.touchcancel(b)):(b.preventDefault(),this.processTouches(b,this.moveOverOut)))},moveOverOut:function(b){var c=T.get(b.pointerId);if(c){var d=c.out,g=c.outTarget;v.move(b);d&&g!==b.target&&(d.relatedTarget=b.target,b.relatedTarget=g,d.target=g,b.target?(v.leaveOut(d),v.enterOver(b)):(b.target=g,b.relatedTarget=null,this.cancelOut(b)));c.out=b;c.outTarget=b.target}},touchend:function(b){this.dedupSynthMouse(b);
this.processTouches(b,this.upOut)},upOut:function(b){this.scrolling||(v.up(b),v.leaveOut(b));this.cleanUpPointer(b)},touchcancel:function(b){this.processTouches(b,this.cancelOut)},cancelOut:function(b){v.cancel(b);v.leaveOut(b);this.cleanUpPointer(b)},cleanUpPointer:function(b){T["delete"](b.pointerId);this.removePrimaryPointer(b)},dedupSynthMouse:function(b){var c=H.lastTouches;b=b.changedTouches[0];this.isPrimaryTouch(b)&&(b={x:b.clientX,y:b.clientY},c.push(b),c=function(b,c){var d=b.indexOf(c);
-1<d&&b.splice(d,1)}.bind(null,c,b),setTimeout(c,2500))}};F=new e(Q.elementAdded,Q.elementRemoved,Q.elementChanged,Q);var Z,aa,la,qa=v.pointermap,ea=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,oa={events:"MSPointerDown MSPointerMove MSPointerUp MSPointerOut MSPointerOver MSPointerCancel MSGotPointerCapture MSLostPointerCapture".split(" "),register:function(b){v.listen(b,this.events)},unregister:function(b){v.unlisten(b,this.events)},POINTER_TYPES:["","unavailable",
"touch","pen","mouse"],prepareEvent:function(b){var c=b;return ea&&(c=v.cloneEvent(b),c.pointerType=this.POINTER_TYPES[b.pointerType]),c},cleanup:function(b){qa["delete"](b)},MSPointerDown:function(b){qa.set(b.pointerId,b);b=this.prepareEvent(b);v.down(b)},MSPointerMove:function(b){b=this.prepareEvent(b);v.move(b)},MSPointerUp:function(b){var c=this.prepareEvent(b);v.up(c);this.cleanup(b.pointerId)},MSPointerOut:function(b){b=this.prepareEvent(b);v.leaveOut(b)},MSPointerOver:function(b){b=this.prepareEvent(b);
v.enterOver(b)},MSPointerCancel:function(b){var c=this.prepareEvent(b);v.cancel(c);this.cleanup(b.pointerId)},MSLostPointerCapture:function(b){b=v.makeEvent("lostpointercapture",b);v.dispatchEvent(b)},MSGotPointerCapture:function(b){b=v.makeEvent("gotpointercapture",b);v.dispatchEvent(b)}};window.navigator.msPointerEnabled?(Z=function(b){n(b);l(this);0!==v.pointermap.get(b).buttons&&(v.setCapture(b,this,!0),this.msSetPointerCapture(b))},aa=function(b){n(b);v.releaseCapture(b,!0);this.msReleasePointerCapture(b)}):
(Z=function(b){n(b);l(this);0!==v.pointermap.get(b).buttons&&v.setCapture(b,this)},aa=function(b){n(b);v.releaseCapture(b)});la=function(b){return!!v.captureInfo[b]};M&&(C.forEach(function(b){String(b)===b?(J+=j(b)+f(b)+"\n",O&&(J+=d(b)+f(b)+"\n")):(J+=b.selectors.map(j)+f(b.rule)+"\n",O&&(J+=b.selectors.map(d)+f(b.rule)+"\n"))}),C=document.createElement("style"),C.textContent=J,document.head.appendChild(C));window.PointerEvent||((window.PointerEvent=b,window.navigator.msPointerEnabled)?(Object.defineProperty(window.navigator,
"maxTouchPoints",{value:window.navigator.msMaxTouchPoints,enumerable:!0}),v.registerSource("ms",oa)):(Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),v.registerSource("mouse",H),void 0!==window.ontouchstart&&v.registerSource("touch",Q)),v.register(document));window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:Z},releasePointerCapture:{value:aa},hasPointerCapture:{value:la}});return{dispatcher:v,
Installer:e,PointerEvent:b,PointerMap:p,targetFinding:z}});window.wgl={modules:{}};!function(b){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=b();else{var c;"undefined"!=typeof window?c=window:"undefined"!=typeof global?c=global:"undefined"!=typeof self&&(c=self);c.CANNON=b()}}(function(){return function c(e,d,j){function f(g,m){if(!d[g]){if(!e[g]){var p="function"==typeof require&&require;if(!m&&p)return p(g,!0);if(n)return n(g,!0);throw Error("Cannot find module '"+g+"'");}p=d[g]={exports:{}};e[g][0].call(p.exports,function(c){var d=e[g][1][c];return f(d?
d:c)},p,p.exports,c,e,d,j)}return d[g].exports}for(var n="function"==typeof require&&require,l=0;l<j.length;l++)f(j[l]);return f}({1:[function(c,e){e.exports={name:"cannon",version:"0.6.2",description:"A lightweight 3D physics engine written in JavaScript.",homepage:"https://github.com/schteppe/cannon.js",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["cannon.js","cannon","physics","engine","3d"],main:"./build/cannon.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/cannon.js.git"},
bugs:{url:"https://github.com/schteppe/cannon.js/issues"},licenses:[{type:"MIT"}],devDependencies:{jshint:"latest","uglify-js":"latest",nodeunit:"^0.9.0",grunt:"~0.4.0","grunt-contrib-jshint":"~0.1.1","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-concat":"~0.1.3","grunt-contrib-uglify":"^0.5.1","grunt-browserify":"^2.1.4","grunt-contrib-yuidoc":"^0.5.2",browserify:"*"},dependencies:{}}},{}],2:[function(c,e){e.exports={version:c("../package.json").version,AABB:c("./collision/AABB"),ArrayCollisionMatrix:c("./collision/ArrayCollisionMatrix"),
Body:c("./objects/Body"),Box:c("./shapes/Box"),Broadphase:c("./collision/Broadphase"),Constraint:c("./constraints/Constraint"),ContactEquation:c("./equations/ContactEquation"),Narrowphase:c("./world/Narrowphase"),ConeTwistConstraint:c("./constraints/ConeTwistConstraint"),ContactMaterial:c("./material/ContactMaterial"),ConvexPolyhedron:c("./shapes/ConvexPolyhedron"),Cylinder:c("./shapes/Cylinder"),DistanceConstraint:c("./constraints/DistanceConstraint"),Equation:c("./equations/Equation"),EventTarget:c("./utils/EventTarget"),
FrictionEquation:c("./equations/FrictionEquation"),GSSolver:c("./solver/GSSolver"),GridBroadphase:c("./collision/GridBroadphase"),Heightfield:c("./shapes/Heightfield"),HingeConstraint:c("./constraints/HingeConstraint"),LockConstraint:c("./constraints/LockConstraint"),Mat3:c("./math/Mat3"),Material:c("./material/Material"),NaiveBroadphase:c("./collision/NaiveBroadphase"),ObjectCollisionMatrix:c("./collision/ObjectCollisionMatrix"),Pool:c("./utils/Pool"),Particle:c("./shapes/Particle"),Plane:c("./shapes/Plane"),
PointToPointConstraint:c("./constraints/PointToPointConstraint"),Quaternion:c("./math/Quaternion"),Ray:c("./collision/Ray"),RaycastVehicle:c("./objects/RaycastVehicle"),RaycastResult:c("./collision/RaycastResult"),RigidVehicle:c("./objects/RigidVehicle"),RotationalEquation:c("./equations/RotationalEquation"),RotationalMotorEquation:c("./equations/RotationalMotorEquation"),SAPBroadphase:c("./collision/SAPBroadphase"),SPHSystem:c("./objects/SPHSystem"),Shape:c("./shapes/Shape"),Solver:c("./solver/Solver"),
Sphere:c("./shapes/Sphere"),SplitSolver:c("./solver/SplitSolver"),Spring:c("./objects/Spring"),Trimesh:c("./shapes/Trimesh"),Vec3:c("./math/Vec3"),Vec3Pool:c("./utils/Vec3Pool"),World:c("./world/World")}},{"../package.json":1,"./collision/AABB":3,"./collision/ArrayCollisionMatrix":4,"./collision/Broadphase":5,"./collision/GridBroadphase":6,"./collision/NaiveBroadphase":7,"./collision/ObjectCollisionMatrix":8,"./collision/Ray":9,"./collision/RaycastResult":10,"./collision/SAPBroadphase":11,"./constraints/ConeTwistConstraint":12,
"./constraints/Constraint":13,"./constraints/DistanceConstraint":14,"./constraints/HingeConstraint":15,"./constraints/LockConstraint":16,"./constraints/PointToPointConstraint":17,"./equations/ContactEquation":19,"./equations/Equation":20,"./equations/FrictionEquation":21,"./equations/RotationalEquation":22,"./equations/RotationalMotorEquation":23,"./material/ContactMaterial":24,"./material/Material":25,"./math/Mat3":27,"./math/Quaternion":28,"./math/Vec3":30,"./objects/Body":31,"./objects/RaycastVehicle":32,
"./objects/RigidVehicle":33,"./objects/SPHSystem":34,"./objects/Spring":35,"./shapes/Box":37,"./shapes/ConvexPolyhedron":38,"./shapes/Cylinder":39,"./shapes/Heightfield":40,"./shapes/Particle":41,"./shapes/Plane":42,"./shapes/Shape":43,"./shapes/Sphere":44,"./shapes/Trimesh":45,"./solver/GSSolver":46,"./solver/Solver":47,"./solver/SplitSolver":48,"./utils/EventTarget":49,"./utils/Pool":51,"./utils/Vec3Pool":54,"./world/Narrowphase":55,"./world/World":56}],3:[function(c,e){function d(c){c=c||{};this.lowerBound=
new j;c.lowerBound&&this.lowerBound.copy(c.lowerBound);this.upperBound=new j;c.upperBound&&this.upperBound.copy(c.upperBound)}var j=c("../math/Vec3");c("../utils/Utils");e.exports=d;var f=new j;d.prototype.setFromPoints=function(c,d,e,p){var j=this.lowerBound,s=this.upperBound;j.copy(c[0]);e&&e.vmult(j,j);s.copy(j);for(var n=1;n<c.length;n++){var u=c[n];e&&(e.vmult(u,f),u=f);u.x>s.x&&(s.x=u.x);u.x<j.x&&(j.x=u.x);u.y>s.y&&(s.y=u.y);u.y<j.y&&(j.y=u.y);u.z>s.z&&(s.z=u.z);u.z<j.z&&(j.z=u.z)}d&&(d.vadd(j,
j),d.vadd(s,s));p&&(j.x-=p,j.y-=p,j.z-=p,s.x+=p,s.y+=p,s.z+=p);return this};d.prototype.copy=function(c){this.lowerBound.copy(c.lowerBound);this.upperBound.copy(c.upperBound);return this};d.prototype.clone=function(){return(new d).copy(this)};d.prototype.extend=function(c){var d=c.lowerBound.x;this.lowerBound.x>d&&(this.lowerBound.x=d);d=c.upperBound.x;this.upperBound.x<d&&(this.upperBound.x=d);d=c.lowerBound.y;this.lowerBound.y>d&&(this.lowerBound.y=d);d=c.upperBound.y;this.upperBound.y<d&&(this.upperBound.y=
d);d=c.lowerBound.z;this.lowerBound.z>d&&(this.lowerBound.z=d);d=c.upperBound.z;this.upperBound.z<d&&(this.upperBound.z=d)};d.prototype.overlaps=function(c){var d=this.lowerBound,e=this.upperBound,f=c.lowerBound;c=c.upperBound;return(f.x<=e.x&&e.x<=c.x||d.x<=c.x&&c.x<=e.x)&&(f.y<=e.y&&e.y<=c.y||d.y<=c.y&&c.y<=e.y)&&(f.z<=e.z&&e.z<=c.z||d.z<=c.z&&c.z<=e.z)};d.prototype.contains=function(c){var d=this.lowerBound,e=this.upperBound,f=c.lowerBound;c=c.upperBound;return d.x<=f.x&&e.x>=c.x&&d.y<=f.y&&e.y>=
c.y&&d.z<=f.z&&e.z>=c.z};d.prototype.getCorners=function(c,d,e,f,j,s,n,u){var v=this.lowerBound,z=this.upperBound;c.copy(v);d.set(z.x,v.y,v.z);e.set(z.x,z.y,v.z);f.set(v.x,z.y,z.z);j.set(z.x,v.y,v.z);s.set(v.x,z.y,v.z);n.set(v.x,v.y,z.z);u.copy(z)};var n=[new j,new j,new j,new j,new j,new j,new j,new j];d.prototype.toLocalFrame=function(c,d){this.getCorners(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]);for(var e=0;8!==e;e++){var f=n[e];c.pointToLocal(f,f)}return d.setFromPoints(n)};d.prototype.toWorldFrame=
function(c,d){this.getCorners(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]);for(var e=0;8!==e;e++){var f=n[e];c.pointToWorld(f,f)}return d.setFromPoints(n)}},{"../math/Vec3":30,"../utils/Utils":53}],4:[function(c,e){function d(){this.matrix=[]}e.exports=d;d.prototype.get=function(c,d){c=c.index;d=d.index;if(d>c){var e=d;d=c;c=e}return this.matrix[(c*(c+1)>>1)+d-1]};d.prototype.set=function(c,d,e){c=c.index;d=d.index;if(d>c){var l=d;d=c;c=l}this.matrix[(c*(c+1)>>1)+d-1]=e?1:0};d.prototype.reset=function(){for(var c=
0,d=this.matrix.length;c!==d;c++)this.matrix[c]=0};d.prototype.setNumObjects=function(c){this.matrix.length=c*(c-1)>>1}},{}],5:[function(c,e){function d(){this.world=null;this.useBoundingBoxes=!1;this.dirty=!0}var j=c("../objects/Body"),f=c("../math/Vec3"),n=c("../math/Quaternion");c("../shapes/Shape");c("../shapes/Plane");e.exports=d;d.prototype.collisionPairs=function(){throw Error("collisionPairs not implemented for this BroadPhase class!");};var l=j.STATIC|j.KINEMATIC;d.prototype.needBroadphaseCollision=
function(c,d){return 0===(c.collisionFilterGroup&d.collisionFilterMask)||0===(d.collisionFilterGroup&c.collisionFilterMask)||(0!==(c.type&l)||c.sleepState===j.SLEEPING)&&(0!==(d.type&l)||d.sleepState===j.SLEEPING)?!1:!0};d.prototype.intersectionTest=function(c,d,g,e){this.useBoundingBoxes?this.doBoundingBoxBroadphase(c,d,g,e):this.doBoundingSphereBroadphase(c,d,g,e)};var g=new f;new f;new n;new f;d.prototype.doBoundingSphereBroadphase=function(c,d,e,f){d.position.vsub(c.position,g);var p=Math.pow(c.boundingRadius+
d.boundingRadius,2);g.norm2()<p&&(e.push(c),f.push(d))};d.prototype.doBoundingBoxBroadphase=function(c,d,g,e){c.aabbNeedsUpdate&&c.computeAABB();d.aabbNeedsUpdate&&d.computeAABB();c.aabb.overlaps(d.aabb)&&(g.push(c),e.push(d))};var m={keys:[]},p=[],r=[];d.prototype.makePairsUnique=function(c,d){for(var g=c.length,e=0;e!==g;e++)p[e]=c[e],r[e]=d[e];c.length=0;for(e=d.length=0;e!==g;e++){var f=p[e].id,j=r[e].id,f=f<j?f+","+j:j+","+f;m[f]=e;m.keys.push(f)}for(e=0;e!==m.keys.length;e++)f=m.keys.pop(),
g=m[f],c.push(p[g]),d.push(r[g]),delete m[f]};d.prototype.setWorld=function(){};var s=new f;d.boundingSphereCheck=function(c,d){c.position.vsub(d.position,s);return Math.pow(c.shape.boundingSphereRadius+d.shape.boundingSphereRadius,2)>s.norm2()};d.prototype.aabbQuery=function(){console.warn(".aabbQuery is not implemented in this Broadphase subclass.");return[]}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Plane":42,"../shapes/Shape":43}],6:[function(c,e){function d(c,
d,e,l,s){j.apply(this);this.nx=e||10;this.ny=l||10;this.nz=s||10;this.aabbMin=c||new f(100,100,100);this.aabbMax=d||new f(-100,-100,-100);c=this.nx*this.ny*this.nz;if(0>=c)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[];this.binLengths=[];this.bins.length=c;this.binLengths.length=c;for(d=0;d<c;d++)this.bins[d]=[],this.binLengths[d]=0}e.exports=d;var j=c("./Broadphase"),f=c("../math/Vec3"),n=c("../shapes/Shape");d.prototype=new j;d.prototype.constructor=d;var l=new f;new f;d.prototype.collisionPairs=
function(c,d,e){function f(c,d,g,e,p,m,j){c=(c-J)*N|0;d=(d-M)*K|0;g=(g-O)*V|0;e=T((e-J)*N);p=T((p-M)*K);m=T((m-O)*V);0>c?c=0:c>=v&&(c=v-1);0>d?d=0:d>=z&&(d=z-1);0>g?g=0:g>=x&&(g=x-1);0>e?e=0:e>=v&&(e=v-1);0>p?p=0:p>=z&&(p=z-1);0>m?m=0:m>=x&&(m=x-1);c*=B;d*=A;g*=D;e*=B;p*=A;for(m*=D;c<=e;c+=B)for(var l=d;l<=p;l+=A)for(var r=g;r<=m;r+=D){var s=c+l+r;R[s][L[s]++]=j}}var j=c.numObjects();c=c.bodies;for(var t=this.aabbMax,u=this.aabbMin,v=this.nx,z=this.ny,x=this.nz,B=z*x,A=x,D=1,I=t.x,y=t.y,C=t.z,J=u.x,
M=u.y,O=u.z,N=v/(I-J),K=z/(y-M),V=x/(C-O),I=(I-J)/v,da=(y-M)/z,C=(C-O)/x,F=0.5*Math.sqrt(I*I+da*da+C*C),y=n.types,H=y.SPHERE,ia=y.PLANE,R=this.bins,L=this.binLengths,y=this.bins.length,u=0;u!==y;u++)L[u]=0;for(var T=Math.ceil,u=Math.min,t=Math.max,u=0;u!==j;u++){var t=c[u],Q=t.shape;switch(Q.type){case H:var Z=t.position.x,aa=t.position.y,la=t.position.z,Q=Q.radius;f(Z-Q,aa-Q,la-Q,Z+Q,aa+Q,la+Q,t);break;case ia:Q.worldNormalNeedsUpdate&&Q.computeWorldNormal(t.quaternion);var la=Q.worldNormal,Q=M+
0.5*da-t.position.y,qa=O+0.5*C-t.position.z,ea=l;ea.set(J+0.5*I-t.position.x,Q,qa);for(var oa=Z=0;Z!==v;Z++,oa+=B,ea.y=Q,ea.x+=I)for(var E=aa=0;aa!==z;aa++,E+=A,ea.z=qa,ea.y+=da)for(var U=0,ga=0;U!==x;U++,ga+=D,ea.z+=C)if(ea.dot(la)<F){var G=oa+E+ga;R[G][L[G]++]=t}break;default:t.aabbNeedsUpdate&&t.computeAABB(),f(t.aabb.lowerBound.x,t.aabb.lowerBound.y,t.aabb.lowerBound.z,t.aabb.upperBound.x,t.aabb.upperBound.y,t.aabb.upperBound.z,t)}}for(u=0;u!==y;u++)if(j=L[u],1<j){c=R[u];for(Z=0;Z!==j;Z++){t=
c[Z];for(aa=0;aa!==Z;aa++)I=c[aa],this.needBroadphaseCollision(t,I)&&this.intersectionTest(t,I,d,e)}}this.makePairsUnique(d,e)}},{"../math/Vec3":30,"../shapes/Shape":43,"./Broadphase":5}],7:[function(c,e){function d(){j.apply(this)}e.exports=d;var j=c("./Broadphase"),f=c("./AABB");d.prototype=new j;d.prototype.constructor=d;d.prototype.collisionPairs=function(c,d,g){c=c.bodies;var e=c.length,f,j,s,t;for(f=0;f!==e;f++)for(j=0;j!==f;j++)s=c[f],t=c[j],this.needBroadphaseCollision(s,t)&&this.intersectionTest(s,
t,d,g)};new f;d.prototype.aabbQuery=function(c,d,g){g=g||[];for(var e=0;e<c.bodies.length;e++){var f=c.bodies[e];f.aabbNeedsUpdate&&f.computeAABB();f.aabb.overlaps(d)&&g.push(f)}return g}},{"./AABB":3,"./Broadphase":5}],8:[function(c,e){function d(){this.matrix={}}e.exports=d;d.prototype.get=function(c,d){c=c.id;d=d.id;if(d>c){var e=d;d=c;c=e}return c+"-"+d in this.matrix};d.prototype.set=function(c,d,e){c=c.id;d=d.id;if(d>c){var l=d;d=c;c=l}e?this.matrix[c+"-"+d]=!0:delete this.matrix[c+"-"+d]};
d.prototype.reset=function(){this.matrix={}};d.prototype.setNumObjects=function(){}},{}],9:[function(c,e){function d(c,e){this.from=c?c.clone():new f;this.to=e?e.clone():new f;this._direction=new f;this.precision=1E-4;this.checkCollisionResponse=!0;this.skipBackfaces=!1;this.collisionFilterGroup=this.collisionFilterMask=-1;this.mode=d.ANY;this.result=new g;this.hasHit=!1;this.callback=function(){}}function j(c,d,g,e){e.vsub(d,R);g.vsub(d,t);c.vsub(d,u);c=R.dot(R);d=R.dot(t);g=R.dot(u);e=t.dot(t);
var f=t.dot(u),p,m;return 0<=(p=e*g-d*f)&&0<=(m=c*f-d*g)&&p+m<c*e-d*d}e.exports=d;var f=c("../math/Vec3"),n=c("../math/Quaternion"),l=c("../math/Transform");c("../shapes/ConvexPolyhedron");c("../shapes/Box");var g=c("../collision/RaycastResult"),m=c("../shapes/Shape"),p=c("../collision/AABB");d.prototype.constructor=d;d.CLOSEST=1;d.ANY=2;d.ALL=4;var r=new p,s=[];d.prototype.intersectWorld=function(c,e){this.mode=e.mode||d.ANY;this.result=e.result||new g;this.skipBackfaces=!!e.skipBackfaces;this.collisionFilterMask=
"undefined"!==typeof e.collisionFilterMask?e.collisionFilterMask:-1;this.collisionFilterGroup="undefined"!==typeof e.collisionFilterGroup?e.collisionFilterGroup:-1;e.from&&this.from.copy(e.from);e.to&&this.to.copy(e.to);this.callback=e.callback||function(){};this.hasHit=!1;this.result.reset();this._updateDirection();this.getAABB(r);s.length=0;c.broadphase.aabbQuery(c,r,s);this.intersectBodies(s);return this.hasHit};var t=new f,u=new f;d.pointInTriangle=j;var v=new f,z=new n;d.prototype.intersectBody=
function(c,d){d&&(this.result=d,this._updateDirection());var g=this.checkCollisionResponse;if(!g||c.collisionResponse)if(!(0===(this.collisionFilterGroup&c.collisionFilterMask)||0===(c.collisionFilterGroup&this.collisionFilterMask)))for(var e=0,f=c.shapes.length;e<f;e++){var p=c.shapes[e];if(!g||p.collisionResponse)if(c.quaternion.mult(c.shapeOrientations[e],z),c.quaternion.vmult(c.shapeOffsets[e],v),v.vadd(c.position,v),this.intersectShape(p,z,v,c),this.result._shouldStop)break}};d.prototype.intersectBodies=
function(c,d){d&&(this.result=d,this._updateDirection());for(var g=0,e=c.length;!this.result._shouldStop&&g<e;g++)this.intersectBody(c[g])};d.prototype._updateDirection=function(){this.to.vsub(this.from,this._direction);this._direction.normalize()};d.prototype.intersectShape=function(c,d,g,e){var f=this.from,p=this._direction;g.vsub(f,R);var m=R.dot(p);p.mult(m,L);L.vadd(f,L);g.distanceTo(L)>c.boundingSphereRadius||(f=this[c.type])&&f.call(this,c,d,g,e)};new f;new f;var x=new f,B=new f,A=new f,D=
new f;new f;new g;d.prototype.intersectBox=function(c,d,g,e){return this.intersectConvex(c.convexPolyhedronRepresentation,d,g,e)};d.prototype[m.types.BOX]=d.prototype.intersectBox;d.prototype.intersectPlane=function(c,d,g,e){var p=this.from,m=this.to,j=this._direction,l=new f(0,0,1);d.vmult(l,l);var r=new f;p.vsub(g,r);d=r.dot(l);m.vsub(g,r);r=r.dot(l);if(!(0<d*r)&&!(p.distanceTo(m)<d)&&(r=l.dot(j),!(Math.abs(r)<this.precision))){var s=new f,m=new f;d=new f;p.vsub(g,s);g=-l.dot(s)/r;j.scale(g,m);
p.vadd(m,d);this.reportIntersection(l,d,c,e,-1)}};d.prototype[m.types.PLANE]=d.prototype.intersectPlane;d.prototype.getAABB=function(c){var d=this.to,g=this.from;c.lowerBound.x=Math.min(d.x,g.x);c.lowerBound.y=Math.min(d.y,g.y);c.lowerBound.z=Math.min(d.z,g.z);c.upperBound.x=Math.max(d.x,g.x);c.upperBound.y=Math.max(d.y,g.y);c.upperBound.z=Math.max(d.z,g.z)};var I={faceList:[0]};d.prototype.intersectHeightfield=function(c,g,e,p){var m=new f,j=new d(this.from,this.to);l.pointToLocalFrame(e,g,j.from,
j.from);l.pointToLocalFrame(e,g,j.to,j.to);var r=[],s=null,n=null,t=null,u=null,v=c.getIndexOfPosition(j.from.x,j.from.y,r,!1);v&&(s=r[0],n=r[1],t=r[0],u=r[1]);if(v=c.getIndexOfPosition(j.to.x,j.to.y,r,!1)){if(null===s||r[0]<s)s=r[0];if(null===t||r[0]>t)t=r[0];if(null===n||r[1]<n)n=r[1];if(null===u||r[1]>u)u=r[1]}if(null!==s){c.getRectMinMax(s,n,t,u,[]);for(j=s;j<=t;j++)for(r=n;r<=u;r++){if(this.result._shouldStop)return;c.getConvexTrianglePillar(j,r,!1);l.pointToWorldFrame(e,g,c.pillarOffset,m);
this.intersectConvex(c.pillarConvex,g,m,p,I);if(this.result._shouldStop)return;c.getConvexTrianglePillar(j,r,!0);l.pointToWorldFrame(e,g,c.pillarOffset,m);this.intersectConvex(c.pillarConvex,g,m,p,I)}}};d.prototype[m.types.HEIGHTFIELD]=d.prototype.intersectHeightfield;var y=new f,C=new f;d.prototype.intersectSphere=function(c,d,g,e){d=this.from;var f=this.to,p=c.radius,m=Math.pow(f.x-d.x,2)+Math.pow(f.y-d.y,2)+Math.pow(f.z-d.z,2),j=2*((f.x-d.x)*(d.x-g.x)+(f.y-d.y)*(d.y-g.y)+(f.z-d.z)*(d.z-g.z)),p=
Math.pow(d.x-g.x,2)+Math.pow(d.y-g.y,2)+Math.pow(d.z-g.z,2)-Math.pow(p,2),l=Math.pow(j,2)-4*m*p;0>l||(0===l?(d.lerp(f,l,y),y.vsub(g,C),C.normalize(),this.reportIntersection(C,y,c,e,-1)):(p=(-j-Math.sqrt(l))/(2*m),m=(-j+Math.sqrt(l))/(2*m),0<=p&&1>=p&&(d.lerp(f,p,y),y.vsub(g,C),C.normalize(),this.reportIntersection(C,y,c,e,-1)),!this.result._shouldStop&&(0<=m&&1>=m)&&(d.lerp(f,m,y),y.vsub(g,C),C.normalize(),this.reportIntersection(C,y,c,e,-1))))};d.prototype[m.types.SPHERE]=d.prototype.intersectSphere;
var J=new f;new f;new f;var M=new f;d.prototype.intersectConvex=function(c,d,g,e,f){f=f&&f.faceList||null;for(var p=c.faces,m=c.vertices,l=c.faceNormals,r=this._direction,s=this.from,n=s.distanceTo(this.to),t=f?f.length:p.length,u=this.result,v=0;!u._shouldStop&&v<t;v++){var z=f?f[v]:v,y=p[z],L=l[z],K=d,F=g;M.copy(m[y[0]]);K.vmult(M,M);M.vadd(F,M);M.vsub(s,M);K.vmult(L,J);L=r.dot(J);if(!(Math.abs(L)<this.precision)&&(L=J.dot(M)/L,!(0>L))){r.mult(L,x);x.vadd(s,x);B.copy(m[y[0]]);K.vmult(B,B);F.vadd(B,
B);for(L=1;!u._shouldStop&&L<y.length-1;L++){A.copy(m[y[L]]);D.copy(m[y[L+1]]);K.vmult(A,A);K.vmult(D,D);F.vadd(A,A);F.vadd(D,D);var H=x.distanceTo(s);!j(x,B,A,D)&&!j(x,A,B,D)||H>n||this.reportIntersection(J,x,c,e,z)}}}};d.prototype[m.types.CONVEXPOLYHEDRON]=d.prototype.intersectConvex;var O=new f,N=new f,K=new f,V=new f,da=new f,F=new f;new p;var H=[],ia=new l;d.prototype.intersectTrimesh=function(c,d,g,e){var f=c.indices,p=this.from,m=this.to,r=this._direction;ia.position.copy(g);ia.quaternion.copy(d);
l.vectorToLocalFrame(g,d,r,N);l.pointToLocalFrame(g,d,p,K);l.pointToLocalFrame(g,d,m,V);p=K.distanceSquared(V);c.tree.rayQuery(this,ia,H);m=0;for(r=H.length;!this.result._shouldStop&&m!==r;m++){var s=H[m];c.getNormal(s,O);c.getVertex(f[3*s],B);B.vsub(K,M);var n=N.dot(O),n=O.dot(M)/n;0>n||(N.scale(n,x),x.vadd(K,x),c.getVertex(f[3*s+1],A),c.getVertex(f[3*s+2],D),n=x.distanceSquared(K),!j(x,A,B,D)&&!j(x,B,A,D)||n>p||(l.vectorToWorldFrame(d,O,da),l.pointToWorldFrame(g,d,x,F),this.reportIntersection(da,
F,c,e,s)))}H.length=0};d.prototype[m.types.TRIMESH]=d.prototype.intersectTrimesh;d.prototype.reportIntersection=function(c,g,e,f,p){var m=this.from,j=this.to,l=m.distanceTo(g),r=this.result;if(!(this.skipBackfaces&&0<c.dot(this._direction)))switch(r.hitFaceIndex="undefined"!==typeof p?p:-1,this.mode){case d.ALL:this.hasHit=!0;r.set(m,j,c,g,e,f,l);r.hasHit=!0;this.callback(r);break;case d.CLOSEST:if(l<r.distance||!r.hasHit)this.hasHit=!0,r.hasHit=!0,r.set(m,j,c,g,e,f,l);break;case d.ANY:this.hasHit=
!0,r.hasHit=!0,r.set(m,j,c,g,e,f,l),r._shouldStop=!0}};var R=new f,L=new f},{"../collision/AABB":3,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/Box":37,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43}],10:[function(c,e){function d(){this.rayFromWorld=new j;this.rayToWorld=new j;this.hitNormalWorld=new j;this.hitPointWorld=new j;this.hasHit=!1;this.body=this.shape=null;this.distance=this.hitFaceIndex=-1;this._shouldStop=!1}var j=c("../math/Vec3");
e.exports=d;d.prototype.reset=function(){this.rayFromWorld.setZero();this.rayToWorld.setZero();this.hitNormalWorld.setZero();this.hitPointWorld.setZero();this.hasHit=!1;this.body=this.shape=null;this.distance=this.hitFaceIndex=-1;this._shouldStop=!1};d.prototype.abort=function(){this._shouldStop=!0};d.prototype.set=function(c,d,e,g,m,p,j){this.rayFromWorld.copy(c);this.rayToWorld.copy(d);this.hitNormalWorld.copy(e);this.hitPointWorld.copy(g);this.shape=m;this.body=p;this.distance=j}},{"../math/Vec3":30}],
11:[function(c,e){function d(c){j.apply(this);this.axisList=[];this.world=null;this.axisIndex=0;var d=this.axisList;this._addBodyHandler=function(c){d.push(c.body)};this._removeBodyHandler=function(c){c=d.indexOf(c.body);-1!==c&&d.splice(c,1)};c&&this.setWorld(c)}c("../shapes/Shape");var j=c("../collision/Broadphase");e.exports=d;d.prototype=new j;d.prototype.setWorld=function(c){for(var d=this.axisList.length=0;d<c.bodies.length;d++)this.axisList.push(c.bodies[d]);c.removeEventListener("addBody",
this._addBodyHandler);c.removeEventListener("removeBody",this._removeBodyHandler);c.addEventListener("addBody",this._addBodyHandler);c.addEventListener("removeBody",this._removeBodyHandler);this.world=c;this.dirty=!0};d.insertionSortX=function(c){for(var d=1,e=c.length;d<e;d++){for(var g=c[d],m=d-1;0<=m&&!(c[m].aabb.lowerBound.x<=g.aabb.lowerBound.x);m--)c[m+1]=c[m];c[m+1]=g}return c};d.insertionSortY=function(c){for(var d=1,e=c.length;d<e;d++){for(var g=c[d],m=d-1;0<=m&&!(c[m].aabb.lowerBound.y<=
g.aabb.lowerBound.y);m--)c[m+1]=c[m];c[m+1]=g}return c};d.insertionSortZ=function(c){for(var d=1,e=c.length;d<e;d++){for(var g=c[d],m=d-1;0<=m&&!(c[m].aabb.lowerBound.z<=g.aabb.lowerBound.z);m--)c[m+1]=c[m];c[m+1]=g}return c};d.prototype.collisionPairs=function(c,e,j){c=this.axisList;var g=c.length,m=this.axisIndex,p,r;this.dirty&&(this.sortList(),this.dirty=!1);for(p=0;p!==g;p++){var s=c[p];for(r=p+1;r<g;r++){var t=c[r];if(this.needBroadphaseCollision(s,t)){if(!d.checkBounds(s,t,m))break;this.intersectionTest(s,
t,e,j)}}}};d.prototype.sortList=function(){for(var c=this.axisList,e=this.axisIndex,j=c.length,g=0;g!==j;g++){var m=c[g];m.aabbNeedsUpdate&&m.computeAABB()}0===e?d.insertionSortX(c):1===e?d.insertionSortY(c):2===e&&d.insertionSortZ(c)};d.checkBounds=function(c,d,e){var g,m;0===e?(g=c.position.x,m=d.position.x):1===e?(g=c.position.y,m=d.position.y):2===e&&(g=c.position.z,m=d.position.z);return m-d.boundingRadius<g+c.boundingRadius};d.prototype.autoDetectAxis=function(){for(var c=0,d=0,e=0,g=0,m=0,
p=0,j=this.axisList,s=j.length,t=1/s,u=0;u!==s;u++)var v=j[u],z=v.position.x,c=c+z,d=d+z*z,z=v.position.y,e=e+z,g=g+z*z,v=v.position.z,m=m+v,p=p+v*v;c=d-c*c*t;e=g-e*e*t;m=p-m*m*t;this.axisIndex=c>e?c>m?0:2:e>m?1:2};d.prototype.aabbQuery=function(c,d,e){e=e||[];this.dirty&&(this.sortList(),this.dirty=!1);c=this.axisList;for(var g=0;g<c.length;g++){var m=c[g];m.aabbNeedsUpdate&&m.computeAABB();m.aabb.overlaps(d)&&e.push(m)}return e}},{"../collision/Broadphase":5,"../shapes/Shape":43}],12:[function(c,
e){function d(c,d,e){e=e||{};var r="undefined"!==typeof e.maxForce?e.maxForce:1E6,s=e.pivotA?e.pivotA.clone():new l,t=e.pivotB?e.pivotB.clone():new l;this.axisA=e.axisA?e.axisA.clone():new l;this.axisB=e.axisB?e.axisB.clone():new l;j.call(this,c,s,d,t,r);this.collideConnected=!!e.collideConnected;this.angle="undefined"!==typeof e.angle?e.angle:0;s=this.coneEquation=new f(c,d,e);c=this.twistEquation=new n(c,d,e);this.twistAngle="undefined"!==typeof e.twistAngle?e.twistAngle:0;s.maxForce=0;s.minForce=
-r;c.maxForce=0;c.minForce=-r;this.equations.push(s,c)}e.exports=d;c("./Constraint");var j=c("./PointToPointConstraint"),f=c("../equations/ConeEquation"),n=c("../equations/RotationalEquation");c("../equations/ContactEquation");var l=c("../math/Vec3");d.prototype=new j;d.constructor=d;new l;new l;d.prototype.update=function(){var c=this.bodyA,d=this.bodyB,e=this.coneEquation,f=this.twistEquation;j.prototype.update.call(this);c.vectorToWorldFrame(this.axisA,e.axisA);d.vectorToWorldFrame(this.axisB,
e.axisB);this.axisA.tangents(f.axisA,f.axisA);c.vectorToWorldFrame(f.axisA,f.axisA);this.axisB.tangents(f.axisB,f.axisB);d.vectorToWorldFrame(f.axisB,f.axisB);e.angle=this.angle;f.maxAngle=this.twistAngle}},{"../equations/ConeEquation":18,"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],13:[function(c,e){function d(c,e,l){l=j.defaults(l,{collideConnected:!0,wakeUpBodies:!0});this.equations=[];this.bodyA=c;this.bodyB=
e;this.id=d.idCounter++;this.collideConnected=l.collideConnected;l.wakeUpBodies&&(c&&c.wakeUp(),e&&e.wakeUp())}e.exports=d;var j=c("../utils/Utils");d.prototype.update=function(){throw Error("method update() not implmemented in this Constraint subclass!");};d.prototype.enable=function(){for(var c=this.equations,d=0;d<c.length;d++)c[d].enabled=!0};d.prototype.disable=function(){for(var c=this.equations,d=0;d<c.length;d++)c[d].enabled=!1};d.idCounter=0},{"../utils/Utils":53}],14:[function(c,e){function d(c,
d,g,e){j.call(this,c,d);"undefined"===typeof g&&(g=c.position.distanceTo(d.position));"undefined"===typeof e&&(e=1E6);this.distance=g;c=this.distanceEquation=new f(c,d);this.equations.push(c);c.minForce=-e;c.maxForce=e}e.exports=d;var j=c("./Constraint"),f=c("../equations/ContactEquation");d.prototype=new j;d.prototype.update=function(){var c=this.distanceEquation,d=0.5*this.distance,g=c.ni;this.bodyB.position.vsub(this.bodyA.position,g);g.normalize();g.mult(d,c.ri);g.mult(-d,c.rj)}},{"../equations/ContactEquation":19,
"./Constraint":13}],15:[function(c,e){function d(c,d,g){g=g||{};var e="undefined"!==typeof g.maxForce?g.maxForce:1E6,m=g.pivotA?g.pivotA.clone():new l,v=g.pivotB?g.pivotB.clone():new l;j.call(this,c,m,d,v,e);(this.axisA=g.axisA?g.axisA.clone():new l(1,0,0)).normalize();(this.axisB=g.axisB?g.axisB.clone():new l(1,0,0)).normalize();m=this.rotationalEquation1=new f(c,d,g);g=this.rotationalEquation2=new f(c,d,g);c=this.motorEquation=new n(c,d,e);c.enabled=!1;this.equations.push(m,g,c)}e.exports=d;c("./Constraint");
var j=c("./PointToPointConstraint"),f=c("../equations/RotationalEquation"),n=c("../equations/RotationalMotorEquation");c("../equations/ContactEquation");var l=c("../math/Vec3");d.prototype=new j;d.constructor=d;d.prototype.enableMotor=function(){this.motorEquation.enabled=!0};d.prototype.disableMotor=function(){this.motorEquation.enabled=!1};d.prototype.setMotorSpeed=function(c){this.motorEquation.targetVelocity=c};d.prototype.setMotorMaxForce=function(c){this.motorEquation.maxForce=c;this.motorEquation.minForce=
-c};var g=new l,m=new l;d.prototype.update=function(){var c=this.bodyA,d=this.bodyB,e=this.motorEquation,f=this.rotationalEquation1,l=this.rotationalEquation2,n=this.axisA,z=this.axisB;j.prototype.update.call(this);c.quaternion.vmult(n,g);d.quaternion.vmult(z,m);g.tangents(f.axisA,l.axisA);f.axisB.copy(m);l.axisB.copy(m);this.motorEquation.enabled&&(c.quaternion.vmult(this.axisA,e.axisA),d.quaternion.vmult(this.axisB,e.axisB))}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,
"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],16:[function(c,e){function d(c,d,e){e=e||{};var p="undefined"!==typeof e.maxForce?e.maxForce:1E6,r=new n,s=new n,t=new n;c.position.vadd(d.position,t);t.scale(0.5,t);d.pointToLocalFrame(t,s);c.pointToLocalFrame(t,r);j.call(this,c,r,d,s,p);p=this.rotationalEquation1=new f(c,d,e);r=this.rotationalEquation2=new f(c,d,e);c=this.rotationalEquation3=new f(c,d,e);this.equations.push(p,r,c)}e.exports=
d;c("./Constraint");var j=c("./PointToPointConstraint"),f=c("../equations/RotationalEquation");c("../equations/RotationalMotorEquation");c("../equations/ContactEquation");var n=c("../math/Vec3");d.prototype=new j;d.constructor=d;new n;new n;d.prototype.update=function(){var c=this.bodyA,d=this.bodyB,e=this.rotationalEquation1,f=this.rotationalEquation2,r=this.rotationalEquation3;j.prototype.update.call(this);c.vectorToWorldFrame(n.UNIT_X,e.axisA);d.vectorToWorldFrame(n.UNIT_Y,e.axisB);c.vectorToWorldFrame(n.UNIT_Y,
f.axisA);d.vectorToWorldFrame(n.UNIT_Z,f.axisB);c.vectorToWorldFrame(n.UNIT_Z,r.axisA);d.vectorToWorldFrame(n.UNIT_X,r.axisB)}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],17:[function(c,e){function d(c,d,e,p,r){j.call(this,c,e);r="undefined"!==typeof r?r:1E6;this.pivotA=d?d.clone():new n;this.pivotB=p?p.clone():new n;d=this.equationX=new f(c,e);p=this.equationY=
new f(c,e);c=this.equationZ=new f(c,e);this.equations.push(d,p,c);d.minForce=p.minForce=c.minForce=-r;d.maxForce=p.maxForce=c.maxForce=r;d.ni.set(1,0,0);p.ni.set(0,1,0);c.ni.set(0,0,1)}e.exports=d;var j=c("./Constraint"),f=c("../equations/ContactEquation"),n=c("../math/Vec3");d.prototype=new j;d.prototype.update=function(){var c=this.bodyB,d=this.equationX,e=this.equationY,f=this.equationZ;this.bodyA.quaternion.vmult(this.pivotA,d.ri);c.quaternion.vmult(this.pivotB,d.rj);e.ri.copy(d.ri);e.rj.copy(d.rj);
f.ri.copy(d.ri);f.rj.copy(d.rj)}},{"../equations/ContactEquation":19,"../math/Vec3":30,"./Constraint":13}],18:[function(c,e){function d(c,d,e){e=e||{};var l="undefined"!==typeof e.maxForce?e.maxForce:1E6;f.call(this,c,d,-l,l);this.axisA=e.axisA?e.axisA.clone():new j(1,0,0);this.axisB=e.axisB?e.axisB.clone():new j(0,1,0);this.angle="undefined"!==typeof e.angle?e.angle:0}e.exports=d;var j=c("../math/Vec3");c("../math/Mat3");var f=c("./Equation");d.prototype=new f;d.prototype.constructor=d;var n=new j,
l=new j;d.prototype.computeB=function(c){var d=this.a,e=this.b,f=this.axisA,j=this.axisB,t=this.jacobianElementA,u=this.jacobianElementB;f.cross(j,n);j.cross(f,l);t.rotational.copy(l);u.rotational.copy(n);f=Math.cos(this.angle)-f.dot(j);j=this.computeGW();t=this.computeGiMf();return-f*d-j*e-c*t}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],19:[function(c,e){function d(c,d,e){j.call(this,c,d,0,"undefined"!==typeof e?e:1E6);this.restitution=0;this.ri=new f;this.rj=new f;this.ni=new f}e.exports=
d;var j=c("./Equation"),f=c("../math/Vec3");c("../math/Mat3");d.prototype=new j;d.prototype.constructor=d;var n=new f,l=new f,g=new f;d.prototype.computeB=function(c){var d=this.a,e=this.b,f=this.bi,p=this.bj,m=this.ri,j=this.rj,r=f.velocity,s=f.angularVelocity,t=p.velocity,J=p.angularVelocity,M=this.jacobianElementA,O=this.jacobianElementB,N=this.ni;m.cross(N,n);j.cross(N,l);N.negate(M.spatial);n.negate(M.rotational);O.spatial.copy(N);O.rotational.copy(l);g.copy(p.position);g.vadd(j,g);g.vsub(f.position,
g);g.vsub(m,g);f=N.dot(g);p=this.restitution+1;r=p*t.dot(N)-p*r.dot(N)+J.dot(l)-s.dot(n);s=this.computeGiMf();return-f*d-r*e-c*s};var m=new f,p=new f,r=new f,s=new f,t=new f;d.prototype.getImpactVelocityAlongNormal=function(){this.bi.position.vadd(this.ri,r);this.bj.position.vadd(this.rj,s);this.bi.getVelocityAtWorldPoint(r,m);this.bj.getVelocityAtWorldPoint(s,p);m.vsub(p,t);return this.ni.dot(t)}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],20:[function(c,e){function d(c,e,g,f){this.id=
d.id++;this.minForce="undefined"===typeof g?-1E6:g;this.maxForce="undefined"===typeof f?1E6:f;this.bi=c;this.bj=e;this.eps=this.b=this.a=0;this.jacobianElementA=new j;this.jacobianElementB=new j;this.enabled=!0;this.setSpookParams(1E7,4,1/60)}e.exports=d;var j=c("../math/JacobianElement"),f=c("../math/Vec3");d.prototype.constructor=d;d.id=0;d.prototype.setSpookParams=function(c,d,e){this.a=4/(e*(1+4*d));this.b=4*d/(1+4*d);this.eps=4/(e*e*c*(1+4*d))};d.prototype.computeB=function(c,d,e){var g=this.computeGW(),
f=this.computeGq(),p=this.computeGiMf();return-f*c-g*d-p*e};d.prototype.computeGq=function(){var c=this.jacobianElementB,d=this.bj.position;return this.jacobianElementA.spatial.dot(this.bi.position)+c.spatial.dot(d)};var n=new f;d.prototype.computeGW=function(){var c=this.jacobianElementB,d=this.bi,e=this.bj,g=e.velocity,e=e.angularVelocity||n;return this.jacobianElementA.multiplyVectors(d.velocity,d.angularVelocity||n)+c.multiplyVectors(g,e)};d.prototype.computeGWlambda=function(){var c=this.jacobianElementB,
d=this.bi,e=this.bj,g=e.vlambda,e=e.wlambda||n;return this.jacobianElementA.multiplyVectors(d.vlambda,d.wlambda||n)+c.multiplyVectors(g,e)};var l=new f,g=new f,m=new f,p=new f;d.prototype.computeGiMf=function(){var c=this.jacobianElementA,d=this.jacobianElementB,e=this.bi,f=this.bj,j=e.force,r=e.torque,s=f.force,n=f.torque,I=e.invMassSolve,y=f.invMassSolve;e.invInertiaWorldSolve?e.invInertiaWorldSolve.vmult(r,m):m.set(0,0,0);f.invInertiaWorldSolve?f.invInertiaWorldSolve.vmult(n,p):p.set(0,0,0);j.mult(I,
l);s.mult(y,g);return c.multiplyVectors(l,m)+d.multiplyVectors(g,p)};var r=new f;d.prototype.computeGiMGt=function(){var c=this.jacobianElementA,d=this.jacobianElementB,e=this.bi,g=this.bj,f=e.invInertiaWorldSolve,p=g.invInertiaWorldSolve,e=e.invMassSolve+g.invMassSolve;f&&(f.vmult(c.rotational,r),e+=r.dot(c.rotational));p&&(p.vmult(d.rotational,r),e+=r.dot(d.rotational));return e};var s=new f;new f;new f;new f;new f;new f;d.prototype.addToWlambda=function(c){var d=this.jacobianElementA,e=this.jacobianElementB,
g=this.bi,f=this.bj;d.spatial.mult(g.invMassSolve*c,s);g.vlambda.vadd(s,g.vlambda);e.spatial.mult(f.invMassSolve*c,s);f.vlambda.vadd(s,f.vlambda);g.invInertiaWorldSolve&&(g.invInertiaWorldSolve.vmult(d.rotational,s),s.mult(c,s),g.wlambda.vadd(s,g.wlambda));f.invInertiaWorldSolve&&(f.invInertiaWorldSolve.vmult(e.rotational,s),s.mult(c,s),f.wlambda.vadd(s,f.wlambda))};d.prototype.computeC=function(){return this.computeGiMGt()+this.eps}},{"../math/JacobianElement":26,"../math/Vec3":30}],21:[function(c,
e){function d(c,d,e){j.call(this,c,d,-e,e);this.ri=new f;this.rj=new f;this.t=new f}e.exports=d;var j=c("./Equation"),f=c("../math/Vec3");c("../math/Mat3");d.prototype=new j;d.prototype.constructor=d;var n=new f,l=new f;d.prototype.computeB=function(c){var d=this.b,e=this.rj,f=this.t;this.ri.cross(f,n);e.cross(f,l);var e=this.jacobianElementA,j=this.jacobianElementB;f.negate(e.spatial);n.negate(e.rotational);j.spatial.copy(f);j.rotational.copy(l);f=this.computeGW();e=this.computeGiMf();return-f*d-
c*e}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],22:[function(c,e){function d(c,d,e){e=e||{};var l="undefined"!==typeof e.maxForce?e.maxForce:1E6;f.call(this,c,d,-l,l);this.axisA=e.axisA?e.axisA.clone():new j(1,0,0);this.axisB=e.axisB?e.axisB.clone():new j(0,1,0);this.maxAngle=Math.PI/2}e.exports=d;var j=c("../math/Vec3");c("../math/Mat3");var f=c("./Equation");d.prototype=new f;d.prototype.constructor=d;var n=new j,l=new j;d.prototype.computeB=function(c){var d=this.a,e=this.b,f=this.axisA,
j=this.axisB,t=this.jacobianElementA,u=this.jacobianElementB;f.cross(j,n);j.cross(f,l);t.rotational.copy(l);u.rotational.copy(n);f=Math.cos(this.maxAngle)-f.dot(j);j=this.computeGW();t=this.computeGiMf();return-f*d-j*e-c*t}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],23:[function(c,e){function d(c,d,e){e="undefined"!==typeof e?e:1E6;f.call(this,c,d,-e,e);this.axisA=new j;this.axisB=new j;this.targetVelocity=0}e.exports=d;var j=c("../math/Vec3");c("../math/Mat3");var f=c("./Equation");
d.prototype=new f;d.prototype.constructor=d;d.prototype.computeB=function(c){var d=this.b,e=this.axisB,f=this.jacobianElementB;this.jacobianElementA.rotational.copy(this.axisA);e.negate(f.rotational);e=this.computeGW()-this.targetVelocity;f=this.computeGiMf();return-e*d-c*f}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],24:[function(c,e){function d(c,e,l){l=j.defaults(l,{friction:0.3,restitution:0.3,contactEquationStiffness:1E7,contactEquationRelaxation:3,frictionEquationStiffness:1E7,frictionEquationRelaxation:3});
this.id=d.idCounter++;this.materials=[c,e];this.friction=l.friction;this.restitution=l.restitution;this.contactEquationStiffness=l.contactEquationStiffness;this.contactEquationRelaxation=l.contactEquationRelaxation;this.frictionEquationStiffness=l.frictionEquationStiffness;this.frictionEquationRelaxation=l.frictionEquationRelaxation}var j=c("../utils/Utils");e.exports=d;d.idCounter=0},{"../utils/Utils":53}],25:[function(c,e){function d(c){var e="";c=c||{};"string"===typeof c?(e=c,c={}):"object"===
typeof c&&(e="");this.name=e;this.id=d.idCounter++;this.friction="undefined"!==typeof c.friction?c.friction:-1;this.restitution="undefined"!==typeof c.restitution?c.restitution:-1}e.exports=d;d.idCounter=0},{}],26:[function(c,e){function d(){this.spatial=new j;this.rotational=new j}e.exports=d;var j=c("./Vec3");d.prototype.multiplyElement=function(c){return c.spatial.dot(this.spatial)+c.rotational.dot(this.rotational)};d.prototype.multiplyVectors=function(c,d){return c.dot(this.spatial)+d.dot(this.rotational)}},
{"./Vec3":30}],27:[function(c,e){function d(c){this.elements=c?c:[0,0,0,0,0,0,0,0,0]}e.exports=d;var j=c("./Vec3");d.prototype.identity=function(){var c=this.elements;c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=1;c[5]=0;c[6]=0;c[7]=0;c[8]=1};d.prototype.setZero=function(){var c=this.elements;c[0]=0;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=0;c[6]=0;c[7]=0;c[8]=0};d.prototype.setTrace=function(c){var d=this.elements;d[0]=c.x;d[4]=c.y;d[8]=c.z};d.prototype.getTrace=function(c){c=c||new j;var d=this.elements;c.x=d[0];c.y=
d[4];c.z=d[8]};d.prototype.vmult=function(c,d){d=d||new j;var e=this.elements,g=c.x,m=c.y,p=c.z;d.x=e[0]*g+e[1]*m+e[2]*p;d.y=e[3]*g+e[4]*m+e[5]*p;d.z=e[6]*g+e[7]*m+e[8]*p;return d};d.prototype.smult=function(c){for(var d=0;d<this.elements.length;d++)this.elements[d]*=c};d.prototype.mmult=function(c,e){for(var j=e||new d,g=0;3>g;g++)for(var m=0;3>m;m++){for(var p=0,r=0;3>r;r++)p+=c.elements[g+3*r]*this.elements[r+3*m];j.elements[g+3*m]=p}return j};d.prototype.scale=function(c,e){e=e||new d;for(var j=
this.elements,g=e.elements,m=0;3!==m;m++)g[3*m+0]=c.x*j[3*m+0],g[3*m+1]=c.y*j[3*m+1],g[3*m+2]=c.z*j[3*m+2];return e};d.prototype.solve=function(c,d){d=d||new j;for(var e=[],g=0;12>g;g++)e.push(0);for(var m,g=0;3>g;g++)for(m=0;3>m;m++)e[g+4*m]=this.elements[g+3*m];e[3]=c.x;e[7]=c.y;e[11]=c.z;var p=3,r=p,s,t;do{g=r-p;if(0===e[g+4*g])for(m=g+1;m<r;m++)if(0!==e[g+4*m]){s=4;do t=4-s,e[t+4*g]+=e[t+4*m];while(--s);break}if(0!==e[g+4*g])for(m=g+1;m<r;m++){var u=e[g+4*m]/e[g+4*g];s=4;do t=4-s,e[t+4*m]=t<=
g?0:e[t+4*m]-e[t+4*g]*u;while(--s)}}while(--p);d.z=e[11]/e[10];d.y=(e[7]-e[6]*d.z)/e[5];d.x=(e[3]-e[2]*d.z-e[1]*d.y)/e[0];if(isNaN(d.x)||isNaN(d.y)||isNaN(d.z)||Infinity===d.x||Infinity===d.y||Infinity===d.z)throw"Could not solve equation! Got x=["+d.toString()+"], b=["+c.toString()+"], A=["+this.toString()+"]";return d};d.prototype.e=function(c,d,e){if(void 0===e)return this.elements[d+3*c];this.elements[d+3*c]=e};d.prototype.copy=function(c){for(var d=0;d<c.elements.length;d++)this.elements[d]=
c.elements[d];return this};d.prototype.toString=function(){for(var c="",d=0;9>d;d++)c+=this.elements[d]+",";return c};d.prototype.reverse=function(c){c=c||new d;for(var e=[],j=0;18>j;j++)e.push(0);for(var g,j=0;3>j;j++)for(g=0;3>g;g++)e[j+6*g]=this.elements[j+3*g];e[3]=1;e[9]=0;e[15]=0;e[4]=0;e[10]=1;e[16]=0;e[5]=0;e[11]=0;e[17]=1;var m=3,p=m,r,s;do{j=p-m;if(0===e[j+6*j])for(g=j+1;g<p;g++)if(0!==e[j+6*g]){r=6;do s=6-r,e[s+6*j]+=e[s+6*g];while(--r);break}if(0!==e[j+6*j])for(g=j+1;g<p;g++){var t=e[j+
6*g]/e[j+6*j];r=6;do s=6-r,e[s+6*g]=s<=j?0:e[s+6*g]-e[s+6*j]*t;while(--r)}}while(--m);j=2;do{g=j-1;do{t=e[j+6*g]/e[j+6*j];r=6;do s=6-r,e[s+6*g]-=e[s+6*j]*t;while(--r)}while(g--)}while(--j);j=2;do{t=1/e[j+6*j];r=6;do s=6-r,e[s+6*j]*=t;while(--r)}while(j--);j=2;do{g=2;do{s=e[3+g+6*j];if(isNaN(s)||Infinity===s)throw"Could not reverse! A=["+this.toString()+"]";c.e(j,g,s)}while(g--)}while(j--);return c};d.prototype.setRotationFromQuaternion=function(c){var d=c.x,e=c.y,g=c.z,m=c.w,p=d+d,j=e+e,s=g+g;c=d*
p;var t=d*j,d=d*s,u=e*j,e=e*s,g=g*s,p=m*p,j=m*j,m=m*s,s=this.elements;s[0]=1-(u+g);s[1]=t-m;s[2]=d+j;s[3]=t+m;s[4]=1-(c+g);s[5]=e-p;s[6]=d-j;s[7]=e+p;s[8]=1-(c+u);return this};d.prototype.transpose=function(c){c=c||new d;for(var e=c.elements,j=this.elements,g=0;3!==g;g++)for(var m=0;3!==m;m++)e[3*g+m]=j[3*m+g];return c}},{"./Vec3":30}],28:[function(c,e){function d(c,d,e,g){this.x=void 0!==c?c:0;this.y=void 0!==d?d:0;this.z=void 0!==e?e:0;this.w=void 0!==g?g:1}e.exports=d;var j=c("./Vec3");d.prototype.set=
function(c,d,e,g){this.x=c;this.y=d;this.z=e;this.w=g};d.prototype.toString=function(){return this.x+","+this.y+","+this.z+","+this.w};d.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]};d.prototype.setFromAxisAngle=function(c,d){var e=Math.sin(0.5*d);this.x=c.x*e;this.y=c.y*e;this.z=c.z*e;this.w=Math.cos(0.5*d)};d.prototype.toAxisAngle=function(c){c=c||new j;this.normalize();var d=2*Math.acos(this.w),e=Math.sqrt(1-this.w*this.w);0.001>e?(c.x=this.x,c.y=this.y,c.z=this.z):(c.x=this.x/
e,c.y=this.y/e,c.z=this.z/e);return[c,d]};var f=new j,n=new j;d.prototype.setFromVectors=function(c,d){if(c.isAntiparallelTo(d))c.tangents(f,n),this.setFromAxisAngle(f,Math.PI);else{var e=c.cross(d);this.x=e.x;this.y=e.y;this.z=e.z;this.w=Math.sqrt(Math.pow(c.norm(),2)*Math.pow(d.norm(),2))+c.dot(d);this.normalize()}};var l=new j,g=new j,m=new j;d.prototype.mult=function(c,e){e=e||new d;var f=this.w;l.set(this.x,this.y,this.z);g.set(c.x,c.y,c.z);e.w=f*c.w-l.dot(g);l.cross(g,m);e.x=f*g.x+c.w*l.x+m.x;
e.y=f*g.y+c.w*l.y+m.y;e.z=f*g.z+c.w*l.z+m.z;return e};d.prototype.inverse=function(c){var e=this.x,g=this.y,f=this.z,m=this.w;c=c||new d;this.conjugate(c);e=1/(e*e+g*g+f*f+m*m);c.x*=e;c.y*=e;c.z*=e;c.w*=e;return c};d.prototype.conjugate=function(c){c=c||new d;c.x=-this.x;c.y=-this.y;c.z=-this.z;c.w=this.w;return c};d.prototype.normalize=function(){var c=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);0===c?this.w=this.z=this.y=this.x=0:(c=1/c,this.x*=c,this.y*=c,this.z*=c,this.w*=
c)};d.prototype.normalizeFast=function(){var c=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;0===c?this.w=this.z=this.y=this.x=0:(this.x*=c,this.y*=c,this.z*=c,this.w*=c)};d.prototype.vmult=function(c,d){d=d||new j;var e=c.x,g=c.y,f=c.z,m=this.x,l=this.y,n=this.z,B=this.w,A=B*e+l*f-n*g,D=B*g+n*e-m*f,I=B*f+m*g-l*e,e=-m*e-l*g-n*f;d.x=A*B+e*-m+D*-n-I*-l;d.y=D*B+e*-l+I*-m-A*-n;d.z=I*B+e*-n+A*-l-D*-m;return d};d.prototype.copy=function(c){this.x=c.x;this.y=c.y;this.z=c.z;this.w=c.w;return this};
d.prototype.toEuler=function(c,d){d=d||"YZX";var e,g,f,m=this.x,j=this.y,l=this.z,n=this.w;switch(d){case "YZX":var A=m*j+l*n;0.499<A&&(e=2*Math.atan2(m,n),g=Math.PI/2,f=0);-0.499>A&&(e=-2*Math.atan2(m,n),g=-Math.PI/2,f=0);if(isNaN(e)){f=m*m;var D=l*l;e=Math.atan2(2*j*n-2*m*l,1-2*j*j-2*D);g=Math.asin(2*A);f=Math.atan2(2*m*n-2*j*l,1-2*f-2*D)}break;default:throw Error("Euler order "+d+" not supported yet.");}c.y=e;c.z=g;c.x=f};d.prototype.setFromEuler=function(c,d,e,g){g=g||"XYZ";var f=Math.cos(c/2),
m=Math.cos(d/2),j=Math.cos(e/2);c=Math.sin(c/2);d=Math.sin(d/2);e=Math.sin(e/2);"XYZ"===g?(this.x=c*m*j+f*d*e,this.y=f*d*j-c*m*e,this.z=f*m*e+c*d*j,this.w=f*m*j-c*d*e):"YXZ"===g?(this.x=c*m*j+f*d*e,this.y=f*d*j-c*m*e,this.z=f*m*e-c*d*j,this.w=f*m*j+c*d*e):"ZXY"===g?(this.x=c*m*j-f*d*e,this.y=f*d*j+c*m*e,this.z=f*m*e+c*d*j,this.w=f*m*j-c*d*e):"ZYX"===g?(this.x=c*m*j-f*d*e,this.y=f*d*j+c*m*e,this.z=f*m*e-c*d*j,this.w=f*m*j+c*d*e):"YZX"===g?(this.x=c*m*j+f*d*e,this.y=f*d*j+c*m*e,this.z=f*m*e-c*d*j,this.w=
f*m*j-c*d*e):"XZY"===g&&(this.x=c*m*j-f*d*e,this.y=f*d*j-c*m*e,this.z=f*m*e+c*d*j,this.w=f*m*j+c*d*e);return this};d.prototype.clone=function(){return new d(this.x,this.y,this.z,this.w)}},{"./Vec3":30}],29:[function(c,e){function d(c){c=c||{};this.position=new j;c.position&&this.position.copy(c.position);this.quaternion=new f;c.quaternion&&this.quaternion.copy(c.quaternion)}var j=c("./Vec3"),f=c("./Quaternion");e.exports=d;var n=new f;d.pointToLocalFrame=function(c,d,e,f){f=f||new j;e.vsub(c,f);d.conjugate(n);
n.vmult(f,f);return f};d.prototype.pointToLocal=function(c,e){return d.pointToLocalFrame(this.position,this.quaternion,c,e)};d.pointToWorldFrame=function(c,d,e,f){f=f||new j;d.vmult(e,f);f.vadd(c,f);return f};d.prototype.pointToWorld=function(c,e){return d.pointToWorldFrame(this.position,this.quaternion,c,e)};d.prototype.vectorToWorldFrame=function(c,d){d=d||new j;this.quaternion.vmult(c,d);return d};d.vectorToWorldFrame=function(c,d,e){c.vmult(d,e);return e};d.vectorToLocalFrame=function(c,d,e,f){f=
f||new j;d.w*=-1;d.vmult(e,f);d.w*=-1;return f}},{"./Quaternion":28,"./Vec3":30}],30:[function(c,e){function d(c,d,e){this.x=c||0;this.y=d||0;this.z=e||0}e.exports=d;var j=c("./Mat3");d.ZERO=new d(0,0,0);d.UNIT_X=new d(1,0,0);d.UNIT_Y=new d(0,1,0);d.UNIT_Z=new d(0,0,1);d.prototype.cross=function(c,e){var f=c.x,j=c.y,l=c.z,n=this.x,u=this.y,v=this.z;e=e||new d;e.x=u*l-v*j;e.y=v*f-n*l;e.z=n*j-u*f;return e};d.prototype.set=function(c,d,e){this.x=c;this.y=d;this.z=e;return this};d.prototype.setZero=function(){this.x=
this.y=this.z=0};d.prototype.vadd=function(c,e){if(e)e.x=c.x+this.x,e.y=c.y+this.y,e.z=c.z+this.z;else return new d(this.x+c.x,this.y+c.y,this.z+c.z)};d.prototype.vsub=function(c,e){if(e)e.x=this.x-c.x,e.y=this.y-c.y,e.z=this.z-c.z;else return new d(this.x-c.x,this.y-c.y,this.z-c.z)};d.prototype.crossmat=function(){return new j([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])};d.prototype.normalize=function(){var c=this.x,d=this.y,e=this.z,c=Math.sqrt(c*c+d*d+e*e);0<c?(d=1/c,this.x*=d,this.y*=
d,this.z*=d):this.z=this.y=this.x=0;return c};d.prototype.unit=function(c){c=c||new d;var e=this.x,f=this.y,j=this.z,l=Math.sqrt(e*e+f*f+j*j);0<l?(l=1/l,c.x=e*l,c.y=f*l,c.z=j*l):(c.x=1,c.y=0,c.z=0);return c};d.prototype.norm=function(){var c=this.x,d=this.y,e=this.z;return Math.sqrt(c*c+d*d+e*e)};d.prototype.length=d.prototype.norm;d.prototype.norm2=function(){return this.dot(this)};d.prototype.lengthSquared=d.prototype.norm2;d.prototype.distanceTo=function(c){var d=this.x,e=this.y,f=this.z,j=c.x,
l=c.y;c=c.z;return Math.sqrt((j-d)*(j-d)+(l-e)*(l-e)+(c-f)*(c-f))};d.prototype.distanceSquared=function(c){var d=this.x,e=this.y,f=this.z,j=c.x,l=c.y;c=c.z;return(j-d)*(j-d)+(l-e)*(l-e)+(c-f)*(c-f)};d.prototype.mult=function(c,e){e=e||new d;var f=this.y,j=this.z;e.x=c*this.x;e.y=c*f;e.z=c*j;return e};d.prototype.scale=d.prototype.mult;d.prototype.dot=function(c){return this.x*c.x+this.y*c.y+this.z*c.z};d.prototype.isZero=function(){return 0===this.x&&0===this.y&&0===this.z};d.prototype.negate=function(c){c=
c||new d;c.x=-this.x;c.y=-this.y;c.z=-this.z;return c};var f=new d,n=new d;d.prototype.tangents=function(c,d){var e=this.norm();0<e?(e=1/e,f.set(this.x*e,this.y*e,this.z*e),0.9>Math.abs(f.x)?n.set(1,0,0):n.set(0,1,0),f.cross(n,c),f.cross(c,d)):(c.set(1,0,0),d.set(0,1,0))};d.prototype.toString=function(){return this.x+","+this.y+","+this.z};d.prototype.toArray=function(){return[this.x,this.y,this.z]};d.prototype.copy=function(c){this.x=c.x;this.y=c.y;this.z=c.z;return this};d.prototype.lerp=function(c,
d,e){var f=this.x,j=this.y,l=this.z;e.x=f+(c.x-f)*d;e.y=j+(c.y-j)*d;e.z=l+(c.z-l)*d};d.prototype.almostEquals=function(c,d){void 0===d&&(d=1E-6);return Math.abs(this.x-c.x)>d||Math.abs(this.y-c.y)>d||Math.abs(this.z-c.z)>d?!1:!0};d.prototype.almostZero=function(c){void 0===c&&(c=1E-6);return Math.abs(this.x)>c||Math.abs(this.y)>c||Math.abs(this.z)>c?!1:!0};var l=new d;d.prototype.isAntiparallelTo=function(c,d){this.negate(l);return l.almostEquals(c,d)};d.prototype.clone=function(){return new d(this.x,
this.y,this.z)}},{"./Mat3":27}],31:[function(c,e){function d(c){c=c||{};j.apply(this);this.id=d.idCounter++;this.postStep=this.preStep=this.world=null;this.vlambda=new f;this.collisionFilterGroup="number"===typeof c.collisionFilterGroup?c.collisionFilterGroup:1;this.collisionFilterMask="number"===typeof c.collisionFilterMask?c.collisionFilterMask:1;this.collisionResponse=!0;this.position=new f;c.position&&this.position.copy(c.position);this.previousPosition=new f;this.initPosition=new f;this.velocity=
new f;c.velocity&&this.velocity.copy(c.velocity);this.initVelocity=new f;this.force=new f;var e="number"===typeof c.mass?c.mass:0;this.mass=e;this.invMass=0<e?1/e:0;this.material=c.material||null;this.linearDamping="number"===typeof c.linearDamping?c.linearDamping:0.01;this.type=0>=e?d.STATIC:d.DYNAMIC;typeof c.type===typeof d.STATIC&&(this.type=c.type);this.allowSleep="undefined"!==typeof c.allowSleep?c.allowSleep:!0;this.sleepState=0;this.sleepSpeedLimit="undefined"!==typeof c.sleepSpeedLimit?c.sleepSpeedLimit:
0.1;this.sleepTimeLimit="undefined"!==typeof c.sleepTimeLimit?c.sleepTimeLimit:1;this.timeLastSleepy=0;this._wakeUpAfterNarrowphase=!1;this.torque=new f;this.quaternion=new l;c.quaternion&&this.quaternion.copy(c.quaternion);this.initQuaternion=new l;this.angularVelocity=new f;c.angularVelocity&&this.angularVelocity.copy(c.angularVelocity);this.initAngularVelocity=new f;this.interpolatedPosition=new f;this.interpolatedQuaternion=new l;this.shapes=[];this.shapeOffsets=[];this.shapeOrientations=[];this.inertia=
new f;this.invInertia=new f;this.invInertiaWorld=new n;this.invMassSolve=0;this.invInertiaSolve=new f;this.invInertiaWorldSolve=new n;this.fixedRotation="undefined"!==typeof c.fixedRotation?c.fixedRotation:!1;this.angularDamping="undefined"!==typeof c.angularDamping?c.angularDamping:0.01;this.aabb=new g;this.aabbNeedsUpdate=!0;this.wlambda=new f;c.shape&&this.addShape(c.shape);this.updateMassProperties()}e.exports=d;var j=c("../utils/EventTarget");c("../shapes/Shape");var f=c("../math/Vec3"),n=c("../math/Mat3"),
l=c("../math/Quaternion");c("../material/Material");var g=c("../collision/AABB"),m=c("../shapes/Box");d.prototype=new j;d.prototype.constructor=d;d.DYNAMIC=1;d.STATIC=2;d.KINEMATIC=4;d.AWAKE=0;d.SLEEPY=1;d.SLEEPING=2;d.idCounter=0;d.prototype.wakeUp=function(){var c=this.sleepState;this.sleepState=0;c===d.SLEEPING&&this.dispatchEvent({type:"wakeup"})};d.prototype.sleep=function(){this.sleepState=d.SLEEPING;this.velocity.set(0,0,0);this.angularVelocity.set(0,0,0)};d.sleepyEvent={type:"sleepy"};d.sleepEvent=
{type:"sleep"};d.prototype.sleepTick=function(c){if(this.allowSleep){var e=this.sleepState,g=this.velocity.norm2()+this.angularVelocity.norm2(),f=Math.pow(this.sleepSpeedLimit,2);e===d.AWAKE&&g<f?(this.sleepState=d.SLEEPY,this.timeLastSleepy=c,this.dispatchEvent(d.sleepyEvent)):e===d.SLEEPY&&g>f?this.wakeUp():e===d.SLEEPY&&c-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(d.sleepEvent))}};d.prototype.updateSolveMassProperties=function(){this.sleepState===d.SLEEPING||this.type===
d.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))};d.prototype.pointToLocalFrame=function(c,d){d=d||new f;c.vsub(this.position,d);this.quaternion.conjugate().vmult(d,d);return d};d.prototype.vectorToLocalFrame=function(c,d){d=d||new f;this.quaternion.conjugate().vmult(c,d);return d};d.prototype.pointToWorldFrame=function(c,
d){d=d||new f;this.quaternion.vmult(c,d);d.vadd(this.position,d);return d};d.prototype.vectorToWorldFrame=function(c,d){d=d||new f;this.quaternion.vmult(c,d);return d};var p=new f,r=new l;d.prototype.addShape=function(c,d,e){var g=new f,j=new l;d&&g.copy(d);e&&j.copy(e);this.shapes.push(c);this.shapeOffsets.push(g);this.shapeOrientations.push(j);this.updateMassProperties();this.updateBoundingRadius();this.aabbNeedsUpdate=!0;return this};d.prototype.updateBoundingRadius=function(){for(var c=this.shapes,
d=this.shapeOffsets,e=c.length,g=0,f=0;f!==e;f++){var j=c[f];j.updateBoundingSphereRadius();var m=d[f].norm(),j=j.boundingSphereRadius;m+j>g&&(g=m+j)}this.boundingRadius=g};var s=new g;d.prototype.computeAABB=function(){for(var c=this.shapes,d=this.shapeOffsets,e=this.shapeOrientations,g=c.length,f=this.quaternion,j=this.aabb,m=0;m!==g;m++){var l=c[m];e[m].mult(f,r);r.vmult(d[m],p);p.vadd(this.position,p);l.calculateWorldAABB(p,r,s.lowerBound,s.upperBound);0===m?j.copy(s):j.extend(s)}this.aabbNeedsUpdate=
!1};var t=new n,u=new n;new n;d.prototype.updateInertiaWorld=function(c){var d=this.invInertia;d.x===d.y&&d.y===d.z&&!c||(t.setRotationFromQuaternion(this.quaternion),t.transpose(u),t.scale(d,t),t.mmult(u,this.invInertiaWorld))};var v=new f,z=new f;d.prototype.applyForce=function(c,e){this.type===d.DYNAMIC&&(e.vsub(this.position,v),v.cross(c,z),this.force.vadd(c,this.force),this.torque.vadd(z,this.torque))};var x=new f,B=new f;d.prototype.applyLocalForce=function(c,e){this.type===d.DYNAMIC&&(this.vectorToWorldFrame(c,
x),this.pointToWorldFrame(e,B),this.applyForce(x,B))};var A=new f,D=new f,I=new f;d.prototype.applyImpulse=function(c,e){this.type===d.DYNAMIC&&(e.vsub(this.position,A),D.copy(c),D.mult(this.invMass,D),this.velocity.vadd(D,this.velocity),A.cross(c,I),this.invInertiaWorld.vmult(I,I),this.angularVelocity.vadd(I,this.angularVelocity))};var y=new f,C=new f;d.prototype.applyLocalImpulse=function(c,e){this.type===d.DYNAMIC&&(this.vectorToWorldFrame(c,y),this.pointToWorldFrame(e,C),this.applyImpulse(y,C))};
var J=new f;d.prototype.updateMassProperties=function(){this.invMass=0<this.mass?1/this.mass:0;var c=this.inertia,d=this.fixedRotation;this.computeAABB();J.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2);m.calculateInertia(J,this.mass,c);this.invInertia.set(0<c.x&&!d?1/c.x:0,0<c.y&&!d?1/c.y:0,0<c.z&&!d?1/c.z:0);this.updateInertiaWorld(!0)};d.prototype.getVelocityAtWorldPoint=function(c,d){var e=
new f;c.vsub(this.position,e);this.angularVelocity.cross(e,d);this.velocity.vadd(d,d);return d}},{"../collision/AABB":3,"../material/Material":25,"../math/Mat3":27,"../math/Quaternion":28,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Shape":43,"../utils/EventTarget":49}],32:[function(c,e){function d(c){this.chassisBody=c.chassisBody;this.wheelInfos=[];this.sliding=!1;this.world=null;this.indexRightAxis="undefined"!==typeof c.indexRightAxis?c.indexRightAxis:1;this.indexForwardAxis="undefined"!==
typeof c.indexForwardAxis?c.indexForwardAxis:0;this.indexUpAxis="undefined"!==typeof c.indexUpAxis?c.indexUpAxis:2}function j(c,d,e){var g=I,f=y,j=C,m=J;d.vsub(c.position,g);g.cross(e,f);c.invInertiaWorld.vmult(f,m);m.cross(g,j);return c.invMass+e.dot(j)}c("./Body");var f=c("../math/Vec3"),n=c("../math/Quaternion");c("../collision/RaycastResult");var l=c("../collision/Ray"),g=c("../objects/WheelInfo");e.exports=d;new f;new f;new f;var m=new f,p=new f,r=new f;new l;d.prototype.addWheel=function(c){c=
c||{};c=new g(c);var d=this.wheelInfos.length;this.wheelInfos.push(c);return d};d.prototype.setSteeringValue=function(c,d){this.wheelInfos[d].steering=c};new f;d.prototype.applyEngineForce=function(c,d){this.wheelInfos[d].engineForce=c};d.prototype.setBrake=function(c,d){this.wheelInfos[d].brake=c};d.prototype.addToWorld=function(c){c.add(this.chassisBody);var d=this;this.preStepCallback=function(){d.updateVehicle(c.dt)};c.addEventListener("preStep",this.preStepCallback);this.world=c};d.prototype.getVehicleAxisWorld=
function(c,d){d.set(0===c?1:0,1===c?1:0,2===c?1:0);this.chassisBody.vectorToWorldFrame(d,d)};d.prototype.updateVehicle=function(c){for(var d=this.wheelInfos,e=d.length,g=this.chassisBody,j=0;j<e;j++)this.updateWheelTransform(j);this.currentVehicleSpeedKmHour=3.6*g.velocity.norm();j=new f;this.getVehicleAxisWorld(this.indexForwardAxis,j);0>j.dot(g.velocity)&&(this.currentVehicleSpeedKmHour*=-1);for(j=0;j<e;j++)this.castRay(d[j]);this.updateSuspension(c);for(var m=new f,p=new f,j=0;j<e;j++){var l=d[j],
r=l.suspensionForce;r>l.maxSuspensionForce&&(r=l.maxSuspensionForce);l.raycastResult.hitNormalWorld.scale(r*c,m);l.raycastResult.hitPointWorld.vsub(g.position,p);g.applyImpulse(m,l.raycastResult.hitPointWorld)}this.updateFriction(c);m=new f;p=new f;r=new f;for(j=0;j<e;j++){l=d[j];g.getVelocityAtWorldPoint(l.chassisConnectionPointWorld,r);var s=1;switch(this.indexUpAxis){case 1:s=-1}if(l.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,p);var n=p.dot(l.raycastResult.hitNormalWorld);l.raycastResult.hitNormalWorld.scale(n,
m);p.vsub(m,p);n=p.dot(r);l.deltaRotation=s*n*c/l.radius}if((l.sliding||!l.isInContact)&&0!==l.engineForce&&l.useCustomSlidingRotationalSpeed)l.deltaRotation=(0<l.engineForce?1:-1)*l.customSlidingRotationalSpeed*c;Math.abs(l.brake)>Math.abs(l.engineForce)&&(l.deltaRotation=0);l.rotation+=l.deltaRotation;l.deltaRotation*=0.99}};d.prototype.updateSuspension=function(){for(var c=this.chassisBody.mass,d=this.wheelInfos,e=d.length,g=0;g<e;g++){var f=d[g];if(f.isInContact){var j;j=f.suspensionStiffness*
(f.suspensionRestLength-f.suspensionLength)*f.clippedInvContactDotSuspension;var m=f.suspensionRelativeVelocity;j-=(0>m?f.dampingCompression:f.dampingRelaxation)*m;f.suspensionForce=j*c;0>f.suspensionForce&&(f.suspensionForce=0)}else f.suspensionForce=0}};d.prototype.removeFromWorld=function(c){c.remove(this.chassisBody);c.removeEventListener("preStep",this.preStepCallback);this.world=null};var s=new f,t=new f;d.prototype.castRay=function(c){this.updateWheelTransformWorld(c);var d=this.chassisBody,
e=-1;c.directionWorld.scale(c.suspensionRestLength+c.radius,s);var g=c.chassisConnectionPointWorld;g.vadd(s,t);var j=c.raycastResult;j.reset();var m=d.collisionResponse;d.collisionResponse=!1;this.world.rayTest(g,t,j);d.collisionResponse=m;g=j.body;c.raycastResult.groundObject=0;g?(e=j.distance,c.raycastResult.hitNormalWorld=j.hitNormalWorld,c.isInContact=!0,c.suspensionLength=j.distance-c.radius,j=c.suspensionRestLength-c.maxSuspensionTravel,g=c.suspensionRestLength+c.maxSuspensionTravel,c.suspensionLength<
j&&(c.suspensionLength=j),c.suspensionLength>g&&(c.suspensionLength=g,c.raycastResult.reset()),j=c.raycastResult.hitNormalWorld.dot(c.directionWorld),g=new f,d.getVelocityAtWorldPoint(c.raycastResult.hitPointWorld,g),d=c.raycastResult.hitNormalWorld.dot(g),-0.1<=j?(c.suspensionRelativeVelocity=0,c.clippedInvContactDotSuspension=10):(j=-1/j,c.suspensionRelativeVelocity=d*j,c.clippedInvContactDotSuspension=j)):(c.suspensionLength=c.suspensionRestLength+0*c.maxSuspensionTravel,c.suspensionRelativeVelocity=
0,c.directionWorld.scale(-1,c.raycastResult.hitNormalWorld),c.clippedInvContactDotSuspension=1);return e};d.prototype.updateWheelTransformWorld=function(c){c.isInContact=!1;var d=this.chassisBody;d.pointToWorldFrame(c.chassisConnectionPointLocal,c.chassisConnectionPointWorld);d.vectorToWorldFrame(c.directionLocal,c.directionWorld);d.vectorToWorldFrame(c.axleLocal,c.axleWorld)};d.prototype.updateWheelTransform=function(c){c=this.wheelInfos[c];this.updateWheelTransformWorld(c);c.directionLocal.scale(-1,
m);p.copy(c.axleLocal);m.cross(p,r);r.normalize();p.normalize();var d=c.steering,e=new n;e.setFromAxisAngle(m,d);d=new n;d.setFromAxisAngle(p,c.rotation);var g=c.worldTransform.quaternion;this.chassisBody.quaternion.mult(e,g);g.mult(d,g);g.normalize();e=c.worldTransform.position;e.copy(c.directionWorld);e.scale(c.suspensionLength,e);e.vadd(c.chassisConnectionPointWorld,e)};var u=[new f(1,0,0),new f(0,1,0),new f(0,0,1)];d.prototype.getWheelTransformWorld=function(c){return this.wheelInfos[c].worldTransform};
var v=new f,z=[],x=[];d.prototype.updateFriction=function(c){for(var d=this.wheelInfos,e=d.length,g=this.chassisBody,m=0,p=0;p<e;p++){var l=d[p],r=l.raycastResult.body;r&&m++;l.sideImpulse=0;l.forwardImpulse=0;x[p]||(x[p]=new f);z[p]||(z[p]=new f)}for(p=0;p<e;p++)if(l=d[p],r=l.raycastResult.body){var s=z[p];this.getWheelTransformWorld(p).vectorToWorldFrame(u[this.indexRightAxis],s);var m=l.raycastResult.hitNormalWorld,n=s.dot(m);m.scale(n,v);s.vsub(v,s);s.normalize();m.cross(s,x[p]);x[p].normalize();
m=l;var n=g,t=l.raycastResult.hitPointWorld,y=l.raycastResult.hitPointWorld,C=void 0;if(1.1<s.norm2())r=0;else{var C=M,J=O,ea=N;n.getVelocityAtWorldPoint(t,C);r.getVelocityAtWorldPoint(y,J);C.vsub(J,ea);r=C=-0.2*s.dot(ea)*(1/(n.invMass+r.invMass))}m.sideImpulse=r;l.sideImpulse*=1}this.sliding=!1;for(p=0;p<e;p++){l=d[p];r=l.raycastResult.body;n=0;l.slipInfo=1;if(r){var m=l.brake?l.brake:0,C=g,t=r,y=l.raycastResult.hitPointWorld,s=x[p],n=m,J=0,J=y,ea=B,oa=A,E=D;C.getVelocityAtWorldPoint(J,ea);t.getVelocityAtWorldPoint(J,
oa);ea.vsub(oa,E);J=s.dot(E);C=j(C,y,s);t=j(t,y,s);J=-J*(1/(C+t));n<J&&(J=n);J<-n&&(J=-n);n=J;n+=l.engineForce*c;m/=n;l.slipInfo*=m}l.forwardImpulse=0;l.skidInfo=1;r&&(l.skidInfo=1,r=l.suspensionForce*c*l.frictionSlip,m=r*r,l.forwardImpulse=n,n=0.5*l.forwardImpulse,t=1*l.sideImpulse,n=n*n+t*t,l.sliding=!1,n>m&&(this.sliding=!0,l.sliding=!0,m=r/Math.sqrt(n),l.skidInfo*=m))}if(this.sliding)for(p=0;p<e;p++)l=d[p],0!==l.sideImpulse&&1>l.skidInfo&&(l.forwardImpulse*=l.skidInfo,l.sideImpulse*=l.skidInfo);
for(p=0;p<e;p++)l=d[p],c=new f,c.copy(l.raycastResult.hitPointWorld),0!==l.forwardImpulse&&(r=new f,x[p].scale(l.forwardImpulse,r),g.applyImpulse(r,c)),0!==l.sideImpulse&&(r=l.raycastResult.body,m=new f,m.copy(l.raycastResult.hitPointWorld),n=new f,z[p].scale(l.sideImpulse,n),g.pointToLocalFrame(c,c),c["xyz"[this.indexUpAxis]]*=l.rollInfluence,g.pointToWorldFrame(c,c),g.applyImpulse(n,c),n.scale(-1,n),r.applyImpulse(n,m))};var B=new f,A=new f,D=new f,I=new f,y=new f,C=new f,J=new f,M=new f,O=new f,
N=new f},{"../collision/Ray":9,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Vec3":30,"../objects/WheelInfo":36,"./Body":31}],33:[function(c,e){function d(c){this.wheelBodies=[];this.coordinateSystem="undefined"===typeof c.coordinateSystem?new l(1,2,3):c.coordinateSystem.clone();this.chassisBody=c.chassisBody;this.chassisBody||(c=new n(new l(5,2,0.5)),this.chassisBody=new j(1,c));this.constraints=[];this.wheelAxes=[];this.wheelForces=[]}var j=c("./Body"),f=c("../shapes/Sphere"),
n=c("../shapes/Box"),l=c("../math/Vec3"),g=c("../constraints/HingeConstraint");e.exports=d;d.prototype.addWheel=function(c){c=c||{};var d=c.body;d||(d=new j(1,new f(1.2)));this.wheelBodies.push(d);this.wheelForces.push(0);new l;var e="undefined"!==typeof c.position?c.position.clone():new l,m=new l;this.chassisBody.pointToWorldFrame(e,m);d.position.set(m.x,m.y,m.z);c="undefined"!==typeof c.axis?c.axis.clone():new l(0,1,0);this.wheelAxes.push(c);d=new g(this.chassisBody,d,{pivotA:e,axisA:c,pivotB:l.ZERO,
axisB:c,collideConnected:!1});this.constraints.push(d);return this.wheelBodies.length-1};d.prototype.setSteeringValue=function(c,d){var e=this.wheelAxes[d],g=Math.cos(c),f=Math.sin(c),j=e.x,e=e.y;this.constraints[d].axisA.set(g*j-f*e,f*j+g*e,0)};d.prototype.setMotorSpeed=function(c,d){var e=this.constraints[d];e.enableMotor();e.motorTargetVelocity=c};d.prototype.disableMotor=function(c){this.constraints[c].disableMotor()};var m=new l;d.prototype.setWheelForce=function(c,d){this.wheelForces[d]=c};
d.prototype.applyWheelForce=function(c,d){var e=this.wheelBodies[d],g=e.torque;this.wheelAxes[d].scale(c,m);e.vectorToWorldFrame(m,m);g.vadd(m,g)};d.prototype.addToWorld=function(c){for(var d=this.constraints,e=this.wheelBodies.concat([this.chassisBody]),g=0;g<e.length;g++)c.add(e[g]);for(g=0;g<d.length;g++)c.addConstraint(d[g]);c.addEventListener("preStep",this._update.bind(this))};d.prototype._update=function(){for(var c=this.wheelForces,d=0;d<c.length;d++)this.applyWheelForce(c[d],d)};d.prototype.removeFromWorld=
function(c){for(var d=this.constraints,e=this.wheelBodies.concat([this.chassisBody]),g=0;g<e.length;g++)c.remove(e[g]);for(g=0;g<d.length;g++)c.removeConstraint(d[g])};var p=new l;d.prototype.getWheelSpeed=function(c){var d=this.wheelBodies[c].angularVelocity;this.chassisBody.vectorToWorldFrame(this.wheelAxes[c],p);return d.dot(p)}},{"../constraints/HingeConstraint":15,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Sphere":44,"./Body":31}],34:[function(c,e){function d(){this.particles=[];this.speedOfSound=
this.smoothingRadius=this.density=1;this.viscosity=0.01;this.eps=1E-6;this.pressures=[];this.densities=[];this.neighbors=[]}e.exports=d;c("../shapes/Shape");var j=c("../math/Vec3");c("../math/Quaternion");c("../shapes/Particle");c("../objects/Body");c("../material/Material");d.prototype.add=function(c){this.particles.push(c);this.neighbors.length<this.particles.length&&this.neighbors.push([])};d.prototype.remove=function(c){c=this.particles.indexOf(c);-1!==c&&(this.particles.splice(c,1),this.neighbors.length>
this.particles.length&&this.neighbors.pop())};var f=new j;d.prototype.getNeighbors=function(c,d){for(var e=this.particles.length,g=c.id,j=this.smoothingRadius*this.smoothingRadius,m=0;m!==e;m++){var p=this.particles[m];p.position.vsub(c.position,f);g!==p.id&&f.norm2()<j&&d.push(p)}};var n=new j,l=new j,g=new j,m=new j,p=new j,r=new j;d.prototype.update=function(){for(var c=this.particles.length,d=this.speedOfSound,e=this.eps,f=0;f!==c;f++){var j=this.particles[f],x=this.neighbors[f];x.length=0;this.getNeighbors(j,
x);x.push(this.particles[f]);for(var B=x.length,A=0,D=0;D!==B;D++){j.position.vsub(x[D].position,n);var I=n.norm(),I=this.w(I),A=A+x[D].mass*I}this.densities[f]=A;this.pressures[f]=d*d*(this.densities[f]-this.density)}for(f=0;f!==c;f++){d=this.particles[f];l.set(0,0,0);g.set(0,0,0);x=this.neighbors[f];B=x.length;for(D=0;D!==B;D++)A=x[D],d.position.vsub(A.position,p),I=p.norm(),j=-A.mass*(this.pressures[f]/(this.densities[f]*this.densities[f]+e)+this.pressures[D]/(this.densities[D]*this.densities[D]+
e)),this.gradw(p,m),m.mult(j,m),l.vadd(m,l),A.velocity.vsub(d.velocity,r),r.mult(1/(1E-4+this.densities[f]*this.densities[D])*this.viscosity*A.mass,r),j=this.nablaw(I),r.mult(j,r),g.vadd(r,g);g.mult(d.mass,g);l.mult(d.mass,l);d.force.vadd(g,d.force);d.force.vadd(l,d.force)}};d.prototype.w=function(c){var d=this.smoothingRadius;return 315/(64*Math.PI*Math.pow(d,9))*Math.pow(d*d-c*c,3)};d.prototype.gradw=function(c,d){var e=c.norm(),g=this.smoothingRadius;c.mult(945/(32*Math.PI*Math.pow(g,9))*Math.pow(g*
g-e*e,2),d)};d.prototype.nablaw=function(c){var d=this.smoothingRadius;return 945/(32*Math.PI*Math.pow(d,9))*(d*d-c*c)*(7*c*c-3*d*d)}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Particle":41,"../shapes/Shape":43}],35:[function(c,e){function d(c,d,e){e=e||{};this.restLength="number"===typeof e.restLength?e.restLength:1;this.stiffness=e.stiffness||100;this.damping=e.damping||1;this.bodyA=c;this.bodyB=d;this.localAnchorA=new j;this.localAnchorB=
new j;e.localAnchorA&&this.localAnchorA.copy(e.localAnchorA);e.localAnchorB&&this.localAnchorB.copy(e.localAnchorB);e.worldAnchorA&&this.setWorldAnchorA(e.worldAnchorA);e.worldAnchorB&&this.setWorldAnchorB(e.worldAnchorB)}var j=c("../math/Vec3");e.exports=d;d.prototype.setWorldAnchorA=function(c){this.bodyA.pointToLocalFrame(c,this.localAnchorA)};d.prototype.setWorldAnchorB=function(c){this.bodyB.pointToLocalFrame(c,this.localAnchorB)};d.prototype.getWorldAnchorA=function(c){this.bodyA.pointToWorldFrame(this.localAnchorA,
c)};d.prototype.getWorldAnchorB=function(c){this.bodyB.pointToWorldFrame(this.localAnchorB,c)};var f=new j,n=new j,l=new j,g=new j,m=new j,p=new j,r=new j,s=new j,t=new j,u=new j,v=new j;d.prototype.applyForce=function(){var c=this.stiffness,d=this.damping,e=this.restLength,j=this.bodyA,D=this.bodyB;this.getWorldAnchorA(m);this.getWorldAnchorB(p);m.vsub(j.position,r);p.vsub(D.position,s);p.vsub(m,f);var I=f.norm();n.copy(f);n.normalize();D.velocity.vsub(j.velocity,l);D.angularVelocity.cross(s,v);
l.vadd(v,l);j.angularVelocity.cross(r,v);l.vsub(v,l);n.mult(-c*(I-e)-d*l.dot(n),g);j.force.vsub(g,j.force);D.force.vadd(g,D.force);r.cross(g,t);s.cross(g,u);j.torque.vsub(t,j.torque);D.torque.vadd(u,D.torque)}},{"../math/Vec3":30}],36:[function(c,e){function d(c){c=l.defaults(c,{chassisConnectionPointLocal:new j,chassisConnectionPointWorld:new j,directionLocal:new j,directionWorld:new j,axleLocal:new j,axleWorld:new j,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,
dampingRelaxation:10,frictionSlip:1E4,steering:0,rotation:0,deltaRotation:0,rollInfluence:0.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-0.1});this.maxSuspensionTravel=c.maxSuspensionTravel;this.customSlidingRotationalSpeed=c.customSlidingRotationalSpeed;this.useCustomSlidingRotationalSpeed=c.useCustomSlidingRotationalSpeed;
this.sliding=!1;this.chassisConnectionPointLocal=c.chassisConnectionPointLocal.clone();this.chassisConnectionPointWorld=c.chassisConnectionPointWorld.clone();this.directionLocal=c.directionLocal.clone();this.directionWorld=c.directionWorld.clone();this.axleLocal=c.axleLocal.clone();this.axleWorld=c.axleWorld.clone();this.suspensionRestLength=c.suspensionRestLength;this.suspensionMaxLength=c.suspensionMaxLength;this.radius=c.radius;this.suspensionStiffness=c.suspensionStiffness;this.dampingCompression=
c.dampingCompression;this.dampingRelaxation=c.dampingRelaxation;this.frictionSlip=c.frictionSlip;this.deltaRotation=this.rotation=this.steering=0;this.rollInfluence=c.rollInfluence;this.maxSuspensionForce=c.maxSuspensionForce;this.brake=this.engineForce=0;this.isFrontWheel=c.isFrontWheel;this.clippedInvContactDotSuspension=1;this.forwardImpulse=this.sideImpulse=this.suspensionLength=this.skidInfo=this.suspensionForce=this.suspensionRelativeVelocity=0;this.raycastResult=new n;this.worldTransform=new f;
this.isInContact=!1}var j=c("../math/Vec3"),f=c("../math/Transform"),n=c("../collision/RaycastResult"),l=c("../utils/Utils");e.exports=d;var g=new j,m=new j,g=new j;d.prototype.updateWheel=function(c){var d=this.raycastResult;if(this.isInContact){var e=d.hitNormalWorld.dot(d.directionWorld);d.hitPointWorld.vsub(c.position,m);c.getVelocityAtWorldPoint(m,g);c=d.hitNormalWorld.dot(g);-0.1<=e?(this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=10):(e=-1/e,this.suspensionRelativeVelocity=
c*e,this.clippedInvContactDotSuspension=e)}else d.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,d.directionWorld.scale(-1,d.hitNormalWorld),this.clippedInvContactDotSuspension=1}},{"../collision/RaycastResult":10,"../math/Transform":29,"../math/Vec3":30,"../utils/Utils":53}],37:[function(c,e){function d(c){j.call(this);this.type=j.types.BOX;this.halfExtents=c;this.convexPolyhedronRepresentation=null;this.updateConvexPolyhedronRepresentation();this.updateBoundingSphereRadius()}
e.exports=d;var j=c("./Shape"),f=c("../math/Vec3"),n=c("./ConvexPolyhedron");d.prototype=new j;d.prototype.constructor=d;d.prototype.updateConvexPolyhedronRepresentation=function(){var c=this.halfExtents.x,d=this.halfExtents.y,e=this.halfExtents.z,c=[new f(-c,-d,-e),new f(c,-d,-e),new f(c,d,-e),new f(-c,d,-e),new f(-c,-d,e),new f(c,-d,e),new f(c,d,e),new f(-c,d,e)];new f(0,0,1);new f(0,1,0);new f(1,0,0);this.convexPolyhedronRepresentation=c=new n(c,[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,
3],[1,2,6,5]]);c.material=this.material};d.prototype.calculateLocalInertia=function(c,e){e=e||new f;d.calculateInertia(this.halfExtents,c,e);return e};d.calculateInertia=function(c,d,e){e.x=1/12*d*(4*c.y*c.y+4*c.z*c.z);e.y=1/12*d*(4*c.x*c.x+4*c.z*c.z);e.z=1/12*d*(4*c.y*c.y+4*c.x*c.x)};d.prototype.getSideNormals=function(c,d){var e=this.halfExtents;c[0].set(e.x,0,0);c[1].set(0,e.y,0);c[2].set(0,0,e.z);c[3].set(-e.x,0,0);c[4].set(0,-e.y,0);c[5].set(0,0,-e.z);if(void 0!==d)for(e=0;e!==c.length;e++)d.vmult(c[e],
c[e]);return c};d.prototype.volume=function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.halfExtents.norm()};var l=new f;new f;d.prototype.forEachWorldCorner=function(c,d,e){for(var g=this.halfExtents,g=[[g.x,g.y,g.z],[-g.x,g.y,g.z],[-g.x,-g.y,g.z],[-g.x,-g.y,-g.z],[g.x,-g.y,-g.z],[g.x,g.y,-g.z],[-g.x,g.y,-g.z],[g.x,-g.y,g.z]],f=0;f<g.length;f++)l.set(g[f][0],g[f][1],g[f][2]),d.vmult(l,l),c.vadd(l,
l),e(l.x,l.y,l.z)};var g=[new f,new f,new f,new f,new f,new f,new f,new f];d.prototype.calculateWorldAABB=function(c,d,e,f){var j=this.halfExtents;g[0].set(j.x,j.y,j.z);g[1].set(-j.x,j.y,j.z);g[2].set(-j.x,-j.y,j.z);g[3].set(-j.x,-j.y,-j.z);g[4].set(j.x,-j.y,-j.z);g[5].set(j.x,j.y,-j.z);g[6].set(-j.x,j.y,-j.z);g[7].set(j.x,-j.y,j.z);var l=g[0];d.vmult(l,l);c.vadd(l,l);f.copy(l);e.copy(l);for(j=1;8>j;j++){l=g[j];d.vmult(l,l);c.vadd(l,l);var n=l.x,z=l.y,l=l.z;n>f.x&&(f.x=n);z>f.y&&(f.y=z);l>f.z&&(f.z=
l);n<e.x&&(e.x=n);z<e.y&&(e.y=z);l<e.z&&(e.z=l)}}},{"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],38:[function(c,e){function d(c,d,e){j.call(this);this.type=j.types.CONVEXPOLYHEDRON;this.vertices=c||[];this.worldVertices=[];this.worldVerticesNeedsUpdate=!0;this.faces=d||[];this.faceNormals=[];this.computeNormals();this.worldFaceNormalsNeedsUpdate=!0;this.worldFaceNormals=[];this.uniqueEdges=[];this.uniqueAxes=e?e.slice():null;this.computeEdges();this.updateBoundingSphereRadius()}e.exports=
d;var j=c("./Shape"),f=c("../math/Vec3");c("../math/Quaternion");var n=c("../math/Transform");d.prototype=new j;d.prototype.constructor=d;var l=new f;d.prototype.computeEdges=function(){for(var c=this.faces,d=this.vertices,e=this.uniqueEdges,g=e.length=0;g!==c.length;g++)for(var f=c[g],j=f.length,m=0;m!==j;m++){d[f[m]].vsub(d[f[(m+1)%j]],l);l.normalize();for(var p=!1,r=0;r!==e.length;r++)if(e[r].almostEquals(l)||e[r].almostEquals(l)){p=!0;break}p||e.push(l.clone())}};d.prototype.computeNormals=function(){this.faceNormals.length=
this.faces.length;for(var c=0;c<this.faces.length;c++){for(var d=0;d<this.faces[c].length;d++)if(!this.vertices[this.faces[c][d]])throw Error("Vertex "+this.faces[c][d]+" not found!");d=this.faceNormals[c]||new f;this.getFaceNormal(c,d);d.negate(d);this.faceNormals[c]=d;if(0>d.dot(this.vertices[this.faces[c][0]])){console.error(".faceNormals["+c+"] = Vec3("+d.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");
for(d=0;d<this.faces[c].length;d++)console.warn(".vertices["+this.faces[c][d]+"] = Vec3("+this.vertices[this.faces[c][d]].toString()+")")}}};var g=new f,m=new f;d.computeNormal=function(c,d,e,f){d.vsub(c,m);e.vsub(d,g);g.cross(m,f);f.isZero()||f.normalize()};d.prototype.getFaceNormal=function(c,e){var g=this.faces[c];return d.computeNormal(this.vertices[g[0]],this.vertices[g[1]],this.vertices[g[2]],e)};var p=new f;d.prototype.clipAgainstHull=function(c,d,e,g,j,m,l,r,n){for(var s=-1,t=-Number.MAX_VALUE,
u=0;u<e.faces.length;u++){p.copy(e.faceNormals[u]);j.vmult(p,p);var v=p.dot(m);v>t&&(t=v,s=u)}for(var t=[],u=e.faces[s],v=u.length,y=0;y<v;y++){var z=e.vertices[u[y]],x=new f;x.copy(z);j.vmult(x,x);g.vadd(x,x);t.push(x)}0<=s&&this.clipFaceAgainstHull(m,c,d,t,l,r,n)};var r=new f,s=new f,t=new f,u=new f,v=new f,z=new f;d.prototype.findSeparatingAxis=function(c,d,e,g,f,j,m,p){var l=Number.MAX_VALUE,n=0;if(this.uniqueAxes)for(x=0;x!==this.uniqueAxes.length;x++){e.vmult(this.uniqueAxes[x],r);C=this.testSepAxis(r,
c,d,e,g,f);if(!1===C)return!1;C<l&&(l=C,j.copy(r))}else for(var y=m?m.length:this.faces.length,x=0;x<y;x++){C=m?m[x]:x;r.copy(this.faceNormals[C]);e.vmult(r,r);var C=this.testSepAxis(r,c,d,e,g,f);if(!1===C)return!1;C<l&&(l=C,j.copy(r))}if(c.uniqueAxes)for(x=0;x!==c.uniqueAxes.length;x++){f.vmult(c.uniqueAxes[x],s);n++;C=this.testSepAxis(s,c,d,e,g,f);if(!1===C)return!1;C<l&&(l=C,j.copy(s))}else{m=p?p.length:c.faces.length;for(x=0;x<m;x++){C=p?p[x]:x;s.copy(c.faceNormals[C]);f.vmult(s,s);n++;C=this.testSepAxis(s,
c,d,e,g,f);if(!1===C)return!1;C<l&&(l=C,j.copy(s))}}for(p=0;p!==this.uniqueEdges.length;p++){e.vmult(this.uniqueEdges[p],u);for(n=0;n!==c.uniqueEdges.length;n++)if(f.vmult(c.uniqueEdges[n],v),u.cross(v,z),!z.almostZero()){z.normalize();x=this.testSepAxis(z,c,d,e,g,f);if(!1===x)return!1;x<l&&(l=x,j.copy(z))}}g.vsub(d,t);0<t.dot(j)&&j.negate(j);return!0};var x=[],B=[];d.prototype.testSepAxis=function(c,e,g,f,j,m){d.project(this,c,g,f,x);d.project(e,c,j,m,B);g=x[0];c=x[1];e=B[0];f=B[1];if(g<f||e<c)return!1;
g-=f;c=e-c;return g<c?g:c};var A=new f,D=new f;d.prototype.calculateLocalInertia=function(c,d){this.computeLocalAABB(A,D);var e=D.x-A.x,g=D.y-A.y,f=D.z-A.z;d.x=1/12*c*(4*g*g+4*f*f);d.y=1/12*c*(4*e*e+4*f*f);d.z=1/12*c*(4*g*g+4*e*e)};d.prototype.getPlaneConstantOfFace=function(c){return-this.faceNormals[c].dot(this.vertices[this.faces[c][0]])};var I=new f,y=new f,C=new f,J=new f,M=new f,O=new f,N=new f,K=new f;d.prototype.clipFaceAgainstHull=function(c,d,e,g,f,j,m){for(var p=[],l=-1,r=Number.MAX_VALUE,
n=0;n<this.faces.length;n++){I.copy(this.faceNormals[n]);e.vmult(I,I);var s=I.dot(c);s<r&&(r=s,l=n)}if(!(0>l)){c=this.faces[l];c.connectedFaces=[];for(r=0;r<this.faces.length;r++)for(n=0;n<this.faces[r].length;n++)-1!==c.indexOf(this.faces[r][n])&&(r!==l&&-1===c.connectedFaces.indexOf(r))&&c.connectedFaces.push(r);r=c.length;for(n=0;n<r;n++){s=this.vertices[c[n]];s.vsub(this.vertices[c[(n+1)%r]],y);C.copy(y);e.vmult(C,C);d.vadd(C,C);J.copy(this.faceNormals[l]);e.vmult(J,J);d.vadd(J,J);C.cross(J,M);
M.negate(M);O.copy(s);e.vmult(O,O);d.vadd(O,O);O.dot(M);s=c.connectedFaces[n];N.copy(this.faceNormals[s]);s=this.getPlaneConstantOfFace(s);K.copy(N);e.vmult(K,K);s-=K.dot(d);for(this.clipFaceAgainstPlane(g,p,K,s);g.length;)g.shift();for(;p.length;)g.push(p.shift())}N.copy(this.faceNormals[l]);s=this.getPlaneConstantOfFace(l);K.copy(N);e.vmult(K,K);s-=K.dot(d);for(r=0;r<g.length;r++)d=K.dot(g[r])+s,d<=f&&(console.log("clamped: depth="+d+" to minDist="+(f+"")),d=f),d<=j&&(e=g[r],0>=d&&m.push({point:e,
normal:K,depth:d}))}};d.prototype.clipFaceAgainstPlane=function(c,d,e,g){var j,m,p=c.length;if(2>p)return d;var l=c[c.length-1],r=c[0];j=e.dot(l)+g;for(var n=0;n<p;n++){r=c[n];m=e.dot(r)+g;if(0>j){if(0>m){var s=new f;s.copy(r)}else s=new f,l.lerp(r,j/(j-m),s);d.push(s)}else 0>m&&(s=new f,l.lerp(r,j/(j-m),s),d.push(s),d.push(r));l=r;j=m}return d};d.prototype.computeWorldVertices=function(c,d){for(var e=this.vertices.length;this.worldVertices.length<e;)this.worldVertices.push(new f);for(var g=this.vertices,
j=this.worldVertices,m=0;m!==e;m++)d.vmult(g[m],j[m]),c.vadd(j[m],j[m]);this.worldVerticesNeedsUpdate=!1};new f;d.prototype.computeLocalAABB=function(c,d){var e=this.vertices.length,g=this.vertices;c.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);d.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var f=0;f<e;f++){var j=g[f];j.x<c.x?c.x=j.x:j.x>d.x&&(d.x=j.x);j.y<c.y?c.y=j.y:j.y>d.y&&(d.y=j.y);j.z<c.z?c.z=j.z:j.z>d.z&&(d.z=j.z)}};d.prototype.computeWorldFaceNormals=function(c){for(var d=
this.faceNormals.length;this.worldFaceNormals.length<d;)this.worldFaceNormals.push(new f);for(var e=this.faceNormals,g=this.worldFaceNormals,j=0;j!==d;j++)c.vmult(e[j],g[j]);this.worldFaceNormalsNeedsUpdate=!1};d.prototype.updateBoundingSphereRadius=function(){for(var c=0,d=this.vertices,e=0,g=d.length;e!==g;e++){var f=d[e].norm2();f>c&&(c=f)}this.boundingSphereRadius=Math.sqrt(c)};var V=new f;d.prototype.calculateWorldAABB=function(c,d,e,g){for(var f=this.vertices.length,j=this.vertices,m,p,l,r,
n,s,t=0;t<f;t++){V.copy(j[t]);d.vmult(V,V);c.vadd(V,V);var u=V;if(u.x<m||void 0===m)m=u.x;else if(u.x>r||void 0===r)r=u.x;if(u.y<p||void 0===p)p=u.y;else if(u.y>n||void 0===n)n=u.y;if(u.z<l||void 0===l)l=u.z;else if(u.z>s||void 0===s)s=u.z}e.set(m,p,l);g.set(r,n,s)};d.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3};d.prototype.getAveragePointLocal=function(c){c=c||new f;for(var d=this.vertices.length,e=this.vertices,g=0;g<d;g++)c.vadd(e[g],c);c.mult(1/d,c);return c};d.prototype.transformAllPoints=
function(c,d){var e=this.vertices.length,g=this.vertices;if(d){for(var f=0;f<e;f++){var j=g[f];d.vmult(j,j)}for(f=0;f<this.faceNormals.length;f++)j=this.faceNormals[f],d.vmult(j,j)}if(c)for(f=0;f<e;f++)j=g[f],j.vadd(c,j)};var da=new f,F=new f,H=new f;d.prototype.pointIsInside=function(c){var d=this.vertices.length,e=this.vertices,g=this.faces,f=this.faceNormals,j=this.faces.length;this.getAveragePointLocal(da);for(var m=0;m<j;m++){var d=f[m],p=e[g[m][0]],l=F;c.vsub(p,l);var l=d.dot(l),r=H;da.vsub(p,
r);d=d.dot(r);if(0>l&&0<d||0<l&&0>d)return!1}return-1};new f;var ia=new f,R=new f;d.project=function(c,d,e,g,f){var j=c.vertices.length,m=0,p=0;c=c.vertices;R.setZero();n.vectorToLocalFrame(e,g,d,ia);n.pointToLocalFrame(e,g,R,R);d=R.dot(ia);p=m=c[0].dot(ia);for(e=1;e<j;e++)g=c[e].dot(ia),g>m&&(m=g),g<p&&(p=g);p-=d;m-=d;p>m&&(j=p,p=m,m=j);f[0]=m;f[1]=p}},{"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"./Shape":43}],39:[function(c,e){function d(c,d,e,p){var r=[],s=[],t=[],u=[],v=
[],z=Math.cos,x=Math.sin;r.push(new f(d*z(0),d*x(0),0.5*-e));u.push(0);r.push(new f(c*z(0),c*x(0),0.5*e));v.push(1);for(var B=0;B<p;B++){var A=2*Math.PI/p*(B+1),D=2*Math.PI/p*(B+0.5);B<p-1?(r.push(new f(d*z(A),d*x(A),0.5*-e)),u.push(2*B+2),r.push(new f(c*z(A),c*x(A),0.5*e)),v.push(2*B+3),t.push([2*B+2,2*B+3,2*B+1,2*B])):t.push([0,1,2*B+1,2*B]);(1===p%2||B<p/2)&&s.push(new f(z(D),x(D),0))}t.push(v);s.push(new f(0,0,1));c=[];for(B=0;B<u.length;B++)c.push(u[u.length-B-1]);t.push(c);this.type=j.types.CONVEXPOLYHEDRON;
n.call(this,r,t,s)}e.exports=d;var j=c("./Shape"),f=c("../math/Vec3");c("../math/Quaternion");var n=c("./ConvexPolyhedron");d.prototype=new n},{"../math/Quaternion":28,"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],40:[function(c,e){function d(c,d){d=l.defaults(d,{maxValue:null,minValue:null,elementSize:1});this.data=c;this.maxValue=d.maxValue;this.minValue=d.minValue;this.elementSize=d.elementSize;null===d.minValue&&this.updateMinValue();null===d.maxValue&&this.updateMaxValue();this.cacheEnabled=
!0;j.call(this);this.pillarConvex=new f;this.pillarOffset=new n;this.type=j.types.HEIGHTFIELD;this.updateBoundingSphereRadius();this._cachedPillars={}}var j=c("./Shape"),f=c("./ConvexPolyhedron"),n=c("../math/Vec3"),l=c("../utils/Utils");e.exports=d;d.prototype=new j;d.prototype.update=function(){this._cachedPillars={}};d.prototype.updateMinValue=function(){for(var c=this.data,d=c[0][0],e=0;e!==c.length;e++)for(var f=0;f!==c[e].length;f++){var j=c[e][f];j<d&&(d=j)}this.minValue=d};d.prototype.updateMaxValue=
function(){for(var c=this.data,d=c[0][0],e=0;e!==c.length;e++)for(var f=0;f!==c[e].length;f++){var j=c[e][f];j>d&&(d=j)}this.maxValue=d};d.prototype.setHeightValueAtIndex=function(c,d,e){this.data[c][d]=e;this.clearCachedConvexTrianglePillar(c,d,!1);0<c&&(this.clearCachedConvexTrianglePillar(c-1,d,!0),this.clearCachedConvexTrianglePillar(c-1,d,!1));0<d&&(this.clearCachedConvexTrianglePillar(c,d-1,!0),this.clearCachedConvexTrianglePillar(c,d-1,!1));0<d&&0<c&&this.clearCachedConvexTrianglePillar(c-
1,d-1,!0)};d.prototype.getRectMinMax=function(c,d,e,f,j){j=j||[];for(var l=this.data,n=this.minValue;c<=e;c++)for(var v=d;v<=f;v++){var z=l[c][v];z>n&&(n=z)}j[0]=this.minValue;j[1]=n};d.prototype.getIndexOfPosition=function(c,d,e,f){var j=this.elementSize,l=this.data;c=Math.floor(c/j);d=Math.floor(d/j);e[0]=c;e[1]=d;f&&(0>c&&(c=0),0>d&&(d=0),c>=l.length-1&&(c=l.length-1),d>=l[0].length-1&&(d=l[0].length-1));return 0>c||0>d||c>=l.length-1||d>=l[0].length-1?!1:!0};d.prototype.getHeightAt=function(c,
d,e){var f=[];this.getIndexOfPosition(c,d,f,e);c=[];this.getRectMinMax(f[0],f[1]+1,f[0],f[1]+1,c);return(c[0]+c[1])/2};d.prototype.getCacheConvexTrianglePillarKey=function(c,d,e){return c+"_"+d+"_"+(e?1:0)};d.prototype.getCachedConvexTrianglePillar=function(c,d,e){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(c,d,e)]};d.prototype.setCachedConvexTrianglePillar=function(c,d,e,f,j){this._cachedPillars[this.getCacheConvexTrianglePillarKey(c,d,e)]={convex:f,offset:j}};d.prototype.clearCachedConvexTrianglePillar=
function(c,d,e){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(c,d,e)]};d.prototype.getConvexTrianglePillar=function(c,d,e){var j=this.pillarConvex,l=this.pillarOffset;if(this.cacheEnabled){var t=this.getCachedConvexTrianglePillar(c,d,e);if(t){this.pillarConvex=t.convex;this.pillarOffset=t.offset;return}j=new f;l=new n;this.pillarConvex=j;this.pillarOffset=l}var t=this.data,u=this.elementSize,v=j.faces;j.vertices.length=6;for(var z=0;6>z;z++)j.vertices[z]||(j.vertices[z]=new n);v.length=
5;for(z=0;5>z;z++)v[z]||(v[z]=[]);var z=j.vertices,x=(Math.min(t[c][d],t[c+1][d],t[c][d+1],t[c+1][d+1])-this.minValue)/2+this.minValue;e?(l.set((c+0.75)*u,(d+0.75)*u,x),z[0].set(0.25*u,0.25*u,t[c+1][d+1]-x),z[1].set(-0.75*u,0.25*u,t[c][d+1]-x),z[2].set(0.25*u,-0.75*u,t[c+1][d]-x),z[3].set(0.25*u,0.25*u,-x-1),z[4].set(-0.75*u,0.25*u,-x-1),z[5].set(0.25*u,-0.75*u,-x-1),v[0][0]=0,v[0][1]=1,v[0][2]=2,v[1][0]=5,v[1][1]=4,v[1][2]=3,v[2][0]=2,v[2][1]=5,v[2][2]=3,v[2][3]=0,v[3][0]=3,v[3][1]=4,v[3][2]=1,v[3][3]=
0,v[4][0]=1,v[4][1]=4,v[4][2]=5,v[4][3]=2):(l.set((c+0.25)*u,(d+0.25)*u,x),z[0].set(-0.25*u,-0.25*u,t[c][d]-x),z[1].set(0.75*u,-0.25*u,t[c+1][d]-x),z[2].set(-0.25*u,0.75*u,t[c][d+1]-x),z[3].set(-0.25*u,-0.25*u,-x-1),z[4].set(0.75*u,-0.25*u,-x-1),z[5].set(-0.25*u,0.75*u,-x-1),v[0][0]=0,v[0][1]=1,v[0][2]=2,v[1][0]=5,v[1][1]=4,v[1][2]=3,v[2][0]=0,v[2][1]=2,v[2][2]=5,v[2][3]=3,v[3][0]=1,v[3][1]=0,v[3][2]=3,v[3][3]=4,v[4][0]=4,v[4][1]=5,v[4][2]=2,v[4][3]=1);j.computeNormals();j.computeEdges();j.updateBoundingSphereRadius();
this.setCachedConvexTrianglePillar(c,d,e,j,l)};d.prototype.calculateLocalInertia=function(c,d){d=d||new n;d.set(0,0,0);return d};d.prototype.volume=function(){return Number.MAX_VALUE};d.prototype.calculateWorldAABB=function(c,d,e,f){e.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);f.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)};d.prototype.updateBoundingSphereRadius=function(){var c=this.data,d=this.elementSize;this.boundingSphereRadius=(new n(c.length*d,c[0].length*d,Math.max(Math.abs(this.maxValue),
Math.abs(this.minValue)))).norm()}},{"../math/Vec3":30,"../utils/Utils":53,"./ConvexPolyhedron":38,"./Shape":43}],41:[function(c,e){function d(){j.call(this);this.type=j.types.PARTICLE}e.exports=d;var j=c("./Shape"),f=c("../math/Vec3");d.prototype=new j;d.prototype.constructor=d;d.prototype.calculateLocalInertia=function(c,d){d=d||new f;d.set(0,0,0);return d};d.prototype.volume=function(){return 0};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=0};d.prototype.calculateWorldAABB=
function(c,d,e,f){e.copy(c);f.copy(c)}},{"../math/Vec3":30,"./Shape":43}],42:[function(c,e){function d(){j.call(this);this.type=j.types.PLANE;this.worldNormal=new f;this.worldNormalNeedsUpdate=!0;this.boundingSphereRadius=Number.MAX_VALUE}e.exports=d;var j=c("./Shape"),f=c("../math/Vec3");d.prototype=new j;d.prototype.constructor=d;d.prototype.computeWorldNormal=function(c){var d=this.worldNormal;d.set(0,0,1);c.vmult(d,d);this.worldNormalNeedsUpdate=!1};d.prototype.calculateLocalInertia=function(c,
d){return d=d||new f};d.prototype.volume=function(){return Number.MAX_VALUE};var n=new f;d.prototype.calculateWorldAABB=function(c,d,e,f){n.set(0,0,1);d.vmult(n,n);d=Number.MAX_VALUE;e.set(-d,-d,-d);f.set(d,d,d);1===n.x&&(f.x=c.x);1===n.y&&(f.y=c.y);1===n.z&&(f.z=c.z);-1===n.x&&(e.x=c.x);-1===n.y&&(e.y=c.y);-1===n.z&&(e.z=c.z)};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=Number.MAX_VALUE}},{"../math/Vec3":30,"./Shape":43}],43:[function(c,e){function d(){this.id=d.idCounter++;
this.boundingSphereRadius=this.type=0;this.collisionResponse=!0;this.material=null}e.exports=d;d=c("./Shape");c("../math/Vec3");c("../math/Quaternion");c("../material/Material");d.prototype.constructor=d;d.prototype.updateBoundingSphereRadius=function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type;};d.prototype.volume=function(){throw"volume() not implemented for shape type "+this.type;};d.prototype.calculateLocalInertia=function(){throw"calculateLocalInertia() not implemented for shape type "+
this.type;};d.idCounter=0;d.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"./Shape":43}],44:[function(c,e){function d(c){j.call(this);this.radius=void 0!==c?Number(c):1;this.type=j.types.SPHERE;if(0>this.radius)throw Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}e.exports=d;var j=c("./Shape"),f=c("../math/Vec3");d.prototype=new j;
d.prototype.constructor=d;d.prototype.calculateLocalInertia=function(c,d){d=d||new f;var e=2*c*this.radius*this.radius/5;d.x=e;d.y=e;d.z=e;return d};d.prototype.volume=function(){return 4*Math.PI*this.radius/3};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.radius};d.prototype.calculateWorldAABB=function(c,d,e,f){d=this.radius;for(var j=["x","y","z"],r=0;r<j.length;r++){var s=j[r];e[s]=c[s]-d;f[s]=c[s]+d}}},{"../math/Vec3":30,"./Shape":43}],45:[function(c,e){function d(c,
d){j.call(this);this.type=j.types.TRIMESH;this.vertices=new Float32Array(c);this.indices=new Int16Array(d);this.normals=new Float32Array(d.length);this.aabb=new l;this.edges=null;this.scale=new f(1,1,1);this.tree=new g;this.updateEdges();this.updateNormals();this.updateAABB();this.updateBoundingSphereRadius();this.updateTree()}e.exports=d;var j=c("./Shape"),f=c("../math/Vec3");c("../math/Quaternion");var n=c("../math/Transform"),l=c("../collision/AABB"),g=c("../utils/Octree");d.prototype=new j;d.prototype.constructor=
d;var m=new f;d.prototype.updateTree=function(){var c=this.tree;c.reset();c.aabb.copy(this.aabb);var d=this.scale;c.aabb.lowerBound.x*=1/d.x;c.aabb.lowerBound.y*=1/d.y;c.aabb.lowerBound.z*=1/d.z;c.aabb.upperBound.x*=1/d.x;c.aabb.upperBound.y*=1/d.y;c.aabb.upperBound.z*=1/d.z;for(var d=new l,e=new f,g=new f,j=new f,m=[e,g,j],p=0;p<this.indices.length/3;p++){var r=3*p;this._getUnscaledVertex(this.indices[r],e);this._getUnscaledVertex(this.indices[r+1],g);this._getUnscaledVertex(this.indices[r+2],j);
d.setFromPoints(m);c.insert(d,p)}c.removeEmptyNodes()};var p=new l;d.prototype.getTrianglesInAABB=function(c,d){p.copy(c);var e=this.scale,g=e.x,f=e.y,e=e.z,j=p.lowerBound,m=p.upperBound;j.x/=g;j.y/=f;j.z/=e;m.x/=g;m.y/=f;m.z/=e;return this.tree.aabbQuery(p,d)};d.prototype.setScale=function(c){var d=c.x===c.y===c.z;this.scale.x===this.scale.y===this.scale.z&&d||this.updateNormals();this.scale.copy(c);this.updateAABB();this.updateBoundingSphereRadius()};d.prototype.updateNormals=function(){for(var c=
this.normals,e=0;e<this.indices.length/3;e++){var g=3*e,f=this.indices[g+1],j=this.indices[g+2];this.getVertex(this.indices[g],v);this.getVertex(f,z);this.getVertex(j,x);d.computeNormal(z,v,x,m);c[g]=m.x;c[g+1]=m.y;c[g+2]=m.z}};d.prototype.updateEdges=function(){for(var c={},d=function(){c[f<j?f+"_"+j:j+"_"+f]=!0},e=0;e<this.indices.length/3;e++){var g=3*e,f=this.indices[g],j=this.indices[g+1],g=this.indices[g+2];d(f,j);d(j,g);d(g,f)}d=Object.keys(c);this.edges=new Int16Array(2*d.length);for(e=0;e<
d.length;e++)g=d[e].split("_"),this.edges[2*e]=parseInt(g[0],10),this.edges[2*e+1]=parseInt(g[1],10)};d.prototype.getEdgeVertex=function(c,d,e){this.getVertex(this.edges[2*c+(d?1:0)],e)};var r=new f,s=new f;d.prototype.getEdgeVector=function(c,d){this.getEdgeVertex(c,0,r);this.getEdgeVertex(c,1,s);s.vsub(r,d)};var t=new f,u=new f;d.computeNormal=function(c,d,e,g){d.vsub(c,u);e.vsub(d,t);t.cross(u,g);g.isZero()||g.normalize()};var v=new f,z=new f,x=new f;d.prototype.getVertex=function(c,d){var e=this.scale;
this._getUnscaledVertex(c,d);d.x*=e.x;d.y*=e.y;d.z*=e.z;return d};d.prototype._getUnscaledVertex=function(c,d){var e=3*c,g=this.vertices;return d.set(g[e],g[e+1],g[e+2])};d.prototype.getWorldVertex=function(c,d,e,g){this.getVertex(c,g);n.pointToWorldFrame(d,e,g,g);return g};d.prototype.getTriangleVertices=function(c,d,e,g){c*=3;this.getVertex(this.indices[c],d);this.getVertex(this.indices[c+1],e);this.getVertex(this.indices[c+2],g)};d.prototype.getNormal=function(c,d){var e=3*c;return d.set(this.normals[e],
this.normals[e+1],this.normals[e+2])};var B=new l;d.prototype.calculateLocalInertia=function(c,d){this.computeLocalAABB(B);var e=B.upperBound.x-B.lowerBound.x,g=B.upperBound.y-B.lowerBound.y,f=B.upperBound.z-B.lowerBound.z;return d.set(1/12*c*(4*g*g+4*f*f),1/12*c*(4*e*e+4*f*f),1/12*c*(4*g*g+4*e*e))};var A=new f;d.prototype.computeLocalAABB=function(c){var d=c.lowerBound;c=c.upperBound;var e=this.vertices.length;this.getVertex(0,A);d.copy(A);c.copy(A);for(var g=0;g!==e;g++)this.getVertex(g,A),A.x<
d.x?d.x=A.x:A.x>c.x&&(c.x=A.x),A.y<d.y?d.y=A.y:A.y>c.y&&(c.y=A.y),A.z<d.z?d.z=A.z:A.z>c.z&&(c.z=A.z)};d.prototype.updateAABB=function(){this.computeLocalAABB(this.aabb)};d.prototype.updateBoundingSphereRadius=function(){for(var c=0,d=this.vertices,e=new f,g=0,d=d.length/3;g!==d;g++){this.getVertex(g,e);var j=e.norm2();j>c&&(c=j)}this.boundingSphereRadius=Math.sqrt(c)};new f;var D=new n,I=new l;d.prototype.calculateWorldAABB=function(c,d,e,g){D.position=c;D.quaternion=d;this.aabb.toWorldFrame(D,I);
e.copy(I.lowerBound);g.copy(I.upperBound)};d.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3};d.createTorus=function(c,e,g,f,j){c=c||1;e=e||0.5;g=g||8;f=f||6;j=j||2*Math.PI;for(var m=[],p=[],l=0;l<=g;l++)for(var r=0;r<=f;r++){var n=r/f*j,s=2*l/g*Math.PI,t=(c+e*Math.cos(s))*Math.cos(n),n=(c+e*Math.cos(s))*Math.sin(n),s=e*Math.sin(s);m.push(t,n,s)}for(l=1;l<=g;l++)for(r=1;r<=f;r++)c=(f+1)*(l-1)+r-1,e=(f+1)*(l-1)+r,j=(f+1)*l+r,p.push((f+1)*l+r-1,c,j),p.push(c,e,j);return new d(m,
p)}},{"../collision/AABB":3,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../utils/Octree":50,"./Shape":43}],46:[function(c,e){function d(){j.call(this);this.iterations=10;this.tolerance=1E-7}e.exports=d;c("../math/Vec3");c("../math/Quaternion");var j=c("./Solver");d.prototype=new j;var f=[],n=[],l=[];d.prototype.solve=function(c,d){var e=0,j=this.iterations,s=this.tolerance*this.tolerance,t=this.equations,u=t.length,v=d.bodies,z=v.length,x,B,A,D,I;if(0!==u)for(A=0;A!==z;A++)v[A].updateSolveMassProperties();
n.length=u;l.length=u;f.length=u;for(A=0;A!==u;A++){var y=t[A];f[A]=0;l[A]=y.computeB(c);n[A]=1/y.computeC()}if(0!==u){for(A=0;A!==z;A++)y=v[A],e=y.wlambda,y.vlambda.set(0,0,0),e&&e.set(0,0,0);for(e=0;e!==j;e++){for(var C=A=0;C!==u;C++)y=t[C],x=l[C],B=n[C],I=f[C],D=y.computeGWlambda(),x=B*(x-D-y.eps*I),I+x<y.minForce?x=y.minForce-I:I+x>y.maxForce&&(x=y.maxForce-I),f[C]+=x,A+=0<x?x:-x,y.addToWlambda(x);if(A*A<s)break}for(A=0;A!==z;A++)y=v[A],j=y.velocity,s=y.angularVelocity,j.vadd(y.vlambda,j),s&&
s.vadd(y.wlambda,s)}return e}},{"../math/Quaternion":28,"../math/Vec3":30,"./Solver":47}],47:[function(c,e){function d(){this.equations=[]}e.exports=d;d.prototype.solve=function(){return 0};d.prototype.addEquation=function(c){c.enabled&&this.equations.push(c)};d.prototype.removeEquation=function(c){var d=this.equations;c=d.indexOf(c);-1!==c&&d.splice(c,1)};d.prototype.removeAllEquations=function(){this.equations.length=0}},{}],48:[function(c,e){function d(c){l.call(this);this.iterations=10;this.tolerance=
1E-7;this.subsolver=c;this.nodes=[];for(this.nodePool=[];128>this.nodePool.length;)this.nodePool.push(this.createNode())}function j(c){for(var d=c.length,e=0;e!==d;e++){var g=c[e];if(!g.visited&&!(g.body.type&s))return g}return!1}function f(c,d,e){d.push(c.body);d=c.eqs.length;for(var g=0;g!==d;g++){var f=c.eqs[g];-1===e.indexOf(f)&&e.push(f)}}function n(c,d){return d.id-c.id}e.exports=d;c("../math/Vec3");c("../math/Quaternion");var l=c("./Solver"),g=c("../objects/Body");d.prototype=new l;var m=[],
p=[],r={bodies:[]},s=g.STATIC,t=[];d.prototype.createNode=function(){return{body:null,children:[],eqs:[],visited:!1}};d.prototype.solve=function(c,d){for(var e=this.nodePool,g=d.bodies,l=this.equations,s=l.length,D=g.length,I=this.subsolver;e.length<D;)e.push(this.createNode());m.length=D;for(var y=0;y<D;y++)m[y]=e[y];for(y=0;y!==D;y++)e=m[y],e.body=g[y],e.children.length=0,e.eqs.length=0,e.visited=!1;for(D=0;D!==s;D++){var e=l[D],y=g.indexOf(e.bi),C=g.indexOf(e.bj),y=m[y],C=m[C];y.children.push(C);
y.eqs.push(e);C.children.push(y);C.eqs.push(e)}g=0;l=p;I.tolerance=this.tolerance;for(I.iterations=this.iterations;y=j(m);){l.length=0;r.bodies.length=0;e=y;y=f;s=r.bodies;D=l;t.push(e);e.visited=!0;for(y(e,s,D);t.length;)for(e=t.pop();C=j(e.children);)C.visited=!0,y(C,s,D),t.push(C);s=l.length;l=l.sort(n);for(y=0;y!==s;y++)I.addEquation(l[y]);I.solve(c,r);I.removeAllEquations();g++}return g}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"./Solver":47}],49:[function(c,e){var d=
function(){};e.exports=d;d.prototype={constructor:d,addEventListener:function(c,d){void 0===this._listeners&&(this._listeners={});var e=this._listeners;void 0===e[c]&&(e[c]=[]);-1===e[c].indexOf(d)&&e[c].push(d);return this},hasEventListener:function(c,d){if(void 0===this._listeners)return!1;var e=this._listeners;return void 0!==e[c]&&-1!==e[c].indexOf(d)?!0:!1},removeEventListener:function(c,d){if(void 0===this._listeners)return this;var e=this._listeners;if(void 0===e[c])return this;var l=e[c].indexOf(d);
-1!==l&&e[c].splice(l,1);return this},dispatchEvent:function(c){if(void 0===this._listeners)return this;var d=this._listeners[c.type];if(void 0!==d){c.target=this;for(var e=0,l=d.length;e<l;e++)d[e].call(this,c)}return this}}},{}],50:[function(c,e){function d(c){c=c||{};this.root=c.root||null;this.aabb=c.aabb?c.aabb.clone():new f;this.data=[];this.children=[]}function j(c,e){e=e||{};e.root=null;e.aabb=c;d.call(this,e);this.maxDepth="undefined"!==typeof e.maxDepth?e.maxDepth:8}var f=c("../collision/AABB"),
n=c("../math/Vec3");e.exports=j;j.prototype=new d;d.prototype.reset=function(){this.children.length=this.data.length=0};d.prototype.insert=function(c,d,e){var g=this.data;e=e||0;if(!this.aabb.contains(c))return!1;var f=this.children;if(e<(this.maxDepth||this.root.maxDepth)){var j=!1;f.length||(this.subdivide(),j=!0);for(var l=0;8!==l;l++)if(f[l].insert(c,d,e+1))return!0;j&&(f.length=0)}g.push(d);return!0};var l=new n;d.prototype.subdivide=function(){var c=this.aabb,e=c.lowerBound,g=c.upperBound,c=
this.children;c.push(new d({aabb:new f({lowerBound:new n(0,0,0)})}),new d({aabb:new f({lowerBound:new n(1,0,0)})}),new d({aabb:new f({lowerBound:new n(1,1,0)})}),new d({aabb:new f({lowerBound:new n(1,1,1)})}),new d({aabb:new f({lowerBound:new n(0,1,1)})}),new d({aabb:new f({lowerBound:new n(0,0,1)})}),new d({aabb:new f({lowerBound:new n(1,0,1)})}),new d({aabb:new f({lowerBound:new n(0,1,0)})}));g.vsub(e,l);l.scale(0.5,l);for(var g=this.root||this,j=0;8!==j;j++){var t=c[j];t.root=g;var u=t.aabb.lowerBound;
u.x*=l.x;u.y*=l.y;u.z*=l.z;u.vadd(e,u);u.vadd(l,t.aabb.upperBound)}};d.prototype.aabbQuery=function(c,d){for(var e=[this];e.length;){var g=e.pop();g.aabb.overlaps(c)&&Array.prototype.push.apply(d,g.data);Array.prototype.push.apply(e,g.children)}return d};var g=new f;d.prototype.rayQuery=function(c,d,e){c.getAABB(g);g.toLocalFrame(d,g);this.aabbQuery(g,e);return e};d.prototype.removeEmptyNodes=function(){for(var c=[this];c.length;){for(var d=c.pop(),e=d.children.length-1;0<=e;e--)d.children[e].data.length||
d.children.splice(e,1);Array.prototype.push.apply(c,d.children)}}},{"../collision/AABB":3,"../math/Vec3":30}],51:[function(c,e){function d(){this.objects=[];this.type=Object}e.exports=d;d.prototype.release=function(){for(var c=arguments.length,d=0;d!==c;d++)this.objects.push(arguments[d])};d.prototype.get=function(){return 0===this.objects.length?this.constructObject():this.objects.pop()};d.prototype.constructObject=function(){throw Error("constructObject() not implemented in this Pool subclass yet!");
}},{}],52:[function(c,e){function d(){this.data={keys:[]}}e.exports=d;d.prototype.get=function(c,d){if(c>d){var e=d;d=c;c=e}return this.data[c+"-"+d]};d.prototype.set=function(c,d,e){if(c>d){var l=d;d=c;c=l}l=c+"-"+d;this.get(c,d)||this.data.keys.push(l);this.data[l]=e};d.prototype.reset=function(){for(var c=this.data,d=c.keys;0<d.length;){var e=d.pop();delete c[e]}}},{}],53:[function(c,e){function d(){}e.exports=d;d.defaults=function(c,d){c=c||{};for(var e in d)e in c||(c[e]=d[e]);return c}},{}],
54:[function(c,e){function d(){f.call(this);this.type=j}e.exports=d;var j=c("../math/Vec3"),f=c("./Pool");d.prototype=new f;d.prototype.constructObject=function(){return new j}},{"../math/Vec3":30,"./Pool":51}],55:[function(c,e){function d(c){this.contactPointPool=[];this.frictionEquationPool=[];this.result=[];this.frictionResult=[];this.v3pool=new p;this.world=c;this.currentContactMaterial=null;this.enableFrictionReduction=!1}e.exports=d;var j=c("../collision/AABB"),f=c("../shapes/Shape"),n=c("../collision/Ray"),
l=c("../math/Vec3"),g=c("../math/Transform");c("../shapes/ConvexPolyhedron");var m=c("../math/Quaternion");c("../solver/Solver");var p=c("../utils/Vec3Pool"),r=c("../equations/ContactEquation"),s=c("../equations/FrictionEquation");d.prototype.createContactEquation=function(c,d,e,g,f,j){var m;this.contactPointPool.length?(m=this.contactPointPool.pop(),m.bi=c,m.bj=d):m=new r(c,d);m.enabled=c.collisionResponse&&d.collisionResponse&&e.collisionResponse&&g.collisionResponse;var p=this.currentContactMaterial;
m.restitution=p.restitution;m.setSpookParams(p.contactEquationStiffness,p.contactEquationRelaxation,this.world.dt);c=e.material||c.material;d=g.material||d.material;c&&(d&&0<=c.restitution&&0<=d.restitution)&&(m.restitution=c.restitution*d.restitution);m.si=f||e;m.sj=j||g;return m};d.prototype.createFrictionEquationsFromContact=function(c,d){var e=c.bi,g=c.bj,f=this.world,j=this.currentContactMaterial,m=j.friction,p=c.si.material||e.material,l=c.sj.material||g.material;p&&(l&&0<=p.friction&&0<=l.friction)&&
(m=p.friction*l.friction);if(0<m){m*=f.gravity.length();p=e.invMass+g.invMass;0<p&&(p=1/p);var r=this.frictionEquationPool,l=r.length?r.pop():new s(e,g,m*p),r=r.length?r.pop():new s(e,g,m*p);l.bi=r.bi=e;l.bj=r.bj=g;l.minForce=r.minForce=-m*p;l.maxForce=r.maxForce=m*p;l.ri.copy(c.ri);l.rj.copy(c.rj);r.ri.copy(c.ri);r.rj.copy(c.rj);c.ni.tangents(l.t,r.t);l.setSpookParams(j.frictionEquationStiffness,j.frictionEquationRelaxation,f.dt);r.setSpookParams(j.frictionEquationStiffness,j.frictionEquationRelaxation,
f.dt);l.enabled=r.enabled=c.enabled;d.push(l,r);return!0}return!1};var t=new l,u=new l,v=new l;d.prototype.createFrictionFromAverage=function(c){var d=this.result[this.result.length-1];if(this.createFrictionEquationsFromContact(d,this.frictionResult)&&1!==c){var e=this.frictionResult[this.frictionResult.length-2],g=this.frictionResult[this.frictionResult.length-1];t.setZero();u.setZero();v.setZero();for(var f=d.bi,j=0;j!==c;j++)d=this.result[this.result.length-1-j],d.bodyA!==f?(t.vadd(d.ni,t),u.vadd(d.ri,
u),v.vadd(d.rj,v)):(t.vsub(d.ni,t),u.vadd(d.rj,u),v.vadd(d.ri,v));c=1/c;u.scale(c,e.ri);v.scale(c,e.rj);g.ri.copy(e.ri);g.rj.copy(e.rj);t.normalize();t.tangents(e.t,g.t)}};var z=new l,x=new l,B=new m,A=new m;d.prototype.getContacts=function(c,d,e,g,f,j,m){this.contactPointPool=f;this.frictionEquationPool=m;this.result=g;this.frictionResult=j;g=0;for(f=c.length;g!==f;g++){j=c[g];m=d[g];var p=null;j.material&&m.material&&(p=e.getContactMaterial(j.material,m.material)||null);for(var l=0;l<j.shapes.length;l++){j.quaternion.mult(j.shapeOrientations[l],
B);j.quaternion.vmult(j.shapeOffsets[l],z);z.vadd(j.position,z);for(var r=j.shapes[l],n=0;n<m.shapes.length;n++){m.quaternion.mult(m.shapeOrientations[n],A);m.quaternion.vmult(m.shapeOffsets[n],x);x.vadd(m.position,x);var s=m.shapes[n];if(!(z.distanceTo(x)>r.boundingSphereRadius+s.boundingSphereRadius)){var q=null;r.material&&s.material&&(q=e.getContactMaterial(r.material,s.material)||null);this.currentContactMaterial=q||p||e.defaultContactMaterial;(q=this[r.type|s.type])&&(r.type<s.type?q.call(this,
r,s,z,x,B,A,j,m,r,s):q.call(this,s,r,x,z,A,B,m,j,r,s))}}}}};d.prototype[f.types.BOX|f.types.BOX]=d.prototype.boxBox=function(c,d,e,g,f,j,m,p){c.convexPolyhedronRepresentation.material=c.material;d.convexPolyhedronRepresentation.material=d.material;c.convexPolyhedronRepresentation.collisionResponse=c.collisionResponse;d.convexPolyhedronRepresentation.collisionResponse=d.collisionResponse;this.convexConvex(c.convexPolyhedronRepresentation,d.convexPolyhedronRepresentation,e,g,f,j,m,p,c,d)};d.prototype[f.types.BOX|
f.types.CONVEXPOLYHEDRON]=d.prototype.boxConvex=function(c,d,e,g,f,j,m,p){c.convexPolyhedronRepresentation.material=c.material;c.convexPolyhedronRepresentation.collisionResponse=c.collisionResponse;this.convexConvex(c.convexPolyhedronRepresentation,d,e,g,f,j,m,p,c,d)};d.prototype[f.types.BOX|f.types.PARTICLE]=d.prototype.boxParticle=function(c,d,e,g,f,j,m,p){c.convexPolyhedronRepresentation.material=c.material;c.convexPolyhedronRepresentation.collisionResponse=c.collisionResponse;this.convexParticle(c.convexPolyhedronRepresentation,
d,e,g,f,j,m,p,c,d)};d.prototype[f.types.SPHERE]=d.prototype.sphereSphere=function(c,d,e,g,f,j,m,p){f=this.createContactEquation(m,p,c,d);g.vsub(e,f.ni);f.ni.normalize();f.ri.copy(f.ni);f.rj.copy(f.ni);f.ri.mult(c.radius,f.ri);f.rj.mult(-d.radius,f.rj);f.ri.vadd(e,f.ri);f.ri.vsub(m.position,f.ri);f.rj.vadd(g,f.rj);f.rj.vsub(p.position,f.rj);this.result.push(f);this.createFrictionEquationsFromContact(f,this.frictionResult)};var D=new l,I=new l,y=new l;d.prototype[f.types.PLANE|f.types.TRIMESH]=d.prototype.planeTrimesh=
function(c,d,e,f,j,m,p,r){var n=new l;D.set(0,0,1);j.vmult(D,D);for(j=0;j<d.vertices.length/3;j++){d.getVertex(j,n);var s=new l;s.copy(n);g.pointToWorldFrame(f,m,s,n);s=I;n.vsub(e,s);if(0>=D.dot(s)){var q=this.createContactEquation(p,r,c,d);q.ni.copy(D);var t=y;D.scale(s.dot(D),t);n.vsub(t,t);q.ri.copy(t);q.ri.vsub(p.position,q.ri);q.rj.copy(n);q.rj.vsub(r.position,q.rj);this.result.push(q);this.createFrictionEquationsFromContact(q,this.frictionResult)}}};var C=new l,J=new l;new l;var M=new l,O=new l,
N=new l,K=new l,V=new l,da=new l,F=new l,H=new l,ia=new l,R=new l,L=new l,T=new j,Q=[];d.prototype[f.types.SPHERE|f.types.TRIMESH]=d.prototype.sphereTrimesh=function(c,d,e,f,j,m,p,l){g.pointToLocalFrame(f,m,e,F);j=c.radius;T.lowerBound.set(F.x-j,F.y-j,F.z-j);T.upperBound.set(F.x+j,F.y+j,F.z+j);d.getTrianglesInAABB(T,Q);var r=c.radius*c.radius;for(j=0;j<Q.length;j++)for(var s=0;3>s;s++)if(d.getVertex(d.indices[3*Q[j]+s],M),M.vsub(F,J),J.norm2()<=r){O.copy(M);g.pointToWorldFrame(f,m,O,M);M.vsub(e,J);
var q=this.createContactEquation(p,l,c,d);q.ni.copy(J);q.ni.normalize();q.ri.copy(q.ni);q.ri.scale(c.radius,q.ri);q.ri.vadd(e,q.ri);q.ri.vsub(p.position,q.ri);q.rj.copy(M);q.rj.vsub(l.position,q.rj);this.result.push(q);this.createFrictionEquationsFromContact(q,this.frictionResult)}for(j=0;j<Q.length;j++)for(s=0;3>s;s++)d.getVertex(d.indices[3*Q[j]+s],N),d.getVertex(d.indices[3*Q[j]+(s+1)%3],K),K.vsub(N,V),F.vsub(K,H),e=H.dot(V),F.vsub(N,H),q=H.dot(V),0<q&&0>e&&(F.vsub(N,H),da.copy(V),da.normalize(),
q=H.dot(da),da.scale(q,H),H.vadd(N,H),e=H.distanceTo(F),e<c.radius&&(q=this.createContactEquation(p,l,c,d),H.vsub(F,q.ni),q.ni.normalize(),q.ni.scale(c.radius,q.ri),g.pointToWorldFrame(f,m,H,H),H.vsub(l.position,q.rj),g.vectorToWorldFrame(m,q.ni,q.ni),g.vectorToWorldFrame(m,q.ri,q.ri),this.result.push(q),this.createFrictionEquationsFromContact(q,this.frictionResult)));j=0;for(s=Q.length;j!==s;j++)d.getTriangleVertices(Q[j],ia,R,L),d.getNormal(Q[j],C),F.vsub(ia,H),e=H.dot(C),C.scale(e,H),F.vsub(H,
H),e=H.distanceTo(F),n.pointInTriangle(H,ia,R,L)&&e<c.radius&&(q=this.createContactEquation(p,l,c,d),H.vsub(F,q.ni),q.ni.normalize(),q.ni.scale(c.radius,q.ri),g.pointToWorldFrame(f,m,H,H),H.vsub(l.position,q.rj),g.vectorToWorldFrame(m,q.ni,q.ni),g.vectorToWorldFrame(m,q.ri,q.ri),this.result.push(q),this.createFrictionEquationsFromContact(q,this.frictionResult));Q.length=0};var Z=new l,aa=new l;d.prototype[f.types.SPHERE|f.types.PLANE]=d.prototype.spherePlane=function(c,d,e,g,f,j,m,p){d=this.createContactEquation(m,
p,c,d);d.ni.set(0,0,1);j.vmult(d.ni,d.ni);d.ni.negate(d.ni);d.ni.normalize();d.ni.mult(c.radius,d.ri);e.vsub(g,Z);d.ni.mult(d.ni.dot(Z),aa);Z.vsub(aa,d.rj);-Z.dot(d.ni)<=c.radius&&(c=d.ri,j=d.rj,c.vadd(e,c),c.vsub(m.position,c),j.vadd(g,j),j.vsub(p.position,j),this.result.push(d),this.createFrictionEquationsFromContact(d,this.frictionResult))};var la=new l,qa=new l,ea=new l,oa=new l,E=new l,U=new l,ga=new l,G=[new l,new l,new l,new l,new l,new l],Xa=new l,pa=new l,Ia=new l,Oa=new l;d.prototype[f.types.SPHERE|
f.types.BOX]=d.prototype.sphereBox=function(c,d,e,g,f,j,m,p){f=this.v3pool;e.vsub(g,oa);d.getSideNormals(G,j);j=c.radius;for(var l=!1,r=null,n=0,s=0,q=0,t=null,u=0,v=G.length;u!==v&&!1===l;u++){var x=E;x.copy(G[u]);var z=x.norm();x.normalize();var y=oa.dot(x);if(y<z+j&&0<y){var F=U,A=ga;F.copy(G[(u+1)%3]);A.copy(G[(u+2)%3]);var B=F.norm(),H=A.norm();F.normalize();A.normalize();var D=oa.dot(F),C=oa.dot(A);if(D<B&&(D>-B&&C<H&&C>-H)&&(y=Math.abs(y-z-j),null===t||y<t))t=y,s=D,q=C,r=z,pa.copy(x),Ia.copy(F),
Oa.copy(A),n++}}n&&(l=!0,n=this.createContactEquation(m,p,c,d),pa.mult(-j,n.ri),n.ni.copy(pa),n.ni.negate(n.ni),pa.mult(r,pa),Ia.mult(s,Ia),pa.vadd(Ia,pa),Oa.mult(q,Oa),pa.vadd(Oa,n.rj),n.ri.vadd(e,n.ri),n.ri.vsub(m.position,n.ri),n.rj.vadd(g,n.rj),n.rj.vsub(p.position,n.rj),this.result.push(n),this.createFrictionEquationsFromContact(n,this.frictionResult));y=f.get();for(r=0;2!==r&&!l;r++)for(s=0;2!==s&&!l;s++)for(q=0;2!==q&&!l;q++)y.set(0,0,0),r?y.vadd(G[0],y):y.vsub(G[0],y),s?y.vadd(G[1],y):y.vsub(G[1],
y),q?y.vadd(G[2],y):y.vsub(G[2],y),g.vadd(y,Xa),Xa.vsub(e,Xa),Xa.norm2()<j*j&&(l=!0,n=this.createContactEquation(m,p,c,d),n.ri.copy(Xa),n.ri.normalize(),n.ni.copy(n.ri),n.ri.mult(j,n.ri),n.rj.copy(y),n.ri.vadd(e,n.ri),n.ri.vsub(m.position,n.ri),n.rj.vadd(g,n.rj),n.rj.vsub(p.position,n.rj),this.result.push(n),this.createFrictionEquationsFromContact(n,this.frictionResult));f.release(y);t=f.get();u=f.get();n=f.get();v=f.get();y=f.get();x=G.length;for(r=0;r!==x&&!l;r++)for(s=0;s!==x&&!l;s++)if(r%3!==
s%3){G[s].cross(G[r],t);t.normalize();G[r].vadd(G[s],u);n.copy(e);n.vsub(u,n);n.vsub(g,n);z=n.dot(t);t.mult(z,v);for(q=0;q===r%3||q===s%3;)q++;y.copy(e);y.vsub(v,y);y.vsub(u,y);y.vsub(g,y);z=Math.abs(z);F=y.norm();z<G[q].norm()&&F<j&&(l=!0,q=this.createContactEquation(m,p,c,d),u.vadd(v,q.rj),q.rj.copy(q.rj),y.negate(q.ni),q.ni.normalize(),q.ri.copy(q.rj),q.ri.vadd(g,q.ri),q.ri.vsub(e,q.ri),q.ri.normalize(),q.ri.mult(j,q.ri),q.ri.vadd(e,q.ri),q.ri.vsub(m.position,q.ri),q.rj.vadd(g,q.rj),q.rj.vsub(p.position,
q.rj),this.result.push(q),this.createFrictionEquationsFromContact(q,this.frictionResult))}f.release(t,u,n,v,y)};var Va=new l,cb=new l,vb=new l,db=new l,wb=new l,Lb=new l,ba=new l,q=new l,Mb=new l,Nb=new l;d.prototype[f.types.SPHERE|f.types.CONVEXPOLYHEDRON]=d.prototype.sphereConvex=function(c,d,e,g,f,j,m,p){f=this.v3pool;e.vsub(g,Va);for(var l=d.faceNormals,r=d.faces,n=d.vertices,s=c.radius,t=0;t!==n.length;t++){var u=wb;j.vmult(n[t],u);g.vadd(u,u);var v=db;u.vsub(e,v);if(v.norm2()<s*s){c=this.createContactEquation(m,
p,c,d);c.ri.copy(v);c.ri.normalize();c.ni.copy(c.ri);c.ri.mult(s,c.ri);u.vsub(g,c.rj);c.ri.vadd(e,c.ri);c.ri.vsub(m.position,c.ri);c.rj.vadd(g,c.rj);c.rj.vsub(p.position,c.rj);this.result.push(c);this.createFrictionEquationsFromContact(c,this.frictionResult);return}}t=0;for(u=r.length;t!==u;t++){var v=r[t],y=Lb;j.vmult(l[t],y);var x=ba;j.vmult(n[v[0]],x);x.vadd(g,x);var z=q;y.mult(-s,z);e.vadd(z,z);var F=Mb;z.vsub(x,F);z=F.dot(y);F=Nb;e.vsub(x,F);if(0>z&&0<F.dot(y)){for(var x=[],F=0,E=v.length;F!==
E;F++){var A=f.get();j.vmult(n[v[F]],A);g.vadd(A,A);x.push(A)}a:{for(var F=x,E=y,A=e,B=null,H=F.length,D=0;D!==H;D++){var C=F[D],U=la;F[(D+1)%H].vsub(C,U);var T=qa;U.cross(E,T);U=ea;A.vsub(C,U);C=T.dot(U);if(null===B||0<C&&!0===B||0>=C&&!1===B)null===B&&(B=0<C);else{F=!1;break a}}F=!0}if(F){c=this.createContactEquation(m,p,c,d);y.mult(-s,c.ri);y.negate(c.ni);d=f.get();y.mult(-z,d);j=f.get();y.mult(-s,j);e.vsub(g,c.rj);c.rj.vadd(j,c.rj);c.rj.vadd(d,c.rj);c.rj.vadd(g,c.rj);c.rj.vsub(p.position,c.rj);
c.ri.vadd(e,c.ri);c.ri.vsub(m.position,c.ri);f.release(d);f.release(j);this.result.push(c);this.createFrictionEquationsFromContact(c,this.frictionResult);F=0;for(v=x.length;F!==v;F++)f.release(x[F]);break}else for(F=0;F!==v.length;F++){y=f.get();z=f.get();j.vmult(n[v[(F+1)%v.length]],y);j.vmult(n[v[(F+2)%v.length]],z);g.vadd(y,y);g.vadd(z,z);H=cb;z.vsub(y,H);B=vb;H.unit(B);E=f.get();A=f.get();e.vsub(y,A);D=A.dot(B);B.mult(D,E);E.vadd(y,E);B=f.get();E.vsub(e,B);if(0<D&&D*D<H.norm2()&&B.norm2()<s*s){c=
this.createContactEquation(m,p,c,d);E.vsub(g,c.rj);E.vsub(e,c.ni);c.ni.normalize();c.ni.mult(s,c.ri);c.rj.vadd(g,c.rj);c.rj.vsub(p.position,c.rj);c.ri.vadd(e,c.ri);c.ri.vsub(m.position,c.ri);this.result.push(c);this.createFrictionEquationsFromContact(c,this.frictionResult);F=0;for(v=x.length;F!==v;F++)f.release(x[F]);f.release(y);f.release(z);f.release(E);f.release(B);f.release(A);return}f.release(y);f.release(z);f.release(E);f.release(B);f.release(A)}F=0;for(v=x.length;F!==v;F++)f.release(x[F])}}};
new l;new l;d.prototype[f.types.PLANE|f.types.BOX]=d.prototype.planeBox=function(c,d,e,g,f,j,m,p){d.convexPolyhedronRepresentation.material=d.material;d.convexPolyhedronRepresentation.collisionResponse=d.collisionResponse;this.planeConvex(c,d.convexPolyhedronRepresentation,e,g,f,j,m,p)};var Da=new l,Ja=new l,va=new l,lb=new l;d.prototype[f.types.PLANE|f.types.CONVEXPOLYHEDRON]=d.prototype.planeConvex=function(c,d,e,g,f,j,m,p){Ja.set(0,0,1);f.vmult(Ja,Ja);for(var l=f=0;l!==d.vertices.length;l++)if(Da.copy(d.vertices[l]),
j.vmult(Da,Da),g.vadd(Da,Da),Da.vsub(e,va),0>=Ja.dot(va)){var r=this.createContactEquation(m,p,c,d),n=lb;Ja.mult(Ja.dot(va),n);Da.vsub(n,n);n.vsub(e,r.ri);r.ni.copy(Ja);Da.vsub(g,r.rj);r.ri.vadd(e,r.ri);r.ri.vsub(m.position,r.ri);r.rj.vadd(g,r.rj);r.rj.vsub(p.position,r.rj);this.result.push(r);f++;this.enableFrictionReduction||this.createFrictionEquationsFromContact(r,this.frictionResult)}this.enableFrictionReduction&&f&&this.createFrictionFromAverage(f)};var X=new l,Ra=new l;d.prototype[f.types.CONVEXPOLYHEDRON]=
d.prototype.convexConvex=function(c,d,e,g,f,j,m,p,l,r,n,q){if(!(e.distanceTo(g)>c.boundingSphereRadius+d.boundingSphereRadius)&&c.findSeparatingAxis(d,e,f,g,j,X,n,q)){n=[];c.clipAgainstHull(e,f,d,g,j,X,-100,100,n);for(j=f=0;j!==n.length;j++){q=this.createContactEquation(m,p,c,d,l,r);var s=q.ri,t=q.rj;X.negate(q.ni);n[j].normal.negate(Ra);Ra.mult(n[j].depth,Ra);n[j].point.vadd(Ra,s);t.copy(n[j].point);s.vsub(e,s);t.vsub(g,t);s.vadd(e,s);s.vsub(m.position,s);t.vadd(g,t);t.vsub(p.position,t);this.result.push(q);
f++;this.enableFrictionReduction||this.createFrictionEquationsFromContact(q,this.frictionResult)}this.enableFrictionReduction&&f&&this.createFrictionFromAverage(f)}};var ja=new l,sa=new l,Sa=new l;d.prototype[f.types.PLANE|f.types.PARTICLE]=d.prototype.planeParticle=function(c,d,e,g,f,j,m,p){ja.set(0,0,1);m.quaternion.vmult(ja,ja);g.vsub(m.position,sa);0>=ja.dot(sa)&&(c=this.createContactEquation(p,m,d,c),c.ni.copy(ja),c.ni.negate(c.ni),c.ri.set(0,0,0),ja.mult(ja.dot(g),Sa),g.vsub(Sa,Sa),c.rj.copy(Sa),
this.result.push(c),this.createFrictionEquationsFromContact(c,this.frictionResult))};var Ka=new l;d.prototype[f.types.PARTICLE|f.types.SPHERE]=d.prototype.sphereParticle=function(c,d,e,g,f,j,m,p){Ka.set(0,0,1);g.vsub(e,Ka);Ka.norm2()<=c.radius*c.radius&&(d=this.createContactEquation(p,m,d,c),Ka.normalize(),d.rj.copy(Ka),d.rj.mult(c.radius,d.rj),d.ni.copy(Ka),d.ni.negate(d.ni),d.ri.set(0,0,0),this.result.push(d),this.createFrictionEquationsFromContact(d,this.frictionResult))};var zb=new m,Ta=new l;
new l;var eb=new l,Fa=new l,Ea=new l;d.prototype[f.types.PARTICLE|f.types.CONVEXPOLYHEDRON]=d.prototype.convexParticle=function(c,d,e,g,f,j,m,p){var l=-1;j=null;var r=0;Ta.copy(g);Ta.vsub(e,Ta);f.conjugate(zb);zb.vmult(Ta,Ta);if(c.pointIsInside(Ta)){c.worldVerticesNeedsUpdate&&c.computeWorldVertices(e,f);c.worldFaceNormalsNeedsUpdate&&c.computeWorldFaceNormals(f);f=0;for(var n=c.faces.length;f!==n;f++){var q=c.worldFaceNormals[f];g.vsub(c.worldVertices[c.faces[f][0]],Fa);var s=-q.dot(Fa);if(null===
j||Math.abs(s)<Math.abs(j))j=s,l=f,eb.copy(q),r++}-1!==l?(c=this.createContactEquation(p,m,d,c),eb.mult(j,Ea),Ea.vadd(g,Ea),Ea.vsub(e,Ea),c.rj.copy(Ea),eb.negate(c.ni),c.ri.set(0,0,0),d=c.ri,j=c.rj,d.vadd(g,d),d.vsub(p.position,d),j.vadd(e,j),j.vsub(m.position,j),this.result.push(c),this.createFrictionEquationsFromContact(c,this.frictionResult)):console.warn("Point found inside convex, but did not find penetrating face!")}};d.prototype[f.types.BOX|f.types.HEIGHTFIELD]=d.prototype.boxHeightfield=function(c,
d,e,g,f,j,m,p){c.convexPolyhedronRepresentation.material=c.material;c.convexPolyhedronRepresentation.collisionResponse=c.collisionResponse;this.convexHeightfield(c.convexPolyhedronRepresentation,d,e,g,f,j,m,p)};var Ga=new l,za=new l,Ya=[0];d.prototype[f.types.CONVEXPOLYHEDRON|f.types.HEIGHTFIELD]=d.prototype.convexHeightfield=function(c,d,e,f,j,m,p,l){var r=d.data,n=d.elementSize,q=c.boundingSphereRadius;g.pointToLocalFrame(f,m,e,Ga);var s=Math.floor((Ga.x-q)/n)-1,t=Math.ceil((Ga.x+q)/n)+1,u=Math.floor((Ga.y-
q)/n)-1,n=Math.ceil((Ga.y+q)/n)+1;if(!(0>t||0>n||s>r.length||u>r[0].length)){0>s&&(s=0);0>t&&(t=0);0>u&&(u=0);0>n&&(n=0);s>=r.length&&(s=r.length-1);t>=r.length&&(t=r.length-1);n>=r[0].length&&(n=r[0].length-1);u>=r[0].length&&(u=r[0].length-1);r=[];d.getRectMinMax(s,u,t,n,r);var v=r[0];if(!(Ga.z-q>r[1]||Ga.z+q<v))for(q=s;q<t;q++)for(s=u;s<n;s++)d.getConvexTrianglePillar(q,s,!1),g.pointToWorldFrame(f,m,d.pillarOffset,za),e.distanceTo(za)<d.pillarConvex.boundingSphereRadius+c.boundingSphereRadius&&
this.convexConvex(c,d.pillarConvex,e,za,j,m,p,l,null,null,Ya,null),d.getConvexTrianglePillar(q,s,!0),g.pointToWorldFrame(f,m,d.pillarOffset,za),e.distanceTo(za)<d.pillarConvex.boundingSphereRadius+c.boundingSphereRadius&&this.convexConvex(c,d.pillarConvex,e,za,j,m,p,l,null,null,Ya,null)}};var Aa=new l,Ba=new l;d.prototype[f.types.SPHERE|f.types.HEIGHTFIELD]=d.prototype.sphereHeightfield=function(c,d,e,f,j,m,p,l){var r=d.data,n=c.radius,q=d.elementSize;g.pointToLocalFrame(f,m,e,Aa);var s=Math.floor((Aa.x-
n)/q)-1,t=Math.ceil((Aa.x+n)/q)+1,u=Math.floor((Aa.y-n)/q)-1,q=Math.ceil((Aa.y+n)/q)+1;if(!(0>t||0>q||s>r.length||q>r[0].length)){0>s&&(s=0);0>t&&(t=0);0>u&&(u=0);0>q&&(q=0);s>=r.length&&(s=r.length-1);t>=r.length&&(t=r.length-1);q>=r[0].length&&(q=r[0].length-1);u>=r[0].length&&(u=r[0].length-1);r=[];d.getRectMinMax(s,u,t,q,r);var v=r[0];if(!(Aa.z-n>r[1]||Aa.z+n<v))for(n=this.result;s<t;s++)for(r=u;r<q;r++)if(v=n.length,d.getConvexTrianglePillar(s,r,!1),g.pointToWorldFrame(f,m,d.pillarOffset,Ba),
e.distanceTo(Ba)<d.pillarConvex.boundingSphereRadius+c.boundingSphereRadius&&this.sphereConvex(c,d.pillarConvex,e,Ba,j,m,p,l),d.getConvexTrianglePillar(s,r,!0),g.pointToWorldFrame(f,m,d.pillarOffset,Ba),e.distanceTo(Ba)<d.pillarConvex.boundingSphereRadius+c.boundingSphereRadius&&this.sphereConvex(c,d.pillarConvex,e,Ba,j,m,p,l),2<n.length-v)return}}},{"../collision/AABB":3,"../collision/Ray":9,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../math/Quaternion":28,"../math/Transform":29,
"../math/Vec3":30,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43,"../solver/Solver":47,"../utils/Vec3Pool":54}],56:[function(c,e){function d(){g.apply(this);this.dt=-1;this.allowSleep=!1;this.contacts=[];this.frictionEquations=[];this.quatNormalizeSkip=0;this.quatNormalizeFast=!1;this.stepnumber=this.time=0;this.default_dt=1/60;this.nextId=0;this.gravity=new j;this.broadphase=new x;this.bodies=[];this.solver=new n;this.constraints=[];this.narrowphase=new l(this);this.collisionMatrix=new m;this.collisionMatrixPrevious=
new m;this.materials=[];this.contactmaterials=[];this.contactMaterialTable=new t;this.defaultMaterial=new p("default");this.defaultContactMaterial=new r(this.defaultMaterial,this.defaultMaterial,{friction:0.3,restitution:0});this.doProfiling=!1;this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0};this.subsystems=[];this.addBodyEvent={type:"addBody",body:null};this.removeBodyEvent={type:"removeBody",body:null}}e.exports=d;c("../shapes/Shape");var j=c("../math/Vec3"),
f=c("../math/Quaternion"),n=c("../solver/GSSolver");c("../utils/Vec3Pool");c("../equations/ContactEquation");c("../equations/FrictionEquation");var l=c("./Narrowphase"),g=c("../utils/EventTarget"),m=c("../collision/ArrayCollisionMatrix"),p=c("../material/Material"),r=c("../material/ContactMaterial"),s=c("../objects/Body"),t=c("../utils/TupleDictionary"),u=c("../collision/RaycastResult"),v=c("../collision/AABB"),z=c("../collision/Ray"),x=c("../collision/NaiveBroadphase");d.prototype=new g;new v;var B=
new z;d.prototype.getContactMaterial=function(c,d){return this.contactMaterialTable.get(c.id,d.id)};d.prototype.numObjects=function(){return this.bodies.length};d.prototype.collisionMatrixTick=function(){var c=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix;this.collisionMatrix=c;this.collisionMatrix.reset()};d.prototype.add=d.prototype.addBody=function(c){-1===this.bodies.indexOf(c)&&(c.index=this.bodies.length,this.bodies.push(c),c.world=this,c.initPosition.copy(c.position),
c.initVelocity.copy(c.velocity),c.timeLastSleepy=this.time,c instanceof s&&(c.initAngularVelocity.copy(c.angularVelocity),c.initQuaternion.copy(c.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=c,this.dispatchEvent(this.addBodyEvent))};d.prototype.addConstraint=function(c){this.constraints.push(c)};d.prototype.removeConstraint=function(c){c=this.constraints.indexOf(c);-1!==c&&this.constraints.splice(c,1)};d.prototype.rayTest=function(c,d,e){e instanceof u?
this.raycastClosest(c,d,{skipBackfaces:!0},e):this.raycastAll(c,d,{skipBackfaces:!0},e)};d.prototype.raycastAll=function(c,d,e,g){e.mode=z.ALL;e.from=c;e.to=d;e.callback=g;return B.intersectWorld(this,e)};d.prototype.raycastAny=function(c,d,e,g){e.mode=z.ANY;e.from=c;e.to=d;e.result=g;return B.intersectWorld(this,e)};d.prototype.raycastClosest=function(c,d,e,g){e.mode=z.CLOSEST;e.from=c;e.to=d;e.result=g;return B.intersectWorld(this,e)};d.prototype.remove=function(c){c.world=null;var d=this.bodies.length-
1,e=this.bodies,g=e.indexOf(c);if(-1!==g){e.splice(g,1);for(g=0;g!==e.length;g++)e[g].index=g;this.collisionMatrix.setNumObjects(d);this.removeBodyEvent.body=c;this.dispatchEvent(this.removeBodyEvent)}};d.prototype.removeBody=d.prototype.remove;d.prototype.addMaterial=function(c){this.materials.push(c)};d.prototype.addContactMaterial=function(c){this.contactmaterials.push(c);this.contactMaterialTable.set(c.materials[0].id,c.materials[1].id,c)};"undefined"===typeof performance&&(performance={});if(!performance.now){var A=
Date.now();performance.timing&&performance.timing.navigationStart&&(A=performance.timing.navigationStart);performance.now=function(){return Date.now()-A}}var D=new j;d.prototype.step=function(c,d,e){e=e||10;d=d||0;if(0===d)this.internalStep(c),this.time+=c;else{var g=Math.floor((this.time+d)/c)-Math.floor(this.time/c),g=Math.min(g,e);e=performance.now();for(var f=0;f!==g&&!(this.internalStep(c),performance.now()-e>1E3*c);f++);this.time+=d;c=this.time%c/c;d=this.bodies;for(g=0;g!==d.length;g++)e=d[g],
e.type!==s.STATIC&&e.sleepState!==s.SLEEPING?(e.position.vsub(e.previousPosition,D),D.scale(c,D),e.position.vadd(D,e.interpolatedPosition)):(e.interpolatedPosition.copy(e.position),e.interpolatedQuaternion.copy(e.quaternion))}};var I={type:"postStep"},y={type:"preStep"},C={type:"collide",body:null,contact:null},J=[],M=[],O=[],N=[];new j;new j;new j;new j;new j;new j;new j;new j;new j;new f;var K=new f,V=new f,da=new j;d.prototype.internalStep=function(c){this.dt=c;var d=this.contacts,e=this.numObjects(),
g=this.bodies,f=this.solver,j=this.gravity,m=this.doProfiling,p=this.profile,l=s.DYNAMIC,r,n=this.constraints;j.norm();var t=j.x,u=j.y,v=j.z,j=0;m&&(r=performance.now());for(j=0;j!==e;j++){var x=g[j];if(x.type&l){var z=x.force,x=x.mass;z.x+=x*t;z.y+=x*u;z.z+=x*v}}j=0;for(x=this.subsystems.length;j!==x;j++)this.subsystems[j].update();m&&(r=performance.now());O.length=0;N.length=0;this.broadphase.collisionPairs(this,O,N);m&&(p.broadphase=performance.now()-r);x=n.length;for(j=0;j!==x;j++)if(t=n[j],!t.collideConnected)for(u=
O.length-1;0<=u;u-=1)if(t.bodyA===O[u]&&t.bodyB===N[u]||t.bodyB===O[u]&&t.bodyA===N[u])O.splice(u,1),N.splice(u,1);this.collisionMatrixTick();m&&(r=performance.now());x=d.length;for(j=0;j!==x;j++)J.push(d[j]);d.length=0;x=this.frictionEquations.length;for(j=0;j!==x;j++)M.push(this.frictionEquations[j]);this.frictionEquations.length=0;this.narrowphase.getContacts(O,N,this,d,J,this.frictionEquations,M);m&&(p.narrowphase=performance.now()-r);m&&(r=performance.now());for(j=0;j<this.frictionEquations.length;j++)f.addEquation(this.frictionEquations[j]);
j=d.length;for(u=0;u!==j;u++){t=d[u];x=t.bi;v=t.bj;x.material&&v.material&&this.getContactMaterial(x.material,v.material);x.material&&v.material&&(0<=x.material.restitution&&0<=v.material.restitution)&&(t.restitution=x.material.restitution*v.material.restitution);f.addEquation(t);if(x.allowSleep&&x.type===s.DYNAMIC&&x.sleepState===s.SLEEPING&&v.sleepState===s.AWAKE&&v.type!==s.STATIC){var z=v.velocity.norm2()+v.angularVelocity.norm2(),A=Math.pow(v.sleepSpeedLimit,2);z>=2*A&&(x._wakeUpAfterNarrowphase=
!0)}v.allowSleep&&(v.type===s.DYNAMIC&&v.sleepState===s.SLEEPING&&x.sleepState===s.AWAKE&&x.type!==s.STATIC)&&(z=x.velocity.norm2()+x.angularVelocity.norm2(),A=Math.pow(x.sleepSpeedLimit,2),z>=2*A&&(v._wakeUpAfterNarrowphase=!0));this.collisionMatrix.set(x,v,!0);this.collisionMatrixPrevious.get(x,v)||(C.body=v,C.contact=t,x.dispatchEvent(C),C.body=x,v.dispatchEvent(C))}m&&(p.makeContactConstraints=performance.now()-r,r=performance.now());for(j=0;j!==e;j++)x=g[j],x._wakeUpAfterNarrowphase&&(x.wakeUp(),
x._wakeUpAfterNarrowphase=!1);x=n.length;for(j=0;j!==x;j++){t=n[j];t.update();u=0;for(d=t.equations.length;u!==d;u++)f.addEquation(t.equations[u])}f.solve(c,this);m&&(p.solve=performance.now()-r);f.removeAllEquations();f=Math.pow;for(j=0;j!==e;j++)if(x=g[j],x.type&l&&(n=f(1-x.linearDamping,c),d=x.velocity,d.mult(n,d),n=x.angularVelocity))d=f(1-x.angularDamping,c),n.mult(d,n);this.dispatchEvent(y);for(j=0;j!==e;j++)x=g[j],x.preStep&&x.preStep.call(x);m&&(r=performance.now());l=s.DYNAMIC|s.KINEMATIC;
f=0===this.stepnumber%(this.quatNormalizeSkip+1);n=this.quatNormalizeFast;d=0.5*c;for(j=0;j!==e;j++)if(x=g[j],t=x.force,u=x.torque,x.type&l&&x.sleepState!==s.SLEEPING){var v=x.velocity,z=x.angularVelocity,A=x.position,B=x.quaternion,D=x.invMass,Ia=x.invInertiaWorld;v.x+=t.x*D*c;v.y+=t.y*D*c;v.z+=t.z*D*c;x.angularVelocity&&(Ia.vmult(u,da),da.mult(c,da),da.vadd(z,z));A.x+=v.x*c;A.y+=v.y*c;A.z+=v.z*c;x.angularVelocity&&(K.set(z.x,z.y,z.z,0),K.mult(B,V),B.x+=d*V.x,B.y+=d*V.y,B.z+=d*V.z,B.w+=d*V.w,f&&
(n?B.normalizeFast():B.normalize()));x.aabb&&(x.aabbNeedsUpdate=!0);x.updateInertiaWorld&&x.updateInertiaWorld()}this.clearForces();this.broadphase.dirty=!0;m&&(p.integrate=performance.now()-r);this.time+=c;this.stepnumber+=1;this.dispatchEvent(I);for(j=0;j!==e;j++)x=g[j],(c=x.postStep)&&c.call(x);if(this.allowSleep)for(j=0;j!==e;j++)g[j].sleepTick(this.time)};d.prototype.clearForces=function(){for(var c=this.bodies,d=c.length,e=0;e!==d;e++){var g=c[e];g.force.set(0,0,0);g.torque.set(0,0,0)}}},{"../collision/AABB":3,
"../collision/ArrayCollisionMatrix":4,"../collision/NaiveBroadphase":7,"../collision/Ray":9,"../collision/RaycastResult":10,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../material/ContactMaterial":24,"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Shape":43,"../solver/GSSolver":46,"../utils/EventTarget":49,"../utils/TupleDictionary":52,"../utils/Vec3Pool":54,"./Narrowphase":55}]},{},[2])(2)});function getInternetExplorerVersion(){var b=-1;"Microsoft Internet Explorer"==navigator.appName&&null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(b=parseFloat(RegExp.$1));return b}var ie=getInternetExplorerVersion();function getQueryVariable(b){for(var c=window.location.search.substring(1).split("&"),e=0;e<c.length;e++){var d=c[e].match(/([^=]+?)=(.+)/);if(d&&decodeURIComponent(d[1])==b)return decodeURIComponent(d[2])}};this.jukebox={};
jukebox.Player=function(b,c){this.id=++jukebox.__jukeboxId;this.origin=c||null;this.settings={};for(var e in this.defaults)this.settings[e]=this.defaults[e];if("[object Object]"===Object.prototype.toString.call(b))for(var d in b)this.settings[d]=b[d];"[object Function]"===Object.prototype.toString.call(jukebox.Manager)&&(jukebox.Manager=new jukebox.Manager);this.resource=this.isPlaying=null;this.resource="[object Object]"===Object.prototype.toString.call(jukebox.Manager)?jukebox.Manager.getPlayableResource(this.settings.resources):this.settings.resources[0]||
null;if(null===this.resource)throw"Your browser can't playback the given resources - or you have missed to include jukebox.Manager";this.__init();return this};jukebox.__jukeboxId=0;
jukebox.Player.prototype={defaults:{resources:[],autoplay:!1,spritemap:{},flashMediaElement:"./swf/FlashMediaElement.swf",timeout:1E3},__addToManager:function(){!0!==this.__wasAddedToManager&&(jukebox.Manager.add(this),this.__wasAddedToManager=!0)},__init:function(){var b=this,c=this.settings,e={},d;jukebox.Manager&&void 0!==jukebox.Manager.features&&(e=jukebox.Manager.features);if(!0===e.html5audio){this.context=new Audio;this.context.src=this.resource;if(null===this.origin){var j=function(c){b.__addToManager(c)};
this.context.addEventListener("canplaythrough",j,!0);window.setTimeout(function(){b.context.removeEventListener("canplaythrough",j,!0);j("timeout")},c.timeout)}this.context.autobuffer=!0;this.context.preload=!0;for(d in this.HTML5API)this[d]=this.HTML5API[d];1<e.channels?!0===c.autoplay?this.context.autoplay=!0:void 0!==c.spritemap[c.autoplay]&&this.play(c.autoplay):1===e.channels&&void 0!==c.spritemap[c.autoplay]&&(this.backgroundMusic=c.spritemap[c.autoplay],this.backgroundMusic.started=Date.now?
Date.now():+new Date,this.play(c.autoplay));1==e.channels&&!0!==c.canPlayBackground&&(window.addEventListener("pagehide",function(){null!==b.isPlaying&&(b.pause(),b.__wasAutoPaused=!0)}),window.addEventListener("pageshow",function(){b.__wasAutoPaused&&(b.resume(),delete b._wasAutoPaused)}))}else if(!0===e.flashaudio){for(d in this.FLASHAPI)this[d]=this.FLASHAPI[d];e=["id=jukebox-flashstream-"+this.id,"autoplay="+c.autoplay,"file="+window.encodeURIComponent(this.resource)];this.__initFlashContext(e);
!0===c.autoplay?this.play(0):c.spritemap[c.autoplay]&&this.play(c.autoplay)}else throw"Your Browser does not support Flash Audio or HTML5 Audio.";},__initFlashContext:function(b){var c,e=this.settings.flashMediaElement,d,j={flashvars:b.join("&"),quality:"high",bgcolor:"#000000",wmode:"transparent",allowscriptaccess:"always",allowfullscreen:"true"};if(navigator.userAgent.match(/MSIE/)){c=document.createElement("div");document.getElementsByTagName("body")[0].appendChild(c);var f=document.createElement("object");
f.id="jukebox-flashstream-"+this.id;f.setAttribute("type","application/x-shockwave-flash");f.setAttribute("classid","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000");f.setAttribute("width","0");f.setAttribute("height","0");j.movie=e+"?x="+(Date.now?Date.now():+new Date);j.flashvars=b.join("&amp;");for(d in j)b=document.createElement("param"),b.setAttribute("name",d),b.setAttribute("value",j[d]),f.appendChild(b);c.outerHTML=f.outerHTML;this.context=document.getElementById("jukebox-flashstream-"+this.id)}else{c=
document.createElement("embed");c.id="jukebox-flashstream-"+this.id;c.setAttribute("type","application/x-shockwave-flash");c.setAttribute("width","100");c.setAttribute("height","100");j.play=!1;j.loop=!1;j.src=e+"?x="+(Date.now?Date.now():+new Date);for(d in j)c.setAttribute(d,j[d]);document.getElementsByTagName("body")[0].appendChild(c);this.context=c}},backgroundHackForiOS:function(){if(void 0!==this.backgroundMusic){var b=Date.now?Date.now():+new Date;void 0===this.backgroundMusic.started?(this.backgroundMusic.started=
b,this.setCurrentTime(this.backgroundMusic.start)):(this.backgroundMusic.lastPointer=(b-this.backgroundMusic.started)/1E3%(this.backgroundMusic.end-this.backgroundMusic.start)+this.backgroundMusic.start,this.play(this.backgroundMusic.lastPointer))}},play:function(b,c){if(null!==this.isPlaying&&!0!==c)void 0!==jukebox.Manager&&jukebox.Manager.addToQueue(b,this.id);else{var e=this.settings.spritemap,d;if(void 0!==e[b])d=e[b].start;else if("number"===typeof b){d=b;for(var j in e)if(d>=e[j].start&&d<=
e[j].end){b=j;break}}void 0!==d&&"[object Object]"===Object.prototype.toString.call(e[b])&&(this.isPlaying=this.settings.spritemap[b],this.context.play&&this.context.play(),this.wasReady=this.setCurrentTime(d))}},stop:function(){this.__lastPosition=0;this.isPlaying=null;this.backgroundMusic?this.backgroundHackForiOS():this.context.pause();return!0},pause:function(){this.isPlaying=null;this.__lastPosition=this.getCurrentTime();this.context.pause();return this.__lastPosition},resume:function(b){b="number"===
typeof b?b:this.__lastPosition;if(null!==b)return this.play(b),this.__lastPosition=null,!0;this.context.play();return!1},HTML5API:{getVolume:function(){return this.context.volume||1},setVolume:function(b){this.context.volume=b;return 1E-4>Math.abs(this.context.volume-b)?!0:!1},getCurrentTime:function(){return this.context.currentTime||0},setCurrentTime:function(b){try{return this.context.currentTime=b,!0}catch(c){return!1}}},FLASHAPI:{getVolume:function(){return this.context&&"function"===typeof this.context.getVolume?
this.context.getVolume():1},setVolume:function(b){return this.context&&"function"===typeof this.context.setVolume?(this.context.setVolume(b),!0):!1},getCurrentTime:function(){return this.context&&"function"===typeof this.context.getCurrentTime?this.context.getCurrentTime():0},setCurrentTime:function(b){return this.context&&"function"===typeof this.context.setCurrentTime?this.context.setCurrentTime(b):!1}}};
if(void 0===this.jukebox)throw"jukebox.Manager requires jukebox.Player (Player.js) to run properly.";
jukebox.Manager=function(b){this.features={};this.codecs={};this.__players={};this.__playersLength=0;this.__clones={};this.__queue=[];this.settings={};for(var c in this.defaults)this.settings[c]=this.defaults[c];if("[object Object]"===Object.prototype.toString.call(b))for(var e in b)this.settings[e]=b[e];this.__detectFeatures();jukebox.Manager.__initialized=!1===this.settings.useGameLoop?window.setInterval(function(){jukebox.Manager.loop()},20):!0};
jukebox.Manager.prototype={defaults:{useFlash:!1,useGameLoop:!1},__detectFeatures:function(){var b=window.Audio&&new Audio;if(b&&b.canPlayType&&!1===this.settings.useFlash){for(var c=[{e:"3gp",m:["audio/3gpp","audio/amr"]},{e:"aac",m:["audio/aac","audio/aacp"]},{e:"amr",m:["audio/amr","audio/3gpp"]},{e:"caf",m:["audio/IMA-ADPCM","audio/x-adpcm",'audio/x-aiff; codecs="IMA-ADPCM, ADPCM"']},{e:"m4a",m:'audio/mp4{audio/mp4; codecs="mp4a.40.2,avc1.42E01E"{audio/mpeg4{audio/mpeg4-generic{audio/mp4a-latm{audio/MP4A-LATM{audio/x-m4a'.split("{")},
{e:"mp3",m:["audio/mp3","audio/mpeg",'audio/mpeg; codecs="mp3"',"audio/MPA","audio/mpa-robust"]},{e:"mpga",m:["audio/MPA","audio/mpa-robust","audio/mpeg","video/mpeg"]},{e:"mp4",m:["audio/mp4","video/mp4"]},{e:"ogg",m:["application/ogg","audio/ogg",'audio/ogg; codecs="theora, vorbis"',"video/ogg",'video/ogg; codecs="theora, vorbis"']},{e:"wav",m:["audio/wave","audio/wav",'audio/wav; codecs="1"',"audio/x-wav","audio/x-pn-wav"]},{e:"webm",m:["audio/webm",'audio/webm; codecs="vorbis"',"video/webm"]}],
e,d,j=0,f=c.length;j<f;j++)if(d=c[j].e,c[j].m.length&&"object"===typeof c[j].m)for(var n=0,l=c[j].m.length;n<l;n++)if(e=c[j].m[n],""!==b.canPlayType(e)){this.codecs[d]=e;break}else this.codecs[d]||(this.codecs[d]=!1);this.features.html5audio=!(!this.codecs.mp3&&!this.codecs.ogg&&!this.codecs.webm&&!this.codecs.wav);this.features.channels=8;b.volume=0.1337;this.features.volume=!!(1E-4>Math.abs(b.volume-0.1337));navigator.userAgent.match(/iPhone|iPod|iPad/i)&&(this.features.channels=1)}this.features.flashaudio=
!!navigator.mimeTypes["application/x-shockwave-flash"]||!!navigator.plugins["Shockwave Flash"]||!1;if(window.ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash.10"),this.features.flashaudio=!0}catch(g){}!0===this.settings.useFlash&&(this.features.flashaudio=!0);!0===this.features.flashaudio&&!this.features.html5audio&&(this.codecs.mp3="audio/mp3",this.codecs.mpga="audio/mpeg",this.codecs.mp4="audio/mp4",this.codecs.m4a="audio/mp4",this.codecs["3gp"]="audio/3gpp",this.codecs.amr="audio/amr",
this.features.volume=!0,this.features.channels=1)},__getPlayerById:function(b){return this.__players&&void 0!==this.__players[b]?this.__players[b]:null},__getClone:function(b,c){for(var e in this.__clones){var d=this.__clones[e];if(null===d.isPlaying&&d.origin===b)return d}if("[object Object]"===Object.prototype.toString.call(c)){e={};for(var j in c)e[j]=c[j];e.autoplay=!1;j=new jukebox.Player(e,b);j.isClone=!0;j.wasReady=!1;return this.__clones[j.id]=j}return null},loop:function(){if(0!==this.__playersLength)if(this.__queue.length&&
this.__playersLength<this.features.channels){var b=this.__queue[0],c=this.__getPlayerById(b.origin);if(null!==c){var e=this.__getClone(b.origin,c.settings);null!==e&&(!0===this.features.volume&&(c=this.__players[b.origin])&&e.setVolume(c.getVolume()),this.add(e),e.play(b.pointer,!0))}this.__queue.splice(0,1)}else for(e in this.__queue.length&&1===this.features.channels&&(b=this.__queue[0],c=this.__getPlayerById(b.origin),null!==c&&c.play(b.pointer,!0),this.__queue.splice(0,1)),this.__players)b=this.__players[e],
c=b.getCurrentTime()||0,b.isPlaying&&!1===b.wasReady?b.wasReady=b.setCurrentTime(b.isPlaying.start):b.isPlaying&&!0===b.wasReady?c>b.isPlaying.end&&(!0===b.isPlaying.loop?b.play(b.isPlaying.start,!0):b.stop()):b.isClone&&null===b.isPlaying?this.remove(b):void 0!==b.backgroundMusic&&null===b.isPlaying&&c>b.backgroundMusic.end&&b.backgroundHackForiOS()},getPlayableResource:function(b){"[object Array]"!==Object.prototype.toString.call(b)&&(b=[b]);for(var c=0,e=b.length;c<e;c++){var d=b[c],j=d.match(/\.([^\.]*)$/)[1];
if(j&&this.codecs[j])return d}return null},add:function(b){return b instanceof jukebox.Player&&void 0===this.__players[b.id]?(this.__playersLength++,this.__players[b.id]=b,!0):!1},remove:function(b){return b instanceof jukebox.Player&&void 0!==this.__players[b.id]?(this.__playersLength--,delete this.__players[b.id],!0):!1},addToQueue:function(b,c){return("string"===typeof b||"number"===typeof b)&&void 0!==this.__players[c]?(this.__queue.push({pointer:b,origin:c}),!0):!1}};(function(){var b=function(){this.init()};b.prototype={init:function(){var b=this||c;b._counter=1E3;b._html5AudioPool=[];b.html5PoolSize=10;b._codecs={};b._howls=[];b._muted=!1;b._volume=1;b._canPlayEvent="canplaythrough";b._navigator="undefined"!==typeof window&&window.navigator?window.navigator:null;b.masterGain=null;b.noAudio=!1;b.usingWebAudio=!0;b.autoSuspend=!1;b.ctx=null;b.autoUnlock=!0;b._setup();return b},volume:function(b){var d=this||c;b=parseFloat(b);d.ctx||l();if("undefined"!==typeof b&&
0<=b&&1>=b){d._volume=b;if(d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(b,c.ctx.currentTime);for(var e=0;e<d._howls.length;e++)if(!d._howls[e]._webAudio)for(var f=d._howls[e]._getSoundIds(),j=0;j<f.length;j++){var n=d._howls[e]._soundById(f[j]);n&&n._node&&(n._node.volume=n._volume*b)}return d}return d._volume},mute:function(b){var d=this||c;d.ctx||l();d._muted=b;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(b?0:d._volume,c.ctx.currentTime);for(var e=0;e<d._howls.length;e++)if(!d._howls[e]._webAudio)for(var f=
d._howls[e]._getSoundIds(),j=0;j<f.length;j++){var n=d._howls[e]._soundById(f[j]);n&&n._node&&(n._node.muted=b?!0:n._muted)}return d},stop:function(){for(var b=this||c,d=0;d<b._howls.length;d++)b._howls[d].stop();return b},unload:function(){for(var b=this||c,d=b._howls.length-1;0<=d;d--)b._howls[d].unload();b.usingWebAudio&&(b.ctx&&"undefined"!==typeof b.ctx.close)&&(b.ctx.close(),b.ctx=null,l());return b},codecs:function(b){return(this||c)._codecs[b.replace(/^x-/,"")]},_setup:function(){var b=this||
c;b.state=b.ctx?b.ctx.state||"suspended":"suspended";b._autoSuspend();if(!b.usingWebAudio)if("undefined"!==typeof Audio)try{var d=new Audio;"undefined"===typeof d.oncanplaythrough&&(b._canPlayEvent="canplay")}catch(e){b.noAudio=!0}else b.noAudio=!0;try{d=new Audio,d.muted&&(b.noAudio=!0)}catch(f){}b.noAudio||b._setupCodecs();return b},_setupCodecs:function(){var b=this||c,d=null;try{d="undefined"!==typeof Audio?new Audio:null}catch(e){return b}if(!d||"function"!==typeof d.canPlayType)return b;var f=
d.canPlayType("audio/mpeg;").replace(/^no$/,""),j=b._navigator&&b._navigator.userAgent.match(/OPR\/([0-6].)/g),j=j&&33>parseInt(j[0].split("/")[1],10);b._codecs={mp3:!(j||!f&&!d.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!f,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!d.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),
aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(d.canPlayType("audio/x-m4b;")||d.canPlayType("audio/m4b;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,
""),webm:!!d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")};return b},_unlockAudio:function(){var b=this||c;if(!b._audioUnlocked&&b.ctx){b._audioUnlocked=!1;b.autoUnlock=!1;!b._mobileUnloaded&&44100!==b.ctx.sampleRate&&(b._mobileUnloaded=!0,b.unload());b._scratchBuffer=b.ctx.createBuffer(1,1,22050);var d=function(){for(;b._html5AudioPool.length<
b.html5PoolSize;)try{var c=new Audio;c._unlocked=!0;b._releaseHtml5Audio(c)}catch(e){b.noAudio=!0;break}for(c=0;c<b._howls.length;c++)if(!b._howls[c]._webAudio)for(var f=b._howls[c]._getSoundIds(),j=0;j<f.length;j++){var l=b._howls[c]._soundById(f[j]);l&&(l._node&&!l._node._unlocked)&&(l._node._unlocked=!0,l._node.load())}b._autoResume();var n=b.ctx.createBufferSource();n.buffer=b._scratchBuffer;n.connect(b.ctx.destination);"undefined"===typeof n.start?n.noteOn(0):n.start(0);"function"===typeof b.ctx.resume&&
b.ctx.resume();n.onended=function(){n.disconnect(0);b._audioUnlocked=!0;document.removeEventListener("touchstart",d,!0);document.removeEventListener("touchend",d,!0);document.removeEventListener("click",d,!0);for(var c=0;c<b._howls.length;c++)b._howls[c]._emit("unlock")}};document.addEventListener("touchstart",d,!0);document.addEventListener("touchend",d,!0);document.addEventListener("click",d,!0);return b}},_obtainHtml5Audio:function(){var b=this||c;if(b._html5AudioPool.length)return b._html5AudioPool.pop();
(b=(new Audio).play())&&("undefined"!==typeof Promise&&(b instanceof Promise||"function"===typeof b.then))&&b.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")});return new Audio},_releaseHtml5Audio:function(b){var d=this||c;b._unlocked&&d._html5AudioPool.push(b);return d},_autoSuspend:function(){var b=this;if(b.autoSuspend&&b.ctx&&"undefined"!==typeof b.ctx.suspend&&c.usingWebAudio){for(var d=0;d<b._howls.length;d++)if(b._howls[d]._webAudio)for(var e=
0;e<b._howls[d]._sounds.length;e++)if(!b._howls[d]._sounds[e]._paused)return b;b._suspendTimer&&clearTimeout(b._suspendTimer);b._suspendTimer=setTimeout(function(){if(b.autoSuspend){b._suspendTimer=null;b.state="suspending";var c=function(){b.state="suspended";b._resumeAfterSuspend&&(delete b._resumeAfterSuspend,b._autoResume())};b.ctx.suspend().then(c,c)}},3E4);return b}},_autoResume:function(){var b=this;if(b.ctx&&"undefined"!==typeof b.ctx.resume&&c.usingWebAudio)return"running"===b.state&&"interrupted"!==
b.ctx.state&&b._suspendTimer?(clearTimeout(b._suspendTimer),b._suspendTimer=null):"suspended"===b.state||"running"===b.state&&"interrupted"===b.ctx.state?(b.ctx.resume().then(function(){b.state="running";for(var c=0;c<b._howls.length;c++)b._howls[c]._emit("resume")}),b._suspendTimer&&(clearTimeout(b._suspendTimer),b._suspendTimer=null)):"suspending"===b.state&&(b._resumeAfterSuspend=!0),b}};var c=new b,e=function(c){!c.src||0===c.src.length?console.error("An array of source files must be passed with any new Howl."):
this.init(c)};e.prototype={init:function(b){var d=this;c.ctx||l();d._autoplay=b.autoplay||!1;d._format="string"!==typeof b.format?b.format:[b.format];d._html5=b.html5||!1;d._muted=b.mute||!1;d._loop=b.loop||!1;d._pool=b.pool||5;d._preload="boolean"===typeof b.preload||"metadata"===b.preload?b.preload:!0;d._rate=b.rate||1;d._sprite=b.sprite||{};d._src="string"!==typeof b.src?b.src:[b.src];d._volume=void 0!==b.volume?b.volume:1;d._xhr={method:b.xhr&&b.xhr.method?b.xhr.method:"GET",headers:b.xhr&&b.xhr.headers?
b.xhr.headers:null,withCredentials:b.xhr&&b.xhr.withCredentials?b.xhr.withCredentials:!1};d._duration=0;d._state="unloaded";d._sounds=[];d._endTimers={};d._queue=[];d._playLock=!1;d._onend=b.onend?[{fn:b.onend}]:[];d._onfade=b.onfade?[{fn:b.onfade}]:[];d._onload=b.onload?[{fn:b.onload}]:[];d._onloaderror=b.onloaderror?[{fn:b.onloaderror}]:[];d._onplayerror=b.onplayerror?[{fn:b.onplayerror}]:[];d._onpause=b.onpause?[{fn:b.onpause}]:[];d._onplay=b.onplay?[{fn:b.onplay}]:[];d._onstop=b.onstop?[{fn:b.onstop}]:
[];d._onmute=b.onmute?[{fn:b.onmute}]:[];d._onvolume=b.onvolume?[{fn:b.onvolume}]:[];d._onrate=b.onrate?[{fn:b.onrate}]:[];d._onseek=b.onseek?[{fn:b.onseek}]:[];d._onunlock=b.onunlock?[{fn:b.onunlock}]:[];d._onresume=[];d._webAudio=c.usingWebAudio&&!d._html5;"undefined"!==typeof c.ctx&&(c.ctx&&c.autoUnlock)&&c._unlockAudio();c._howls.push(d);d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}});d._preload&&"none"!==d._preload&&d.load();return d},load:function(){var b=null;if(c.noAudio)this._emit("loaderror",
null,"No audio support.");else{"string"===typeof this._src&&(this._src=[this._src]);for(var e=0;e<this._src.length;e++){var p,l;if(this._format&&this._format[e])p=this._format[e];else{l=this._src[e];if("string"!==typeof l){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(p=/^data:audio\/([^;,]+);/i.exec(l))||(p=/\.([^.]+)$/.exec(l.split("?",1)[0]));p&&(p=p[1].toLowerCase())}p||console.warn('No file extension was found. Consider using the "format" property or specify an extension.');
if(p&&c.codecs(p)){b=this._src[e];break}}if(b){this._src=b;this._state="loading";"https:"===window.location.protocol&&"http:"===b.slice(0,5)&&(this._html5=!0,this._webAudio=!1);new d(this);if(this._webAudio){var s=this,t=s._src;if(j[t])s._duration=j[t].duration,n(s);else if(/^data:[^;]+;base64,/.test(t)){b=atob(t.split(",")[1]);e=new Uint8Array(b.length);for(p=0;p<b.length;++p)e[p]=b.charCodeAt(p);f(e.buffer,s)}else{var u=new XMLHttpRequest;u.open(s._xhr.method,t,!0);u.withCredentials=s._xhr.withCredentials;
u.responseType="arraybuffer";s._xhr.headers&&Object.keys(s._xhr.headers).forEach(function(c){u.setRequestHeader(c,s._xhr.headers[c])});u.onload=function(){var c=(u.status+"")[0];"0"!==c&&"2"!==c&&"3"!==c?s._emit("loaderror",null,"Failed loading audio file with status: "+u.status+"."):f(u.response,s)};u.onerror=function(){s._webAudio&&(s._html5=!0,s._webAudio=!1,s._sounds=[],delete j[t],s.load())};try{u.send()}catch(v){u.onerror()}}}return this}this._emit("loaderror",null,"No codec support for selected audio sources.")}},
play:function(b,d){var e=this,f=null;if("number"===typeof b)f=b,b=null;else{if("string"===typeof b&&"loaded"===e._state&&!e._sprite[b])return null;if("undefined"===typeof b&&(b="__default",!e._playLock)){for(var j=0,l=0;l<e._sounds.length;l++)e._sounds[l]._paused&&!e._sounds[l]._ended&&(j++,f=e._sounds[l]._id);1===j?b=null:f=null}}var n=f?e._soundById(f):e._inactiveSound();if(!n)return null;f&&!b&&(b=n._sprite||"__default");if("loaded"!==e._state){n._sprite=b;n._ended=!1;var v=n._id;e._queue.push({event:"play",
action:function(){e.play(v)}});return v}if(f&&!n._paused)return d||e._loadQueue("play"),n._id;e._webAudio&&c._autoResume();var z=Math.max(0,0<n._seek?n._seek:e._sprite[b][0]/1E3),x=Math.max(0,(e._sprite[b][0]+e._sprite[b][1])/1E3-z),B=1E3*x/Math.abs(n._rate),A=e._sprite[b][0]/1E3,D=(e._sprite[b][0]+e._sprite[b][1])/1E3;n._sprite=b;n._ended=!1;var I=function(){n._paused=!1;n._seek=z;n._start=A;n._stop=D;n._loop=!(!n._loop&&!e._sprite[b][2])};if(z>=D)e._ended(n);else{var y=n._node;if(e._webAudio)f=
function(){e._playLock=!1;I();e._refreshBuffer(n);y.gain.setValueAtTime(n._muted||e._muted?0:n._volume,c.ctx.currentTime);n._playStart=c.ctx.currentTime;"undefined"===typeof y.bufferSource.start?n._loop?y.bufferSource.noteGrainOn(0,z,86400):y.bufferSource.noteGrainOn(0,z,x):n._loop?y.bufferSource.start(0,z,86400):y.bufferSource.start(0,z,x);Infinity!==B&&(e._endTimers[n._id]=setTimeout(e._ended.bind(e,n),B));d||setTimeout(function(){e._emit("play",n._id);e._loadQueue()},0)},"running"===c.state&&"interrupted"!==
c.ctx.state?f():(e._playLock=!0,e.once("resume",f),e._clearTimer(n._id));else{var C=function(){y.currentTime=z;y.muted=n._muted||e._muted||c._muted||y.muted;y.volume=n._volume*c.volume();y.playbackRate=n._rate;try{var f=y.play();f&&"undefined"!==typeof Promise&&(f instanceof Promise||"function"===typeof f.then)?(e._playLock=!0,I(),f.then(function(){e._playLock=!1;y._unlocked=!0;d||(e._emit("play",n._id),e._loadQueue())}).catch(function(){e._playLock=!1;e._emit("playerror",n._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");
n._ended=!0;n._paused=!0})):d||(e._playLock=!1,I(),e._emit("play",n._id),e._loadQueue());y.playbackRate=n._rate;y.paused?e._emit("playerror",n._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."):"__default"!==b||n._loop?e._endTimers[n._id]=setTimeout(e._ended.bind(e,n),B):(e._endTimers[n._id]=function(){e._ended(n);y.removeEventListener("ended",e._endTimers[n._id],!1)},y.addEventListener("ended",e._endTimers[n._id],
!1))}catch(j){e._emit("playerror",n._id,j)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===y.src&&(y.src=e._src,y.load());f=window&&window.ejecta||!y.readyState&&c._navigator.isCocoonJS;if(3<=y.readyState||f)C();else{e._playLock=!0;var J=function(){C();y.removeEventListener(c._canPlayEvent,J,!1)};y.addEventListener(c._canPlayEvent,J,!1);e._clearTimer(n._id)}}return n._id}},pause:function(c,b){var d=this;if("loaded"!==d._state||d._playLock)return d._queue.push({event:"pause",
action:function(){d.pause(c)}}),d;for(var e=d._getSoundIds(c),f=0;f<e.length;f++){d._clearTimer(e[f]);var j=d._soundById(e[f]);if(j&&!j._paused&&(j._seek=d.seek(e[f]),j._rateSeek=0,j._paused=!0,d._stopFade(e[f]),j._node))if(d._webAudio){if(!j._node.bufferSource)continue;"undefined"===typeof j._node.bufferSource.stop?j._node.bufferSource.noteOff(0):j._node.bufferSource.stop(0);d._cleanBuffer(j._node)}else(!isNaN(j._node.duration)||Infinity===j._node.duration)&&j._node.pause();b||d._emit("pause",j?
j._id:null)}return d},stop:function(c,b){var d=this;if("loaded"!==d._state||d._playLock)return d._queue.push({event:"stop",action:function(){d.stop(c)}}),d;for(var e=d._getSoundIds(c),f=0;f<e.length;f++){d._clearTimer(e[f]);var j=d._soundById(e[f]);if(j){j._seek=j._start||0;j._rateSeek=0;j._paused=!0;j._ended=!0;d._stopFade(e[f]);if(j._node)if(d._webAudio)j._node.bufferSource&&("undefined"===typeof j._node.bufferSource.stop?j._node.bufferSource.noteOff(0):j._node.bufferSource.stop(0),d._cleanBuffer(j._node));
else if(!isNaN(j._node.duration)||Infinity===j._node.duration)j._node.currentTime=j._start||0,j._node.pause(),Infinity===j._node.duration&&d._clearSound(j._node);b||d._emit("stop",j._id)}}return d},mute:function(b,d){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"mute",action:function(){e.mute(b,d)}}),e;if("undefined"===typeof d)if("boolean"===typeof b)e._muted=b;else return e._muted;for(var f=e._getSoundIds(d),j=0;j<f.length;j++){var l=e._soundById(f[j]);l&&(l._muted=
b,l._interval&&e._stopFade(l._id),e._webAudio&&l._node?l._node.gain.setValueAtTime(b?0:l._volume,c.ctx.currentTime):l._node&&(l._node.muted=c._muted?!0:b),e._emit("mute",l._id))}return e},volume:function(){var b=this,d=arguments,e,f;if(0===d.length)return b._volume;1===d.length||2===d.length&&"undefined"===typeof d[1]?0<=b._getSoundIds().indexOf(d[0])?f=parseInt(d[0],10):e=parseFloat(d[0]):2<=d.length&&(e=parseFloat(d[0]),f=parseInt(d[1],10));var j;if("undefined"!==typeof e&&0<=e&&1>=e){if("loaded"!==
b._state||b._playLock)return b._queue.push({event:"volume",action:function(){b.volume.apply(b,d)}}),b;"undefined"===typeof f&&(b._volume=e);f=b._getSoundIds(f);for(var l=0;l<f.length;l++)if(j=b._soundById(f[l]))j._volume=e,d[2]||b._stopFade(f[l]),b._webAudio&&j._node&&!j._muted?j._node.gain.setValueAtTime(e,c.ctx.currentTime):j._node&&!j._muted&&(j._node.volume=e*c.volume()),b._emit("volume",j._id)}else return(j=f?b._soundById(f):b._sounds[0])?j._volume:0;return b},fade:function(b,d,e,f){var j=this;
if("loaded"!==j._state||j._playLock)return j._queue.push({event:"fade",action:function(){j.fade(b,d,e,f)}}),j;b=Math.min(Math.max(0,parseFloat(b)),1);d=Math.min(Math.max(0,parseFloat(d)),1);e=parseFloat(e);j.volume(b,f);for(var l=j._getSoundIds(f),n=0;n<l.length;n++){var v=j._soundById(l[n]);if(v){f||j._stopFade(l[n]);if(j._webAudio&&!v._muted){var z=c.ctx.currentTime,x=z+e/1E3;v._volume=b;v._node.gain.setValueAtTime(b,z);v._node.gain.linearRampToValueAtTime(d,x)}j._startFadeInterval(v,b,d,e,l[n],
"undefined"===typeof f)}}return j},_startFadeInterval:function(c,b,d,e,f,j){var l=this,n=b,z=d-b;f=Math.abs(z/0.01);f=Math.max(4,0<f?e/f:e);var x=Date.now();c._fadeTo=d;c._interval=setInterval(function(){var f=(Date.now()-x)/e;x=Date.now();n+=z*f;n=0>z?Math.max(d,n):Math.min(d,n);n=Math.round(100*n)/100;l._webAudio?c._volume=n:l.volume(n,c._id,!0);j&&(l._volume=n);if(d<b&&n<=d||d>b&&n>=d)clearInterval(c._interval),c._interval=null,c._fadeTo=null,l.volume(d,c._id),l._emit("fade",c._id)},f)},_stopFade:function(b){var d=
this._soundById(b);d&&d._interval&&(this._webAudio&&d._node.gain.cancelScheduledValues(c.ctx.currentTime),clearInterval(d._interval),d._interval=null,this.volume(d._fadeTo,b),d._fadeTo=null,this._emit("fade",b));return this},loop:function(){var c=arguments,b,d;if(0===c.length)return this._loop;if(1===c.length)if("boolean"===typeof c[0])this._loop=b=c[0];else return(c=this._soundById(parseInt(c[0],10)))?c._loop:!1;else 2===c.length&&(b=c[0],d=parseInt(c[1],10));d=this._getSoundIds(d);for(var e=0;e<
d.length;e++)if(c=this._soundById(d[e]))if(c._loop=b,this._webAudio&&(c._node&&c._node.bufferSource)&&(c._node.bufferSource.loop=b))c._node.bufferSource.loopStart=c._start||0,c._node.bufferSource.loopEnd=c._stop;return this},rate:function(){var b=this,d=arguments,e,f;0===d.length?f=b._sounds[0]._id:1===d.length?0<=b._getSoundIds().indexOf(d[0])?f=parseInt(d[0],10):e=parseFloat(d[0]):2===d.length&&(e=parseFloat(d[0]),f=parseInt(d[1],10));var j;if("number"===typeof e){if("loaded"!==b._state||b._playLock)return b._queue.push({event:"rate",
action:function(){b.rate.apply(b,d)}}),b;"undefined"===typeof f&&(b._rate=e);f=b._getSoundIds(f);for(var l=0;l<f.length;l++)if(j=b._soundById(f[l])){b.playing(f[l])&&(j._rateSeek=b.seek(f[l]),j._playStart=b._webAudio?c.ctx.currentTime:j._playStart);j._rate=e;b._webAudio&&j._node&&j._node.bufferSource?j._node.bufferSource.playbackRate.setValueAtTime(e,c.ctx.currentTime):j._node&&(j._node.playbackRate=e);var n=b.seek(f[l]),n=1E3*((b._sprite[j._sprite][0]+b._sprite[j._sprite][1])/1E3-n)/Math.abs(j._rate);
if(b._endTimers[f[l]]||!j._paused)b._clearTimer(f[l]),b._endTimers[f[l]]=setTimeout(b._ended.bind(b,j),n);b._emit("rate",j._id)}}else return(j=b._soundById(f))?j._rate:b._rate;return b},seek:function(){var b=this,d=arguments,e,f;0===d.length?f=b._sounds[0]._id:1===d.length?0<=b._getSoundIds().indexOf(d[0])?f=parseInt(d[0],10):b._sounds.length&&(f=b._sounds[0]._id,e=parseFloat(d[0])):2===d.length&&(e=parseFloat(d[0]),f=parseInt(d[1],10));if("undefined"===typeof f)return b;if("loaded"!==b._state||b._playLock)return b._queue.push({event:"seek",
action:function(){b.seek.apply(b,d)}}),b;var j=b._soundById(f);if(j)if("number"===typeof e&&0<=e){var l=b.playing(f);l&&b.pause(f,!0);j._seek=e;j._ended=!1;b._clearTimer(f);!b._webAudio&&(j._node&&!isNaN(j._node.duration))&&(j._node.currentTime=e);var n=function(){b._emit("seek",f);l&&b.play(f,!0)};if(l&&!b._webAudio){var v=function(){b._playLock?setTimeout(v,0):n()};setTimeout(v,0)}else n()}else return b._webAudio?(e=b.playing(f)?c.ctx.currentTime-j._playStart:0,j._seek+((j._rateSeek?j._rateSeek-
j._seek:0)+e*Math.abs(j._rate))):j._node.currentTime;return b},playing:function(c){if("number"===typeof c)return(c=this._soundById(c))?!c._paused:!1;for(c=0;c<this._sounds.length;c++)if(!this._sounds[c]._paused)return!0;return!1},duration:function(c){var b=this._duration;(c=this._soundById(c))&&(b=this._sprite[c._sprite][1]/1E3);return b},state:function(){return this._state},unload:function(){for(var b=this._sounds,d=0;d<b.length;d++)b[d]._paused||this.stop(b[d]._id),this._webAudio||(this._clearSound(b[d]._node),
b[d]._node.removeEventListener("error",b[d]._errorFn,!1),b[d]._node.removeEventListener(c._canPlayEvent,b[d]._loadFn,!1),c._releaseHtml5Audio(b[d]._node)),delete b[d]._node,this._clearTimer(b[d]._id);d=c._howls.indexOf(this);0<=d&&c._howls.splice(d,1);b=!0;for(d=0;d<c._howls.length;d++)if(c._howls[d]._src===this._src||0<=this._src.indexOf(c._howls[d]._src)){b=!1;break}j&&b&&delete j[this._src];c.noAudio=!1;this._state="unloaded";this._sounds=[];return null},on:function(c,b,d,e){c=this["_on"+c];"function"===
typeof b&&c.push(e?{id:d,fn:b,once:e}:{id:d,fn:b});return this},off:function(c,b,d){var e=this["_on"+c],f=0;"number"===typeof b&&(d=b,b=null);if(b||d)for(f=0;f<e.length;f++){if(c=d===e[f].id,b===e[f].fn&&c||!b&&c){e.splice(f,1);break}}else if(c)this["_on"+c]=[];else{b=Object.keys(this);for(f=0;f<b.length;f++)0===b[f].indexOf("_on")&&Array.isArray(this[b[f]])&&(this[b[f]]=[])}return this},once:function(c,b,d){this.on(c,b,d,1);return this},_emit:function(c,b,d){for(var e=this["_on"+c],f=e.length-1;0<=
f;f--)if(!e[f].id||e[f].id===b||"load"===c)setTimeout(function(c){c.call(this,b,d)}.bind(this,e[f].fn),0),e[f].once&&this.off(c,e[f].fn,e[f].id);this._loadQueue(c);return this},_loadQueue:function(c){if(0<this._queue.length){var b=this._queue[0];b.event===c&&(this._queue.shift(),this._loadQueue());c||b.action()}return this},_ended:function(b){var d=b._sprite;if(!this._webAudio&&b._node&&!b._node.paused&&!b._node.ended&&b._node.currentTime<b._stop)return setTimeout(this._ended.bind(this,b),100),this;
d=!(!b._loop&&!this._sprite[d][2]);this._emit("end",b._id);!this._webAudio&&d&&this.stop(b._id,!0).play(b._id);if(this._webAudio&&d){this._emit("play",b._id);b._seek=b._start||0;b._rateSeek=0;b._playStart=c.ctx.currentTime;var e=1E3*(b._stop-b._start)/Math.abs(b._rate);this._endTimers[b._id]=setTimeout(this._ended.bind(this,b),e)}this._webAudio&&!d&&(b._paused=!0,b._ended=!0,b._seek=b._start||0,b._rateSeek=0,this._clearTimer(b._id),this._cleanBuffer(b._node),c._autoSuspend());!this._webAudio&&!d&&
this.stop(b._id,!0);return this},_clearTimer:function(c){if(this._endTimers[c]){if("function"!==typeof this._endTimers[c])clearTimeout(this._endTimers[c]);else{var b=this._soundById(c);b&&b._node&&b._node.removeEventListener("ended",this._endTimers[c],!1)}delete this._endTimers[c]}return this},_soundById:function(c){for(var b=0;b<this._sounds.length;b++)if(c===this._sounds[b]._id)return this._sounds[b];return null},_inactiveSound:function(){this._drain();for(var c=0;c<this._sounds.length;c++)if(this._sounds[c]._ended)return this._sounds[c].reset();
return new d(this)},_drain:function(){var c=this._pool,b=0,d=0;if(!(this._sounds.length<c)){for(d=0;d<this._sounds.length;d++)this._sounds[d]._ended&&b++;for(d=this._sounds.length-1;0<=d&&!(b<=c);d--)this._sounds[d]._ended&&(this._webAudio&&this._sounds[d]._node&&this._sounds[d]._node.disconnect(0),this._sounds.splice(d,1),b--)}},_getSoundIds:function(c){if("undefined"===typeof c){c=[];for(var b=0;b<this._sounds.length;b++)c.push(this._sounds[b]._id);return c}return[c]},_refreshBuffer:function(b){b._node.bufferSource=
c.ctx.createBufferSource();b._node.bufferSource.buffer=j[this._src];b._panner?b._node.bufferSource.connect(b._panner):b._node.bufferSource.connect(b._node);if(b._node.bufferSource.loop=b._loop)b._node.bufferSource.loopStart=b._start||0,b._node.bufferSource.loopEnd=b._stop||0;b._node.bufferSource.playbackRate.setValueAtTime(b._rate,c.ctx.currentTime);return this},_cleanBuffer:function(b){var d=c._navigator&&0<=c._navigator.vendor.indexOf("Apple");if(c._scratchBuffer&&b.bufferSource&&(b.bufferSource.onended=
null,b.bufferSource.disconnect(0),d))try{b.bufferSource.buffer=c._scratchBuffer}catch(e){}b.bufferSource=null;return this},_clearSound:function(b){/MSIE |Trident\//.test(c._navigator&&c._navigator.userAgent)||(b.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var d=function(c){this._parent=c;this.init()};d.prototype={init:function(){var b=this._parent;this._muted=b._muted;this._loop=b._loop;this._volume=b._volume;this._rate=b._rate;this._seek=0;this._ended=
this._paused=!0;this._sprite="__default";this._id=++c._counter;b._sounds.push(this);this.create();return this},create:function(){var b=this._parent,d=c._muted||this._muted||this._parent._muted?0:this._volume;b._webAudio?(this._node="undefined"===typeof c.ctx.createGain?c.ctx.createGainNode():c.ctx.createGain(),this._node.gain.setValueAtTime(d,c.ctx.currentTime),this._node.paused=!0,this._node.connect(c.masterGain)):c.noAudio||(this._node=c._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),
this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(c._canPlayEvent,this._loadFn,!1),this._node.src=b._src,this._node.preload=!0===b._preload?"auto":b._preload,this._node.volume=d*c.volume(),this._node.load());return this},reset:function(){var b=this._parent;this._muted=b._muted;this._loop=b._loop;this._volume=b._volume;this._rate=b._rate;this._rateSeek=this._seek=0;this._ended=this._paused=!0;this._sprite="__default";this._id=
++c._counter;return this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0);this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var b=this._parent;b._duration=Math.ceil(10*this._node.duration)/10;0===Object.keys(b._sprite).length&&(b._sprite={__default:[0,1E3*b._duration]});"loaded"!==b._state&&(b._state="loaded",b._emit("load"),b._loadQueue());this._node.removeEventListener(c._canPlayEvent,this._loadFn,!1)}};
var j={},f=function(b,d){var e=function(){d._emit("loaderror",null,"Decoding audio data failed.")},f=function(b){b&&0<d._sounds.length?(j[d._src]=b,n(d,b)):e()};"undefined"!==typeof Promise&&1===c.ctx.decodeAudioData.length?c.ctx.decodeAudioData(b).then(f).catch(e):c.ctx.decodeAudioData(b,f,e)},n=function(b,c){c&&!b._duration&&(b._duration=c.duration);0===Object.keys(b._sprite).length&&(b._sprite={__default:[0,1E3*b._duration]});"loaded"!==b._state&&(b._state="loaded",b._emit("load"),b._loadQueue())},
l=function(){if(c.usingWebAudio){try{"undefined"!==typeof AudioContext?c.ctx=new AudioContext:"undefined"!==typeof webkitAudioContext?c.ctx=new webkitAudioContext:c.usingWebAudio=!1}catch(b){c.usingWebAudio=!1}c.ctx||(c.usingWebAudio=!1);var d=/iP(hone|od|ad)/.test(c._navigator&&c._navigator.platform),e=c._navigator&&c._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),e=e?parseInt(e[1],10):null;d&&(e&&9>e)&&(d=/safari/.test(c._navigator&&c._navigator.userAgent.toLowerCase()),c._navigator&&!d&&
(c.usingWebAudio=!1));c.usingWebAudio&&(c.masterGain="undefined"===typeof c.ctx.createGain?c.ctx.createGainNode():c.ctx.createGain(),c.masterGain.gain.setValueAtTime(c._muted?0:c._volume,c.ctx.currentTime),c.masterGain.connect(c.ctx.destination));c._setup()}};"function"===typeof define&&define.amd&&define([],function(){return{Howler:c,Howl:e}});"undefined"!==typeof exports&&(exports.Howler=c,exports.Howl=e);"undefined"!==typeof global?(global.HowlerGlobal=b,global.Howler=c,global.Howl=e,global.Sound=
d):"undefined"!==typeof window&&(window.HowlerGlobal=b,window.Howler=c,window.Howl=e,window.Sound=d)})();
(function(){HowlerGlobal.prototype._pos=[0,0,0];HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0];HowlerGlobal.prototype.stereo=function(b){if(!this.ctx||!this.ctx.listener)return this;for(var c=this._howls.length-1;0<=c;c--)this._howls[c].stereo(b);return this};HowlerGlobal.prototype.pos=function(b,c,d){if(!this.ctx||!this.ctx.listener)return this;c="number"!==typeof c?this._pos[1]:c;d="number"!==typeof d?this._pos[2]:d;if("number"===typeof b)this._pos=[b,c,d],"undefined"!==typeof this.ctx.listener.positionX?
(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,0.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,0.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,0.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]);else return this._pos;return this};HowlerGlobal.prototype.orientation=function(b,c,d,e,g,m){if(!this.ctx||!this.ctx.listener)return this;var p=this._orientation;c="number"!==
typeof c?p[1]:c;d="number"!==typeof d?p[2]:d;e="number"!==typeof e?p[3]:e;g="number"!==typeof g?p[4]:g;m="number"!==typeof m?p[5]:m;if("number"===typeof b)this._orientation=[b,c,d,e,g,m],"undefined"!==typeof this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(b,Howler.ctx.currentTime,0.1),this.ctx.listener.forwardY.setTargetAtTime(c,Howler.ctx.currentTime,0.1),this.ctx.listener.forwardZ.setTargetAtTime(d,Howler.ctx.currentTime,0.1),this.ctx.listener.upX.setTargetAtTime(e,Howler.ctx.currentTime,
0.1),this.ctx.listener.upY.setTargetAtTime(g,Howler.ctx.currentTime,0.1),this.ctx.listener.upZ.setTargetAtTime(m,Howler.ctx.currentTime,0.1)):this.ctx.listener.setOrientation(b,c,d,e,g,m);else return p;return this};var b=Howl.prototype.init;Howl.prototype.init=function(c){this._orientation=c.orientation||[1,0,0];this._stereo=c.stereo||null;this._pos=c.pos||null;this._pannerAttr={coneInnerAngle:"undefined"!==typeof c.coneInnerAngle?c.coneInnerAngle:360,coneOuterAngle:"undefined"!==typeof c.coneOuterAngle?
c.coneOuterAngle:360,coneOuterGain:"undefined"!==typeof c.coneOuterGain?c.coneOuterGain:0,distanceModel:"undefined"!==typeof c.distanceModel?c.distanceModel:"inverse",maxDistance:"undefined"!==typeof c.maxDistance?c.maxDistance:1E4,panningModel:"undefined"!==typeof c.panningModel?c.panningModel:"HRTF",refDistance:"undefined"!==typeof c.refDistance?c.refDistance:1,rolloffFactor:"undefined"!==typeof c.rolloffFactor?c.rolloffFactor:1};this._onstereo=c.onstereo?[{fn:c.onstereo}]:[];this._onpos=c.onpos?
[{fn:c.onpos}]:[];this._onorientation=c.onorientation?[{fn:c.onorientation}]:[];return b.call(this,c)};Howl.prototype.stereo=function(c,b){var e=this;if(!e._webAudio)return e;if("loaded"!==e._state)return e._queue.push({event:"stereo",action:function(){e.stereo(c,b)}}),e;var l="undefined"===typeof Howler.ctx.createStereoPanner?"spatial":"stereo";if("undefined"===typeof b)if("number"===typeof c)e._stereo=c,e._pos=[c,0,0];else return e._stereo;for(var g=e._getSoundIds(b),m=0;m<g.length;m++){var p=e._soundById(g[m]);
if(p)if("number"===typeof c)p._stereo=c,p._pos=[c,0,0],p._node&&(p._pannerAttr.panningModel="equalpower",(!p._panner||!p._panner.pan)&&d(p,l),"spatial"===l?"undefined"!==typeof p._panner.positionX?(p._panner.positionX.setValueAtTime(c,Howler.ctx.currentTime),p._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),p._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):p._panner.setPosition(c,0,0):p._panner.pan.setValueAtTime(c,Howler.ctx.currentTime)),e._emit("stereo",p._id);else return p._stereo}return e};
Howl.prototype.pos=function(c,b,e,l){var g=this;if(!g._webAudio)return g;if("loaded"!==g._state)return g._queue.push({event:"pos",action:function(){g.pos(c,b,e,l)}}),g;b="number"!==typeof b?0:b;e="number"!==typeof e?-0.5:e;if("undefined"===typeof l)if("number"===typeof c)g._pos=[c,b,e];else return g._pos;for(var m=g._getSoundIds(l),p=0;p<m.length;p++){var r=g._soundById(m[p]);if(r)if("number"===typeof c)r._pos=[c,b,e],r._node&&((!r._panner||r._panner.pan)&&d(r,"spatial"),"undefined"!==typeof r._panner.positionX?
(r._panner.positionX.setValueAtTime(c,Howler.ctx.currentTime),r._panner.positionY.setValueAtTime(b,Howler.ctx.currentTime),r._panner.positionZ.setValueAtTime(e,Howler.ctx.currentTime)):r._panner.setPosition(c,b,e)),g._emit("pos",r._id);else return r._pos}return g};Howl.prototype.orientation=function(c,b,e,l){var g=this;if(!g._webAudio)return g;if("loaded"!==g._state)return g._queue.push({event:"orientation",action:function(){g.orientation(c,b,e,l)}}),g;b="number"!==typeof b?g._orientation[1]:b;e=
"number"!==typeof e?g._orientation[2]:e;if("undefined"===typeof l)if("number"===typeof c)g._orientation=[c,b,e];else return g._orientation;for(var m=g._getSoundIds(l),p=0;p<m.length;p++){var r=g._soundById(m[p]);if(r)if("number"===typeof c)r._orientation=[c,b,e],r._node&&(r._panner||(r._pos||(r._pos=g._pos||[0,0,-0.5]),d(r,"spatial")),"undefined"!==typeof r._panner.orientationX?(r._panner.orientationX.setValueAtTime(c,Howler.ctx.currentTime),r._panner.orientationY.setValueAtTime(b,Howler.ctx.currentTime),
r._panner.orientationZ.setValueAtTime(e,Howler.ctx.currentTime)):r._panner.setOrientation(c,b,e)),g._emit("orientation",r._id);else return r._orientation}return g};Howl.prototype.pannerAttr=function(){var c=arguments,b,e;if(!this._webAudio)return this;if(0===c.length)return this._pannerAttr;if(1===c.length)if("object"===typeof c[0])b=c[0],"undefined"===typeof e&&(b.pannerAttr||(b.pannerAttr={coneInnerAngle:b.coneInnerAngle,coneOuterAngle:b.coneOuterAngle,coneOuterGain:b.coneOuterGain,distanceModel:b.distanceModel,
maxDistance:b.maxDistance,refDistance:b.refDistance,rolloffFactor:b.rolloffFactor,panningModel:b.panningModel}),this._pannerAttr={coneInnerAngle:"undefined"!==typeof b.pannerAttr.coneInnerAngle?b.pannerAttr.coneInnerAngle:this._coneInnerAngle,coneOuterAngle:"undefined"!==typeof b.pannerAttr.coneOuterAngle?b.pannerAttr.coneOuterAngle:this._coneOuterAngle,coneOuterGain:"undefined"!==typeof b.pannerAttr.coneOuterGain?b.pannerAttr.coneOuterGain:this._coneOuterGain,distanceModel:"undefined"!==typeof b.pannerAttr.distanceModel?
b.pannerAttr.distanceModel:this._distanceModel,maxDistance:"undefined"!==typeof b.pannerAttr.maxDistance?b.pannerAttr.maxDistance:this._maxDistance,refDistance:"undefined"!==typeof b.pannerAttr.refDistance?b.pannerAttr.refDistance:this._refDistance,rolloffFactor:"undefined"!==typeof b.pannerAttr.rolloffFactor?b.pannerAttr.rolloffFactor:this._rolloffFactor,panningModel:"undefined"!==typeof b.pannerAttr.panningModel?b.pannerAttr.panningModel:this._panningModel});else return(c=this._soundById(parseInt(c[0],
10)))?c._pannerAttr:this._pannerAttr;else 2===c.length&&(b=c[0],e=parseInt(c[1],10));e=this._getSoundIds(e);for(var l=0;l<e.length;l++)if(c=this._soundById(e[l])){var g=c._pannerAttr,g={coneInnerAngle:"undefined"!==typeof b.coneInnerAngle?b.coneInnerAngle:g.coneInnerAngle,coneOuterAngle:"undefined"!==typeof b.coneOuterAngle?b.coneOuterAngle:g.coneOuterAngle,coneOuterGain:"undefined"!==typeof b.coneOuterGain?b.coneOuterGain:g.coneOuterGain,distanceModel:"undefined"!==typeof b.distanceModel?b.distanceModel:
g.distanceModel,maxDistance:"undefined"!==typeof b.maxDistance?b.maxDistance:g.maxDistance,refDistance:"undefined"!==typeof b.refDistance?b.refDistance:g.refDistance,rolloffFactor:"undefined"!==typeof b.rolloffFactor?b.rolloffFactor:g.rolloffFactor,panningModel:"undefined"!==typeof b.panningModel?b.panningModel:g.panningModel},m=c._panner;m?(m.coneInnerAngle=g.coneInnerAngle,m.coneOuterAngle=g.coneOuterAngle,m.coneOuterGain=g.coneOuterGain,m.distanceModel=g.distanceModel,m.maxDistance=g.maxDistance,
m.refDistance=g.refDistance,m.rolloffFactor=g.rolloffFactor,m.panningModel=g.panningModel):(c._pos||(c._pos=this._pos||[0,0,-0.5]),d(c,"spatial"))}return this};var c=Sound.prototype.init;Sound.prototype.init=function(){var b=this._parent;this._orientation=b._orientation;this._stereo=b._stereo;this._pos=b._pos;this._pannerAttr=b._pannerAttr;c.call(this);this._stereo?b.stereo(this._stereo):this._pos&&b.pos(this._pos[0],this._pos[1],this._pos[2],this._id)};var e=Sound.prototype.reset;Sound.prototype.reset=
function(){var b=this._parent;this._orientation=b._orientation;this._stereo=b._stereo;this._pos=b._pos;this._pannerAttr=b._pannerAttr;this._stereo?b.stereo(this._stereo):this._pos?b.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,b._refreshBuffer(this));return e.call(this)};var d=function(b,c){"spatial"===(c||"spatial")?(b._panner=Howler.ctx.createPanner(),b._panner.coneInnerAngle=b._pannerAttr.coneInnerAngle,b._panner.coneOuterAngle=
b._pannerAttr.coneOuterAngle,b._panner.coneOuterGain=b._pannerAttr.coneOuterGain,b._panner.distanceModel=b._pannerAttr.distanceModel,b._panner.maxDistance=b._pannerAttr.maxDistance,b._panner.refDistance=b._pannerAttr.refDistance,b._panner.rolloffFactor=b._pannerAttr.rolloffFactor,b._panner.panningModel=b._pannerAttr.panningModel,"undefined"!==typeof b._panner.positionX?(b._panner.positionX.setValueAtTime(b._pos[0],Howler.ctx.currentTime),b._panner.positionY.setValueAtTime(b._pos[1],Howler.ctx.currentTime),
b._panner.positionZ.setValueAtTime(b._pos[2],Howler.ctx.currentTime)):b._panner.setPosition(b._pos[0],b._pos[1],b._pos[2]),"undefined"!==typeof b._panner.orientationX?(b._panner.orientationX.setValueAtTime(b._orientation[0],Howler.ctx.currentTime),b._panner.orientationY.setValueAtTime(b._orientation[1],Howler.ctx.currentTime),b._panner.orientationZ.setValueAtTime(b._orientation[2],Howler.ctx.currentTime)):b._panner.setOrientation(b._orientation[0],b._orientation[1],b._orientation[2])):(b._panner=
Howler.ctx.createStereoPanner(),b._panner.pan.setValueAtTime(b._stereo,Howler.ctx.currentTime));b._panner.connect(b._node);b._paused||b._parent.pause(b._id,!0).play(b._id,!0)}})();!function(b,c){"object"==typeof exports&&"undefined"!=typeof module?c():"function"==typeof define&&define.amd?define(c):c()}(0,function(){function b(b){var c=this.constructor;return this.then(function(d){return c.resolve(b()).then(function(){return d})},function(d){return c.resolve(b()).then(function(){return c.reject(d)})})}function c(){}function e(b){if(!(this instanceof e))throw new TypeError("Promises must be constructed via new");if("function"!=typeof b)throw new TypeError("not a function");
this._state=0;this._handled=!1;this._value=void 0;this._deferreds=[];l(b,this)}function d(b,c){for(;3===b._state;)b=b._value;0!==b._state?(b._handled=!0,e._immediateFn(function(){var d=1===b._state?c.onFulfilled:c.onRejected;if(null!==d){var e;try{e=d(b._value)}catch(g){return void f(c.promise,g)}j(c.promise,e)}else(1===b._state?j:f)(c.promise,b._value)})):b._deferreds.push(c)}function j(b,c){try{if(c===b)throw new TypeError("A promise cannot be resolved with itself.");if(c&&("object"==typeof c||
"function"==typeof c)){var d=c.then;if(c instanceof e)return b._state=3,b._value=c,void n(b);if("function"==typeof d)return void l(function(){d.apply(c,arguments)},b)}b._state=1;b._value=c;n(b)}catch(g){f(b,g)}}function f(b,c){b._state=2;b._value=c;n(b)}function n(b){2===b._state&&0===b._deferreds.length&&e._immediateFn(function(){b._handled||e._unhandledRejectionFn(b._value)});for(var c=0,f=b._deferreds.length;f>c;c++)d(b,b._deferreds[c]);b._deferreds=null}function l(b,c){var d=!1;try{b(function(b){d||
(d=!0,j(c,b))},function(b){d||(d=!0,f(c,b))})}catch(e){d||(d=!0,f(c,e))}}var g=setTimeout;e.prototype["catch"]=function(b){return this.then(null,b)};e.prototype.then=function(b,e){var f=new this.constructor(c);return d(this,new function(b,c,d){this.onFulfilled="function"==typeof b?b:null;this.onRejected="function"==typeof c?c:null;this.promise=d}(b,e,f)),f};e.prototype["finally"]=b;e.all=function(b){return new e(function(c,d){function e(b,j){try{if(j&&("object"==typeof j||"function"==typeof j)){var l=
j.then;if("function"==typeof l)return void l.call(j,function(c){e(b,c)},d)}f[b]=j;0==--g&&c(f)}catch(m){d(m)}}if(!b||"undefined"==typeof b.length)throw new TypeError("Promise.all accepts an array");var f=Array.prototype.slice.call(b);if(0===f.length)return c([]);for(var g=f.length,j=0;f.length>j;j++)e(j,f[j])})};e.resolve=function(b){return b&&"object"==typeof b&&b.constructor===e?b:new e(function(c){c(b)})};e.reject=function(b){return new e(function(c,d){d(b)})};e.race=function(b){return new e(function(c,
d){for(var e=0,f=b.length;f>e;e++)b[e].then(c,d)})};e._immediateFn="function"==typeof setImmediate&&function(b){setImmediate(b)}||function(b){g(b,0)};e._unhandledRejectionFn=function(b){void 0!==console&&console&&console.warn("Possible Unhandled Promise Rejection:",b)};var m=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("unable to locate global object");}();"Promise"in m?m.Promise.prototype["finally"]||
(m.Promise.prototype["finally"]=b):m.Promise=e});(function(){function b(b,c){document.addEventListener?b.addEventListener("scroll",c,!1):b.attachEvent("scroll",c)}function c(b){this.a=document.createElement("div");this.a.setAttribute("aria-hidden","true");this.a.appendChild(document.createTextNode(b));this.b=document.createElement("span");this.c=document.createElement("span");this.h=document.createElement("span");this.f=document.createElement("span");this.g=-1;this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";
this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;";this.b.appendChild(this.h);this.c.appendChild(this.f);this.a.appendChild(this.b);this.a.appendChild(this.c)}function e(b,c){b.a.style.cssText=
"max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+c+";"}function d(b){var c=b.a.offsetWidth,d=c+100;b.f.style.width=d+"px";b.c.scrollLeft=d;b.b.scrollLeft=b.b.scrollWidth+100;return b.g!==c?(b.g=c,!0):!1}function j(c,e){function f(){var b=g;d(b)&&b.a.parentNode&&e(b.g)}var g=c;b(c.b,f);b(c.c,f);d(c)}function f(b,c){var d=c||{};this.family=b;this.style=d.style||
"normal";this.weight=d.weight||"normal";this.stretch=d.stretch||"normal"}function n(){null===s&&(s=!!document.fonts);return s}function l(){if(null===r){var b=document.createElement("div");try{b.style.font="condensed 100px sans-serif"}catch(c){}r=""!==b.style.font}return r}function g(b,c){return[b.style,b.weight,l()?b.stretch:"","100px",c].join(" ")}var m=null,p=null,r=null,s=null;f.prototype.load=function(b,d){var f=this,l=b||"BESbswy",r=0,s=d||3E3,A=(new Date).getTime();return new Promise(function(b,
d){var t;if(t=n())null===p&&(n()&&/Apple/.test(window.navigator.vendor)?(t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),p=!!t&&603>parseInt(t[1],10)):p=!1),t=!p;if(t){t=new Promise(function(b,c){function d(){(new Date).getTime()-A>=s?c(Error(""+s+"ms timeout exceeded")):document.fonts.load(g(f,'"'+f.family+'"'),l).then(function(c){1<=c.length?b():setTimeout(d,25)},c)}d()});var u=new Promise(function(b,c){r=setTimeout(function(){c(Error(""+s+"ms timeout exceeded"))},
s)});Promise.race([u,t]).then(function(){clearTimeout(r);b(f)},d)}else{var J=function(){function p(){var c;if(c=-1!=C&&-1!=F||-1!=C&&-1!=H||-1!=F&&-1!=H)(c=C!=F&&C!=H&&F!=H)||(null===m&&(c=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),m=!!c&&(536>parseInt(c[1],10)||536===parseInt(c[1],10)&&11>=parseInt(c[2],10))),c=m&&(C==J&&F==J&&H==J||C==R&&F==R&&H==R||C==L&&F==L&&H==L)),c=!c;c&&(T.parentNode&&T.parentNode.removeChild(T),clearTimeout(r),b(f))}function n(){if((new Date).getTime()-
A>=s)T.parentNode&&T.parentNode.removeChild(T),d(Error(""+s+"ms timeout exceeded"));else{var b=document.hidden;if(!0===b||void 0===b)C=t.a.offsetWidth,F=u.a.offsetWidth,H=y.a.offsetWidth,p();r=setTimeout(n,50)}}var t=new c(l),u=new c(l),y=new c(l),C=-1,F=-1,H=-1,J=-1,R=-1,L=-1,T=document.createElement("div");T.dir="ltr";e(t,g(f,"sans-serif"));e(u,g(f,"serif"));e(y,g(f,"monospace"));T.appendChild(t.a);T.appendChild(u.a);T.appendChild(y.a);document.body.appendChild(T);J=t.a.offsetWidth;R=u.a.offsetWidth;
L=y.a.offsetWidth;n();j(t,function(b){C=b;p()});e(t,g(f,'"'+f.family+'",sans-serif'));j(u,function(b){F=b;p()});e(u,g(f,'"'+f.family+'",serif'));j(y,function(b){H=b;p()});e(y,g(f,'"'+f.family+'",monospace'))};document.body?J():document.addEventListener?document.addEventListener("DOMContentLoaded",function O(){document.removeEventListener("DOMContentLoaded",O);J()}):document.attachEvent("onreadystatechange",function N(){if("interactive"==document.readyState||"complete"==document.readyState)document.detachEvent("onreadystatechange",
N),J()})}})};"object"===typeof module?module.exports=f:(window.FontFaceObserver=f,window.FontFaceObserver.prototype.load=f.prototype.load)})();(function(b){Number.prototype.map=function(b,c,d,e){return d+(e-d)*((this-b)/(c-b))};Number.prototype.limit=function(b,c){return Math.min(c,Math.max(b,this))};Number.prototype.round=function(b){b=Math.pow(10,b||0);return Math.round(this*b)/b};Number.prototype.floor=function(){return Math.floor(this)};Number.prototype.ceil=function(){return Math.ceil(this)};Number.prototype.toInt=function(){return this|0};Number.prototype.toRad=function(){return this/180*Math.PI};Number.prototype.toDeg=function(){return 180*
this/Math.PI};Array.prototype.erase=function(b){for(var c=this.length;c--;)this[c]===b&&this.splice(c,1);return this};Array.prototype.random=function(){return this[Math.floor(Math.random()*this.length)]};Function.prototype.bind=Function.prototype.bind||function(b){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var c=Array.prototype.slice.call(arguments,1),d=this,e=function(){},f=function(){return d.apply(this instanceof e&&b?
this:b,c.concat(Array.prototype.slice.call(arguments)))};e.prototype=this.prototype;f.prototype=new e;return f};b.ig={game:null,debug:null,version:"1.23",global:b,modules:{},resources:[],ready:!1,baked:!1,nocache:"",ua:{},prefix:b.ImpactPrefix||"",lib:"lib/",_current:null,_loadQueue:[],_waitForOnload:0,$:function(b){return"#"==b.charAt(0)?document.getElementById(b.substr(1)):document.getElementsByTagName(b)},$new:function(b){return document.createElement(b)},copy:function(b){if(!b||"object"!=typeof b||
b instanceof HTMLElement||b instanceof ig.Class)return b;if(b instanceof Array)for(var c=[],d=0,e=b.length;d<e;d++)c[d]=ig.copy(b[d]);else for(d in c={},b)c[d]=ig.copy(b[d]);return c},merge:function(b,c){for(var d in c)if(!("_mesh"===d||"_camera"===d)){var e=c[d];if("object"!=typeof e||e instanceof HTMLElement||e instanceof ig.Class||null===e)b[d]=e;else{if(!b[d]||"object"!=typeof b[d])b[d]=e instanceof Array?[]:{};ig.merge(b[d],e)}}return b},ksort:function(b){if(!b||"object"!=typeof b)return[];var c=
[],d=[],e;for(e in b)c.push(e);c.sort();for(e=0;e<c.length;e++)d.push(b[c[e]]);return d},setVendorAttribute:function(b,c,d){var e=c.charAt(0).toUpperCase()+c.substr(1);b[c]="undefined"!==typeof b.imageSmoothingEnabled?b["ms"+e]=b["moz"+e]=b["o"+e]=d:b["ms"+e]=b["moz"+e]=b["webkit"+e]=b["o"+e]=d},getVendorAttribute:function(b,c){var d=c.charAt(0).toUpperCase()+c.substr(1);return"undefined"!==typeof b.imageSmoothingEnabled?b[c]||b["ms"+d]||b["moz"+d]||b["o"+d]:b[c]||b["ms"+d]||b["moz"+d]||b["webkit"+
d]||b["o"+d]},normalizeVendorAttribute:function(b,c){var d=ig.getVendorAttribute(b,c);!b[c]&&d&&(b[c]=d)},getImagePixels:function(b,c,d,e,f){var j=ig.$new("canvas");j.width=b.width;j.height=b.height;var n=j.getContext("2d");ig.System.SCALE.CRISP(j,n);var u=ig.getVendorAttribute(n,"backingStorePixelRatio")||1;ig.normalizeVendorAttribute(n,"getImageDataHD");var v=b.width/u,z=b.height/u;j.width=Math.ceil(v);j.height=Math.ceil(z);n.drawImage(b,0,0,v,z);return 1===u?n.getImageData(c,d,e,f):n.getImageDataHD(c,
d,e,f)},module:function(b){if(ig._current)throw"Module '"+ig._current.name+"' defines nothing";if(ig.modules[b]&&ig.modules[b].body)throw"Module '"+b+"' is already defined";ig._current={name:b,requires:[],loaded:!1,body:null};ig.modules[b]=ig._current;ig._loadQueue.push(ig._current);return ig},requires:function(){ig._current.requires=Array.prototype.slice.call(arguments);return ig},defines:function(b){ig._current.body=b;ig._current=null;ig._initDOMReady()},addResource:function(b){ig.resources.push(b)},
setNocache:function(b){ig.nocache=b?"?"+Date.now():""},log:function(){},assert:function(){},show:function(){},mark:function(){},_loadScript:function(b,c){ig.modules[b]={name:b,requires:[],loaded:!1,body:null};ig._waitForOnload++;var d=ig.prefix+ig.lib+b.replace(/\./g,"/")+".js"+ig.nocache,e=ig.$new("script");e.type="text/javascript";e.src=d;e.onload=function(){ig._waitForOnload--;ig._execModules()};e.onerror=function(){throw"Failed to load module "+b+" at "+d+" required from "+c;};ig.$("head")[0].appendChild(e)},
_execModules:function(){for(var b=!1,c=0;c<ig._loadQueue.length;c++){for(var d=ig._loadQueue[c],e=!0,f=0;f<d.requires.length;f++){var j=d.requires[f];ig.modules[j]?ig.modules[j].loaded||(e=!1):(e=!1,ig._loadScript(j,d.name))}e&&d.body&&(ig._loadQueue.splice(c,1),d.loaded=!0,d.body(),b=!0,c--)}if(b)ig._execModules();else if(!ig.baked&&0==ig._waitForOnload&&0!=ig._loadQueue.length){b=[];for(c=0;c<ig._loadQueue.length;c++){e=[];j=ig._loadQueue[c].requires;for(f=0;f<j.length;f++)d=ig.modules[j[f]],(!d||
!d.loaded)&&e.push(j[f]);b.push(ig._loadQueue[c].name+" (requires: "+e.join(", ")+")")}throw"Unresolved (or circular?) dependencies. Most likely there's a name/path mismatch for one of the listed modules or a previous syntax error prevents a module from loading:\n"+b.join("\n");}},_DOMReady:function(){if(!ig.modules["dom.ready"].loaded){if(!document.body)return setTimeout(ig._DOMReady,13);ig.modules["dom.ready"].loaded=!0;ig._waitForOnload--;ig._execModules()}return 0},_boot:function(){document.location.href.match(/\?nocache/)&&
ig.setNocache(!0);ig.ua.pixelRatio=b.devicePixelRatio||1;ig.ua.viewport={width:b.innerWidth,height:b.innerHeight};ig.ua.screen={width:b.screen.availWidth*ig.ua.pixelRatio,height:b.screen.availHeight*ig.ua.pixelRatio};ig.ua.iPhone=/iPhone/i.test(navigator.userAgent);ig.ua.iPhone4=ig.ua.iPhone&&2==ig.ua.pixelRatio;ig.ua.iPad=/iPad/i.test(navigator.userAgent);ig.ua.android=/android/i.test(navigator.userAgent);ig.ua.winPhone=/Windows Phone/i.test(navigator.userAgent);ig.ua.is_uiwebview=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);
ig.ua.is_safari_or_uiwebview=/(iPhone|iPod|iPad).*AppleWebKit/i.test(navigator.userAgent);ig.ua.iOS=ig.ua.iPhone||ig.ua.iPad;ig.ua.iOS6_tag=/OS 6_/i.test(navigator.userAgent);ig.ua.iOS6=(ig.ua.iPhone||ig.ua.iPad)&&ig.ua.iOS6_tag;ig.ua.iOSgt5=ig.ua.iOS&&5<parseInt(navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/)[1]);ig.ua.HTCONE=/HTC_One/i.test(navigator.userAgent);ig.ua.winPhone=/Windows Phone/i.test(navigator.userAgent);ig.ua.Kindle=/Silk/i.test(navigator.userAgent);ig.ua.touchDevice="ontouchstart"in
b||b.navigator.msMaxTouchPoints;ig.ua.mobile=ig.ua.iOS||ig.ua.android||ig.ua.iOS6||ig.ua.winPhone||ig.ua.Kindle||/mobile/i.test(navigator.userAgent)},_initDOMReady:function(){ig.modules["dom.ready"]?ig._execModules():(ig._boot(),ig.modules["dom.ready"]={requires:[],loaded:!1,body:null},ig._waitForOnload++,"complete"===document.readyState?ig._DOMReady():(document.addEventListener("DOMContentLoaded",ig._DOMReady,!1),b.addEventListener("load",ig._DOMReady,!1)))}};ig.normalizeVendorAttribute(b,"requestAnimationFrame");
if(b.requestAnimationFrame){var c=1,e={};b.ig.setAnimation=function(d){var f=c++;e[f]=!0;var j=function(){e[f]&&(b.requestAnimationFrame(j),d())};b.requestAnimationFrame(j);return f};b.ig.clearAnimation=function(b){delete e[b]}}else b.ig.setAnimation=function(c){return b.setInterval(c,1E3/60)},b.ig.clearAnimation=function(c){b.clearInterval(c)};var d=!1,j=/xyz/.test(function(){xyz})?/\bparent\b/:/.*/,f=0;b.ig.Class=function(){};var n=function(b){var c=this.prototype,d={},e;for(e in b)"function"==
typeof b[e]&&"function"==typeof c[e]&&j.test(b[e])?(d[e]=c[e],c[e]=function(b,c){return function(){var e=this.parent;this.parent=d[b];var f=c.apply(this,arguments);this.parent=e;return f}}(e,b[e])):c[e]=b[e]};b.ig.Class.extend=function(c){function e(){if(!d){if(this.staticInstantiate){var b=this.staticInstantiate.apply(this,arguments);if(b)return b}for(var c in this)"object"==typeof this[c]&&(this[c]=ig.copy(this[c]));this.init&&this.init.apply(this,arguments)}return this}var m=this.prototype;d=!0;
var p=new this;d=!1;for(var r in c)p[r]="function"==typeof c[r]&&"function"==typeof m[r]&&j.test(c[r])?function(b,c){return function(){var d=this.parent;this.parent=m[b];var e=c.apply(this,arguments);this.parent=d;return e}}(r,c[r]):c[r];e.prototype=p;e.prototype.constructor=e;e.extend=b.ig.Class.extend;e.inject=n;e.classId=p.classId=++f;return e};b.ImpactMixin&&ig.merge(ig,b.ImpactMixin)})(window);ig.baked=!0;
ig.module("impact.image").defines(function(){ig.Image=ig.Class.extend({data:null,width:0,height:0,loaded:!1,failed:!1,loadCallback:null,path:"",staticInstantiate:function(b){return ig.Image.cache[b]||null},init:function(b){this.path=b;this.load()},load:function(b){this.loaded?b&&b(this.path,!0):(!this.loaded&&ig.ready?(this.loadCallback=b||null,this.data=new Image,this.data.onload=this.onload.bind(this),this.data.onerror=this.onerror.bind(this),this.data.src=ig.prefix+this.path+ig.nocache):ig.addResource(this),
ig.Image.cache[this.path]=this)},reload:function(){this.loaded=!1;this.data=new Image;this.data.onload=this.onload.bind(this);this.data.src=this.path+"?"+Date.now()},onload:function(){this.width=this.data.width;this.height=this.data.height;this.loaded=!0;1!=ig.system.scale&&this.resize(ig.system.scale);this.loadCallback&&this.loadCallback(this.path,!0)},onerror:function(){this.failed=!0;this.loadCallback&&this.loadCallback(this.path,!1)},resize:function(b){var c=ig.getImagePixels(this.data,0,0,this.width,
this.height),e=this.width*b,d=this.height*b,j=ig.$new("canvas");j.width=e;j.height=d;for(var f=j.getContext("2d"),n=f.getImageData(0,0,e,d),l=0;l<d;l++)for(var g=0;g<e;g++){var m=4*(Math.floor(l/b)*this.width+Math.floor(g/b)),p=4*(l*e+g);n.data[p]=c.data[m];n.data[p+1]=c.data[m+1];n.data[p+2]=c.data[m+2];n.data[p+3]=c.data[m+3]}f.putImageData(n,0,0);this.data=j},draw:function(b,c,e,d,j,f){if(this.loaded){var n=ig.system.scale;j=(j?j:this.width)*n;f=(f?f:this.height)*n;ig.system.context.drawImage(this.data,
e?e*n:0,d?d*n:0,j,f,ig.system.getDrawPos(b),ig.system.getDrawPos(c),j,f);ig.Image.drawCount++}},drawTile:function(b,c,e,d,j,f,n){j=j?j:d;if(this.loaded&&!(d>this.width||j>this.height)){var l=ig.system.scale,g=Math.floor(d*l),m=Math.floor(j*l),p=f?-1:1,r=n?-1:1;if(f||n)ig.system.context.save(),ig.system.context.scale(p,r);ig.system.context.drawImage(this.data,Math.floor(e*d)%this.width*l,Math.floor(e*d/this.width)*j*l,g,m,ig.system.getDrawPos(b)*p-(f?g:0),ig.system.getDrawPos(c)*r-(n?m:0),g,m);(f||
n)&&ig.system.context.restore();ig.Image.drawCount++}}});ig.Image.drawCount=0;ig.Image.cache={};ig.Image.reloadCache=function(){for(var b in ig.Image.cache)ig.Image.cache[b].reload()}});ig.baked=!0;
ig.module("impact.font").requires("impact.image").defines(function(){ig.Font=ig.Image.extend({widthMap:[],indices:[],firstChar:32,alpha:1,letterSpacing:1,lineSpacing:0,onload:function(b){this._loadMetrics(this.data);this.parent(b)},widthForString:function(b){if(-1!==b.indexOf("\n")){b=b.split("\n");for(var c=0,e=0;e<b.length;e++)c=Math.max(c,this._widthForLine(b[e]));return c}return this._widthForLine(b)},_widthForLine:function(b){for(var c=0,e=0;e<b.length;e++)c+=this.widthMap[b.charCodeAt(e)-this.firstChar]+
this.letterSpacing;return c},heightForString:function(b){return b.split("\n").length*(this.height+this.lineSpacing)},draw:function(b,c,e,d){"string"!=typeof b&&(b=b.toString());if(-1!==b.indexOf("\n")){b=b.split("\n");for(var j=this.height+this.lineSpacing,f=0;f<b.length;f++)this.draw(b[f],c,e+f*j,d)}else{if(d==ig.Font.ALIGN.RIGHT||d==ig.Font.ALIGN.CENTER)f=this._widthForLine(b),c-=d==ig.Font.ALIGN.CENTER?f/2:f;1!==this.alpha&&(ig.system.context.globalAlpha=this.alpha);for(f=0;f<b.length;f++)d=b.charCodeAt(f),
c+=this._drawChar(d-this.firstChar,c,e);1!==this.alpha&&(ig.system.context.globalAlpha=1);ig.Image.drawCount+=b.length}},_drawChar:function(b,c,e){if(!this.loaded||0>b||b>=this.indices.length)return 0;var d=ig.system.scale,j=this.widthMap[b]*d,f=(this.height-2)*d;ig.system.context.drawImage(this.data,this.indices[b]*d,0,j,f,ig.system.getDrawPos(c),ig.system.getDrawPos(e),j,f);return this.widthMap[b]+this.letterSpacing},_loadMetrics:function(b){this.height=b.height-1;this.widthMap=[];this.indices=
[];for(var c=ig.getImagePixels(b,0,b.height-1,b.width,1),e=0,d=0,j=0;j<b.width;j++){var f=4*j+3;127<c.data[f]?d++:128>c.data[f]&&d&&(this.widthMap.push(d),this.indices.push(j-d),e++,d=0)}this.widthMap.push(d);this.indices.push(j-d)}});ig.Font.ALIGN={LEFT:0,RIGHT:1,CENTER:2}});ig.baked=!0;
ig.module("impact.sound").defines(function(){ig.SoundManager=ig.Class.extend({clips:{},volume:1,format:null,init:function(){if(!ig.Sound.enabled||!window.Audio)ig.Sound.enabled=!1;else{for(var b=new Audio,c=0;c<ig.Sound.use.length;c++){var e=ig.Sound.use[c];if(b.canPlayType(e.mime)){this.format=e;break}}this.format||(ig.Sound.enabled=!1)}},load:function(b,c,e){var d=ig.prefix+b.replace(/[^\.]+$/,this.format.ext)+ig.nocache;if(this.clips[b]){if(c&&this.clips[b].length<ig.Sound.channels)for(c=this.clips[b].length;c<
ig.Sound.channels;c++){var j=new Audio(d);j.load();this.clips[b].push(j)}return this.clips[b][0]}var f=new Audio(d);e&&(f.addEventListener("canplaythrough",function l(c){f.removeEventListener("canplaythrough",l,!1);e(b,!0,c)},!1),f.addEventListener("error",function(c){e(b,!1,c)},!1));f.preload="auto";f.load();this.clips[b]=[f];if(c)for(c=1;c<ig.Sound.channels;c++)j=new Audio(d),j.load(),this.clips[b].push(j);return f},get:function(b){b=this.clips[b];for(var c=0,e;e=b[c++];)if(e.paused||e.ended)return e.ended&&
(e.currentTime=0),e;b[0].pause();b[0].currentTime=0;return b[0]}});ig.Music=ig.Class.extend({tracks:[],namedTracks:{},currentTrack:null,currentIndex:0,random:!1,_volume:1,_loop:!1,_fadeInterval:0,_fadeTimer:null,_endedCallbackBound:null,init:function(){this._endedCallbackBound=this._endedCallback.bind(this);Object.defineProperty?(Object.defineProperty(this,"volume",{get:this.getVolume.bind(this),set:this.setVolume.bind(this)}),Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)})):
this.__defineGetter__&&(this.__defineGetter__("volume",this.getVolume.bind(this)),this.__defineSetter__("volume",this.setVolume.bind(this)),this.__defineGetter__("loop",this.getLooping.bind(this)),this.__defineSetter__("loop",this.setLooping.bind(this)))},add:function(b,c){if(ig.Sound.enabled){var e=ig.soundManager.load(b instanceof ig.Sound?b.path:b,!1);e.loop=this._loop;e.volume=this._volume;e.addEventListener("ended",this._endedCallbackBound,!1);this.tracks.push(e);c&&(this.namedTracks[c]=e);this.currentTrack||
(this.currentTrack=e)}},next:function(){this.tracks.length&&(this.stop(),this.currentIndex=this.random?Math.floor(Math.random()*this.tracks.length):(this.currentIndex+1)%this.tracks.length,this.currentTrack=this.tracks[this.currentIndex],this.play())},pause:function(){this.currentTrack&&this.currentTrack.pause()},stop:function(){this.currentTrack&&(this.currentTrack.pause(),this.currentTrack.currentTime=0)},play:function(b){if(b&&this.namedTracks[b])b=this.namedTracks[b],b!=this.currentTrack&&(this.stop(),
this.currentTrack=b);else if(!this.currentTrack)return;this.currentTrack.play()},getLooping:function(){return this._loop},setLooping:function(b){this._loop=b;for(var c in this.tracks)this.tracks[c].loop=b},getVolume:function(){return this._volume},setVolume:function(b){this._volume=b.limit(0,1);for(var c in this.tracks)this.tracks[c].volume=this._volume},fadeOut:function(b){this.currentTrack&&(clearInterval(this._fadeInterval),this.fadeTimer=new ig.Timer(b),this._fadeInterval=setInterval(this._fadeStep.bind(this),
50))},_fadeStep:function(){var b=this.fadeTimer.delta().map(-this.fadeTimer.target,0,1,0).limit(0,1)*this._volume;0.01>=b?(this.stop(),this.currentTrack.volume=this._volume,clearInterval(this._fadeInterval)):this.currentTrack.volume=b},_endedCallback:function(){this._loop?this.play():this.next()}});ig.Sound=ig.Class.extend({path:"",volume:1,currentClip:null,multiChannel:!0,init:function(b,c){this.path=b;this.multiChannel=!1!==c;this.load()},load:function(b){ig.Sound.enabled?ig.ready?ig.soundManager.load(this.path,
this.multiChannel,b):ig.addResource(this):b&&b(this.path,!0)},play:function(){ig.Sound.enabled&&(this.currentClip=ig.soundManager.get(this.path),this.currentClip.volume=ig.soundManager.volume*this.volume,this.currentClip.play())},stop:function(){this.currentClip&&(this.currentClip.pause(),this.currentClip.currentTime=0)}});ig.Sound.FORMAT={MP3:{ext:"mp3",mime:"audio/mpeg"},M4A:{ext:"m4a",mime:"audio/mp4; codecs=mp4a"},OGG:{ext:"ogg",mime:"audio/ogg; codecs=vorbis"},WEBM:{ext:"webm",mime:"audio/webm; codecs=vorbis"},
CAF:{ext:"caf",mime:"audio/x-caf"}};ig.Sound.use=[ig.Sound.FORMAT.OGG,ig.Sound.FORMAT.MP3];ig.Sound.channels=4;ig.Sound.enabled=!0});ig.baked=!0;
ig.module("impact.loader").requires("impact.image","impact.font","impact.sound").defines(function(){ig.Loader=ig.Class.extend({resources:[],gameClass:null,status:0,done:!1,_unloaded:[],_drawStatus:0,_intervalId:0,_loadCallbackBound:null,init:function(b,c){this.gameClass=b;this.resources=c;this._loadCallbackBound=this._loadCallback.bind(this);for(var e=0;e<this.resources.length;e++)this._unloaded.push(this.resources[e].path)},load:function(){ig.system.clear("#000");if(this.resources.length){for(var b=
0;b<this.resources.length;b++)this.loadResource(this.resources[b]);this._intervalId=setInterval(this.draw.bind(this),16)}else this.end()},loadResource:function(b){b.load(this._loadCallbackBound)},end:function(){this.done||(this.done=!0,clearInterval(this._intervalId))},draw:function(){},_loadCallback:function(b,c){if(c)this._unloaded.erase(b);else throw"Failed to load resource: "+b;this.status=1-this._unloaded.length/this.resources.length;0==this._unloaded.length&&setTimeout(this.end.bind(this),250)}})});
ig.baked=!0;
ig.module("impact.timer").defines(function(){ig.Timer=ig.Class.extend({target:0,base:0,last:0,pausedAt:0,init:function(b){this.last=this.base=ig.Timer.time;this.target=b||0},set:function(b){this.target=b||0;this.base=ig.Timer.time;this.pausedAt=0},reset:function(){this.base=ig.Timer.time;this.pausedAt=0},tick:function(){var b=ig.Timer.time-this.last;this.last=ig.Timer.time;return this.pausedAt?0:b},delta:function(){return(this.pausedAt||ig.Timer.time)-this.base-this.target},pause:function(){this.pausedAt||(this.pausedAt=
ig.Timer.time)},unpause:function(){this.pausedAt&&(this.base+=ig.Timer.time-this.pausedAt,this.pausedAt=0)}});ig.Timer._last=0;ig.Timer.time=Number.MIN_VALUE;ig.Timer.timeScale=1;ig.Timer.maxStep=0.05;ig.Timer.step=function(){var b=Date.now();ig.Timer.time+=Math.min((b-ig.Timer._last)/1E3,ig.Timer.maxStep)*ig.Timer.timeScale;ig.Timer._last=b}});ig.baked=!0;
ig.module("impact.system").requires("impact.timer","impact.image").defines(function(){ig.System=ig.Class.extend({fps:30,width:320,height:240,realWidth:320,realHeight:240,scale:1,tick:0,animationId:0,newGameClass:null,running:!1,delegate:null,clock:null,canvas:null,context:null,init:function(b,c,e,d,j){this.fps=c;this.clock=new ig.Timer;this.canvas=ig.$(b);this.resize(e,d,j);this.context=this.canvas.getContext("2d");this.getDrawPos=ig.System.drawMode;1!=this.scale&&(ig.System.scaleMode=ig.System.SCALE.CRISP);
ig.System.scaleMode(this.canvas,this.context)},resize:function(b,c,e){this.width=b;this.height=c;this.scale=e||this.scale;this.realWidth=this.width*this.scale;this.realHeight=this.height*this.scale;this.canvas.width=this.realWidth;this.canvas.height=this.realHeight},setGame:function(b){this.running?this.newGameClass=b:this.setGameNow(b)},setGameNow:function(b){ig.game=new b;ig.system.setDelegate(ig.game)},setDelegate:function(b){if("function"==typeof b.run)this.delegate=b,this.startRunLoop();else throw"System.setDelegate: No run() function in object";
},stopRunLoop:function(){ig.clearAnimation(this.animationId);this.running=!1},startRunLoop:function(){this.stopRunLoop();this.animationId=ig.setAnimation(this.run.bind(this));this.running=!0},clear:function(b){this.context.fillStyle=b;this.context.fillRect(0,0,this.realWidth,this.realHeight)},run:function(){ig.Timer.step();this.tick=this.clock.tick();this.delegate.run();ig.input.clearPressed();this.newGameClass&&(this.setGameNow(this.newGameClass),this.newGameClass=null)},getDrawPos:null});ig.System.DRAW=
{AUTHENTIC:function(b){return Math.round(b)*this.scale},SMOOTH:function(b){return Math.round(b*this.scale)},SUBPIXEL:function(b){return b*this.scale}};ig.System.drawMode=ig.System.DRAW.SMOOTH;ig.System.SCALE={CRISP:function(b,c){ig.setVendorAttribute(c,"imageSmoothingEnabled",!1);b.style.imageRendering="-moz-crisp-edges";b.style.imageRendering="-o-crisp-edges";b.style.imageRendering="-webkit-optimize-contrast";b.style.imageRendering="crisp-edges";b.style.msInterpolationMode="nearest-neighbor"},SMOOTH:function(b,
c){ig.setVendorAttribute(c,"imageSmoothingEnabled",!0);b.style.imageRendering="";b.style.msInterpolationMode=""}};ig.System.scaleMode=ig.System.SCALE.SMOOTH});ig.baked=!0;
ig.module("impact.input").defines(function(){ig.KEY={MOUSE1:-1,MOUSE2:-3,MWHEEL_UP:-4,MWHEEL_DOWN:-5,BACKSPACE:8,TAB:9,ENTER:13,PAUSE:19,CAPS:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,_0:48,_1:49,_2:50,_3:51,_4:52,_5:53,_6:54,_7:55,_8:56,_9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,
NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SHIFT:16,CTRL:17,ALT:18,PLUS:187,COMMA:188,MINUS:189,PERIOD:190};ig.Input=ig.Class.extend({bindings:{},actions:{},presses:{},locks:{},delayedKeyup:{},isUsingMouse:!1,isUsingKeyboard:!1,isUsingAccelerometer:!1,mouse:{x:0,y:0},accel:{x:0,y:0,z:0},initMouse:function(){if(!this.isUsingMouse){this.isUsingMouse=
!0;var b=this.mousewheel.bind(this);ig.system.canvas.addEventListener("wheel",b,!1);ig.system.canvas.addEventListener("mousewheel",b,!1);ig.system.canvas.addEventListener("DOMMouseScroll",b,!1);ig.system.canvas.addEventListener("contextmenu",this.contextmenu.bind(this),!1);ig.system.canvas.addEventListener("mousedown",this.keydown.bind(this),!1);ig.system.canvas.addEventListener("mouseup",this.keyup.bind(this),!1);ig.system.canvas.addEventListener("mousemove",this.mousemove.bind(this),!1);ig.ua.touchDevice&&
(ig.system.canvas.addEventListener("touchstart",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.mousemove.bind(this),!1),ig.system.canvas.addEventListener("MSPointerDown",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("MSPointerUp",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",this.mousemove.bind(this),!1),ig.system.canvas.style.msTouchAction="none")}},
initKeyboard:function(){this.isUsingKeyboard||(this.isUsingKeyboard=!0,window.addEventListener("keydown",this.keydown.bind(this),!1),window.addEventListener("keyup",this.keyup.bind(this),!1))},initAccelerometer:function(){this.isUsingAccelerometer||window.addEventListener("devicemotion",this.devicemotion.bind(this),!1)},mousewheel:function(b){var c=this.bindings[0<(b.wheelDelta?b.wheelDelta:-1*b.detail)?ig.KEY.MWHEEL_UP:ig.KEY.MWHEEL_DOWN];c&&(this.actions[c]=!0,this.presses[c]=!0,this.delayedKeyup[c]=
!0,b.stopPropagation(),b.preventDefault())},mousemove:function(b){var c=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth;ig.ua.mobile&&(c=ig.system.realWidth);var c=ig.system.scale*(c/ig.system.realWidth),e={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());b=b.touches?b.touches[0]:b;this.mouse.x=(b.clientX-e.left)/c;this.mouse.y=(b.clientY-e.top)/c},contextmenu:function(b){this.bindings[ig.KEY.MOUSE2]&&(b.stopPropagation(),b.preventDefault())},
keydown:function(b){var c=b.target.tagName;"INPUT"==c||"TEXTAREA"==c||(c="keydown"==b.type?b.keyCode:2==b.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1,("touchstart"==b.type||"mousedown"==b.type)&&this.mousemove(b),c=this.bindings[c],console.log(c),c&&(this.actions[c]=!0,this.locks[c]||(this.presses[c]=!0,this.locks[c]=!0),b.stopPropagation(),b.preventDefault()))},keyup:function(b){var c=b.target.tagName;if(!("INPUT"==c||"TEXTAREA"==c))if(c=this.bindings["keyup"==b.type?b.keyCode:2==b.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1])this.delayedKeyup[c]=
!0,b.stopPropagation(),b.preventDefault()},devicemotion:function(b){this.accel=b.accelerationIncludingGravity},bind:function(b,c){0>b?this.initMouse():0<b&&this.initKeyboard();this.bindings[b]=c},bindTouch:function(b,c){var e=ig.$(b),d=this;e.addEventListener("touchstart",function(b){d.touchStart(b,c)},!1);e.addEventListener("touchend",function(b){d.touchEnd(b,c)},!1);e.addEventListener("MSPointerDown",function(b){d.touchStart(b,c)},!1);e.addEventListener("MSPointerUp",function(b){d.touchEnd(b,c)},
!1)},unbind:function(b){this.delayedKeyup[this.bindings[b]]=!0;this.bindings[b]=null},unbindAll:function(){this.bindings={};this.actions={};this.presses={};this.locks={};this.delayedKeyup={}},state:function(b){return this.actions[b]},pressed:function(b){return this.presses[b]},released:function(b){return!!this.delayedKeyup[b]},clearPressed:function(){for(var b in this.delayedKeyup)this.actions[b]=!1,this.locks[b]=!1;this.delayedKeyup={};this.presses={}},touchStart:function(b,c){this.actions[c]=!0;
this.presses[c]=!0;b.stopPropagation();b.preventDefault();return!1},touchEnd:function(b,c){this.delayedKeyup[c]=!0;b.stopPropagation();b.preventDefault();return!1}})});ig.baked=!0;ig.module("impact.impact").requires("dom.ready","impact.loader","impact.system","impact.input","impact.sound").defines(function(){ig.main=function(b,c,e,d,j,f,n){ig.system=new ig.System(b,e,d,j,f||1);ig.input=new ig.Input;ig.soundManager=new ig.SoundManager;ig.music=new ig.Music;ig.ready=!0;(new (n||ig.Loader)(c,ig.resources)).load()}});
ig.baked=!0;
ig.module("impact.animation").requires("impact.timer","impact.image").defines(function(){ig.AnimationSheet=ig.Class.extend({width:8,height:8,image:null,init:function(b,c,e){this.width=c;this.height=e;this.image=new ig.Image(b)}});ig.Animation=ig.Class.extend({sheet:null,timer:null,sequence:[],flip:{x:!1,y:!1},pivot:{x:0,y:0},frame:0,tile:0,loopCount:0,alpha:1,angle:0,init:function(b,c,e,d){this.sheet=b;this.pivot={x:b.width/2,y:b.height/2};this.timer=new ig.Timer;this.frameTime=c;this.sequence=e;
this.stop=!!d;this.tile=this.sequence[0]},rewind:function(){this.timer.set();this.frame=this.loopCount=0;this.tile=this.sequence[0];return this},gotoFrame:function(b){this.timer.set(this.frameTime*-b-1E-4);this.update()},gotoRandomFrame:function(){this.gotoFrame(Math.floor(Math.random()*this.sequence.length))},update:function(){var b=Math.floor(this.timer.delta()/this.frameTime);this.loopCount=Math.floor(b/this.sequence.length);this.frame=this.stop&&0<this.loopCount?this.sequence.length-1:b%this.sequence.length;
this.tile=this.sequence[this.frame]},draw:function(b,c){var e=Math.max(this.sheet.width,this.sheet.height);b>ig.system.width||(c>ig.system.height||0>b+e||0>c+e)||(1!=this.alpha&&(ig.system.context.globalAlpha=this.alpha),0==this.angle?this.sheet.image.drawTile(b,c,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y):(ig.system.context.save(),ig.system.context.translate(ig.system.getDrawPos(b+this.pivot.x),ig.system.getDrawPos(c+this.pivot.y)),ig.system.context.rotate(this.angle),
this.sheet.image.drawTile(-this.pivot.x,-this.pivot.y,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y),ig.system.context.restore()),1!=this.alpha&&(ig.system.context.globalAlpha=1))}})});ig.baked=!0;
ig.module("impact.entity").requires("impact.animation","impact.impact").defines(function(){ig.Entity=ig.Class.extend({id:0,settings:{},size:{x:16,y:16},offset:{x:0,y:0},pos:{x:0,y:0},last:{x:0,y:0},vel:{x:0,y:0},accel:{x:0,y:0},friction:{x:0,y:0},maxVel:{x:100,y:100},zIndex:0,gravityFactor:1,standing:!1,bounciness:0,minBounceVelocity:40,anims:{},animSheet:null,currentAnim:null,health:10,type:0,checkAgainst:0,collides:0,_killed:!1,slopeStanding:{min:(44).toRad(),max:(136).toRad()},init:function(b,
c,e){this.id=++ig.Entity._lastId;this.pos.x=this.last.x=b;this.pos.y=this.last.y=c;ig.merge(this,e)},reset:function(b,c,e){var d=this.constructor.prototype;this.pos.x=b;this.pos.y=c;this.last.x=b;this.last.y=c;this.vel.x=d.vel.x;this.vel.y=d.vel.y;this.accel.x=d.accel.x;this.accel.y=d.accel.y;this.health=d.health;this._killed=d._killed;this.standing=d.standing;this.type=d.type;this.checkAgainst=d.checkAgainst;this.collides=d.collides;ig.merge(this,e)},addAnim:function(b,c,e,d){if(!this.animSheet)throw"No animSheet to add the animation "+
b+" to.";c=new ig.Animation(this.animSheet,c,e,d);this.anims[b]=c;this.currentAnim||(this.currentAnim=c);return c},update:function(){this.last.x=this.pos.x;this.last.y=this.pos.y;this.vel.y+=ig.game.gravity*ig.system.tick*this.gravityFactor;this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x);this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y,this.friction.y,this.maxVel.y);var b=ig.game.collisionMap.trace(this.pos.x,this.pos.y,this.vel.x*ig.system.tick,this.vel.y*
ig.system.tick,this.size.x,this.size.y);this.handleMovementTrace(b);this.currentAnim&&this.currentAnim.update()},getNewVelocity:function(b,c,e,d){return c?(b+c*ig.system.tick).limit(-d,d):e?(c=e*ig.system.tick,0<b-c?b-c:0>b+c?b+c:0):b.limit(-d,d)},handleMovementTrace:function(b){this.standing=!1;b.collision.y&&(0<this.bounciness&&Math.abs(this.vel.y)>this.minBounceVelocity?this.vel.y*=-this.bounciness:(0<this.vel.y&&(this.standing=!0),this.vel.y=0));b.collision.x&&(this.vel.x=0<this.bounciness&&Math.abs(this.vel.x)>
this.minBounceVelocity?this.vel.x*-this.bounciness:0);if(b.collision.slope){var c=b.collision.slope;if(0<this.bounciness){var e=this.vel.x*c.nx+this.vel.y*c.ny;this.vel.x=(this.vel.x-2*c.nx*e)*this.bounciness;this.vel.y=(this.vel.y-2*c.ny*e)*this.bounciness}else e=(this.vel.x*c.x+this.vel.y*c.y)/(c.x*c.x+c.y*c.y),this.vel.x=c.x*e,this.vel.y=c.y*e,c=Math.atan2(c.x,c.y),c>this.slopeStanding.min&&c<this.slopeStanding.max&&(this.standing=!0)}this.pos=b.pos},draw:function(){this.currentAnim&&this.currentAnim.draw(this.pos.x-
this.offset.x-ig.game._rscreen.x,this.pos.y-this.offset.y-ig.game._rscreen.y)},kill:function(){ig.game.removeEntity(this)},receiveDamage:function(b){this.health-=b;0>=this.health&&this.kill()},touches:function(b){return!(this.pos.x>=b.pos.x+b.size.x||this.pos.x+this.size.x<=b.pos.x||this.pos.y>=b.pos.y+b.size.y||this.pos.y+this.size.y<=b.pos.y)},distanceTo:function(b){var c=this.pos.x+this.size.x/2-(b.pos.x+b.size.x/2);b=this.pos.y+this.size.y/2-(b.pos.y+b.size.y/2);return Math.sqrt(c*c+b*b)},angleTo:function(b){return Math.atan2(b.pos.y+
b.size.y/2-(this.pos.y+this.size.y/2),b.pos.x+b.size.x/2-(this.pos.x+this.size.x/2))},check:function(){},collideWith:function(){},ready:function(){},erase:function(){}});ig.Entity._lastId=0;ig.Entity.COLLIDES={NEVER:0,LITE:1,PASSIVE:2,ACTIVE:4,FIXED:8};ig.Entity.TYPE={NONE:0,A:1,B:2,BOTH:3};ig.Entity.checkPair=function(b,c){b.checkAgainst&c.type&&b.check(c);c.checkAgainst&b.type&&c.check(b);b.collides&&(c.collides&&b.collides+c.collides>ig.Entity.COLLIDES.ACTIVE)&&ig.Entity.solveCollision(b,c)};ig.Entity.solveCollision=
function(b,c){var e=null;if(b.collides==ig.Entity.COLLIDES.LITE||c.collides==ig.Entity.COLLIDES.FIXED)e=b;else if(c.collides==ig.Entity.COLLIDES.LITE||b.collides==ig.Entity.COLLIDES.FIXED)e=c;b.last.x+b.size.x>c.last.x&&b.last.x<c.last.x+c.size.x?(b.last.y<c.last.y?ig.Entity.seperateOnYAxis(b,c,e):ig.Entity.seperateOnYAxis(c,b,e),b.collideWith(c,"y"),c.collideWith(b,"y")):b.last.y+b.size.y>c.last.y&&b.last.y<c.last.y+c.size.y&&(b.last.x<c.last.x?ig.Entity.seperateOnXAxis(b,c,e):ig.Entity.seperateOnXAxis(c,
b,e),b.collideWith(c,"x"),c.collideWith(b,"x"))};ig.Entity.seperateOnXAxis=function(b,c,e){var d=b.pos.x+b.size.x-c.pos.x;e?(e.vel.x=-e.vel.x*e.bounciness+(b===e?c:b).vel.x,c=ig.game.collisionMap.trace(e.pos.x,e.pos.y,e==b?-d:d,0,e.size.x,e.size.y),e.pos.x=c.pos.x):(e=(b.vel.x-c.vel.x)/2,b.vel.x=-e,c.vel.x=e,e=ig.game.collisionMap.trace(b.pos.x,b.pos.y,-d/2,0,b.size.x,b.size.y),b.pos.x=Math.floor(e.pos.x),b=ig.game.collisionMap.trace(c.pos.x,c.pos.y,d/2,0,c.size.x,c.size.y),c.pos.x=Math.ceil(b.pos.x))};
ig.Entity.seperateOnYAxis=function(b,c,e){var d=b.pos.y+b.size.y-c.pos.y;if(e){c=b===e?c:b;e.vel.y=-e.vel.y*e.bounciness+c.vel.y;var j=0;e==b&&Math.abs(e.vel.y-c.vel.y)<e.minBounceVelocity&&(e.standing=!0,j=c.vel.x*ig.system.tick);b=ig.game.collisionMap.trace(e.pos.x,e.pos.y,j,e==b?-d:d,e.size.x,e.size.y);e.pos.y=b.pos.y;e.pos.x=b.pos.x}else ig.game.gravity&&(c.standing||0<b.vel.y)?(e=ig.game.collisionMap.trace(b.pos.x,b.pos.y,0,-(b.pos.y+b.size.y-c.pos.y),b.size.x,b.size.y),b.pos.y=e.pos.y,0<b.bounciness&&
b.vel.y>b.minBounceVelocity?b.vel.y*=-b.bounciness:(b.standing=!0,b.vel.y=0)):(e=(b.vel.y-c.vel.y)/2,b.vel.y=-e,c.vel.y=e,j=c.vel.x*ig.system.tick,e=ig.game.collisionMap.trace(b.pos.x,b.pos.y,j,-d/2,b.size.x,b.size.y),b.pos.y=e.pos.y,b=ig.game.collisionMap.trace(c.pos.x,c.pos.y,0,d/2,c.size.x,c.size.y),c.pos.y=b.pos.y)}});ig.baked=!0;
ig.module("impact.map").defines(function(){ig.Map=ig.Class.extend({tilesize:8,width:1,height:1,data:[[]],name:null,init:function(b,c){this.tilesize=b;this.data=c;this.height=c.length;this.width=c[0].length;this.pxWidth=this.width*this.tilesize;this.pxHeight=this.height*this.tilesize},getTile:function(b,c){var e=Math.floor(b/this.tilesize),d=Math.floor(c/this.tilesize);return 0<=e&&e<this.width&&0<=d&&d<this.height?this.data[d][e]:0},setTile:function(b,c,e){b=Math.floor(b/this.tilesize);c=Math.floor(c/
this.tilesize);0<=b&&b<this.width&&(0<=c&&c<this.height)&&(this.data[c][b]=e)}})});ig.baked=!0;
ig.module("impact.collision-map").requires("impact.map").defines(function(){ig.CollisionMap=ig.Map.extend({lastSlope:1,tiledef:null,init:function(b,c,j){this.parent(b,c);this.tiledef=j||ig.CollisionMap.defaultTileDef;for(var f in this.tiledef)f|0>this.lastSlope&&(this.lastSlope=f|0)},trace:function(b,c,j,f,n,l){var g={collision:{x:!1,y:!1,slope:!1},pos:{x:b,y:c},tile:{x:0,y:0}},m=Math.ceil(Math.max(Math.abs(j),Math.abs(f))/this.tilesize);if(1<m)for(var p=j/m,r=f/m,s=0;s<m&&(p||r)&&!(this._traceStep(g,
b,c,p,r,n,l,j,f,s),b=g.pos.x,c=g.pos.y,g.collision.x&&(j=p=0),g.collision.y&&(f=r=0),g.collision.slope);s++);else this._traceStep(g,b,c,j,f,n,l,j,f,0);return g},_traceStep:function(b,c,j,f,n,l,g,m,p,r){b.pos.x+=f;b.pos.y+=n;var s=0;if(f){var t=0<f?l:0,u=0>f?this.tilesize:0,s=Math.max(Math.floor(j/this.tilesize),0),v=Math.min(Math.ceil((j+g)/this.tilesize),this.height);f=Math.floor((b.pos.x+t)/this.tilesize);var z=Math.floor((c+t)/this.tilesize);if(0<r||f==z||0>z||z>=this.width)z=-1;if(0<=f&&f<this.width)for(var x=
s;x<v&&!(-1!=z&&(s=this.data[x][z],1<s&&s<=this.lastSlope&&this._checkTileDef(b,s,c,j,m,p,l,g,z,x)));x++)if(s=this.data[x][f],1==s||s>this.lastSlope||1<s&&this._checkTileDef(b,s,c,j,m,p,l,g,f,x)){if(1<s&&s<=this.lastSlope&&b.collision.slope)break;b.collision.x=!0;b.tile.x=s;c=b.pos.x=f*this.tilesize-t+u;m=0;break}}if(n){t=0<n?g:0;n=0>n?this.tilesize:0;s=Math.max(Math.floor(b.pos.x/this.tilesize),0);u=Math.min(Math.ceil((b.pos.x+l)/this.tilesize),this.width);x=Math.floor((b.pos.y+t)/this.tilesize);
v=Math.floor((j+t)/this.tilesize);if(0<r||x==v||0>v||v>=this.height)v=-1;if(0<=x&&x<this.height)for(f=s;f<u&&!(-1!=v&&(s=this.data[v][f],1<s&&s<=this.lastSlope&&this._checkTileDef(b,s,c,j,m,p,l,g,f,v)));f++)if(s=this.data[x][f],1==s||s>this.lastSlope||1<s&&this._checkTileDef(b,s,c,j,m,p,l,g,f,x)){if(1<s&&s<=this.lastSlope&&b.collision.slope)break;b.collision.y=!0;b.tile.y=s;b.pos.y=x*this.tilesize-t+n;break}}},_checkTileDef:function(b,c,j,f,n,l,g,m,p,r){var s=this.tiledef[c];if(!s)return!1;c=(s[2]-
s[0])*this.tilesize;var t=(s[3]-s[1])*this.tilesize,u=s[4];g=j+n+(0>t?g:0)-(p+s[0])*this.tilesize;m=f+l+(0<c?m:0)-(r+s[1])*this.tilesize;if(0<c*m-t*g){if(0>n*-t+l*c)return u;p=Math.sqrt(c*c+t*t);r=t/p;p=-c/p;var v=g*r+m*p,s=r*v,v=p*v;if(s*s+v*v>=n*n+l*l)return u||0.5>c*(m-l)-t*(g-n);b.pos.x=j+n-s;b.pos.y=f+l-v;b.collision.slope={x:c,y:t,nx:r,ny:p};return!0}return!1}});var b=1/3,c=2/3;ig.CollisionMap.defaultTileDef={5:[0,1,1,c,!0],6:[0,c,1,b,!0],7:[0,b,1,0,!0],3:[0,1,1,0.5,!0],4:[0,0.5,1,0,!0],2:[0,
1,1,0,!0],10:[0.5,1,1,0,!0],21:[0,1,0.5,0,!0],32:[c,1,1,0,!0],43:[b,1,c,0,!0],54:[0,1,b,0,!0],27:[0,0,1,b,!0],28:[0,b,1,c,!0],29:[0,c,1,1,!0],25:[0,0,1,0.5,!0],26:[0,0.5,1,1,!0],24:[0,0,1,1,!0],11:[0,0,0.5,1,!0],22:[0.5,0,1,1,!0],33:[0,0,b,1,!0],44:[b,0,c,1,!0],55:[c,0,1,1,!0],16:[1,b,0,0,!0],17:[1,c,0,b,!0],18:[1,1,0,c,!0],14:[1,0.5,0,0,!0],15:[1,1,0,0.5,!0],13:[1,1,0,0,!0],8:[0.5,1,0,0,!0],19:[1,1,0.5,0,!0],30:[b,1,0,0,!0],41:[c,1,b,0,!0],52:[1,1,c,0,!0],38:[1,c,0,1,!0],39:[1,b,0,c,!0],40:[1,0,
0,b,!0],36:[1,0.5,0,1,!0],37:[1,0,0,0.5,!0],35:[1,0,0,1,!0],9:[1,0,0.5,1,!0],20:[0.5,0,0,1,!0],31:[1,0,c,1,!0],42:[c,0,b,1,!0],53:[b,0,0,1,!0],12:[0,0,1,0,!1],23:[1,1,0,1,!1],34:[1,0,1,1,!1],45:[0,1,0,0,!1]};ig.CollisionMap.staticNoCollision={trace:function(b,c,j,f){return{collision:{x:!1,y:!1,slope:!1},pos:{x:b+j,y:c+f},tile:{x:0,y:0}}}}});ig.baked=!0;
ig.module("impact.background-map").requires("impact.map","impact.image").defines(function(){ig.BackgroundMap=ig.Map.extend({tiles:null,scroll:{x:0,y:0},distance:1,repeat:!1,tilesetName:"",foreground:!1,enabled:!0,preRender:!1,preRenderedChunks:null,chunkSize:512,debugChunks:!1,anims:{},init:function(b,c,e){this.parent(b,c);this.setTileset(e)},setTileset:function(b){this.tilesetName=b instanceof ig.Image?b.path:b;this.tiles=new ig.Image(this.tilesetName);this.preRenderedChunks=null},setScreenPos:function(b,
c){this.scroll.x=b/this.distance;this.scroll.y=c/this.distance},preRenderMapToChunks:function(){var b=this.width*this.tilesize*ig.system.scale,c=this.height*this.tilesize*ig.system.scale;this.chunkSize=Math.min(Math.max(b,c),this.chunkSize);var e=Math.ceil(b/this.chunkSize),d=Math.ceil(c/this.chunkSize);this.preRenderedChunks=[];for(var j=0;j<d;j++){this.preRenderedChunks[j]=[];for(var f=0;f<e;f++)this.preRenderedChunks[j][f]=this.preRenderChunk(f,j,f==e-1?b-f*this.chunkSize:this.chunkSize,j==d-1?
c-j*this.chunkSize:this.chunkSize)}},preRenderChunk:function(b,c,e,d){var j=e/this.tilesize/ig.system.scale+1,f=d/this.tilesize/ig.system.scale+1,n=b*this.chunkSize/ig.system.scale%this.tilesize,l=c*this.chunkSize/ig.system.scale%this.tilesize;b=Math.floor(b*this.chunkSize/this.tilesize/ig.system.scale);c=Math.floor(c*this.chunkSize/this.tilesize/ig.system.scale);var g=ig.$new("canvas");g.width=e;g.height=d;g.retinaResolutionEnabled=!1;d=g.getContext("2d");ig.System.scaleMode(g,d);e=ig.system.context;
ig.system.context=d;for(d=0;d<j;d++)for(var m=0;m<f;m++)if(d+b<this.width&&m+c<this.height){var p=this.data[m+c][d+b];p&&this.tiles.drawTile(d*this.tilesize-n,m*this.tilesize-l,p-1,this.tilesize)}ig.system.context=e;return g},draw:function(){this.tiles.loaded&&this.enabled&&(this.preRender?this.drawPreRendered():this.drawTiled())},drawPreRendered:function(){this.preRenderedChunks||this.preRenderMapToChunks();var b=ig.system.getDrawPos(this.scroll.x),c=ig.system.getDrawPos(this.scroll.y);if(this.repeat)var e=
this.width*this.tilesize*ig.system.scale,b=(b%e+e)%e,e=this.height*this.tilesize*ig.system.scale,c=(c%e+e)%e;var e=Math.max(Math.floor(b/this.chunkSize),0),d=Math.max(Math.floor(c/this.chunkSize),0),j=Math.ceil((b+ig.system.realWidth)/this.chunkSize),f=Math.ceil((c+ig.system.realHeight)/this.chunkSize),n=this.preRenderedChunks[0].length,l=this.preRenderedChunks.length;this.repeat||(j=Math.min(j,n),f=Math.min(f,l));for(var g=0;d<f;d++){for(var m=0,p=e;p<j;p++){var r=this.preRenderedChunks[d%l][p%n],
s=-b+p*this.chunkSize-m,t=-c+d*this.chunkSize-g;ig.system.context.drawImage(r,s,t);ig.Image.drawCount++;this.debugChunks&&(ig.system.context.strokeStyle="#f0f",ig.system.context.strokeRect(s,t,this.chunkSize,this.chunkSize));this.repeat&&(r.width<this.chunkSize&&s+r.width<ig.system.realWidth)&&(m+=this.chunkSize-r.width,j++)}this.repeat&&(r.height<this.chunkSize&&t+r.height<ig.system.realHeight)&&(g+=this.chunkSize-r.height,f++)}},drawTiled:function(){for(var b=0,c=null,e=(this.scroll.x/this.tilesize).toInt(),
d=(this.scroll.y/this.tilesize).toInt(),j=this.scroll.x%this.tilesize,f=this.scroll.y%this.tilesize,n=-j-this.tilesize,j=ig.system.width+this.tilesize-j,l=ig.system.height+this.tilesize-f,g=-1,f=-f-this.tilesize;f<l;g++,f+=this.tilesize){var m=g+d;if(m>=this.height||0>m){if(!this.repeat)continue;m=(m%this.height+this.height)%this.height}for(var p=-1,r=n;r<j;p++,r+=this.tilesize){b=p+e;if(b>=this.width||0>b){if(!this.repeat)continue;b=(b%this.width+this.width)%this.width}if(b=this.data[m][b])(c=this.anims[b-
1])?c.draw(r,f):this.tiles.drawTile(r,f,b-1,this.tilesize)}}}})});ig.baked=!0;
ig.module("impact.game").requires("impact.impact","impact.entity","impact.collision-map","impact.background-map").defines(function(){ig.Game=ig.Class.extend({clearColor:"#000000",gravity:0,screen:{x:0,y:0},_rscreen:{x:0,y:0},entities:[],namedEntities:{},collisionMap:ig.CollisionMap.staticNoCollision,backgroundMaps:[],backgroundAnims:{},autoSort:!1,sortBy:null,cellSize:64,_deferredKill:[],_levelToLoad:null,_doSortEntities:!1,staticInstantiate:function(){this.sortBy=this.sortBy||ig.Game.SORT.Z_INDEX;
ig.game=this;return null},loadLevel:function(b){this.screen={x:0,y:0};this.entities=[];this.namedEntities={};for(var c=0;c<b.entities.length;c++){var e=b.entities[c];this.spawnEntity(e.type,e.x,e.y,e.settings)}this.sortEntities();this.collisionMap=ig.CollisionMap.staticNoCollision;this.backgroundMaps=[];for(c=0;c<b.layer.length;c++)if(e=b.layer[c],"collision"==e.name)this.collisionMap=new ig.CollisionMap(e.tilesize,e.data);else{var d=new ig.BackgroundMap(e.tilesize,e.data,e.tilesetName);d.anims=this.backgroundAnims[e.tilesetName]||
{};d.repeat=e.repeat;d.distance=e.distance;d.foreground=!!e.foreground;d.preRender=!!e.preRender;d.name=e.name;this.backgroundMaps.push(d)}for(c=0;c<this.entities.length;c++)this.entities[c].ready()},loadLevelDeferred:function(b){this._levelToLoad=b},getMapByName:function(b){if("collision"==b)return this.collisionMap;for(var c=0;c<this.backgroundMaps.length;c++)if(this.backgroundMaps[c].name==b)return this.backgroundMaps[c];return null},getEntityByName:function(b){return this.namedEntities[b]},getEntitiesByType:function(b){b=
"string"===typeof b?ig.global[b]:b;for(var c=[],e=0;e<this.entities.length;e++){var d=this.entities[e];d instanceof b&&!d._killed&&c.push(d)}return c},spawnEntity:function(b,c,e,d){var j="string"===typeof b?ig.global[b]:b;if(!j)throw"Can't spawn entity of type "+b;b=new j(c,e,d||{});this.entities.push(b);b.name&&(this.namedEntities[b.name]=b);return b},sortEntities:function(){this.entities.sort(this.sortBy)},sortEntitiesDeferred:function(){this._doSortEntities=!0},removeEntity:function(b){b.name&&
delete this.namedEntities[b.name];b._killed=!0;b.type=ig.Entity.TYPE.NONE;b.checkAgainst=ig.Entity.TYPE.NONE;b.collides=ig.Entity.COLLIDES.NEVER;this._deferredKill.push(b)},run:function(){this.update();this.draw()},update:function(){this._levelToLoad&&(this.loadLevel(this._levelToLoad),this._levelToLoad=null);this.updateEntities();this.checkEntities();for(var b=0;b<this._deferredKill.length;b++)this._deferredKill[b].erase(),this.entities.erase(this._deferredKill[b]);this._deferredKill=[];if(this._doSortEntities||
this.autoSort)this.sortEntities(),this._doSortEntities=!1;for(var c in this.backgroundAnims){var b=this.backgroundAnims[c],e;for(e in b)b[e].update()}},updateEntities:function(){for(var b=0;b<this.entities.length;b++){var c=this.entities[b];c._killed||c.update()}},draw:function(){this.clearColor&&ig.system.clear(this.clearColor);this._rscreen.x=ig.system.getDrawPos(this.screen.x)/ig.system.scale;this._rscreen.y=ig.system.getDrawPos(this.screen.y)/ig.system.scale;var b;for(b=0;b<this.backgroundMaps.length;b++){var c=
this.backgroundMaps[b];if(c.foreground)break;c.setScreenPos(this.screen.x,this.screen.y);c.draw()}this.drawEntities();for(b;b<this.backgroundMaps.length;b++)c=this.backgroundMaps[b],c.setScreenPos(this.screen.x,this.screen.y),c.draw()},drawEntities:function(){for(var b=0;b<this.entities.length;b++)this.entities[b].draw()},checkEntities:function(){for(var b={},c=0;c<this.entities.length;c++){var e=this.entities[c];if(!(e.type==ig.Entity.TYPE.NONE&&e.checkAgainst==ig.Entity.TYPE.NONE&&e.collides==ig.Entity.COLLIDES.NEVER))for(var d=
{},j=Math.floor(e.pos.y/this.cellSize),f=Math.floor((e.pos.x+e.size.x)/this.cellSize)+1,n=Math.floor((e.pos.y+e.size.y)/this.cellSize)+1,l=Math.floor(e.pos.x/this.cellSize);l<f;l++)for(var g=j;g<n;g++)if(b[l])if(b[l][g]){for(var m=b[l][g],p=0;p<m.length;p++)e.touches(m[p])&&!d[m[p].id]&&(d[m[p].id]=!0,ig.Entity.checkPair(e,m[p]));m.push(e)}else b[l][g]=[e];else b[l]={},b[l][g]=[e]}}});ig.Game.SORT={Z_INDEX:function(b,c){return b.zIndex-c.zIndex},POS_X:function(b,c){return b.pos.x+b.size.x-(c.pos.x+
c.size.x)},POS_Y:function(b,c){return b.pos.y+b.size.y-(c.pos.y+c.size.y)}}});ig.baked=!0;
ig.module("impact.debug.menu").requires("dom.ready","impact.system").defines(function(){ig.System.inject({run:function(){ig.debug.beforeRun();this.parent();ig.debug.afterRun()},setGameNow:function(b){this.parent(b);ig.debug.ready()}});ig.Debug=ig.Class.extend({options:{},panels:{},numbers:{},container:null,panelMenu:null,activePanel:null,debugTime:0,debugTickAvg:0.016,debugRealTime:Date.now(),init:function(){var b=ig.$new("link");b.rel="stylesheet";b.type="text/css";b.href=ig.prefix+"lib/impact/debug/debug.css";
ig.$("body")[0].appendChild(b);this.container=ig.$new("div");this.container.className="ig_debug";ig.$("body")[0].appendChild(this.container);this.panelMenu=ig.$new("div");this.panelMenu.innerHTML='<div class="ig_debug_head">Impact.Debug:</div>';this.panelMenu.className="ig_debug_panel_menu";this.container.appendChild(this.panelMenu);this.numberContainer=ig.$new("div");this.numberContainer.className="ig_debug_stats";this.panelMenu.appendChild(this.numberContainer);window.console&&(window.console.log&&
window.console.assert)&&(ig.log=console.log.bind?console.log.bind(console):console.log,ig.assert=console.assert.bind?console.assert.bind(console):console.assert);ig.show=this.showNumber.bind(this)},addNumber:function(b){var c=ig.$new("span");this.numberContainer.appendChild(c);this.numberContainer.appendChild(document.createTextNode(b));this.numbers[b]=c},showNumber:function(b,c,e){this.numbers[b]||this.addNumber(b,e);this.numbers[b].textContent=c},addPanel:function(b){var c=new b.type(b.name,b.label);
if(b.options)for(var e=0;e<b.options.length;e++){var d=b.options[e];c.addOption(new ig.DebugOption(d.name,d.object,d.property))}this.panels[c.name]=c;c.container.style.display="none";this.container.appendChild(c.container);b=ig.$new("div");b.className="ig_debug_menu_item";b.textContent=c.label;b.addEventListener("click",function(){this.togglePanel(c)}.bind(this),!1);c.menuItem=b;d=!1;for(e=1;e<this.panelMenu.childNodes.length;e++){var j=this.panelMenu.childNodes[e];if(j.textContent>c.label){this.panelMenu.insertBefore(b,
j);d=!0;break}}d||this.panelMenu.appendChild(b)},showPanel:function(b){this.togglePanel(this.panels[b])},togglePanel:function(b){b!=this.activePanel&&this.activePanel&&(this.activePanel.toggle(!1),this.activePanel.menuItem.className="ig_debug_menu_item",this.activePanel=null);var c="block"!=b.container.style.display;b.toggle(c);b.menuItem.className="ig_debug_menu_item"+(c?" active":"");c&&(this.activePanel=b)},ready:function(){for(var b in this.panels)this.panels[b].ready()},beforeRun:function(){var b=
Date.now();this.debugTickAvg=0.8*this.debugTickAvg+0.2*(b-this.debugRealTime);this.debugRealTime=b;this.activePanel&&this.activePanel.beforeRun()},afterRun:function(){var b=Date.now()-this.debugRealTime;this.debugTime=0.8*this.debugTime+0.2*b;this.activePanel&&this.activePanel.afterRun();this.showNumber("ms",this.debugTime.toFixed(2));this.showNumber("fps",Math.round(1E3/this.debugTickAvg));this.showNumber("draws",ig.Image.drawCount);ig.game&&ig.game.entities&&this.showNumber("entities",ig.game.entities.length);
ig.Image.drawCount=0}});ig.DebugPanel=ig.Class.extend({active:!1,container:null,options:[],panels:[],label:"",name:"",init:function(b,c){this.name=b;this.label=c;this.container=ig.$new("div");this.container.className="ig_debug_panel "+this.name},toggle:function(b){this.active=b;this.container.style.display=b?"block":"none"},addPanel:function(b){this.panels.push(b);this.container.appendChild(b.container)},addOption:function(b){this.options.push(b);this.container.appendChild(b.container)},ready:function(){},
beforeRun:function(){},afterRun:function(){}});ig.DebugOption=ig.Class.extend({name:"",labelName:"",className:"ig_debug_option",label:null,mark:null,container:null,active:!1,colors:{enabled:"#fff",disabled:"#444"},init:function(b,c,e){this.name=b;this.object=c;this.property=e;this.active=this.object[this.property];this.container=ig.$new("div");this.container.className="ig_debug_option";this.label=ig.$new("span");this.label.className="ig_debug_label";this.label.textContent=this.name;this.mark=ig.$new("span");
this.mark.className="ig_debug_label_mark";this.container.appendChild(this.mark);this.container.appendChild(this.label);this.container.addEventListener("click",this.click.bind(this),!1);this.setLabel()},setLabel:function(){this.mark.style.backgroundColor=this.active?this.colors.enabled:this.colors.disabled},click:function(b){this.active=!this.active;this.object[this.property]=this.active;this.setLabel();b.stopPropagation();b.preventDefault();return!1}});ig.debug=new ig.Debug});ig.baked=!0;
ig.module("impact.debug.entities-panel").requires("impact.debug.menu","impact.entity").defines(function(){ig.Entity.inject({colors:{names:"#fff",velocities:"#0f0",boxes:"#f00"},pos:{x:0,y:0},draw:function(){this.parent();ig.Entity._debugShowBoxes&&(ig.system.context.strokeStyle=this.colors.boxes,ig.system.context.lineWidth=1,ig.system.context.strokeRect(ig.system.getDrawPos(this.pos.x.round()-ig.game.screen.x)-0.5,ig.system.getDrawPos(this.pos.y.round()-ig.game.screen.y)-0.5,this.size.x*ig.system.scale,
this.size.y*ig.system.scale));if(ig.Entity._debugShowVelocities){var b=this.pos.x+this.size.x/2,c=this.pos.y+this.size.y/2;this._debugDrawLine(this.colors.velocities,b,c,b+this.vel.x,c+this.vel.y)}if(ig.Entity._debugShowNames&&(this.name&&(ig.system.context.fillStyle=this.colors.names,ig.system.context.fillText(this.name,ig.system.getDrawPos(this.pos.x-ig.game.screen.x),ig.system.getDrawPos(this.pos.y-ig.game.screen.y))),"object"==typeof this.target))for(var e in this.target)(b=ig.game.getEntityByName(this.target[e]))&&
this._debugDrawLine(this.colors.names,this.pos.x+this.size.x/2,this.pos.y+this.size.y/2,b.pos.x+b.size.x/2,b.pos.y+b.size.y/2)},_debugDrawLine:function(b,c,e,d,j){ig.system.context.strokeStyle=b;ig.system.context.lineWidth=1;ig.system.context.beginPath();ig.system.context.moveTo(ig.system.getDrawPos(c-ig.game.screen.x),ig.system.getDrawPos(e-ig.game.screen.y));ig.system.context.lineTo(ig.system.getDrawPos(d-ig.game.screen.x),ig.system.getDrawPos(j-ig.game.screen.y));ig.system.context.stroke();ig.system.context.closePath()}});
ig.Entity._debugEnableChecks=!0;ig.Entity._debugShowBoxes=!1;ig.Entity._debugShowVelocities=!1;ig.Entity._debugShowNames=!1;ig.Entity.oldCheckPair=ig.Entity.checkPair;ig.Entity.checkPair=function(b,c){ig.Entity._debugEnableChecks&&ig.Entity.oldCheckPair(b,c)};ig.debug.addPanel({type:ig.DebugPanel,name:"entities",label:"Entities",options:[{name:"Checks & Collisions",object:ig.Entity,property:"_debugEnableChecks"},{name:"Show Collision Boxes",object:ig.Entity,property:"_debugShowBoxes"},{name:"Show Velocities",
object:ig.Entity,property:"_debugShowVelocities"},{name:"Show Names & Targets",object:ig.Entity,property:"_debugShowNames"}]})});ig.baked=!0;
ig.module("impact.debug.maps-panel").requires("impact.debug.menu","impact.game","impact.background-map").defines(function(){ig.Game.inject({loadLevel:function(b){this.parent(b);ig.debug.panels.maps.load(this)}});ig.DebugMapsPanel=ig.DebugPanel.extend({maps:[],mapScreens:[],init:function(b,c){this.parent(b,c);this.load()},load:function(b){this.options=[];this.panels=[];if(!b||!b.backgroundMaps.length)this.container.innerHTML="<em>No Maps Loaded</em>";else{this.maps=b.backgroundMaps;this.mapScreens=
[];this.container.innerHTML="";for(b=0;b<this.maps.length;b++){var c=this.maps[b],e=new ig.DebugPanel(b,"Layer "+b),d=new ig.$new("strong");d.textContent=b+": "+c.tiles.path;e.container.appendChild(d);e.addOption(new ig.DebugOption("Enabled",c,"enabled"));e.addOption(new ig.DebugOption("Pre Rendered",c,"preRender"));e.addOption(new ig.DebugOption("Show Chunks",c,"debugChunks"));this.generateMiniMap(e,c,b);this.addPanel(e)}}},generateMiniMap:function(b,c,e){var d=ig.system.scale,j=ig.$new("canvas"),
f=j.getContext("2d"),n=c.tiles.width*d,l=c.tiles.height*d,g=n/c.tilesize,m=l/c.tilesize;j.width=g;j.height=m;f.drawImage(c.tiles.data,0,0,n,l,0,0,g,m);f=ig.$new("canvas");f.width=c.width*d;f.height=c.height*d;m=f.getContext("2d");ig.game.clearColor&&(m.fillStyle=ig.game.clearColor,m.fillRect(0,0,n,l));for(l=n=0;l<c.width;l++)for(var p=0;p<c.height;p++)(n=c.data[p][l])&&m.drawImage(j,Math.floor((n-1)*d%g),Math.floor((n-1)*d/g)*d,d,d,l*d,p*d,d,d);j=ig.$new("div");j.className="ig_debug_map_container";
j.style.width=c.width*d+"px";j.style.height=c.height*d+"px";g=ig.$new("div");g.className="ig_debug_map_screen";g.style.width=ig.system.width/c.tilesize*d-2+"px";g.style.height=ig.system.height/c.tilesize*d-2+"px";this.mapScreens[e]=g;j.appendChild(f);j.appendChild(g);b.container.appendChild(j)},afterRun:function(){for(var b=ig.system.scale,c=0;c<this.maps.length;c++){var e=this.maps[c],d=this.mapScreens[c];if(e&&d){var j=e.scroll.x/e.tilesize,f=e.scroll.y/e.tilesize;e.repeat&&(j%=e.width,f%=e.height);
d.style.left=j*b+"px";d.style.top=f*b+"px"}}}});ig.debug.addPanel({type:ig.DebugMapsPanel,name:"maps",label:"Background Maps"})});ig.baked=!0;
ig.module("impact.debug.graph-panel").requires("impact.debug.menu","impact.system","impact.game","impact.image").defines(function(){ig.Game.inject({draw:function(){ig.graph.beginClock("draw");this.parent();ig.graph.endClock("draw")},update:function(){ig.graph.beginClock("update");this.parent();ig.graph.endClock("update")},checkEntities:function(){ig.graph.beginClock("checks");this.parent();ig.graph.endClock("checks")}});ig.DebugGraphPanel=ig.DebugPanel.extend({clocks:{},marks:[],textY:0,height:128,
ms:64,timeBeforeRun:0,init:function(b,c){this.parent(b,c);this.mark16ms=(this.height-16*(this.height/this.ms)).round();this.mark33ms=(this.height-33*(this.height/this.ms)).round();this.msHeight=this.height/this.ms;this.graph=ig.$new("canvas");this.graph.width=window.innerWidth;this.graph.height=this.height;this.container.appendChild(this.graph);this.ctx=this.graph.getContext("2d");this.ctx.fillStyle="#444";this.ctx.fillRect(0,this.mark16ms,this.graph.width,1);this.ctx.fillRect(0,this.mark33ms,this.graph.width,
1);this.addGraphMark("16ms",this.mark16ms);this.addGraphMark("33ms",this.mark33ms);this.addClock("draw","Draw","#13baff");this.addClock("update","Entity Update","#bb0fff");this.addClock("checks","Entity Checks & Collisions","#a2e908");this.addClock("lag","System Lag","#f26900");ig.mark=this.mark.bind(this);ig.graph=this},addGraphMark:function(b,c){var e=ig.$new("span");e.className="ig_debug_graph_mark";e.textContent=b;e.style.top=c.round()+"px";this.container.appendChild(e)},addClock:function(b,c,
e){var d=ig.$new("span");d.className="ig_debug_legend_color";d.style.backgroundColor=e;var j=ig.$new("span");j.className="ig_debug_legend_number";j.appendChild(document.createTextNode("0"));var f=ig.$new("span");f.className="ig_debug_legend";f.appendChild(d);f.appendChild(document.createTextNode(c+" ("));f.appendChild(j);f.appendChild(document.createTextNode("ms)"));this.container.appendChild(f);this.clocks[b]={description:c,color:e,current:0,start:Date.now(),avg:0,html:j}},beginClock:function(b,
c){this.clocks[b].start=Date.now()+(c||0)},endClock:function(b){b=this.clocks[b];b.current=Math.round(Date.now()-b.start);b.avg=0.8*b.avg+0.2*b.current},mark:function(b,c){this.active&&this.marks.push({msg:b,color:c||"#fff"})},beforeRun:function(){this.endClock("lag");this.timeBeforeRun=Date.now()},afterRun:function(){var b=Date.now()-this.timeBeforeRun;this.beginClock("lag",Math.max(1E3/ig.system.fps-b,0));var b=this.graph.width-1,c=this.height;this.ctx.drawImage(this.graph,-1,0);this.ctx.fillStyle=
"#000";this.ctx.fillRect(b,0,1,this.height);this.ctx.fillStyle="#444";this.ctx.fillRect(b,this.mark16ms,1,1);this.ctx.fillStyle="#444";this.ctx.fillRect(b,this.mark33ms,1,1);for(var e in this.clocks){var d=this.clocks[e];d.html.textContent=d.avg.toFixed(2);if(d.color&&0<d.current){this.ctx.fillStyle=d.color;var j=d.current*this.msHeight,c=c-j;this.ctx.fillRect(b,c,1,j);d.current=0}}this.ctx.textAlign="right";this.ctx.textBaseline="top";this.ctx.globalAlpha=0.5;for(e=0;e<this.marks.length;e++)c=this.marks[e],
this.ctx.fillStyle=c.color,this.ctx.fillRect(b,0,1,this.height),c.msg&&(this.ctx.fillText(c.msg,b-1,this.textY),this.textY=(this.textY+8)%32);this.ctx.globalAlpha=1;this.marks=[]}});ig.debug.addPanel({type:ig.DebugGraphPanel,name:"graph",label:"Performance"})});ig.baked=!0;ig.module("impact.debug.debug").requires("impact.debug.entities-panel","impact.debug.maps-panel","impact.debug.graph-panel").defines(function(){});ig.baked=!0;
ig.module("plugins.patches.timer-patch").requires("impact.timer").defines(function(){ig.Timer.step=function(){var b=Date.now(),c=(b-ig.Timer._last)/1E3;0>c&&(c=0);ig.Timer.time+=Math.min(c,ig.Timer.maxStep)*ig.Timer.timeScale;ig.Timer._last=b}});ig.baked=!0;
ig.module("plugins.patches.user-agent-patch").defines(function(){ig.ua.touchDevice="ontouchstart"in window||window.navigator.msMaxTouchPoints||window.navigator.maxTouchPoints;ig.ua.is_mac="MacIntel"===navigator.platform;ig.ua.iOS=ig.ua.touchDevice&&ig.ua.is_mac||ig.ua.iOS;ig.ua.mobile=ig.ua.iOS||ig.ua.mobile});ig.baked=!0;
ig.module("plugins.patches.webkit-image-smoothing-patch").defines(function(){ig.System&&(ig.System.SCALE={CRISP:function(b,c){c.imageSmoothingEnabled=c.msImageSmoothingEnabled=c.mozImageSmoothingEnabled=c.oImageSmoothingEnabled=!1;b.style.imageRendering="-moz-crisp-edges";b.style.imageRendering="-o-crisp-edges";b.style.imageRendering="-webkit-optimize-contrast";b.style.imageRendering="crisp-edges";b.style.msInterpolationMode="nearest-neighbor"},SMOOTH:function(b,c){c.imageSmoothingEnabled=c.msImageSmoothingEnabled=
c.mozImageSmoothingEnabled=c.oImageSmoothingEnabled=!0;b.style.imageRendering="";b.style.msInterpolationMode=""}},ig.System.scaleMode=ig.System.SCALE.SMOOTH)});ig.baked=!0;
ig.module("plugins.patches.windowfocus-onMouseDown-patch").requires("impact.input").defines(function(){var b=!1;try{b=window.self!==window.top,!1===b&&(b=0<window.frames.length)}catch(c){b=!0}ig.Input.inject({keydown:function(c){var d=c.target.tagName;if(!("INPUT"==d||"TEXTAREA"==d))if(d="keydown"==c.type?c.keyCode:2==c.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1,b&&0>d&&window.focus(),("touchstart"==c.type||"mousedown"==c.type)&&this.mousemove(c),d=this.bindings[d])this.actions[d]=!0,this.locks[d]||(this.presses[d]=
!0,this.locks[d]=!0),c.stopPropagation(),c.preventDefault()}})});ig.baked=!0;
ig.module("plugins.patches.input-patch").requires("impact.input").defines(function(){ig.Input.inject({move:new BABYLON.Vector2(0,0),initMouse:function(){if(!this.isUsingMouse){this.isUsingMouse=!0;var b=this.mousewheel.bind(this);ig.system.canvas.addEventListener("mousewheel",b,!1);ig.system.canvas.addEventListener("DOMMouseScroll",b,!1);ig.system.canvas.addEventListener("contextmenu",this.contextmenu.bind(this),!1);ig.system.canvas.addEventListener("mousedown",this.keydown.bind(this),!1);ig.system.canvas.addEventListener("mouseup",
this.keyup.bind(this),!1);ig.system.canvas.addEventListener("mousemove",this.mousemove.bind(this),!1);ig.ua.touchDevice&&(ig.system.canvas.addEventListener("touchstart",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.mousemove.bind(this),!1),ig.system.canvas.addEventListener("MSPointerDown",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("MSPointerUp",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",
this.mousemove.bind(this),!1),ig.system.canvas.style.msTouchAction="none")}},mousemove:function(b){var c=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth;ig.ua.mobile&&(c=ig.system.realWidth);var c=ig.system.scale*(c/ig.system.realWidth),e={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());var d=b.touches?b.touches[0]:b;this.mouse.x=(d.clientX-e.left)/c;this.mouse.y=(d.clientY-e.top)/c;void 0!==typeof b.movementX?(this.move.x=b.movementX,
this.move.y=b.movementY):(this.move.x=0,this.move.y=0);try{ig.soundHandler.unlockWebAudio()}catch(j){}},keyup:function(b){var c=b.target.tagName;if(!("INPUT"==c||"TEXTAREA"==c)){if(c=this.bindings["keyup"==b.type?b.keyCode:2==b.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1])this.delayedKeyup[c]=!0,b.stopPropagation(),b.preventDefault();if(ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(e){}}}})});ig.baked=!0;
ig.module("plugins.data.vector").defines(function(){Vector2=ig.Class.extend({x:null,y:null,valType:"number",init:function(b,c){typeof b===this.valType&&typeof c===this.valType&&(this.x=b,this.y=c)},row:function(b){typeof b===this.valType&&(this.y=b);return this.y},col:function(b){typeof b===this.valType&&(this.x=b);return this.x},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},unitVector:function(){var b=this.magnitude();if(0<b)return new Vector2(this.x/b,this.y/b);throw"Divide by 0 error in unitVector function of vector:"+
this;},add:function(b){return new Vector2(this.x+b.x,this.y+b.y)},subtract:function(b){return new Vector2(this.x-b.x,this.y-b.y)},dotProduct:function(b){return this.x*b.x+this.y*b.y},multiplyByScalar:function(b){return new Vector2(b*this.x,b*this.y)}})});ig.baked=!0;
ig.module("plugins.data.color-rgb").defines(function(){ColorRGB=function(b,c,e,d){this.r=b||0;this.g=c||0;this.b=e||0;this.a=d||0};ColorRGB.prototype={setRandomColor:function(){this.r=Math.round(255*Math.random());this.g=Math.round(255*Math.random());this.b=Math.round(255*Math.random())},getStyle:function(){return"rgba("+this.r+","+this.g+","+this.b+","+this.a+")"},getHex:function(){for(var b=this.r.toString(16),c=this.g.toString(16),e=this.b.toString(16);2>b.length;)b="0"+b;for(;2>c.length;)c="0"+
c;for(;2>e.length;)e="0"+e;return"#"+b+c+e},getInvertedColor:function(){return new ColorRGB(255-this.r,255-this.g,255-this.b,255-this.a)},clone:function(){return new ColorRGB(this.r,this.g,this.b,this.a)}}});ig.baked=!0;
ig.module("plugins.font.font-info").requires("impact.impact").defines(function(){ig.FontInfo=ig.Class.extend({fonts:[{name:"mainfont",source:"media/fonts/mainfont"}],init:function(){this.registerCssFont()},getKeys:function(){for(var b={},c=0;c<this.fonts.length;c++){for(var e=this.fonts[c].name,d=e.split("-"),j="",f=0;f<d.length;f++)j+=d[f];b[j]=e}return b},registerCssFont:function(){if(0<this.fonts.length){var b=document.createElement("style");b.type="text/css";for(var c="",e=0;e<this.fonts.length;e++)var d=
this.fonts[e],c=c+("@font-face {font-family: '"+d.name+"';src: url('"+d.source+".eot');src: url('"+d.source+".eot?#iefix') format('embedded-opentype'),url('"+d.source+".woff2') format('woff2'),url('"+d.source+".woff') format('woff'),url('"+d.source+".ttf') format('truetype'),url('"+d.source+".svg#svgFontName') format('svg')}");b.appendChild(document.createTextNode(c));document.head.appendChild(b)}},isValid:function(){for(var b=0;b<this.fonts.length;b++)if(!this._isValidName(this.fonts[b].source))return!1;
return!0},_isValidName:function(b){return-1==b.search(/^[a-z0-9-\/]+$/)?!1:!0}})});ig.baked=!0;
ig.module("plugins.font.font-loader").requires("impact.impact","plugins.font.font-info","impact.loader").defines(function(){ig.FontLoader=ig.Class.extend({fontInfo:new ig.FontInfo,onload:!1,onerror:!1,init:function(b,c){this.onload=b;this.onerror=c},load:function(){this.fontInfo.isValid()?this._loadByLib():console.error("Only lowercased alphanumeric and dash are allowed for font file name!. Please check the font path")},_loadByLib:function(){for(var b=[],c=0;c<this.fontInfo.fonts.length;c++){var e=
new FontFaceObserver(this.fontInfo.fonts[c].name);b.push(e.load())}Promise.all(b).then(this.onload).catch(this.onerror)}});ig.Loader.inject({parentLoad:!1,load:function(){this.parentLoad=this.parent;this.fontLoader=(new ig.FontLoader(this.onFontLoad.bind(this),this.onFontError.bind(this))).load()},onFontLoad:function(){this.parentLoad()},onFontError:function(){console.error("Font is not loaded")}})});ig.baked=!0;
ig.module("plugins.handlers.dom-handler").defines(function(){ig.DomHandler=ig.Class.extend({JQUERYAVAILABLE:!1,init:function(){this.JQUERYAVAILABLE=this._jqueryAvailable()},_jqueryAvailable:function(){return"undefined"!==typeof jQuery},addEvent:function(b,c,e,d){if(this.JQUERYAVAILABLE)b.on(c,e);else b.addEventListener(c,e,d)},create:function(b){return this.JQUERYAVAILABLE?$("<"+b+">"):ig.$new(b)},getElementByClass:function(b){return this.JQUERYAVAILABLE?$("."+b):document.getElementsByClassName(b)},
getElementById:function(b){return this.JQUERYAVAILABLE?0<$(b).length?$(b):null:ig.$(b)},appendChild:function(b,c){this.JQUERYAVAILABLE?b.append(c):b.appendChild(c)},appendToBody:function(b){this.JQUERYAVAILABLE?$("body").append(b):document.body.appendChild(b)},resize:function(b,c,e){if(this.JQUERYAVAILABLE)b.width(c.toFixed(2)),b.height(e.toFixed(2));else{var d=b.style.visibility;c="width:"+c.toFixed(2)+"px; height:"+e.toFixed(2)+"px;";this.attr(b,"style",c);b.style.visibility=d}},resizeOffsetLeft:function(b,
c,e,d){if(this.JQUERYAVAILABLE)b.width(c.toFixed(2)),b.height(e.toFixed(2)),b.css("left",d);else{var j=b.style.visibility;c="width:"+c.toFixed(2)+"px; height:"+e.toFixed(2)+"px; left: "+d.toFixed(2)+"px;";this.attr(b,"style",c);b.style.visibility=j}},resizeOffset:function(b,c,e,d,j){if(this.JQUERYAVAILABLE)b.width(c.toFixed(2)),b.height(e.toFixed(2)),b.css("left",d),b.css("top",j);else{var f=b.style.visibility;c="width:"+c.toFixed(2)+"px; height:"+e.toFixed(2)+"px; left: "+d.toFixed(2)+"px; top: "+
j.toFixed(2)+"px;";this.attr(b,"style",c);b.style.visibility=f}},css:function(b,c){if(this.JQUERYAVAILABLE)b.css(c);else{var e="",d;for(d in c)e+=d+":"+c[d]+";";this.attr(b,"style",e)}},getOffsets:function(b){return this.JQUERYAVAILABLE?(b=b.offset(),{left:b.left,top:b.top}):{left:b.offsetLeft,top:b.offsetTop}},attr:function(b,c,e){if("undefined"===typeof e)return this.JQUERYAVAILABLE?b.attr(c):b.getAttribute(c);this.JQUERYAVAILABLE?b.attr(c,e):b.setAttribute(c,e)},show:function(b){this.JQUERYAVAILABLE?
(b.show(),b.css("visibility","visible")):b&&(b.style?b.style.visibility="visible":b[0]&&(b[0].style.visibility="visible"))},hide:function(b){this.JQUERYAVAILABLE?(b.hide(),b.css("visibility","hidden")):b&&(b.style?b.style.visibility="hidden":b[0]&&(b[0].style.visibility="hidden"))},getQueryVariable:function(b){for(var c=window.location.search.substring(1).split("&"),e=0;e<c.length;e++){var d=c[e].match(/([^=]+?)=(.+)/);if(d&&decodeURIComponent(d[1])==b)return decodeURIComponent(d[2])}},forcedDeviceDetection:function(){var b=
this.getQueryVariable("device");if(b)switch(b){case "mobile":console.log("serving mobile version ...");ig.ua.mobile=!0;break;case "desktop":console.log("serving desktop version ...");ig.ua.mobile=!1;break;default:console.log("serving universal version ...")}else console.log("serving universal version ...")},forcedDeviceRotation:function(){var b=this.getQueryVariable("force-rotate");if(b)switch(b){case "portrait":console.log("force rotate to portrait");window.orientation=0;break;case "landscape":console.log("force rotate to horizontal");
window.orientation=90;break;default:alert("wrong command/type in param force-rotate. Defaulting value to portrait"),window.orientation=0}},setZIndex:function(b,c){this.JQUERYAVAILABLE?b.css("zIndex",c):b&&(b.style?b.style.zIndex=c:b[0]&&(b[0].style.zIndex=c))}})});ig.baked=!0;
ig.module("plugins.handlers.size-handler").defines(function(){ig.SizeHandler=ig.Class.extend({portraitMode:!0,disableStretchToFitOnMobileFlag:!1,enableStretchToFitOnAntiPortraitModeFlag:!0,enableScalingLimitsOnMobileFlag:!1,minScalingOnMobile:0,maxScalingOnMobile:1,enableStretchToFitOnDesktopFlag:!1,enableScalingLimitsOnDesktopFlag:!1,minScalingOnDesktop:0,maxScalingOnDesktop:1,desktop:{actualSize:new BABYLON.Vector2(window.innerWidth,window.innerHeight),actualResolution:new BABYLON.Vector2(540,960)},
mobile:{actualSize:new BABYLON.Vector2(window.innerWidth,window.innerHeight),actualResolution:new BABYLON.Vector2(540,960)},windowSize:new BABYLON.Vector2(window.innerWidth,window.innerHeight),scaleRatioMultiplier:new BABYLON.Vector2(1,1),sizeRatio:new BABYLON.Vector2(1,1),scale:1,domHandler:null,dynamicClickableEntityDivs:{},coreDivsToResize:["#webglcanvas","#canvas","#play","#orientate"],adsToResize:{MobileAdInGamePreroll:{"box-width":_SETTINGS.Ad.Mobile.Preroll.Width+2,"box-height":_SETTINGS.Ad.Mobile.Preroll.Height+
20},MobileAdInGameEnd:{"box-width":_SETTINGS.Ad.Mobile.End.Width+2,"box-height":_SETTINGS.Ad.Mobile.End.Height+20},MobileAdInGamePreroll2:{"box-width":_SETTINGS.Ad.Mobile.Preroll.Width+2,"box-height":_SETTINGS.Ad.Mobile.Preroll.Height+20},MobileAdInGameEnd2:{"box-width":_SETTINGS.Ad.Mobile.End.Width+2,"box-height":_SETTINGS.Ad.Mobile.End.Height+20},MobileAdInGamePreroll3:{"box-width":_SETTINGS.Ad.Mobile.Preroll.Width+2,"box-height":_SETTINGS.Ad.Mobile.Preroll.Height+20},MobileAdInGameEnd3:{"box-width":_SETTINGS.Ad.Mobile.End.Width+
2,"box-height":_SETTINGS.Ad.Mobile.End.Height+20}},init:function(b){this.domHandler=b;if("undefined"===typeof b)throw"undefined Dom Handler for Size Handler";this.sizeCalcs();this.eventListenerSetup();this.samsungFix()},sizeCalcs:function(){this.windowSize=new Vector2(window.innerWidth,window.innerHeight);if(ig.ua.mobile){this.mobile.actualSize=new Vector2(window.innerWidth,window.innerHeight);var b=new Vector2(this.mobile.actualResolution.x,this.mobile.actualResolution.y);this.scaleRatioMultiplier=
new Vector2(this.mobile.actualSize.x/b.x,this.mobile.actualSize.y/b.y);if(this.disableStretchToFitOnMobileFlag){var c=Math.min(this.scaleRatioMultiplier.x,this.scaleRatioMultiplier.y);this.enableScalingLimitsOnMobileFlag&&(c=c.limit(this.minScalingOnMobile,this.maxScalingOnMobile));this.mobile.actualSize.x=b.x*c;this.mobile.actualSize.y=b.y*c;this.scaleRatioMultiplier.x=c;this.scaleRatioMultiplier.y=c}else this.sizeRatio.x=this.scaleRatioMultiplier.x,this.sizeRatio.y=this.scaleRatioMultiplier.y,this.scaleRatioMultiplier.x=
1,this.scaleRatioMultiplier.y=1}else this.desktop.actualSize=new Vector2(window.innerWidth,window.innerHeight),b=new Vector2(this.desktop.actualResolution.x,this.desktop.actualResolution.y),this.scaleRatioMultiplier=new Vector2(this.desktop.actualSize.x/b.x,this.desktop.actualSize.y/b.y),this.enableStretchToFitOnDesktopFlag?(this.sizeRatio.x=this.scaleRatioMultiplier.x,this.sizeRatio.y=this.scaleRatioMultiplier.y,this.scaleRatioMultiplier.x=1,this.scaleRatioMultiplier.y=1):(c=Math.min(this.scaleRatioMultiplier.x,
this.scaleRatioMultiplier.y),this.enableScalingLimitsOnDesktopFlag&&(c=c.limit(this.minScalingOnDesktop,this.maxScalingOnDesktop)),this.desktop.actualSize.x=b.x*c,this.desktop.actualSize.y=b.y*c,this.scaleRatioMultiplier.x=c,this.scaleRatioMultiplier.y=c)},resizeLayers:function(){for(var b=0;b<this.coreDivsToResize.length;b++){var c=ig.domHandler.getElementById(this.coreDivsToResize[b]);if(ig.ua.mobile)if(this.disableStretchToFitOnMobileFlag){var e=Math.floor(ig.sizeHandler.windowSize.x/2-ig.sizeHandler.mobile.actualSize.x/
2),d=Math.floor(ig.sizeHandler.windowSize.y/2-ig.sizeHandler.mobile.actualSize.y/2);0>e&&(e=0);0>d&&(d=0);ig.domHandler.resizeOffset(c,Math.floor(ig.sizeHandler.mobile.actualSize.x),Math.floor(ig.sizeHandler.mobile.actualSize.y),e,d);var j=!1;if(j=this.portraitMode?window.innerHeight<window.innerWidth:window.innerHeight>window.innerWidth)if(this.enableStretchToFitOnAntiPortraitModeFlag)ig.domHandler.resizeOffset(c,Math.floor(window.innerWidth),Math.floor(window.innerHeight),0,0);else{var j=new Vector2(window.innerWidth/
this.mobile.actualResolution.y,window.innerHeight/this.mobile.actualResolution.x),e=Math.min(j.x,j.y),j=this.mobile.actualResolution.y*e,f=this.mobile.actualResolution.x*e,e=Math.floor(ig.sizeHandler.windowSize.x/2-j/2),d=Math.floor(ig.sizeHandler.windowSize.y/2-f/2);0>e&&(e=0);0>d&&(d=0);ig.domHandler.resizeOffset(c,Math.floor(j),Math.floor(f),e,d)}}else ig.domHandler.resize(c,Math.floor(ig.sizeHandler.mobile.actualSize.x),Math.floor(ig.sizeHandler.mobile.actualSize.y));else this.enableStretchToFitOnDesktopFlag?
ig.domHandler.resize(c,Math.floor(ig.sizeHandler.desktop.actualSize.x),Math.floor(ig.sizeHandler.desktop.actualSize.y)):(e=Math.floor(ig.sizeHandler.windowSize.x/2-ig.sizeHandler.desktop.actualSize.x/2),d=Math.floor(ig.sizeHandler.windowSize.y/2-ig.sizeHandler.desktop.actualSize.y/2),0>e&&(e=0),0>d&&(d=0),ig.domHandler.resizeOffset(c,Math.floor(ig.sizeHandler.desktop.actualSize.x),Math.floor(ig.sizeHandler.desktop.actualSize.y),e,d))}for(var n in this.adsToResize)b=ig.domHandler.getElementById("#"+
n),c=ig.domHandler.getElementById("#"+n+"-Box"),j=(window.innerWidth-this.adsToResize[n]["box-width"])/2+"px",e=(window.innerHeight-this.adsToResize[n]["box-height"])/2+"px",b&&ig.domHandler.css(b,{width:window.innerWidth,height:window.innerHeight}),c&&ig.domHandler.css(c,{left:j,top:e});b=ig.domHandler.getElementById("#canvas");c=ig.domHandler.getOffsets(b);b=c.left;c=c.top;j=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);for(n in this.dynamicClickableEntityDivs){e=
ig.domHandler.getElementById("#"+n);if(ig.ua.mobile){var f=this.dynamicClickableEntityDivs[n].entity_pos_x,l=this.dynamicClickableEntityDivs[n].entity_pos_y,g=this.dynamicClickableEntityDivs[n].width,d=this.dynamicClickableEntityDivs[n].height;this.disableStretchToFitOnMobileFlag?(f=Math.floor(b+f*this.scaleRatioMultiplier.x)+"px",l=Math.floor(c+l*this.scaleRatioMultiplier.y)+"px",g=Math.floor(g*this.scaleRatioMultiplier.x)+"px",d=Math.floor(d*this.scaleRatioMultiplier.y)+"px"):(f=Math.floor(f*this.sizeRatio.x)+
"px",l=Math.floor(l*this.sizeRatio.y)+"px",g=Math.floor(g*this.sizeRatio.x)+"px",d=Math.floor(d*this.sizeRatio.y)+"px")}else f=this.dynamicClickableEntityDivs[n].entity_pos_x,l=this.dynamicClickableEntityDivs[n].entity_pos_y,g=this.dynamicClickableEntityDivs[n].width,d=this.dynamicClickableEntityDivs[n].height,this.enableStretchToFitOnDesktopFlag?(f=Math.floor(f*this.sizeRatio.x)+"px",l=Math.floor(l*this.sizeRatio.y)+"px",g=Math.floor(g*this.sizeRatio.x)+"px",d=Math.floor(d*this.sizeRatio.y)+"px"):
(f=Math.floor(b+f*this.scaleRatioMultiplier.x)+"px",l=Math.floor(c+l*this.scaleRatioMultiplier.y)+"px",g=Math.floor(g*this.scaleRatioMultiplier.x)+"px",d=Math.floor(d*this.scaleRatioMultiplier.y)+"px");ig.domHandler.css(e,{"float":"left",position:"absolute",left:f,top:l,width:g,height:d,"z-index":3});this.dynamicClickableEntityDivs[n]["font-size"]&&ig.domHandler.css(e,{"font-size":this.dynamicClickableEntityDivs[n]["font-size"]*j+"px"})}$("#ajaxbar").width(this.windowSize.x);$("#ajaxbar").height(this.windowSize.y)},
resize:function(){this.sizeCalcs();this.resizeLayers()},reorient:function(){console.log("changing orientation ...");if(ig.ua.mobile){var b=!1,b=this.portraitMode?window.innerHeight<window.innerWidth:window.innerHeight>window.innerWidth,c=this.domHandler.getElementById("#orientate"),e=this.domHandler.getElementById("#game");b?(this.domHandler.show(c),this.domHandler.hide(e),console.log("portrait"+window.innerWidth+","+window.innerHeight)):(this.domHandler.show(e),this.domHandler.hide(c),console.log("landscape"+
window.innerWidth+","+window.innerHeight))}ig.ua.mobile?(this.resize(),this.resizeAds()):this.resize()},resizeAds:function(){for(var b in this.adsToResize){var c=ig.domHandler.getElementById("#"+b),e=ig.domHandler.getElementById("#"+b+"-Box"),d=(window.innerWidth-this.adsToResize[b]["box-width"]>>1)+"px",j=(window.innerHeight-this.adsToResize[b]["box-height"]>>1)+"px";c&&ig.domHandler.css(c,{width:window.innerWidth,height:window.innerHeight});e&&ig.domHandler.css(e,{left:d,top:j})}},samsungFix:function(){ig.ua.android&&
(!(4.2>parseFloat(navigator.userAgent.slice(navigator.userAgent.indexOf("Android")+8,navigator.userAgent.indexOf("Android")+11)))&&!(0>navigator.userAgent.indexOf("GT"))&&!(0<navigator.userAgent.indexOf("Chrome"))&&!(0<navigator.userAgent.indexOf("Firefox")))&&(document.addEventListener("touchstart",function(b){b.preventDefault();return!1},!1),document.addEventListener("touchmove",function(b){b.preventDefault();return!1},!1),document.addEventListener("touchend",function(b){b.preventDefault();return!1},
!1))},orientationInterval:null,orientationTimeout:null,orientationHandler:function(){this.reorient();window.scrollTo(0,1)},orientationDelayHandler:function(){null==this.orientationInterval&&(this.orientationInterval=window.setInterval(this.orientationHandler.bind(this),100));null==this.orientationTimeout&&(this.orientationTimeout=window.setTimeout(function(){this.clearAllIntervals()}.bind(this),2E3))},clearAllIntervals:function(){window.clearInterval(this.orientationInterval);this.orientationInterval=
null;window.clearTimeout(this.orientationTimeout);this.orientationTimeout=null},eventListenerSetup:function(){ig.isXiaomiBrowser=/XiaoMi/i.test(navigator.userAgent)||/MiuiBrowser/i.test(navigator.userAgent)||/Mint/i.test(navigator.userAgent);ig.ua.iOS||ig.isXiaomiBrowser?(window.addEventListener("orientationchange",this.orientationDelayHandler.bind(this)),window.addEventListener("resize",this.orientationDelayHandler.bind(this))):(window.addEventListener("orientationchange",this.orientationHandler.bind(this)),
window.addEventListener("resize",this.orientationHandler.bind(this)));document.ontouchmove=function(){window.scrollTo(0,1)};this.chromePullDownRefreshFix()},chromePullDownRefreshFix:function(){var b=window.chrome||navigator.userAgent.match("CriOS"),c="ontouchstart"in document.documentElement;if(b&&c){var e=b=!1,d=0,j=!1;try{CSS.supports("overscroll-behavior-y","contain")&&(b=!0)}catch(f){}try{if(b)return document.body.style.overscrollBehaviorY="contain"}catch(n){}b=document.head||document.body;c=
document.createElement("style");c.type="text/css";c.styleSheet?c.styleSheet.cssText="\n      ::-webkit-scrollbar {\n        width: 500x;\n      }\n      ::-webkit-scrollbar-thumb {\n        border-radius: 500px;\n        background-color: rgba(0, 0, 0, 0.2);\n      }\n      body {\n        -webkit-overflow-scrolling: auto!important;\n      }\n    ":c.appendChild(document.createTextNode("\n      ::-webkit-scrollbar {\n        width: 500px;\n      }\n      ::-webkit-scrollbar-thumb {\n        border-radius: 500px;\n        background-color: rgba(0, 0, 0, 0.2);\n      }\n      body {\n        -webkit-overflow-scrolling: auto!important;\n      }\n    "));
b.appendChild(c);try{addEventListener("test",null,{get passive(){e=!0}})}catch(l){}document.addEventListener("touchstart",function(b){1===b.touches.length&&(d=b.touches[0].clientY,j=0===window.pageYOffset)},!!e&&{passive:!0});document.addEventListener("touchmove",function(b){var c;if(c=j){j=!1;c=b.touches[0].clientY;var e=c-d;c=(d=c,0<e)}if(c)return b.preventDefault()},!!e&&{passive:!1})}}})});ig.baked=!0;
ig.module("plugins.handlers.api-handler").defines(function(){ig.ApiHandler=ig.Class.extend({apiAvailable:{MJSPreroll:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS&&_SETTINGS.Ad.Mobile.Preroll.Enabled&&MobileAdInGamePreroll.Initialize()},MJSHeader:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS.Ad.Mobile.Header.Enabled&&MobileAdInGameHeader.Initialize()},MJSFooter:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS.Ad.Mobile.Footer.Enabled&&MobileAdInGameFooter.Initialize()},
MJSEnd:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS.Ad.Mobile.End.Enabled&&MobileAdInGameEnd.Initialize()}},run:function(b,c){if(this.apiAvailable[b])this.apiAvailable[b](c)}})});ig.baked=!0;
ig.module("plugins.audio.sound-player").defines(function(){SoundPlayer=ig.Class.extend({tagName:"SoundPlayer",stayMuteFlag:!1,debug:!1,init:function(){this.debug&&console.log(this.tagName)},play:function(b){this.debug&&console.log("play sound ",b)},stop:function(){this.debug&&console.log("stop sound ")},volume:function(){this.debug&&console.log("set volume")},mute:function(b){this.debug&&console.log("mute");"undefined"===typeof b?this.stayMuteFlag=!0:b&&(this.stayMuteFlag=!0)},unmute:function(b){this.debug&&
console.log("unmute");"undefined"===typeof b?this.stayMuteFlag=!1:b&&(this.stayMuteFlag=!1)}})});ig.baked=!0;
ig.module("plugins.audio.impact-music-player").requires("plugins.audio.sound-player").defines(function(){ImpactMusicPlayer=SoundPlayer.extend({tagName:"ImpactMusicPlayer",bgmPlaying:!1,soundList:{},init:function(b,c){this.parent(b,c);for(var e in b)this.soundList[e]=e,ig.music.add(b[e].path+".*",e);c&&c.loop&&(ig.music.loop=c.loop)},play:function(b){this.stayMuteFlag||(this.bgmPlaying=!0,"undefined"===typeof b?ig.music.play(b):ig.music.play())},stop:function(){this.bgmPlaying=!1;ig.music.pause()},
volume:function(b){console.log("impactmusic:",b);ig.music.volume=0>b?0:isNaN(b)?1:1<b?1:b},getVolume:function(){return ig.music.volume},mute:function(b){this.parent(b);this.bgmPlaying&&this.stop()},unmute:function(b){this.parent(b);this.play()}})});ig.baked=!0;
ig.module("plugins.audio.impact-sound-player").requires("plugins.audio.sound-player").defines(function(){ImpactSoundPlayer=SoundPlayer.extend({tagName:"ImpactSoundPlayer",soundList:{},init:function(b,c){this.parent(b,c);for(var e in b){var d=new ig.Sound(b[e].path+".*");this.soundList[e]=d}},play:function(b){this.stayMuteFlag||("object"===typeof b?(console.log(b+" exists"),b.play()):"string"===typeof b&&this.soundList[b].play())},stop:function(b){this.parent(b);b.stop()},volume:function(b){ig.soundManager.volume=
0>b?0:isNaN(b)?1:1<b?1:b},getVolume:function(){return ig.soundManager.volume},mute:function(b){this.parent(b);ig.Sound.enabled=!1},unmute:function(b){this.parent(b);ig.Sound.enabled=!0}})});ig.baked=!0;
ig.module("plugins.audio.howler-player").requires("plugins.audio.sound-player").defines(function(){HowlerPlayer=SoundPlayer.extend({tagName:"HowlerPlayer",soundList:{},init:function(b,c){this.parent(b,c);for(var e in b){var d=b[e].path,d=new Howl({src:[d+"."+ig.Sound.FORMAT.OGG.ext,d+"."+ig.Sound.FORMAT.MP3.ext]});this.soundList[e]=d}},play:function(b){if(Howler.ctx&&"running"!==Howler.ctx.state)return Howler.ctx.resume();this.stayMuteFlag||("object"===typeof b?b.play():"string"===typeof b&&this.soundList[b].play())},
stop:function(b){this.parent(b);"object"===typeof b?b.stop():"string"===typeof b&&this.soundList[b].stop()},volume:function(b){for(var c in this.soundList){if(0>b){this.soundList[c].volume(0);break}isNaN(b)?this.soundList[c].volume(1):1<b?this.soundList[c].volume(1):this.soundList[c].volume(b)}},getVolume:function(){for(var b in this.soundList)return this.soundList[b].volume()},mute:function(b){this.parent(b);Howler.mute(!0)},unmute:function(b){this.parent(b);Howler.mute(!1)}})});ig.baked=!0;
ig.module("plugins.audio.howler-music-player").requires("plugins.audio.sound-player").defines(function(){HowlerMusicPlayer=SoundPlayer.extend({tagName:"HowlerMusicPlayer",bgmPlaying:!1,soundList:{},init:function(b,c){this.parent(b,c);for(var e in b){var d=b[e].path,d=new Howl({src:[d+"."+ig.Sound.FORMAT.OGG.ext,d+"."+ig.Sound.FORMAT.MP3.ext],loop:!0,autoplay:!1,onend:function(){}.bind(this)});this.soundList[e]=d}},play:function(b){if(!this.stayMuteFlag&&!this.bgmPlaying)if("object"===typeof b)this.bgmPlaying=
!0,b.play();else if("string"===typeof b)this.bgmPlaying=!0,this.soundList[b].play();else for(var c in this.soundList){this.soundList[c].play();this.bgmPlaying=!0;break}},stop:function(b){this.parent(b);if(this.bgmPlaying){for(var c in this.soundList)this.soundList[c].stop();this.bgmPlaying=!1}},volume:function(b){for(var c in this.soundList){if(0>b){this.soundList[c].volume(0);break}isNaN(b)?this.soundList[c].volume(1):1<b?this.soundList[c].volume(1):this.soundList[c].volume(b)}},getVolume:function(){for(var b in this.soundList)return this.soundList[b].volume()},
mute:function(b){this.parent(b);Howler.mute(!0)},unmute:function(b){this.parent(b);Howler.mute(!1)}})});ig.baked=!0;
ig.module("plugins.audio.jukebox-player").requires("plugins.audio.sound-player").defines(function(){JukeboxPlayer=SoundPlayer.extend({tagName:"JukeboxPlayer",bgmPlaying:!1,soundList:{},jukeboxPlayer:null,pausePosition:0,premuteVolume:0,minVolume:0.001,init:function(b,c){this.parent(b,c);for(var e in b){this.soundList[e]=e;var d=b[e].path;this.jukeboxPlayer=new jukebox.Player({resources:[d+"."+ig.Sound.FORMAT.OGG.ext,d+"."+ig.Sound.FORMAT.MP3.ext],autoplay:!1,spritemap:{music:{start:b[e].startMp3,
end:b[e].endMp3,loop:!0}}})}},play:function(){this.stayMuteFlag||(this.bgmPlaying=!0,this.pausePosition?(console.log("resume"),this.jukeboxPlayer.resume(this.pausePosition)):(console.log("play"),this.jukeboxPlayer.play(this.jukeboxPlayer.settings.spritemap.music.start,!0)),this.premuteVolume=this.getVolume())},stop:function(){this.bgmPlaying=!1;this.pausePosition=this.jukeboxPlayer.pause()},volume:function(b){console.log("jukebox:",b);0>=b?this.jukeboxPlayer.setVolume(this.minVolume):isNaN(b)?this.jukeboxPlayer.setVolume(1):
1<b?this.jukeboxPlayer.setVolume(1):this.jukeboxPlayer.setVolume(b)},getVolume:function(){return this.jukeboxPlayer.getVolume()},mute:function(b){this.parent(b);this.bgmPlaying&&(console.log("jukebox",this.premuteVolume),this.stayMuteFlag||(this.premuteVolume=this.getVolume()),this.jukeboxPlayer.pause(),this.jukeboxPlayer.setVolume(this.minVolume))},unmute:function(b){this.parent(b);this.stayMuteFlag||(console.log("jukebox",this.premuteVolume),this.jukeboxPlayer.setVolume(this.premuteVolume),this.jukeboxPlayer.resume())}})});
ig.baked=!0;
ig.module("plugins.audio.webaudio-music-player").requires("plugins.audio.sound-player").defines(function(){WebaudioMusicPlayer=SoundPlayer.extend({tagName:"WebaudioMusicPlayer",bgmPlaying:!1,isSupported:!1,muteFlag:!1,pausedTime:0,webaudio:null,useHTML5Audio:!1,audio:null,inactiveAudio:null,codecs:null,reinitOnPlay:!1,inputList:null,_volume:1,soundList:{},init:function(b){this.webaudio={compatibility:{},gainNode:null,buffer:null,source_loop:{},source_once:{}};try{Howler&&Howler.ctx?this.webaudio.context=Howler.ctx:
ig&&ig.webaudio_ctx?this.webaudio.context=ig.webaudio_ctx:(this.AudioContext=window.AudioContext||window.webkitAudioContext,this.webaudio.context=new this.AudioContext,ig.webaudio_ctx=this.webaudio.context),this.isSupported=!0}catch(c){console.log("Web Audio API not supported in this browser."),this.webaudio=null,this.useHTML5Audio=!0}if(this.useHTML5Audio)if("undefined"!==typeof Audio)try{new Audio}catch(e){this.useHTML5Audio=!1}else this.useHTML5Audio=!1;this.useHTML5Audio&&(this.audio=new Audio,
this.isSupported=!0,this.initHTML5Audio(b));if(!this.isSupported)return null;this.webaudio&&(this.inputList=b,this.initWebAudio(b))},initWebAudio:function(b){ig.ua.iOS&&this.initIOSWebAudioUnlock();this.webaudio.gainNode=this.webaudio.context.createGain();this.webaudio.gainNode.connect(this.webaudio.context.destination);this.webaudio.gainNode.gain.value=this._volume;this.webaudio.buffer=null;var c="start",e="stop",d=this.webaudio.context.createBufferSource();"function"!==typeof d.start&&(c="noteOn");
this.webaudio.compatibility.start=c;"function"!==typeof d.stop&&(e="noteOff");this.webaudio.compatibility.stop=e;for(var j in b){this.soundList[j]=j;var e=b[j].path,c=e+"."+ig.Sound.FORMAT.MP3.ext,f=e+"."+ig.Sound.FORMAT.OGG.ext;ig.ua.mobile?ig.ua.iOS&&(f=c):(e=navigator.userAgent.toLowerCase(),-1!=e.indexOf("safari")&&-1>=e.indexOf("chrome")&&(f=c),e.indexOf("win64")&&(f=c));var n=new XMLHttpRequest;n.open("GET",f,!0);n.responseType="arraybuffer";n.onload=function(){this.webaudio.context.decodeAudioData(n.response,
function(b){this.webaudio.buffer=b;this.webaudio.source_loop={};this.bgmPlaying?this.play(null,!0):this.stop()}.bind(this),function(){console.log('Error decoding audio "'+f+'".')})}.bind(this);n.send();if(4==n.readyState&&"undefined"!==typeof Audio){this.useHTML5Audio=!0;try{new Audio}catch(l){this.useHTML5Audio=!1}this.useHTML5Audio&&(console.log("Using HTML5 Audio"),this.webaudio=null,this.audio=new Audio,this.isSupported=!0,this.initHTML5Audio(b))}break}},initIOSWebAudioUnlock:function(){if(this.webaudio){webaudio=
this.webaudio;var b=function(){var c=webaudio.context,e=c.createBuffer(1,1,22050),d=c.createBufferSource();d.buffer=e;d.connect(c.destination);"undefined"===typeof d.start?d.noteOn(0):d.start(0);setTimeout(function(){(d.playbackState===d.PLAYING_STATE||d.playbackState===d.FINISHED_STATE)&&window.removeEventListener("touchend",b,!1)}.bind(this),0)};window.addEventListener("touchend",b,!1)}},initHTML5Audio:function(b){if(this.useHTML5Audio&&this.audio){var c=this.audio;this.codecs={};this.codecs={mp3:!!c.canPlayType("audio/mpeg;").replace(/^no$/,
""),opus:!!c.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!c.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!c.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!c.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(c.canPlayType("audio/x-m4a;")||c.canPlayType("audio/m4a;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(c.canPlayType("audio/x-mp4;")||c.canPlayType("audio/mp4;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!c.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,
"")};this.is={ff:Boolean(null!=window.mozInnerScreenX&&/firefox/.test(navigator.userAgent.toLowerCase())),ie:Boolean(document.all&&!window.opera),opera:Boolean(window.opera),chrome:Boolean(window.chrome),safari:Boolean(!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase())&&window.getComputedStyle&&!window.globalStorage&&!window.opera)};this.playDelay=-60;this.stopDelay=30;this.is.chrome&&(this.playDelay=-25);this.is.chrome&&(this.stopDelay=25);this.is.ff&&(this.playDelay=-25);this.is.ff&&
(this.stopDelay=85);this.is.opera&&(this.playDelay=5);this.is.opera&&(this.stopDelay=0);for(var e in b){this.soundList[e]=e;var d=b[e].path,c=d+"."+ig.Sound.FORMAT.OGG.ext,d=d+"."+ig.Sound.FORMAT.MP3.ext,j=null;this.codecs[ig.Sound.FORMAT.OGG.ext.toLowerCase()]?j=c:this.codecs[ig.Sound.FORMAT.MP3.ext.toLowerCase()]&&(j=d);if(j){ig.ua.mobile?ig.ua.iOS&&(j=d):(b=navigator.userAgent.toLowerCase(),-1!=b.indexOf("safari")&&-1>=b.indexOf("chrome")&&(j=d));this.audio.addEventListener("error",function(){this.audio.error&&
4===this.audio.error.code&&(this.isSupported=!1)},!1);this.audio.src=j;this.audio._pos=0;this.audio.preload="auto";this.audio.volume=this._volume;this.inactiveAudio=new Audio;this.inactiveAudio.src=j;this.inactiveAudio._pos=0;this.inactiveAudio.preload="auto";this.inactiveAudio.volume=this._volume;this.inactiveAudio.load();var f=function(){this._duration=this.audio.duration;this._loaded||(this._loaded=!0);this.bgmPlaying?this.play(null,!0):this.stop();this.audio.removeEventListener("canplaythrough",
f,!1)}.bind(this);this.audio.addEventListener("canplaythrough",f,!1);this.audio.load();break}}}},play:function(b,c){if(this.isSupported)if(this.bgmPlaying=!0,this.webaudio){if(!c&&this.reinitOnPlay&&this.webaudio.source_loop.buffer==this.webaudio.buffer){if(this.webaudio.source_loop._playing&&(this.webaudio.source_loop[this.webaudio.compatibility.stop](0),this.webaudio.source_loop._playing=!1,this.pausedTime+=this.webaudio.context.currentTime-this.webaudio.source_loop._startTime,this.pausedTime%=
this.webaudio.source_loop.buffer.duration,this.webaudio.source_loop._startTime=0,"noteOn"===this.webaudio.compatibility.start))this.webaudio.source_once[this.webaudio.compatibility.stop](0);try{this.webaudio.context.close();this.webaudio.context=new this.AudioContext;this.webaudio.gainNode=this.webaudio.context.createGain();this.webaudio.gainNode.connect(this.webaudio.context.destination);this.webaudio.gainNode.gain.value=this._volume;var e="start",d="stop",j=this.webaudio.context.createBufferSource();
"function"!==typeof j.start&&(e="noteOn");this.webaudio.compatibility.start=e;"function"!==typeof j.stop&&(d="noteOff");this.webaudio.compatibility.stop=d;this.webaudio.source_loop={};this.play(null,!0)}catch(f){}}if(this.webaudio.buffer){if(!this.muteFlag&&(this.bgmPlaying=!0,!this.webaudio.source_loop._playing)){this.webaudio.source_loop=this.webaudio.context.createBufferSource();this.webaudio.source_loop.buffer=this.webaudio.buffer;this.webaudio.source_loop.loop=!0;this.webaudio.source_loop.connect(this.webaudio.gainNode);
if(null==b||isNaN(b))b=0,this.pausedTime&&(b=this.pausedTime);this.webaudio.source_loop._startTime=this.webaudio.context.currentTime;if("noteOn"===this.webaudio.compatibility.start)this.webaudio.source_once=this.webaudio.context.createBufferSource(),this.webaudio.source_once.buffer=this.webaudio.buffer,this.webaudio.source_once.connect(this.webaudio.gainNode),this.webaudio.source_once.noteGrainOn(0,b,this.webaudio.buffer.duration-b),this.webaudio.source_loop[this.webaudio.compatibility.start](this.webaudio.context.currentTime+
(this.webaudio.buffer.duration-b));else this.webaudio.source_loop[this.webaudio.compatibility.start](0,b);this.webaudio.source_loop._playing=!0}}else this.bgmPlaying=!0}else if(this.audio){var n=this.audio;if(!this.muteFlag)if(this.bgmPlaying=!0,isNaN(b)&&(b=0,this.pausedTime&&(b=this.pausedTime)),e=this._duration-b,this._onEndTimer&&(clearTimeout(this._onEndTimer),this._onEndTimer=null),this._onEndTimer=setTimeout(function(){this.audio.currentTime=0;this.audio.pause();this.pausedTime=0;if(this.inactiveAudio){var b=
this.audio;this.audio=this.inactiveAudio;this.inactiveAudio=b}this.play()}.bind(this),1E3*e+this.playDelay),4===n.readyState||!n.readyState&&navigator.isCocoonJS)n.readyState=4,n.currentTime=b,n.muted=this.muteFlag||n.muted,n.volume=this._volume,setTimeout(function(){n.play()},0);else{clearTimeout(this._onEndTimer);this._onEndTimer=null;var l=function(){typeof("function"==this.play)&&(this.play(),n.removeEventListener("canplaythrough",l,!1))}.bind(this);n.addEventListener("canplaythrough",l,!1)}}},
stop:function(){this.bgmPlaying=!1;if(this.isSupported)if(this.webaudio){if(this.webaudio.source_loop._playing&&(this.webaudio.source_loop[this.webaudio.compatibility.stop](0),this.webaudio.source_loop._playing=!1,this.pausedTime+=this.webaudio.context.currentTime-this.webaudio.source_loop._startTime,this.pausedTime%=this.webaudio.source_loop.buffer.duration,this.webaudio.source_loop._startTime=0,"noteOn"===this.webaudio.compatibility.start))this.webaudio.source_once[this.webaudio.compatibility.stop](0)}else if(this.audio){var b=
this.audio;4==b.readyState&&(this.pausedTime=b.currentTime,b.currentTime=0,b.pause(),clearTimeout(this._onEndTimer),this._onEndTimer=null)}},volume:function(b){if(isNaN(b)||null==b)return this.getVolume();this.isSupported&&(this._volume=b,0>this._volume?this._volume=0:1<this._volume&&(this._volume=1),this.webaudio?this.webaudio.gainNode&&(this.webaudio.gainNode.gain.value=this._volume):this.audio&&(this.audio.volume=this._volume,this.inactiveAudio&&(this.inactiveAudio.volume=this._volume)))},getVolume:function(){return!this.isSupported?
0:this._volume},mute:function(b){this.parent(b);!1==this.muteFlag&&(this.muteFlag=!0,this.bgmPlaying&&(this.stop(),this.bgmPlaying=!0))},unmute:function(b){this.parent(b);!this.stayMuteFlag&&!0==this.muteFlag&&(this.muteFlag=!1,this.bgmPlaying&&this.play())}})});ig.baked=!0;
ig.module("plugins.audio.sound-info").defines(function(){SoundInfo=ig.Class.extend({FORMATS:{OGG:".ogg",MP3:".mp3"},sfx:{kittyopeningSound:{path:"media/audio/opening/kittyopening"},staticSound:{path:"media/audio/play/static"},openingSound:{path:"media/audio/opening/opening"}},bgm:{background:{path:"media/audio/bgm",startOgg:0,endOgg:21.463,startMp3:0,endMp3:21.463}}})});ig.baked=!0;
ig.module("plugins.audio.sound-handler").requires("plugins.audio.impact-music-player","plugins.audio.impact-sound-player","plugins.audio.howler-player","plugins.audio.howler-music-player","plugins.audio.jukebox-player","plugins.audio.webaudio-music-player","plugins.audio.sound-info").defines(function(){ig.SoundHandler=ig.Class.extend({bgmPlayer:null,sfxPlayer:null,focusBlurMute:!1,soundInfo:new SoundInfo,init:function(){console.log("Initiating sound handler");this.sfxPlayer=new HowlerPlayer(this.soundInfo.sfx);
ig.ua.mobile?(this.initPowerButtonFix(),this.bgmPlayer=new WebaudioMusicPlayer(this.soundInfo.bgm,{loop:!0}),this.bgmPlayer.isSupported||(this.bgmPlayer=new JukeboxPlayer(this.soundInfo.bgm,{loop:!0}))):(this.bgmPlayer=new WebaudioMusicPlayer(this.soundInfo.bgm,{loop:!0}),this.bgmPlayer.isSupported||(this.bgmPlayer=new ImpactMusicPlayer(this.soundInfo.bgm,{loop:!0})))},unlockWebAudio:function(){Howler&&(Howler.ctx&&"running"!==Howler.ctx.state&&Howler.ctx.resume(),Howler._audioUnlocked||"function"===
typeof Howler._unlockAudio&&Howler._unlockAudio());ig&&ig.webaudio_ctx&&ig.webaudio_ctx.state&&"running"!==ig.webaudio_ctx.state&&ig.webaudio_ctx.resume();this.bgmPlayer.webaudio&&this.bgmPlayer.webaudio.context&&this.bgmPlayer.webaudio.context.state&&"running"!==this.bgmPlayer.webaudio.context.state&&this.bgmPlayer.webaudio.context.resume()},checkBGM:function(){return this.bgmPlayer.stayMuteFlag},checkSFX:function(){return this.sfxPlayer.stayMuteFlag},muteSFX:function(b){this.sfxPlayer&&this.sfxPlayer.mute(b)},
muteBGM:function(b){this.bgmPlayer&&this.bgmPlayer.mute(b)},unmuteSFX:function(b){this.sfxPlayer&&this.sfxPlayer.unmute(b)},unmuteBGM:function(b){this.bgmPlayer&&this.bgmPlayer.unmute(b)},muteAll:function(b){this.muteSFX(b);this.muteBGM(b)},unmuteAll:function(b){this.unlockWebAudio();this.unmuteSFX(b);this.unmuteBGM(b)},forceMuteAll:function(){this.focusBlurMute||this.muteAll(!1);this.focusBlurMute=!0},forceUnMuteAll:function(){this.focusBlurMute&&(this.unmuteAll(!1),this.focusBlurMute=!1)},initWindowHandler:function(){"true"===
ig.domHandler.getQueryVariable("webview")?($(window).focus(function(){wgl.system&&wgl.system.startRender();ig.soundHandler&&ig.soundHandler.forceUnMuteAll()}),$(window).blur(function(){wgl.system&&wgl.system.stopRender();ig.soundHandler&&ig.soundHandler.forceMuteAll()})):(window.onfocus=function(){wgl.system&&wgl.system.startRender();ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},window.onblur=function(){wgl.system&&wgl.system.stopRender();ig.soundHandler&&ig.soundHandler.forceMuteAll()})},initPowerButtonFix:function(){var b=
this.getHiddenProp();b&&(b=b.replace(/[H|h]idden/,"")+"visibilitychange",document.addEventListener(b,this.visChange));window.addEventListener("pagehide",function(){ig.soundHandler&&ig.soundHandler.forceMuteAll()},!1);window.addEventListener("pageshow",function(){ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},!1)},getHiddenProp:function(){var b=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var c=0;c<b.length;c++)if(b[c]+"Hidden"in document)return b[c]+"Hidden";return null},
isHidden:function(){var b=this.getHiddenProp();return!b?!1:document[b]},visChange:function(){ig.soundHandler.isHidden()?ig.soundHandler&&ig.soundHandler.forceMuteAll():ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},saveVolume:function(){this.sfxPlayer&&ig.game.io.storageSet("soundVolume",this.sfxPlayer.getVolume());this.bgmPlayer&&ig.game.io.storageSet("musicVolume",this.bgmPlayer.getVolume())},forceLoopBGM:function(){var b;if(!this.focusBlurMute&&this.bgmPlayer.bgmPlaying&&this.bgmPlayer){var c=
this.bgmPlayer.jukeboxPlayer;if(c){null!=window.mozInnerScreenX&&/firefox/.test(navigator.userAgent.toLowerCase());b=Boolean(window.chrome);!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase());var e=0.1;ig.ua.mobile&&(e=0.115,ig.ua.android&&(e=0.45,b&&(e=0.3)));c.settings.spritemap.music&&(b=c.settings.spritemap.music.end-e,c.getCurrentTime()>=b&&(b=c.settings.spritemap.music.start,ig.ua.android?this.forcelooped||(c.play(b,!0),this.forcelooped=!0,setTimeout(function(){ig.soundHandler.forcelooped=
!1},e)):c.setCurrentTime(b)))}else"ImpactMusicPlayer"==this.bgmPlayer.tagName&&(null!=window.mozInnerScreenX&&/firefox/.test(navigator.userAgent.toLowerCase()),b=Boolean(window.chrome),!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase()),e=0.1,ig.ua.mobile&&(e=0.115,ig.ua.android&&(e=0.45,b&&(e=0.3))),c=0,"mp3"==ig.soundManager.format.ext&&(c=0.05),ig.music.currentTrack&&(b=ig.music.currentTrack.duration-e,ig.music.currentTrack.currentTime>=b&&(ig.ua.android?this.forcelooped||(ig.music.currentTrack.pause(),
ig.music.currentTrack.currentTime=c,ig.music.currentTrack.play(),this.forcelooped=!0,setTimeout(function(){ig.soundHandler.forcelooped=!1},e)):ig.music.currentTrack.currentTime=c)))}}})});ig.baked=!0;
ig.module("plugins.handlers.visibility-handler").requires("plugins.audio.sound-handler").defines(function(){ig.VisibilityHandler=ig.Class.extend({version:"1.0.2",config:{allowResumeWithoutFocus:{desktop:!0,mobile:{kaios:!1,"default":!0}},handlerDelay:{desktop:0,mobile:{kaios:0,"default":0}},autoFocusOnResume:{desktop:!0,mobile:{kaios:!1,"default":!0}},autoFocusAfterResume:{desktop:!0,mobile:{kaios:!1,"default":!0}}},browserPrefixes:["o","ms","moz","webkit"],browserPrefix:null,hiddenPropertyName:null,
visibilityEventName:null,visibilityStateName:null,isShowingOverlay:!1,isFocused:!1,isPaused:!1,init:function(){this.initVisibilityHandler();this.initFocusHandler();this.initPageTransitionHandler();ig.visibilityHandler=this},pauseHandler:function(){ig.game&&ig.game.pauseGame();wgl.system&&wgl.system.stopRender();ig.soundHandler&&ig.soundHandler.forceMuteAll()},resumeHandler:function(){ig.game&&ig.game.resumeGame();wgl.system&&wgl.system.startRender();ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},
initVisibilityHandler:function(){this.browserPrefix=this.getBrowserPrefix();this.hiddenPropertyName=this.getHiddenPropertyName(this.browserPrefix);this.visibilityEventName=this.getVisibilityEventName(this.browserPrefix);this.visibilityStateName=this.getVisibilityStateName(this.browserPrefix);this.visibilityEventName&&document.addEventListener(this.visibilityEventName,this.onChange.bind(this),!0)},initFocusHandler:function(){window.addEventListener("blur",this.onChange.bind(this),!0);document.addEventListener("blur",
this.onChange.bind(this),!0);document.addEventListener("focusout",this.onChange.bind(this),!0);window.addEventListener("focus",this.onChange.bind(this),!0);document.addEventListener("focus",this.onChange.bind(this),!0);document.addEventListener("focusin",this.onChange.bind(this),!0)},initPageTransitionHandler:function(){window.addEventListener("pagehide",this.onChange.bind(this),!0);window.addEventListener("pageshow",this.onChange.bind(this),!0)},getBrowserPrefix:function(){var b=null;this.browserPrefixes.forEach(function(c){if(this.getHiddenPropertyName(c)in
document)return b=c}.bind(this));return b},getHiddenPropertyName:function(b){return b?b+"Hidden":"hidden"},getVisibilityEventName:function(b){return(b?b:"")+"visibilitychange"},getVisibilityStateName:function(b){return b?b+"VisibilityState":"visibilityState"},hasView:function(){return!(document[this.hiddenPropertyName]||"visible"!==document[this.visibilityStateName])},hasFocus:function(){return document.hasFocus()||this.isFocused},onOverlayShow:function(){this.systemPaused();this.isShowingOverlay=
!0},onOverlayHide:function(){this.isShowingOverlay=!1;this.systemResumed()},systemPaused:function(){if(this.isPaused)return!1;this.pauseHandler();return this.isPaused=!0},systemResumed:function(){if(!this.isPaused||!this.hasView()||this.isShowingOverlay)return!1;if(!this.hasFocus())if(ig.ua.mobile)if(this.isKaiOS()){if(!this.config.allowResumeWithoutFocus.mobile.kaios)return!1}else{if(!this.config.allowResumeWithoutFocus.mobile.default)return!1}else if(!this.config.allowResumeWithoutFocus.desktop)return!1;
this.focusOnResume();this.resumeHandler();this.focusAfterResume();this.isPaused=!1;return!0},isKaiOS:function(){return/KAIOS/.test(navigator.userAgent)||!1},focusOnResume:function(){var b=!1;return b=ig.ua.mobile?this.isKaiOS()?this.config.autoFocusOnResume.mobile.kaios:this.config.autoFocusOnResume.mobile.default:this.config.autoFocusOnResume.desktop},focusAfterResume:function(){var b=!1;return b=ig.ua.mobile?this.isKaiOS()?this.config.autoFocusAfterResume.mobile.kaios:this.config.autoFocusAfterResume.mobile.default:
this.config.autoFocusAfterResume.desktop},focus:function(b){window.focus&&b&&window.focus()},handleDelayedEvent:function(b){if(!this.hasView()||"pause"===b.type||"pageHide"===b.type||"blur"===b.type||"focusout"===b.type){if("blur"===b.type||"focusout"===b.type)this.isFocused=!1;return this.systemPaused(b)}if("focus"===b.type||"focusin"===b.type)this.isFocused=!0;return this.systemResumed(b)},startDelayedEventHandler:function(b){ig.ua.mobile?this.isKaiOS()?0<this.config.handlerDelay.mobile.kaios?window.setTimeout(function(b){this.handleDelayedEvent(b)}.bind(this,
b),this.config.handlerDelay.mobile):this.handleDelayedEvent(b):0<this.config.handlerDelay.mobile.default?window.setTimeout(function(b){this.handleDelayedEvent(b)}.bind(this,b),this.config.handlerDelay.mobile):this.handleDelayedEvent(b):0<this.config.handlerDelay.desktop?window.setTimeout(function(b){this.handleDelayedEvent(b)}.bind(this,b),this.config.handlerDelay.desktop):this.handleDelayedEvent(b)},onChange:function(b){this.startDelayedEventHandler(b)}})});ig.baked=!0;
ig.module("plugins.io.storage").defines(function(){ig.Storage=ig.Class.extend({staticInstantiate:function(){return!ig.Storage.instance?null:ig.Storage.instance},init:function(){ig.Storage.instance=this},isCapable:function(){return"undefined"!==typeof window.localStorage},isSet:function(b){return null!==this.get(b)},initUnset:function(b,c){null===this.get(b)&&this.set(b,c)},get:function(b){if(!this.isCapable())return null;try{return JSON.parse(localStorage.getItem(b))}catch(c){return window.localStorage.getItem(b)}},
getInt:function(b){return~~this.get(b)},getFloat:function(b){return parseFloat(this.get(b))},getBool:function(b){return!!this.get(b)},key:function(b){return this.isCapable()?window.localStorage.key(b):null},set:function(b,c){if(!this.isCapable())return null;try{window.localStorage.setItem(b,JSON.stringify(c))}catch(e){console.log(e)}},setHighest:function(b,c){c>this.getFloat(b)&&this.set(b,c)},remove:function(b){if(!this.isCapable())return null;window.localStorage.removeItem(b)},clear:function(){if(!this.isCapable())return null;
window.localStorage.clear()}})});ig.baked=!0;
ig.module("plugins.io.mouse").requires("plugins.data.vector").defines(function(){Mouse=ig.Class.extend({bindings:{click:[ig.KEY.MOUSE1]},pos:new BABYLON.Vector2.Zero,init:function(){ig.input.initMouse();for(var b in this.bindings){this[b]=b;for(var c=0;c<this.bindings[b].length;c++)ig.input.bind(this.bindings[b][c],b)}},getWglPos:function(){var b=ig.sizeHandler.mobile.actualResolution.x,c=ig.sizeHandler.mobile.actualResolution.y,e=wgl.system.engine.getRenderWidth(),d=wgl.system.engine.getRenderHeight(),
b=e/b,c=d/c,d=ig.game.io.getClickPos();ig.ua.mobile?(b=d.x*ig.sizeHandler.sizeRatio.x,c=d.y*ig.sizeHandler.sizeRatio.y):(b*=d.x,c*=d.y);return new BABYLON.Vector2(b,c)},getLast:function(){return this.pos},getPos:function(){if(ig.ua.mobile)var b=ig.input.mouse.x/ig.sizeHandler.scaleRatioMultiplier.x,c=ig.input.mouse.y/ig.sizeHandler.scaleRatioMultiplier.y;else b=ig.input.mouse.x,c=ig.input.mouse.y;this.pos=new BABYLON.Vector2(b,c);return this.pos.clone()}})});ig.baked=!0;
ig.module("plugins.io.keyboard").defines(function(){Keyboard=ig.Class.extend({bindings:{up:[ig.KEY.W,ig.KEY.UP_ARROW],right:[ig.KEY.D,ig.KEY.RIGHT_ARROW],left:[ig.KEY.A,ig.KEY.LEFT_ARROW],down:[ig.KEY.S,ig.KEY.DOWN_ARROW,ig.KEY.SPACE]},init:function(){for(var b in this.bindings){this[b]=b;for(var c=0;c<this.bindings[b].length;c++)ig.input.bind(this.bindings[b][c],b)}}})});ig.baked=!0;
ig.module("plugins.io.gamepad-input").defines(function(){ig.PADKEY={BUTTON_0:0,PADBUTTON_1:1,BUTTON_2:2,BUTTON_3:3,BUTTON_LEFT_BUMPER:4,BUTTON_RIGHT_BUMPER:5,BUTTON_LEFT_TRIGGER:6,BUTTON_RIGHT_TRIGGER:7,BUTTON_LEFT_JOYSTICK:10,BUTTON_RIGHT_JOYSTICK:11,BUTTON_DPAD_UP:12,BUTTON_DPAD_DOWN:13,BUTTON_DPAD_LEFT:14,BUTTON_DPAD_RIGHT:15,BUTTON_MENU:16,AXIS_LEFT_JOYSTICK_X:0,AXIS_LEFT_JOYSTICK_Y:1,AXIS_RIGHT_JOYSTICK_X:2,AXIS_RIGHT_JOYSTICK_Y:3};ig.GamepadInput=ig.Class.extend({isInit:!1,isSupported:!1,list:[],
bindings:{},states:{},presses:{},releases:{},downLocks:{},upLocks:{},leftStick:{x:0,y:0},rightStick:{x:0,y:0},start:function(){if(!this.isInit){this.isInit=!0;var b=navigator.getGamepads||navigator.webkitGetGamepads;b&&(!navigator.getGamepads&&navigator.webkitGetGamepads&&(navigator.getGamepads=navigator.webkitGetGamepads),this.list=navigator.getGamepads());this.isSupported=b}},isAvailable:function(){return this.isInit&&this.isSupported},buttonPressed:function(b){return"object"==typeof b?b.pressed:
1==b},buttonDown:function(b){if(b=this.bindings[b])this.states[b]=!0,this.downLocks[b]||(this.presses[b]=!0,this.downLocks[b]=!0)},buttonUp:function(b){if((b=this.bindings[b])&&this.downLocks[b]&&!this.upLocks[b])this.states[b]=!1,this.releases[b]=!0,this.upLocks[b]=!0},clearPressed:function(){for(var b in this.releases)this.states[b]=!1,this.downLocks[b]=!1;this.releases={};this.presses={};this.upLocks={}},bind:function(b,c){this.bindings[b]=c},unbind:function(b){this.releases[this.bindings[b]]=
!0;this.bindings[b]=null},unbindAll:function(){this.bindings={};this.states={};this.presses={};this.releases={};this.downLocks={};this.upLocks={}},state:function(b){return this.states[b]},pressed:function(b){return this.presses[b]},released:function(b){return this.releases[b]},clamp:function(b,c,e){return b<c?c:b>e?e:b},pollGamepads:function(){if(this.isSupported){this.leftStick.x=0;this.leftStick.y=0;this.rightStick.x=0;this.rightStick.y=0;this.list=navigator.getGamepads();for(var b in this.bindings){for(var c=
!1,e=0;e<this.list.length;e++){var d=this.list[e];if(d&&d.buttons&&this.buttonPressed(d.buttons[b])){c=!0;break}}c?this.buttonDown(b):this.buttonUp(b)}for(e=0;e<this.list.length;e++)if((d=this.list[e])&&d.axes){b=d.axes[ig.GAMEPADINPUT.AXIS_LEFT_JOYSTICK_X];var c=d.axes[ig.GAMEPADINPUT.AXIS_LEFT_JOYSTICK_Y],j=d.axes[ig.GAMEPADINPUT.AXIS_RIGHT_JOYSTICK_X],d=d.axes[ig.GAMEPADINPUT.AXIS_RIGHT_JOYSTICK_Y];this.leftStick.x+=isNaN(b)?0:b;this.leftStick.y+=isNaN(c)?0:c;this.rightStick.x+=isNaN(j)?0:j;this.rightStick.y+=
isNaN(d)?0:d}0<this.list.length&&(this.leftStick.x=this.clamp(this.leftStick.x,-1,1),this.leftStick.y=this.clamp(this.leftStick.y,-1,1),this.rightStick.x=this.clamp(this.rightStick.x,-1,1),this.rightStick.y=this.clamp(this.rightStick.y,-1,1))}}})});ig.baked=!0;
ig.module("plugins.io.gamepad").requires("plugins.io.gamepad-input").defines(function(){Gamepad=ig.Class.extend({bindings:{padJump:[ig.PADKEY.BUTTON_0]},init:function(){ig.gamepadInput.start();for(var b in this.bindings)for(var c=0;c<this.bindings[b].length;c++)ig.gamepadInput.bind(this.bindings[b][c],b)},press:function(){},held:function(){},release:function(){}})});ig.baked=!0;
ig.module("plugins.io.multitouch").defines(function(){Multitouch=ig.Class.extend({init:function(){ig.multitouchInput.start()},getTouchesPos:function(){if(ig.ua.mobile){if(0<ig.multitouchInput.touches.length){for(var b=[],c=0;c<ig.multitouchInput.touches.length;c++){var e=ig.multitouchInput.touches[c];b.push({x:e.x,y:e.y})}return b}return null}}})});ig.baked=!0;
ig.module("plugins.io.multitouch-input").defines(function(){ig.MultitouchInput=ig.Class.extend({isStart:!1,touches:{},pressed:[],state:[],released:[],multitouchCapable:!1,lastEventUp:null,internalWidth:1,internalHeight:1,scaleX:1,scaleY:1,start:function(){this.isStart||(this.isStart=!0,navigator.maxTouchPoints&&1<navigator.maxTouchPoints&&(this.multitouchCapable=!0),ig.ua.touchDevice&&(window.navigator.msPointerEnabled&&(ig.system.canvas.addEventListener("MSPointerDown",this.touchdown.bind(this),
!1),ig.system.canvas.addEventListener("MSPointerUp",this.touchup.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",this.touchmove.bind(this),!1),ig.system.canvas.style.msContentZooming="none",ig.system.canvas.style.msTouchAction="none"),ig.system.canvas.addEventListener("touchstart",this.touchdown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.touchup.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.touchmove.bind(this),!1)))},touchdown:function(b){if(ig.ua.touchDevice)if(this.updateSizeProperties(),
window.navigator.msPointerEnabled)this.windowKeyDown(b);else if(b.touches){this.pollMultitouch(b.touches.length);this.updateSizeProperties();var c={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(c=ig.system.canvas.getBoundingClientRect());for(var e=[],d=0;d<b.touches.length;d++)e.push(b.touches[d]);this.spliceFromArray(e,this.pressed);this.spliceFromArray(e,this.state);this.spliceFromArray(e,this.released);for(d=0;d<e.length;d++)b=e[d],this.pressed.push({identifier:b.identifier,x:(b.clientX-
c.left)/this.scaleX,y:(b.clientY-c.top)/this.scaleY})}},touchmove:function(b){if(ig.ua.touchDevice){this.updateSizeProperties();if(window.navigator.msPointerEnabled)this.windowMove(b);else if(b.touches){this.pollMultitouch(b.touches.length);for(var c=0;c<b.touches.length;c++){var e=b.touches[c];this.upgrade(this.pressed,this.state,e);this.updateArray(this.state,e)}}try{ig.soundHandler.unlockWebAudio()}catch(d){}}},touchup:function(b){if(ig.ua.touchDevice){this.updateSizeProperties();if(window.navigator.msPointerEnabled)this.windowKeyUp(b);
else if(this.lastEventUp=b,b.touches)for(var c=0;c<b.changedTouches.length;c++){var e=b.changedTouches[c];this.upgrade(this.state,this.released,e);this.upgrade(this.pressed,this.released,e)}if(ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(d){}}},windowKeyDown:function(b){b=b.changedTouches?b.changedTouches:[b];this.pollMultitouch(b.length);this.updateSizeProperties();for(var c=[],e=0;e<b.length;e++)c.push(b[e]);var d={left:0,top:0};ig.system.canvas.getBoundingClientRect&&
(d=ig.system.canvas.getBoundingClientRect());this.spliceFromArray(c,this.pressed);this.spliceFromArray(c,this.state);this.spliceFromArray(c,this.released);for(e=0;e<c.length;e++){var j=b[e];this.pressed.push({identifier:"undefined"!=typeof j.identifier?j.identifier:"undefined"!=typeof j.pointerId?j.pointerId:1,x:(j.clientX-d.left)/this.scaleX,y:(j.clientY-d.top)/this.scaleY})}},windowKeyUp:function(b){this.lastEventUp=b;b=b.changedTouches?b.changedTouches:[b];for(var c=0;c<b.length;c++){var e=b[c],
e={identifier:"undefined"!=typeof e.identifier?e.identifier:"undefined"!=typeof e.pointerId?e.pointerId:1,clientX:e.clientX,clientY:e.clientY};this.upgrade(this.state,this.released,e);this.upgrade(this.pressed,this.released,e)}if(ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(d){}},windowMove:function(b){b=b.changedTouches?b.changedTouches:[b];this.pollMultitouch(b.length);for(var c=0;c<b.length;c++){var e=b[c],e={identifier:e.pointerId,clientX:e.clientX,
clientY:e.clientY};this.upgrade(this.pressed,this.state,e);this.updateArray(this.state,e)}try{ig.soundHandler.unlockWebAudio()}catch(d){}},clear:function(){for(var b=0;b<this.released.length;++b)this.released[b]&&(this.released.splice(b,1),b--)},pollMultitouch:function(b){!this.multitouchCapable&&1<b&&(this.multitouchCapable=!0)},spliceFromArray:function(b,c){for(var e=0;e<c.length;e++)for(var d=0;d<b.length;d++)b[d].identifier===c[e].identifier&&(b.splice(d,1),d--)},updateSizeProperties:function(){var b=
parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth,c=parseInt(ig.system.canvas.offsetHeight)||ig.system.realHeight;this.scaleX=ig.system.scale*(b/ig.system.realWidth);this.scaleY=ig.system.scale*(c/ig.system.realHeight)},upgrade:function(b,c,e){var d={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(d=ig.system.canvas.getBoundingClientRect());for(var j=(e.clientX-d.left)/this.scaleX,d=(e.clientY-d.top)/this.scaleY,f=0;f<b.length;f++)if(void 0!==typeof b[f].identifier&&void 0!==typeof e.identifier&&
e.identifier===b[f].identifier){b.splice(f,1);c.push({identifier:e.identifier,x:j,y:d});break}},updateArray:function(b,c){var e={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());for(var d=(c.clientX-e.left)/this.scaleX,e=(c.clientY-e.top)/this.scaleY,j=0;j<b.length;j++)if(void 0!==typeof b[j].identifier&&void 0!==typeof c.identifier&&c.identifier===b[j].identifier){b[j].x=d;b[j].y=e;break}}})});ig.baked=!0;
ig.module("plugins.io.fake-storage").requires("impact.game").defines(function(){ig.FakeStorage=ig.Class.extend({tempData:{},init:function(){ig.FakeStorage.instance=this},initUnset:function(b,c){null===this.get(b)&&this.set(b,c)},set:function(b,c){this.tempData[b]=JSON.stringify(c)},setHighest:function(b,c){c>this.getFloat(b)&&this.set(b,c)},get:function(b){return"undefined"==typeof this.tempData[b]?null:JSON.parse(this.tempData[b])},getInt:function(b){return~~this.get(b)},getFloat:function(b){return parseFloat(this.get(b))},
getBool:function(b){return!!this.get(b)},isSet:function(b){return null!==this.get(b)},remove:function(b){delete this.tempData[b]},clear:function(){this.tempData={}}})});ig.baked=!0;
ig.module("plugins.io.io-manager").requires("plugins.io.storage","plugins.io.mouse","plugins.io.keyboard","plugins.io.gamepad","plugins.io.multitouch","plugins.io.multitouch-input","plugins.io.gamepad-input","plugins.io.fake-storage").defines(function(){IoManager=ig.Class.extend({version:"1.0.0",storage:null,localStorageSupport:!1,mouse:null,keyboard:null,multitouch:null,gamepad:null,init:function(){ig.multitouchInput=new ig.MultitouchInput;ig.gamepadInput=new ig.GamepadInput;this.unbindAll();this.initStorage();
this.initMouse();this.initKeyboard()},unbindAll:function(){ig.input.unbindAll();ig.gamepadInput.unbindAll()},initStorage:function(){try{window.localStorage.setItem("test","test"),window.localStorage.removeItem("test"),this.storage=new ig.Storage}catch(b){console.log("using fake storage"),this.storage=new ig.FakeStorage}},initMouse:function(){this.mouse=new Mouse},initKeyboard:function(){this.keyboard=new Keyboard},initMultitouch:function(){this.multitouch=new Multitouch},initGamepad:function(){this.gamepad=
new Gamepad},press:function(b){return ig.input.pressed(b)||this.gamepad&&this.gamepad.press(b)?!0:!1},held:function(b){return ig.input.state(b)||this.gamepad&&this.gamepad.state(b)?!0:!1},release:function(b){return ig.input.released(b)||this.gamepad&&this.gamepad.released(b)?!0:!1},getClickPos:function(){return this.mouse.getPos()},getLastClickPos:function(){return this.mouse.getLast()},getTouchesPos:function(){return this.multitouch.getTouchesPos()},checkOverlap:function(b,c,e,d,j){return b.x>c+
d||b.x<c||b.y>e+j||b.y<e?!1:!0},clear:function(){ig.multitouchInput.clear()},_supportsLocalStorage:function(){try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),this.localStorageSupport="localStorage"in window&&null!==window.localStorage}catch(b){return this.localStorageSupport}},storageIsSet:function(b){return"function"===typeof this.storage.isSet?this.storage.isSet(b):null},storageGet:function(b){return"function"===typeof this.storage.get?this.storage.get(b):null},storageSet:function(b,
c){return"function"===typeof this.storage.set?this.storage.set(b,c):null},assert:function(b,c,e){if(c!==e)throw"actualValue:"+c+" not equal to testValue:"+e+" at "+b;}})});ig.baked=!0;
ig.module("plugins.io.storage-manager").requires("impact.game","plugins.io.io-manager").defines(function(){ig.Game.prototype.name="MJS-Game";ig.Game.prototype.version="1.0";ig.Game.prototype.sessionData={};ig.Game.prototype.initData=function(){return this.sessionData={sound:0.5,music:0.5,level:1,score:0}};ig.Game.prototype.setupStorageManager=function(){"undefined"===typeof this.name?console.error("Cannot found Game Name, Storage Manager Cancelled."):"undefined"===typeof this.version?console.error("Cannot found Game Version, Storage Manager Cancelled."):
(this.io||(this.io=new IoManager,console.log("IO Manager doesn't existed. Initialize...")),console.log("Plug in Storage Manager"),this.storage=this.io.storage,this.storageName=this.name+"-v"+this.version,this.loadAll())};ig.Game.prototype.loadAll=function(){var b=this.storage.get(this.storageName);if(null===b||"undefined"===typeof b)b=this.initData();for(var c in b)this.sessionData[c]=b[c];this.storage.set(this.storageName,b)};ig.Game.prototype.saveAll=function(){var b=this.storage.get(this.storageName),
c;for(c in b)b[c]=this.sessionData[c];this.storage.set(this.storageName,b)};ig.Game.prototype.load=function(b){return this.storage.get(this.storageName)[b]};ig.Game.prototype.save=function(b,c){var e=this.storage.get(this.storageName);e[b]=c;this.storage.set(this.storageName,e)}});ig.baked=!0;
ig.module("plugins.splash-loader").requires("impact.loader","impact.animation").defines(function(){ig.SplashLoader=ig.Loader.extend({desktopCoverDIVID:"play-desktop",init:function(b,c){this.parent(b,c);var e=ig.domHandler.getElementById("#game"),d=ig.domHandler.getElementById("#webgl");ig.domHandler.setZIndex(e,1);ig.domHandler.setZIndex(d,0);ig.apiHandler.run("MJSPreroll")},end:function(){this.parent();this._drawStatus=1;this.draw();ig.altBabylon.scene?this.startGame():ig.altBabylon.onSceneReady.addOnce(this.startGame.bind(this))},
startGame:function(){this._drawStatus=1;this.draw();_SETTINGS.TapToStartAudioUnlock.Enabled?this.tapToStartDiv(function(){ig.system.setGame(MyGame)}):ig.system.setGame(MyGame)},tapToStartDiv:function(b){this.desktopCoverDIV=document.getElementById(this.desktopCoverDIVID);if(!this.desktopCoverDIV){this.desktopCoverDIV=document.createElement("div");this.desktopCoverDIV.id=this.desktopCoverDIVID;this.desktopCoverDIV.setAttribute("class","play");this.desktopCoverDIV.setAttribute("style","position: absolute; display: block; z-index: 999999; background-color: rgba(23, 32, 53, 0.7); visibility: visible; font-size: 10vmin; text-align: center; vertical-align: middle; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;");
this.desktopCoverDIV.innerHTML="<div style='color:white;background-color: rgba(255, 255, 255, 0.3); border: 2px solid #fff; font-size:20px; border-radius: 5px; position: relative; float: left; top: 50%; left: 50%; transform: translate(-50%, -50%);'><div style='padding:20px 50px; font-family: montserrat;'>"+_STRINGS.Splash.TapToStart+"</div></div>";(document.getElementById("play").parentNode||document.getElementById("ajaxbar")).appendChild(this.desktopCoverDIV);try{"undefined"!==typeof ig.sizeHandler?
"undefined"!==typeof ig.sizeHandler.coreDivsToResize&&(ig.sizeHandler.coreDivsToResize.push("#"+this.desktopCoverDIVID),"function"===typeof ig.sizeHandler.reorient&&ig.sizeHandler.reorient()):"undefined"!==typeof coreDivsToResize&&(coreDivsToResize.push(this.desktopCoverDIVID),"function"===typeof sizeHandler&&sizeHandler())}catch(c){console.log(c)}this.desktopCoverDIV.addEventListener("click",function(){ig.soundHandler.unlockWebAudio();this.setAttribute("style","visibility: hidden;");"function"===
typeof b&&b()})}},draw:function(){var b=ig.system.context;b.save();b.fillStyle="#f8c85c";b.fillRect(0,0,ig.system.width,ig.system.height);var c=ig.responsive.toAnchor(0,0,"default");if(ig.babylonJSSupport){this._drawStatus+=(this.status-this._drawStatus)/5;!ig.altBabylon.scene&&0.95<this._drawStatus&&(this._drawStatus=0.95);b.globalAlpha=0.5;b.lineWidth=2;b.fillStyle="#ffffff";b.strokeStyle="#ffffff";b.globalAlpha=1;ig.drawRoundRect(b,c.x+50,c.y+870,440,30,19,!0,!0);b.lineWidth=4;b.fillStyle="#ed0049";
b.strokeStyle="#ffffff";b.globalAlpha=1;ig.drawRoundRect(b,c.x+50,c.y+870,440,30,17,!1,!0);b.fillStyle="#ed0049";b.strokeStyle="#ed0049";var e=430*this._drawStatus;22>e&&(e=22);ig.drawRoundRect(b,c.x+50+5,c.y+870+5,e,20,12,!0,!1);b.restore();this.drawVersion()}else b=ig.system.context,b.fillStyle="#ffffff",b.strokeStyle="#000000",b.lineWidth=8,b.lineJoin="round",b.textAlign="center",b.font="54px mainfont",b.strokeText("UNABLE TO RUN GAME",c.x+270,760),b.fillText("UNABLE TO RUN GAME",c.x+270,760),
b.font="28px mainfont",b.strokeText("THIS BROWSER DOES NOT SUPPORT WEBGL",c.x+270,800),b.fillText("THIS BROWSER DOES NOT SUPPORT WEBGL",c.x+270,800)},drawVersion:function(){if("undefined"!==typeof _SETTINGS.Versioning&&null!==_SETTINGS.Versioning&&_SETTINGS.Versioning.DrawVersion){var b=ig.system.context;fontSize=_SETTINGS.Versioning.FontSize;fontFamily=_SETTINGS.Versioning.FontFamily;fillStyle=_SETTINGS.Versioning.FillStyle;b.save();b.textBaseline="bottom";b.textAlign="left";b.font=fontSize+" "+
fontFamily||"10px Arial";b.fillStyle=fillStyle||"#ffffff";b.fillText("v"+_SETTINGS.Versioning.Version+"+build."+_SETTINGS.Versioning.Build,10,ig.system.height-10);b.restore()}}})});ig.baked=!0;
ig.module("plugins.tween").requires("impact.entity").defines(function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(b){for(var c=0;c<this.length;++c)if(this[c]===b)return c;return-1});ig.Entity.prototype.tweens=[];ig.Entity.prototype._preTweenUpdate=ig.Entity.prototype.update;ig.Entity.prototype.update=function(){this._preTweenUpdate();if(0<this.tweens.length){for(var b=[],c=0;c<this.tweens.length;c++)this.tweens[c].update(),this.tweens[c].complete||b.push(this.tweens[c]);this.tweens=
b}};ig.Entity.prototype.tween=function(b,c,e){b=new ig.Tween(this,b,c,e);this.tweens.push(b);return b};ig.Entity.prototype.pauseTweens=function(){for(var b=0;b<this.tweens.length;b++)this.tweens[b].pause()};ig.Entity.prototype.resumeTweens=function(){for(var b=0;b<this.tweens.length;b++)this.tweens[b].resume()};ig.Entity.prototype.stopTweens=function(b){for(var c=0;c<this.tweens.length;c++)this.tweens[c].stop(b)};ig.Tween=function(b,c,e,d){var j={},f={},n={},l=0,g=!1,m=!1,p=!1;this.duration=e;this.paused=
this.complete=!1;this.easing=ig.Tween.Easing.Linear.EaseNone;this.onComplete=!1;this.loop=this.delay=0;this.loopCount=-1;ig.merge(this,d);this.loopNum=this.loopCount;this.chain=function(b){p=b};this.initEnd=function(b,c,d){if("object"!==typeof c[b])d[b]=c[b];else for(subprop in c[b])d[b]||(d[b]={}),this.initEnd(subprop,c[b],d[b])};this.initStart=function(b,c,d,e){if("object"!==typeof d[b])"undefined"!==typeof c[b]&&(e[b]=d[b]);else for(subprop in d[b])e[b]||(e[b]={}),"undefined"!==typeof c[b]&&this.initStart(subprop,
c[b],d[b],e[b])};this.start=function(){this.paused=this.complete=!1;this.loopNum=this.loopCount;l=0;-1==b.tweens.indexOf(this)&&b.tweens.push(this);m=!0;g=new ig.Timer;for(var d in c)this.initEnd(d,c,f);for(d in f)this.initStart(d,f,b,j),this.initDelta(d,n,b,f)};this.initDelta=function(b,c,d,e){if("object"!==typeof e[b])c[b]=e[b]-d[b];else for(subprop in e[b])c[b]||(c[b]={}),this.initDelta(subprop,c[b],d[b],e[b])};this.propUpdate=function(b,c,d,e,f){if("object"!==typeof d[b])c[b]="undefined"!=typeof d[b]?
d[b]+e[b]*f:c[b];else for(subprop in d[b])this.propUpdate(subprop,c[b],d[b],e[b],f)};this.propSet=function(b,c,d){if("object"!==typeof c[b])d[b]=c[b];else for(subprop in c[b])d[b]||(d[b]={}),this.propSet(subprop,c[b],d[b])};this.update=function(){if(!m)return!1;if(this.delay){if(g.delta()<this.delay)return;this.delay=0;g.reset()}if(this.paused||this.complete)return!1;var c=(g.delta()+l)/this.duration,c=1<c?1:c,d=this.easing(c);for(property in n)this.propUpdate(property,b,j,n,d);if(1<=c){if(0==this.loopNum||
!this.loop){this.complete=!0;if(this.onComplete)this.onComplete();p&&p.start();return!1}if(this.loop==ig.Tween.Loop.Revert){for(property in j)this.propSet(property,j,b);l=0;g.reset();-1!=this.loopNum&&this.loopNum--}else if(this.loop==ig.Tween.Loop.Reverse){c={};d={};ig.merge(c,f);ig.merge(d,j);ig.merge(j,c);ig.merge(f,d);for(property in f)this.initDelta(property,n,b,f);l=0;g.reset();-1!=this.loopNum&&this.loopNum--}}};this.pause=function(){this.paused=!0;g&&g.delta&&(l+=g.delta())};this.resume=function(){this.paused=
!1;g&&g.reset&&g.reset()};this.stop=function(b){b&&(this.loop=this.complete=this.paused=!1,l+=e,this.update());this.complete=!0}};ig.Tween.Loop={Revert:1,Reverse:2};ig.Tween.Easing={Linear:{},Quadratic:{},Cubic:{},Quartic:{},Quintic:{},Sinusoidal:{},Exponential:{},Circular:{},Elastic:{},Back:{},Bounce:{}};ig.Tween.Easing.Linear.EaseNone=function(b){return b};ig.Tween.Easing.Quadratic.EaseIn=function(b){return b*b};ig.Tween.Easing.Quadratic.EaseOut=function(b){return-b*(b-2)};ig.Tween.Easing.Quadratic.EaseInOut=
function(b){return 1>(b*=2)?0.5*b*b:-0.5*(--b*(b-2)-1)};ig.Tween.Easing.Cubic.EaseIn=function(b){return b*b*b};ig.Tween.Easing.Cubic.EaseOut=function(b){return--b*b*b+1};ig.Tween.Easing.Cubic.EaseInOut=function(b){return 1>(b*=2)?0.5*b*b*b:0.5*((b-=2)*b*b+2)};ig.Tween.Easing.Quartic.EaseIn=function(b){return b*b*b*b};ig.Tween.Easing.Quartic.EaseOut=function(b){return-(--b*b*b*b-1)};ig.Tween.Easing.Quartic.EaseInOut=function(b){return 1>(b*=2)?0.5*b*b*b*b:-0.5*((b-=2)*b*b*b-2)};ig.Tween.Easing.Quintic.EaseIn=
function(b){return b*b*b*b*b};ig.Tween.Easing.Quintic.EaseOut=function(b){return(b-=1)*b*b*b*b+1};ig.Tween.Easing.Quintic.EaseInOut=function(b){return 1>(b*=2)?0.5*b*b*b*b*b:0.5*((b-=2)*b*b*b*b+2)};ig.Tween.Easing.Sinusoidal.EaseIn=function(b){return-Math.cos(b*Math.PI/2)+1};ig.Tween.Easing.Sinusoidal.EaseOut=function(b){return Math.sin(b*Math.PI/2)};ig.Tween.Easing.Sinusoidal.EaseInOut=function(b){return-0.5*(Math.cos(Math.PI*b)-1)};ig.Tween.Easing.Exponential.EaseIn=function(b){return 0==b?0:Math.pow(2,
10*(b-1))};ig.Tween.Easing.Exponential.EaseOut=function(b){return 1==b?1:-Math.pow(2,-10*b)+1};ig.Tween.Easing.Exponential.EaseInOut=function(b){return 0==b?0:1==b?1:1>(b*=2)?0.5*Math.pow(2,10*(b-1)):0.5*(-Math.pow(2,-10*(b-1))+2)};ig.Tween.Easing.Circular.EaseIn=function(b){return-(Math.sqrt(1-b*b)-1)};ig.Tween.Easing.Circular.EaseOut=function(b){return Math.sqrt(1- --b*b)};ig.Tween.Easing.Circular.EaseInOut=function(b){return 1>(b/=0.5)?-0.5*(Math.sqrt(1-b*b)-1):0.5*(Math.sqrt(1-(b-=2)*b)+1)};ig.Tween.Easing.Elastic.EaseIn=
function(b){var c,e=0.1,d=0.4;if(0==b)return 0;if(1==b)return 1;d||(d=0.3);!e||1>e?(e=1,c=d/4):c=d/(2*Math.PI)*Math.asin(1/e);return-(e*Math.pow(2,10*(b-=1))*Math.sin((b-c)*2*Math.PI/d))};ig.Tween.Easing.Elastic.EaseOut=function(b){var c,e=0.1,d=0.4;if(0==b)return 0;if(1==b)return 1;d||(d=0.3);!e||1>e?(e=1,c=d/4):c=d/(2*Math.PI)*Math.asin(1/e);return e*Math.pow(2,-10*b)*Math.sin((b-c)*2*Math.PI/d)+1};ig.Tween.Easing.Elastic.EaseInOut=function(b){var c,e=0.1,d=0.4;if(0==b)return 0;if(1==b)return 1;
d||(d=0.3);!e||1>e?(e=1,c=d/4):c=d/(2*Math.PI)*Math.asin(1/e);return 1>(b*=2)?-0.5*e*Math.pow(2,10*(b-=1))*Math.sin((b-c)*2*Math.PI/d):0.5*e*Math.pow(2,-10*(b-=1))*Math.sin((b-c)*2*Math.PI/d)+1};ig.Tween.Easing.Back.EaseIn=function(b){return b*b*(2.70158*b-1.70158)};ig.Tween.Easing.Back.EaseOut=function(b){return(b-=1)*b*(2.70158*b+1.70158)+1};ig.Tween.Easing.Back.EaseInOut=function(b){return 1>(b*=2)?0.5*b*b*(3.5949095*b-2.5949095):0.5*((b-=2)*b*(3.5949095*b+2.5949095)+2)};ig.Tween.Easing.Bounce.EaseIn=
function(b){return 1-ig.Tween.Easing.Bounce.EaseOut(1-b)};ig.Tween.Easing.Bounce.EaseOut=function(b){return(b/=1)<1/2.75?7.5625*b*b:b<2/2.75?7.5625*(b-=1.5/2.75)*b+0.75:b<2.5/2.75?7.5625*(b-=2.25/2.75)*b+0.9375:7.5625*(b-=2.625/2.75)*b+0.984375};ig.Tween.Easing.Bounce.EaseInOut=function(b){return 0.5>b?0.5*ig.Tween.Easing.Bounce.EaseIn(2*b):0.5*ig.Tween.Easing.Bounce.EaseOut(2*b-1)+0.5};ig.Tween.Interpolation={Linear:function(b,c){var e=b.length-1,d=e*c,j=Math.floor(d),f=TWEEN.Interpolation.Utils.Linear;
return 0>c?f(b[0],b[1],d):1<c?f(b[e],b[e-1],e-d):f(b[j],b[j+1>e?e:j+1],d-j)}}});ig.baked=!0;
ig.module("plugins.patches.entity-patch").requires("impact.entity").defines(function(){ig.Entity.inject({handleMovementTrace:function(b){this.standing=!1;b.collision.y&&(0<this.bounciness&&Math.abs(this.vel.y)>this.minBounceVelocity?this.vel.y*=-this.bounciness:(0<this.vel.y&&(this.standing=!0),this.vel.y=0));b.collision.x&&(this.vel.x=0<this.bounciness&&Math.abs(this.vel.x)>this.minBounceVelocity?this.vel.x*-this.bounciness:0);if(b.collision.slope){var c=b.collision.slope;if(0<this.bounciness){var e=
this.vel.x*c.nx+this.vel.y*c.ny;this.vel.x=(this.vel.x-2*c.nx*e)*this.bounciness;this.vel.y=(this.vel.y-2*c.ny*e)*this.bounciness}else e=(this.vel.x*c.x+this.vel.y*c.y)/(c.x*c.x+c.y*c.y),this.vel.x=c.x*e,this.vel.y=c.y*e,c=Math.atan2(c.x,c.y),c>this.slopeStanding.min&&c<this.slopeStanding.max&&(this.standing=!0)}this.pos.x=b.pos.x;this.pos.y=b.pos.y}})});ig.baked=!0;
ig.module("plugins.tweens-handler").requires("impact.entity","plugins.tween","plugins.patches.entity-patch").defines(function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(b){for(var e=0;e<this.length;++e)if(this[e]===b)return e;return-1});ig.TweensHandler=ig.Class.extend({_tweens:[],_systemPausedTweens:[],init:function(){},getAll:function(){return this._tweens},removeAll:function(){this._tweens=[]},add:function(b){this._tweens.push(b)},remove:function(b){b=this._tweens.indexOf(b);
-1!==b&&this._tweens.splice(b,1)},onSystemPause:function(){if(0===this._tweens.length)return!1;for(var b=0,e=null;b<this._tweens.length;)e=this._tweens[b],e._isPlaying&&(this._systemPausedTweens.push(e),e.pause()),b++;return!0},onSystemResume:function(){if(0===this._systemPausedTweens.length)return!1;for(var b=0;b<this._systemPausedTweens.length;)this._systemPausedTweens[b].resume(),b++;this._systemPausedTweens=[];return!0},update:function(b,e){if(0===this._tweens.length)return!1;var d=0;for(b=void 0!==
b?b:ig.game.tweens.now();d<this._tweens.length;)this._tweens[d].update(b)||e?d++:this._tweens.splice(d,1);return!0},now:function(){return Date.now()}});ig.TweenDef=ig.Class.extend({_ent:null,_valuesStart:{},_valuesEnd:{},_valuesStartRepeat:{},_duration:1E3,_repeat:0,_yoyo:!1,_isPlaying:!1,_reversed:!1,_delayTime:0,_startTime:null,_pauseTime:null,_easingFunction:ig.Tween.Easing.Linear.EaseNone,_interpolationFunction:ig.Tween.Interpolation.Linear,_chainedTweens:[],_onStartCallback:null,_onStartCallbackFired:!1,
_onUpdateCallback:null,_onCompleteCallback:null,_onStopCallback:null,_onPauseCallback:null,_onResumeCallback:null,_currentElapsed:0,init:function(b){this._object=b},to:function(b,e){this._valuesEnd=b;void 0!==e&&(this._duration=e);return this},start:function(b){if(this._isPlaying)return this;ig.game.tweens.add(this);this._isPlaying=!0;this._onStartCallbackFired=!1;this._startTime=void 0!==b?b:ig.game.tweens.now();this._startTime+=this._delayTime;for(var e in this._valuesEnd){if(this._valuesEnd[e]instanceof
Array){if(0===this._valuesEnd[e].length)continue;this._valuesEnd[e]=[this._object[e]].concat(this._valuesEnd[e])}void 0!==this._object[e]&&(this._valuesStart[e]=this._object[e],!1===this._valuesStart[e]instanceof Array&&(this._valuesStart[e]*=1),this._valuesStartRepeat[e]=this._valuesStart[e]||0)}return this},stop:function(){if(!this._isPlaying)return this;ig.game.tweens.remove(this);this._isPlaying=!1;null!==this._onStopCallback&&this._onStopCallback.call(this._object,this._object);this.stopChainedTweens();
return this},pause:function(){if(!this._isPlaying)return this;ig.game.tweens.remove(this);this._isPlaying=!1;this._pauseTime=ig.game.tweens.now();null!==this._onPauseCallback&&this._onPauseCallback.call(this._object,this._object);return this},resume:function(){if(this._isPlaying||!this._pauseTime)return this;var b=ig.game.tweens.now()-this._pauseTime;this._startTime+=b;ig.game.tweens.add(this);this._isPlaying=!0;null!==this._onResumeCallback&&this._onResumeCallback.call(this._object,this._object);
this._pauseTime=null;return this},end:function(){this.update(this._startTime+this._duration);return this},stopChainedTweens:function(){for(var b=0,e=this._chainedTweens.length;b<e;b++)this._chainedTweens[b].stop()},delay:function(b){this._delayTime=b;return this},repeat:function(b){this._repeat=b;return this},repeatDelay:function(b){this._repeatDelayTime=b;return this},yoyo:function(b){this._yoyo=b;return this},easing:function(b){this._easingFunction=b;return this},interpolation:function(b){this._interpolationFunction=
b;return this},chain:function(){this._chainedTweens=arguments;return this},onStart:function(b){this._onStartCallback=b;return this},onUpdate:function(b){this._onUpdateCallback=b;return this},onComplete:function(b){this._onCompleteCallback=b;return this},onStop:function(b){this._onStopCallback=b;return this},onPause:function(b){this._onPauseCallback=b;return this},onResume:function(b){this._onResumeCallback=b;return this},update:function(b){var e,d,j;if(b<this._startTime)return!0;!1===this._onStartCallbackFired&&
(null!==this._onStartCallback&&this._onStartCallback.call(this._object,this._object),this._onStartCallbackFired=!0);d=(b-this._startTime)/this._duration;this._currentElapsed=d=1<d?1:d;j=this._easingFunction(d);for(e in this._valuesEnd)if(void 0!==this._valuesStart[e]){var f=this._valuesStart[e]||0,n=this._valuesEnd[e];n instanceof Array?this._object[e]=this._interpolationFunction(n,j):("string"===typeof n&&(n="+"===n.charAt(0)||"-"===n.charAt(0)?f+parseFloat(n):parseFloat(n)),"number"===typeof n&&
(this._object[e]=f+(n-f)*j))}null!==this._onUpdateCallback&&this._onUpdateCallback.call(this._object,this._object,j);if(1===d)if(0<this._repeat){isFinite(this._repeat)&&this._repeat--;for(e in this._valuesStartRepeat)"string"===typeof this._valuesEnd[e]&&(this._valuesStartRepeat[e]=_valuesStartRepeat[e]+parseFloat(_valuesEnd[e])),this._yoyo&&(d=this._valuesStartRepeat[e],this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=d),this._valuesStart[e]=this._valuesStartRepeat[e];this._yoyo&&
(this._reversed=!this._reversed);this._startTime=void 0!==this._repeatDelayTime?b+this._repeatDelayTime:b+this._delayTime}else{null!==this._onCompleteCallback&&this._onCompleteCallback.call(this._object,this._object);b=0;for(e=this._chainedTweens.length;b<e;b++)this._chainedTweens[b].start(this._startTime+this._duration);return!1}return!0}});var b=[1];ig.Tween.Interpolation={Linear:function(b,e){var d=b.length-1,j=d*e,f=Math.floor(j),n=ig.Tween.Interpolation.Utils.Linear;return 0>e?n(b[0],b[1],j):
1<e?n(b[d],b[d-1],d-j):n(b[f],b[f+1>d?d:f+1],j-f)},Bezier:function(b,e){for(var d=0,j=b.length-1,f=Math.pow,n=ig.Tween.Interpolation.Utils.Bernstein,l=0;l<=j;l++)d+=f(1-e,j-l)*f(e,l)*b[l]*n(j,l);return d},CatmullRom:function(b,e){var d=b.length-1,j=d*e,f=Math.floor(j),n=ig.Tween.Interpolation.Utils.CatmullRom;return b[0]===b[d]?(0>e&&(f=Math.floor(j=d*(1+e))),n(b[(f-1+d)%d],b[f],b[(f+1)%d],b[(f+2)%d],j-f)):0>e?b[0]-(n(b[0],b[0],b[1],b[1],-j)-b[0]):1<e?b[d]-(n(b[d],b[d],b[d-1],b[d-1],j-d)-b[d]):n(b[f?
f-1:0],b[f],b[d<f+1?d:f+1],b[d<f+2?d:f+2],j-f)},Utils:{Linear:function(b,e,d){return(e-b)*d+b},Bernstein:function(b,e){var d=ig.Tween.Interpolation.Utils.Factorial;return d(b)/d(e)/d(b-e)},Factorial:function(c){var e=1;if(b[c])return b[c];for(var d=c;1<d;d--)e*=d;return b[c]=e},CatmullRom:function(b,e,d,j,f){b=0.5*(d-b);j=0.5*(j-e);var n=f*f;return(2*e-2*d+b+j)*f*n+(-3*e+3*d-2*b-j)*n+b*f+e}}}});ig.baked=!0;
ig.module("plugins.url-parameters").defines(function(){ig.UrlParameters=ig.Class.extend({init:function(){switch(getQueryVariable("iphone")){case "true":ig.ua.iPhone=!0,console.log("iPhone mode")}var b=getQueryVariable("webview");if(b)switch(b){case "true":ig.ua.is_uiwebview=!0,console.log("webview mode")}if(b=getQueryVariable("debug"))switch(b){case "true":ig.game.showDebugMenu(),console.log("debug mode")}if(b=getQueryVariable("debugwgl"))switch(b){case "true":wgl.debug.debug=!0,console.log("wgl debug mode")}switch(getQueryVariable("view")){case "stats":ig.game.resetPlayerStats(),
ig.game.endGame()}getQueryVariable("ad")}})});ig.baked=!0;
ig.module("plugins.director").requires("impact.impact").defines(function(){ig.Director=ig.Class.extend({init:function(b,c){this.game=b;this.levels=[];this.currentLevel=0;this.append(c)},loadLevel:function(b){for(var c in ig.sizeHandler.dynamicClickableEntityDivs){var e=ig.domHandler.getElementById("#"+c);ig.domHandler.hide(e)}this.currentLevel=b;this.game.loadLevel(this.levels[b]);return!0},loadLevelWithoutEntities:function(b){this.currentLevel=b;this.game.loadLevelWithoutEntities(this.levels[b]);
return!0},append:function(b){newLevels=[];return"object"===typeof b?(b.constructor===[].constructor?newLevels=b:newLevels[0]=b,this.levels=this.levels.concat(newLevels),!0):!1},nextLevel:function(){return this.currentLevel+1<this.levels.length?this.loadLevel(this.currentLevel+1):!1},previousLevel:function(){return 0<=this.currentLevel-1?this.loadLevel(this.currentLevel-1):!1},jumpTo:function(b){var c=null;for(i=0;i<this.levels.length;i++)this.levels[i]==b&&(c=i);return 0<=c?this.loadLevel(c):!1},
firstLevel:function(){return this.loadLevel(0)},lastLevel:function(){return this.loadLevel(this.levels.length-1)},reloadLevel:function(){return this.loadLevel(this.currentLevel)}})});ig.baked=!0;
ig.module("plugins.impact-storage").requires("impact.game").defines(function(){ig.Storage=ig.Class.extend({staticInstantiate:function(){return!ig.Storage.instance?null:ig.Storage.instance},init:function(){ig.Storage.instance=this},isCapable:function(){return"undefined"!==typeof window.localStorage},isSet:function(b){return null!==this.get(b)},initUnset:function(b,c){null===this.get(b)&&this.set(b,c)},get:function(b){if(!this.isCapable())return null;try{return JSON.parse(localStorage.getItem(b))}catch(c){return window.localStorage.getItem(b)}},
getInt:function(b){return~~this.get(b)},getFloat:function(b){return parseFloat(this.get(b))},getBool:function(b){return!!this.get(b)},key:function(b){return this.isCapable()?window.localStorage.key(b):null},set:function(b,c){if(!this.isCapable())return null;try{window.localStorage.setItem(b,JSON.stringify(c))}catch(e){console.log(e)}},setHighest:function(b,c){c>this.getFloat(b)&&this.set(b,c)},remove:function(b){if(!this.isCapable())return null;window.localStorage.removeItem(b)},clear:function(){if(!this.isCapable())return null;
window.localStorage.clear()}})});ig.baked=!0;
ig.module("plugins.responsive.responsive-utils").requires("impact.system").defines(function(){ig.responsive={width:0,height:0,halfWidth:0,halfHeight:0,originalWidth:0,originalHeight:0,fillScale:1,scaleX:1,scaleY:1,toAnchor:function(b,c,e){switch(e){case "top-left":case "left-top":return this.toAnchorTopLeft(b,c);case "top-center":case "center-top":case "top":return this.toAnchorTopCenter(b,c);case "top-right":case "right-top":return this.toAnchorTopRight(b,c);case "left-middle":case "middle-left":case "left":return this.toAnchorLeftMiddle(b,
c);case "center-middle":case "middle-center":case "middle":case "center":return this.toAnchorCenterMiddle(b,c);case "right-middle":case "middle-right":case "right":return toAnchorRightMiddle(b,c);case "bottom-left":case "left-bottom":return this.toAnchorBottomLeft(b,c);case "bottom-center":case "center-bottom":case "bottom":return this.toAnchorBottomCenter(b,c);case "bottom-right":case "right-bottom":return this.toAnchorBottomRight(b,c);default:return this.toAnchorDefault(b,c)}},toAnchorDefault:function(b,
c){return{x:b+(this.width-this.originalWidth)/2,y:c+(this.height-this.originalHeight)/2}},toAnchorCenterMiddle:function(b,c){return{x:b+this.halfWidth,y:c+this.halfHeight}},toAnchorLeftMiddle:function(b,c){return{x:b,y:c+this.halfHeight}},toAnchorTopCenter:function(b,c){return{x:b+this.halfWidth,y:c}},toAnchorRightMiddle:function(b,c){return{x:b+this.width,y:c+this.halfHeight}},toAnchorBottomCenter:function(b,c){return{x:b+this.halfWidth,y:c+this.height}},toAnchorTopLeft:function(b,c){return{x:b,
y:c}},toAnchorBottomLeft:function(b,c){return{x:b,y:c+this.height}},toAnchorTopRight:function(b,c){return{x:b+this.width,y:c}},toAnchorBottomRight:function(b,c){return{x:b+this.width,y:c+this.height}},drawScaledImage:function(b,c,e,d,j,f,n){f||(f=0);n||(n=0);var l=ig.system.context;l.save();l.translate(c,e);(1!=d||1!=j)&&l.scale(d,j);b.draw(-b.width*f,-b.height*n);l.restore()}}});ig.baked=!0;
ig.module("plugins.responsive.responsive-plugin").requires("impact.system","impact.entity","plugins.handlers.size-handler","plugins.responsive.responsive-utils").defines(function(){ig.SizeHandler.inject({resize:function(){this.parent()},sizeCalcs:function(){this.originalResolution||(this.originalResolution=new BABYLON.Vector2(this.desktop.actualResolution.x,this.desktop.actualResolution.y),ig.responsive.originalWidth=this.desktop.actualResolution.x,ig.responsive.originalHeight=this.desktop.actualResolution.y);
var b=window.innerWidth,c=window.innerHeight,e=b/c,d=this.originalResolution.x/this.originalResolution.y,j=0,f=0;this.windowSize=new BABYLON.Vector2(b,c);e<d?(j=this.originalResolution.x,f=j/e,ig.responsive.scaleX=1,ig.responsive.scaleY=f/this.originalResolution.y):(f=this.originalResolution.y,j=f*e,ig.responsive.scaleX=j/this.originalResolution.x,ig.responsive.scaleY=1);this.scaleRatioMultiplier=new BABYLON.Vector2(b/j,c/f);this.desktop.actualResolution=new BABYLON.Vector2(j,f);this.mobile.actualResolution=
new BABYLON.Vector2(j,f);this.desktop.actualSize=new BABYLON.Vector2(b,c);this.mobile.actualSize=new BABYLON.Vector2(b,c);ig.responsive.width=j;ig.responsive.height=f;ig.responsive.halfWidth=j/2;ig.responsive.halfHeight=f/2;ig.responsive.fillScale=Math.max(ig.responsive.scaleX,ig.responsive.scaleY)},resizeLayers:function(){ig.system.resize(ig.sizeHandler.desktop.actualResolution.x,ig.sizeHandler.desktop.actualResolution.y);for(var b=0;b<this.coreDivsToResize.length;b++){var c=ig.domHandler.getElementById(this.coreDivsToResize[b]),
e=Math.floor(ig.sizeHandler.windowSize.x/2-ig.sizeHandler.desktop.actualSize.x/2),d=Math.floor(ig.sizeHandler.windowSize.y/2-ig.sizeHandler.desktop.actualSize.y/2);0>e&&(e=0);0>d&&(d=0);ig.domHandler.resizeOffset(c,Math.floor(ig.sizeHandler.desktop.actualSize.x),Math.floor(ig.sizeHandler.desktop.actualSize.y),e,d)}for(var j in this.adsToResize)b=ig.domHandler.getElementById("#"+j),c=ig.domHandler.getElementById("#"+j+"-Box"),e=(window.innerWidth-this.adsToResize[j]["box-width"])/2+"px",d=(window.innerHeight-
this.adsToResize[j]["box-height"])/2+"px",b&&ig.domHandler.css(b,{width:window.innerWidth,height:window.innerHeight}),c&&ig.domHandler.css(c,{left:e,top:d});b=ig.domHandler.getElementById("#canvas");c=ig.domHandler.getOffsets(b);b=c.left;c=c.top;e=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);for(j in this.dynamicClickableEntityDivs)d=ig.domHandler.getElementById("#"+j),ig.domHandler.css(d,{"float":"left",position:"absolute",left:Math.floor(b+this.dynamicClickableEntityDivs[j].entity_pos_x*
this.scaleRatioMultiplier.x)+"px",top:Math.floor(c+this.dynamicClickableEntityDivs[j].entity_pos_y*this.scaleRatioMultiplier.y)+"px",width:Math.floor(this.dynamicClickableEntityDivs[j].width*this.scaleRatioMultiplier.x)+"px",height:Math.floor(this.dynamicClickableEntityDivs[j].height*this.scaleRatioMultiplier.y)+"px","z-index":3}),this.dynamicClickableEntityDivs[j]["font-size"]&&ig.domHandler.css(d,{"font-size":this.dynamicClickableEntityDivs[j]["font-size"]*e+"px"});$("#ajaxbar").width(this.windowSize.x);
$("#ajaxbar").height(this.windowSize.y)},reorient:function(){ig.ua.mobile?(this.resize(),this.resizeAds()):this.resize();this.resizeBabylon();ig.game&&(ig.game.update(),ig.game.draw())},resizeBabylon:function(){var b=window.innerWidth,c=window.innerHeight,e=b/c,d=ig.responsive.originalWidth,j=ig.responsive.originalHeight,f=d/j,n=2560;ig.ua.mobile&&(n=640);minSize=Math.min(d,j);e>f?(c>j&&(c=j),b=Math.floor(window.innerWidth/window.innerHeight*c),b>n&&(b=n),c=Math.floor(window.innerHeight/window.innerWidth*
b)):(b>d&&(b=d),c=Math.floor(window.innerHeight/window.innerWidth*b),c>n&&(c=n),b=Math.floor(window.innerWidth/window.innerHeight*c));d=e=1;window.innerWidth>n&&(e=window.innerWidth/n);window.innerHeight>n&&(d=window.innerHeight/n);n=null;window.wgl&&(wgl.system&&wgl.system.engine)&&(n=wgl.system.engine);ig.altBabylon&&(n=ig.altBabylon.engine);n.setSize(b,c);n.resize();n.setHardwareScalingLevel(Math.max(e,d));console.log("babylon renderSize : ",n.getRenderWidth(),n.getRenderHeight(),"hwScalingLevel : ",
n.getHardwareScalingLevel().toFixed(2))}});ig.Entity.inject({init:function(b,c,e){this.parent(b,c,e);this.anchorType="none";this.anchoredPositionX=b;this.anchoredPositionY=c},setAnchoredPosition:function(b,c,e){e||(e="default");this.anchorType=e;this.anchoredPositionX=b;this.anchoredPositionY=c},update:function(){this.parent();if(""!=this.anchorType&&"none"!=this.anchorType){var b=ig.responsive.toAnchor(this.anchoredPositionX,this.anchoredPositionY,this.anchorType);this.pos.x=b.x;this.pos.y=b.y}}})});
this.START_BRANDING_SPLASH;ig.baked=!0;
ig.module("plugins.branding.splash").requires("impact.impact","impact.entity").defines(function(){ig.BrandingSplash=ig.Class.extend({init:function(){ig.game.spawnEntity(EntityBranding,0,0)}});EntityBranding=ig.Entity.extend({autoUpdateScale:!1,gravityFactor:0,size:{x:32,y:32},splash:new ig.Image("branding/splash1.png"),init:function(b,c,e){this.parent(b,c,e);320>=ig.system.width?(this.size.x=320,this.size.y=200):(this.size.x=480,this.size.y=240);this.pos.x=(ig.system.width-this.size.x)/2;this.pos.y=
-this.size.y-200;this.endPosY=(ig.system.height-this.size.y)/2;b=this.tween({pos:{y:this.endPosY}},0.5,{easing:ig.Tween.Easing.Bounce.EaseIn});c=this.tween({},2.5,{onComplete:function(){ig.game.director.loadLevel(ig.game.director.currentLevel)}});b.chain(c);b.start();this.currentAnim=this.anims.idle},createClickableLayer:function(){console.log("Build clickable layer");this.checkClickableLayer("branding-splash",_SETTINGS.Branding.Logo.Link,_SETTINGS.Branding.Logo.NewWindow)},doesClickableLayerExist:function(b){for(k in dynamicClickableEntityDivs)if(k==
b)return!0;return!1},checkClickableLayer:function(b,c,e){"undefined"==typeof wm&&(this.doesClickableLayerExist(b)?(ig.game.showOverlay([b]),$("#"+b).find("[href]").attr("href",c)):this.createClickableOutboundLayer(b,c,"media/graphics/misc/invisible.png",e))},createClickableOutboundLayer:function(b,c,e,d){var j=ig.$new("div");j.id=b;document.body.appendChild(j);j=$("#"+j.id);j.css("float","left");j.css("position","absolute");if(ig.ua.mobile){var f=window.innerHeight/mobileHeight,n=window.innerWidth/
mobileWidth;j.css("left",this.pos.x*n);j.css("top",this.pos.y*f);j.css("width",this.size.x*n);j.css("height",this.size.y*f)}else f=w/2-destW/2,n=h/2-destH/2,console.log(f,n),j.css("left",f+this.pos.x*multiplier),j.css("top",n+this.pos.y*multiplier),j.css("width",this.size.x*multiplier),j.css("height",this.size.y*multiplier);d?j.html("<a target='_blank' href='"+c+"'><img style='width:100%;height:100%' src='"+e+"'></a>"):j.html("<a href='"+c+"'><img style='width:100%;height:100%' src='"+e+"'></a>");
dynamicClickableEntityDivs[b]={};dynamicClickableEntityDivs[b].width=this.size.x*multiplier;dynamicClickableEntityDivs[b].height=this.size.y*multiplier;dynamicClickableEntityDivs[b].entity_pos_x=this.pos.x;dynamicClickableEntityDivs[b].entity_pos_y=this.pos.y},draw:function(){ig.system.context.fillStyle="#ffffff";ig.system.context.fillRect(0,0,ig.system.width,ig.system.height);ig.system.context.fillStyle="#000";ig.system.context.font="12px Arial";ig.system.context.textAlign="left";320>=ig.system.width?
ig.system.context.fillText("powered by MarketJS.com",ig.system.width-150,ig.system.height-15):ig.system.context.fillText("powered by MarketJS.com",ig.system.width-160,ig.system.height-15);this.parent();this.splash&&ig.system.context.drawImage(this.splash.data,0,0,this.splash.data.width,this.splash.data.height,this.pos.x,this.pos.y,this.size.x,this.size.y)}})});this.END_BRANDING_SPLASH;ig.baked=!0;
ig.module("plugins.datastructure.binary-heap").defines(function(){BinaryHeap=ig.Class.extend({content:[],getValue:null,minHeap:!0,tagName:"BinaryHeap",init:function(b,c){this.getValue=b;c&&(this.minHeap=!1)},push:function(b){this.content.push(b);this.sinkDown(this.content.length-1)},pop:function(){var b=this.content[0],c=this.content.pop();0<this.content.length&&(this.content[0]=c,this.bubbleUp(0));return b},remove:function(b){var c=this.content.indexOf(b),e=this.content.pop();c!==this.content.length-
1&&(this.content[c]=e,this.minHeap?this.getValue(e)<this.getValue(b)?this.sinkDown(c):this.bubbleUp(c):this.getValue(e)>this.getValue(b)?this.sinkDown(c):this.bubbleUp(c))},size:function(){return this.content.length},rescoreElement:function(b){this.sinkDown(this.content.indexOf(b))},sinkDown:function(b){for(var c=this.content[b];0<b;){var e=(b+1>>1)-1,d=this.content[e];if(this.minHeap)if(this.getValue(c)<this.getValue(d))this.content[e]=c,this.content[b]=d,b=e;else break;else if(this.getValue(c)>
this.getValue(d))this.content[e]=c,this.content[b]=d,b=e;else break}},bubbleUp:function(b){for(var c=this.content.length,e=this.content[b],d=this.getValue(e);;){var j=b+1<<1,f=j-1,n=null,l;f<c&&(l=this.getValue(this.content[f]),this.minHeap?l<d&&(n=f):l>d&&(n=f));if(j<c)if(f=this.getValue(this.content[j]),this.minHeap){if(f<(null===n?d:l))n=j}else if(f>(null===n?d:l))n=j;if(null!==n)this.content[b]=this.content[n],this.content[n]=e,b=n;else break}},empty:function(){for(;0<this.content.length;)this.content.pop()}})});
ig.baked=!0;
ig.module("game.entities.buttons.button").requires("impact.entity").defines(function(){EntityButton=ig.Entity.extend({collides:ig.Entity.COLLIDES.NEVER,type:ig.Entity.TYPE.A,size:new BABYLON.Vector2(48,48),fillColor:null,zIndex:95E3,pos:{x:0,y:0},name:"button",init:function(b,c,e){this.parent(b,c,e);!ig.global.wm&&(e&&!isNaN(e.zIndex))&&(this.zIndex=e.zIndex);b=Math.floor(256*Math.random());c=Math.floor(256*Math.random());e=Math.floor(256*Math.random());this.fillColor="rgba("+b+","+e+","+c+",1)"},
clicked:function(){throw"no implementation on clicked()";},clicking:function(){throw"no implementation on clicking()";},released:function(){throw"no implementation on released()";}})});ig.baked=!0;
ig.module("plugins.clickable-div-layer").defines(function(){ClickableDivLayer=ig.Class.extend({pos:new BABYLON.Vector2(0,0),size:new BABYLON.Vector2(0,0),identifier:null,invisImagePath:"media/graphics/misc/invisible.png",init:function(b){this.pos=new BABYLON.Vector2(b.pos.x,b.pos.y);this.size=new BABYLON.Vector2(b.size.x,b.size.y);var c="more-games",e="www.google.com",d=!1;b.div_layer_name&&(c=b.div_layer_name);b.link&&(e=b.link);b.newWindow&&(d=b.newWindow);this.createClickableLayer(c,e,d)},createClickableLayer:function(b,
c,e){this.identifier=b;var d=ig.domHandler.getElementById("#"+b);d?(ig.domHandler.show(d),ig.domHandler.attr(d,"href",c)):this.createClickableOutboundLayer(b,c,this.invisImagePath,e)},update:function(b,c,e,d){this.pos.x==b&&this.pos.y==c||(this.pos.x=b,this.pos.y=c,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier]={},ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].width=e,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].height=d,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].entity_pos_x=
this.pos.x,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].entity_pos_y=this.pos.y,ig.sizeHandler.resizeLayers())},createClickableOutboundLayer:function(b,c,e,d){var j=ig.domHandler.create("div");ig.domHandler.attr(j,"id",b);var f=ig.domHandler.create("a");ig.domHandler.addEvent(j,"mousedown",function(b){b.preventDefault()});d?(ig.domHandler.attr(f,"href",c),ig.domHandler.attr(f,"target","_blank")):ig.domHandler.attr(f,"href",c);c=ig.domHandler.create("img");ig.domHandler.css(c,{width:"100%",
height:"100%"});ig.domHandler.attr(c,"src",e);e=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);if(ig.ua.mobile){d=Math.floor(this.pos.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px";var n=Math.floor(this.pos.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px",l=Math.floor(this.size.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px";e=Math.floor(this.size.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px"}else d=ig.domHandler.getElementById("#canvas"),d=ig.domHandler.getOffsets(d),
n=d.top,d=Math.floor(d.left+this.pos.x*e)+"px",n=Math.floor(n+this.pos.y*e)+"px",l=Math.floor(this.size.x*e)+"px",e=Math.floor(this.size.y*e)+"px";ig.domHandler.css(j,{"float":"left",position:"absolute",left:d,top:n,width:l,height:e,"z-index":3});ig.domHandler.addEvent(j,"mousemove",ig.input.mousemove.bind(ig.input),!1);ig.domHandler.appendChild(f,c);ig.domHandler.appendChild(j,f);ig.domHandler.appendToBody(j);ig.sizeHandler.dynamicClickableEntityDivs[b]={};ig.sizeHandler.dynamicClickableEntityDivs[b].width=
this.size.x;ig.sizeHandler.dynamicClickableEntityDivs[b].height=this.size.y;ig.sizeHandler.dynamicClickableEntityDivs[b].entity_pos_x=this.pos.x;ig.sizeHandler.dynamicClickableEntityDivs[b].entity_pos_y=this.pos.y}})});ig.baked=!0;
ig.module("game.entities.buttons.button-branding-logo").requires("game.entities.buttons.button","plugins.clickable-div-layer").defines(function(){EntityButtonBrandingLogo=EntityButton.extend({type:ig.Entity.TYPE.A,gravityFactor:0,logo:new ig.AnimationSheet("branding/logo.png",_SETTINGS.Branding.Logo.Width,_SETTINGS.Branding.Logo.Height),zIndex:10001,size:{x:64,y:66},clickableLayer:null,link:null,newWindow:!1,div_layer_name:"branding-logo",name:"brandinglogo",init:function(b,c,e){this.parent(b,c,e);
if(!ig.global.wm){ig.responsive&&(this.anchorType="default");if("undefined"==typeof wm)if(_SETTINGS.Branding.Logo.Enabled)this.size.x=_SETTINGS.Branding.Logo.Width,this.size.y=_SETTINGS.Branding.Logo.Height,this.anims.idle=new ig.Animation(this.logo,0,[0],!0),this.currentAnim=this.anims.idle,e&&e.centralize&&(this.pos.x=(ig.system.width>>>1)-(this.size.x>>>1),console.log("centralize true ... centering branded logo ...")),_SETTINGS.Branding.Logo.LinkEnabled&&(this.link=_SETTINGS.Branding.Logo.Link,
this.newWindow=_SETTINGS.Branding.Logo.NewWindow,this.clickableLayer=new ClickableDivLayer(this));else{this.kill();return}this.div_layer_name=e.div_layer_name?e.div_layer_name:"branding-logo"}},show:function(){var b=ig.domHandler.getElementById("#"+this.div_layer_name);ig.domHandler.show(b)},hide:function(){var b=ig.domHandler.getElementById("#"+this.div_layer_name);ig.domHandler.hide(b)},clicked:function(){},clicking:function(){},released:function(){}})});ig.baked=!0;
ig.module("game.entities.branding-logo-placeholder").requires("impact.entity","game.entities.buttons.button-branding-logo").defines(function(){EntityBrandingLogoPlaceholder=ig.Entity.extend({gravityFactor:0,size:{x:32,y:32},_wmDrawBox:!0,_wmBoxColor:"rgba(0, 0, 255, 0.7)",init:function(b,c,e){this.parent(b,c,e);ig.responsive&&(this.anchorType="default");if(e)switch(console.log("settings found ... using that div layer name"),b=e.div_layer_name,console.log("settings.centralize:",e.centralize),e.centralize){case "true":console.log("centralize true");
centralize=!0;break;case "false":console.log("centralize false");centralize=!1;break;default:console.log("default ... centralize false"),centralize=!1}else b="branding-logo",centralize=!1;if("undefined"==typeof wm){if(_SETTINGS.Branding.Logo.Enabled)try{ig.game.spawnEntity(EntityButtonBrandingLogo,this.pos.x,this.pos.y,{div_layer_name:b,centralize:centralize})}catch(d){console.log(d)}this.kill()}}})});ig.baked=!0;
ig.module("game.entities.buttons.button-more-games").requires("game.entities.buttons.button","plugins.clickable-div-layer").defines(function(){EntityButtonMoreGames=EntityButton.extend({type:ig.Entity.TYPE.A,gravityFactor:0,logo:new ig.AnimationSheet("media/graphics/game/more-games-btn.png",64,66),size:{x:64,y:66},zIndex:750,clickableLayer:null,link:null,newWindow:!1,div_layer_name:"more-games",name:"moregames",init:function(b,c,e){this.parent(b,c,e);ig.global.wm||(ig.responsive&&(this.anchorType=
"default"),this.div_layer_name=e.div_layer_name?e.div_layer_name:"more-games",_SETTINGS.MoreGames.Enabled?(this.anims.idle=new ig.Animation(this.logo,0,[0],!0),this.currentAnim=this.anims.idle,_SETTINGS.MoreGames.Link&&(this.link=_SETTINGS.MoreGames.Link),_SETTINGS.MoreGames.NewWindow&&(this.newWindow=_SETTINGS.MoreGames.NewWindow),this.clickableLayer=new ClickableDivLayer(this)):this.kill())},update:function(){this.parent();this.clickableLayer.update(this.pos.x,this.pos.y,this.size.x,this.size.y)},
show:function(){var b=ig.domHandler.getElementById("#"+this.div_layer_name);ig.domHandler.show(b)},hide:function(){var b=ig.domHandler.getElementById("#"+this.div_layer_name);ig.domHandler.hide(b)},clicked:function(){},clicking:function(){},released:function(){}})});ig.baked=!0;
ig.module("game.entities.opening-kitty").requires("impact.entity").defines(function(){EntityOpeningKitty=ig.Entity.extend({size:{x:48,y:48},kittyAnim:-1,kittyImage:new ig.Image("media/graphics/opening/kitty.png"),kittyTitleImage:new ig.Image("media/graphics/opening/kittytitle.png"),soundKey:"kittyopeningSound",init:function(b,c,e){this.parent(b,c,e)},ready:function(){ig.wm||(_SETTINGS.DeveloperBranding.Splash.Enabled?this.initTimer=new ig.Timer(0.1):(ig.game.director.nextLevel(),ig.system.context.globalAlpha=
1,this.kill()))},update:function(){this.parent();this.updateKittyOpening();this.unlockWebAudio()},unlockWebAudio:function(){if(ig.input.released("click"))try{ig.soundHandler.unlockWebAudio()}catch(b){}},draw:function(){this.parent();ig.global.wm||(this.nextLevelTimer&&0>this.nextLevelTimer.delta()&&(ig.system.context.globalAlpha=-this.nextLevelTimer.delta()),this.drawKittyOpening())},updateKittyOpening:function(){if(this.initTimer&&0<this.initTimer.delta()){this.initTimer=null;try{ig.soundHandler.sfxPlayer.play(this.soundKey)}catch(b){console.log(b)}this.kittyTimer=
new ig.Timer(0.15)}this.kittyTimer&&0<this.kittyTimer.delta()&&(7>this.kittyAnim?(this.kittyAnim++,this.kittyTimer.reset()):(this.kittyTimer=null,this.nextLevelTimer=new ig.Timer(2)));this.nextLevelTimer&&0<this.nextLevelTimer.delta()&&(this.nextLevelTimer=null,ig.game.director.nextLevel(),ig.system.context.globalAlpha=1)},drawKittyOpening:function(){var b=ig.system.context.createLinearGradient(0,0,0,ig.system.height);b.addColorStop(0,"#ffed94");b.addColorStop(1,"#ffcd85");ig.system.context.fillStyle=
b;ig.system.context.fillRect(0,0,ig.system.width,ig.system.height);0<=this.kittyAnim&&(this.kittyImage.drawTile((ig.system.width>>>1)-(this.kittyImage.width>>>3),(ig.system.height>>>1)-(this.kittyImage.height>>>2),this.kittyAnim,218,325),this.kittyTitleImage.drawTile((ig.system.width>>>1)-(this.kittyTitleImage.width>>>1),(ig.system.height>>>1)+(this.kittyImage.height>>>2)+10,this.kittyAnim,380,37));ig.system.context.globalAlpha=1}})});ig.baked=!0;
ig.module("game.entities.pointer").requires("impact.entity").defines(function(){EntityPointer=ig.Entity.extend({checkAgainst:ig.Entity.TYPE.BOTH,isFirstPressed:!1,isPressed:!1,isReleased:!1,isHovering:!1,hoveringItem:null,objectArray:[],clickedObjectList:[],ignorePause:!0,zIndex:5E3,name:"pointer",check:function(b){this.objectArray.push(b)},clickObject:function(b){this.isFirstPressed&&"function"==typeof b.clicked&&(b.clicked(),this.addToClickedObjectList(b));this.isPressed&&!this.isReleased&&"function"==
typeof b.clicking&&b.clicking();this.isReleased&&"function"==typeof b.released&&(b.released(),this.removeFromClickedObjectList(b))},refreshPos:function(){this.pos=ig.game.io.getClickPos()},update:function(){this.parent();this.refreshPos();var b=null,c=-1;for(a=this.objectArray.length-1;-1<a;a--)this.objectArray[a].zIndex>c&&(c=this.objectArray[a].zIndex,b=this.objectArray[a]);if(null!=b)null!=this.hoveringItem?this.hoveringItem!=b&&("function"==typeof this.hoveringItem.leave&&this.hoveringItem.leave(),
"function"==typeof b.over&&b.over()):"function"==typeof b.over&&b.over(),this.hoveringItem=this.lastEnt=b,this.clickObject(b),this.objectArray=[];else if(null!=this.hoveringItem&&"function"==typeof this.hoveringItem.leave&&(this.hoveringItem.leave(),this.hoveringItem=null),this.isReleased){for(b=0;b<this.clickedObjectList.length;b++)c=this.clickedObjectList[b],"function"==typeof c.releasedOutside&&c.releasedOutside();this.lastEnt&&(this.lastEnt.released&&this.lastEnt.released(),this.lastEnt=null);
this.clickedObjectList=[]}this.isFirstPressed=ig.input.pressed("click");this.isReleased=ig.input.released("click");this.isPressed=ig.input.state("click")},addToClickedObjectList:function(b){this.clickedObjectList.push(b)},removeFromClickedObjectList:function(b){for(var c=[],e=0;e<this.clickedObjectList.length;e++){var d=this.clickedObjectList[e];d!=b&&c.push(d)}this.clickedObjectList=c}})});ig.baked=!0;
ig.module("game.entities.pointer-selector").requires("game.entities.pointer").defines(function(){EntityPointerSelector=EntityPointer.extend({zIndex:1E3,_wmDrawBox:!0,_wmBoxColor:"rgba(0, 0, 255, 0.7)",size:{x:20,y:20},init:function(b,c,e){this.parent(b,c,e)}})});ig.baked=!0;
ig.module("game.entities.select").requires("impact.entity").defines(function(){EntitySelect=ig.Entity.extend({type:ig.Entity.TYPE.B,checkAgainst:ig.Entity.TYPE.A,collides:ig.Entity.COLLIDES.NEVER,canSelect:!1,canSelectTimerDuration:0.35,zIndex:99999,isHovering:!1,isSelected:!1,init:function(b,c,e){this.parent(b,c,e);this.canSelectTimer=new ig.Timer(this.canSelectTimerDuration)},doesClickableLayerExist:function(b){for(k in dynamicClickableEntityDivs)if(k==b)return!0;return!1},checkClickableLayer:function(b,
c,e){"undefined"==typeof wm&&(this.doesClickableLayerExist(b)?(ig.game.showOverlay([b]),$("#"+b).find("[href]").attr("href",c)):this.createClickableOutboundLayer(b,c,"media/graphics/misc/invisible.png",e))},createClickableOutboundLayer:function(b,c,e,d){var j=ig.$new("div");j.id=b;document.body.appendChild(j);$("#"+j.id).css("float","left");$("#"+j.id).css("width",this.size.x*multiplier);$("#"+j.id).css("height",this.size.y*multiplier);$("#"+j.id).css("position","absolute");var f=w/2-destW/2,n=h/
2-destH/2;w==mobileWidth?($("#"+j.id).css("left",this.pos.x),$("#"+j.id).css("top",this.pos.y)):($("#"+j.id).css("left",f+this.pos.x*multiplier),$("#"+j.id).css("top",n+this.pos.y*multiplier));d?$("#"+j.id).html("<a target='_blank' href='"+c+"'><img style='width:100%;height:100%' src='"+e+"'></a>"):$("#"+j.id).html("<a href='"+c+"'><img style='width:100%;height:100%' src='"+e+"'></a>");dynamicClickableEntityDivs[b]={};dynamicClickableEntityDivs[b].width=$("#"+j.id).width();dynamicClickableEntityDivs[b].height=
$("#"+j.id).height();dynamicClickableEntityDivs[b].entity_pos_x=this.pos.x;dynamicClickableEntityDivs[b].entity_pos_y=this.pos.y},hovered:function(){this.isHovering=!0;this.dehoverOthers()},dehoverOthers:function(){var b=ig.game.getEntitiesByType(EntitySelect);for(i=0;i<b.length;i++)b[i]!=this&&(b[i].isHovering=!1)},deselectOthers:function(){var b=ig.game.getEntitiesByType(EntitySelect);for(i=0;i<b.length;i++)b[i]!=this&&(b[i].isSelected=!1)},update:function(){this.parent();this.canSelectTimer&&0<
this.canSelectTimer.delta()&&(this.canSelect=!0,this.canSelectTimer=null)}})});ig.baked=!0;ig.module("game.levels.opening").requires("impact.image","game.entities.opening-kitty").defines(function(){LevelOpening={entities:[{type:"EntityOpeningKitty",x:520,y:212}],layer:[]}});ig.baked=!0;
ig.module("game.toybox.objects.game-object").requires("impact.entity").defines(function(){EntityGameObject=ig.Entity.extend({gravityFactor:0,idleSheetInfo:null,singleFrameImage:null,visible:!0,alpha:1,zIndex:1E3,drawAsRect:!1,drawAsOutline:!1,outlineWidth:1,rectColor:"#FFFFFF",outlineColor:"#000000",entryDelay:0,entryDuration:0.25,entryType:null,exitDelay:0,exitDuration:0.25,exitType:null,killOnExit:!0,scaleX:1,scaleY:1,angle:0,anchorX:0,anchorY:0,forceDraw:!1,width:32,height:32,onInputDown:null,
onInputUp:null,onClicked:null,hasTouchInside:!1,inputEnabled:!1,isClicking:!1,boundLeft:0,boundRight:0,boundTop:0,boundBottom:0,isFinishEntering:!1,fixedOnCamera:!1,timedLife:-999,size:{x:32,y:32},init:function(b,c,e){this.onInputDown=new ig.Signal;this.onInputUp=new ig.Signal;this.onClicked=new ig.Signal;e.singleFrameImage?this.singleFrameImage=e.singleFrameImage:e.image&&(this.image=this.singleFrameImage=e.image);null!=this.singleFrameImage?(this.idleSheetInfo={sheetImage:this.singleFrameImage,
sheetX:1,sheetY:1},this.setSpriteSheet("idle"),this.setSize("idle"),this.addAnimation("idle","idleSheet",1,[0],!1,!0)):null!=this.idleSheetInfo&&(this.setSpriteSheet("idle"),this.setSize("idle"));this.parent(b,c,e);!1===e.visible&&(this.visible=!1);this.anchorType=e.anchorType?e.anchorType:"default";this.enter()},swapImage:function(b){this.idleSheetInfo.sheetImage=b;this.idleSheet.image=b},onFinishEntering:function(){},enter:function(){this.visible=!0;if(ig.responsive){var b=ig.responsive.toAnchor(this.anchoredPositionX,
this.anchoredPositionY,this.anchorType);this.pos.x=b.x;this.pos.y=b.y}null!=this.entryType?(this[this.entryType](),this.delayedCall(this.entryDelay+this.entryDuration,function(){this.onFinishEntering();this.isFinishEntering=!0}.bind(this))):(this.isFinishEntering=!0,this.onFinishEntering())},exit:function(){if(null!=this.exitType)this[this.exitType]();else this.alpha0();this.delayedCall(this.exitDuration+this.exitDelay,function(){this.checkKill()}.bind(this))},setSpriteSheet:function(b){this[b+"Sheet"]=
new ig.AnimationSheet(this[b+"SheetInfo"].sheetImage.path,this[b+"SheetInfo"].sheetImage.width/this[b+"SheetInfo"].sheetX,this[b+"SheetInfo"].sheetImage.height/this[b+"SheetInfo"].sheetY)},setSize:function(b){this.width=this[b+"SheetInfo"].sheetImage.width/this[b+"SheetInfo"].sheetX;this.height=this[b+"SheetInfo"].sheetImage.height/this[b+"SheetInfo"].sheetY},addAnimation:function(b,c,e,d,j,f){this[b]=new ig.Animation(this[c],e,d,!j);!0==f&&(this.currentAnim=this[b])},makeFramesArray:function(b,c,
e){for(var d=[],j=b;j<=c;j++)d.push(j);if(e)for(j=c;j>=b;j--)d.push(j);return d},draw:function(){if(this.visible&&(this.forceDraw||this.currentAnim||this.drawAsRect||this.drawAsOutline)){var b=ig.system.context;b.save();var c=0,e=0;this.fixedOnCamera?(c=ig.system.getDrawPos(this.pos.x.round()-this.offset.x),e=ig.system.getDrawPos(this.pos.y.round()-this.offset.y)):(c=ig.system.getDrawPos(this.pos.x.round()-this.offset.x-ig.game.screen.x),e=ig.system.getDrawPos(this.pos.y.round()-this.offset.y-ig.game.screen.y));
b.translate(c,e);(1!=this.scaleX||1!=this.scaleY)&&b.scale(this.scaleX,this.scaleY);c=-this.anchorX*this.width;e=-this.anchorY*this.height;0<this.shakeValue&&(this.shakeValue-=ig.system.tick*this.shakeReductionMultiplier,c+=ig.random.float(-this.shakeValue,this.shakeValue),e+=ig.random.float(-this.shakeValue,this.shakeValue));this.drawObject(c,e);b.restore()}},drawObject:function(b,c){var e=ig.system.context,d=ig.hexToRgb(this.rectColor);this.drawAsRect&&(e.fillStyle=1>this.alpha?"rgba("+d.r+","+
d.g+","+d.b+","+this.alpha+")":d.hex,e.fillRect(b,c,this.width,this.height));d=ig.hexToRgb(this.outlineColor);this.drawAsOutline?(e.lineWidth=this.outlineWidth,e.strokeStyle=1>this.alpha?"rgba("+d.r+","+d.g+","+d.b+","+this.alpha+")":d.hex,e.strokeRect(b,c,this.width,this.height)):null!=this.currentAnim&&(this.currentAnim.alpha=this.alpha,this.currentAnim.draw(b,c))},update:function(){ig.game.entities&&this.parent();if(this.inputEnabled&&this.isFinishEntering&&this.visible){var b=!1;this.hasTouchInside=
!1;for(var c=0;c<ig.multitouchInput.touches.length;c++){var b=!0,e=ig.multitouchInput.touches[c];this.processInput(e.x,e.y)}for(c=0;c<ig.ToyboxTouch.touches.length;c++)b=!0,e=ig.ToyboxTouch.touches[c],this.processInput(e.x,e.y);!b&&ig.input.state("click")&&(b=!0,c=ig.game.io.mouse.getPos(),this.processInput(c.x,c.y));b?this.hasTouchInside||(this.isClicking=!1):(this.isClicking&&(this.onInputUp.dispatch(this),this.onClicked.dispatch(this)),this.isClicking=!1)}-999!=this.timedLife&&this.isFinishEntering&&
(this.timedLife-=ig.system.tick,0>=this.timedLife&&(this.timedLife=-999,this.exit()))},processInput:function(b,c){this.isInsideBounds(b,c)&&(this.hasTouchInside=!0,this.isClicking||(this.isClicking=!0,this.onInputDown.dispatch(this)))},isInsideBounds:function(b,c){var e=this.scaleX*this.width,d=this.scaleY*this.height;this.boundLeft=this.pos.x-e*this.anchorX;this.boundTop=this.pos.y-d*this.anchorY;this.boundRight=this.boundLeft+e;this.boundBottom=this.boundTop+d;this.boundLeft>this.boundRight&&(e=
this.boundLeft,this.boundLeft=this.boundRight,this.boundRight=e);this.boundTop>this.boundBottom&&(e=this.boundTop,this.boundTop=this.boundBottom,this.boundBottom=e);return b<this.boundLeft||c<this.boundTop||b>this.boundRight||c>this.boundBottom?!1:!0},getBounds:function(){this._bounds||(this._bounds={});var b=this._bounds,c=this.scaleX*this.width,e=this.scaleY*this.height;b.left=this.pos.x-c*this.anchorX;b.top=this.pos.y-e*this.anchorY;b.right=b.left+c;b.bottom=b.top+e;b.width=Math.abs(c);b.height=
Math.abs(e);b.left>b.right&&(c=b.left,b.left=b.right,b.right=c);b.top>b.bottom&&(c=b.top,b.top=b.bottom,b.bottom=c);b.x=b.left;b.y=b.top;return b},isCollidingWith:function(b){var c=this.getBounds();b=b.getBounds();return c.right<b.left||c.left>b.right||c.bottom<b.top||c.top>b.bottom?!1:!0},shakeValue:0,shakeReductionMultiplier:0,shake:function(b,c){b||(b=5);c||(c=10);this.shakeValue=b;this.shakeReductionMultiplier=c},fadeBounceRightIn:function(){this.alpha=0;var b=this.pos.x;this.pos.x-=100;this.tween({alpha:1},
0.75*this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start();this.tween({pos:{x:b}},this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Back.EaseOut}).start()},fadeBounceRightOut:function(){this.tween({alpha:0},0.75*this.exitDuration,{delay:this.exitDelay+0.25*this.exitDuration,easing:ig.Tween.Easing.Quadratic.EaseOut}).start();this.tween({pos:{x:this.pos.x-100}},this.exitDuration,{delay:this.exitDelay,easing:ig.Tween.Easing.Back.EaseIn}).start()},
fadeBounceLeftIn:function(){this.alpha=0;var b=this.pos.x;this.pos.x+=100;this.tween({alpha:1},0.75*this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start();this.tween({pos:{x:b}},this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Back.EaseOut}).start()},fadeBounceLeftOut:function(){this.tween({alpha:0},0.75*this.exitDuration,{delay:this.exitDelay+0.25*this.exitDuration,easing:ig.Tween.Easing.Quadratic.EaseOut}).start();this.tween({pos:{x:this.pos.x+
100}},this.exitDuration,{delay:this.exitDelay,easing:ig.Tween.Easing.Back.EaseIn}).start()},fadeJumpIn:function(){this.alpha=0;var b=this.pos.y;this.pos.y+=100;this.tween({alpha:1},0.75*this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start();this.tween({pos:{y:b}},this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Back.EaseOut}).start()},fadeJumpOut:function(){this.tween({alpha:0},0.75*this.exitDuration,{delay:this.exitDelay+0.25*this.exitDuration,
easing:ig.Tween.Easing.Quadratic.EaseOut}).start();this.tween({pos:{y:this.pos.y+100}},this.exitDuration,{delay:this.exitDelay,easing:ig.Tween.Easing.Back.EaseIn}).start()},fadeIn:function(){var b=this.alpha;this.alpha=0;this.tween({alpha:b},this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start()},fadeInLinear:function(){var b=this.alpha;this.alpha=0;this.tween({alpha:b},this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Linear.EaseNone}).start()},
fadeOut:function(){this.tween({alpha:0},this.exitDuration,{delay:this.exitDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start()},fadeOutLinear:function(){this.tween({alpha:0},this.exitDuration,{delay:this.exitDelay,easing:ig.Tween.Easing.Linear.EaseNone}).start()},expandIn:function(){this.alpha=0;this.tween({alpha:1},this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start()},expandOut:function(){this.tween({alpha:0},this.exitDuration,{delay:this.exitDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start()},
dropBoinkIn:function(){this.alpha=0;var b=this.pos.y,c=1.2*this.scaleX,e=0.8*this.scaleY,d=this.scaleX,j=this.scaleY;this.pos.y-=0<this.height?3*this.height:3*this.size.y;c=this.tween({scaleX:c,scaleY:e},0.2*this.entryDuration,{delay:this.entryDelay+0.6*this.entryDuration,easing:ig.Tween.Easing.Quadratic.EaseOut});d=this.tween({scaleX:d,scaleY:j},0.2*this.entryDuration,{easing:ig.Tween.Easing.Quadratic.EaseIn});c.chain(d);c.start();this.tween({alpha:1},0.6*this.entryDuration,{delay:this.entryDelay,
easing:ig.Tween.Easing.Quadratic.EaseIn}).start();this.tween({pos:{y:b}},0.6*this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Quartic.EaseIn}).start()},alpha0:function(){this.alpha=0},alpha1:function(){this.alpha=1},checkKill:function(){this.killOnExit&&this.kill()}})});ig.baked=!0;
ig.module("game.toybox.objects.ui.buttons.simple-button").requires("game.toybox.objects.game-object").defines(function(){EntitySimpleButton=EntityGameObject.extend({originalX:0,originalY:0,transitionInDelay:0,zIndex:7E3,text:"",font:"48px Arial",textColor:"#FFFFFF",align:"center",offsetX:0,offsetY:0,anchorX:0.5,anchorY:0.5,lineSpacing:1,valign:"center",enableShadow:!1,shadowColor:"#000000",shadowOffsetX:0,shadowOffsetY:4,shadowAlpha:0.4,outlineWeight:0,outlineColor:"#000000",outlineCap:"square",outlineJoin:"bevel",
normalScale:1,usePressedTween:!0,textRenderer:null,forceDraw:!0,init:function(b,c,e){this.parent(b,c,e);this.textRenderer=new ig.TextRenderer;if(e.textString)throw Error("old text field detected");},update:function(){this.parent();if(this.usePressedTween&&this.visible){var b=0.9*this.normalScale,c=0.9*this.normalScale,b=0.9*this.normalScale,b=this.hasTouchInside?0.9*this.normalScale:this.normalScale,c=0>this.scaleX?-1*b:b,b=0>this.scaleY?-1*b:b;this.scaleX+=(c-this.scaleX)/3;this.scaleY+=(b-this.scaleY)/
3}},drawObject:function(b,c){this.parent(b,c);this.visible&&(this.textRenderer.text=this.text,this.textRenderer.font=this.font,this.textRenderer.color=this.textColor,this.textRenderer.alpha=this.alpha,this.textRenderer.align=this.align,this.textRenderer.offsetX=this.offsetX,this.textRenderer.offsetY=this.offsetY,this.textRenderer.lineSpacing=this.lineSpacing,this.textRenderer.valign=this.valign,this.textRenderer.enableShadow=this.enableShadow,this.textRenderer.shadowAlpha=this.shadowAlpha,this.textRenderer.shadowColor=
this.shadowColor,this.textRenderer.shadowOffsetX=this.shadowOffsetX,this.textRenderer.shadowOffsetY=this.shadowOffsetY,this.textRenderer.outlineWeight=this.outlineWeight,this.textRenderer.outlineColor=this.outlineColor,this.textRenderer.outlineCap=this.outlineCap,this.textRenderer.outlineJoin=this.outlineJoin,this.textRenderer.draw(b+this.width/2,c+this.height/2))},onFinishEntering:function(){this.inputEnabled=!0}})});ig.baked=!0;
ig.module("game.toybox.objects.ui.fade-black").requires("game.toybox.objects.game-object").defines(function(){ig.hasFadeBlack=!1;EntityFadeBlack=EntityGameObject.extend({zIndex:99999,isIn:!1,nextLevelID:-1,rectColor:"#000000",init:function(b,c,e){this.parent(b,c,e);this.size.x=ig.system.width;this.size.y=ig.system.height;ig.game.sortEntitiesDeferred()},enter:function(){this.visible=!0;this.isIn?(this.alpha=0,this.tween({alpha:1},0.35,{easing:ig.Tween.Easing.Quadratic.EaseIn,onComplete:function(){0<=
this.nextLevelID&&ig.game.director.loadLevel(this.nextLevelID)}.bind(this)}).start()):(this.alpha=1,this.tween({alpha:0},0.35,{easing:ig.Tween.Easing.Quadratic.EaseOut,onComplete:function(){this.kill()}.bind(this)}).start())},drawObject:function(b,c){if(this.visible){var e=ig.system.context;e.save();var d=this.rectColor;e.fillStyle=1>this.alpha?"rgba("+d.r+","+d.g+","+d.b+","+this.alpha+")":d.hex;e.fillRect(this.pos.x,this.pos.y,this.size.x,this.size.y);e.restore()}this.parent(b,c)}});ig.dropCurtain=
function(b){void 0===b&&(b=-1);ig.hasFadeBlack=!0;ig.game.spawnEntity(EntityFadeBlack,0,0,{isIn:!0,nextLevelID:b})};ig.liftCurtain=function(){ig.hasFadeBlack=!1;ig.game.spawnEntity(EntityFadeBlack,0,0,{isIn:!1})}});ig.baked=!0;
ig.module("game.toybox.controllers.controller").requires("impact.entity","game.entities.pointer","game.toybox.objects.ui.fade-black").defines(function(){EntityController=ig.Entity.extend({gravityFactor:0,isAllowInput:!0,pointer:null,liftCurtainOnStart:!0,onInputDown:null,onInputUp:null,lastTouchY:0,lastTouchX:0,size:{x:960,y:540},init:function(b,c,e){this.parent(b,c,e);this.pointer=ig.game.getEntitiesByType(EntityPointer)[0];this.onInputDown=new ig.Signal;this.onInputUp=new ig.Signal;this.liftCurtainOnStart&&
ig.liftCurtain()},goToLevel:function(b){this.isAllowInput=!1;ig.dropCurtain(b)},showPopup:function(b,c){c||(c={});c.controller=this;this.isAllowInput=!1;ig.game.spawnEntity(b,0,0,c);ig.game.sortEntitiesDeferred()},onPopupFinished:function(){this.isAllowInput=!0},update:function(){this.parent();for(var b=!1,c=0;c<ig.multitouchInput.touches.length;c++){var b=!0,e=ig.multitouchInput.touches[c];this.processInput(e.x,e.y)}!b&&ig.input.state("click")&&(b=!0,c=ig.game.io.mouse.getPos(),this.processInput(c.x,
c.y));b||(this.isClicking&&this.onInputUp.dispatch(this),this.isClicking=!1)},processInput:function(b,c){this.currentTouchX=b;this.currentTouchY=c;this.isInsideBounds(b,c)&&!this.isClicking&&(this.isClicking=!0,this.lastTouchX=b,this.lastTouchY=c,this.onInputDown.dispatch(this))},isInsideBounds:function(b,c){var e=this.scaleX*this.width,d=this.scaleY*this.height;this.boundLeft=this.pos.x-e*this.anchorX;this.boundTop=this.pos.y-d*this.anchorY;this.boundRight=this.boundLeft+e;this.boundBottom=this.boundTop+
d;this.boundLeft>this.boundRight&&(e=this.boundLeft,this.boundLeft=this.boundRight,this.boundRight=e);this.boundTop>this.boundBottom&&(e=this.boundTop,this.boundTop=this.boundBottom,this.boundBottom=e);return b<this.boundLeft||c<this.boundTop||b>this.boundRight||c>this.boundBottom?!1:!0}})});ig.baked=!0;
ig.module("game.entities.controllers.main-menu-controller").requires("impact.entity","game.toybox.objects.ui.buttons.simple-button","game.toybox.controllers.controller").defines(function(){EntityMainMenuController=EntityController.extend({titleImage:new ig.Image("media/graphics/game/title.png"),playBtnImage:new ig.Image("media/graphics/game/play-btn.png"),settingsBtnImage:new ig.Image("media/graphics/game/settings-btn.png"),moreGamesBtnImage:new ig.Image("media/graphics/game/more-games-btn.png"),
bgAlpha:0,init:function(b,c,e){this.parent(b,c,e);ig.game.spawnEntity(EntityTextField,270,250,{font:"150px mainfont",text:"COOL\nARCHER",align:"center",entryType:"fadeIn",exitType:"fadeOut"});b=ig.game.spawnEntity(EntitySimpleButton,270,650,{image:this.playBtnImage,entryType:"fadeIn",exitType:"fadeOut"});b.onClicked.add(this.onClickPlay,this);c=ig.game.spawnEntity(EntitySimpleButton,410,650,{image:this.settingsBtnImage,entryType:"fadeIn",exitType:"fadeOut"});c.onClicked.add(this.onClickSettings,this);
_SETTINGS.MoreGames.Enabled?(c=ig.game.spawnEntity(EntitySimpleButton,130,650,{image:this.moreGamesBtnImage,entryType:"fadeIn",exitType:"fadeOut"}),c.size.x=this.moreGamesBtnImage.width,c.size.y=this.moreGamesBtnImage.height,this.moreGamesButton=c,_SETTINGS.MoreGames.Link&&(c.link=_SETTINGS.MoreGames.Link),_SETTINGS.MoreGames.NewWindow&&(c.newWindow=_SETTINGS.MoreGames.NewWindow),b.normalScale=1.2,this.clickableLayer=new ClickableDivLayer(c)):(b.normalScale=1.3,c.anchoredPositionX=270,c.anchoredPositionY=
800);this.fullscreenbtn=ig.game.spawnEntity(ig.FullscreenButton,-82,20,{enterImage:new ig.Image("media/graphics/game/button-maximize.png"),exitImage:new ig.Image("media/graphics/game/button-minimize.png")});this.fullscreenbtn.anchorType="right-top";ig.game.backFromSettings?(ig.game.backFromSettings=!1,this.bgAlpha=0):(ig.babylonSceneController.update(0),this.bgAlpha=1.5);ig.babylonSceneController.arrow.setMainMenu();ig.babylonSceneController.paused=!0},onClickSettings:function(){ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);
ig.game.goToLevel("MainMenuSettings")},onClickPlay:function(){ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);ig.game.goToLevel("Gameplay")},update:function(){this.parent();if(this.clickableLayer){var b=this.moreGamesButton;this.clickableLayer.update(b.pos.x-b.width/2,b.pos.y-b.height/2,b.width,b.height)}},draw:function(){this.parent();var b=ig.system.context;b.clearRect(0,0,ig.system.width,ig.system.height);0<this.bgAlpha&&(this.bgAlpha-=2*ig.system.tick,0.05>this.bgAlpha&&
(this.bgAlpha=0),b.save(),b.globalAlpha=1<this.bgAlpha?1:this.bgAlpha,b.fillStyle="#f8c85c",b.fillRect(0,0,ig.system.width,ig.system.height),b.restore(),b.globalAlpha=1)}})});ig.baked=!0;ig.module("game.levels.main-menu").requires("impact.image","game.entities.controllers.main-menu-controller").defines(function(){LevelMainMenu={entities:[{type:"EntityMainMenuController",x:0,y:0}],layer:[]}});ig.baked=!0;
ig.module("game.toybox.objects.ui.popups.popup").requires("game.toybox.objects.game-object").defines(function(){EntityPopup=EntityGameObject.extend({gravityFactor:0,zIndex:1E4,controller:null,members:[],entryType:"fadeIn",exitType:"fadeOut",exitDelay:0.5,isAllowInput:!1,memberZIndex:10001,init:function(b,c,e){this.parent(b,c,e)},spawnMember:function(b,c,e,d,j){j&&(d.zIndex=j);b=ig.game.spawnEntity(b,c,e,d);!j&&b.zIndex<this.zIndex&&(b.zIndex=this.memberZIndex++);this.members.push(b);this.fixedOnCamera&&
(b.fixedOnCamera=!0);return b},enter:function(){this.parent();this.delayedCall(this.entryDelay+this.entryDuration,function(){this.isAllowInput=!0}.bind(this))},exit:function(){this.parent();this.isAllowInput=!1;this.callControllerCallback();for(var b=0;b<this.members.length;b++)this.members[b].exit()},callControllerCallback:function(){if(this.controller&&this.controller.onPopupFinished){var b=this.exitDelay+this.exitDuration-0.1;if(0>=b)this.controller.onPopupFinished(this.name);else this.delayedCall(b,
function(){this.controller.onPopupFinished(this.name)}.bind(this))}}})});ig.baked=!0;
ig.module("game.toybox.objects.ui.texts.text-field").requires("game.toybox.objects.game-object").defines(function(){EntityTextField=EntityGameObject.extend({text:"",font:"48px Arial",color:"#FFFFFF",align:"start",offsetX:0,offsetY:0,lineSpacing:1,valign:"top",textRenderer:null,forceDraw:!0,enableShadow:!1,shadowColor:"#000000",shadowOffsetX:0,shadowOffsetY:4,shadowAlpha:0.4,outlineWeight:0,outlineColor:"#000000",outlineCap:"square",outlineJoin:"bevel",zIndex:7E3,init:function(b,c,e){this.parent(b,
c,e);this.textRenderer=new ig.TextRenderer},drawObject:function(b,c){this.parent(b,c);this.visible&&(this.applyProperties(),this.textRenderer.draw(b,c))},applyProperties:function(){this.textRenderer.text=this.text;this.textRenderer.font=this.font;this.textRenderer.color=this.color;this.textRenderer.alpha=this.alpha;this.textRenderer.align=this.align;this.textRenderer.offsetX=this.offsetX;this.textRenderer.offsetY=this.offsetY;this.textRenderer.lineSpacing=this.lineSpacing;this.textRenderer.valign=
this.valign;this.textRenderer.enableShadow=this.enableShadow;this.textRenderer.shadowAlpha=this.shadowAlpha;this.textRenderer.shadowColor=this.shadowColor;this.textRenderer.shadowOffsetX=this.shadowOffsetX;this.textRenderer.shadowOffsetY=this.shadowOffsetY;this.textRenderer.outlineWeight=this.outlineWeight;this.textRenderer.outlineColor=this.outlineColor;this.textRenderer.outlineCap=this.outlineCap;this.textRenderer.outlineJoin=this.outlineJoin},getTextWidth:function(){this.applyProperties();return this.textRenderer.measureTextWidth()}})});
ig.baked=!0;
ig.module("game.entities.popups.settings-popup").requires("game.toybox.objects.ui.popups.popup","game.toybox.objects.ui.buttons.simple-button","game.toybox.objects.ui.texts.text-field").defines(function(){EntitySettingsPopup=EntityPopup.extend({bgImg:new ig.Image("media/graphics/game/blank.png"),homeBtnImg:new ig.Image("media/graphics/game/home-btn.png"),sfxOnIconImg:new ig.Image("media/graphics/game/sfx-icon-on.png"),sfxOffIconImg:new ig.Image("media/graphics/game/sfx-icon-off.png"),bgmOnIconImg:new ig.Image("media/graphics/game/bgm-icon-on.png"),
bgmOffIconImg:new ig.Image("media/graphics/game/bgm-icon-off.png"),toggleOffImg:new ig.Image("media/graphics/game/button-off.png"),toggleOnImg:new ig.Image("media/graphics/game/button-on.png"),homeButton:null,bgmButton:null,sfxButton:null,title:null,exitDelay:0,exitDuration:0.25,init:function(b,c,e){this.parent(b,c,e);c=this.spawnMember(EntityGameObject,270,480,{image:this.bgImg,anchorX:0.5,anchorY:0.5,entryType:"fadeIn",exitType:"fadeOut",zIndex:0});b=c.anchoredPositionX;c=c.anchoredPositionY;this.title=
this.spawnMember(EntityTextField,b+15,c-70,{zIndex:7E3,anchorX:0.5,anchorY:0.5,text:_STRINGS.Game.Settings,font:"64px mainfont",align:"center",color:"#ffffff",entryType:"fadeIn",exitType:"fadeOut"});this.homeButton=this.spawnMember(EntitySimpleButton,b,c+150,{image:this.homeBtnImg,entryType:"fadeIn",exitType:"fadeOut"});this.homeButton.onClicked.addOnce(this.onClickHome,this);this.bgmButton=this.spawnMember(EntitySimpleButton,b-80,c,{image:this.toggleOnImg,text:"",font:"48px sans-serif",align:"center",
color:"#ffffff",offsetY:-5,entryType:"fadeIn",exitType:"fadeOut"});this.bgmButton.onClicked.add(this.onValueToggleBgm,this);this.sfxButton=this.spawnMember(EntitySimpleButton,b+80,c,{image:this.toggleOnImg,text:"",font:"48px sans-serif",align:"center",color:"#ffffff",offsetY:-5,entryType:"fadeIn",exitType:"fadeOut"});this.sfxButton.onClicked.add(this.onValueToggleSfx,this);this.bgmIcon=this.spawnMember(EntityGameObject,this.bgmButton.anchoredPositionX,this.bgmButton.anchoredPositionY,{image:this.bgmOnIconImg,
anchorX:0.5,anchorY:0.5,entryType:"fadeIn",exitType:"fadeOut"});this.sfxIcon=this.spawnMember(EntityGameObject,this.sfxButton.anchoredPositionX,this.sfxButton.anchoredPositionY,{image:this.sfxOnIconImg,anchorX:0.5,anchorY:0.5,entryType:"fadeIn",exitType:"fadeOut"});ig.game.sortEntitiesDeferred();this.refreshToggleButton()},refreshToggleButton:function(){0<ig.game.sessionData.music?(this.bgmButton.swapImage(this.toggleOnImg),this.bgmIcon.swapImage(this.bgmOnIconImg)):(this.bgmButton.swapImage(this.toggleOffImg),
this.bgmIcon.swapImage(this.bgmOffIconImg));0<ig.game.sessionData.sound?(this.sfxButton.swapImage(this.toggleOnImg),this.sfxIcon.swapImage(this.sfxOnIconImg)):(this.sfxButton.swapImage(this.toggleOffImg),this.sfxIcon.swapImage(this.sfxOffIconImg))},onValueToggleSfx:function(){ig.game.sessionData.sound=0<ig.game.sessionData.sound?0:ig.game.sfxDefaultVolume;ig.game.saveAll();ig.soundHandler.sfxPlayer.volume(ig.game.sessionData.sound);ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);
this.refreshToggleButton()},onValueToggleBgm:function(){ig.game.sessionData.music=0<ig.game.sessionData.music?0:ig.game.bgmDefaultVolume;ig.game.saveAll();ig.soundHandler.bgmPlayer.volume(ig.game.sessionData.music);ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);this.refreshToggleButton()},onClickHome:function(){this.isAllowInput&&(this.isAllowInput=!1,this.exit(),ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click))}})});ig.baked=!0;
ig.module("game.entities.controllers.main-menu-settings-controller").requires("impact.entity","game.toybox.controllers.controller","game.toybox.objects.game-object","game.toybox.objects.ui.buttons.simple-button","game.entities.popups.settings-popup").defines(function(){EntityMainMenuSettingsController=EntityController.extend({init:function(b,c,e){this.parent(b,c,e);this.delayedCall(0.1,function(){this.showPopup(EntitySettingsPopup)}.bind(this))},onPopupFinished:function(b){this.parent(b);this.isAllowInput&&
(this.isAllowInput=!1,setTimeout(function(){ig.game.backFromSettings=!0;ig.game.goToLevel("MainMenu")}.bind(this),100))},update:function(){this.parent()},draw:function(){this.parent();ig.system.context.clearRect(0,0,ig.system.width,ig.system.height)}})});ig.baked=!0;ig.module("game.levels.main-menu-settings").requires("impact.image","game.entities.controllers.main-menu-settings-controller").defines(function(){LevelMainMenuSettings={entities:[{type:"EntityMainMenuSettingsController",x:0,y:0}],layer:[]}});
ig.baked=!0;
ig.module("game.entities.controllers.game-over-controller").requires("impact.entity","game.toybox.objects.ui.buttons.simple-button","game.toybox.controllers.controller").defines(function(){EntityGameOverController=EntityController.extend({playBtnImage:new ig.Image("media/graphics/game/play-btn.png"),homeBtnImage:new ig.Image("media/graphics/game/home-btn.png"),scoreBgImage:new ig.Image("media/graphics/game/score-bg.png"),bestBgImage:new ig.Image("media/graphics/game/best-bg.png"),init:function(b,c,
e){this.parent(b,c,e);ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.gameover);ig.game.spawnEntity(EntityTextField,270,250,{font:"72px mainfont",text:_STRINGS.Game.GameOver,align:"center",entryType:"fadeIn",exitType:"fadeOut"});b=ig.lastScore;b>ig.game.sessionData.score&&(ig.game.sessionData.score=b,ig.game.saveAll());c=ig.game.spawnEntity(EntityGameObject,270,350,{anchorX:0.5,anchorY:0.5,image:this.scoreBgImage,entryType:"fadeIn",exitType:"fadeOut"});e=ig.game.spawnEntity(EntityGameObject,
270,470,{anchorX:0.5,anchorY:0.5,image:this.bestBgImage,entryType:"fadeIn",exitType:"fadeOut"});ig.game.spawnEntity(EntityTextField,100,c.anchoredPositionY+13,{font:"40px mainfont",text:_STRINGS.Game.Score,align:"left",entryType:"fadeIn",exitType:"fadeOut",color:"#ed0049"});ig.game.spawnEntity(EntityTextField,100,e.anchoredPositionY+13,{font:"40px mainfont",text:_STRINGS.Game.Best,align:"left",entryType:"fadeIn",exitType:"fadeOut"});ig.game.spawnEntity(EntityTextField,440,c.anchoredPositionY+22,{font:"64px mainfont",
text:""+b,align:"right",entryType:"fadeIn",exitType:"fadeOut",color:"#ed0049"});ig.game.spawnEntity(EntityTextField,440,e.anchoredPositionY+22,{font:"64px mainfont",text:""+ig.game.sessionData.score,align:"right",entryType:"fadeIn",exitType:"fadeOut"});ig.game.spawnEntity(EntitySimpleButton,340,600,{image:this.playBtnImage,entryType:"fadeIn",exitType:"fadeOut"}).onClicked.add(this.onClickPlay,this);ig.game.spawnEntity(EntitySimpleButton,200,600,{image:this.homeBtnImage,entryType:"fadeIn",exitType:"fadeOut"}).onClicked.add(this.onClickHome,
this);this.isAllowInput=!0},onClickPlay:function(){ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);ig.game.goToLevel("Gameplay")},onClickHome:function(){ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);ig.game.goToLevel("MainMenu")},update:function(){this.parent();ig.input.state("jump")&&this.isAllowInput&&(this.isAllowInput=!1,this.onClickPlay())},draw:function(){this.parent();ig.system.context.clearRect(0,0,ig.system.width,ig.system.height)}})});
ig.baked=!0;ig.module("game.levels.game-over").requires("impact.image","game.entities.controllers.game-over-controller").defines(function(){LevelGameOver={entities:[{type:"EntityGameOverController",x:0,y:0}],layer:[]}});ig.baked=!0;
ig.module("game.entities.popups.pause-popup").requires("game.entities.popups.settings-popup").defines(function(){EntityPausePopup=EntitySettingsPopup.extend({resumeBtnImg:new ig.Image("media/graphics/game/small-play-btn.png"),replayBtnImg:new ig.Image("media/graphics/game/replay-btn.png"),showCover:!1,init:function(b,c,e){this.parent(b,c,e);this.resumeButton=this.spawnMember(EntitySimpleButton,270,this.homeButton.anchoredPositionY,{usePressedTween:!0,image:this.resumeBtnImg,anchorX:0.5,anchorY:0.5,
entryType:"fadeIn",exitType:"fadeOut",entryDuration:0.25,exitDuration:0.25});this.resumeButton.onClicked.addOnce(this.onClickResume,this);this.replayButton=this.spawnMember(EntitySimpleButton,390,this.homeButton.anchoredPositionY,{usePressedTween:!0,image:this.replayBtnImg,anchorX:0.5,anchorY:0.5,entryType:"fadeIn",exitType:"fadeOut",entryDuration:0.25,exitDuration:0.25});this.replayButton.onClicked.addOnce(this.onClickReplay,this);this.homeButton.anchoredPositionX=150;this.title.text=_STRINGS.Game.Paused;
ig.game.sortEntitiesDeferred()},update:function(){this.parent()},draw:function(){this.parent();if(this.showCover){var b=ig.system.context;b.save();b.fillStyle="#f8c85c";b.fillRect(0,0,ig.system.width,ig.system.height);b.restore()}},onClickHome:function(){if(this.isAllowInput){this.showCover=!0;ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);this.isAllowInput=!1;ig.babylonSceneController.paused=!0;this.delayedCall(0.1,function(){ig.game.goToLevel("MainMenu")}.bind(this));
for(var b=0;b<this.members.length;b++)this.members[b].exit()}},onClickResume:function(){this.isAllowInput&&(this.isAllowInput=!1,this.exit(),ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click))},onClickReplay:function(){if(this.isAllowInput){this.showCover=!0;ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);this.isAllowInput=!1;ig.babylonSceneController.paused=!0;this.delayedCall(0.1,function(){ig.game.goToLevel("Gameplay")}.bind(this));for(var b=0;b<
this.members.length;b++)this.members[b].exit()}}})});ig.baked=!0;
ig.module("game.entities.objects.score-fx").requires("impact.entity","game.toybox.objects.ui.texts.text-field").defines(function(){EntityScoreFx=EntityTextField.extend({init:function(b,c,e){e.text="+"+e.score;0==e.score&&(e.text="MISS!");e.anchorType="top";e.color="#000000";e.font="70px mainfont";e.align="center";e.entryType="fadeJumpIn";e.entryDelay=0.5;e.exitType="fadeOut";e.timedLife=1;this.parent(0,180,e)},kill:function(){this.parent();this.callback()}})});ig.baked=!0;
ig.module("game.entities.objects.wind-fx").requires("game.toybox.objects.game-object").defines(function(){ig.windFxFactor=50;EntityWindFx=EntityGameObject.extend({windDirectionImage:new ig.Image("media/graphics/game/wind-direction.png"),traversedDistance:0,init:function(b,c,e){e.anchorType="bottom-left";e.image=this.windDirectionImage;e.scaleY=0.2;e.scaleX=e.scaleY*(0<ig.babylonSceneController.arrow.wind.x?1:-1);this.parent(b,c,e)},update:function(){this.parent();var b=ig.babylonSceneController.arrow.wind.x*
ig.windFxFactor*ig.system.tick;this.anchoredPositionX+=b;this.traversedDistance+=Math.abs(b);this.traversedDistance>this.killDistance?this.kill():ig.babylonSceneController.arrow.isFlying&&this.kill()}})});ig.baked=!0;
ig.module("game.entities.controllers.gameplay-controller").requires("impact.entity","game.entities.popups.pause-popup","game.toybox.objects.ui.buttons.simple-button","game.toybox.controllers.controller","game.entities.objects.score-fx","game.entities.objects.wind-fx").defines(function(){EntityGameplayController=EntityController.extend({pauseImage:new ig.Image("media/graphics/game/pause-btn.png"),targetImage:new ig.Image("media/graphics/game/target.png"),arrowImage:new ig.Image("media/graphics/game/arrow-icon.png"),
windImage:new ig.Image("media/graphics/game/wind3.png"),windIconImage:new ig.Image("media/graphics/game/wind-icon.png"),allowShooting:!0,isAiming:!1,aimCenterX:0,aimCenterY:0,aimControlX:0,aimControlY:0,aimMinimumSpeed:100,crosshairX:0,crosshairY:0,crosshairAreaRadius:2E3,crosshairStartAimRadius:500,crosshairSpeedMultiplier:5,cameraPositionRatio:0.02,showAimController:!1,score:0,arrowLeft:3,aimTime:5,aimTimeMax:6,windFxSpawnDelay:0,init:function(b,c,e){this.parent(b,c,e);ig.babylonSceneController.arrow.reset();
this.score=0;this.scoreTf=ig.game.spawnEntity(EntityTextField,0,80,{font:"90px mainfont",text:"0",align:"center",color:"#000000",entryType:"fadeIn",exitType:"fadeOut",anchorType:"top",entryDelay:0.5});this.windIcon=ig.game.spawnEntity(EntityGameObject,150,-150,{image:this.windIconImage,anchorType:"bottom-left",scaleX:0.35,scaleY:0.35,anchorX:0.5,anchorY:1,alpha:0});this.pauseButton=ig.game.spawnEntity(EntitySimpleButton,-50,45,{anchorX:1,anchorY:0,anchorType:"top-right",image:this.pauseImage,entryType:"fadeIn",
exitType:"fadeOut",anchorX:0.5,anchorY:0.5,entryDelay:0.5});this.pauseButton.onClicked.add(this.onClickPause,this);ig.babylonSceneController.paused=!1;ig.babylonSceneController.arrow.resetDifficulty();this.allowShooting=!0;this.isAiming=!1;ig.babylonSceneController.arrow.onLanded.add(this.onArrowLanded,this)},onArrowLanded:function(){ig.meshManager.crosshairPoint.position.x=0;ig.meshManager.crosshairPoint.position.y=ig.meshManager.targetHeight;ig.game.spawnEntity(EntityScoreFx,0,0,{score:ig.babylonSceneController.arrow.lastScore,
callback:function(){this.score+=ig.babylonSceneController.arrow.lastScore}.bind(this)});0==ig.babylonSceneController.arrow.lastScore&&this.arrowLeft--;this.delayedCall(0.25,function(){0<this.arrowLeft?(ig.babylonSceneController.arrow.resetNextFrame=!0,ig.babylonSceneController.arrow.increaseDifficulty(),this.allowShooting=!0,this.isAiming=!1,console.log("playAgain")):(ig.lastScore=this.score,ig.game.goToLevel("GameOver"))}.bind(this))},onClickPause:function(){this.isAllowInput&&(this.showPopup(EntityPausePopup),
ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click),this.isAllowInput=!1,ig.babylonSceneController.paused=!0,this.pauseButton.usePressedTween=!1,console.log("pause"))},onPopupFinished:function(b){this.parent(b);this.isAllowInput=!1;this.delayedCall(0.25,function(){this.isAllowInput=!0;ig.babylonSceneController.paused=!1;this.pauseButton.usePressedTween=!0;console.log("resume")}.bind(this))},update:function(){this.parent();this.updateInput();this.scoreTf.text=Math.round(this.score).toFixed();
this.scoreTf.visible=0<this.score;var b=ig.babylonSceneController.arrow.wind.x;0!=b&&(ig.babylonSceneController.arrow.isRelaxing||ig.babylonSceneController.arrow.isAiming)?(this.windIcon.alpha+=(1-this.windIcon.alpha)/10,this.windIcon.scaleX=this.windIcon.scaleY*(0>b?-1:1),0<this.windFxSpawnDelay?this.windFxSpawnDelay-=ig.system.tick:(this.windFxSpawnDelay=Math.abs(10/(b*ig.windFxFactor)),ig.game.spawnEntity(EntityWindFx,this.windIcon.anchoredPositionX+(0>b?40:-40),this.windIcon.anchoredPositionY-
10,{killDistance:80}))):this.windIcon.alpha-=this.windIcon.alpha/10},updateInput:function(){if(!ig.babylonSceneController.paused){for(var b=!1,c=0,e=0,d=0;d<ig.ToyboxTouch.touches.length;d++){var j=ig.ToyboxTouch.touches[d];100<j.y&&(b=!0,c=j.x,e=j.y)}!b&&(ig.input.state("click")&&100<ig.game.io.mouse.getPos().y)&&(b=!0,c=ig.game.io.mouse.getPos().x,e=ig.game.io.mouse.getPos().y);0>this.aimTime&&(b=!1);this.allowShooting&&ig.babylonSceneController.arrow.isRelaxing&&(b?(ig.cameraControl.targetFov=
ig.cameraControl.fovAim,this.isAiming||(this.aimCenterX=c+ig.random.int(-50,50),this.aimCenterY=e+ig.random.int(-50,50),this.crosshairX=2*ig.random.int(-this.crosshairStartAimRadius,this.crosshairStartAimRadius),this.crosshairY=2*ig.random.int(-this.crosshairStartAimRadius,this.crosshairStartAimRadius),this.aimTime=this.aimTimeMax),this.isAiming=!0,this.aimControlX=c,this.aimControlY=e,b=ig.system.tick,c=(this.aimControlX-this.aimCenterX)*b*this.crosshairSpeedMultiplier,e=(this.aimCenterY-this.aimControlY)*
b*this.crosshairSpeedMultiplier,d=this.aimMinimumSpeed*b,c*c+e*e<d*d&&(e=ig.utils.normalize2(c,e,d),c=e.x,e=e.y),this.crosshairX+=c,this.crosshairY+=e,this.crosshairX<-this.crosshairAreaRadius&&(this.crosshairX=-this.crosshairAreaRadius),this.crosshairX>this.crosshairAreaRadius&&(this.crosshairX=this.crosshairAreaRadius),this.crosshairY<-this.crosshairAreaRadius&&(this.crosshairY=-this.crosshairAreaRadius),this.crosshairY>this.crosshairAreaRadius&&(this.crosshairY=this.crosshairAreaRadius),ig.meshManager.crosshairPoint.position.x=
0+this.crosshairX*this.cameraPositionRatio,ig.meshManager.crosshairPoint.position.y=ig.meshManager.targetHeight+this.crosshairY*this.cameraPositionRatio,5>ig.meshManager.crosshairPoint.position.y&&(ig.meshManager.crosshairPoint.position.y=5),this.aimTime-=b):(ig.cameraControl.targetFov=ig.cameraControl.fovRelaxing,this.isAiming&&(this.allowShooting=this.isAiming=!1,ig.babylonSceneController.arrow.launchNextFrame=!0,this.aimTime=this.aimTimeMax)));ig.babylonSceneController.arrow.isAiming=this.isAiming}},
draw:function(){this.parent();var b=ig.system.context;b.clearRect(0,0,ig.system.width,ig.system.height);b.save();for(var c=0;c<this.arrowLeft;c++)this.arrowImage.draw(10+20*c,10);if(this.isAiming){b.save();var e=c=30,d=this.aimTime/this.aimTimeMax;0.5>d&&(b.globalAlpha=Math.cos(7*this.aimTime));b.translate(ig.system.width/2,ig.system.height/2);b.fillStyle="#000000";b.beginPath();b.arc(0,0,2,0,2*Math.PI);b.fill();b.strokeStyle="#000000";b.lineWidth=2;c=5+(c-5)*d;e=5+(e-5)*d;b.beginPath();b.moveTo(-c,
0);b.lineTo(-5,0);b.stroke();b.beginPath();b.moveTo(c,0);b.lineTo(5,0);b.stroke();b.beginPath();b.moveTo(0,-e);b.lineTo(0,-5);b.stroke();b.beginPath();b.moveTo(0,e);b.lineTo(0,5);b.stroke();b.globalAlpha=1;b.restore();this.showAimController&&(b.fillStyle="#000000",b.strokeStyle="#000000",b.lineWidth=2,b.beginPath(),b.arc(this.aimCenterX,this.aimCenterY,10,0,2*Math.PI),b.fill(),b.beginPath(),b.arc(this.aimCenterX,this.aimCenterY,50,0,2*Math.PI),b.stroke(),b.beginPath(),b.arc(this.aimControlX,this.aimControlY,
5,0,2*Math.PI),b.fill(),b.beginPath(),b.moveTo(this.aimCenterX,this.aimCenterY),b.lineTo(this.aimControlX,this.aimControlY),b.stroke())}b.restore()}})});ig.baked=!0;ig.module("game.levels.gameplay").requires("impact.image","game.entities.controllers.gameplay-controller").defines(function(){LevelGameplay={entities:[{type:"EntityGameplayController",x:0,y:0}],layer:[]}});ig.baked=!0;
ig.module("game.entities.controllers.tutorial-controller").requires("impact.entity","game.toybox.objects.ui.buttons.simple-button","game.toybox.controllers.controller").defines(function(){EntityTutorialController=EntityController.extend({init:function(b,c,e){this.parent(b,c,e);for(b=0;4>b;b++)c=ig.game.spawnEntity(EntityTextField,270,250+60*b,{font:"38px mainfont",text:"",align:"center",entryType:"fadeIn",exitType:"fadeOut",enableShadow:!0,shadowColor:"#f36d61"}),c.text=ig.ua.mobile?_STRINGS.Game.TutorialMobile[b]:
_STRINGS.Game.TutorialDesktop[b],3==b&&(c.anchoredPositionY=650);this.isAllowInput=!0;ig.gameScene3D.paused=!0;ig.gameScene3D.player.mesh.isVisible=!1},update:function(){this.parent();ig.ua.mobile?this.isClicking&&this.isAllowInput&&(this.isAllowInput=!1,this.onClickPlay()):ig.input.state("jump")&&this.isAllowInput&&(this.isAllowInput=!1,this.onClickPlay())},onClickPlay:function(){ig.game.goToLevel("Gameplay")},timer:1,draw:function(){this.parent();var b=ig.system.context;b.clearRect(0,0,ig.system.width,
ig.system.height);ig.ua.mobile&&(this.timer-=ig.system.tick/2,0>this.timer&&(this.timer=1),b.save(),b.fillStyle="rgba(255,255,255,0.2)",0.5>this.timer?b.fillRect(0,0,ig.system.width/2,ig.system.height):b.fillRect(ig.system.width/2,0,ig.system.width/2,ig.system.height),b.restore())}})});ig.baked=!0;ig.module("game.levels.tutorial").requires("impact.image","game.entities.controllers.tutorial-controller").defines(function(){LevelTutorial={entities:[{type:"EntityTutorialController",x:0,y:0}],layer:[]}});
ig.baked=!0;
ig.module("game.scene3d.utils.camera-control").defines(function(){ig.cameraControl={camera:null,targetMesh:null,zero:null,light:null,tempVec1:null,tempVec2:null,tempVec3:null,targetRelativePosition:null,isFrozen:!1,targetFov:1.6,fovAim:0.5,fovRelaxing:0.8,init:function(){var b=ig.altBabylon.scene;b.clearColor.set(248/255,200/255,92/255,1);this.light=b.getLightByName("Light");this.light.intensity=1;this.light.diffuse=new BABYLON.Color3(0.5,0.5,0.5);this.camera=b.getCameraByName("Camera");this.zero=
new BABYLON.Vector3(0,0,0);this.targetRelativePosition=new BABYLON.Vector3(0,0,-10);this.camera.minZ=0;this.camera.maxZ=2E3;this.camera.fov=0.8;this.zero=new BABYLON.Vector3(0,0,0);this.tempVec1=new BABYLON.Vector3(0,0,0);this.tempVec2=new BABYLON.Vector3(0,0,0);this.tempVec3=new BABYLON.Vector3(0,0,0);this.pointCameraToVec3(new BABYLON.Vector3(0,20,0),0,!0)},turnSpeed:0,turnAcc:10,update:function(){this.targetMesh&&this.pointCameraToTarget();this.camera.fov!=this.targetFov&&(this.camera.fov+=(this.targetFov-
this.camera.fov)/10,0.03>Math.abs(this.camera.fov-this.targetFov)&&(this.camera.fov=this.targetFov))},followMesh:function(b){this.targetMesh=b},unfollowMesh:function(){this.targetMesh=null},reset:function(){this.camera.position.set(0,20,20);this.camera.setTarget(new BABYLON.Vector3(0,0,50));this.light.position.set(this.camera.position.x,this.camera.position.y+10,this.camera.position.z)},pointCameraToTarget:function(b){this.pointCameraToVec3(this.targetMesh.position,0,b)},pointCameraToVec3:function(b,
c,e){c=this.tempVec1;c.copyFrom(this.camera.target);e?(c.x=b.x,c.y=b.y,c.z=b.z):(c.x+=(b.x-c.x)/10,c.y+=(b.y-c.y)/10,c.z+=(b.z-c.z)/10);this.camera.position.set(c.x+this.targetRelativePosition.x,c.y+this.targetRelativePosition.y,c.z+this.targetRelativePosition.z);this.camera.setTarget(c)}}});ig.baked=!0;
ig.module("game.scene3d.utils.mesh-manager").defines(function(){ig.meshManager={ground:null,target:null,bow:null,arrowTip:null,arrowBody:null,crosshairPoint:null,treeLineDistance:450,targetDistance:350,targetHeight:20,targetRadius:8,windIndicator:null,init:function(){this.initGround();this.initTarget();this.initArrow();this.initBow();setTimeout(function(){ig.altBabylon.scene.getMaterialByName("default material")&&(ig.altBabylon.scene.getMaterialByName("default material").disableLighting=!0)}.bind(this),
200)},initGround:function(){var b=ig.altBabylon.scene;this.groundMaterial=new BABYLON.StandardMaterial("groundMaterial",b);this.groundMaterial.emissiveColor=BABYLON.Color3.FromHexString("#fa9368");this.groundMaterial.ambientColor=BABYLON.Color3.FromHexString("#fa9368");this.groundMaterial.diffuseColor=BABYLON.Color3.FromHexString("#fa9368");this.ground=BABYLON.MeshBuilder.CreateGround("ground",{width:5E3,height:5E3},b);this.ground.position.set(0,0,0);this.ground.material=this.groundMaterial;this.stripes=
[];this.stripeMaterial=new BABYLON.StandardMaterial("stripeMaterial",b);this.stripeMaterial.emissiveColor=BABYLON.Color3.FromHexString("#ffba9d");this.stripeMaterial.ambientColor=BABYLON.Color3.FromHexString("#ffba9d");this.stripeMaterial.diffuseColor=BABYLON.Color3.FromHexString("#ffba9d");for(var c=0;c<this.treeLineDistance+100;c+=80){var e=BABYLON.MeshBuilder.CreateBox("stripe",{width:200,height:1,depth:40},b);e.position.set(0,0,c);e.material=this.stripeMaterial;e.convertToFlatShadedMesh();this.stripes.push(e)}this.trees=
[];this.treeMaterial=new BABYLON.StandardMaterial("treeMaterial",b);this.treeMaterial.emissiveColor=BABYLON.Color3.FromHexString("#c5440f");this.treeMaterial.ambientColor=BABYLON.Color3.FromHexString("#c5440f");this.treeMaterial.diffuseColor=BABYLON.Color3.FromHexString("#c5440f");this.treeWoodMaterial=new BABYLON.StandardMaterial("treeWoodMaterial",b);this.treeWoodMaterial.emissiveColor=BABYLON.Color3.FromHexString("#3b1d10");this.treeWoodMaterial.ambientColor=BABYLON.Color3.FromHexString("#3b1d10");
this.treeWoodMaterial.diffuseColor=BABYLON.Color3.FromHexString("#3b1d10");b=BABYLON.MeshBuilder.CreateBox("tree",{width:5,height:10,depth:5},b);b.material=this.treeWoodMaterial;c=BABYLON.MeshBuilder.CreateCylinder("treeBody",{diameterTop:10,diameterBottom:30,height:80});c.position.y=45;c.material=this.treeMaterial;b.addChild(c);b.position.set(0,5,-this.treeLineDistance);e=!0;for(c=-200;200>c;c+=20){var d=b.clone("treeInstance");d.position.x=c;d.position.z=this.treeLineDistance;e?e=!1:(d.position.z+=
50,e=!0);d.scaling.y=ig.random.float(1,1.3);this.trees.push(d)}for(c=0;c<this.treeLineDistance;c+=20){d=b.clone("treeInstance");d.position.x=-100;d.position.z=c;e?e=!1:(d.position.x-=50,e=!0);var j=b.clone("treeInstance");j.position.x=100;j.position.z=c;e&&(j.position.x+=50);d.scaling.y=ig.random.float(1,1.3);j.scaling.y=ig.random.float(1,1.3)}},initTarget:function(){var b=ig.altBabylon.scene;this.targetDynamicTexture=new BABYLON.DynamicTexture("targetTexture",512,b,!0);this.targetTextureHasDrawn=
!1;this.targetMaterial=new BABYLON.StandardMaterial("targetMaterial",b);this.targetMaterial.emissiveTexture=this.targetDynamicTexture;this.targetMaterial.diffuseTexture=this.targetDynamicTexture;this.targetMaterial.opacityTexture=this.targetDynamicTexture;var c=[new BABYLON.Vector4(0,0,1,1),new BABYLON.Vector4(0,0,0.01,0.01),new BABYLON.Vector4(0,0,1,1)],e=[BABYLON.Color4.FromHexString("#a60000ff"),BABYLON.Color4.FromHexString("#a60000ff"),BABYLON.Color4.FromHexString("#ffffa6ff")];this.target=BABYLON.MeshBuilder.CreateCylinder("target",
{diameter:2*this.targetRadius,height:3,tessellation:64,faceUV:c,faceColors:e},b);this.target.position.set(0,this.targetHeight,this.targetDistance);this.target.rotation.set(-Math.PI/2,0,0);this.target.material=this.targetMaterial},initArrow:function(){var b=ig.altBabylon.scene;this.arrowTip=BABYLON.MeshBuilder.CreateSphere("arrowTip",{diameter:0.1},b);this.arrowTip.position.set(0,20,0);this.arrowBody=BABYLON.MeshBuilder.CreateBox("arrowBody",{width:0.1,height:0.1,depth:15},b);this.arrowBody.position.set(0,
20,-7.5);this.arrowTip.addChild(this.arrowBody);this.aftershotCamPos=BABYLON.MeshBuilder.CreateSphere("arrowTip",{diameter:0.1},b);this.aftershotCamPos.position.copyFrom(this.target.position);this.aftershotCamPos.position.x-=5;this.aftershotCamPos.position.y+=5;this.aftershotCamPos.position.z-=15;this.aftershotCamPos.isVisible=!1;this.crosshairPoint=BABYLON.MeshBuilder.CreateSphere("crosshairPoint",{diameter:0.1},b);this.crosshairPoint.position.copyFrom(this.target.position);this.crosshairPoint.isVisible=
!1},initBow:function(){},initWindIndicator:function(){var b=ig.altBabylon.scene;this.screenCorner=BABYLON.MeshBuilder.CreateBox("screenCorner",{width:0.5,height:0.5,depth:0.5},b);this.screenCorner.setPivotMatrix(BABYLON.Matrix.Translation(0.5,0.15,1),!1);var c=BABYLON.MeshBuilder.CreateGround("windPlane",{width:2,height:2},b);c.material=new BABYLON.StandardMaterial("WindIndicatorMat",b);c.material.emissiveColor=new BABYLON.Color3(1,1,1);c.material.disableLighting=!0;this.windIndicatorTexture=new BABYLON.DynamicTexture("windPlaneTexture",
512,b,!0);c.material.diffuseTexture=this.windIndicatorTexture;c.material.opacityTexture=this.windIndicatorTexture;this.windIndicatorTextureHasDrawn=c.material.backFaceCulling=!1;this.cornerOffset=new BABYLON.TransformNode("screenCornerOffset");this.windIndicator=new BABYLON.TransformNode("windIndicator");this.windIndicator.parent=this.screenCorner;c.parent=this.screenCorner;this.windIndicator.scaling.set(0.01,0.01,0.01)},update:function(){if(!this.targetTextureHasDrawn){var b=new ig.Image("media/graphics/game/target.png");
b.loaded&&(this.targetDynamicTexture.getContext().drawImage(b.data,0,0),this.targetDynamicTexture.update(),this.targetTextureHasDrawn=!0,console.log("targetDrawn"))}},setPosition:function(b,c,e,d,j,f,n){d/=n;n=e/n;b=b?-1+2*d:1-2*n-2*d;e=new BABYLON.Vector3(-1,-1,-0.9999);n=new BABYLON.Vector3(-1+2*n,-1,-0.9999);d=BABYLON.Vector3.TransformCoordinates(e,f);n=BABYLON.Vector3.TransformCoordinates(n,f).subtract(d).length();c.scaling=new BABYLON.Vector3(n,n,n);e.x=b;c.rotation.copyFrom(j.rotation);c.position=
BABYLON.Vector3.TransformCoordinates(e,f)},normalize2:function(b,c,e){var d=Math.sqrt(b*b+c*c);return{x:e*b/d,y:e*c/d}},getCenterVec3:function(b,c){var e=new BABYLON.Vector3(0,0,0);e.x=(b.x+c.x)/2;e.y=(b.y+c.y)/2;e.z=(b.z+c.z)/2;return e},normalizeYToCenter:function(b,c,e,d){var j=b.x-c,f=b.z-e,n=Math.sqrt(j*j+f*f);b.x=d*j/n+c;b.z=d*f/n+e},rotateOnYAxis:function(b,c,e,d){var j=Math.sin(d);d=Math.cos(d);b.x=(b.x-c)*d-(b.z-e)*j+c;b.z=(b.x-c)*j+(b.z-e)*d+e}}});ig.baked=!0;
ig.module("game.scene3d.objects.mesh-object").defines(function(){ig.MeshObject=ig.Class.extend({mesh:null,timedLife:-1,init:function(b,c,e,d,j,f){j?(this.mesh=d.clone("clonedMesh"),this.mesh.sourceName=d.name):this.mesh=f?d.createInstance("meshInstance"):d;this.mesh.position.set(b,c,e)},update:function(b){0<this.timedLife&&(this.timedLife-=b,0>=this.timedLife&&this.destroy())},destroy:function(){this.mesh.dispose()}})});ig.baked=!0;
ig.module("game.scene3d.objects.arrow").requires("game.scene3d.objects.mesh-object").defines(function(){ig.Arrow=ig.MeshObject.extend({isFlying:!1,gravity:null,speed:null,wind:null,lookTarget:null,aftershotTarget:null,arrowPower:200,arrowBody:null,isAiming:!1,isRelaxing:!1,onLanded:null,launchNextFrame:!1,resetNextFrame:!1,onTarget:!1,difficulty:0,init:function(){this.parent(0,0,0,ig.meshManager.arrowTip,!1,!1);this.speed=new BABYLON.Vector3(0,0,0);this.wind=new BABYLON.Vector3(1,0,0);this.lookTarget=
new BABYLON.Vector3(0,0,0);this.aftershotTarget=new BABYLON.Vector3(0,0,0);this.gravity=new BABYLON.Vector3(0,-10,0);this.arrowBody=ig.meshManager.arrowBody;this.reset();this.onLanded=new ig.Signal},resetDifficulty:function(){this.difficulty=0;this.wind.set(0,0,0)},increaseDifficulty:function(){this.difficulty++;var b=2*this.difficulty;20<b&&(b=20);b=0.25*ig.random.int(-b,b);this.wind.x=b;console.log("windSpeed",b.toFixed(2))},isHitTarget:function(){var b=ig.meshManager.target,c=this.mesh;if(this.mesh.intersectsMesh(ig.meshManager.target)){var e=
c.position.x-b.position.x,b=c.position.y-b.position.y;return e*e+b*b<=ig.meshManager.targetRadius*ig.meshManager.targetRadius}return!1},isHitPost:function(){for(var b=0;b<ig.babylonSceneController.postLines.length;b++)if(this.mesh.intersectsMesh(ig.babylonSceneController.postLines[b]))return!0;return!1},isHitTrees:function(){for(var b=0;b<ig.meshManager.trees.length;b++){var c=ig.meshManager.trees[b];if(this.mesh.intersectsMesh(c)||(c=c.getChildren())&&0<c.length&&this.mesh.intersectsMesh(c[0]))return!0}return!1},
calculateScore:function(){var b=ig.meshManager.target,c=this.mesh,e=c.position.x-b.position.x,b=c.position.y-b.position.y,e=Math.sqrt(e*e+b*b),e=Math.floor(10*(1-e/ig.meshManager.targetRadius))+1;0>e&&(e=0);this.lastScore=e},update:function(b){this.parent(b);if(this.isFlying){var c=this.mesh;this.speed.x+=(this.gravity.x+this.wind.x)*b;this.speed.y+=(this.gravity.y+this.wind.y)*b;this.speed.z+=(this.gravity.z+this.wind.z)*b;c.position.x+=this.speed.x*b;c.position.y+=this.speed.y*b;c.position.z+=this.speed.z*
b;this.lookTarget.set(this.speed.x+c.position.x,this.speed.y+c.position.y,this.speed.z+c.position.z);c.lookAt(this.lookTarget);b=this.isHitTarget();var c=0>this.mesh.position.y,e=this.isHitPost(),d=this.isHitTrees();if(b||c||e||d)b&&(this.onTarget=!0),ig.babylonSceneController.targetAllowMove=!1,this.calculateScore(),this.isFlying=!1,setTimeout(function(){ig.cameraControl.unfollowMesh();this.aftershotTarget.copyFrom(this.mesh.position);this.toAftershotCam=!0;console.log("arrowLanded")}.bind(this),
1E3)}else if(this.isAiming||this.isRelaxing)this.mesh.position.x+=(ig.cameraControl.camera.position.x+1-this.mesh.position.x)/2,this.mesh.position.y+=(ig.cameraControl.camera.position.y-2-this.mesh.position.y)/2,this.mesh.position.z+=(ig.cameraControl.camera.position.z+10-this.mesh.position.z)/2;this.toAftershotCam&&(b=ig.cameraControl.camera,c=this.aftershotTarget.y+5,e=this.aftershotTarget.z-30,b.position.x+=(this.aftershotTarget.x-5-b.position.x)/20,b.position.y+=(c-b.position.y)/20,b.position.z+=
(e-b.position.z)/20,b.target.x=this.aftershotTarget.x,b.target.y=this.aftershotTarget.y,b.target.z=this.aftershotTarget.z,b.setTarget(b.target),0.1>Math.abs(b.position.z-e)&&(this.toAftershotCam=!1,this.onLanded.dispatch()));this.launchNextFrame&&(this.launch(),this.launchNextFrame=!1);this.resetNextFrame&&(ig.cameraControl.unfollowMesh(),b=ig.cameraControl.camera,b.position.x+=(0-b.position.x)/10,c=(ig.meshManager.targetHeight-b.position.y)/20,this.aftershotTarget.z>ig.meshManager.targetDistance+
10&&b.position.z>0.001*ig.meshManager.targetDistance&&(c=(2*ig.meshManager.targetHeight-b.position.y)/2),b.position.y+=c,c=(-10-b.position.z)/10,-5>c&&(c=-5),b.position.z+=c,0.1>Math.abs(b.position.x)&&(b.position.x=0),c=ig.meshManager.targetHeight,e=ig.meshManager.targetDistance,b.target.x+=(0-b.target.x)/2,b.target.y+=(c-b.target.y)/2,b.target.z+=(e-b.target.y)/2,this.aftershotTarget.z>e&&-9.9<b.position.z&&(b.target.z=this.aftershotTarget.z),b.setTarget(b.target),-9.998>=b.position.z&&0.02>Math.abs(ig.meshManager.targetHeight-
b.position.y)&&(this.resetNextFrame=!1,this.reset()))},reset:function(){this.onTarget&&ig.babylonSceneController.nextTargetMovement();this.isFlying=this.toAftershotCam=this.resetNextFrame=this.launchNextFrame=!1;this.isRelaxing=!0;this.isAiming=!1;this.mesh.position.set(1,ig.meshManager.targetHeight-2,-50);this.mesh.rotation.set(0,0,0);ig.cameraControl.targetRelativePosition.set(0,0,-ig.meshManager.targetDistance-10);ig.cameraControl.followMesh(ig.meshManager.crosshairPoint);ig.cameraControl.pointCameraToTarget(!0);
this.mesh.isVisible=!0;ig.meshManager.target.isVisible=!0;ig.babylonSceneController.targetAllowMove=!0;this.onTarget=!1;console.log("reset")},setMainMenu:function(){this.reset();this.mesh.isVisible=!1;ig.meshManager.target.isVisible=!1},launch:function(){this.onTarget=!1;this.isFlying=!0;this.isRelaxing=!1;this.mesh.position.x=ig.cameraControl.camera.position.x;this.mesh.position.y=ig.cameraControl.camera.position.y;this.speed.set(0,-this.gravity.y*((ig.meshManager.targetDistance-this.mesh.position.z)/
this.arrowPower/2),this.arrowPower);ig.cameraControl.targetRelativePosition.set(-1,1,-10);ig.cameraControl.followMesh(this.mesh);ig.cameraControl.pointCameraToTarget(!0)}})});ig.baked=!0;
ig.module("game.scene3d.babylon-scene-controller").requires("game.scene3d.utils.camera-control","game.scene3d.utils.mesh-manager","game.scene3d.objects.arrow").defines(function(){ig.babylonSceneController={hasInitialized:!1,paused:!1,player:null,dtAccumulator:0,arrow:null,shadowGenerator:null,targetAllowMove:!0,targetMovementId:0,targetMovementWaypoints:null,targetMovementTime:0,targetMovementSize:0,targetMovementDuration:0,postLines:[],init:function(){console.log("WebGL Version",ig.altBabylon.engine.webGLVersion);
this.initTargetMovementWaypoints();ig.meshManager.init();ig.cameraControl.init();ig.showStats=!1;this.arrow=new ig.Arrow;ig.altBabylon.onUpdate.add(this.update.bind(this));this.paused=this.hasInitialized=!0;this.reset();this.setTargetMovement(0,10,10)},nextTargetMovement:function(){var b=this.targetMovementId+1,c=this.targetMovementSize+5,e=this.targetMovementDuration;b>=this.targetMovementWaypoints.length&&(b=0);40<c&&(c=20,e--,4>e&&(e=4));this.setTargetMovement(b,c,e)},reset:function(){this.arrow.reset()},
initDebug:function(){ig.debug&&(ig.sceneInstrumentation=new BABYLON.SceneInstrumentation(ig.altBabylon.scene),ig.sceneInstrumentation.captureActiveMeshesEvaluationTime=!0,ig.sceneInstrumentation.captureRenderTargetsRenderTime=!0,ig.sceneInstrumentation.captureDrawCalls=!0,ig.sceneInstrumentation.captureFrameTime=!0,ig.sceneInstrumentation.captureRenderTime=!0,ig.sceneInstrumentation.captureCameraRenderTime=!0)},update:function(b){!this.paused&&this.hasInitialized&&(ig.cameraControl.update(b),ig.meshManager.update(b),
this.arrow.update(b),this.updateTarget(b))},updateTarget:function(){var b=ig.meshManager.target;if(0==this.targetMovementId)b.position.x=0,b.position.y=ig.meshManager.targetHeight;else if(this.targetAllowMove){var c=this.targetMovementTime/this.targetMovementDuration;1<=c?(this.targetMovementTime=0,c=1):this.targetMovementTime+=ig.system.tick;var e=this.targetMovementWaypoints[this.targetMovementId],d=1/e.length,j=Math.floor(c/d),d=(c-j*d)/d,f=e[j],n=j<e.length-1?e[j+1]:e[0];1==c&&(f=e[j-1],n=e[0],
d=1);c=(1-d)*f.y*this.targetMovementSize+d*n.y*this.targetMovementSize+ig.meshManager.targetHeight;b.position.x=(1-d)*f.x*this.targetMovementSize+d*n.x*this.targetMovementSize+0;b.position.y=c}},setTargetMovement:function(b,c,e){this.targetMovementDuration=e;this.targetMovementSize=c;this.targetMovementId=b;this.targetMovementTime=0;this.buildPostLines(b,c)},buildPostLines:function(b,c){this.postLines||(this.postLines=[]);for(;0<this.postLines.length;)this.postLines.pop().dispose();for(var e=this.targetMovementWaypoints[b],
d=ig.meshManager.targetHeight,j=0;j<e.length;j++){var f=e[j],n=f.x*c+0,l=f.y*c+d,f=j<e.length-1?e[j+1]:e[0],g=f.x*c+0,m=f.y*c+d,f=g-n,p=m-l,r=Math.sqrt(f*f+p*p),g=(g+n)/2,m=(m+l)/2,r=BABYLON.MeshBuilder.CreateBox("post",{width:r,height:3,depth:3},ig.altBabylon.scene);r.position.x=g;r.position.y=m;r.position.z=ig.meshManager.targetDistance+3;r.rotation.z=Math.atan2(p,f);f=BABYLON.MeshBuilder.CreateSphere("point",{diameter:3,segments:8},ig.altBabylon.scene);f.position.x=n;f.position.y=l;f.position.z=
r.position.z;this.postLines.push(r);this.postLines.push(f)}e=this.findCenterPostHeight(b,c);d=BABYLON.MeshBuilder.CreateBox("post",{width:3,height:e,depth:3},ig.altBabylon.scene);d.position.x=0;d.position.y=e/2;d.position.z=ig.meshManager.targetDistance+3;this.postLines.push(d);console.log("centerpostHeight:",e)},findCenterPostHeight:function(b,c){if(0==b)return ig.meshManager.targetHeight;for(var e=this.targetMovementWaypoints[b],d=ig.meshManager.targetHeight,j=9999999999,f=0;f<e.length;f++)for(var n=
e[f],l=n.x*c+0,g=n.y*c+d,n=f<e.length-1?e[f+1]:e[0],m=n.x*c+0,n=n.y*c+d,p=0;1>p;p+=0.01){var r=(1-p)*g+p*n;0.5>Math.abs((1-p)*l+p*m)&&r<j&&(j=r)}return j},initTargetMovementWaypoints:function(){this.targetMovementWaypoints=[[{x:0,y:0}],[{x:0,y:0},{x:1,y:0},{x:0,y:0},{x:-1,y:0}],[{x:0,y:0},{x:-1,y:1},{x:1,y:1}],[{x:0,y:0},{x:-1,y:0},{x:-1,y:1},{x:0,y:1},{x:1,y:1},{x:1,y:0}],[{x:0,y:0},{x:1,y:1},{x:0,y:2},{x:-1,y:1}],[{x:-2,y:0},{x:-1,y:1},{x:0,y:0},{x:1,y:1},{x:2,y:0},{x:1,y:1},{x:0,y:0},{x:-1,y:1}],
[{x:0,y:0},{x:1,y:0},{x:-1,y:2},{x:1,y:2},{x:-1,y:0}],[{x:-1,y:0},{x:1,y:1},{x:1,y:0},{x:-1,y:1}],[{x:0,y:0},{x:1,y:1},{x:-1,y:3},{x:0,y:4}],[{x:0,y:0},{x:1,y:1},{x:-1,y:3},{x:0,y:4},{x:1,y:3},{x:-1,y:1}],[{x:0,y:0.224},{x:0.309,y:0},{x:0.202,y:0.378},{x:0.5,y:0.618},{x:0.125,y:0.628},{x:0,y:1},{x:-0.125,y:0.628},{x:-0.5,y:0.618},{x:-0.202,y:0.378},{x:-0.309,y:0}]];this.basePostHeight=[]}}});ig.baked=!0;
ig.module("game.toybox.utils.tween-patch").requires("plugins.tween").defines(function(){ig.Entity.prototype.delayedCall=function(b,c,e){void 0===e&&(e=!0);b=new ig.Tween(this,{},b,{onComplete:c});this.tweens.push(b);e&&b.start();return b}});ig.baked=!0;
ig.module("game.toybox.objects.ui.texts.text-renderer").requires("impact.impact").defines(function(){ig.TextRenderer=ig.Class.extend({text:"",font:"48px Arial",color:"#000000",alpha:1,align:"start",offsetX:0,offsetY:0,lineSpacing:1,valign:"default",enableShadow:!1,shadowColor:"#000000",shadowOffsetX:0,shadowOffsetY:4,shadowAlpha:1,outlineWeight:0,outlineColor:"#000000",outlineCap:"square",outlineJoin:"bevel",_previousText:"",_multiline:!1,_lines:[],_lineHeightInPixel:0,init:function(){},draw:function(b,
c){void 0===b&&(b=0);void 0===c&&(c=0);this.enableShadow&&this.drawText(b+this.shadowOffsetX,c+this.shadowOffsetY,this.shadowAlpha*this.alpha,this.shadowColor,this.shadowColor);this.drawText(b,c,this.alpha,this.color,this.outlineColor)},drawText:function(b,c,e,d,j){if(0<this.text.length){this._previousTextString!=this.text&&(this._previousTextString=this.text,this._lines=this.text.split(/\r?\n/),this._multiline=1<this._lines.length?!0:!1,this._lineHeightInPixel=parseInt(this.font.split("px")[0].split(" ").pop())*
this.lineSpacing,isNaN(this._lineHeightInPixel)&&console.error("'"+this.font+"' is a wrong font string format, error when rendering "+this.text));var f=ig.system.context;f.save();f.font=this.font;f.textAlign=this.align;f.lineWidth=2*this.outlineWeight;f.lineCap=this.outlineCap;f.lineJoin=this.outlineJoin;f.miterLimit=2*this.outlineWeight;1>e?(d=ig.hexToRgb(d),f.fillStyle="rgba("+d.r+","+d.g+","+d.b+","+e+")",d=ig.hexToRgb(j),f.strokeStyle="rgba("+d.r+","+d.g+","+d.b+","+e+")"):(f.fillStyle=d,f.strokeStyle=
j);b+=this.offsetX;e=c+this.offsetY;if(this._multiline){c=e;"center"==this.valign&&(c=e-(this._lines.length-1)*this._lineHeightInPixel/2);for(e=0;e<this._lines.length;e++)j=this._lines[e],0<this.outlineWeight&&f.strokeText(j,b,c+e*this._lineHeightInPixel),f.fillText(j,b,c+e*this._lineHeightInPixel)}else"center"==this.valign&&(e+=this._lineHeightInPixel/2),0<this.outlineWeight&&f.strokeText(this.text,b,e),f.fillText(this.text,b,e);f.restore()}},measureTextWidth:function(){var b=ig.system.context;b.save();
b.font=this.font;b.textAlign="left";var c=b.measureText(this.text);b.restore();return c.width}})});ig.baked=!0;
ig.module("game.toybox.utils.random").defines(function(){ig.random={chance:function(b){return Math.random()<b},bool:function(){return 0.5>Math.random()},"int":function(b,c){return b+Math.floor((c-b+1)*Math.random())},"float":function(b,c){return b+(c-b)*Math.random()},string:function(b,c){void 0===c&&(c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789");for(var e="",d=0;d<b;d++)e+=c.charAt(Random.int(0,c.length-1));return e},fromArray:function(b){return null!=b&&0<b.length?b[this.int(0,
b.length-1)]:null},shuffle:function(b){if(null!=b)for(var c=0;c<b.length;c++){var e=this.int(0,b.length-1),d=b[c];b[c]=b[e];b[e]=d}return b}}});ig.baked=!0;
ig.module("game.toybox.utils.signal").requires("impact.impact").defines(function(){ig.Signal=ig.Class.extend({signalListeners:null,id:0,init:function(){this.id=++ig.Signal._lastId;this.signalListeners=[]},addOnce:function(b,c){this.signalListeners.push({signalListener:b,signalContext:c,isOnce:!0})},add:function(b,c){this.signalListeners.push({signalListener:b,signalContext:c,isOnce:!1})},dispatch:function(){for(var b=0;b<this.signalListeners.length;){var c=this.signalListeners[b];c.signalListener.apply(c.signalContext,
arguments);c.isOnce?this.signalListeners.splice(b,1):b++}}});ig.Signal._lastId=0});ig.baked=!0;
ig.module("game.toybox.utils.toybox-touch").requires("impact.impact").defines(function(){ig.ToyboxTouch={hasInitialized:!1,touches:[],mouseX:0,mouseY:0,init:function(){ig.ua.touchDevice&&(window.navigator.msPointerEnabled&&(ig.system.canvas.addEventListener("MSPointerDown",this.touchDown.bind(this),!1),ig.system.canvas.addEventListener("MSPointerUp",this.touchUp.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",this.touchMove.bind(this),!1),ig.system.canvas.style.msContentZooming="none",
ig.system.canvas.style.msTouchAction="none"),ig.system.canvas.addEventListener("touchstart",this.touchDown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.touchUp.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.touchMove.bind(this),!1));ig.system.canvas.addEventListener("mousemove",this.mouseMove.bind(this),!1);this.hasInitialized=!0},mouseMove:function(b){var c=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth,e=parseInt(ig.system.canvas.offsetHeight)||
ig.system.realHeight;this.scaleX=ig.system.scale*(c/ig.system.realWidth);this.scaleY=ig.system.scale*(e/ig.system.realHeight);c={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(c=ig.system.canvas.getBoundingClientRect());this.mouseX=(b.clientX-c.left)/this.scaleX;this.mouseY=(b.clientY-c.top)/this.scaleY},touchDown:function(b){this.processTouch(b.touches)},touchUp:function(b){this.processTouch(b.touches)},touchMove:function(b){this.processTouch(b.touches)},processTouch:function(b){var c=parseInt(ig.system.canvas.offsetWidth)||
ig.system.realWidth,e=parseInt(ig.system.canvas.offsetHeight)||ig.system.realHeight;this.scaleX=ig.system.scale*(c/ig.system.realWidth);this.scaleY=ig.system.scale*(e/ig.system.realHeight);c={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(c=ig.system.canvas.getBoundingClientRect());this.touches=[];for(e=0;e<b.length;e++){var d=b[e];this.touches.push({x:(d.clientX-c.left)/this.scaleX,y:(d.clientY-c.top)/this.scaleY})}}}});ig.baked=!0;
ig.module("game.toybox.babylon.alt-babylon").defines(function(){ig.altBabylon={onSceneLoaded:null,onUpdate:null,scene:null,engine:null,canvas:null,canvasId:null,loadScene:function(b,c,e){this.scene&&this.scene.dispose();this.scene=null;this.onSceneLoaded=new ig.Signal;this.onUpdate=new ig.Signal;BABYLON.Engine.isSupported()&&(this.engine||(e?this.canvasId=e:this.canvasId||(this.canvasId="webgl"),this.canvas=ig.$(e),this.engine=new BABYLON.Engine(this.canvas,!1),this.runEngineLoop()),BABYLON.SceneLoader.ShowLoadingScreen=
!1,BABYLON.SceneLoader.Load(b,c,this.engine,this.onLoadSuccess.bind(this),null,this.onLoadError.bind(this)));return this},stopEngineLoop:function(){this.engine.stopRenderLoop()},runEngineLoop:function(){this.engine.runRenderLoop(ig.altBabylon.loop.bind(ig.altBabylon))},loop:function(){if(this.scene){if(this.onUpdate){var b=this.engine.getDeltaTime()/1E3;this.onUpdate.dispatch(b)}this.scene.render()}},onLoadSuccess:function(b){this.scene=b;this.onSceneLoaded.dispatch()},onLoadError:function(b,c,e){console.log("ERROR LOADING SCENE");
console.log(b);console.log(c);console.log(e)}}});ig.baked=!0;
ig.module("game.toybox.utils.uv-frame-animator").requires("impact.impact").defines(function(){ig.UVFrameAnimator=ig.Class.extend({texture:null,gridX:7,gridY:4,frameOffsetX:0,frameOffsetY:0.14,currentFrame:0,currentAnim:null,animations:[],init:function(b,c,e,d,j){this.texture=b;this.gridX=e;this.gridY=c;this.frameOffsetX=d;this.frameOffsetY=j;this.texture.uScale=1/this.gridX;this.texture.vScale=1/this.gridY;this.setFrame(0)},setFrame:function(b){if(0<=b){var c=this.gridX*this.gridY-1;b>c?(console.warn("Sprite frame index out of bound : ",
b),b=c):0>b&&(console.warn("Sprite frame index out of bound : ",b),b=0);this.currentFrame!=b&&(this.currentFrame=b,b=c-b,c=Math.floor(b/this.gridX),this.texture.uOffset=(this.gridX-b%this.gridX-1)*this.texture.uScale+this.texture.uScale*this.frameOffsetX,this.texture.vOffset=c*this.texture.vScale+this.texture.vScale*this.frameOffsetY)}else console.warn("Invalid frame index : ",b)},addAnimation:function(b,c,e,d){this.animations.push({name:b,frames:c,fps:e,loop:d,frameTime:0,frameIndex:0,frameTimeMax:1/
e,isFinished:!1})},playAnimation:function(b,c){if(!this.currentAnim||c||this.currentAnim.name!=b){for(var e=0;e<this.animations.length;e++)if(this.animations[e].name==b){this.playAnimationIndex(e);return}console.warn("Play animation failed, animation name not found  : ",b)}},playAnimationIndex:function(b){b>=this.animations.length||0>b?console.warn("Play animation failed, animation index out of found  : ",b):(this.currentAnim=this.animations[b],this.currentAnim.frameIndex=0,this.currentAnim.frameTime=
0,this.currentAnim.isFinished=!1)},update:function(b){this.currentAnim&&!this.currentAnim.isFinished&&(this.currentAnim.frameTime+=b,this.currentAnim.frameTime>=this.currentAnim.frameTimeMax&&(this.currentAnim.frameTime-=this.currentAnim.frameTimeMax,this.currentAnim.frameIndex++,this.currentAnim.frameIndex>=this.currentAnim.frames.length&&(this.currentAnim.loop?this.currentAnim.frameIndex=0:this.currentAnim.isFinished=!0)),this.currentAnim.isFinished||this.setFrame(this.currentAnim.frames[this.currentAnim.frameIndex]))}})});
ig.baked=!0;
ig.module("game.toybox.content").requires("impact.entity","game.toybox.utils.tween-patch","game.toybox.controllers.controller","game.toybox.objects.game-object","game.toybox.objects.ui.texts.text-field","game.toybox.objects.ui.texts.text-renderer","game.toybox.objects.ui.buttons.simple-button","game.toybox.utils.random","game.toybox.utils.signal","game.toybox.utils.toybox-touch","game.toybox.babylon.alt-babylon","game.toybox.utils.uv-frame-animator").defines(function(){setTimeout(function(){console.log("toybox 0.4.5");ig.ToyboxTouch.init()},
1E3);ig.drawRoundRect=function(b,c,e,d,j,f,n,l){"undefined"==typeof l&&(l=!0);"undefined"===typeof f&&(f=5);b.beginPath();b.moveTo(c+f,e);b.lineTo(c+d-f,e);b.quadraticCurveTo(c+d,e,c+d,e+f);b.lineTo(c+d,e+j-f);b.quadraticCurveTo(c+d,e+j,c+d-f,e+j);b.lineTo(c+f,e+j);b.quadraticCurveTo(c,e+j,c,e+j-f);b.lineTo(c,e+f);b.quadraticCurveTo(c,e,c+f,e);b.closePath();l&&b.stroke();n&&b.fill()};ig.hexToRgb=function(b){ig.hexToRgbTable||(ig.hexToRgbTable={});if(ig.hexToRgbTable[b])return ig.hexToRgbTable[b];
var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);if(c)return ig.hexToRgbTable[b]={r:parseInt(c[1],16),g:parseInt(c[2],16),b:parseInt(c[3],16),hex:b},ig.hexToRgbTable[b];console.log("cannot convert to rgb from hex :",b);return null};ig.utils={};ig.utils.normalize2=function(b,c,e){var d=Math.sqrt(b*b+c*c);return{x:e*b/d,y:e*c/d}};ig.utils.lerp=function(b,c,e){return(1-e)*b+e*c};ig.utils.lerpDt=function(b,c,e){return this.lerp(b,c,e*ig.system.tick)};ig.utils.lerpPerfectDt=function(b,c,e,d,j){j||
(j=0.01);if(Math.abs(b-c)<j)return c;e=1-Math.pow(e,d);return this.lerp(b,c,e)};ig.utils.setFaceDirection=function(b,c){b.rotationQuaternion||(b.rotationQuaternion=BABYLON.Quaternion.Identity());c.normalize();var e=BABYLON.Matrix.Identity(),d=BABYLON.Vector3.Up(),d=BABYLON.Vector3.Cross(c,d),j=BABYLON.Vector3.Cross(d,c);e.m[0]=d.x;e.m[1]=d.y;e.m[2]=d.z;e.m[4]=c.x;e.m[5]=c.y;e.m[6]=c.z;e.m[8]=j.x;e.m[9]=j.y;e.m[10]=j.z;BABYLON.Quaternion.FromRotationMatrixToRef(e,b.rotationQuaternion)};ig.utils.showAxis3d=
function(b){var c=wgl.game.currentScene,e=function(b,e,f){var n=new BABYLON.DynamicTexture("DynamicTexture",50,c,!0);n.hasAlpha=!0;n.drawText(b,5,40,"bold 36px Arial",e,"transparent",!0);b=new BABYLON.Mesh.CreatePlane("TextPlane",f,c,!0);b.material=new BABYLON.StandardMaterial("TextPlaneMaterial",c);b.material.backFaceCulling=!1;b.material.specularColor=new BABYLON.Color3(0,0,0);b.material.diffuseTexture=n;return b};BABYLON.Mesh.CreateLines("axisX",[new BABYLON.Vector3.Zero,new BABYLON.Vector3(b,
0,0),new BABYLON.Vector3(0.95*b,0.05*b,0),new BABYLON.Vector3(b,0,0),new BABYLON.Vector3(0.95*b,-0.05*b,0)],c).color=new BABYLON.Color3(1,0,0);e("X","red",b/10).position=new BABYLON.Vector3(0.9*b,-0.05*b,0);BABYLON.Mesh.CreateLines("axisY",[new BABYLON.Vector3.Zero,new BABYLON.Vector3(0,b,0),new BABYLON.Vector3(-0.05*b,0.95*b,0),new BABYLON.Vector3(0,b,0),new BABYLON.Vector3(0.05*b,0.95*b,0)],c).color=new BABYLON.Color3(0,1,0);e("Y","green",b/10).position=new BABYLON.Vector3(0,0.9*b,-0.05*b);BABYLON.Mesh.CreateLines("axisZ",
[new BABYLON.Vector3.Zero,new BABYLON.Vector3(0,0,b),new BABYLON.Vector3(0,-0.05*b,0.95*b),new BABYLON.Vector3(0,0,b),new BABYLON.Vector3(0,0.05*b,0.95*b)],c).color=new BABYLON.Color3(0,0,1);e("Z","blue",b/10).position=new BABYLON.Vector3(0,0.05*b,0.9*b)}});ig.baked=!0;
ig.module("plugins.fullscreen").requires("impact.entity","plugins.handlers.size-handler","plugins.director").defines(function(){ig.Fullscreen={enableFullscreenButton:!0,_isEnabled:"notChecked",isEnabled:function(){"notChecked"==this._isEnabled&&(this._isEnabled=document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled?!0:!1);return this._isEnabled},isFullscreen:function(){return ig.Fullscreen.isEnabled()&&(document.fullscreenElement||
document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)?!0:!1},toggleFullscreen:function(){ig.Fullscreen.isFullscreen()?ig.Fullscreen.exitFullscreen():ig.Fullscreen.requestFullscreen();ig.sizeHandler.orientationDelayHandler();if(ig&&ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(b){}},requestFullscreen:function(){var b=document.documentElement;b.requestFullscreen?b.requestFullscreen():b.webkitRequestFullscreen?
b.webkitRequestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.msRequestFullscreen?b.msRequestFullscreen():console.log("no request fullscreen method available")},exitFullscreen:function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():console.log("no exit fullscreen method available")},divs:{}};ig.Director.inject({loadLevel:function(b){var c=
ig.Fullscreen.divs,e;for(e in c)c=ig.domHandler.getElementById("#"+e),ig.domHandler.hide(c);return this.parent(b)}});ig.SizeHandler.inject({resize:function(){this.parent();var b=ig.Fullscreen.divs,c;for(c in b){var e=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y),d=ig.domHandler.getElementById("#"+c),j=b[c].entity_pos_x,f=b[c].entity_pos_y,n=b[c].width,l=b[c].height,g=ig.domHandler.getElementById("#canvas"),g=ig.domHandler.getOffsets(g);ig.domHandler.css(d,{"float":"left",
position:"absolute",left:Math.floor(g.left+j*e)+"px",top:Math.floor(g.top+f*e)+"px",width:Math.floor(n*e)+"px",height:Math.floor(l*e)+"px","z-index":3})}}});ig.FullscreenButton=ig.Entity.extend({enterImage:null,exitImage:null,isReady:!1,zIndex:999999,identifier:null,prevPos:{x:0,y:0},invisImagePath:"media/graphics/misc/invisible.png",init:function(b,c,e){this.parent(b,c,e);ig.Fullscreen.isEnabled()&&ig.Fullscreen.enableFullscreenButton?this.enterImage.loaded?this.initSize():this.enterImage.loadCallback=
function(){this.initSize()}.bind(this):this.kill()},kill:function(){this.parent()},destroy:function(){this.parent();console.log("destroy")},initSize:function(){this.size.x=this.enterImage.width;this.size.y=this.enterImage.height;this.createClickableLayer();this.isReady=!0},createClickableLayer:function(){this.identifier="fullscreen-button-layer";var b=ig.domHandler.getElementById("#"+this.identifier);b?(ig.domHandler.show(b),ig.domHandler.attr(b,"onclick","ig.Fullscreen.toggleFullscreen()")):this.createClickableOutboundLayer()},
update:function(b,c){this.parent();b=this.pos.x;c=this.pos.y;this.isReady&&!(this.prevPos.x==b&&this.prevPos.y==c)&&(console.log(b,c),this.prevPos.x=b,this.prevPos.y=c,ig.Fullscreen.divs[this.identifier]={},ig.Fullscreen.divs[this.identifier].width=this.size.x,ig.Fullscreen.divs[this.identifier].height=this.size.y,ig.Fullscreen.divs[this.identifier].entity_pos_x=this.pos.x,ig.Fullscreen.divs[this.identifier].entity_pos_y=this.pos.y,ig.sizeHandler.resize())},draw:function(){this.isReady&&(ig.Fullscreen.isFullscreen()?
this.exitImage.draw(this.pos.x,this.pos.y):this.enterImage.draw(this.pos.x,this.pos.y))},createClickableOutboundLayer:function(){var b=this.identifier,c=this.invisImagePath,e=ig.domHandler.create("div");ig.domHandler.attr(e,"id",b);ig.domHandler.attr(e,"onclick","ig.Fullscreen.toggleFullscreen()");var d=ig.domHandler.create("a"),j=ig.domHandler.create("img");ig.domHandler.css(j,{width:"100%",height:"100%"});ig.domHandler.attr(j,"src",c);c=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);
if(ig.ua.mobile){var f=ig.domHandler.getElementById("#canvas"),f=ig.domHandler.getOffsets(f),n=f.left,l=f.top;console.log(f.left);ig.sizeHandler.disableStretchToFitOnMobileFlag?(f=Math.floor(n+this.pos.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px",l=Math.floor(l+this.pos.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px",n=Math.floor(this.size.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px",c=Math.floor(this.size.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px"):(f=Math.floor(this.pos.x*ig.sizeHandler.sizeRatio.x)+
"px",l=Math.floor(this.pos.y*ig.sizeHandler.sizeRatio.y)+"px",n=Math.floor(this.size.x*ig.sizeHandler.sizeRatio.x)+"px",c=Math.floor(this.size.y*ig.sizeHandler.sizeRatio.y)+"px")}else f=ig.domHandler.getElementById("#canvas"),f=ig.domHandler.getOffsets(f),n=f.left,l=f.top,ig.sizeHandler.enableStretchToFitOnDesktopFlag?(f=Math.floor(n+this.pos.x*ig.sizeHandler.sizeRatio.x)+"px",l=Math.floor(l+this.pos.y*ig.sizeHandler.sizeRatio.y)+"px",n=Math.floor(this.size.x*ig.sizeHandler.sizeRatio.x)+"px",c=Math.floor(this.size.y*
ig.sizeHandler.sizeRatio.y)+"px"):(f=Math.floor(n+this.pos.x*c)+"px",l=Math.floor(l+this.pos.y*c)+"px",n=Math.floor(this.size.x*c)+"px",c=Math.floor(this.size.y*c)+"px");ig.domHandler.css(e,{"float":"left",position:"absolute",left:f,top:l,width:n,height:c,"z-index":3});ig.domHandler.addEvent(e,"mousemove",ig.input.mousemove.bind(ig.input),!1);ig.domHandler.appendChild(d,j);ig.domHandler.appendChild(e,d);ig.domHandler.appendToBody(e);ig.Fullscreen.divs[b]={};ig.Fullscreen.divs[b].width=this.size.x;
ig.Fullscreen.divs[b].height=this.size.y;ig.Fullscreen.divs[b].entity_pos_x=this.pos.x;ig.Fullscreen.divs[b].entity_pos_y=this.pos.y}})});ig.baked=!0;
ig.module("game.main").requires("impact.game","impact.debug.debug","plugins.patches.timer-patch","plugins.patches.user-agent-patch","plugins.patches.webkit-image-smoothing-patch","plugins.patches.windowfocus-onMouseDown-patch","plugins.patches.input-patch","plugins.data.vector","plugins.data.color-rgb","plugins.font.font-loader","plugins.handlers.dom-handler","plugins.handlers.size-handler","plugins.handlers.api-handler","plugins.handlers.visibility-handler","plugins.audio.sound-handler","plugins.io.io-manager",
"plugins.io.storage-manager","plugins.splash-loader","plugins.tween","plugins.tweens-handler","plugins.url-parameters","plugins.director","plugins.impact-storage","plugins.responsive.responsive-plugin","plugins.branding.splash","plugins.datastructure.binary-heap","game.entities.branding-logo-placeholder","game.entities.buttons.button-more-games","game.entities.opening-kitty","game.entities.pointer","game.entities.pointer-selector","game.entities.select","game.levels.opening","game.levels.main-menu",
"game.levels.main-menu-settings","game.levels.game-over","game.levels.gameplay","game.levels.tutorial","game.scene3d.babylon-scene-controller","game.toybox.content","plugins.fullscreen").defines(function(){this.START_OBFUSCATION;this.FRAMEBREAKER;MyGame=ig.Game.extend({name:"MJS-Cool-Archer-Prototype",version:"1.0.0",frameworkVersion:"1.4.5",io:null,paused:!1,lastDraw:[],scorelist:null,score:0,sfxDefaultVolume:0.7,bgmDefaultVolume:0.3,init:function(){this.tweens=new ig.TweensHandler;this.io=new IoManager;
this.setupUrlParams=new ig.UrlParameters;this.removeLoadingWheel();this.setupStorageManager();this.finalize()},initData:function(){return this.sessionData={sound:ig.game.sfxDefaultVolume,music:ig.game.bgmDefaultVolume,hasShownTutorial:!1,score:0}},finalize:function(){this.start();ig.sizeHandler.reorient()},removeLoadingWheel:function(){try{$("#ajaxbar").css("background","none")}catch(b){console.log(b)}},showDebugMenu:function(){console.log("showing debug menu ...");ig.Entity._debugShowBoxes=!0;$(".ig_debug").show()},
start:function(){this.resetPlayerStats();this.director=new ig.Director(this,[LevelOpening,LevelMainMenu,LevelGameplay,LevelMainMenuSettings,LevelGameOver,LevelTutorial]);if(_SETTINGS.Branding.Splash.Enabled)try{this.branding=new ig.BrandingSplash}catch(b){console.log(b),console.log("Loading original levels ..."),this.startGame()}else this.startGame();this.spawnEntity(EntityPointerSelector,50,50);ig.input.bind(ig.KEY.UP_ARROW,"jump");ig.input.bind(ig.KEY.LEFT_ARROW,"left");ig.input.bind(ig.KEY.RIGHT_ARROW,
"right");ig.input.bind(ig.KEY.W,"jump");ig.input.bind(ig.KEY.A,"left");ig.input.bind(ig.KEY.D,"right");ig.input.bind(ig.KEY.SPACE,"jump");ig.soundHandler.bgmPlayer.volume(ig.game.sessionData.music);ig.soundHandler.sfxPlayer.volume(ig.game.sessionData.sound)},startGame:function(){this.director.loadLevel(this.director.currentLevel)},goToLevel:function(b){this.director.loadLevel(this.getLevelID(b))},getLevelID:function(b){for(var c=0;c<this.director.levels.length;c++){var e=this.director.levels[c];if(e.entities&&
e.entities[0].type=="Entity"+b+"Controller")return c}console.error("Cannot find level named : "+b);return 0},fpsCount:function(){this.fpsTimer||(this.fpsTimer=new ig.Timer(1));this.fpsTimer&&0>this.fpsTimer.delta()?null!=this.fpsCounter?this.fpsCounter++:this.fpsCounter=0:(ig.game.fps=this.fpsCounter,this.fpsCounter=0,this.fpsTimer.reset())},endGame:function(){console.log("End game");ig.soundHandler.bgmPlayer.stop();ig.apiHandler.run("MJSEnd")},resetPlayerStats:function(){ig.log("resetting player stats ...");
this.playerStats={id:this.playerStats?this.playerStats.id:null}},splashClick:function(){var b=ig.domHandler.getElementById("#play");ig.domHandler.hide(b);ig.apiHandler.run("MJSFooter");ig.apiHandler.run("MJSHeader");ig.game.start()},pauseGame:function(){ig.system.stopRunLoop.call(ig.system);ig.game.tweens.onSystemPause();ig.babylonSceneController.paused=!0;console.log("Game Paused")},resumeGame:function(){ig.system.startRunLoop.call(ig.system);ig.game.tweens.onSystemResume();ig.babylonSceneController.paused=
!1;console.log("Game Resumed")},showOverlay:function(b){for(i=0;i<b.length;i++)$("#"+b[i])&&$("#"+b[i]).show(),document.getElementById(b[i])&&(document.getElementById(b[i]).style.visibility="visible")},hideOverlay:function(b){for(i=0;i<b.length;i++)$("#"+b[i])&&$("#"+b[i]).hide(),document.getElementById(b[i])&&(document.getElementById(b[i]).style.visibility="hidden")},currentBGMVolume:1,addition:0.1,update:function(){this.paused?(this.updateWhilePaused(),this.checkEntities()):(this.parent(),ig.ua.mobile&&
ig.soundHandler&&ig.soundHandler.forceLoopBGM());this.io.clear()},updateWhilePaused:function(){for(var b=0;b<this.entities.length;b++)this.entities[b].ignorePause&&this.entities[b].update()},draw:function(){this.parent();this.drawFPS();for(var b=0;b<this.lastDraw.length;b++)this.lastDraw[b]();this.dctf()},dctf:function(){this.COPYRIGHT},drawFPS:function(){var b=Math.round(1E3/ig.debug.debugTickAvg);this.fillStrokeText("[ WEBGL "+ig.altBabylon.engine.webGLVersion+" ][ FPS C "+b+" ][ FPS B "+ig.altBabylon.engine.performanceMonitor.averageFPS.toFixed()+
" ]",5,953)},fillStrokeText:function(b,c,e){var d=ig.system.context,j=d.measureText(b).width+4;d.save();d.fillStyle="#333333";d.fillRect(c-3,e-11,j+4,16);d.fillStyle="#ffffff";d.fillText(b,c,e);d.restore()},clearCanvas:function(b,c,e){var d=b.canvas;b.clearRect(0,0,c,e);d.style.display="none";d.offsetHeight;d.style.display="inherit"},drawDebug:function(){if(!ig.global.wm&&(this.debugEnable(),this.viewDebug&&(ig.system.context.fillStyle="#000000",ig.system.context.globalAlpha=0.35,ig.system.context.fillRect(0,
0,ig.system.width/4,ig.system.height),ig.system.context.globalAlpha=1,this.debug&&0<this.debug.length)))for(i=0;i<this.debug.length;i++)ig.system.context.font="10px Arial",ig.system.context.fillStyle="#ffffff",ig.system.context.fillText(this.debugLine-this.debug.length+i+": "+this.debug[i],10,50+10*i)},debugCL:function(b){this.debug?(50>this.debug.length||this.debug.splice(0,1),this.debug.push(b),this.debugLine++):(this.debug=[],this.debugLine=1,this.debug.push(b));console.log(b)},debugEnable:function(){ig.input.pressed("click")&&
(this.debugEnableTimer=new ig.Timer(2));this.debugEnableTimer&&0>this.debugEnableTimer.delta()?ig.input.released("click")&&(this.debugEnableTimer=null):this.debugEnableTimer&&0<this.debugEnableTimer.delta()&&(this.debugEnableTimer=null,this.viewDebug=this.viewDebug?!1:!0)}});ig.babylonJSSupport=!0;ig.domHandler=null;ig.domHandler=new ig.DomHandler;ig.domHandler.forcedDeviceDetection();ig.domHandler.forcedDeviceRotation();ig.apiHandler=new ig.ApiHandler;ig.sizeHandler=new ig.SizeHandler(ig.domHandler);
ig.visibilityHandler=new ig.VisibilityHandler;ig.soundHandler=null;ig.soundHandler=new ig.SoundHandler;ig.fontInfo=null;ig.fontInfo=new ig.FontInfo;ig.altBabylon.loadScene("media/scenes/","game-scene.babylon","#webglcanvas").onSceneLoaded.addOnce(ig.babylonSceneController.init.bind(ig.babylonSceneController));ig.main("#canvas",MyGame,60,ig.sizeHandler.desktop.actualResolution.x,ig.sizeHandler.desktop.actualResolution.y,ig.sizeHandler.scale,ig.SplashLoader);ig.sizeHandler.reorient();this.DOMAINLOCK_BREAKOUT_ATTEMPT;
this.END_OBFUSCATION});
