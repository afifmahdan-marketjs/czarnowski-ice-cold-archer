!function(c,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=c.document?b(c,!0):function(c){if(!c.document)throw Error("jQuery requires a window with a document");return b(c)}:b(c)}("undefined"!=typeof window?window:this,function(c,b){function e(c,b){b=b||G;var d=b.createElement("script");d.text=c;b.head.appendChild(d).parentNode.removeChild(d)}function d(c){var b=!!c&&"length"in c&&c.length,d=q.type(c);return"function"!==d&&!q.isWindow(c)&&("array"===d||0===b||"number"==
typeof b&&0<b&&b-1 in c)}function j(c,b){return c.nodeName&&c.nodeName.toLowerCase()===b.toLowerCase()}function f(c,b,d){return q.isFunction(b)?q.grep(c,function(c,Z){return!!b.call(c,Z,c)!==d}):b.nodeType?q.grep(c,function(c){return c===b!==d}):"string"!=typeof b?q.grep(c,function(c){return-1<Va.call(b,c)!==d}):Gc.test(b)?q.filter(b,c,d):(b=q.filter(b,c),q.grep(c,function(c){return-1<Va.call(b,c)!==d&&1===c.nodeType}))}function p(c,b){for(;(c=c[b])&&1!==c.nodeType;);return c}function l(c){return c}
function g(c){throw c;}function m(c,b,d,g){var e;try{c&&q.isFunction(e=c.promise)?e.call(c).done(b).fail(d):c&&q.isFunction(e=c.then)?e.call(c,b,d):b.apply(void 0,[c].slice(g))}catch(f){d.apply(void 0,[f])}}function n(){G.removeEventListener("DOMContentLoaded",n);c.removeEventListener("load",n);q.ready()}function r(){this.expando=q.expando+r.uid++}function s(c,b,d){var g;if(void 0===d&&1===c.nodeType)if(g="data-"+b.replace(Hc,"-$&").toLowerCase(),d=c.getAttribute(g),"string"==typeof d){try{d="true"===
d||"false"!==d&&("null"===d?null:d===+d+""?+d:Ic.test(d)?JSON.parse(d):d)}catch(e){}ra.set(c,b,d)}else d=void 0;return d}function t(c,b,d,g){var e,f=1,n=20,m=g?function(){return g.cur()}:function(){return q.css(c,b,"")},j=m(),l=d&&d[3]||(q.cssNumber[b]?"":"px"),r=(q.cssNumber[b]||"px"!==l&&+j)&&kb.exec(q.css(c,b));if(r&&r[3]!==l){l=l||r[3];d=d||[];r=+j||1;do f=f||".5",r/=f,q.style(c,b,r+l);while(f!==(f=m()/j)&&1!==f&&--n)}return d&&(r=+r||+j||0,e=d[1]?r+(d[1]+1)*d[2]:+d[2],g&&(g.unit=l,g.start=r,
g.end=e)),e}function u(c,b){for(var d,g,e=[],f=0,n=c.length;f<n;f++)if(g=c[f],g.style)if(d=g.style.display,b){if("none"===d&&(e[f]=P.get(g,"display")||null,e[f]||(g.style.display="")),""===g.style.display&&sb(g)){d=e;var m=f,j,l=void 0;j=g.ownerDocument;var r=g.nodeName;j=(g=Wb[r])?g:(l=j.body.appendChild(j.createElement(r)),g=q.css(l,"display"),l.parentNode.removeChild(l),"none"===g&&(g="block"),Wb[r]=g,g);d[m]=j}}else"none"!==d&&(e[f]="none",P.set(g,"display",d));for(f=0;f<n;f++)null!=e[f]&&(c[f].style.display=
e[f]);return c}function v(c,b){var d;return d="undefined"!=typeof c.getElementsByTagName?c.getElementsByTagName(b||"*"):"undefined"!=typeof c.querySelectorAll?c.querySelectorAll(b||"*"):[],void 0===b||b&&j(c,b)?q.merge([c],d):d}function z(c,b){for(var d=0,g=c.length;d<g;d++)P.set(c[d],"globalEval",!b||P.get(b[d],"globalEval"))}function x(c,b,d,g,e){for(var f,n,m,j,l=b.createDocumentFragment(),r=[],s=0,p=c.length;s<p;s++)if(f=c[s],f||0===f)if("object"===q.type(f))q.merge(r,f.nodeType?[f]:f);else if(Jc.test(f)){n=
n||l.appendChild(b.createElement("div"));m=(Xb.exec(f)||["",""])[1].toLowerCase();m=ta[m]||ta._default;n.innerHTML=m[1]+q.htmlPrefilter(f)+m[2];for(m=m[0];m--;)n=n.lastChild;q.merge(r,n.childNodes);n=l.firstChild;n.textContent=""}else r.push(b.createTextNode(f));l.textContent="";for(s=0;f=r[s++];)if(g&&-1<q.inArray(f,g))e&&e.push(f);else if(j=q.contains(f.ownerDocument,f),n=v(l.appendChild(f),"script"),j&&z(n),d)for(m=0;f=n[m++];)Yb.test(f.type||"")&&d.push(f);return l}function B(){return!0}function A(){return!1}
function D(){try{return G.activeElement}catch(c){}}function I(c,b,d,g,e,f){var n,m;if("object"==typeof b){"string"!=typeof d&&(g=g||d,d=void 0);for(m in b)I(c,m,d,g,b[m],f);return c}if(null==g&&null==e?(e=d,g=d=void 0):null==e&&("string"==typeof d?(e=g,g=void 0):(e=g,g=d,d=void 0)),!1===e)e=A;else if(!e)return c;return 1===f&&(n=e,e=function(c){return q().off(c),n.apply(this,arguments)},e.guid=n.guid||(n.guid=q.guid++)),c.each(function(){q.event.add(this,b,e,g,d)})}function y(c,b){return j(c,"table")&&
j(11!==b.nodeType?b:b.firstChild,"tr")?q(">tbody",c)[0]||c:c}function C(c){return c.type=(null!==c.getAttribute("type"))+"/"+c.type,c}function J(c){var b=Kc.exec(c.type);return b?c.type=b[1]:c.removeAttribute("type"),c}function M(c,b){var d,g,e,f,n,m;if(1===b.nodeType){if(P.hasData(c)&&(d=P.access(c),g=P.set(b,d),m=d.events))for(e in delete g.handle,g.events={},m){d=0;for(g=m[e].length;d<g;d++)q.event.add(b,e,m[e][d])}ra.hasData(c)&&(f=ra.access(c),n=q.extend({},f),ra.set(b,n))}}function O(c,b,d,
g){b=Ia.apply([],b);var f,n,m,j,l=0,r=c.length,s=r-1,p=b[0],E=q.isFunction(p);if(E||1<r&&"string"==typeof p&&!ca.checkClone&&Lc.test(p))return c.each(function(e){var f=c.eq(e);E&&(b[0]=p.call(this,e,f.html()));O(f,b,d,g)});if(r&&(f=x(b,c[0].ownerDocument,!1,c,g),n=f.firstChild,1===f.childNodes.length&&(f=n),n||g)){n=q.map(v(f,"script"),C);for(m=n.length;l<r;l++)j=f,l!==s&&(j=q.clone(j,!0,!0),m&&q.merge(n,v(j,"script"))),d.call(c[l],j,l);if(m){f=n[n.length-1].ownerDocument;q.map(n,J);for(l=0;l<m;l++)j=
n[l],Yb.test(j.type||"")&&!P.access(j,"globalEval")&&q.contains(f,j)&&(j.src?q._evalUrl&&q._evalUrl(j.src):e(j.textContent.replace(Nc,""),f))}}return c}function N(c,b,d){for(var g=b?q.filter(b,c):c,e=0;null!=(b=g[e]);e++)d||1!==b.nodeType||q.cleanData(v(b)),b.parentNode&&(d&&q.contains(b.ownerDocument,b)&&z(v(b,"script")),b.parentNode.removeChild(b));return c}function K(c,b,d){var g,e,f,n,m=c.style;return d=d||tb(c),d&&(n=d.getPropertyValue(b)||d[b],""!==n||q.contains(c.ownerDocument,c)||(n=q.style(c,
b)),!ca.pixelMarginRight()&&Jb.test(n)&&Zb.test(b)&&(g=m.width,e=m.minWidth,f=m.maxWidth,m.minWidth=m.maxWidth=m.width=n,n=d.width,m.width=g,m.minWidth=e,m.maxWidth=f)),void 0!==n?n+"":n}function W(c,b){return{get:function(){return c()?void delete this.get:(this.get=b).apply(this,arguments)}}}function ea(c){var b=q.cssProps[c];if(!b){var b=q.cssProps,d;a:if(d=c,!(d in $b)){for(var g=d[0].toUpperCase()+d.slice(1),e=ac.length;e--;)if(d=ac[e]+g,d in $b)break a;d=void 0}b=b[c]=d||c}return b}function F(c,
b,d){return(c=kb.exec(b))?Math.max(0,c[2]-(d||0))+(c[3]||"px"):b}function H(c,b,d,g,e){var f=0;for(b=d===(g?"border":"content")?4:"width"===b?1:0;4>b;b+=2)"margin"===d&&(f+=q.css(c,d+Wa[b],!0,e)),g?("content"===d&&(f-=q.css(c,"padding"+Wa[b],!0,e)),"margin"!==d&&(f-=q.css(c,"border"+Wa[b]+"Width",!0,e))):(f+=q.css(c,"padding"+Wa[b],!0,e),"padding"!==d&&(f+=q.css(c,"border"+Wa[b]+"Width",!0,e)));return f}function ia(c,b,d){var g,e=tb(c),f=K(c,b,e),n="border-box"===q.css(c,"boxSizing",!1,e);return Jb.test(f)?
f:(g=n&&(ca.boxSizingReliable()||f===c.style[b]),"auto"===f&&(f=c["offset"+b[0].toUpperCase()+b.slice(1)]),f=parseFloat(f)||0,f+H(c,b,d||(n?"border":"content"),g,e)+"px")}function R(c,b,d,g,e){return new R.prototype.init(c,b,d,g,e)}function L(){ub&&(!1===G.hidden&&c.requestAnimationFrame?c.requestAnimationFrame(L):c.setTimeout(L,q.fx.interval),q.fx.tick())}function U(){return c.setTimeout(function(){bb=void 0}),bb=q.now()}function Q(c,b){var d,g=0,e={height:c};for(b=b?1:0;4>g;g+=2-b)d=Wa[g],e["margin"+
d]=e["padding"+d]=c;return b&&(e.opacity=e.width=c),e}function aa(c,b,d){for(var g,e=(ba.tweeners[b]||[]).concat(ba.tweeners["*"]),f=0,n=e.length;f<n;f++)if(g=e[f].call(d,b,c))return g}function ba(c,b,d){var g,e,f=0,n=ba.prefilters.length,m=q.Deferred().always(function(){delete j.elem}),j=function(){if(e)return!1;for(var b=bb||U(),b=Math.max(0,l.startTime+l.duration-b),d=1-(b/l.duration||0),g=0,f=l.tweens.length;g<f;g++)l.tweens[g].run(d);return m.notifyWith(c,[l,d,b]),1>d&&f?b:(f||m.notifyWith(c,
[l,1,0]),m.resolveWith(c,[l]),!1)},l=m.promise({elem:c,props:q.extend({},b),opts:q.extend(!0,{specialEasing:{},easing:q.easing._default},d),originalProperties:b,originalOptions:d,startTime:bb||U(),duration:d.duration,tweens:[],createTween:function(b,d){var g=q.Tween(c,l.opts,b,d,l.opts.specialEasing[b]||l.opts.easing);return l.tweens.push(g),g},stop:function(b){var d=0,g=b?l.tweens.length:0;if(e)return this;for(e=!0;d<g;d++)l.tweens[d].run(1);return b?(m.notifyWith(c,[l,1,0]),m.resolveWith(c,[l,b])):
m.rejectWith(c,[l,b]),this}});b=l.props;d=l.opts.specialEasing;var r,s,p,E;for(g in b)if(r=q.camelCase(g),s=d[r],p=b[g],Array.isArray(p)&&(s=p[1],p=b[g]=p[0]),g!==r&&(b[r]=p,delete b[g]),E=q.cssHooks[r],E&&"expand"in E)for(g in p=E.expand(p),delete b[r],p)g in b||(b[g]=p[g],d[g]=s);else d[r]=s;for(;f<n;f++)if(g=ba.prefilters[f].call(l,c,b,l.opts))return q.isFunction(g.stop)&&(q._queueHooks(l.elem,l.opts.queue).stop=q.proxy(g.stop,g)),g;return q.map(b,aa,l),q.isFunction(l.opts.start)&&l.opts.start.call(c,
l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),q.fx.timer(q.extend(j,{elem:c,anim:l,queue:l.opts.queue})),l}function la(c){return(c.match(ua)||[]).join(" ")}function qa(c){return c.getAttribute&&c.getAttribute("class")||""}function fa(c,b,d,g){var e;if(Array.isArray(b))q.each(b,function(b,e){d||Oc.test(c)?g(c,e):fa(c+"["+("object"==typeof e&&null!=e?b:"")+"]",e,d,g)});else if(d||"object"!==q.type(b))g(c,b);else for(e in b)fa(c+"["+e+"]",b[e],
d,g)}function oa(c){return function(b,d){"string"!=typeof b&&(d=b,b="*");var g,e=0,f=b.toLowerCase().match(ua)||[];if(q.isFunction(d))for(;g=f[e++];)"+"===g[0]?(g=g.slice(1)||"*",(c[g]=c[g]||[]).unshift(d)):(c[g]=c[g]||[]).push(d)}}function E(c,b,d,g){function e(m){var j;return f[m]=!0,q.each(c[m]||[],function(c,Z){var m=Z(b,d,g);return"string"!=typeof m||n||f[m]?n?!(j=m):void 0:(b.dataTypes.unshift(m),e(m),!1)}),j}var f={},n=c===Kb;return e(b.dataTypes[0])||!f["*"]&&e("*")}function V(c,b){var d,
g,e=q.ajaxSettings.flatOptions||{};for(d in b)void 0!==b[d]&&((e[d]?c:g||(g={}))[d]=b[d]);return g&&q.extend(!0,c,g),c}var ha=[],G=c.document,Xa=Object.getPrototypeOf,pa=ha.slice,Ia=ha.concat,Oa=ha.push,Va=ha.indexOf,cb={},vb=cb.toString,db=cb.hasOwnProperty,wb=db.toString,Lb=wb.call(Object),ca={},q=function(c,b){return new q.fn.init(c,b)},Mb=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Nb=/^-ms-/,Da=/-([a-z])/g,Ja=function(c,b){return b.toUpperCase()};q.fn=q.prototype={jquery:"3.2.1",constructor:q,length:0,
toArray:function(){return pa.call(this)},get:function(c){return null==c?pa.call(this):0>c?this[c+this.length]:this[c]},pushStack:function(c){c=q.merge(this.constructor(),c);return c.prevObject=this,c},each:function(c){return q.each(this,c)},map:function(c){return this.pushStack(q.map(this,function(b,d){return c.call(b,d,b)}))},slice:function(){return this.pushStack(pa.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(c){var b=this.length;c=
+c+(0>c?b:0);return this.pushStack(0<=c&&c<b?[this[c]]:[])},end:function(){return this.prevObject||this.constructor()},push:Oa,sort:ha.sort,splice:ha.splice};q.extend=q.fn.extend=function(){var c,b,d,g,e,f,n=arguments[0]||{},m=1,j=arguments.length,l=!1;"boolean"==typeof n&&(l=n,n=arguments[m]||{},m++);"object"==typeof n||q.isFunction(n)||(n={});for(m===j&&(n=this,m--);m<j;m++)if(null!=(c=arguments[m]))for(b in c)d=n[b],g=c[b],n!==g&&(l&&g&&(q.isPlainObject(g)||(e=Array.isArray(g)))?(e?(e=!1,f=d&&
Array.isArray(d)?d:[]):f=d&&q.isPlainObject(d)?d:{},n[b]=q.extend(l,f,g)):void 0!==g&&(n[b]=g));return n};q.extend({expando:"jQuery"+("3.2.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(c){throw Error(c);},noop:function(){},isFunction:function(c){return"function"===q.type(c)},isWindow:function(c){return null!=c&&c===c.window},isNumeric:function(c){var b=q.type(c);return("number"===b||"string"===b)&&!isNaN(c-parseFloat(c))},isPlainObject:function(c){var b,d;return!(!c||"[object Object]"!==
vb.call(c))&&(!(b=Xa(c))||(d=db.call(b,"constructor")&&b.constructor,"function"==typeof d&&wb.call(d)===Lb))},isEmptyObject:function(c){for(var b in c)return!1;return!0},type:function(c){return null==c?c+"":"object"==typeof c||"function"==typeof c?cb[vb.call(c)]||"object":typeof c},globalEval:function(c){e(c)},camelCase:function(c){return c.replace(Nb,"ms-").replace(Da,Ja)},each:function(c,b){var g,e=0;if(d(c))for(g=c.length;e<g&&!1!==b.call(c[e],e,c[e]);e++);else for(e in c)if(!1===b.call(c[e],e,
c[e]))break;return c},trim:function(c){return null==c?"":(c+"").replace(Mb,"")},makeArray:function(c,b){var g=b||[];return null!=c&&(d(Object(c))?q.merge(g,"string"==typeof c?[c]:c):Oa.call(g,c)),g},inArray:function(c,b,d){return null==b?-1:Va.call(b,c,d)},merge:function(c,b){for(var d=+b.length,g=0,e=c.length;g<d;g++)c[e++]=b[g];return c.length=e,c},grep:function(c,b,d){for(var g=[],e=0,f=c.length,n=!d;e<f;e++)d=!b(c[e],e),d!==n&&g.push(c[e]);return g},map:function(c,b,g){var e,f,n=0,m=[];if(d(c))for(e=
c.length;n<e;n++)f=b(c[n],n,g),null!=f&&m.push(f);else for(n in c)f=b(c[n],n,g),null!=f&&m.push(f);return Ia.apply([],m)},guid:1,proxy:function(c,b){var d,g,e;if("string"==typeof b&&(d=c[b],b=c,c=d),q.isFunction(c))return g=pa.call(arguments,2),e=function(){return c.apply(b||this,g.concat(pa.call(arguments)))},e.guid=c.guid=c.guid||q.guid++,e},now:Date.now,support:ca});"function"==typeof Symbol&&(q.fn[Symbol.iterator]=ha[Symbol.iterator]);q.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),
function(c,b){cb["[object "+b+"]"]=b.toLowerCase()});var va,lb=c,Y=function(c,b,d,g){var e,f,n,m,j,l=b&&b.ownerDocument,r=b?b.nodeType:9;if(d=d||[],"string"!=typeof c||!c||1!==r&&9!==r&&11!==r)return d;if(!g&&((b?b.ownerDocument||b:wa)!==X&&Pa(b),b=b||X,xa)){if(11!==r&&(m=Pc.exec(c)))if(e=m[1])if(9===r){if(!(f=b.getElementById(e)))return d;if(f.id===e)return d.push(f),d}else{if(l&&(f=l.getElementById(e))&&mb(b,f)&&f.id===e)return d.push(f),d}else{if(m[2])return Qa.apply(d,b.getElementsByTagName(c)),
d;if((e=m[3])&&ga.getElementsByClassName&&b.getElementsByClassName)return Qa.apply(d,b.getElementsByClassName(e)),d}if(ga.qsa&&!xb[c+" "]&&(!ma||!ma.test(c))){if(1!==r)l=b,j=c;else if("object"!==b.nodeName.toLowerCase()){(n=b.getAttribute("id"))?n=n.replace(bc,cc):b.setAttribute("id",n=da);f=nb(c);for(e=f.length;e--;)f[e]="#"+n+" "+za(f[e]);j=f.join(",");l=Ob.test(c)&&Ea(b.parentNode)||b}if(j)try{return Qa.apply(d,l.querySelectorAll(j)),d}catch(s){}finally{n===da&&b.removeAttribute("id")}}}return dc(c.replace(yb,
"$1"),b,d,g)},Ra=function(){function c(d,g){return b.push(d+" ")>T.cacheLength&&delete c[b.shift()],c[d+" "]=g}var b=[];return c},ja=function(c){return c[da]=!0,c},sa=function(c){var b=X.createElement("fieldset");try{return!!c(b)}catch(d){return!1}finally{b.parentNode&&b.parentNode.removeChild(b)}},Sa=function(c,b){for(var d=c.split("|"),g=d.length;g--;)T.attrHandle[d[g]]=b},Ka=function(c,b){var d=b&&c,g=d&&1===c.nodeType&&1===b.nodeType&&c.sourceIndex-b.sourceIndex;if(g)return g;if(d)for(;d=d.nextSibling;)if(d===
b)return-1;return c?1:-1},zb=function(c){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===c}},Ta=function(c){return function(b){var d=b.nodeName.toLowerCase();return("input"===d||"button"===d)&&b.type===c}},eb=function(c){return function(b){return"form"in b?b.parentNode&&!1===b.disabled?"label"in b?"label"in b.parentNode?b.parentNode.disabled===c:b.disabled===c:b.isDisabled===c||b.isDisabled!==!c&&Qc(b)===c:b.disabled===c:"label"in b&&b.disabled===c}},Fa=function(c){return ja(function(b){return b=
+b,ja(function(d,g){for(var e,f=c([],d.length,b),n=f.length;n--;)d[e=f[n]]&&(d[e]=!(g[e]=d[e]))})})},Ea=function(c){return c&&"undefined"!=typeof c.getElementsByTagName&&c},Ga=function(){},za=function(c){for(var b=0,d=c.length,g="";b<d;b++)g+=c[b].value;return g},Ya=function(c,b,d){var g=b.dir,e=b.next,f=e||g,n=d&&"parentNode"===f,m=Rc++;return b.first?function(b,d,e){for(;b=b[g];)if(1===b.nodeType||n)return c(b,d,e);return!1}:function(b,d,j){var l,r,S,s=[Ha,m];if(j)for(;b=b[g];){if((1===b.nodeType||
n)&&c(b,d,j))return!0}else for(;b=b[g];)if(1===b.nodeType||n)if(S=b[da]||(b[da]={}),r=S[b.uniqueID]||(S[b.uniqueID]={}),e&&e===b.nodeName.toLowerCase())b=b[g]||b;else{if((l=r[f])&&l[0]===Ha&&l[1]===m)return s[2]=l[2];if(r[f]=s,s[2]=c(b,d,j))return!0}return!1}},Aa=function(c){return 1<c.length?function(b,d,g){for(var e=c.length;e--;)if(!c[e](b,d,g))return!1;return!0}:c[0]},Ba=function(c,b,d,g,e){for(var f,n=[],m=0,j=c.length,l=null!=b;m<j;m++)(f=c[m])&&(d&&!d(f,g,e)||(n.push(f),l&&b.push(m)));return n},
na=function(c,b,d,g,e,f){return g&&!g[da]&&(g=na(g)),e&&!e[da]&&(e=na(e,f)),ja(function(f,n,m,j){var l,r,s=[],p=[],q=n.length,E;if(!(E=f)){E=b||"*";for(var t=m.nodeType?[m]:m,u=[],v=0,V=t.length;v<V;v++)Y(E,t[v],u);E=u}E=!c||!f&&b?E:Ba(E,s,c,m,j);t=d?e||(f?c:q||g)?[]:n:E;if(d&&d(E,t,m,j),g){l=Ba(t,p);g(l,[],m,j);for(m=l.length;m--;)(r=l[m])&&(t[p[m]]=!(E[p[m]]=r))}if(f){if(e||c){if(e){l=[];for(m=t.length;m--;)(r=t[m])&&l.push(E[m]=r);e(null,t=[],l,j)}for(m=t.length;m--;)(r=t[m])&&-1<(l=e?Za(f,r):
s[m])&&(f[l]=!(n[l]=r))}}else t=Ba(t===n?t.splice(q,t.length):t),e?e(null,n,t,j):Qa.apply(n,t)})},Pb=function(c){var b,d,g,e=c.length,f=T.relative[c[0].type];d=f||T.relative[" "];for(var n=f?1:0,m=Ya(function(c){return c===b},d,!0),j=Ya(function(c){return-1<Za(b,c)},d,!0),l=[function(c,d,g){c=!f&&(g||d!==fb)||((b=d).nodeType?m(c,d,g):j(c,d,g));return b=null,c}];n<e;n++)if(d=T.relative[c[n].type])l=[Ya(Aa(l),d)];else{if(d=T.filter[c[n].type].apply(null,c[n].matches),d[da]){for(g=++n;g<e&&!T.relative[c[g].type];g++);
return na(1<n&&Aa(l),1<n&&za(c.slice(0,n-1).concat({value:" "===c[n-2].type?"*":""})).replace(yb,"$1"),d,n<g&&Pb(c.slice(n,g)),g<e&&Pb(c=c.slice(g)),g<e&&za(c))}l.push(d)}return Aa(l)},gb,ga,T,Ab,ec,nb,Qb,dc,fb,Ua,hb,Pa,X,ya,xa,ma,$a,Bb,mb,da="sizzle"+1*new Date,wa=lb.document,Ha=0,Rc=0,fc=Ra(),gc=Ra(),xb=Ra(),Rb=function(c,b){return c===b&&(hb=!0),0},Sc={}.hasOwnProperty,ab=[],Tc=ab.pop,Uc=ab.push,Qa=ab.push,hc=ab.slice,Za=function(c,b){for(var d=0,g=c.length;d<g;d++)if(c[d]===b)return d;return-1},
Vc=/[\x20\t\r\n\f]+/g,yb=/^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g,Wc=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,Xc=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,Yc=/=[\x20\t\r\n\f]*([^\]'"]*?)[\x20\t\r\n\f]*\]/g,Zc=RegExp(":((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),
$c=/^(?:\\.|[\w-]|[^\x00-\xa0])+$/,Cb={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:/^((?:\\.|[\w-]|[^\x00-\xa0])+|[*])/,ATTR:RegExp("^\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\]"),PSEUDO:RegExp("^:((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),
CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)",
"i")},ad=/^(?:input|select|textarea|button)$/i,bd=/^h\d$/i,ob=/^[^{]+\{\s*\[native \w/,Pc=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Ob=/[+~]/,La=/\\([\da-f]{1,6}[\x20\t\r\n\f]?|([\x20\t\r\n\f])|.)/ig,Ma=function(c,b,d){c="0x"+b-65536;return c!==c||d?b:0>c?String.fromCharCode(c+65536):String.fromCharCode(c>>10|55296,1023&c|56320)},bc=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,cc=function(c,b){return b?"\x00"===c?"\ufffd":c.slice(0,-1)+"\\"+c.charCodeAt(c.length-1).toString(16)+" ":"\\"+c},ic=function(){Pa()},
Qc=Ya(function(c){return!0===c.disabled&&("form"in c||"label"in c)},{dir:"parentNode",next:"legend"});try{Qa.apply(ab=hc.call(wa.childNodes),wa.childNodes),ab[wa.childNodes.length].nodeType}catch(Ed){Qa={apply:ab.length?function(c,b){Uc.apply(c,hc.call(b))}:function(c,b){for(var d=c.length,g=0;c[d++]=b[g++];);c.length=d-1}}}ga=Y.support={};ec=Y.isXML=function(c){c=c&&(c.ownerDocument||c).documentElement;return!!c&&"HTML"!==c.nodeName};Pa=Y.setDocument=function(c){var b,d;c=c?c.ownerDocument||c:wa;
return c!==X&&9===c.nodeType&&c.documentElement?(X=c,ya=X.documentElement,xa=!ec(X),wa!==X&&(d=X.defaultView)&&d.top!==d&&(d.addEventListener?d.addEventListener("unload",ic,!1):d.attachEvent&&d.attachEvent("onunload",ic)),ga.attributes=sa(function(c){return c.className="i",!c.getAttribute("className")}),ga.getElementsByTagName=sa(function(c){return c.appendChild(X.createComment("")),!c.getElementsByTagName("*").length}),ga.getElementsByClassName=ob.test(X.getElementsByClassName),ga.getById=sa(function(c){return ya.appendChild(c).id=
da,!X.getElementsByName||!X.getElementsByName(da).length}),ga.getById?(T.filter.ID=function(c){var b=c.replace(La,Ma);return function(c){return c.getAttribute("id")===b}},T.find.ID=function(c,b){if("undefined"!=typeof b.getElementById&&xa){var d=b.getElementById(c);return d?[d]:[]}}):(T.filter.ID=function(c){var b=c.replace(La,Ma);return function(c){return(c="undefined"!=typeof c.getAttributeNode&&c.getAttributeNode("id"))&&c.value===b}},T.find.ID=function(c,b){if("undefined"!=typeof b.getElementById&&
xa){var d,g,e,f=b.getElementById(c);if(f){if(d=f.getAttributeNode("id"),d&&d.value===c)return[f];e=b.getElementsByName(c);for(g=0;f=e[g++];)if(d=f.getAttributeNode("id"),d&&d.value===c)return[f]}return[]}}),T.find.TAG=ga.getElementsByTagName?function(c,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(c):ga.qsa?b.querySelectorAll(c):void 0}:function(c,b){var d,g=[],e=0,f=b.getElementsByTagName(c);if("*"===c){for(;d=f[e++];)1===d.nodeType&&g.push(d);return g}return f},T.find.CLASS=
ga.getElementsByClassName&&function(c,b){if("undefined"!=typeof b.getElementsByClassName&&xa)return b.getElementsByClassName(c)},$a=[],ma=[],(ga.qsa=ob.test(X.querySelectorAll))&&(sa(function(c){ya.appendChild(c).innerHTML="<a id='"+da+"'></a><select id='"+da+"-\r\\' msallowcapture=''><option selected=''></option></select>";c.querySelectorAll("[msallowcapture^='']").length&&ma.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");c.querySelectorAll("[selected]").length||ma.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");
c.querySelectorAll("[id~="+da+"-]").length||ma.push("~=");c.querySelectorAll(":checked").length||ma.push(":checked");c.querySelectorAll("a#"+da+"+*").length||ma.push(".#.+[+~]")}),sa(function(c){c.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var b=X.createElement("input");b.setAttribute("type","hidden");c.appendChild(b).setAttribute("name","D");c.querySelectorAll("[name=d]").length&&ma.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?=");2!==c.querySelectorAll(":enabled").length&&
ma.push(":enabled",":disabled");ya.appendChild(c).disabled=!0;2!==c.querySelectorAll(":disabled").length&&ma.push(":enabled",":disabled");c.querySelectorAll("*,:x");ma.push(",.*:")})),(ga.matchesSelector=ob.test(Bb=ya.matches||ya.webkitMatchesSelector||ya.mozMatchesSelector||ya.oMatchesSelector||ya.msMatchesSelector))&&sa(function(c){ga.disconnectedMatch=Bb.call(c,"*");Bb.call(c,"[s!='']:x");$a.push("!=",":((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)")}),
ma=ma.length&&RegExp(ma.join("|")),$a=$a.length&&RegExp($a.join("|")),b=ob.test(ya.compareDocumentPosition),mb=b||ob.test(ya.contains)?function(c,b){var d=9===c.nodeType?c.documentElement:c,g=b&&b.parentNode;return c===g||!(!g||1!==g.nodeType||!(d.contains?d.contains(g):c.compareDocumentPosition&&16&c.compareDocumentPosition(g)))}:function(c,b){if(b)for(;b=b.parentNode;)if(b===c)return!0;return!1},Rb=b?function(c,b){if(c===b)return hb=!0,0;var d=!c.compareDocumentPosition-!b.compareDocumentPosition;
return d?d:(d=(c.ownerDocument||c)===(b.ownerDocument||b)?c.compareDocumentPosition(b):1,1&d||!ga.sortDetached&&b.compareDocumentPosition(c)===d?c===X||c.ownerDocument===wa&&mb(wa,c)?-1:b===X||b.ownerDocument===wa&&mb(wa,b)?1:Ua?Za(Ua,c)-Za(Ua,b):0:4&d?-1:1)}:function(c,b){if(c===b)return hb=!0,0;var d,g=0;d=c.parentNode;var e=b.parentNode,f=[c],n=[b];if(!d||!e)return c===X?-1:b===X?1:d?-1:e?1:Ua?Za(Ua,c)-Za(Ua,b):0;if(d===e)return Ka(c,b);for(d=c;d=d.parentNode;)f.unshift(d);for(d=b;d=d.parentNode;)n.unshift(d);
for(;f[g]===n[g];)g++;return g?Ka(f[g],n[g]):f[g]===wa?-1:n[g]===wa?1:0},X):X};Y.matches=function(c,b){return Y(c,null,null,b)};Y.matchesSelector=function(c,b){if((c.ownerDocument||c)!==X&&Pa(c),b=b.replace(Yc,"='$1']"),ga.matchesSelector&&xa&&!xb[b+" "]&&(!$a||!$a.test(b))&&(!ma||!ma.test(b)))try{var d=Bb.call(c,b);if(d||ga.disconnectedMatch||c.document&&11!==c.document.nodeType)return d}catch(g){}return 0<Y(b,X,null,[c]).length};Y.contains=function(c,b){return(c.ownerDocument||c)!==X&&Pa(c),mb(c,
b)};Y.attr=function(c,b){(c.ownerDocument||c)!==X&&Pa(c);var d=T.attrHandle[b.toLowerCase()],d=d&&Sc.call(T.attrHandle,b.toLowerCase())?d(c,b,!xa):void 0;return void 0!==d?d:ga.attributes||!xa?c.getAttribute(b):(d=c.getAttributeNode(b))&&d.specified?d.value:null};Y.escape=function(c){return(c+"").replace(bc,cc)};Y.error=function(c){throw Error("Syntax error, unrecognized expression: "+c);};Y.uniqueSort=function(c){var b,d=[],g=0,e=0;if(hb=!ga.detectDuplicates,Ua=!ga.sortStable&&c.slice(0),c.sort(Rb),
hb){for(;b=c[e++];)b===c[e]&&(g=d.push(e));for(;g--;)c.splice(d[g],1)}return Ua=null,c};Ab=Y.getText=function(c){var b,d="",g=0;if(b=c.nodeType)if(1===b||9===b||11===b){if("string"==typeof c.textContent)return c.textContent;for(c=c.firstChild;c;c=c.nextSibling)d+=Ab(c)}else{if(3===b||4===b)return c.nodeValue}else for(;b=c[g++];)d+=Ab(b);return d};T=Y.selectors={cacheLength:50,createPseudo:ja,match:Cb,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",
first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(c){return c[1]=c[1].replace(La,Ma),c[3]=(c[3]||c[4]||c[5]||"").replace(La,Ma),"~="===c[2]&&(c[3]=" "+c[3]+" "),c.slice(0,4)},CHILD:function(c){return c[1]=c[1].toLowerCase(),"nth"===c[1].slice(0,3)?(c[3]||Y.error(c[0]),c[4]=+(c[4]?c[5]+(c[6]||1):2*("even"===c[3]||"odd"===c[3])),c[5]=+(c[7]+c[8]||"odd"===c[3])):c[3]&&Y.error(c[0]),c},PSEUDO:function(c){var b,d=!c[6]&&c[2];return Cb.CHILD.test(c[0])?null:(c[3]?c[2]=c[4]||c[5]||"":d&&Zc.test(d)&&
(b=nb(d,!0))&&(b=d.indexOf(")",d.length-b)-d.length)&&(c[0]=c[0].slice(0,b),c[2]=d.slice(0,b)),c.slice(0,3))}},filter:{TAG:function(c){var b=c.replace(La,Ma).toLowerCase();return"*"===c?function(){return!0}:function(c){return c.nodeName&&c.nodeName.toLowerCase()===b}},CLASS:function(c){var b=fc[c+" "];return b||(b=RegExp("(^|[\\x20\\t\\r\\n\\f])"+c+"([\\x20\\t\\r\\n\\f]|$)"))&&fc(c,function(c){return b.test("string"==typeof c.className&&c.className||"undefined"!=typeof c.getAttribute&&c.getAttribute("class")||
"")})},ATTR:function(c,b,d){return function(g){g=Y.attr(g,c);return null==g?"!="===b:!b||(g+="","="===b?g===d:"!="===b?g!==d:"^="===b?d&&0===g.indexOf(d):"*="===b?d&&-1<g.indexOf(d):"$="===b?d&&g.slice(-d.length)===d:"~="===b?-1<(" "+g.replace(Vc," ")+" ").indexOf(d):"|="===b&&(g===d||g.slice(0,d.length+1)===d+"-"))}},CHILD:function(c,b,d,g,e){var f="nth"!==c.slice(0,3),n="last"!==c.slice(-4),m="of-type"===b;return 1===g&&0===e?function(c){return!!c.parentNode}:function(b,d,j){var l,r,s,S,p,q;d=f!==
n?"nextSibling":"previousSibling";var E=b.parentNode,t=m&&b.nodeName.toLowerCase();j=!j&&!m;var ka=!1;if(E){if(f){for(;d;){for(S=b;S=S[d];)if(m?S.nodeName.toLowerCase()===t:1===S.nodeType)return!1;q=d="only"===c&&!q&&"nextSibling"}return!0}if(q=[n?E.firstChild:E.lastChild],n&&j){S=E;s=S[da]||(S[da]={});r=s[S.uniqueID]||(s[S.uniqueID]={});l=r[c]||[];ka=(p=l[0]===Ha&&l[1])&&l[2];for(S=p&&E.childNodes[p];S=++p&&S&&S[d]||(ka=p=0)||q.pop();)if(1===S.nodeType&&++ka&&S===b){r[c]=[Ha,p,ka];break}}else if(j&&
(S=b,s=S[da]||(S[da]={}),r=s[S.uniqueID]||(s[S.uniqueID]={}),l=r[c]||[],p=l[0]===Ha&&l[1],ka=p),!1===ka)for(;(S=++p&&S&&S[d]||(ka=p=0)||q.pop())&&(!(m?S.nodeName.toLowerCase()===t:1===S.nodeType)||!++ka||!(j&&(s=S[da]||(S[da]={}),r=s[S.uniqueID]||(s[S.uniqueID]={}),r[c]=[Ha,ka]),S===b)););return ka-=e,ka===g||0===ka%g&&0<=ka/g}}},PSEUDO:function(c,b){var d,g=T.pseudos[c]||T.setFilters[c.toLowerCase()]||Y.error("unsupported pseudo: "+c);return g[da]?g(b):1<g.length?(d=[c,c,"",b],T.setFilters.hasOwnProperty(c.toLowerCase())?
ja(function(c,d){for(var e,f=g(c,b),n=f.length;n--;)e=Za(c,f[n]),c[e]=!(d[e]=f[n])}):function(c){return g(c,0,d)}):g}},pseudos:{not:ja(function(c){var b=[],d=[],g=Qb(c.replace(yb,"$1"));return g[da]?ja(function(c,b,d,e){var f;d=g(c,null,e,[]);for(e=c.length;e--;)(f=d[e])&&(c[e]=!(b[e]=f))}):function(c,e,f){return b[0]=c,g(b,null,f,d),b[0]=null,!d.pop()}}),has:ja(function(c){return function(b){return 0<Y(c,b).length}}),contains:ja(function(c){return c=c.replace(La,Ma),function(b){return-1<(b.textContent||
b.innerText||Ab(b)).indexOf(c)}}),lang:ja(function(c){return $c.test(c||"")||Y.error("unsupported lang: "+c),c=c.replace(La,Ma).toLowerCase(),function(b){var d;do if(d=xa?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return d=d.toLowerCase(),d===c||0===d.indexOf(c+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(c){var b=lb.location&&lb.location.hash;return b&&b.slice(1)===c.id},root:function(c){return c===ya},focus:function(c){return c===X.activeElement&&(!X.hasFocus||
X.hasFocus())&&!(!c.type&&!c.href&&!~c.tabIndex)},enabled:eb(!1),disabled:eb(!0),checked:function(c){var b=c.nodeName.toLowerCase();return"input"===b&&!!c.checked||"option"===b&&!!c.selected},selected:function(c){return c.parentNode&&c.parentNode.selectedIndex,!0===c.selected},empty:function(c){for(c=c.firstChild;c;c=c.nextSibling)if(6>c.nodeType)return!1;return!0},parent:function(c){return!T.pseudos.empty(c)},header:function(c){return bd.test(c.nodeName)},input:function(c){return ad.test(c.nodeName)},
button:function(c){var b=c.nodeName.toLowerCase();return"input"===b&&"button"===c.type||"button"===b},text:function(c){var b;return"input"===c.nodeName.toLowerCase()&&"text"===c.type&&(null==(b=c.getAttribute("type"))||"text"===b.toLowerCase())},first:Fa(function(){return[0]}),last:Fa(function(c,b){return[b-1]}),eq:Fa(function(c,b,d){return[0>d?d+b:d]}),even:Fa(function(c,b){for(var d=0;d<b;d+=2)c.push(d);return c}),odd:Fa(function(c,b){for(var d=1;d<b;d+=2)c.push(d);return c}),lt:Fa(function(c,b,
d){for(b=0>d?d+b:d;0<=--b;)c.push(b);return c}),gt:Fa(function(c,b,d){for(d=0>d?d+b:d;++d<b;)c.push(d);return c})}};T.pseudos.nth=T.pseudos.eq;for(gb in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})T.pseudos[gb]=zb(gb);for(gb in{submit:!0,reset:!0})T.pseudos[gb]=Ta(gb);Ga.prototype=T.filters=T.pseudos;T.setFilters=new Ga;nb=Y.tokenize=function(c,b){var d,g,e,f,n,m,j;if(n=gc[c+" "])return b?0:n.slice(0);n=c;m=[];for(j=T.preFilter;n;){d&&!(g=Wc.exec(n))||(g&&(n=n.slice(g[0].length)||n),m.push(e=
[]));d=!1;(g=Xc.exec(n))&&(d=g.shift(),e.push({value:d,type:g[0].replace(yb," ")}),n=n.slice(d.length));for(f in T.filter)!(g=Cb[f].exec(n))||j[f]&&!(g=j[f](g))||(d=g.shift(),e.push({value:d,type:f,matches:g}),n=n.slice(d.length));if(!d)break}return b?n.length:n?Y.error(c):gc(c,m).slice(0)};va=(Qb=Y.compile=function(c,b){var d,g=[],e=[],f=xb[c+" "];if(!f){b||(b=nb(c));for(d=b.length;d--;)f=Pb(b[d]),f[da]?g.push(f):e.push(f);d=xb;var n=0<g.length,m=0<e.length,f=function(c,b,d,f,j){var Z,l,r,s=0,p=
"0",S=c&&[],q=[],E=fb,t=c||m&&T.find.TAG("*",j),ka=Ha+=null==E?1:Math.random()||0.1,u=t.length;for(j&&(fb=b===X||b||j);p!==u&&null!=(Z=t[p]);p++){if(m&&Z){l=0;for(b||Z.ownerDocument===X||(Pa(Z),d=!xa);r=e[l++];)if(r(Z,b||X,d)){f.push(Z);break}j&&(Ha=ka)}n&&((Z=!r&&Z)&&s--,c&&S.push(Z))}if(s+=p,n&&p!==s){for(l=0;r=g[l++];)r(S,q,b,d);if(c){if(0<s)for(;p--;)S[p]||q[p]||(q[p]=Tc.call(f));q=Ba(q)}Qa.apply(f,q);j&&!c&&0<q.length&&1<s+g.length&&Y.uniqueSort(f)}return j&&(Ha=ka,fb=E),S},f=n?ja(f):f,f=d(c,
f);f.selector=c}return f},dc=Y.select=function(c,b,d,g){var e,f,n,m,j,l="function"==typeof c&&c,r=!g&&nb(c=l.selector||c);if(d=d||[],1===r.length){if(f=r[0]=r[0].slice(0),2<f.length&&"ID"===(n=f[0]).type&&9===b.nodeType&&xa&&T.relative[f[1].type]){if(b=(T.find.ID(n.matches[0].replace(La,Ma),b)||[])[0],!b)return d;l&&(b=b.parentNode);c=c.slice(f.shift().value.length)}for(e=Cb.needsContext.test(c)?0:f.length;e--&&!(n=f[e],T.relative[m=n.type]);)if((j=T.find[m])&&(g=j(n.matches[0].replace(La,Ma),Ob.test(f[0].type)&&
Ea(b.parentNode)||b))){if(f.splice(e,1),c=g.length&&za(f),!c)return Qa.apply(d,g),d;break}}return(l||Qb(c,r))(g,b,!xa,d,!b||Ob.test(c)&&Ea(b.parentNode)||b),d},ga.sortStable=da.split("").sort(Rb).join("")===da,ga.detectDuplicates=!!hb,Pa(),ga.sortDetached=sa(function(c){return 1&c.compareDocumentPosition(X.createElement("fieldset"))}),sa(function(c){return c.innerHTML="<a href='#'></a>","#"===c.firstChild.getAttribute("href")})||Sa("type|href|height|width",function(c,b,d){if(!d)return c.getAttribute(b,
"type"===b.toLowerCase()?1:2)}),ga.attributes&&sa(function(c){return c.innerHTML="<input/>",c.firstChild.setAttribute("value",""),""===c.firstChild.getAttribute("value")})||Sa("value",function(c,b,d){if(!d&&"input"===c.nodeName.toLowerCase())return c.defaultValue}),sa(function(c){return null==c.getAttribute("disabled")})||Sa("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(c,b,d){var g;if(!d)return!0===c[b]?b.toLowerCase():
(g=c.getAttributeNode(b))&&g.specified?g.value:null}),Y);q.find=va;q.expr=va.selectors;q.expr[":"]=q.expr.pseudos;q.uniqueSort=q.unique=va.uniqueSort;q.text=va.getText;q.isXMLDoc=va.isXML;q.contains=va.contains;q.escapeSelector=va.escape;var ib=function(c,b,d){for(var g=[],e=void 0!==d;(c=c[b])&&9!==c.nodeType;)if(1===c.nodeType){if(e&&q(c).is(d))break;g.push(c)}return g},jc=function(c,b){for(var d=[];c;c=c.nextSibling)1===c.nodeType&&c!==b&&d.push(c);return d},kc=q.expr.match.needsContext,lc=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,
Gc=/^.[^:#\[\.,]*$/;q.filter=function(c,b,d){var g=b[0];return d&&(c=":not("+c+")"),1===b.length&&1===g.nodeType?q.find.matchesSelector(g,c)?[g]:[]:q.find.matches(c,q.grep(b,function(c){return 1===c.nodeType}))};q.fn.extend({find:function(c){var b,d,g=this.length,e=this;if("string"!=typeof c)return this.pushStack(q(c).filter(function(){for(b=0;b<g;b++)if(q.contains(e[b],this))return!0}));d=this.pushStack([]);for(b=0;b<g;b++)q.find(c,e[b],d);return 1<g?q.uniqueSort(d):d},filter:function(c){return this.pushStack(f(this,
c||[],!1))},not:function(c){return this.pushStack(f(this,c||[],!0))},is:function(c){return!!f(this,"string"==typeof c&&kc.test(c)?q(c):c||[],!1).length}});var mc,cd=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(q.fn.init=function(c,b,d){var g,e;if(!c)return this;if(d=d||mc,"string"==typeof c){if(g="<"===c[0]&&">"===c[c.length-1]&&3<=c.length?[null,c,null]:cd.exec(c),!g||!g[1]&&b)return!b||b.jquery?(b||d).find(c):this.constructor(b).find(c);if(g[1]){if(b=b instanceof q?b[0]:b,q.merge(this,q.parseHTML(g[1],
b&&b.nodeType?b.ownerDocument||b:G,!0)),lc.test(g[1])&&q.isPlainObject(b))for(g in b)q.isFunction(this[g])?this[g](b[g]):this.attr(g,b[g]);return this}return e=G.getElementById(g[2]),e&&(this[0]=e,this.length=1),this}return c.nodeType?(this[0]=c,this.length=1,this):q.isFunction(c)?void 0!==d.ready?d.ready(c):c(q):q.makeArray(c,this)}).prototype=q.fn;mc=q(G);var dd=/^(?:parents|prev(?:Until|All))/,ed={children:!0,contents:!0,next:!0,prev:!0};q.fn.extend({has:function(c){var b=q(c,this),d=b.length;
return this.filter(function(){for(var c=0;c<d;c++)if(q.contains(this,b[c]))return!0})},closest:function(c,b){var d,g=0,e=this.length,f=[],n="string"!=typeof c&&q(c);if(!kc.test(c))for(;g<e;g++)for(d=this[g];d&&d!==b;d=d.parentNode)if(11>d.nodeType&&(n?-1<n.index(d):1===d.nodeType&&q.find.matchesSelector(d,c))){f.push(d);break}return this.pushStack(1<f.length?q.uniqueSort(f):f)},index:function(c){return c?"string"==typeof c?Va.call(q(c),this[0]):Va.call(this,c.jquery?c[0]:c):this[0]&&this[0].parentNode?
this.first().prevAll().length:-1},add:function(c,b){return this.pushStack(q.uniqueSort(q.merge(this.get(),q(c,b))))},addBack:function(c){return this.add(null==c?this.prevObject:this.prevObject.filter(c))}});q.each({parent:function(c){return(c=c.parentNode)&&11!==c.nodeType?c:null},parents:function(c){return ib(c,"parentNode")},parentsUntil:function(c,b,d){return ib(c,"parentNode",d)},next:function(c){return p(c,"nextSibling")},prev:function(c){return p(c,"previousSibling")},nextAll:function(c){return ib(c,
"nextSibling")},prevAll:function(c){return ib(c,"previousSibling")},nextUntil:function(c,b,d){return ib(c,"nextSibling",d)},prevUntil:function(c,b,d){return ib(c,"previousSibling",d)},siblings:function(c){return jc((c.parentNode||{}).firstChild,c)},children:function(c){return jc(c.firstChild)},contents:function(c){return j(c,"iframe")?c.contentDocument:(j(c,"template")&&(c=c.content||c),q.merge([],c.childNodes))}},function(c,b){q.fn[c]=function(d,g){var e=q.map(this,b,d);return"Until"!==c.slice(-5)&&
(g=d),g&&"string"==typeof g&&(e=q.filter(g,e)),1<this.length&&(ed[c]||q.uniqueSort(e),dd.test(c)&&e.reverse()),this.pushStack(e)}});var ua=/[^\x20\t\r\n\f]+/g;q.Callbacks=function(c){var b;if("string"==typeof c){var d={};b=(q.each(c.match(ua)||[],function(c,b){d[b]=!0}),d)}else b=q.extend({},c);c=b;var g,e,f,n,m=[],j=[],l=-1,r=function(){n=n||c.once;for(f=g=!0;j.length;l=-1)for(e=j.shift();++l<m.length;)!1===m[l].apply(e[0],e[1])&&c.stopOnFalse&&(l=m.length,e=!1);c.memory||(e=!1);g=!1;n&&(m=e?[]:
"")},s={add:function(){return m&&(e&&!g&&(l=m.length-1,j.push(e)),function Mc(b){q.each(b,function(b,d){q.isFunction(d)?c.unique&&s.has(d)||m.push(d):d&&d.length&&"string"!==q.type(d)&&Mc(d)})}(arguments),e&&!g&&r()),this},remove:function(){return q.each(arguments,function(c,b){for(var d;-1<(d=q.inArray(b,m,d));)m.splice(d,1),d<=l&&l--}),this},has:function(c){return c?-1<q.inArray(c,m):0<m.length},empty:function(){return m&&(m=[]),this},disable:function(){return n=j=[],m=e="",this},disabled:function(){return!m},
lock:function(){return n=j=[],e||g||(m=e=""),this},locked:function(){return!!n},fireWith:function(c,b){return n||(b=b||[],b=[c,b.slice?b.slice():b],j.push(b),g||r()),this},fire:function(){return s.fireWith(this,arguments),this},fired:function(){return!!f}};return s};q.extend({Deferred:function(b){var d=[["notify","progress",q.Callbacks("memory"),q.Callbacks("memory"),2],["resolve","done",q.Callbacks("once memory"),q.Callbacks("once memory"),0,"resolved"],["reject","fail",q.Callbacks("once memory"),
q.Callbacks("once memory"),1,"rejected"]],e="pending",f={state:function(){return e},always:function(){return n.done(arguments).fail(arguments),this},"catch":function(c){return f.then(null,c)},pipe:function(){var c=arguments;return q.Deferred(function(b){q.each(d,function(d,g){var e=q.isFunction(c[g[4]])&&c[g[4]];n[g[1]](function(){var c=e&&e.apply(this,arguments);c&&q.isFunction(c.promise)?c.promise().progress(b.notify).done(b.resolve).fail(b.reject):b[g[0]+"With"](this,e?[c]:arguments)})});c=null}).promise()},
then:function(b,e,f){function n(b,d,e,f){return function(){var j=this,r=arguments,Z=function(){var c,Z;if(!(b<m)){if(c=e.apply(j,r),c===d.promise())throw new TypeError("Thenable self-resolution");Z=c&&("object"==typeof c||"function"==typeof c)&&c.then;q.isFunction(Z)?f?Z.call(c,n(m,d,l,f),n(m,d,g,f)):(m++,Z.call(c,n(m,d,l,f),n(m,d,g,f),n(m,d,l,d.notifyWith))):(e!==l&&(j=void 0,r=[c]),(f||d.resolveWith)(j,r))}},s=f?Z:function(){try{Z()}catch(c){q.Deferred.exceptionHook&&q.Deferred.exceptionHook(c,
s.stackTrace),b+1>=m&&(e!==g&&(j=void 0,r=[c]),d.rejectWith(j,r))}};b?s():(q.Deferred.getStackHook&&(s.stackTrace=q.Deferred.getStackHook()),c.setTimeout(s))}}var m=0;return q.Deferred(function(c){d[0][3].add(n(0,c,q.isFunction(f)?f:l,c.notifyWith));d[1][3].add(n(0,c,q.isFunction(b)?b:l));d[2][3].add(n(0,c,q.isFunction(e)?e:g))}).promise()},promise:function(c){return null!=c?q.extend(c,f):f}},n={};return q.each(d,function(c,b){var g=b[2],m=b[5];f[b[1]]=g.add;m&&g.add(function(){e=m},d[3-c][2].disable,
d[0][2].lock);g.add(b[3].fire);n[b[0]]=function(){return n[b[0]+"With"](this===n?void 0:this,arguments),this};n[b[0]+"With"]=g.fireWith}),f.promise(n),b&&b.call(n,n),n},when:function(c){var b=arguments.length,d=b,g=Array(d),e=pa.call(arguments),f=q.Deferred(),n=function(c){return function(d){g[c]=this;e[c]=1<arguments.length?pa.call(arguments):d;--b||f.resolveWith(g,e)}};if(1>=b&&(m(c,f.done(n(d)).resolve,f.reject,!b),"pending"===f.state()||q.isFunction(e[d]&&e[d].then)))return f.then();for(;d--;)m(e[d],
n(d),f.reject);return f.promise()}});var fd=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;q.Deferred.exceptionHook=function(b,d){c.console&&c.console.warn&&b&&fd.test(b.name)&&c.console.warn("jQuery.Deferred exception: "+b.message,b.stack,d)};q.readyException=function(b){c.setTimeout(function(){throw b;})};var Sb=q.Deferred();q.fn.ready=function(c){return Sb.then(c)["catch"](function(c){q.readyException(c)}),this};q.extend({isReady:!1,readyWait:1,ready:function(c){(!0===c?--q.readyWait:
q.isReady)||(q.isReady=!0,!0!==c&&0<--q.readyWait||Sb.resolveWith(G,[q]))}});q.ready.then=Sb.then;"complete"===G.readyState||"loading"!==G.readyState&&!G.documentElement.doScroll?c.setTimeout(q.ready):(G.addEventListener("DOMContentLoaded",n),c.addEventListener("load",n));var Na=function(c,b,d,g,e,f,n){var m=0,j=c.length,l=null==d;if("object"===q.type(d))for(m in e=!0,d)Na(c,b,m,d[m],!0,f,n);else if(void 0!==g&&(e=!0,q.isFunction(g)||(n=!0),l&&(n?(b.call(c,g),b=null):(l=b,b=function(c,b,d){return l.call(q(c),
d)})),b))for(;m<j;m++)b(c[m],d,n?g:g.call(c[m],m,b(c[m],d)));return e?c:l?b.call(c):j?b(c[0],d):f},Db=function(c){return 1===c.nodeType||9===c.nodeType||!+c.nodeType};r.uid=1;r.prototype={cache:function(c){var b=c[this.expando];return b||(b={},Db(c)&&(c.nodeType?c[this.expando]=b:Object.defineProperty(c,this.expando,{value:b,configurable:!0}))),b},set:function(c,b,d){var g;c=this.cache(c);if("string"==typeof b)c[q.camelCase(b)]=d;else for(g in b)c[q.camelCase(g)]=b[g];return c},get:function(c,b){return void 0===
b?this.cache(c):c[this.expando]&&c[this.expando][q.camelCase(b)]},access:function(c,b,d){return void 0===b||b&&"string"==typeof b&&void 0===d?this.get(c,b):(this.set(c,b,d),void 0!==d?d:b)},remove:function(c,b){var d,g=c[this.expando];if(void 0!==g){if(void 0!==b){Array.isArray(b)?b=b.map(q.camelCase):(b=q.camelCase(b),b=b in g?[b]:b.match(ua)||[]);for(d=b.length;d--;)delete g[b[d]]}(void 0===b||q.isEmptyObject(g))&&(c.nodeType?c[this.expando]=void 0:delete c[this.expando])}},hasData:function(c){c=
c[this.expando];return void 0!==c&&!q.isEmptyObject(c)}};var P=new r,ra=new r,Ic=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Hc=/[A-Z]/g;q.extend({hasData:function(c){return ra.hasData(c)||P.hasData(c)},data:function(c,b,d){return ra.access(c,b,d)},removeData:function(c,b){ra.remove(c,b)},_data:function(c,b,d){return P.access(c,b,d)},_removeData:function(c,b){P.remove(c,b)}});q.fn.extend({data:function(c,b){var d,g,e,f=this[0],n=f&&f.attributes;if(void 0===c){if(this.length&&(e=ra.get(f),1===f.nodeType&&!P.get(f,
"hasDataAttrs"))){for(d=n.length;d--;)n[d]&&(g=n[d].name,0===g.indexOf("data-")&&(g=q.camelCase(g.slice(5)),s(f,g,e[g])));P.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof c?this.each(function(){ra.set(this,c)}):Na(this,function(b){var d;if(f&&void 0===b){if((d=ra.get(f,c),void 0!==d)||(d=s(f,c),void 0!==d))return d}else this.each(function(){ra.set(this,c,b)})},null,b,1<arguments.length,null,!0)},removeData:function(c){return this.each(function(){ra.remove(this,c)})}});q.extend({queue:function(c,
b,d){var g;if(c)return b=(b||"fx")+"queue",g=P.get(c,b),d&&(!g||Array.isArray(d)?g=P.access(c,b,q.makeArray(d)):g.push(d)),g||[]},dequeue:function(c,b){b=b||"fx";var d=q.queue(c,b),g=d.length,e=d.shift(),f=q._queueHooks(c,b),n=function(){q.dequeue(c,b)};"inprogress"===e&&(e=d.shift(),g--);e&&("fx"===b&&d.unshift("inprogress"),delete f.stop,e.call(c,n,f));!g&&f&&f.empty.fire()},_queueHooks:function(c,b){var d=b+"queueHooks";return P.get(c,d)||P.access(c,d,{empty:q.Callbacks("once memory").add(function(){P.remove(c,
[b+"queue",d])})})}});q.fn.extend({queue:function(c,b){var d=2;return"string"!=typeof c&&(b=c,c="fx",d--),arguments.length<d?q.queue(this[0],c):void 0===b?this:this.each(function(){var d=q.queue(this,c,b);q._queueHooks(this,c);"fx"===c&&"inprogress"!==d[0]&&q.dequeue(this,c)})},dequeue:function(c){return this.each(function(){q.dequeue(this,c)})},clearQueue:function(c){return this.queue(c||"fx",[])},promise:function(c,b){var d,g=1,e=q.Deferred(),f=this,n=this.length,m=function(){--g||e.resolveWith(f,
[f])};"string"!=typeof c&&(b=c,c=void 0);for(c=c||"fx";n--;)(d=P.get(f[n],c+"queueHooks"))&&d.empty&&(g++,d.empty.add(m));return m(),e.promise(b)}});var nc=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,kb=RegExp("^(?:([+-])=|)("+nc+")([a-z%]*)$","i"),Wa=["Top","Right","Bottom","Left"],sb=function(c,b){return c=b||c,"none"===c.style.display||""===c.style.display&&q.contains(c.ownerDocument,c)&&"none"===q.css(c,"display")},oc=function(c,b,d,g){var e,f={};for(e in b)f[e]=c.style[e],c.style[e]=b[e];d=
d.apply(c,g||[]);for(e in b)c.style[e]=f[e];return d},Wb={};q.fn.extend({show:function(){return u(this,!0)},hide:function(){return u(this)},toggle:function(c){return"boolean"==typeof c?c?this.show():this.hide():this.each(function(){sb(this)?q(this).show():q(this).hide()})}});var pc=/^(?:checkbox|radio)$/i,Xb=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Yb=/^$|\/(?:java|ecma)script/i,ta={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],
tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ta.optgroup=ta.option;ta.tbody=ta.tfoot=ta.colgroup=ta.caption=ta.thead;ta.th=ta.td;var Jc=/<|&#?\w+;/,Eb=G.createDocumentFragment().appendChild(G.createElement("div")),Fb=G.createElement("input");Fb.setAttribute("type","radio");Fb.setAttribute("checked","checked");Fb.setAttribute("name","t");Eb.appendChild(Fb);ca.checkClone=Eb.cloneNode(!0).cloneNode(!0).lastChild.checked;Eb.innerHTML=
"<textarea>x</textarea>";ca.noCloneChecked=!!Eb.cloneNode(!0).lastChild.defaultValue;!0;var Gb=G.documentElement,gd=/^key/,hd=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,qc=/^([^.]*)(?:\.(.+)|)/;q.event={global:{},add:function(c,b,d,g,e){var f,n,m,j,l,r,s,p,E,t;if(l=P.get(c)){d.handler&&(f=d,d=f.handler,e=f.selector);e&&q.find.matchesSelector(Gb,e);d.guid||(d.guid=q.guid++);(j=l.events)||(j=l.events={});(n=l.handle)||(n=l.handle=function(b){return"undefined"!=typeof q&&q.event.triggered!==b.type?
q.event.dispatch.apply(c,arguments):void 0});b=(b||"").match(ua)||[""];for(l=b.length;l--;)m=qc.exec(b[l])||[],E=t=m[1],m=(m[2]||"").split(".").sort(),E&&(s=q.event.special[E]||{},E=(e?s.delegateType:s.bindType)||E,s=q.event.special[E]||{},r=q.extend({type:E,origType:t,data:g,handler:d,guid:d.guid,selector:e,needsContext:e&&q.expr.match.needsContext.test(e),namespace:m.join(".")},f),(p=j[E])||(p=j[E]=[],p.delegateCount=0,s.setup&&!1!==s.setup.call(c,g,m,n)||c.addEventListener&&c.addEventListener(E,
n)),s.add&&(s.add.call(c,r),r.handler.guid||(r.handler.guid=d.guid)),e?p.splice(p.delegateCount++,0,r):p.push(r),q.event.global[E]=!0)}},remove:function(c,b,d,g,e){var f,n,m,j,l,r,s,p,E,t,u,v=P.hasData(c)&&P.get(c);if(v&&(j=v.events)){b=(b||"").match(ua)||[""];for(l=b.length;l--;)if(m=qc.exec(b[l])||[],E=u=m[1],t=(m[2]||"").split(".").sort(),E){s=q.event.special[E]||{};E=(g?s.delegateType:s.bindType)||E;p=j[E]||[];m=m[2]&&RegExp("(^|\\.)"+t.join("\\.(?:.*\\.|)")+"(\\.|$)");for(n=f=p.length;f--;)r=
p[f],!e&&u!==r.origType||d&&d.guid!==r.guid||m&&!m.test(r.namespace)||g&&g!==r.selector&&("**"!==g||!r.selector)||(p.splice(f,1),r.selector&&p.delegateCount--,s.remove&&s.remove.call(c,r));n&&!p.length&&(s.teardown&&!1!==s.teardown.call(c,t,v.handle)||q.removeEvent(c,E,v.handle),delete j[E])}else for(E in j)q.event.remove(c,E+b[l],d,g,!0);q.isEmptyObject(j)&&P.remove(c,"handle events")}},dispatch:function(c){var b=q.event.fix(c),d,g,e,f,n,m,j=Array(arguments.length);g=(P.get(this,"events")||{})[b.type]||
[];var l=q.event.special[b.type]||{};j[0]=b;for(d=1;d<arguments.length;d++)j[d]=arguments[d];if(b.delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,b)){m=q.event.handlers.call(this,b,g);for(d=0;(f=m[d++])&&!b.isPropagationStopped();){b.currentTarget=f.elem;for(g=0;(n=f.handlers[g++])&&!b.isImmediatePropagationStopped();)b.rnamespace&&!b.rnamespace.test(n.namespace)||(b.handleObj=n,b.data=n.data,e=((q.event.special[n.origType]||{}).handle||n.handler).apply(f.elem,j),void 0!==e&&!1===
(b.result=e)&&(b.preventDefault(),b.stopPropagation()))}return l.postDispatch&&l.postDispatch.call(this,b),b.result}},handlers:function(c,b){var d,g,e,f,n,m=[],j=b.delegateCount,l=c.target;if(j&&l.nodeType&&!("click"===c.type&&1<=c.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==c.type||!0!==l.disabled)){f=[];n={};for(d=0;d<j;d++)g=b[d],e=g.selector+" ",void 0===n[e]&&(n[e]=g.needsContext?-1<q(e,this).index(l):q.find(e,this,null,[l]).length),n[e]&&f.push(g);f.length&&m.push({elem:l,
handlers:f})}return l=this,j<b.length&&m.push({elem:l,handlers:b.slice(j)}),m},addProp:function(c,b){Object.defineProperty(q.Event.prototype,c,{enumerable:!0,configurable:!0,get:q.isFunction(b)?function(){if(this.originalEvent)return b(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[c]},set:function(b){Object.defineProperty(this,c,{enumerable:!0,configurable:!0,writable:!0,value:b})}})},fix:function(c){return c[q.expando]?c:new q.Event(c)},special:{load:{noBubble:!0},
focus:{trigger:function(){if(this!==D()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===D()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&j(this,"input"))return this.click(),!1},_default:function(c){return j(c.target,"a")}},beforeunload:{postDispatch:function(c){void 0!==c.result&&c.originalEvent&&(c.originalEvent.returnValue=c.result)}}}};q.removeEvent=function(c,b,d){c.removeEventListener&&
c.removeEventListener(b,d)};q.Event=function(c,b){return this instanceof q.Event?(c&&c.type?(this.originalEvent=c,this.type=c.type,this.isDefaultPrevented=c.defaultPrevented||void 0===c.defaultPrevented&&!1===c.returnValue?B:A,this.target=c.target&&3===c.target.nodeType?c.target.parentNode:c.target,this.currentTarget=c.currentTarget,this.relatedTarget=c.relatedTarget):this.type=c,b&&q.extend(this,b),this.timeStamp=c&&c.timeStamp||q.now(),void(this[q.expando]=!0)):new q.Event(c,b)};q.Event.prototype=
{constructor:q.Event,isDefaultPrevented:A,isPropagationStopped:A,isImmediatePropagationStopped:A,isSimulated:!1,preventDefault:function(){var c=this.originalEvent;this.isDefaultPrevented=B;c&&!this.isSimulated&&c.preventDefault()},stopPropagation:function(){var c=this.originalEvent;this.isPropagationStopped=B;c&&!this.isSimulated&&c.stopPropagation()},stopImmediatePropagation:function(){var c=this.originalEvent;this.isImmediatePropagationStopped=B;c&&!this.isSimulated&&c.stopImmediatePropagation();
this.stopPropagation()}};q.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(c){var b=c.button;return null==c.which&&gd.test(c.type)?null!=c.charCode?c.charCode:c.keyCode:!c.which&&void 0!==b&&hd.test(c.type)?
1&b?1:2&b?3:4&b?2:0:c.which}},q.event.addProp);q.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(c,b){q.event.special[c]={delegateType:b,bindType:b,handle:function(c){var d,g=c.relatedTarget,e=c.handleObj;return g&&(g===this||q.contains(this,g))||(c.type=e.origType,d=e.handler.apply(this,arguments),c.type=b),d}}});q.fn.extend({on:function(c,b,d,g){return I(this,c,b,d,g)},one:function(c,b,d,g){return I(this,c,b,d,g,1)},off:function(c,
b,d){var g,e;if(c&&c.preventDefault&&c.handleObj)return g=c.handleObj,q(c.delegateTarget).off(g.namespace?g.origType+"."+g.namespace:g.origType,g.selector,g.handler),this;if("object"==typeof c){for(e in c)this.off(e,b,c[e]);return this}return!1!==b&&"function"!=typeof b||(d=b,b=void 0),!1===d&&(d=A),this.each(function(){q.event.remove(this,c,d,b)})}});var id=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,jd=/<script|<style|<link/i,Lc=/checked\s*(?:[^=]|=\s*.checked.)/i,
Kc=/^true\/(.*)/,Nc=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;q.extend({htmlPrefilter:function(c){return c.replace(id,"<$1></$2>")},clone:function(c,b,d){var g,e,f,n,m=c.cloneNode(!0),j=q.contains(c.ownerDocument,c);if(!ca.noCloneChecked&&!(1!==c.nodeType&&11!==c.nodeType||q.isXMLDoc(c))){n=v(m);f=v(c);g=0;for(e=f.length;g<e;g++){var l=f[g],r=n[g],s=r.nodeName.toLowerCase();"input"===s&&pc.test(l.type)?r.checked=l.checked:"input"!==s&&"textarea"!==s||(r.defaultValue=l.defaultValue)}}if(b)if(d){f=
f||v(c);n=n||v(m);g=0;for(e=f.length;g<e;g++)M(f[g],n[g])}else M(c,m);return n=v(m,"script"),0<n.length&&z(n,!j&&v(c,"script")),m},cleanData:function(c){for(var b,d,g,e=q.event.special,f=0;void 0!==(d=c[f]);f++)if(Db(d)){if(b=d[P.expando]){if(b.events)for(g in b.events)e[g]?q.event.remove(d,g):q.removeEvent(d,g,b.handle);d[P.expando]=void 0}d[ra.expando]&&(d[ra.expando]=void 0)}}});q.fn.extend({detach:function(c){return N(this,c,!0)},remove:function(c){return N(this,c)},text:function(c){return Na(this,
function(c){return void 0===c?q.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=c)})},null,c,arguments.length)},append:function(){return O(this,arguments,function(c){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&y(this,c).appendChild(c)})},prepend:function(){return O(this,arguments,function(c){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=y(this,c);b.insertBefore(c,b.firstChild)}})},before:function(){return O(this,
arguments,function(c){this.parentNode&&this.parentNode.insertBefore(c,this)})},after:function(){return O(this,arguments,function(c){this.parentNode&&this.parentNode.insertBefore(c,this.nextSibling)})},empty:function(){for(var c,b=0;null!=(c=this[b]);b++)1===c.nodeType&&(q.cleanData(v(c,!1)),c.textContent="");return this},clone:function(c,b){return c=null!=c&&c,b=null==b?c:b,this.map(function(){return q.clone(this,c,b)})},html:function(c){return Na(this,function(c){var b=this[0]||{},d=0,g=this.length;
if(void 0===c&&1===b.nodeType)return b.innerHTML;if("string"==typeof c&&!jd.test(c)&&!ta[(Xb.exec(c)||["",""])[1].toLowerCase()]){c=q.htmlPrefilter(c);try{for(;d<g;d++)b=this[d]||{},1===b.nodeType&&(q.cleanData(v(b,!1)),b.innerHTML=c);b=0}catch(e){}}b&&this.empty().append(c)},null,c,arguments.length)},replaceWith:function(){var c=[];return O(this,arguments,function(b){var d=this.parentNode;0>q.inArray(this,c)&&(q.cleanData(v(this)),d&&d.replaceChild(b,this))},c)}});q.each({appendTo:"append",prependTo:"prepend",
insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(c,b){q.fn[c]=function(c){for(var d=[],g=q(c),e=g.length-1,f=0;f<=e;f++)c=f===e?this:this.clone(!0),q(g[f])[b](c),Oa.apply(d,c.get());return this.pushStack(d)}});var Zb=/^margin/,Jb=RegExp("^("+nc+")(?!px)[a-z%]+$","i"),tb=function(b){var d=b.ownerDocument.defaultView;return d&&d.opener||(d=c),d.getComputedStyle(b)},Ib=function(){if(Ca){Ca.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%";
Ca.innerHTML="";Gb.appendChild(Hb);var b=c.getComputedStyle(Ca);rc="1%"!==b.top;sc="2px"===b.marginLeft;tc="4px"===b.width;Ca.style.marginRight="50%";uc="4px"===b.marginRight;Gb.removeChild(Hb);Ca=null}},rc,tc,uc,sc,Hb=G.createElement("div"),Ca=G.createElement("div");Ca.style&&(Ca.style.backgroundClip="content-box",Ca.cloneNode(!0).style.backgroundClip="",ca.clearCloneStyle="content-box"===Ca.style.backgroundClip,Hb.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",
Hb.appendChild(Ca),q.extend(ca,{pixelPosition:function(){return Ib(),rc},boxSizingReliable:function(){return Ib(),tc},pixelMarginRight:function(){return Ib(),uc},reliableMarginLeft:function(){return Ib(),sc}}));!0;var kd=/^(none|table(?!-c[ea]).+)/,vc=/^--/,ld={position:"absolute",visibility:"hidden",display:"block"},wc={letterSpacing:"0",fontWeight:"400"},ac=["Webkit","Moz","ms"],$b=G.createElement("div").style;q.extend({cssHooks:{opacity:{get:function(c,b){if(b){var d=K(c,"opacity");return""===
d?"1":d}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(c,b,d,g){if(c&&3!==c.nodeType&&8!==c.nodeType&&c.style){var e,f,n,m=q.camelCase(b),j=vc.test(b),l=c.style;return j||(b=ea(m)),n=q.cssHooks[b]||q.cssHooks[m],void 0===d?n&&"get"in n&&void 0!==(e=n.get(c,!1,g))?e:l[b]:(f=typeof d,"string"===f&&(e=kb.exec(d))&&e[1]&&
(d=t(c,b,e),f="number"),null!=d&&d===d&&("number"===f&&(d+=e&&e[3]||(q.cssNumber[m]?"":"px")),ca.clearCloneStyle||""!==d||0!==b.indexOf("background")||(l[b]="inherit"),n&&"set"in n&&void 0===(d=n.set(c,d,g))||(j?l.setProperty(b,d):l[b]=d)),void 0)}},css:function(c,b,d,g){var e,f,n,m=q.camelCase(b);return vc.test(b)||(b=ea(m)),n=q.cssHooks[b]||q.cssHooks[m],n&&"get"in n&&(e=n.get(c,!0,d)),void 0===e&&(e=K(c,b,g)),"normal"===e&&b in wc&&(e=wc[b]),""===d||d?(f=parseFloat(e),!0===d||isFinite(f)?f||0:
e):e}});q.each(["height","width"],function(c,b){q.cssHooks[b]={get:function(c,d,g){if(d)return!kd.test(q.css(c,"display"))||c.getClientRects().length&&c.getBoundingClientRect().width?ia(c,b,g):oc(c,ld,function(){return ia(c,b,g)})},set:function(c,d,g){var e,f=g&&tb(c);g=g&&H(c,b,g,"border-box"===q.css(c,"boxSizing",!1,f),f);return g&&(e=kb.exec(d))&&"px"!==(e[3]||"px")&&(c.style[b]=d,d=q.css(c,b)),F(c,d,g)}}});q.cssHooks.marginLeft=W(ca.reliableMarginLeft,function(c,b){if(b)return(parseFloat(K(c,
"marginLeft"))||c.getBoundingClientRect().left-oc(c,{marginLeft:0},function(){return c.getBoundingClientRect().left}))+"px"});q.each({margin:"",padding:"",border:"Width"},function(c,b){q.cssHooks[c+b]={expand:function(d){var g=0,e={};for(d="string"==typeof d?d.split(" "):[d];4>g;g++)e[c+Wa[g]+b]=d[g]||d[g-2]||d[0];return e}};Zb.test(c)||(q.cssHooks[c+b].set=F)});q.fn.extend({css:function(c,b){return Na(this,function(c,b,d){var g,e={},f=0;if(Array.isArray(b)){d=tb(c);for(g=b.length;f<g;f++)e[b[f]]=
q.css(c,b[f],!1,d);return e}return void 0!==d?q.style(c,b,d):q.css(c,b)},c,b,1<arguments.length)}});q.Tween=R;R.prototype={constructor:R,init:function(c,b,d,g,e,f){this.elem=c;this.prop=d;this.easing=e||q.easing._default;this.options=b;this.start=this.now=this.cur();this.end=g;this.unit=f||(q.cssNumber[d]?"":"px")},cur:function(){var c=R.propHooks[this.prop];return c&&c.get?c.get(this):R.propHooks._default.get(this)},run:function(c){var b,d=R.propHooks[this.prop];return this.options.duration?this.pos=
b=q.easing[this.easing](c,this.options.duration*c,0,1,this.options.duration):this.pos=b=c,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),d&&d.set?d.set(this):R.propHooks._default.set(this),this}};R.prototype.init.prototype=R.prototype;R.propHooks={_default:{get:function(c){var b;return 1!==c.elem.nodeType||null!=c.elem[c.prop]&&null==c.elem.style[c.prop]?c.elem[c.prop]:(b=q.css(c.elem,c.prop,""),b&&"auto"!==b?b:0)},set:function(c){q.fx.step[c.prop]?
q.fx.step[c.prop](c):1!==c.elem.nodeType||null==c.elem.style[q.cssProps[c.prop]]&&!q.cssHooks[c.prop]?c.elem[c.prop]=c.now:q.style(c.elem,c.prop,c.now+c.unit)}}};R.propHooks.scrollTop=R.propHooks.scrollLeft={set:function(c){c.elem.nodeType&&c.elem.parentNode&&(c.elem[c.prop]=c.now)}};q.easing={linear:function(c){return c},swing:function(c){return 0.5-Math.cos(c*Math.PI)/2},_default:"swing"};q.fx=R.prototype.init;q.fx.step={};var bb,ub,md=/^(?:toggle|show|hide)$/,nd=/queueHooks$/;q.Animation=q.extend(ba,
{tweeners:{"*":[function(c,b){var d=this.createTween(c,b);return t(d.elem,c,kb.exec(b),d),d}]},tweener:function(c,b){q.isFunction(c)?(b=c,c=["*"]):c=c.match(ua);for(var d,g=0,e=c.length;g<e;g++)d=c[g],ba.tweeners[d]=ba.tweeners[d]||[],ba.tweeners[d].unshift(b)},prefilters:[function(c,b,d){var g,e,f,n,m,j,l,r,s="width"in b||"height"in b,p=this,E={},t=c.style,v=c.nodeType&&sb(c),V=P.get(c,"fxshow");d.queue||(n=q._queueHooks(c,"fx"),null==n.unqueued&&(n.unqueued=0,m=n.empty.fire,n.empty.fire=function(){n.unqueued||
m()}),n.unqueued++,p.always(function(){p.always(function(){n.unqueued--;q.queue(c,"fx").length||n.empty.fire()})}));for(g in b)if(e=b[g],md.test(e)){if(delete b[g],f=f||"toggle"===e,e===(v?"hide":"show")){if("show"!==e||!V||void 0===V[g])continue;v=!0}E[g]=V&&V[g]||q.style(c,g)}if(j=!q.isEmptyObject(b),j||!q.isEmptyObject(E))for(g in s&&1===c.nodeType&&(d.overflow=[t.overflow,t.overflowX,t.overflowY],l=V&&V.display,null==l&&(l=P.get(c,"display")),r=q.css(c,"display"),"none"===r&&(l?r=l:(u([c],!0),
l=c.style.display||l,r=q.css(c,"display"),u([c]))),("inline"===r||"inline-block"===r&&null!=l)&&"none"===q.css(c,"float")&&(j||(p.done(function(){t.display=l}),null==l&&(r=t.display,l="none"===r?"":r)),t.display="inline-block")),d.overflow&&(t.overflow="hidden",p.always(function(){t.overflow=d.overflow[0];t.overflowX=d.overflow[1];t.overflowY=d.overflow[2]})),j=!1,E)j||(V?"hidden"in V&&(v=V.hidden):V=P.access(c,"fxshow",{display:l}),f&&(V.hidden=!v),v&&u([c],!0),p.done(function(){v||u([c]);P.remove(c,
"fxshow");for(g in E)q.style(c,g,E[g])})),j=aa(v?V[g]:0,g,p),g in V||(V[g]=j.start,v&&(j.end=j.start,j.start=0))}],prefilter:function(c,b){b?ba.prefilters.unshift(c):ba.prefilters.push(c)}});q.speed=function(c,b,d){var g=c&&"object"==typeof c?q.extend({},c):{complete:d||!d&&b||q.isFunction(c)&&c,duration:c,easing:d&&b||b&&!q.isFunction(b)&&b};return q.fx.off?g.duration=0:"number"!=typeof g.duration&&(g.duration in q.fx.speeds?g.duration=q.fx.speeds[g.duration]:g.duration=q.fx.speeds._default),null!=
g.queue&&!0!==g.queue||(g.queue="fx"),g.old=g.complete,g.complete=function(){q.isFunction(g.old)&&g.old.call(this);g.queue&&q.dequeue(this,g.queue)},g};q.fn.extend({fadeTo:function(c,b,d,g){return this.filter(sb).css("opacity",0).show().end().animate({opacity:b},c,d,g)},animate:function(c,b,d,g){var e=q.isEmptyObject(c),f=q.speed(b,d,g);b=function(){var b=ba(this,q.extend({},c),f);(e||P.get(this,"finish"))&&b.stop(!0)};return b.finish=b,e||!1===f.queue?this.each(b):this.queue(f.queue,b)},stop:function(c,
b,d){var g=function(c){var b=c.stop;delete c.stop;b(d)};return"string"!=typeof c&&(d=b,b=c,c=void 0),b&&!1!==c&&this.queue(c||"fx",[]),this.each(function(){var b=!0,e=null!=c&&c+"queueHooks",f=q.timers,n=P.get(this);if(e)n[e]&&n[e].stop&&g(n[e]);else for(e in n)n[e]&&n[e].stop&&nd.test(e)&&g(n[e]);for(e=f.length;e--;)f[e].elem!==this||null!=c&&f[e].queue!==c||(f[e].anim.stop(d),b=!1,f.splice(e,1));!b&&d||q.dequeue(this,c)})},finish:function(c){return!1!==c&&(c=c||"fx"),this.each(function(){var b,
d=P.get(this),g=d[c+"queue"];b=d[c+"queueHooks"];var e=q.timers,f=g?g.length:0;d.finish=!0;q.queue(this,c,[]);b&&b.stop&&b.stop.call(this,!0);for(b=e.length;b--;)e[b].elem===this&&e[b].queue===c&&(e[b].anim.stop(!0),e.splice(b,1));for(b=0;b<f;b++)g[b]&&g[b].finish&&g[b].finish.call(this);delete d.finish})}});q.each(["toggle","show","hide"],function(c,b){var d=q.fn[b];q.fn[b]=function(c,g,e){return null==c||"boolean"==typeof c?d.apply(this,arguments):this.animate(Q(b,!0),c,g,e)}});q.each({slideDown:Q("show"),
slideUp:Q("hide"),slideToggle:Q("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(c,b){q.fn[c]=function(c,d,g){return this.animate(b,c,d,g)}});q.timers=[];q.fx.tick=function(){var c,b=0,d=q.timers;for(bb=q.now();b<d.length;b++)c=d[b],c()||d[b]!==c||d.splice(b--,1);d.length||q.fx.stop();bb=void 0};q.fx.timer=function(c){q.timers.push(c);q.fx.start()};q.fx.interval=13;q.fx.start=function(){ub||(ub=!0,L())};q.fx.stop=function(){ub=null};q.fx.speeds={slow:600,
fast:200,_default:400};q.fn.delay=function(b,d){return b=q.fx?q.fx.speeds[b]||b:b,d=d||"fx",this.queue(d,function(d,g){var e=c.setTimeout(d,b);g.stop=function(){c.clearTimeout(e)}})};var jb=G.createElement("input"),od=G.createElement("select").appendChild(G.createElement("option"));jb.type="checkbox";ca.checkOn=""!==jb.value;ca.optSelected=od.selected;jb=G.createElement("input");jb.value="t";jb.type="radio";ca.radioValue="t"===jb.value;var xc,pb=q.expr.attrHandle;q.fn.extend({attr:function(c,b){return Na(this,
q.attr,c,b,1<arguments.length)},removeAttr:function(c){return this.each(function(){q.removeAttr(this,c)})}});q.extend({attr:function(c,b,d){var g,e,f=c.nodeType;if(3!==f&&8!==f&&2!==f)return"undefined"==typeof c.getAttribute?q.prop(c,b,d):(1===f&&q.isXMLDoc(c)||(e=q.attrHooks[b.toLowerCase()]||(q.expr.match.bool.test(b)?xc:void 0)),void 0!==d?null===d?void q.removeAttr(c,b):e&&"set"in e&&void 0!==(g=e.set(c,d,b))?g:(c.setAttribute(b,d+""),d):e&&"get"in e&&null!==(g=e.get(c,b))?g:(g=q.find.attr(c,
b),null==g?void 0:g))},attrHooks:{type:{set:function(c,b){if(!ca.radioValue&&"radio"===b&&j(c,"input")){var d=c.value;return c.setAttribute("type",b),d&&(c.value=d),b}}}},removeAttr:function(c,b){var d,g=0,e=b&&b.match(ua);if(e&&1===c.nodeType)for(;d=e[g++];)c.removeAttribute(d)}});xc={set:function(c,b,d){return!1===b?q.removeAttr(c,d):c.setAttribute(d,d),d}};q.each(q.expr.match.bool.source.match(/\w+/g),function(c,b){var d=pb[b]||q.find.attr;pb[b]=function(c,b,g){var e,f,n=b.toLowerCase();return g||
(f=pb[n],pb[n]=e,e=null!=d(c,b,g)?n:null,pb[n]=f),e}});var pd=/^(?:input|select|textarea|button)$/i,qd=/^(?:a|area)$/i;q.fn.extend({prop:function(c,b){return Na(this,q.prop,c,b,1<arguments.length)},removeProp:function(c){return this.each(function(){delete this[q.propFix[c]||c]})}});q.extend({prop:function(c,b,d){var g,e,f=c.nodeType;if(3!==f&&8!==f&&2!==f)return 1===f&&q.isXMLDoc(c)||(b=q.propFix[b]||b,e=q.propHooks[b]),void 0!==d?e&&"set"in e&&void 0!==(g=e.set(c,d,b))?g:c[b]=d:e&&"get"in e&&null!==
(g=e.get(c,b))?g:c[b]},propHooks:{tabIndex:{get:function(c){var b=q.find.attr(c,"tabindex");return b?parseInt(b,10):pd.test(c.nodeName)||qd.test(c.nodeName)&&c.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}});ca.optSelected||(q.propHooks.selected={get:function(c){c=c.parentNode;return c&&c.parentNode&&c.parentNode.selectedIndex,null},set:function(c){c=c.parentNode;c&&(c.selectedIndex,c.parentNode&&c.parentNode.selectedIndex)}});q.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),
function(){q.propFix[this.toLowerCase()]=this});q.fn.extend({addClass:function(c){var b,d,g,e,f,n,m=0;if(q.isFunction(c))return this.each(function(b){q(this).addClass(c.call(this,b,qa(this)))});if("string"==typeof c&&c)for(b=c.match(ua)||[];d=this[m++];)if(e=qa(d),g=1===d.nodeType&&" "+la(e)+" "){for(n=0;f=b[n++];)0>g.indexOf(" "+f+" ")&&(g+=f+" ");g=la(g);e!==g&&d.setAttribute("class",g)}return this},removeClass:function(c){var b,d,g,e,f,n,m=0;if(q.isFunction(c))return this.each(function(b){q(this).removeClass(c.call(this,
b,qa(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof c&&c)for(b=c.match(ua)||[];d=this[m++];)if(e=qa(d),g=1===d.nodeType&&" "+la(e)+" "){for(n=0;f=b[n++];)for(;-1<g.indexOf(" "+f+" ");)g=g.replace(" "+f+" "," ");g=la(g);e!==g&&d.setAttribute("class",g)}return this},toggleClass:function(c,b){var d=typeof c;return"boolean"==typeof b&&"string"===d?b?this.addClass(c):this.removeClass(c):q.isFunction(c)?this.each(function(d){q(this).toggleClass(c.call(this,d,qa(this),b),
b)}):this.each(function(){var b,g,e,f;if("string"===d){g=0;e=q(this);for(f=c.match(ua)||[];b=f[g++];)e.hasClass(b)?e.removeClass(b):e.addClass(b)}else void 0!==c&&"boolean"!==d||(b=qa(this),b&&P.set(this,"__className__",b),this.setAttribute&&this.setAttribute("class",b||!1===c?"":P.get(this,"__className__")||""))})},hasClass:function(c){var b,d=0;for(c=" "+c+" ";b=this[d++];)if(1===b.nodeType&&-1<(" "+la(qa(b))+" ").indexOf(c))return!0;return!1}});var rd=/\r/g;q.fn.extend({val:function(c){var b,d,
g,e=this[0];if(arguments.length)return g=q.isFunction(c),this.each(function(d){var e;1===this.nodeType&&(e=g?c.call(this,d,q(this).val()):c,null==e?e="":"number"==typeof e?e+="":Array.isArray(e)&&(e=q.map(e,function(c){return null==c?"":c+""})),b=q.valHooks[this.type]||q.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=q.valHooks[e.type]||q.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(d=b.get(e,"value"))?d:(d=e.value,
"string"==typeof d?d.replace(rd,""):null==d?"":d)}});q.extend({valHooks:{option:{get:function(c){var b=q.find.attr(c,"value");return null!=b?b:la(q.text(c))}},select:{get:function(c){var b,d,g=c.options,e=c.selectedIndex,f="select-one"===c.type,n=f?null:[],m=f?e+1:g.length;for(d=0>e?m:f?e:0;d<m;d++)if(b=g[d],(b.selected||d===e)&&!b.disabled&&(!b.parentNode.disabled||!j(b.parentNode,"optgroup"))){if(c=q(b).val(),f)return c;n.push(c)}return n},set:function(c,b){for(var d,g,e=c.options,f=q.makeArray(b),
n=e.length;n--;)g=e[n],(g.selected=-1<q.inArray(q.valHooks.option.get(g),f))&&(d=!0);return d||(c.selectedIndex=-1),f}}}});q.each(["radio","checkbox"],function(){q.valHooks[this]={set:function(c,b){if(Array.isArray(b))return c.checked=-1<q.inArray(q(c).val(),b)}};ca.checkOn||(q.valHooks[this].get=function(c){return null===c.getAttribute("value")?"on":c.value})});var yc=/^(?:focusinfocus|focusoutblur)$/;q.extend(q.event,{trigger:function(b,d,g,e){var f,n,m,j,l,r,s,p=[g||G],E=db.call(b,"type")?b.type:
b;f=db.call(b,"namespace")?b.namespace.split("."):[];if(n=m=g=g||G,3!==g.nodeType&&8!==g.nodeType&&!yc.test(E+q.event.triggered)&&(-1<E.indexOf(".")&&(f=E.split("."),E=f.shift(),f.sort()),l=0>E.indexOf(":")&&"on"+E,b=b[q.expando]?b:new q.Event(E,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=f.join("."),b.rnamespace=b.namespace?RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=g),d=null==d?[b]:q.makeArray(d,[b]),s=q.event.special[E]||{},e||!s.trigger||
!1!==s.trigger.apply(g,d))){if(!e&&!s.noBubble&&!q.isWindow(g)){j=s.delegateType||E;for(yc.test(j+E)||(n=n.parentNode);n;n=n.parentNode)p.push(n),m=n;m===(g.ownerDocument||G)&&p.push(m.defaultView||m.parentWindow||c)}for(f=0;(n=p[f++])&&!b.isPropagationStopped();)b.type=1<f?j:s.bindType||E,(r=(P.get(n,"events")||{})[b.type]&&P.get(n,"handle"))&&r.apply(n,d),(r=l&&n[l])&&r.apply&&Db(n)&&(b.result=r.apply(n,d),!1===b.result&&b.preventDefault());return b.type=E,e||b.isDefaultPrevented()||s._default&&
!1!==s._default.apply(p.pop(),d)||!Db(g)||l&&q.isFunction(g[E])&&!q.isWindow(g)&&(m=g[l],m&&(g[l]=null),q.event.triggered=E,g[E](),q.event.triggered=void 0,m&&(g[l]=m)),b.result}},simulate:function(c,b,d){c=q.extend(new q.Event,d,{type:c,isSimulated:!0});q.event.trigger(c,null,b)}});q.fn.extend({trigger:function(c,b){return this.each(function(){q.event.trigger(c,b,this)})},triggerHandler:function(c,b){var d=this[0];if(d)return q.event.trigger(c,b,d,!0)}});q.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),
function(c,b){q.fn[b]=function(c,d){return 0<arguments.length?this.on(b,null,c,d):this.trigger(b)}});q.fn.extend({hover:function(c,b){return this.mouseenter(c).mouseleave(b||c)}});ca.focusin="onfocusin"in c;ca.focusin||q.each({focus:"focusin",blur:"focusout"},function(c,b){var d=function(c){q.event.simulate(b,c.target,q.event.fix(c))};q.event.special[b]={setup:function(){var g=this.ownerDocument||this,e=P.access(g,b);e||g.addEventListener(c,d,!0);P.access(g,b,(e||0)+1)},teardown:function(){var g=
this.ownerDocument||this,e=P.access(g,b)-1;e?P.access(g,b,e):(g.removeEventListener(c,d,!0),P.remove(g,b))}}});var qb=c.location,zc=q.now(),Tb=/\?/;q.parseXML=function(b){var d;if(!b||"string"!=typeof b)return null;try{d=(new c.DOMParser).parseFromString(b,"text/xml")}catch(g){d=void 0}return d&&!d.getElementsByTagName("parsererror").length||q.error("Invalid XML: "+b),d};var Oc=/\[\]$/,Ac=/\r?\n/g,sd=/^(?:submit|button|image|reset|file)$/i,td=/^(?:input|select|textarea|keygen)/i;q.param=function(c,
b){var d,g=[],e=function(c,b){var d=q.isFunction(b)?b():b;g[g.length]=encodeURIComponent(c)+"="+encodeURIComponent(null==d?"":d)};if(Array.isArray(c)||c.jquery&&!q.isPlainObject(c))q.each(c,function(){e(this.name,this.value)});else for(d in c)fa(d,c[d],b,e);return g.join("&")};q.fn.extend({serialize:function(){return q.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var c=q.prop(this,"elements");return c?q.makeArray(c):this}).filter(function(){var c=this.type;return this.name&&
!q(this).is(":disabled")&&td.test(this.nodeName)&&!sd.test(c)&&(this.checked||!pc.test(c))}).map(function(c,b){var d=q(this).val();return null==d?null:Array.isArray(d)?q.map(d,function(c){return{name:b.name,value:c.replace(Ac,"\r\n")}}):{name:b.name,value:d.replace(Ac,"\r\n")}}).get()}});var ud=/%20/g,vd=/#.*$/,wd=/([?&])_=[^&]*/,xd=/^(.*?):[ \t]*([^\r\n]*)$/gm,yd=/^(?:GET|HEAD)$/,zd=/^\/\//,Bc={},Kb={},Cc="*/".concat("*"),Ub=G.createElement("a");Ub.href=qb.href;q.extend({active:0,lastModified:{},
etag:{},ajaxSettings:{url:qb.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(qb.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Cc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,
"text html":!0,"text json":JSON.parse,"text xml":q.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(c,b){return b?V(V(c,q.ajaxSettings),b):V(q.ajaxSettings,c)},ajaxPrefilter:oa(Bc),ajaxTransport:oa(Kb),ajax:function(b,d){function g(b,d,m,l){var p,E,t,ha,na=d;if(!r){r=!0;j&&c.clearTimeout(j);e=void 0;n=l||"";y.readyState=0<b?4:0;l=200<=b&&300>b||304===b;if(m){t=u;for(var x=y,L,K,M,G,T=t.contents,H=t.dataTypes;"*"===H[0];)H.shift(),void 0===L&&(L=t.mimeType||x.getResponseHeader("Content-Type"));
if(L)for(K in T)if(T[K]&&T[K].test(L)){H.unshift(K);break}if(H[0]in m)M=H[0];else{for(K in m){if(!H[0]||t.converters[K+" "+H[0]]){M=K;break}G||(G=K)}M=M||G}m=M?(M!==H[0]&&H.unshift(M),m[M]):void 0;t=m}var Z;a:{m=u;L=t;K=y;M=l;var F,aa,B;t={};x=m.dataTypes.slice();if(x[1])for(F in m.converters)t[F.toLowerCase()]=m.converters[F];for(G=x.shift();G;)if(m.responseFields[G]&&(K[m.responseFields[G]]=L),!B&&M&&m.dataFilter&&(L=m.dataFilter(L,m.dataType)),B=G,G=x.shift())if("*"===G)G=B;else if("*"!==B&&B!==
G){if(F=t[B+" "+G]||t["* "+G],!F)for(Z in t)if(aa=Z.split(" "),aa[1]===G&&(F=t[B+" "+aa[0]]||t["* "+aa[0]])){!0===F?F=t[Z]:!0!==t[Z]&&(G=aa[0],x.unshift(aa[1]));break}if(!0!==F)if(F&&m["throws"])L=F(L);else try{L=F(L)}catch(fb){Z={state:"parsererror",error:F?fb:"No conversion from "+B+" to "+G};break a}}Z={state:"success",data:L}}t=Z;l?(u.ifModified&&(ha=y.getResponseHeader("Last-Modified"),ha&&(q.lastModified[f]=ha),ha=y.getResponseHeader("etag"),ha&&(q.etag[f]=ha)),204===b||"HEAD"===u.type?na="nocontent":
304===b?na="notmodified":(na=t.state,p=t.data,E=t.error,l=!E)):(E=na,!b&&na||(na="error",0>b&&(b=0)));y.status=b;y.statusText=(d||na)+"";l?z.resolveWith(v,[p,na,y]):z.rejectWith(v,[y,na,E]);y.statusCode(Q);Q=void 0;s&&V.trigger(l?"ajaxSuccess":"ajaxError",[y,u,l?p:E]);U.fireWith(v,[y,na]);s&&(V.trigger("ajaxComplete",[y,u]),--q.active||q.event.trigger("ajaxStop"))}}"object"==typeof b&&(d=b,b=void 0);d=d||{};var e,f,n,m,j,l,r,s,p,t,u=q.ajaxSetup({},d),v=u.context||u,V=u.context&&(v.nodeType||v.jquery)?
q(v):q.event,z=q.Deferred(),U=q.Callbacks("once memory"),Q=u.statusCode||{},ha={},na={},x="canceled",y={readyState:0,getResponseHeader:function(c){var b;if(r){if(!m)for(m={};b=xd.exec(n);)m[b[1].toLowerCase()]=b[2];b=m[c.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return r?n:null},setRequestHeader:function(c,b){return null==r&&(c=na[c.toLowerCase()]=na[c.toLowerCase()]||c,ha[c]=b),this},overrideMimeType:function(c){return null==r&&(u.mimeType=c),this},statusCode:function(c){var b;
if(c)if(r)y.always(c[y.status]);else for(b in c)Q[b]=[Q[b],c[b]];return this},abort:function(c){c=c||x;return e&&e.abort(c),g(0,c),this}};if(z.promise(y),u.url=((b||u.url||qb.href)+"").replace(zd,qb.protocol+"//"),u.type=d.method||d.type||u.method||u.type,u.dataTypes=(u.dataType||"*").toLowerCase().match(ua)||[""],null==u.crossDomain){l=G.createElement("a");try{l.href=u.url,l.href=l.href,u.crossDomain=Ub.protocol+"//"+Ub.host!=l.protocol+"//"+l.host}catch(L){u.crossDomain=!0}}if(u.data&&u.processData&&
"string"!=typeof u.data&&(u.data=q.param(u.data,u.traditional)),E(Bc,u,d,y),r)return y;(s=q.event&&u.global)&&0===q.active++&&q.event.trigger("ajaxStart");u.type=u.type.toUpperCase();u.hasContent=!yd.test(u.type);f=u.url.replace(vd,"");u.hasContent?u.data&&u.processData&&0===(u.contentType||"").indexOf("application/x-www-form-urlencoded")&&(u.data=u.data.replace(ud,"+")):(t=u.url.slice(f.length),u.data&&(f+=(Tb.test(f)?"&":"?")+u.data,delete u.data),!1===u.cache&&(f=f.replace(wd,"$1"),t=(Tb.test(f)?
"&":"?")+"_="+zc++ +t),u.url=f+t);u.ifModified&&(q.lastModified[f]&&y.setRequestHeader("If-Modified-Since",q.lastModified[f]),q.etag[f]&&y.setRequestHeader("If-None-Match",q.etag[f]));(u.data&&u.hasContent&&!1!==u.contentType||d.contentType)&&y.setRequestHeader("Content-Type",u.contentType);y.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+Cc+"; q=0.01":""):u.accepts["*"]);for(p in u.headers)y.setRequestHeader(p,u.headers[p]);
if(u.beforeSend&&(!1===u.beforeSend.call(v,y,u)||r))return y.abort();if(x="abort",U.add(u.complete),y.done(u.success),y.fail(u.error),e=E(Kb,u,d,y)){if(y.readyState=1,s&&V.trigger("ajaxSend",[y,u]),r)return y;u.async&&0<u.timeout&&(j=c.setTimeout(function(){y.abort("timeout")},u.timeout));try{r=!1,e.send(ha,g)}catch(K){if(r)throw K;g(-1,K)}}else g(-1,"No Transport");return y},getJSON:function(c,b,d){return q.get(c,b,d,"json")},getScript:function(c,b){return q.get(c,void 0,b,"script")}});q.each(["get",
"post"],function(c,b){q[b]=function(c,d,g,e){return q.isFunction(d)&&(e=e||g,g=d,d=void 0),q.ajax(q.extend({url:c,type:b,dataType:e,data:d,success:g},q.isPlainObject(c)&&c))}});q._evalUrl=function(c){return q.ajax({url:c,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})};q.fn.extend({wrapAll:function(c){var b;return this[0]&&(q.isFunction(c)&&(c=c.call(this[0])),b=q(c,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var c=
this;c.firstElementChild;)c=c.firstElementChild;return c}).append(this)),this},wrapInner:function(c){return q.isFunction(c)?this.each(function(b){q(this).wrapInner(c.call(this,b))}):this.each(function(){var b=q(this),d=b.contents();d.length?d.wrapAll(c):b.append(c)})},wrap:function(c){var b=q.isFunction(c);return this.each(function(d){q(this).wrapAll(b?c.call(this,d):c)})},unwrap:function(c){return this.parent(c).not("body").each(function(){q(this).replaceWith(this.childNodes)}),this}});q.expr.pseudos.hidden=
function(c){return!q.expr.pseudos.visible(c)};q.expr.pseudos.visible=function(c){return!(!c.offsetWidth&&!c.offsetHeight&&!c.getClientRects().length)};q.ajaxSettings.xhr=function(){try{return new c.XMLHttpRequest}catch(b){}};var Ad={"0":200,1223:204},rb=q.ajaxSettings.xhr();ca.cors=!!rb&&"withCredentials"in rb;ca.ajax=rb=!!rb;q.ajaxTransport(function(b){var d,g;if(ca.cors||rb&&!b.crossDomain)return{send:function(e,f){var n,m=b.xhr();if(m.open(b.type,b.url,b.async,b.username,b.password),b.xhrFields)for(n in b.xhrFields)m[n]=
b.xhrFields[n];b.mimeType&&m.overrideMimeType&&m.overrideMimeType(b.mimeType);b.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(n in e)m.setRequestHeader(n,e[n]);d=function(c){return function(){d&&(d=g=m.onload=m.onerror=m.onabort=m.onreadystatechange=null,"abort"===c?m.abort():"error"===c?"number"!=typeof m.status?f(0,"error"):f(m.status,m.statusText):f(Ad[m.status]||m.status,m.statusText,"text"!==(m.responseType||"text")||"string"!=typeof m.responseText?{binary:m.response}:
{text:m.responseText},m.getAllResponseHeaders()))}};m.onload=d();g=m.onerror=d("error");void 0!==m.onabort?m.onabort=g:m.onreadystatechange=function(){4===m.readyState&&c.setTimeout(function(){d&&g()})};d=d("abort");try{m.send(b.hasContent&&b.data||null)}catch(j){if(d)throw j;}},abort:function(){d&&d()}}});q.ajaxPrefilter(function(c){c.crossDomain&&(c.contents.script=!1)});q.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},
converters:{"text script":function(c){return q.globalEval(c),c}}});q.ajaxPrefilter("script",function(c){void 0===c.cache&&(c.cache=!1);c.crossDomain&&(c.type="GET")});q.ajaxTransport("script",function(c){if(c.crossDomain){var b,d;return{send:function(g,e){b=q("<script>").prop({charset:c.scriptCharset,src:c.url}).on("load error",d=function(c){b.remove();d=null;c&&e("error"===c.type?404:200,c.type)});G.head.appendChild(b[0])},abort:function(){d&&d()}}}});var Dc=[],Vb=/(=)\?(?=&|$)|\?\?/;q.ajaxSetup({jsonp:"callback",
jsonpCallback:function(){var c=Dc.pop()||q.expando+"_"+zc++;return this[c]=!0,c}});q.ajaxPrefilter("json jsonp",function(b,d,g){var e,f,n,m=!1!==b.jsonp&&(Vb.test(b.url)?"url":"string"==typeof b.data&&0===(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Vb.test(b.data)&&"data");if(m||"jsonp"===b.dataTypes[0])return e=b.jsonpCallback=q.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,m?b[m]=b[m].replace(Vb,"$1"+e):!1!==b.jsonp&&(b.url+=(Tb.test(b.url)?"&":"?")+b.jsonp+
"="+e),b.converters["script json"]=function(){return n||q.error(e+" was not called"),n[0]},b.dataTypes[0]="json",f=c[e],c[e]=function(){n=arguments},g.always(function(){void 0===f?q(c).removeProp(e):c[e]=f;b[e]&&(b.jsonpCallback=d.jsonpCallback,Dc.push(e));n&&q.isFunction(f)&&f(n[0]);n=f=void 0}),"script"});var Bd=ca,Ec,Fc=G.implementation.createHTMLDocument("").body;Ec=(Fc.innerHTML="<form></form><form></form>",2===Fc.childNodes.length);Bd.createHTMLDocument=Ec;q.parseHTML=function(c,b,d){if("string"!=
typeof c)return[];"boolean"==typeof b&&(d=b,b=!1);var g,e,f;return b||(ca.createHTMLDocument?(b=G.implementation.createHTMLDocument(""),g=b.createElement("base"),g.href=G.location.href,b.head.appendChild(g)):b=G),e=lc.exec(c),f=!d&&[],e?[b.createElement(e[1])]:(e=x([c],b,f),f&&f.length&&q(f).remove(),q.merge([],e.childNodes))};q.fn.load=function(c,b,d){var g,e,f,n=this,m=c.indexOf(" ");return-1<m&&(g=la(c.slice(m)),c=c.slice(0,m)),q.isFunction(b)?(d=b,b=void 0):b&&"object"==typeof b&&(e="POST"),0<
n.length&&q.ajax({url:c,type:e||"GET",dataType:"html",data:b}).done(function(c){f=arguments;n.html(g?q("<div>").append(q.parseHTML(c)).find(g):c)}).always(d&&function(c,b){n.each(function(){d.apply(this,f||[c.responseText,b,c])})}),this};q.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(c,b){q.fn[b]=function(c){return this.on(b,c)}});q.expr.pseudos.animated=function(c){return q.grep(q.timers,function(b){return c===b.elem}).length};q.offset={setOffset:function(c,
b,d){var g,e,f,n,m,j,l=q.css(c,"position"),r=q(c),s={};"static"===l&&(c.style.position="relative");m=r.offset();f=q.css(c,"top");j=q.css(c,"left");("absolute"===l||"fixed"===l)&&-1<(f+j).indexOf("auto")?(g=r.position(),n=g.top,e=g.left):(n=parseFloat(f)||0,e=parseFloat(j)||0);q.isFunction(b)&&(b=b.call(c,d,q.extend({},m)));null!=b.top&&(s.top=b.top-m.top+n);null!=b.left&&(s.left=b.left-m.left+e);"using"in b?b.using.call(c,s):r.css(s)}};q.fn.extend({offset:function(c){if(arguments.length)return void 0===
c?this:this.each(function(b){q.offset.setOffset(this,c,b)});var b,d,g,e,f=this[0];if(f)return f.getClientRects().length?(g=f.getBoundingClientRect(),b=f.ownerDocument,d=b.documentElement,e=b.defaultView,{top:g.top+e.pageYOffset-d.clientTop,left:g.left+e.pageXOffset-d.clientLeft}):{top:0,left:0}},position:function(){if(this[0]){var c,b,d=this[0],g={top:0,left:0};return"fixed"===q.css(d,"position")?b=d.getBoundingClientRect():(c=this.offsetParent(),b=this.offset(),j(c[0],"html")||(g=c.offset()),g={top:g.top+
q.css(c[0],"borderTopWidth",!0),left:g.left+q.css(c[0],"borderLeftWidth",!0)}),{top:b.top-g.top-q.css(d,"marginTop",!0),left:b.left-g.left-q.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var c=this.offsetParent;c&&"static"===q.css(c,"position");)c=c.offsetParent;return c||Gb})}});q.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(c,b){var d="pageYOffset"===b;q.fn[c]=function(g){return Na(this,function(c,g,e){var f;return q.isWindow(c)?f=c:9===c.nodeType&&
(f=c.defaultView),void 0===e?f?f[b]:c[g]:void(f?f.scrollTo(d?f.pageXOffset:e,d?e:f.pageYOffset):c[g]=e)},c,g,arguments.length)}});q.each(["top","left"],function(c,b){q.cssHooks[b]=W(ca.pixelPosition,function(c,d){if(d)return d=K(c,b),Jb.test(d)?q(c).position()[b]+"px":d})});q.each({Height:"height",Width:"width"},function(c,b){q.each({padding:"inner"+c,content:b,"":"outer"+c},function(d,g){q.fn[g]=function(e,f){var n=arguments.length&&(d||"boolean"!=typeof e),m=d||(!0===e||!0===f?"margin":"border");
return Na(this,function(b,d,e){var f;return q.isWindow(b)?0===g.indexOf("outer")?b["inner"+c]:b.document.documentElement["client"+c]:9===b.nodeType?(f=b.documentElement,Math.max(b.body["scroll"+c],f["scroll"+c],b.body["offset"+c],f["offset"+c],f["client"+c])):void 0===e?q.css(b,d,m):q.style(b,d,e,m)},b,n?e:void 0,n)}})});q.fn.extend({bind:function(c,b,d){return this.on(c,null,b,d)},unbind:function(c,b){return this.off(c,null,b)},delegate:function(c,b,d,g){return this.on(b,c,d,g)},undelegate:function(c,
b,d){return 1===arguments.length?this.off(c,"**"):this.off(b,c||"**",d)}});q.holdReady=function(c){c?q.readyWait++:q.ready(!0)};q.isArray=Array.isArray;q.parseJSON=JSON.parse;q.nodeName=j;"function"==typeof define&&define.amd&&define("jquery",[],function(){return q});var Cd=c.jQuery,Dd=c.$;return q.noConflict=function(b){return c.$===q&&(c.$=Dd),b&&c.jQuery===q&&(c.jQuery=Cd),q},b||(c.jQuery=c.$=q),q});!function(c,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):c.PointerEventsPolyfill=b()}(this,function(){function c(c,b){b=b||Object.create(null);var d=document.createEvent("Event");d.initEvent(c,b.bubbles||!1,b.cancelable||!1);for(var e,f=2;f<g.length;f++)e=g[f],d[e]=b[e]||m[f];d.buttons=b.buttons||0;e=0;return e=b.pressure&&d.buttons?b.pressure:d.buttons?0.5:0,d.x=d.clientX,d.y=d.clientY,d.pointerId=b.pointerId||0,d.width=
b.width||0,d.height=b.height||0,d.pressure=e,d.tiltX=b.tiltX||0,d.tiltY=b.tiltY||0,d.twist=b.twist||0,d.tangentialPressure=b.tangentialPressure||0,d.pointerType=b.pointerType||"",d.hwTimestamp=b.hwTimestamp||0,d.isPrimary=b.isPrimary||!1,d}function b(){this.array=[];this.size=0}function e(c,b,d,g){this.addCallback=c.bind(g);this.removeCallback=b.bind(g);this.changedCallback=d.bind(g);I&&(this.observer=new I(this.mutationWatcher.bind(this)))}function d(c){return"body /shadow-deep/ "+j(c)}function j(c){return'[touch-action="'+
c+'"]'}function f(c){return"{ -ms-touch-action: "+c+"; touch-action: "+c+"; }"}function p(c){if(!v.pointermap.has(c))throw c=Error("InvalidPointerId"),c.name="InvalidPointerId",c;}function l(c){for(var b=c.parentNode;b&&b!==c.ownerDocument;)b=b.parentNode;if(!b)throw c=Error("InvalidStateError"),c.name="InvalidStateError",c;}var g="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget pageX pageY".split(" "),m=[!1,!1,null,null,0,0,0,0,
!1,!1,!1,!1,0,null,0,0],n=window.Map&&window.Map.prototype.forEach?Map:b;b.prototype={set:function(c,b){return void 0===b?this["delete"](c):(this.has(c)||this.size++,void(this.array[c]=b))},has:function(c){return void 0!==this.array[c]},"delete":function(c){this.has(c)&&(delete this.array[c],this.size--)},get:function(c){return this.array[c]},clear:function(){this.size=this.array.length=0},forEach:function(c,b){return this.array.forEach(function(d,g){c.call(b,d,g,this)},this)}};var r="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget buttons pointerId width height pressure tiltX tiltY pointerType hwTimestamp isPrimary type target currentTarget which pageX pageY timeStamp".split(" "),
s=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],t={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},u="undefined"!=typeof SVGElementInstance,v={pointermap:new n,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(c,b){var d=b.events;d&&(d.forEach(function(c){b[c]&&(this.eventMap[c]=b[c].bind(b))},this),this.eventSources[c]=b,this.eventSourceList.push(b))},register:function(c){for(var b,
d=this.eventSourceList.length,g=0;g<d&&(b=this.eventSourceList[g]);g++)b.register.call(b,c)},unregister:function(c){for(var b,d=this.eventSourceList.length,g=0;g<d&&(b=this.eventSourceList[g]);g++)b.unregister.call(b,c)},contains:function(c,b){try{return c.contains(b)}catch(d){return!1}},down:function(c){c.bubbles=!0;this.fireEvent("pointerdown",c)},move:function(c){c.bubbles=!0;this.fireEvent("pointermove",c)},up:function(c){c.bubbles=!0;this.fireEvent("pointerup",c)},enter:function(c){c.bubbles=
!1;this.fireEvent("pointerenter",c)},leave:function(c){c.bubbles=!1;this.fireEvent("pointerleave",c)},over:function(c){c.bubbles=!0;this.fireEvent("pointerover",c)},out:function(c){c.bubbles=!0;this.fireEvent("pointerout",c)},cancel:function(c){c.bubbles=!0;this.fireEvent("pointercancel",c)},leaveOut:function(c){this.out(c);this.propagate(c,this.leave,!1)},enterOver:function(c){this.over(c);this.propagate(c,this.enter,!0)},eventHandler:function(c){if(!c._handledByPE){var b=c.type;(b=this.eventMap&&
this.eventMap[b])&&b(c);c._handledByPE=!0}},listen:function(c,b){b.forEach(function(b){this.addEvent(c,b)},this)},unlisten:function(c,b){b.forEach(function(b){this.removeEvent(c,b)},this)},addEvent:function(c,b){c.addEventListener(b,this.boundHandler)},removeEvent:function(c,b){c.removeEventListener(b,this.boundHandler)},makeEvent:function(b,d){this.captureInfo[d.pointerId]&&(d.relatedTarget=null);var g=new c(b,d);return d.preventDefault&&(g.preventDefault=d.preventDefault),g._target=g._target||d.target,
g},fireEvent:function(c,b){var d=this.makeEvent(c,b);return this.dispatchEvent(d)},cloneEvent:function(c){for(var b,d=Object.create(null),g=0;g<r.length;g++)b=r[g],d[b]=c[b]||s[g],!u||"target"!==b&&"relatedTarget"!==b||d[b]instanceof SVGElementInstance&&(d[b]=d[b].correspondingUseElement);return c.preventDefault&&(d.preventDefault=function(){c.preventDefault()}),d},getTarget:function(c){var b=this.captureInfo[c.pointerId];return b?c._target!==b&&c.type in t?void 0:b:c._target},propagate:function(c,
b,d){for(var g=c.target,e=[];g!==document&&!g.contains(c.relatedTarget);)if(e.push(g),g=g.parentNode,!g)return;d&&e.reverse();e.forEach(function(d){c.target=d;b.call(this,c)},this)},setCapture:function(b,d,g){this.captureInfo[b]&&this.releaseCapture(b,g);this.captureInfo[b]=d;this.implicitRelease=this.releaseCapture.bind(this,b,g);document.addEventListener("pointerup",this.implicitRelease);document.addEventListener("pointercancel",this.implicitRelease);var e=new c("gotpointercapture");e.pointerId=
b;e._target=d;g||this.asyncDispatchEvent(e)},releaseCapture:function(b,d){var g=this.captureInfo[b];if(g){this.captureInfo[b]=void 0;document.removeEventListener("pointerup",this.implicitRelease);document.removeEventListener("pointercancel",this.implicitRelease);var e=new c("lostpointercapture");e.pointerId=b;e._target=g;d||this.asyncDispatchEvent(e)}},dispatchEvent:function(c){var b=this.getTarget(c);if(b)return b.dispatchEvent(c)},asyncDispatchEvent:function(c){requestAnimationFrame(this.dispatchEvent.bind(this,
c))}};v.boundHandler=v.eventHandler.bind(v);var z={shadow:function(c){if(c)return c.shadowRoot||c.webkitShadowRoot},canTarget:function(c){return c&&Boolean(c.elementFromPoint)},targetingShadow:function(c){c=this.shadow(c);if(this.canTarget(c))return c},olderShadow:function(c){var b=c.olderShadowRoot;b||(c=c.querySelector("shadow"))&&(b=c.olderShadowRoot);return b},allShadows:function(c){var b=[];for(c=this.shadow(c);c;)b.push(c),c=this.olderShadow(c);return b},searchRoot:function(c,b,d){if(c){var g,
e=c.elementFromPoint(b,d);for(g=this.targetingShadow(e);g;){if(c=g.elementFromPoint(b,d))return g=this.targetingShadow(c),this.searchRoot(g,b,d)||c;g=this.olderShadow(g)}return e}},owner:function(c){for(;c.parentNode;)c=c.parentNode;return c.nodeType!==Node.DOCUMENT_NODE&&c.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(c=document),c},findTarget:function(c){var b=c.clientX,d=c.clientY;c=this.owner(c.target);return c.elementFromPoint(b,d)||(c=document),this.searchRoot(c,b,d)}},x=Array.prototype.forEach.call.bind(Array.prototype.forEach),
B=Array.prototype.map.call.bind(Array.prototype.map),A=Array.prototype.slice.call.bind(Array.prototype.slice),D=Array.prototype.filter.call.bind(Array.prototype.filter),I=window.MutationObserver||window.WebKitMutationObserver,y={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};e.prototype={watchSubtree:function(c){this.observer&&z.canTarget(c)&&this.observer.observe(c,y)},enableOnSubtree:function(c){this.watchSubtree(c);c===document&&"complete"!==document.readyState?
this.installOnLoad():this.installNewSubtree(c)},installNewSubtree:function(c){x(this.findElements(c),this.addElement,this)},findElements:function(c){return c.querySelectorAll?c.querySelectorAll("[touch-action]"):[]},removeElement:function(c){this.removeCallback(c)},addElement:function(c){this.addCallback(c)},elementChanged:function(c,b){this.changedCallback(c,b)},concatLists:function(c,b){return c.concat(A(b))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===
document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(c){return c.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(c){var b=B(c,this.findElements,this);return b.push(D(c,this.isElement)),b.reduce(this.concatLists,[])},mutationWatcher:function(c){c.forEach(this.mutationHandler,this)},mutationHandler:function(c){"childList"===c.type?(this.flattenMutationTree(c.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(c.removedNodes).forEach(this.removeElement,
this)):"attributes"===c.type&&this.elementChanged(c.target,c.oldValue)}};var C=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],J="",M=window.PointerEvent||window.MSPointerEvent,O=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,N=v.pointermap,K=[1,4,2,8,16],W=!1;try{W=1===(new MouseEvent("test",{buttons:1})).buttons}catch(ea){}var F,H={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(c){v.listen(c,
this.events)},unregister:function(c){v.unlisten(c,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(c){var b,d=this.lastTouches,g=c.clientX;c=c.clientY;for(var e=0,f=d.length;e<f&&(b=d[e]);e++){var n=Math.abs(g-b.x),m=Math.abs(c-b.y);if(25>=n&&25>=m)return!0}},prepareEvent:function(c){var b=v.cloneEvent(c),d=b.preventDefault;return b.preventDefault=function(){c.preventDefault();d()},b.pointerId=this.POINTER_ID,b.isPrimary=!0,b.pointerType=this.POINTER_TYPE,b},prepareButtonsForMove:function(c,
b){var d=N.get(this.POINTER_ID);0!==b.which&&d?c.buttons=d.buttons:c.buttons=0;b.buttons=c.buttons},mousedown:function(c){if(!this.isEventSimulatedFromTouch(c)){var b=N.get(this.POINTER_ID),d=this.prepareEvent(c);W||(d.buttons=K[d.button],b&&(d.buttons|=b.buttons),c.buttons=d.buttons);N.set(this.POINTER_ID,c);b&&0!==b.buttons?v.move(d):v.down(d)}},mousemove:function(c){if(!this.isEventSimulatedFromTouch(c)){var b=this.prepareEvent(c);W||this.prepareButtonsForMove(b,c);b.button=-1;N.set(this.POINTER_ID,
c);v.move(b)}},mouseup:function(c){if(!this.isEventSimulatedFromTouch(c)){var b=N.get(this.POINTER_ID),d=this.prepareEvent(c);if(!W){var g=K[d.button];d.buttons=b?b.buttons&~g:0;c.buttons=d.buttons}N.set(this.POINTER_ID,c);d.buttons&=~K[d.button];0===d.buttons?v.up(d):v.move(d)}},mouseover:function(c){if(!this.isEventSimulatedFromTouch(c)){var b=this.prepareEvent(c);W||this.prepareButtonsForMove(b,c);b.button=-1;N.set(this.POINTER_ID,c);v.enterOver(b)}},mouseout:function(c){if(!this.isEventSimulatedFromTouch(c)){var b=
this.prepareEvent(c);W||this.prepareButtonsForMove(b,c);b.button=-1;v.leaveOut(b)}},cancel:function(c){c=this.prepareEvent(c);v.cancel(c);this.deactivateMouse()},deactivateMouse:function(){N["delete"](this.POINTER_ID)}},ia=v.captureInfo,R=z.findTarget.bind(z),L=z.allShadows.bind(z),U=v.pointermap,Q={events:["touchstart","touchmove","touchend","touchcancel"],register:function(c){F.enableOnSubtree(c)},unregister:function(){},elementAdded:function(c){var b=c.getAttribute("touch-action"),d=this.touchActionToScrollType(b);
d&&(c._scrollType=d,v.listen(c,this.events),L(c).forEach(function(c){c._scrollType=d;v.listen(c,this.events)},this))},elementRemoved:function(c){c._scrollType=void 0;v.unlisten(c,this.events);L(c).forEach(function(c){c._scrollType=void 0;v.unlisten(c,this.events)},this)},elementChanged:function(c,b){var d=c.getAttribute("touch-action"),g=this.touchActionToScrollType(d),d=this.touchActionToScrollType(b);g&&d?(c._scrollType=g,L(c).forEach(function(c){c._scrollType=g},this)):d?this.elementRemoved(c):
g&&this.elementAdded(c)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(c){var b=this.scrollTypes;return"none"===c?"none":c===b.XSCROLLER?"X":c===b.YSCROLLER?"Y":b.SCROLLER.exec(c)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(c){return this.firstTouch===c.identifier},setPrimaryTouch:function(c){(0===U.size||1===U.size&&U.has(1))&&(this.firstTouch=c.identifier,this.firstXY=
{X:c.clientX,Y:c.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(c){c.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var c=function(){this.clickCount=0;this.resetId=null}.bind(this);this.resetId=setTimeout(c,200)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(c){return 0},touchToPointer:function(c){var b=this.currentTouchEvent,
d=v.cloneEvent(c),g=d.pointerId=c.identifier+2;d.target=ia[g]||R(d);d.bubbles=!0;d.cancelable=!0;d.detail=this.clickCount;d.button=0;d.buttons=this.typeToButtons(b.type);d.width=2*(c.radiusX||c.webkitRadiusX||0);d.height=2*(c.radiusY||c.webkitRadiusY||0);d.pressure=c.force||c.webkitForce||0.5;d.isPrimary=this.isPrimaryTouch(c);d.pointerType=this.POINTER_TYPE;d.altKey=b.altKey;d.ctrlKey=b.ctrlKey;d.metaKey=b.metaKey;d.shiftKey=b.shiftKey;var e=this;return d.preventDefault=function(){e.scrolling=!1;
e.firstXY=null;b.preventDefault()},d},processTouches:function(c,b){var d=c.changedTouches;this.currentTouchEvent=c;for(var g,e=0;e<d.length;e++)g=d[e],b.call(this,this.touchToPointer(g))},shouldScroll:function(c){if(this.firstXY){var b;b=c.currentTarget._scrollType;if("none"===b)b=!1;else if("XY"===b)b=!0;else{c=c.changedTouches[0];var d="Y"===b?"X":"Y";b=Math.abs(c["client"+b]-this.firstXY[b]);c=Math.abs(c["client"+d]-this.firstXY[d]);b=b>=c}return this.firstXY=null,b}},findTouch:function(c,b){for(var d,
g=0,e=c.length;g<e&&(d=c[g]);g++)if(d.identifier===b)return!0},vacuumTouches:function(c){var b=c.touches;if(U.size>=b.length){var d=[];U.forEach(function(c,g){1!==g&&!this.findTouch(b,g-2)&&d.push(c.out)},this);d.forEach(this.cancelOut,this)}},touchstart:function(c){this.vacuumTouches(c);this.setPrimaryTouch(c.changedTouches[0]);this.dedupSynthMouse(c);this.scrolling||(this.clickCount++,this.processTouches(c,this.overDown))},overDown:function(c){U.set(c.pointerId,{target:c.target,out:c,outTarget:c.target});
v.enterOver(c);v.down(c)},touchmove:function(c){this.scrolling||(this.shouldScroll(c)?(this.scrolling=!0,this.touchcancel(c)):(c.preventDefault(),this.processTouches(c,this.moveOverOut)))},moveOverOut:function(c){var b=U.get(c.pointerId);if(b){var d=b.out,g=b.outTarget;v.move(c);d&&g!==c.target&&(d.relatedTarget=c.target,c.relatedTarget=g,d.target=g,c.target?(v.leaveOut(d),v.enterOver(c)):(c.target=g,c.relatedTarget=null,this.cancelOut(c)));b.out=c;b.outTarget=c.target}},touchend:function(c){this.dedupSynthMouse(c);
this.processTouches(c,this.upOut)},upOut:function(c){this.scrolling||(v.up(c),v.leaveOut(c));this.cleanUpPointer(c)},touchcancel:function(c){this.processTouches(c,this.cancelOut)},cancelOut:function(c){v.cancel(c);v.leaveOut(c);this.cleanUpPointer(c)},cleanUpPointer:function(c){U["delete"](c.pointerId);this.removePrimaryPointer(c)},dedupSynthMouse:function(c){var b=H.lastTouches;c=c.changedTouches[0];this.isPrimaryTouch(c)&&(c={x:c.clientX,y:c.clientY},b.push(c),b=function(c,b){var d=c.indexOf(b);
-1<d&&c.splice(d,1)}.bind(null,b,c),setTimeout(b,2500))}};F=new e(Q.elementAdded,Q.elementRemoved,Q.elementChanged,Q);var aa,ba,la,qa=v.pointermap,fa=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,oa={events:"MSPointerDown MSPointerMove MSPointerUp MSPointerOut MSPointerOver MSPointerCancel MSGotPointerCapture MSLostPointerCapture".split(" "),register:function(c){v.listen(c,this.events)},unregister:function(c){v.unlisten(c,this.events)},POINTER_TYPES:["","unavailable",
"touch","pen","mouse"],prepareEvent:function(c){var b=c;return fa&&(b=v.cloneEvent(c),b.pointerType=this.POINTER_TYPES[c.pointerType]),b},cleanup:function(c){qa["delete"](c)},MSPointerDown:function(c){qa.set(c.pointerId,c);c=this.prepareEvent(c);v.down(c)},MSPointerMove:function(c){c=this.prepareEvent(c);v.move(c)},MSPointerUp:function(c){var b=this.prepareEvent(c);v.up(b);this.cleanup(c.pointerId)},MSPointerOut:function(c){c=this.prepareEvent(c);v.leaveOut(c)},MSPointerOver:function(c){c=this.prepareEvent(c);
v.enterOver(c)},MSPointerCancel:function(c){var b=this.prepareEvent(c);v.cancel(b);this.cleanup(c.pointerId)},MSLostPointerCapture:function(c){c=v.makeEvent("lostpointercapture",c);v.dispatchEvent(c)},MSGotPointerCapture:function(c){c=v.makeEvent("gotpointercapture",c);v.dispatchEvent(c)}};window.navigator.msPointerEnabled?(aa=function(c){p(c);l(this);0!==v.pointermap.get(c).buttons&&(v.setCapture(c,this,!0),this.msSetPointerCapture(c))},ba=function(c){p(c);v.releaseCapture(c,!0);this.msReleasePointerCapture(c)}):
(aa=function(c){p(c);l(this);0!==v.pointermap.get(c).buttons&&v.setCapture(c,this)},ba=function(c){p(c);v.releaseCapture(c)});la=function(c){return!!v.captureInfo[c]};M&&(C.forEach(function(c){String(c)===c?(J+=j(c)+f(c)+"\n",O&&(J+=d(c)+f(c)+"\n")):(J+=c.selectors.map(j)+f(c.rule)+"\n",O&&(J+=c.selectors.map(d)+f(c.rule)+"\n"))}),C=document.createElement("style"),C.textContent=J,document.head.appendChild(C));window.PointerEvent||((window.PointerEvent=c,window.navigator.msPointerEnabled)?(Object.defineProperty(window.navigator,
"maxTouchPoints",{value:window.navigator.msMaxTouchPoints,enumerable:!0}),v.registerSource("ms",oa)):(Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),v.registerSource("mouse",H),void 0!==window.ontouchstart&&v.registerSource("touch",Q)),v.register(document));window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:aa},releasePointerCapture:{value:ba},hasPointerCapture:{value:la}});return{dispatcher:v,
Installer:e,PointerEvent:c,PointerMap:n,targetFinding:z}});window.wgl={modules:{}};!function(c){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=c();else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self);b.CANNON=c()}}(function(){return function b(e,d,j){function f(g,m){if(!d[g]){if(!e[g]){var n="function"==typeof require&&require;if(!m&&n)return n(g,!0);if(p)return p(g,!0);throw Error("Cannot find module '"+g+"'");}n=d[g]={exports:{}};e[g][0].call(n.exports,function(b){var d=e[g][1][b];return f(d?
d:b)},n,n.exports,b,e,d,j)}return d[g].exports}for(var p="function"==typeof require&&require,l=0;l<j.length;l++)f(j[l]);return f}({1:[function(b,e){e.exports={name:"cannon",version:"0.6.2",description:"A lightweight 3D physics engine written in JavaScript.",homepage:"https://github.com/schteppe/cannon.js",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["cannon.js","cannon","physics","engine","3d"],main:"./build/cannon.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/cannon.js.git"},
bugs:{url:"https://github.com/schteppe/cannon.js/issues"},licenses:[{type:"MIT"}],devDependencies:{jshint:"latest","uglify-js":"latest",nodeunit:"^0.9.0",grunt:"~0.4.0","grunt-contrib-jshint":"~0.1.1","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-concat":"~0.1.3","grunt-contrib-uglify":"^0.5.1","grunt-browserify":"^2.1.4","grunt-contrib-yuidoc":"^0.5.2",browserify:"*"},dependencies:{}}},{}],2:[function(b,e){e.exports={version:b("../package.json").version,AABB:b("./collision/AABB"),ArrayCollisionMatrix:b("./collision/ArrayCollisionMatrix"),
Body:b("./objects/Body"),Box:b("./shapes/Box"),Broadphase:b("./collision/Broadphase"),Constraint:b("./constraints/Constraint"),ContactEquation:b("./equations/ContactEquation"),Narrowphase:b("./world/Narrowphase"),ConeTwistConstraint:b("./constraints/ConeTwistConstraint"),ContactMaterial:b("./material/ContactMaterial"),ConvexPolyhedron:b("./shapes/ConvexPolyhedron"),Cylinder:b("./shapes/Cylinder"),DistanceConstraint:b("./constraints/DistanceConstraint"),Equation:b("./equations/Equation"),EventTarget:b("./utils/EventTarget"),
FrictionEquation:b("./equations/FrictionEquation"),GSSolver:b("./solver/GSSolver"),GridBroadphase:b("./collision/GridBroadphase"),Heightfield:b("./shapes/Heightfield"),HingeConstraint:b("./constraints/HingeConstraint"),LockConstraint:b("./constraints/LockConstraint"),Mat3:b("./math/Mat3"),Material:b("./material/Material"),NaiveBroadphase:b("./collision/NaiveBroadphase"),ObjectCollisionMatrix:b("./collision/ObjectCollisionMatrix"),Pool:b("./utils/Pool"),Particle:b("./shapes/Particle"),Plane:b("./shapes/Plane"),
PointToPointConstraint:b("./constraints/PointToPointConstraint"),Quaternion:b("./math/Quaternion"),Ray:b("./collision/Ray"),RaycastVehicle:b("./objects/RaycastVehicle"),RaycastResult:b("./collision/RaycastResult"),RigidVehicle:b("./objects/RigidVehicle"),RotationalEquation:b("./equations/RotationalEquation"),RotationalMotorEquation:b("./equations/RotationalMotorEquation"),SAPBroadphase:b("./collision/SAPBroadphase"),SPHSystem:b("./objects/SPHSystem"),Shape:b("./shapes/Shape"),Solver:b("./solver/Solver"),
Sphere:b("./shapes/Sphere"),SplitSolver:b("./solver/SplitSolver"),Spring:b("./objects/Spring"),Trimesh:b("./shapes/Trimesh"),Vec3:b("./math/Vec3"),Vec3Pool:b("./utils/Vec3Pool"),World:b("./world/World")}},{"../package.json":1,"./collision/AABB":3,"./collision/ArrayCollisionMatrix":4,"./collision/Broadphase":5,"./collision/GridBroadphase":6,"./collision/NaiveBroadphase":7,"./collision/ObjectCollisionMatrix":8,"./collision/Ray":9,"./collision/RaycastResult":10,"./collision/SAPBroadphase":11,"./constraints/ConeTwistConstraint":12,
"./constraints/Constraint":13,"./constraints/DistanceConstraint":14,"./constraints/HingeConstraint":15,"./constraints/LockConstraint":16,"./constraints/PointToPointConstraint":17,"./equations/ContactEquation":19,"./equations/Equation":20,"./equations/FrictionEquation":21,"./equations/RotationalEquation":22,"./equations/RotationalMotorEquation":23,"./material/ContactMaterial":24,"./material/Material":25,"./math/Mat3":27,"./math/Quaternion":28,"./math/Vec3":30,"./objects/Body":31,"./objects/RaycastVehicle":32,
"./objects/RigidVehicle":33,"./objects/SPHSystem":34,"./objects/Spring":35,"./shapes/Box":37,"./shapes/ConvexPolyhedron":38,"./shapes/Cylinder":39,"./shapes/Heightfield":40,"./shapes/Particle":41,"./shapes/Plane":42,"./shapes/Shape":43,"./shapes/Sphere":44,"./shapes/Trimesh":45,"./solver/GSSolver":46,"./solver/Solver":47,"./solver/SplitSolver":48,"./utils/EventTarget":49,"./utils/Pool":51,"./utils/Vec3Pool":54,"./world/Narrowphase":55,"./world/World":56}],3:[function(b,e){function d(b){b=b||{};this.lowerBound=
new j;b.lowerBound&&this.lowerBound.copy(b.lowerBound);this.upperBound=new j;b.upperBound&&this.upperBound.copy(b.upperBound)}var j=b("../math/Vec3");b("../utils/Utils");e.exports=d;var f=new j;d.prototype.setFromPoints=function(b,d,e,n){var j=this.lowerBound,s=this.upperBound;j.copy(b[0]);e&&e.vmult(j,j);s.copy(j);for(var p=1;p<b.length;p++){var u=b[p];e&&(e.vmult(u,f),u=f);u.x>s.x&&(s.x=u.x);u.x<j.x&&(j.x=u.x);u.y>s.y&&(s.y=u.y);u.y<j.y&&(j.y=u.y);u.z>s.z&&(s.z=u.z);u.z<j.z&&(j.z=u.z)}d&&(d.vadd(j,
j),d.vadd(s,s));n&&(j.x-=n,j.y-=n,j.z-=n,s.x+=n,s.y+=n,s.z+=n);return this};d.prototype.copy=function(b){this.lowerBound.copy(b.lowerBound);this.upperBound.copy(b.upperBound);return this};d.prototype.clone=function(){return(new d).copy(this)};d.prototype.extend=function(b){var d=b.lowerBound.x;this.lowerBound.x>d&&(this.lowerBound.x=d);d=b.upperBound.x;this.upperBound.x<d&&(this.upperBound.x=d);d=b.lowerBound.y;this.lowerBound.y>d&&(this.lowerBound.y=d);d=b.upperBound.y;this.upperBound.y<d&&(this.upperBound.y=
d);d=b.lowerBound.z;this.lowerBound.z>d&&(this.lowerBound.z=d);d=b.upperBound.z;this.upperBound.z<d&&(this.upperBound.z=d)};d.prototype.overlaps=function(b){var d=this.lowerBound,e=this.upperBound,f=b.lowerBound;b=b.upperBound;return(f.x<=e.x&&e.x<=b.x||d.x<=b.x&&b.x<=e.x)&&(f.y<=e.y&&e.y<=b.y||d.y<=b.y&&b.y<=e.y)&&(f.z<=e.z&&e.z<=b.z||d.z<=b.z&&b.z<=e.z)};d.prototype.contains=function(b){var d=this.lowerBound,e=this.upperBound,f=b.lowerBound;b=b.upperBound;return d.x<=f.x&&e.x>=b.x&&d.y<=f.y&&e.y>=
b.y&&d.z<=f.z&&e.z>=b.z};d.prototype.getCorners=function(b,d,e,f,j,s,p,u){var v=this.lowerBound,z=this.upperBound;b.copy(v);d.set(z.x,v.y,v.z);e.set(z.x,z.y,v.z);f.set(v.x,z.y,z.z);j.set(z.x,v.y,v.z);s.set(v.x,z.y,v.z);p.set(v.x,v.y,z.z);u.copy(z)};var p=[new j,new j,new j,new j,new j,new j,new j,new j];d.prototype.toLocalFrame=function(b,d){this.getCorners(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7]);for(var e=0;8!==e;e++){var f=p[e];b.pointToLocal(f,f)}return d.setFromPoints(p)};d.prototype.toWorldFrame=
function(b,d){this.getCorners(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7]);for(var e=0;8!==e;e++){var f=p[e];b.pointToWorld(f,f)}return d.setFromPoints(p)}},{"../math/Vec3":30,"../utils/Utils":53}],4:[function(b,e){function d(){this.matrix=[]}e.exports=d;d.prototype.get=function(b,d){b=b.index;d=d.index;if(d>b){var e=d;d=b;b=e}return this.matrix[(b*(b+1)>>1)+d-1]};d.prototype.set=function(b,d,e){b=b.index;d=d.index;if(d>b){var l=d;d=b;b=l}this.matrix[(b*(b+1)>>1)+d-1]=e?1:0};d.prototype.reset=function(){for(var b=
0,d=this.matrix.length;b!==d;b++)this.matrix[b]=0};d.prototype.setNumObjects=function(b){this.matrix.length=b*(b-1)>>1}},{}],5:[function(b,e){function d(){this.world=null;this.useBoundingBoxes=!1;this.dirty=!0}var j=b("../objects/Body"),f=b("../math/Vec3"),p=b("../math/Quaternion");b("../shapes/Shape");b("../shapes/Plane");e.exports=d;d.prototype.collisionPairs=function(){throw Error("collisionPairs not implemented for this BroadPhase class!");};var l=j.STATIC|j.KINEMATIC;d.prototype.needBroadphaseCollision=
function(b,d){return 0===(b.collisionFilterGroup&d.collisionFilterMask)||0===(d.collisionFilterGroup&b.collisionFilterMask)||(0!==(b.type&l)||b.sleepState===j.SLEEPING)&&(0!==(d.type&l)||d.sleepState===j.SLEEPING)?!1:!0};d.prototype.intersectionTest=function(b,d,g,e){this.useBoundingBoxes?this.doBoundingBoxBroadphase(b,d,g,e):this.doBoundingSphereBroadphase(b,d,g,e)};var g=new f;new f;new p;new f;d.prototype.doBoundingSphereBroadphase=function(b,d,e,f){d.position.vsub(b.position,g);var n=Math.pow(b.boundingRadius+
d.boundingRadius,2);g.norm2()<n&&(e.push(b),f.push(d))};d.prototype.doBoundingBoxBroadphase=function(b,d,g,e){b.aabbNeedsUpdate&&b.computeAABB();d.aabbNeedsUpdate&&d.computeAABB();b.aabb.overlaps(d.aabb)&&(g.push(b),e.push(d))};var m={keys:[]},n=[],r=[];d.prototype.makePairsUnique=function(b,d){for(var g=b.length,e=0;e!==g;e++)n[e]=b[e],r[e]=d[e];b.length=0;for(e=d.length=0;e!==g;e++){var f=n[e].id,j=r[e].id,f=f<j?f+","+j:j+","+f;m[f]=e;m.keys.push(f)}for(e=0;e!==m.keys.length;e++)f=m.keys.pop(),
g=m[f],b.push(n[g]),d.push(r[g]),delete m[f]};d.prototype.setWorld=function(){};var s=new f;d.boundingSphereCheck=function(b,d){b.position.vsub(d.position,s);return Math.pow(b.shape.boundingSphereRadius+d.shape.boundingSphereRadius,2)>s.norm2()};d.prototype.aabbQuery=function(){console.warn(".aabbQuery is not implemented in this Broadphase subclass.");return[]}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Plane":42,"../shapes/Shape":43}],6:[function(b,e){function d(b,
d,e,l,s){j.apply(this);this.nx=e||10;this.ny=l||10;this.nz=s||10;this.aabbMin=b||new f(100,100,100);this.aabbMax=d||new f(-100,-100,-100);b=this.nx*this.ny*this.nz;if(0>=b)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[];this.binLengths=[];this.bins.length=b;this.binLengths.length=b;for(d=0;d<b;d++)this.bins[d]=[],this.binLengths[d]=0}e.exports=d;var j=b("./Broadphase"),f=b("../math/Vec3"),p=b("../shapes/Shape");d.prototype=new j;d.prototype.constructor=d;var l=new f;new f;d.prototype.collisionPairs=
function(b,d,e){function f(b,d,g,e,n,m,j){b=(b-J)*N|0;d=(d-M)*K|0;g=(g-O)*W|0;e=U((e-J)*N);n=U((n-M)*K);m=U((m-O)*W);0>b?b=0:b>=v&&(b=v-1);0>d?d=0:d>=z&&(d=z-1);0>g?g=0:g>=x&&(g=x-1);0>e?e=0:e>=v&&(e=v-1);0>n?n=0:n>=z&&(n=z-1);0>m?m=0:m>=x&&(m=x-1);b*=B;d*=A;g*=D;e*=B;n*=A;for(m*=D;b<=e;b+=B)for(var l=d;l<=n;l+=A)for(var r=g;r<=m;r+=D){var s=b+l+r;R[s][L[s]++]=j}}var j=b.numObjects();b=b.bodies;for(var t=this.aabbMax,u=this.aabbMin,v=this.nx,z=this.ny,x=this.nz,B=z*x,A=x,D=1,I=t.x,y=t.y,C=t.z,J=u.x,
M=u.y,O=u.z,N=v/(I-J),K=z/(y-M),W=x/(C-O),I=(I-J)/v,ea=(y-M)/z,C=(C-O)/x,F=0.5*Math.sqrt(I*I+ea*ea+C*C),y=p.types,H=y.SPHERE,ia=y.PLANE,R=this.bins,L=this.binLengths,y=this.bins.length,u=0;u!==y;u++)L[u]=0;for(var U=Math.ceil,u=Math.min,t=Math.max,u=0;u!==j;u++){var t=b[u],Q=t.shape;switch(Q.type){case H:var aa=t.position.x,ba=t.position.y,la=t.position.z,Q=Q.radius;f(aa-Q,ba-Q,la-Q,aa+Q,ba+Q,la+Q,t);break;case ia:Q.worldNormalNeedsUpdate&&Q.computeWorldNormal(t.quaternion);var la=Q.worldNormal,Q=
M+0.5*ea-t.position.y,qa=O+0.5*C-t.position.z,fa=l;fa.set(J+0.5*I-t.position.x,Q,qa);for(var oa=aa=0;aa!==v;aa++,oa+=B,fa.y=Q,fa.x+=I)for(var E=ba=0;ba!==z;ba++,E+=A,fa.z=qa,fa.y+=ea)for(var V=0,ha=0;V!==x;V++,ha+=D,fa.z+=C)if(fa.dot(la)<F){var G=oa+E+ha;R[G][L[G]++]=t}break;default:t.aabbNeedsUpdate&&t.computeAABB(),f(t.aabb.lowerBound.x,t.aabb.lowerBound.y,t.aabb.lowerBound.z,t.aabb.upperBound.x,t.aabb.upperBound.y,t.aabb.upperBound.z,t)}}for(u=0;u!==y;u++)if(j=L[u],1<j){b=R[u];for(aa=0;aa!==j;aa++){t=
b[aa];for(ba=0;ba!==aa;ba++)I=b[ba],this.needBroadphaseCollision(t,I)&&this.intersectionTest(t,I,d,e)}}this.makePairsUnique(d,e)}},{"../math/Vec3":30,"../shapes/Shape":43,"./Broadphase":5}],7:[function(b,e){function d(){j.apply(this)}e.exports=d;var j=b("./Broadphase"),f=b("./AABB");d.prototype=new j;d.prototype.constructor=d;d.prototype.collisionPairs=function(b,d,g){b=b.bodies;var e=b.length,f,j,s,t;for(f=0;f!==e;f++)for(j=0;j!==f;j++)s=b[f],t=b[j],this.needBroadphaseCollision(s,t)&&this.intersectionTest(s,
t,d,g)};new f;d.prototype.aabbQuery=function(b,d,g){g=g||[];for(var e=0;e<b.bodies.length;e++){var f=b.bodies[e];f.aabbNeedsUpdate&&f.computeAABB();f.aabb.overlaps(d)&&g.push(f)}return g}},{"./AABB":3,"./Broadphase":5}],8:[function(b,e){function d(){this.matrix={}}e.exports=d;d.prototype.get=function(b,d){b=b.id;d=d.id;if(d>b){var e=d;d=b;b=e}return b+"-"+d in this.matrix};d.prototype.set=function(b,d,e){b=b.id;d=d.id;if(d>b){var l=d;d=b;b=l}e?this.matrix[b+"-"+d]=!0:delete this.matrix[b+"-"+d]};
d.prototype.reset=function(){this.matrix={}};d.prototype.setNumObjects=function(){}},{}],9:[function(b,e){function d(b,e){this.from=b?b.clone():new f;this.to=e?e.clone():new f;this._direction=new f;this.precision=1E-4;this.checkCollisionResponse=!0;this.skipBackfaces=!1;this.collisionFilterGroup=this.collisionFilterMask=-1;this.mode=d.ANY;this.result=new g;this.hasHit=!1;this.callback=function(){}}function j(b,d,g,e){e.vsub(d,R);g.vsub(d,t);b.vsub(d,u);b=R.dot(R);d=R.dot(t);g=R.dot(u);e=t.dot(t);
var f=t.dot(u),n,m;return 0<=(n=e*g-d*f)&&0<=(m=b*f-d*g)&&n+m<b*e-d*d}e.exports=d;var f=b("../math/Vec3"),p=b("../math/Quaternion"),l=b("../math/Transform");b("../shapes/ConvexPolyhedron");b("../shapes/Box");var g=b("../collision/RaycastResult"),m=b("../shapes/Shape"),n=b("../collision/AABB");d.prototype.constructor=d;d.CLOSEST=1;d.ANY=2;d.ALL=4;var r=new n,s=[];d.prototype.intersectWorld=function(b,e){this.mode=e.mode||d.ANY;this.result=e.result||new g;this.skipBackfaces=!!e.skipBackfaces;this.collisionFilterMask=
"undefined"!==typeof e.collisionFilterMask?e.collisionFilterMask:-1;this.collisionFilterGroup="undefined"!==typeof e.collisionFilterGroup?e.collisionFilterGroup:-1;e.from&&this.from.copy(e.from);e.to&&this.to.copy(e.to);this.callback=e.callback||function(){};this.hasHit=!1;this.result.reset();this._updateDirection();this.getAABB(r);s.length=0;b.broadphase.aabbQuery(b,r,s);this.intersectBodies(s);return this.hasHit};var t=new f,u=new f;d.pointInTriangle=j;var v=new f,z=new p;d.prototype.intersectBody=
function(b,d){d&&(this.result=d,this._updateDirection());var g=this.checkCollisionResponse;if(!g||b.collisionResponse)if(!(0===(this.collisionFilterGroup&b.collisionFilterMask)||0===(b.collisionFilterGroup&this.collisionFilterMask)))for(var e=0,f=b.shapes.length;e<f;e++){var n=b.shapes[e];if(!g||n.collisionResponse)if(b.quaternion.mult(b.shapeOrientations[e],z),b.quaternion.vmult(b.shapeOffsets[e],v),v.vadd(b.position,v),this.intersectShape(n,z,v,b),this.result._shouldStop)break}};d.prototype.intersectBodies=
function(b,d){d&&(this.result=d,this._updateDirection());for(var g=0,e=b.length;!this.result._shouldStop&&g<e;g++)this.intersectBody(b[g])};d.prototype._updateDirection=function(){this.to.vsub(this.from,this._direction);this._direction.normalize()};d.prototype.intersectShape=function(b,d,g,e){var f=this.from,n=this._direction;g.vsub(f,R);var m=R.dot(n);n.mult(m,L);L.vadd(f,L);g.distanceTo(L)>b.boundingSphereRadius||(f=this[b.type])&&f.call(this,b,d,g,e)};new f;new f;var x=new f,B=new f,A=new f,D=
new f;new f;new g;d.prototype.intersectBox=function(b,d,g,e){return this.intersectConvex(b.convexPolyhedronRepresentation,d,g,e)};d.prototype[m.types.BOX]=d.prototype.intersectBox;d.prototype.intersectPlane=function(b,d,g,e){var n=this.from,m=this.to,j=this._direction,l=new f(0,0,1);d.vmult(l,l);var r=new f;n.vsub(g,r);d=r.dot(l);m.vsub(g,r);r=r.dot(l);if(!(0<d*r)&&!(n.distanceTo(m)<d)&&(r=l.dot(j),!(Math.abs(r)<this.precision))){var s=new f,m=new f;d=new f;n.vsub(g,s);g=-l.dot(s)/r;j.scale(g,m);
n.vadd(m,d);this.reportIntersection(l,d,b,e,-1)}};d.prototype[m.types.PLANE]=d.prototype.intersectPlane;d.prototype.getAABB=function(b){var d=this.to,g=this.from;b.lowerBound.x=Math.min(d.x,g.x);b.lowerBound.y=Math.min(d.y,g.y);b.lowerBound.z=Math.min(d.z,g.z);b.upperBound.x=Math.max(d.x,g.x);b.upperBound.y=Math.max(d.y,g.y);b.upperBound.z=Math.max(d.z,g.z)};var I={faceList:[0]};d.prototype.intersectHeightfield=function(b,g,e,n){var m=new f,j=new d(this.from,this.to);l.pointToLocalFrame(e,g,j.from,
j.from);l.pointToLocalFrame(e,g,j.to,j.to);var r=[],s=null,p=null,t=null,u=null,v=b.getIndexOfPosition(j.from.x,j.from.y,r,!1);v&&(s=r[0],p=r[1],t=r[0],u=r[1]);if(v=b.getIndexOfPosition(j.to.x,j.to.y,r,!1)){if(null===s||r[0]<s)s=r[0];if(null===t||r[0]>t)t=r[0];if(null===p||r[1]<p)p=r[1];if(null===u||r[1]>u)u=r[1]}if(null!==s){b.getRectMinMax(s,p,t,u,[]);for(j=s;j<=t;j++)for(r=p;r<=u;r++){if(this.result._shouldStop)return;b.getConvexTrianglePillar(j,r,!1);l.pointToWorldFrame(e,g,b.pillarOffset,m);
this.intersectConvex(b.pillarConvex,g,m,n,I);if(this.result._shouldStop)return;b.getConvexTrianglePillar(j,r,!0);l.pointToWorldFrame(e,g,b.pillarOffset,m);this.intersectConvex(b.pillarConvex,g,m,n,I)}}};d.prototype[m.types.HEIGHTFIELD]=d.prototype.intersectHeightfield;var y=new f,C=new f;d.prototype.intersectSphere=function(b,d,g,e){d=this.from;var f=this.to,n=b.radius,m=Math.pow(f.x-d.x,2)+Math.pow(f.y-d.y,2)+Math.pow(f.z-d.z,2),j=2*((f.x-d.x)*(d.x-g.x)+(f.y-d.y)*(d.y-g.y)+(f.z-d.z)*(d.z-g.z)),n=
Math.pow(d.x-g.x,2)+Math.pow(d.y-g.y,2)+Math.pow(d.z-g.z,2)-Math.pow(n,2),l=Math.pow(j,2)-4*m*n;0>l||(0===l?(d.lerp(f,l,y),y.vsub(g,C),C.normalize(),this.reportIntersection(C,y,b,e,-1)):(n=(-j-Math.sqrt(l))/(2*m),m=(-j+Math.sqrt(l))/(2*m),0<=n&&1>=n&&(d.lerp(f,n,y),y.vsub(g,C),C.normalize(),this.reportIntersection(C,y,b,e,-1)),!this.result._shouldStop&&(0<=m&&1>=m)&&(d.lerp(f,m,y),y.vsub(g,C),C.normalize(),this.reportIntersection(C,y,b,e,-1))))};d.prototype[m.types.SPHERE]=d.prototype.intersectSphere;
var J=new f;new f;new f;var M=new f;d.prototype.intersectConvex=function(b,d,g,e,f){f=f&&f.faceList||null;for(var n=b.faces,m=b.vertices,l=b.faceNormals,r=this._direction,s=this.from,p=s.distanceTo(this.to),t=f?f.length:n.length,u=this.result,v=0;!u._shouldStop&&v<t;v++){var z=f?f[v]:v,y=n[z],L=l[z],K=d,F=g;M.copy(m[y[0]]);K.vmult(M,M);M.vadd(F,M);M.vsub(s,M);K.vmult(L,J);L=r.dot(J);if(!(Math.abs(L)<this.precision)&&(L=J.dot(M)/L,!(0>L))){r.mult(L,x);x.vadd(s,x);B.copy(m[y[0]]);K.vmult(B,B);F.vadd(B,
B);for(L=1;!u._shouldStop&&L<y.length-1;L++){A.copy(m[y[L]]);D.copy(m[y[L+1]]);K.vmult(A,A);K.vmult(D,D);F.vadd(A,A);F.vadd(D,D);var H=x.distanceTo(s);!j(x,B,A,D)&&!j(x,A,B,D)||H>p||this.reportIntersection(J,x,b,e,z)}}}};d.prototype[m.types.CONVEXPOLYHEDRON]=d.prototype.intersectConvex;var O=new f,N=new f,K=new f,W=new f,ea=new f,F=new f;new n;var H=[],ia=new l;d.prototype.intersectTrimesh=function(b,d,g,e){var f=b.indices,n=this.from,m=this.to,r=this._direction;ia.position.copy(g);ia.quaternion.copy(d);
l.vectorToLocalFrame(g,d,r,N);l.pointToLocalFrame(g,d,n,K);l.pointToLocalFrame(g,d,m,W);n=K.distanceSquared(W);b.tree.rayQuery(this,ia,H);m=0;for(r=H.length;!this.result._shouldStop&&m!==r;m++){var s=H[m];b.getNormal(s,O);b.getVertex(f[3*s],B);B.vsub(K,M);var p=N.dot(O),p=O.dot(M)/p;0>p||(N.scale(p,x),x.vadd(K,x),b.getVertex(f[3*s+1],A),b.getVertex(f[3*s+2],D),p=x.distanceSquared(K),!j(x,A,B,D)&&!j(x,B,A,D)||p>n||(l.vectorToWorldFrame(d,O,ea),l.pointToWorldFrame(g,d,x,F),this.reportIntersection(ea,
F,b,e,s)))}H.length=0};d.prototype[m.types.TRIMESH]=d.prototype.intersectTrimesh;d.prototype.reportIntersection=function(b,g,e,f,n){var m=this.from,j=this.to,l=m.distanceTo(g),r=this.result;if(!(this.skipBackfaces&&0<b.dot(this._direction)))switch(r.hitFaceIndex="undefined"!==typeof n?n:-1,this.mode){case d.ALL:this.hasHit=!0;r.set(m,j,b,g,e,f,l);r.hasHit=!0;this.callback(r);break;case d.CLOSEST:if(l<r.distance||!r.hasHit)this.hasHit=!0,r.hasHit=!0,r.set(m,j,b,g,e,f,l);break;case d.ANY:this.hasHit=
!0,r.hasHit=!0,r.set(m,j,b,g,e,f,l),r._shouldStop=!0}};var R=new f,L=new f},{"../collision/AABB":3,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/Box":37,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43}],10:[function(b,e){function d(){this.rayFromWorld=new j;this.rayToWorld=new j;this.hitNormalWorld=new j;this.hitPointWorld=new j;this.hasHit=!1;this.body=this.shape=null;this.distance=this.hitFaceIndex=-1;this._shouldStop=!1}var j=b("../math/Vec3");
e.exports=d;d.prototype.reset=function(){this.rayFromWorld.setZero();this.rayToWorld.setZero();this.hitNormalWorld.setZero();this.hitPointWorld.setZero();this.hasHit=!1;this.body=this.shape=null;this.distance=this.hitFaceIndex=-1;this._shouldStop=!1};d.prototype.abort=function(){this._shouldStop=!0};d.prototype.set=function(b,d,e,g,m,n,j){this.rayFromWorld.copy(b);this.rayToWorld.copy(d);this.hitNormalWorld.copy(e);this.hitPointWorld.copy(g);this.shape=m;this.body=n;this.distance=j}},{"../math/Vec3":30}],
11:[function(b,e){function d(b){j.apply(this);this.axisList=[];this.world=null;this.axisIndex=0;var d=this.axisList;this._addBodyHandler=function(b){d.push(b.body)};this._removeBodyHandler=function(b){b=d.indexOf(b.body);-1!==b&&d.splice(b,1)};b&&this.setWorld(b)}b("../shapes/Shape");var j=b("../collision/Broadphase");e.exports=d;d.prototype=new j;d.prototype.setWorld=function(b){for(var d=this.axisList.length=0;d<b.bodies.length;d++)this.axisList.push(b.bodies[d]);b.removeEventListener("addBody",
this._addBodyHandler);b.removeEventListener("removeBody",this._removeBodyHandler);b.addEventListener("addBody",this._addBodyHandler);b.addEventListener("removeBody",this._removeBodyHandler);this.world=b;this.dirty=!0};d.insertionSortX=function(b){for(var d=1,e=b.length;d<e;d++){for(var g=b[d],m=d-1;0<=m&&!(b[m].aabb.lowerBound.x<=g.aabb.lowerBound.x);m--)b[m+1]=b[m];b[m+1]=g}return b};d.insertionSortY=function(b){for(var d=1,e=b.length;d<e;d++){for(var g=b[d],m=d-1;0<=m&&!(b[m].aabb.lowerBound.y<=
g.aabb.lowerBound.y);m--)b[m+1]=b[m];b[m+1]=g}return b};d.insertionSortZ=function(b){for(var d=1,e=b.length;d<e;d++){for(var g=b[d],m=d-1;0<=m&&!(b[m].aabb.lowerBound.z<=g.aabb.lowerBound.z);m--)b[m+1]=b[m];b[m+1]=g}return b};d.prototype.collisionPairs=function(b,e,j){b=this.axisList;var g=b.length,m=this.axisIndex,n,r;this.dirty&&(this.sortList(),this.dirty=!1);for(n=0;n!==g;n++){var s=b[n];for(r=n+1;r<g;r++){var t=b[r];if(this.needBroadphaseCollision(s,t)){if(!d.checkBounds(s,t,m))break;this.intersectionTest(s,
t,e,j)}}}};d.prototype.sortList=function(){for(var b=this.axisList,e=this.axisIndex,j=b.length,g=0;g!==j;g++){var m=b[g];m.aabbNeedsUpdate&&m.computeAABB()}0===e?d.insertionSortX(b):1===e?d.insertionSortY(b):2===e&&d.insertionSortZ(b)};d.checkBounds=function(b,d,e){var g,m;0===e?(g=b.position.x,m=d.position.x):1===e?(g=b.position.y,m=d.position.y):2===e&&(g=b.position.z,m=d.position.z);return m-d.boundingRadius<g+b.boundingRadius};d.prototype.autoDetectAxis=function(){for(var b=0,d=0,e=0,g=0,m=0,
n=0,j=this.axisList,s=j.length,t=1/s,u=0;u!==s;u++)var v=j[u],z=v.position.x,b=b+z,d=d+z*z,z=v.position.y,e=e+z,g=g+z*z,v=v.position.z,m=m+v,n=n+v*v;b=d-b*b*t;e=g-e*e*t;m=n-m*m*t;this.axisIndex=b>e?b>m?0:2:e>m?1:2};d.prototype.aabbQuery=function(b,d,e){e=e||[];this.dirty&&(this.sortList(),this.dirty=!1);b=this.axisList;for(var g=0;g<b.length;g++){var m=b[g];m.aabbNeedsUpdate&&m.computeAABB();m.aabb.overlaps(d)&&e.push(m)}return e}},{"../collision/Broadphase":5,"../shapes/Shape":43}],12:[function(b,
e){function d(b,d,e){e=e||{};var r="undefined"!==typeof e.maxForce?e.maxForce:1E6,s=e.pivotA?e.pivotA.clone():new l,t=e.pivotB?e.pivotB.clone():new l;this.axisA=e.axisA?e.axisA.clone():new l;this.axisB=e.axisB?e.axisB.clone():new l;j.call(this,b,s,d,t,r);this.collideConnected=!!e.collideConnected;this.angle="undefined"!==typeof e.angle?e.angle:0;s=this.coneEquation=new f(b,d,e);b=this.twistEquation=new p(b,d,e);this.twistAngle="undefined"!==typeof e.twistAngle?e.twistAngle:0;s.maxForce=0;s.minForce=
-r;b.maxForce=0;b.minForce=-r;this.equations.push(s,b)}e.exports=d;b("./Constraint");var j=b("./PointToPointConstraint"),f=b("../equations/ConeEquation"),p=b("../equations/RotationalEquation");b("../equations/ContactEquation");var l=b("../math/Vec3");d.prototype=new j;d.constructor=d;new l;new l;d.prototype.update=function(){var b=this.bodyA,d=this.bodyB,e=this.coneEquation,f=this.twistEquation;j.prototype.update.call(this);b.vectorToWorldFrame(this.axisA,e.axisA);d.vectorToWorldFrame(this.axisB,
e.axisB);this.axisA.tangents(f.axisA,f.axisA);b.vectorToWorldFrame(f.axisA,f.axisA);this.axisB.tangents(f.axisB,f.axisB);d.vectorToWorldFrame(f.axisB,f.axisB);e.angle=this.angle;f.maxAngle=this.twistAngle}},{"../equations/ConeEquation":18,"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],13:[function(b,e){function d(b,e,l){l=j.defaults(l,{collideConnected:!0,wakeUpBodies:!0});this.equations=[];this.bodyA=b;this.bodyB=
e;this.id=d.idCounter++;this.collideConnected=l.collideConnected;l.wakeUpBodies&&(b&&b.wakeUp(),e&&e.wakeUp())}e.exports=d;var j=b("../utils/Utils");d.prototype.update=function(){throw Error("method update() not implmemented in this Constraint subclass!");};d.prototype.enable=function(){for(var b=this.equations,d=0;d<b.length;d++)b[d].enabled=!0};d.prototype.disable=function(){for(var b=this.equations,d=0;d<b.length;d++)b[d].enabled=!1};d.idCounter=0},{"../utils/Utils":53}],14:[function(b,e){function d(b,
d,g,e){j.call(this,b,d);"undefined"===typeof g&&(g=b.position.distanceTo(d.position));"undefined"===typeof e&&(e=1E6);this.distance=g;b=this.distanceEquation=new f(b,d);this.equations.push(b);b.minForce=-e;b.maxForce=e}e.exports=d;var j=b("./Constraint"),f=b("../equations/ContactEquation");d.prototype=new j;d.prototype.update=function(){var b=this.distanceEquation,d=0.5*this.distance,g=b.ni;this.bodyB.position.vsub(this.bodyA.position,g);g.normalize();g.mult(d,b.ri);g.mult(-d,b.rj)}},{"../equations/ContactEquation":19,
"./Constraint":13}],15:[function(b,e){function d(b,d,g){g=g||{};var e="undefined"!==typeof g.maxForce?g.maxForce:1E6,m=g.pivotA?g.pivotA.clone():new l,v=g.pivotB?g.pivotB.clone():new l;j.call(this,b,m,d,v,e);(this.axisA=g.axisA?g.axisA.clone():new l(1,0,0)).normalize();(this.axisB=g.axisB?g.axisB.clone():new l(1,0,0)).normalize();m=this.rotationalEquation1=new f(b,d,g);g=this.rotationalEquation2=new f(b,d,g);b=this.motorEquation=new p(b,d,e);b.enabled=!1;this.equations.push(m,g,b)}e.exports=d;b("./Constraint");
var j=b("./PointToPointConstraint"),f=b("../equations/RotationalEquation"),p=b("../equations/RotationalMotorEquation");b("../equations/ContactEquation");var l=b("../math/Vec3");d.prototype=new j;d.constructor=d;d.prototype.enableMotor=function(){this.motorEquation.enabled=!0};d.prototype.disableMotor=function(){this.motorEquation.enabled=!1};d.prototype.setMotorSpeed=function(b){this.motorEquation.targetVelocity=b};d.prototype.setMotorMaxForce=function(b){this.motorEquation.maxForce=b;this.motorEquation.minForce=
-b};var g=new l,m=new l;d.prototype.update=function(){var b=this.bodyA,d=this.bodyB,e=this.motorEquation,f=this.rotationalEquation1,l=this.rotationalEquation2,p=this.axisA,z=this.axisB;j.prototype.update.call(this);b.quaternion.vmult(p,g);d.quaternion.vmult(z,m);g.tangents(f.axisA,l.axisA);f.axisB.copy(m);l.axisB.copy(m);this.motorEquation.enabled&&(b.quaternion.vmult(this.axisA,e.axisA),d.quaternion.vmult(this.axisB,e.axisB))}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,
"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],16:[function(b,e){function d(b,d,e){e=e||{};var n="undefined"!==typeof e.maxForce?e.maxForce:1E6,r=new p,s=new p,t=new p;b.position.vadd(d.position,t);t.scale(0.5,t);d.pointToLocalFrame(t,s);b.pointToLocalFrame(t,r);j.call(this,b,r,d,s,n);n=this.rotationalEquation1=new f(b,d,e);r=this.rotationalEquation2=new f(b,d,e);b=this.rotationalEquation3=new f(b,d,e);this.equations.push(n,r,b)}e.exports=
d;b("./Constraint");var j=b("./PointToPointConstraint"),f=b("../equations/RotationalEquation");b("../equations/RotationalMotorEquation");b("../equations/ContactEquation");var p=b("../math/Vec3");d.prototype=new j;d.constructor=d;new p;new p;d.prototype.update=function(){var b=this.bodyA,d=this.bodyB,e=this.rotationalEquation1,f=this.rotationalEquation2,r=this.rotationalEquation3;j.prototype.update.call(this);b.vectorToWorldFrame(p.UNIT_X,e.axisA);d.vectorToWorldFrame(p.UNIT_Y,e.axisB);b.vectorToWorldFrame(p.UNIT_Y,
f.axisA);d.vectorToWorldFrame(p.UNIT_Z,f.axisB);b.vectorToWorldFrame(p.UNIT_Z,r.axisA);d.vectorToWorldFrame(p.UNIT_X,r.axisB)}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],17:[function(b,e){function d(b,d,e,n,r){j.call(this,b,e);r="undefined"!==typeof r?r:1E6;this.pivotA=d?d.clone():new p;this.pivotB=n?n.clone():new p;d=this.equationX=new f(b,e);n=this.equationY=
new f(b,e);b=this.equationZ=new f(b,e);this.equations.push(d,n,b);d.minForce=n.minForce=b.minForce=-r;d.maxForce=n.maxForce=b.maxForce=r;d.ni.set(1,0,0);n.ni.set(0,1,0);b.ni.set(0,0,1)}e.exports=d;var j=b("./Constraint"),f=b("../equations/ContactEquation"),p=b("../math/Vec3");d.prototype=new j;d.prototype.update=function(){var b=this.bodyB,d=this.equationX,e=this.equationY,f=this.equationZ;this.bodyA.quaternion.vmult(this.pivotA,d.ri);b.quaternion.vmult(this.pivotB,d.rj);e.ri.copy(d.ri);e.rj.copy(d.rj);
f.ri.copy(d.ri);f.rj.copy(d.rj)}},{"../equations/ContactEquation":19,"../math/Vec3":30,"./Constraint":13}],18:[function(b,e){function d(b,d,e){e=e||{};var l="undefined"!==typeof e.maxForce?e.maxForce:1E6;f.call(this,b,d,-l,l);this.axisA=e.axisA?e.axisA.clone():new j(1,0,0);this.axisB=e.axisB?e.axisB.clone():new j(0,1,0);this.angle="undefined"!==typeof e.angle?e.angle:0}e.exports=d;var j=b("../math/Vec3");b("../math/Mat3");var f=b("./Equation");d.prototype=new f;d.prototype.constructor=d;var p=new j,
l=new j;d.prototype.computeB=function(b){var d=this.a,e=this.b,f=this.axisA,j=this.axisB,t=this.jacobianElementA,u=this.jacobianElementB;f.cross(j,p);j.cross(f,l);t.rotational.copy(l);u.rotational.copy(p);f=Math.cos(this.angle)-f.dot(j);j=this.computeGW();t=this.computeGiMf();return-f*d-j*e-b*t}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],19:[function(b,e){function d(b,d,g){j.call(this,b,d,0,"undefined"!==typeof g?g:1E6);this.restitution=0;this.ri=new f;this.rj=new f;this.ni=new f}e.exports=
d;var j=b("./Equation"),f=b("../math/Vec3");b("../math/Mat3");d.prototype=new j;d.prototype.constructor=d;var p=new f,l=new f,g=new f;d.prototype.computeB=function(b){var d=this.a,e=this.b,f=this.bi,n=this.bj,m=this.ri,j=this.rj,r=f.velocity,s=f.angularVelocity,t=n.velocity,J=n.angularVelocity,M=this.jacobianElementA,O=this.jacobianElementB,N=this.ni;m.cross(N,p);j.cross(N,l);N.negate(M.spatial);p.negate(M.rotational);O.spatial.copy(N);O.rotational.copy(l);g.copy(n.position);g.vadd(j,g);g.vsub(f.position,
g);g.vsub(m,g);f=N.dot(g);n=this.restitution+1;r=n*t.dot(N)-n*r.dot(N)+J.dot(l)-s.dot(p);s=this.computeGiMf();return-f*d-r*e-b*s};var m=new f,n=new f,r=new f,s=new f,t=new f;d.prototype.getImpactVelocityAlongNormal=function(){this.bi.position.vadd(this.ri,r);this.bj.position.vadd(this.rj,s);this.bi.getVelocityAtWorldPoint(r,m);this.bj.getVelocityAtWorldPoint(s,n);m.vsub(n,t);return this.ni.dot(t)}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],20:[function(b,e){function d(b,g,e,f){this.id=
d.id++;this.minForce="undefined"===typeof e?-1E6:e;this.maxForce="undefined"===typeof f?1E6:f;this.bi=b;this.bj=g;this.eps=this.b=this.a=0;this.jacobianElementA=new j;this.jacobianElementB=new j;this.enabled=!0;this.setSpookParams(1E7,4,1/60)}e.exports=d;var j=b("../math/JacobianElement"),f=b("../math/Vec3");d.prototype.constructor=d;d.id=0;d.prototype.setSpookParams=function(b,d,g){this.a=4/(g*(1+4*d));this.b=4*d/(1+4*d);this.eps=4/(g*g*b*(1+4*d))};d.prototype.computeB=function(b,d,g){var e=this.computeGW(),
f=this.computeGq(),n=this.computeGiMf();return-f*b-e*d-n*g};d.prototype.computeGq=function(){var b=this.jacobianElementB,d=this.bj.position;return this.jacobianElementA.spatial.dot(this.bi.position)+b.spatial.dot(d)};var p=new f;d.prototype.computeGW=function(){var b=this.jacobianElementB,d=this.bi,g=this.bj,e=g.velocity,g=g.angularVelocity||p;return this.jacobianElementA.multiplyVectors(d.velocity,d.angularVelocity||p)+b.multiplyVectors(e,g)};d.prototype.computeGWlambda=function(){var b=this.jacobianElementB,
d=this.bi,g=this.bj,e=g.vlambda,g=g.wlambda||p;return this.jacobianElementA.multiplyVectors(d.vlambda,d.wlambda||p)+b.multiplyVectors(e,g)};var l=new f,g=new f,m=new f,n=new f;d.prototype.computeGiMf=function(){var b=this.jacobianElementA,d=this.jacobianElementB,e=this.bi,f=this.bj,j=e.force,r=e.torque,s=f.force,p=f.torque,I=e.invMassSolve,y=f.invMassSolve;e.invInertiaWorldSolve?e.invInertiaWorldSolve.vmult(r,m):m.set(0,0,0);f.invInertiaWorldSolve?f.invInertiaWorldSolve.vmult(p,n):n.set(0,0,0);j.mult(I,
l);s.mult(y,g);return b.multiplyVectors(l,m)+d.multiplyVectors(g,n)};var r=new f;d.prototype.computeGiMGt=function(){var b=this.jacobianElementA,d=this.jacobianElementB,g=this.bi,e=this.bj,f=g.invInertiaWorldSolve,n=e.invInertiaWorldSolve,g=g.invMassSolve+e.invMassSolve;f&&(f.vmult(b.rotational,r),g+=r.dot(b.rotational));n&&(n.vmult(d.rotational,r),g+=r.dot(d.rotational));return g};var s=new f;new f;new f;new f;new f;new f;d.prototype.addToWlambda=function(b){var d=this.jacobianElementA,g=this.jacobianElementB,
e=this.bi,f=this.bj;d.spatial.mult(e.invMassSolve*b,s);e.vlambda.vadd(s,e.vlambda);g.spatial.mult(f.invMassSolve*b,s);f.vlambda.vadd(s,f.vlambda);e.invInertiaWorldSolve&&(e.invInertiaWorldSolve.vmult(d.rotational,s),s.mult(b,s),e.wlambda.vadd(s,e.wlambda));f.invInertiaWorldSolve&&(f.invInertiaWorldSolve.vmult(g.rotational,s),s.mult(b,s),f.wlambda.vadd(s,f.wlambda))};d.prototype.computeC=function(){return this.computeGiMGt()+this.eps}},{"../math/JacobianElement":26,"../math/Vec3":30}],21:[function(b,
e){function d(b,d,e){j.call(this,b,d,-e,e);this.ri=new f;this.rj=new f;this.t=new f}e.exports=d;var j=b("./Equation"),f=b("../math/Vec3");b("../math/Mat3");d.prototype=new j;d.prototype.constructor=d;var p=new f,l=new f;d.prototype.computeB=function(b){var d=this.b,e=this.rj,f=this.t;this.ri.cross(f,p);e.cross(f,l);var e=this.jacobianElementA,j=this.jacobianElementB;f.negate(e.spatial);p.negate(e.rotational);j.spatial.copy(f);j.rotational.copy(l);f=this.computeGW();e=this.computeGiMf();return-f*d-
b*e}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],22:[function(b,e){function d(b,d,e){e=e||{};var l="undefined"!==typeof e.maxForce?e.maxForce:1E6;f.call(this,b,d,-l,l);this.axisA=e.axisA?e.axisA.clone():new j(1,0,0);this.axisB=e.axisB?e.axisB.clone():new j(0,1,0);this.maxAngle=Math.PI/2}e.exports=d;var j=b("../math/Vec3");b("../math/Mat3");var f=b("./Equation");d.prototype=new f;d.prototype.constructor=d;var p=new j,l=new j;d.prototype.computeB=function(b){var d=this.a,e=this.b,f=this.axisA,
j=this.axisB,t=this.jacobianElementA,u=this.jacobianElementB;f.cross(j,p);j.cross(f,l);t.rotational.copy(l);u.rotational.copy(p);f=Math.cos(this.maxAngle)-f.dot(j);j=this.computeGW();t=this.computeGiMf();return-f*d-j*e-b*t}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],23:[function(b,e){function d(b,d,g){g="undefined"!==typeof g?g:1E6;f.call(this,b,d,-g,g);this.axisA=new j;this.axisB=new j;this.targetVelocity=0}e.exports=d;var j=b("../math/Vec3");b("../math/Mat3");var f=b("./Equation");
d.prototype=new f;d.prototype.constructor=d;d.prototype.computeB=function(b){var d=this.b,g=this.axisB,e=this.jacobianElementB;this.jacobianElementA.rotational.copy(this.axisA);g.negate(e.rotational);g=this.computeGW()-this.targetVelocity;e=this.computeGiMf();return-g*d-b*e}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],24:[function(b,e){function d(b,e,l){l=j.defaults(l,{friction:0.3,restitution:0.3,contactEquationStiffness:1E7,contactEquationRelaxation:3,frictionEquationStiffness:1E7,frictionEquationRelaxation:3});
this.id=d.idCounter++;this.materials=[b,e];this.friction=l.friction;this.restitution=l.restitution;this.contactEquationStiffness=l.contactEquationStiffness;this.contactEquationRelaxation=l.contactEquationRelaxation;this.frictionEquationStiffness=l.frictionEquationStiffness;this.frictionEquationRelaxation=l.frictionEquationRelaxation}var j=b("../utils/Utils");e.exports=d;d.idCounter=0},{"../utils/Utils":53}],25:[function(b,e){function d(b){var e="";b=b||{};"string"===typeof b?(e=b,b={}):"object"===
typeof b&&(e="");this.name=e;this.id=d.idCounter++;this.friction="undefined"!==typeof b.friction?b.friction:-1;this.restitution="undefined"!==typeof b.restitution?b.restitution:-1}e.exports=d;d.idCounter=0},{}],26:[function(b,e){function d(){this.spatial=new j;this.rotational=new j}e.exports=d;var j=b("./Vec3");d.prototype.multiplyElement=function(b){return b.spatial.dot(this.spatial)+b.rotational.dot(this.rotational)};d.prototype.multiplyVectors=function(b,d){return b.dot(this.spatial)+d.dot(this.rotational)}},
{"./Vec3":30}],27:[function(b,e){function d(b){this.elements=b?b:[0,0,0,0,0,0,0,0,0]}e.exports=d;var j=b("./Vec3");d.prototype.identity=function(){var b=this.elements;b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=1;b[5]=0;b[6]=0;b[7]=0;b[8]=1};d.prototype.setZero=function(){var b=this.elements;b[0]=0;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=0;b[6]=0;b[7]=0;b[8]=0};d.prototype.setTrace=function(b){var d=this.elements;d[0]=b.x;d[4]=b.y;d[8]=b.z};d.prototype.getTrace=function(b){b=b||new j;var d=this.elements;b.x=d[0];b.y=
d[4];b.z=d[8]};d.prototype.vmult=function(b,d){d=d||new j;var e=this.elements,g=b.x,m=b.y,n=b.z;d.x=e[0]*g+e[1]*m+e[2]*n;d.y=e[3]*g+e[4]*m+e[5]*n;d.z=e[6]*g+e[7]*m+e[8]*n;return d};d.prototype.smult=function(b){for(var d=0;d<this.elements.length;d++)this.elements[d]*=b};d.prototype.mmult=function(b,e){for(var j=e||new d,g=0;3>g;g++)for(var m=0;3>m;m++){for(var n=0,r=0;3>r;r++)n+=b.elements[g+3*r]*this.elements[r+3*m];j.elements[g+3*m]=n}return j};d.prototype.scale=function(b,e){e=e||new d;for(var j=
this.elements,g=e.elements,m=0;3!==m;m++)g[3*m+0]=b.x*j[3*m+0],g[3*m+1]=b.y*j[3*m+1],g[3*m+2]=b.z*j[3*m+2];return e};d.prototype.solve=function(b,d){d=d||new j;for(var e=[],g=0;12>g;g++)e.push(0);for(var m,g=0;3>g;g++)for(m=0;3>m;m++)e[g+4*m]=this.elements[g+3*m];e[3]=b.x;e[7]=b.y;e[11]=b.z;var n=3,r=n,s,t;do{g=r-n;if(0===e[g+4*g])for(m=g+1;m<r;m++)if(0!==e[g+4*m]){s=4;do t=4-s,e[t+4*g]+=e[t+4*m];while(--s);break}if(0!==e[g+4*g])for(m=g+1;m<r;m++){var u=e[g+4*m]/e[g+4*g];s=4;do t=4-s,e[t+4*m]=t<=
g?0:e[t+4*m]-e[t+4*g]*u;while(--s)}}while(--n);d.z=e[11]/e[10];d.y=(e[7]-e[6]*d.z)/e[5];d.x=(e[3]-e[2]*d.z-e[1]*d.y)/e[0];if(isNaN(d.x)||isNaN(d.y)||isNaN(d.z)||Infinity===d.x||Infinity===d.y||Infinity===d.z)throw"Could not solve equation! Got x=["+d.toString()+"], b=["+b.toString()+"], A=["+this.toString()+"]";return d};d.prototype.e=function(b,d,e){if(void 0===e)return this.elements[d+3*b];this.elements[d+3*b]=e};d.prototype.copy=function(b){for(var d=0;d<b.elements.length;d++)this.elements[d]=
b.elements[d];return this};d.prototype.toString=function(){for(var b="",d=0;9>d;d++)b+=this.elements[d]+",";return b};d.prototype.reverse=function(b){b=b||new d;for(var e=[],j=0;18>j;j++)e.push(0);for(var g,j=0;3>j;j++)for(g=0;3>g;g++)e[j+6*g]=this.elements[j+3*g];e[3]=1;e[9]=0;e[15]=0;e[4]=0;e[10]=1;e[16]=0;e[5]=0;e[11]=0;e[17]=1;var m=3,n=m,r,s;do{j=n-m;if(0===e[j+6*j])for(g=j+1;g<n;g++)if(0!==e[j+6*g]){r=6;do s=6-r,e[s+6*j]+=e[s+6*g];while(--r);break}if(0!==e[j+6*j])for(g=j+1;g<n;g++){var t=e[j+
6*g]/e[j+6*j];r=6;do s=6-r,e[s+6*g]=s<=j?0:e[s+6*g]-e[s+6*j]*t;while(--r)}}while(--m);j=2;do{g=j-1;do{t=e[j+6*g]/e[j+6*j];r=6;do s=6-r,e[s+6*g]-=e[s+6*j]*t;while(--r)}while(g--)}while(--j);j=2;do{t=1/e[j+6*j];r=6;do s=6-r,e[s+6*j]*=t;while(--r)}while(j--);j=2;do{g=2;do{s=e[3+g+6*j];if(isNaN(s)||Infinity===s)throw"Could not reverse! A=["+this.toString()+"]";b.e(j,g,s)}while(g--)}while(j--);return b};d.prototype.setRotationFromQuaternion=function(b){var d=b.x,e=b.y,g=b.z,m=b.w,n=d+d,j=e+e,s=g+g;b=d*
n;var t=d*j,d=d*s,u=e*j,e=e*s,g=g*s,n=m*n,j=m*j,m=m*s,s=this.elements;s[0]=1-(u+g);s[1]=t-m;s[2]=d+j;s[3]=t+m;s[4]=1-(b+g);s[5]=e-n;s[6]=d-j;s[7]=e+n;s[8]=1-(b+u);return this};d.prototype.transpose=function(b){b=b||new d;for(var e=b.elements,j=this.elements,g=0;3!==g;g++)for(var m=0;3!==m;m++)e[3*g+m]=j[3*m+g];return b}},{"./Vec3":30}],28:[function(b,e){function d(b,d,e,g){this.x=void 0!==b?b:0;this.y=void 0!==d?d:0;this.z=void 0!==e?e:0;this.w=void 0!==g?g:1}e.exports=d;var j=b("./Vec3");d.prototype.set=
function(b,d,e,g){this.x=b;this.y=d;this.z=e;this.w=g};d.prototype.toString=function(){return this.x+","+this.y+","+this.z+","+this.w};d.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]};d.prototype.setFromAxisAngle=function(b,d){var e=Math.sin(0.5*d);this.x=b.x*e;this.y=b.y*e;this.z=b.z*e;this.w=Math.cos(0.5*d)};d.prototype.toAxisAngle=function(b){b=b||new j;this.normalize();var d=2*Math.acos(this.w),e=Math.sqrt(1-this.w*this.w);0.001>e?(b.x=this.x,b.y=this.y,b.z=this.z):(b.x=this.x/
e,b.y=this.y/e,b.z=this.z/e);return[b,d]};var f=new j,p=new j;d.prototype.setFromVectors=function(b,d){if(b.isAntiparallelTo(d))b.tangents(f,p),this.setFromAxisAngle(f,Math.PI);else{var e=b.cross(d);this.x=e.x;this.y=e.y;this.z=e.z;this.w=Math.sqrt(Math.pow(b.norm(),2)*Math.pow(d.norm(),2))+b.dot(d);this.normalize()}};var l=new j,g=new j,m=new j;d.prototype.mult=function(b,e){e=e||new d;var f=this.w;l.set(this.x,this.y,this.z);g.set(b.x,b.y,b.z);e.w=f*b.w-l.dot(g);l.cross(g,m);e.x=f*g.x+b.w*l.x+m.x;
e.y=f*g.y+b.w*l.y+m.y;e.z=f*g.z+b.w*l.z+m.z;return e};d.prototype.inverse=function(b){var e=this.x,g=this.y,f=this.z,m=this.w;b=b||new d;this.conjugate(b);e=1/(e*e+g*g+f*f+m*m);b.x*=e;b.y*=e;b.z*=e;b.w*=e;return b};d.prototype.conjugate=function(b){b=b||new d;b.x=-this.x;b.y=-this.y;b.z=-this.z;b.w=this.w;return b};d.prototype.normalize=function(){var b=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);0===b?this.w=this.z=this.y=this.x=0:(b=1/b,this.x*=b,this.y*=b,this.z*=b,this.w*=
b)};d.prototype.normalizeFast=function(){var b=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;0===b?this.w=this.z=this.y=this.x=0:(this.x*=b,this.y*=b,this.z*=b,this.w*=b)};d.prototype.vmult=function(b,d){d=d||new j;var e=b.x,g=b.y,f=b.z,m=this.x,l=this.y,p=this.z,B=this.w,A=B*e+l*f-p*g,D=B*g+p*e-m*f,I=B*f+m*g-l*e,e=-m*e-l*g-p*f;d.x=A*B+e*-m+D*-p-I*-l;d.y=D*B+e*-l+I*-m-A*-p;d.z=I*B+e*-p+A*-l-D*-m;return d};d.prototype.copy=function(b){this.x=b.x;this.y=b.y;this.z=b.z;this.w=b.w;return this};
d.prototype.toEuler=function(b,d){d=d||"YZX";var e,g,f,m=this.x,j=this.y,l=this.z,p=this.w;switch(d){case "YZX":var A=m*j+l*p;0.499<A&&(e=2*Math.atan2(m,p),g=Math.PI/2,f=0);-0.499>A&&(e=-2*Math.atan2(m,p),g=-Math.PI/2,f=0);if(isNaN(e)){f=m*m;var D=l*l;e=Math.atan2(2*j*p-2*m*l,1-2*j*j-2*D);g=Math.asin(2*A);f=Math.atan2(2*m*p-2*j*l,1-2*f-2*D)}break;default:throw Error("Euler order "+d+" not supported yet.");}b.y=e;b.z=g;b.x=f};d.prototype.setFromEuler=function(b,d,e,g){g=g||"XYZ";var f=Math.cos(b/2),
m=Math.cos(d/2),j=Math.cos(e/2);b=Math.sin(b/2);d=Math.sin(d/2);e=Math.sin(e/2);"XYZ"===g?(this.x=b*m*j+f*d*e,this.y=f*d*j-b*m*e,this.z=f*m*e+b*d*j,this.w=f*m*j-b*d*e):"YXZ"===g?(this.x=b*m*j+f*d*e,this.y=f*d*j-b*m*e,this.z=f*m*e-b*d*j,this.w=f*m*j+b*d*e):"ZXY"===g?(this.x=b*m*j-f*d*e,this.y=f*d*j+b*m*e,this.z=f*m*e+b*d*j,this.w=f*m*j-b*d*e):"ZYX"===g?(this.x=b*m*j-f*d*e,this.y=f*d*j+b*m*e,this.z=f*m*e-b*d*j,this.w=f*m*j+b*d*e):"YZX"===g?(this.x=b*m*j+f*d*e,this.y=f*d*j+b*m*e,this.z=f*m*e-b*d*j,this.w=
f*m*j-b*d*e):"XZY"===g&&(this.x=b*m*j-f*d*e,this.y=f*d*j-b*m*e,this.z=f*m*e+b*d*j,this.w=f*m*j+b*d*e);return this};d.prototype.clone=function(){return new d(this.x,this.y,this.z,this.w)}},{"./Vec3":30}],29:[function(b,e){function d(b){b=b||{};this.position=new j;b.position&&this.position.copy(b.position);this.quaternion=new f;b.quaternion&&this.quaternion.copy(b.quaternion)}var j=b("./Vec3"),f=b("./Quaternion");e.exports=d;var p=new f;d.pointToLocalFrame=function(b,d,e,f){f=f||new j;e.vsub(b,f);d.conjugate(p);
p.vmult(f,f);return f};d.prototype.pointToLocal=function(b,e){return d.pointToLocalFrame(this.position,this.quaternion,b,e)};d.pointToWorldFrame=function(b,d,e,f){f=f||new j;d.vmult(e,f);f.vadd(b,f);return f};d.prototype.pointToWorld=function(b,e){return d.pointToWorldFrame(this.position,this.quaternion,b,e)};d.prototype.vectorToWorldFrame=function(b,d){d=d||new j;this.quaternion.vmult(b,d);return d};d.vectorToWorldFrame=function(b,d,e){b.vmult(d,e);return e};d.vectorToLocalFrame=function(b,d,e,f){f=
f||new j;d.w*=-1;d.vmult(e,f);d.w*=-1;return f}},{"./Quaternion":28,"./Vec3":30}],30:[function(b,e){function d(b,d,e){this.x=b||0;this.y=d||0;this.z=e||0}e.exports=d;var j=b("./Mat3");d.ZERO=new d(0,0,0);d.UNIT_X=new d(1,0,0);d.UNIT_Y=new d(0,1,0);d.UNIT_Z=new d(0,0,1);d.prototype.cross=function(b,e){var f=b.x,j=b.y,l=b.z,p=this.x,u=this.y,v=this.z;e=e||new d;e.x=u*l-v*j;e.y=v*f-p*l;e.z=p*j-u*f;return e};d.prototype.set=function(b,d,e){this.x=b;this.y=d;this.z=e;return this};d.prototype.setZero=function(){this.x=
this.y=this.z=0};d.prototype.vadd=function(b,e){if(e)e.x=b.x+this.x,e.y=b.y+this.y,e.z=b.z+this.z;else return new d(this.x+b.x,this.y+b.y,this.z+b.z)};d.prototype.vsub=function(b,e){if(e)e.x=this.x-b.x,e.y=this.y-b.y,e.z=this.z-b.z;else return new d(this.x-b.x,this.y-b.y,this.z-b.z)};d.prototype.crossmat=function(){return new j([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])};d.prototype.normalize=function(){var b=this.x,d=this.y,e=this.z,b=Math.sqrt(b*b+d*d+e*e);0<b?(d=1/b,this.x*=d,this.y*=
d,this.z*=d):this.z=this.y=this.x=0;return b};d.prototype.unit=function(b){b=b||new d;var e=this.x,f=this.y,j=this.z,l=Math.sqrt(e*e+f*f+j*j);0<l?(l=1/l,b.x=e*l,b.y=f*l,b.z=j*l):(b.x=1,b.y=0,b.z=0);return b};d.prototype.norm=function(){var b=this.x,d=this.y,e=this.z;return Math.sqrt(b*b+d*d+e*e)};d.prototype.length=d.prototype.norm;d.prototype.norm2=function(){return this.dot(this)};d.prototype.lengthSquared=d.prototype.norm2;d.prototype.distanceTo=function(b){var d=this.x,e=this.y,f=this.z,j=b.x,
l=b.y;b=b.z;return Math.sqrt((j-d)*(j-d)+(l-e)*(l-e)+(b-f)*(b-f))};d.prototype.distanceSquared=function(b){var d=this.x,e=this.y,f=this.z,j=b.x,l=b.y;b=b.z;return(j-d)*(j-d)+(l-e)*(l-e)+(b-f)*(b-f)};d.prototype.mult=function(b,e){e=e||new d;var f=this.y,j=this.z;e.x=b*this.x;e.y=b*f;e.z=b*j;return e};d.prototype.scale=d.prototype.mult;d.prototype.dot=function(b){return this.x*b.x+this.y*b.y+this.z*b.z};d.prototype.isZero=function(){return 0===this.x&&0===this.y&&0===this.z};d.prototype.negate=function(b){b=
b||new d;b.x=-this.x;b.y=-this.y;b.z=-this.z;return b};var f=new d,p=new d;d.prototype.tangents=function(b,d){var e=this.norm();0<e?(e=1/e,f.set(this.x*e,this.y*e,this.z*e),0.9>Math.abs(f.x)?p.set(1,0,0):p.set(0,1,0),f.cross(p,b),f.cross(b,d)):(b.set(1,0,0),d.set(0,1,0))};d.prototype.toString=function(){return this.x+","+this.y+","+this.z};d.prototype.toArray=function(){return[this.x,this.y,this.z]};d.prototype.copy=function(b){this.x=b.x;this.y=b.y;this.z=b.z;return this};d.prototype.lerp=function(b,
d,e){var f=this.x,j=this.y,l=this.z;e.x=f+(b.x-f)*d;e.y=j+(b.y-j)*d;e.z=l+(b.z-l)*d};d.prototype.almostEquals=function(b,d){void 0===d&&(d=1E-6);return Math.abs(this.x-b.x)>d||Math.abs(this.y-b.y)>d||Math.abs(this.z-b.z)>d?!1:!0};d.prototype.almostZero=function(b){void 0===b&&(b=1E-6);return Math.abs(this.x)>b||Math.abs(this.y)>b||Math.abs(this.z)>b?!1:!0};var l=new d;d.prototype.isAntiparallelTo=function(b,d){this.negate(l);return l.almostEquals(b,d)};d.prototype.clone=function(){return new d(this.x,
this.y,this.z)}},{"./Mat3":27}],31:[function(b,e){function d(b){b=b||{};j.apply(this);this.id=d.idCounter++;this.postStep=this.preStep=this.world=null;this.vlambda=new f;this.collisionFilterGroup="number"===typeof b.collisionFilterGroup?b.collisionFilterGroup:1;this.collisionFilterMask="number"===typeof b.collisionFilterMask?b.collisionFilterMask:1;this.collisionResponse=!0;this.position=new f;b.position&&this.position.copy(b.position);this.previousPosition=new f;this.initPosition=new f;this.velocity=
new f;b.velocity&&this.velocity.copy(b.velocity);this.initVelocity=new f;this.force=new f;var e="number"===typeof b.mass?b.mass:0;this.mass=e;this.invMass=0<e?1/e:0;this.material=b.material||null;this.linearDamping="number"===typeof b.linearDamping?b.linearDamping:0.01;this.type=0>=e?d.STATIC:d.DYNAMIC;typeof b.type===typeof d.STATIC&&(this.type=b.type);this.allowSleep="undefined"!==typeof b.allowSleep?b.allowSleep:!0;this.sleepState=0;this.sleepSpeedLimit="undefined"!==typeof b.sleepSpeedLimit?b.sleepSpeedLimit:
0.1;this.sleepTimeLimit="undefined"!==typeof b.sleepTimeLimit?b.sleepTimeLimit:1;this.timeLastSleepy=0;this._wakeUpAfterNarrowphase=!1;this.torque=new f;this.quaternion=new l;b.quaternion&&this.quaternion.copy(b.quaternion);this.initQuaternion=new l;this.angularVelocity=new f;b.angularVelocity&&this.angularVelocity.copy(b.angularVelocity);this.initAngularVelocity=new f;this.interpolatedPosition=new f;this.interpolatedQuaternion=new l;this.shapes=[];this.shapeOffsets=[];this.shapeOrientations=[];this.inertia=
new f;this.invInertia=new f;this.invInertiaWorld=new p;this.invMassSolve=0;this.invInertiaSolve=new f;this.invInertiaWorldSolve=new p;this.fixedRotation="undefined"!==typeof b.fixedRotation?b.fixedRotation:!1;this.angularDamping="undefined"!==typeof b.angularDamping?b.angularDamping:0.01;this.aabb=new g;this.aabbNeedsUpdate=!0;this.wlambda=new f;b.shape&&this.addShape(b.shape);this.updateMassProperties()}e.exports=d;var j=b("../utils/EventTarget");b("../shapes/Shape");var f=b("../math/Vec3"),p=b("../math/Mat3"),
l=b("../math/Quaternion");b("../material/Material");var g=b("../collision/AABB"),m=b("../shapes/Box");d.prototype=new j;d.prototype.constructor=d;d.DYNAMIC=1;d.STATIC=2;d.KINEMATIC=4;d.AWAKE=0;d.SLEEPY=1;d.SLEEPING=2;d.idCounter=0;d.prototype.wakeUp=function(){var b=this.sleepState;this.sleepState=0;b===d.SLEEPING&&this.dispatchEvent({type:"wakeup"})};d.prototype.sleep=function(){this.sleepState=d.SLEEPING;this.velocity.set(0,0,0);this.angularVelocity.set(0,0,0)};d.sleepyEvent={type:"sleepy"};d.sleepEvent=
{type:"sleep"};d.prototype.sleepTick=function(b){if(this.allowSleep){var e=this.sleepState,g=this.velocity.norm2()+this.angularVelocity.norm2(),f=Math.pow(this.sleepSpeedLimit,2);e===d.AWAKE&&g<f?(this.sleepState=d.SLEEPY,this.timeLastSleepy=b,this.dispatchEvent(d.sleepyEvent)):e===d.SLEEPY&&g>f?this.wakeUp():e===d.SLEEPY&&b-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(d.sleepEvent))}};d.prototype.updateSolveMassProperties=function(){this.sleepState===d.SLEEPING||this.type===
d.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))};d.prototype.pointToLocalFrame=function(b,d){d=d||new f;b.vsub(this.position,d);this.quaternion.conjugate().vmult(d,d);return d};d.prototype.vectorToLocalFrame=function(b,d){d=d||new f;this.quaternion.conjugate().vmult(b,d);return d};d.prototype.pointToWorldFrame=function(b,
d){d=d||new f;this.quaternion.vmult(b,d);d.vadd(this.position,d);return d};d.prototype.vectorToWorldFrame=function(b,d){d=d||new f;this.quaternion.vmult(b,d);return d};var n=new f,r=new l;d.prototype.addShape=function(b,d,e){var g=new f,m=new l;d&&g.copy(d);e&&m.copy(e);this.shapes.push(b);this.shapeOffsets.push(g);this.shapeOrientations.push(m);this.updateMassProperties();this.updateBoundingRadius();this.aabbNeedsUpdate=!0;return this};d.prototype.updateBoundingRadius=function(){for(var b=this.shapes,
d=this.shapeOffsets,e=b.length,g=0,f=0;f!==e;f++){var m=b[f];m.updateBoundingSphereRadius();var j=d[f].norm(),m=m.boundingSphereRadius;j+m>g&&(g=j+m)}this.boundingRadius=g};var s=new g;d.prototype.computeAABB=function(){for(var b=this.shapes,d=this.shapeOffsets,e=this.shapeOrientations,g=b.length,f=this.quaternion,m=this.aabb,j=0;j!==g;j++){var l=b[j];e[j].mult(f,r);r.vmult(d[j],n);n.vadd(this.position,n);l.calculateWorldAABB(n,r,s.lowerBound,s.upperBound);0===j?m.copy(s):m.extend(s)}this.aabbNeedsUpdate=
!1};var t=new p,u=new p;new p;d.prototype.updateInertiaWorld=function(b){var d=this.invInertia;d.x===d.y&&d.y===d.z&&!b||(t.setRotationFromQuaternion(this.quaternion),t.transpose(u),t.scale(d,t),t.mmult(u,this.invInertiaWorld))};var v=new f,z=new f;d.prototype.applyForce=function(b,e){this.type===d.DYNAMIC&&(e.vsub(this.position,v),v.cross(b,z),this.force.vadd(b,this.force),this.torque.vadd(z,this.torque))};var x=new f,B=new f;d.prototype.applyLocalForce=function(b,e){this.type===d.DYNAMIC&&(this.vectorToWorldFrame(b,
x),this.pointToWorldFrame(e,B),this.applyForce(x,B))};var A=new f,D=new f,I=new f;d.prototype.applyImpulse=function(b,e){this.type===d.DYNAMIC&&(e.vsub(this.position,A),D.copy(b),D.mult(this.invMass,D),this.velocity.vadd(D,this.velocity),A.cross(b,I),this.invInertiaWorld.vmult(I,I),this.angularVelocity.vadd(I,this.angularVelocity))};var y=new f,C=new f;d.prototype.applyLocalImpulse=function(b,e){this.type===d.DYNAMIC&&(this.vectorToWorldFrame(b,y),this.pointToWorldFrame(e,C),this.applyImpulse(y,C))};
var J=new f;d.prototype.updateMassProperties=function(){this.invMass=0<this.mass?1/this.mass:0;var b=this.inertia,d=this.fixedRotation;this.computeAABB();J.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2);m.calculateInertia(J,this.mass,b);this.invInertia.set(0<b.x&&!d?1/b.x:0,0<b.y&&!d?1/b.y:0,0<b.z&&!d?1/b.z:0);this.updateInertiaWorld(!0)};d.prototype.getVelocityAtWorldPoint=function(b,d){var e=
new f;b.vsub(this.position,e);this.angularVelocity.cross(e,d);this.velocity.vadd(d,d);return d}},{"../collision/AABB":3,"../material/Material":25,"../math/Mat3":27,"../math/Quaternion":28,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Shape":43,"../utils/EventTarget":49}],32:[function(b,e){function d(b){this.chassisBody=b.chassisBody;this.wheelInfos=[];this.sliding=!1;this.world=null;this.indexRightAxis="undefined"!==typeof b.indexRightAxis?b.indexRightAxis:1;this.indexForwardAxis="undefined"!==
typeof b.indexForwardAxis?b.indexForwardAxis:0;this.indexUpAxis="undefined"!==typeof b.indexUpAxis?b.indexUpAxis:2}function j(b,d,e){var g=I,f=y,m=C,j=J;d.vsub(b.position,g);g.cross(e,f);b.invInertiaWorld.vmult(f,j);j.cross(g,m);return b.invMass+e.dot(m)}b("./Body");var f=b("../math/Vec3"),p=b("../math/Quaternion");b("../collision/RaycastResult");var l=b("../collision/Ray"),g=b("../objects/WheelInfo");e.exports=d;new f;new f;new f;var m=new f,n=new f,r=new f;new l;d.prototype.addWheel=function(b){b=
b||{};b=new g(b);var d=this.wheelInfos.length;this.wheelInfos.push(b);return d};d.prototype.setSteeringValue=function(b,d){this.wheelInfos[d].steering=b};new f;d.prototype.applyEngineForce=function(b,d){this.wheelInfos[d].engineForce=b};d.prototype.setBrake=function(b,d){this.wheelInfos[d].brake=b};d.prototype.addToWorld=function(b){b.add(this.chassisBody);var d=this;this.preStepCallback=function(){d.updateVehicle(b.dt)};b.addEventListener("preStep",this.preStepCallback);this.world=b};d.prototype.getVehicleAxisWorld=
function(b,d){d.set(0===b?1:0,1===b?1:0,2===b?1:0);this.chassisBody.vectorToWorldFrame(d,d)};d.prototype.updateVehicle=function(b){for(var d=this.wheelInfos,e=d.length,g=this.chassisBody,m=0;m<e;m++)this.updateWheelTransform(m);this.currentVehicleSpeedKmHour=3.6*g.velocity.norm();m=new f;this.getVehicleAxisWorld(this.indexForwardAxis,m);0>m.dot(g.velocity)&&(this.currentVehicleSpeedKmHour*=-1);for(m=0;m<e;m++)this.castRay(d[m]);this.updateSuspension(b);for(var j=new f,n=new f,m=0;m<e;m++){var l=d[m],
r=l.suspensionForce;r>l.maxSuspensionForce&&(r=l.maxSuspensionForce);l.raycastResult.hitNormalWorld.scale(r*b,j);l.raycastResult.hitPointWorld.vsub(g.position,n);g.applyImpulse(j,l.raycastResult.hitPointWorld)}this.updateFriction(b);j=new f;n=new f;r=new f;for(m=0;m<e;m++){l=d[m];g.getVelocityAtWorldPoint(l.chassisConnectionPointWorld,r);var s=1;switch(this.indexUpAxis){case 1:s=-1}if(l.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,n);var p=n.dot(l.raycastResult.hitNormalWorld);l.raycastResult.hitNormalWorld.scale(p,
j);n.vsub(j,n);p=n.dot(r);l.deltaRotation=s*p*b/l.radius}if((l.sliding||!l.isInContact)&&0!==l.engineForce&&l.useCustomSlidingRotationalSpeed)l.deltaRotation=(0<l.engineForce?1:-1)*l.customSlidingRotationalSpeed*b;Math.abs(l.brake)>Math.abs(l.engineForce)&&(l.deltaRotation=0);l.rotation+=l.deltaRotation;l.deltaRotation*=0.99}};d.prototype.updateSuspension=function(){for(var b=this.chassisBody.mass,d=this.wheelInfos,e=d.length,g=0;g<e;g++){var f=d[g];if(f.isInContact){var m;m=f.suspensionStiffness*
(f.suspensionRestLength-f.suspensionLength)*f.clippedInvContactDotSuspension;var j=f.suspensionRelativeVelocity;m-=(0>j?f.dampingCompression:f.dampingRelaxation)*j;f.suspensionForce=m*b;0>f.suspensionForce&&(f.suspensionForce=0)}else f.suspensionForce=0}};d.prototype.removeFromWorld=function(b){b.remove(this.chassisBody);b.removeEventListener("preStep",this.preStepCallback);this.world=null};var s=new f,t=new f;d.prototype.castRay=function(b){this.updateWheelTransformWorld(b);var d=this.chassisBody,
e=-1;b.directionWorld.scale(b.suspensionRestLength+b.radius,s);var g=b.chassisConnectionPointWorld;g.vadd(s,t);var m=b.raycastResult;m.reset();var j=d.collisionResponse;d.collisionResponse=!1;this.world.rayTest(g,t,m);d.collisionResponse=j;g=m.body;b.raycastResult.groundObject=0;g?(e=m.distance,b.raycastResult.hitNormalWorld=m.hitNormalWorld,b.isInContact=!0,b.suspensionLength=m.distance-b.radius,m=b.suspensionRestLength-b.maxSuspensionTravel,g=b.suspensionRestLength+b.maxSuspensionTravel,b.suspensionLength<
m&&(b.suspensionLength=m),b.suspensionLength>g&&(b.suspensionLength=g,b.raycastResult.reset()),m=b.raycastResult.hitNormalWorld.dot(b.directionWorld),g=new f,d.getVelocityAtWorldPoint(b.raycastResult.hitPointWorld,g),d=b.raycastResult.hitNormalWorld.dot(g),-0.1<=m?(b.suspensionRelativeVelocity=0,b.clippedInvContactDotSuspension=10):(m=-1/m,b.suspensionRelativeVelocity=d*m,b.clippedInvContactDotSuspension=m)):(b.suspensionLength=b.suspensionRestLength+0*b.maxSuspensionTravel,b.suspensionRelativeVelocity=
0,b.directionWorld.scale(-1,b.raycastResult.hitNormalWorld),b.clippedInvContactDotSuspension=1);return e};d.prototype.updateWheelTransformWorld=function(b){b.isInContact=!1;var d=this.chassisBody;d.pointToWorldFrame(b.chassisConnectionPointLocal,b.chassisConnectionPointWorld);d.vectorToWorldFrame(b.directionLocal,b.directionWorld);d.vectorToWorldFrame(b.axleLocal,b.axleWorld)};d.prototype.updateWheelTransform=function(b){b=this.wheelInfos[b];this.updateWheelTransformWorld(b);b.directionLocal.scale(-1,
m);n.copy(b.axleLocal);m.cross(n,r);r.normalize();n.normalize();var d=b.steering,e=new p;e.setFromAxisAngle(m,d);d=new p;d.setFromAxisAngle(n,b.rotation);var g=b.worldTransform.quaternion;this.chassisBody.quaternion.mult(e,g);g.mult(d,g);g.normalize();e=b.worldTransform.position;e.copy(b.directionWorld);e.scale(b.suspensionLength,e);e.vadd(b.chassisConnectionPointWorld,e)};var u=[new f(1,0,0),new f(0,1,0),new f(0,0,1)];d.prototype.getWheelTransformWorld=function(b){return this.wheelInfos[b].worldTransform};
var v=new f,z=[],x=[];d.prototype.updateFriction=function(b){for(var d=this.wheelInfos,e=d.length,g=this.chassisBody,m=0,n=0;n<e;n++){var l=d[n],r=l.raycastResult.body;r&&m++;l.sideImpulse=0;l.forwardImpulse=0;x[n]||(x[n]=new f);z[n]||(z[n]=new f)}for(n=0;n<e;n++)if(l=d[n],r=l.raycastResult.body){var s=z[n];this.getWheelTransformWorld(n).vectorToWorldFrame(u[this.indexRightAxis],s);var m=l.raycastResult.hitNormalWorld,p=s.dot(m);m.scale(p,v);s.vsub(v,s);s.normalize();m.cross(s,x[n]);x[n].normalize();
m=l;var p=g,t=l.raycastResult.hitPointWorld,y=l.raycastResult.hitPointWorld,C=void 0;if(1.1<s.norm2())r=0;else{var C=M,J=O,fa=N;p.getVelocityAtWorldPoint(t,C);r.getVelocityAtWorldPoint(y,J);C.vsub(J,fa);r=C=-0.2*s.dot(fa)*(1/(p.invMass+r.invMass))}m.sideImpulse=r;l.sideImpulse*=1}this.sliding=!1;for(n=0;n<e;n++){l=d[n];r=l.raycastResult.body;p=0;l.slipInfo=1;if(r){var m=l.brake?l.brake:0,C=g,t=r,y=l.raycastResult.hitPointWorld,s=x[n],p=m,J=0,J=y,fa=B,oa=A,E=D;C.getVelocityAtWorldPoint(J,fa);t.getVelocityAtWorldPoint(J,
oa);fa.vsub(oa,E);J=s.dot(E);C=j(C,y,s);t=j(t,y,s);J=-J*(1/(C+t));p<J&&(J=p);J<-p&&(J=-p);p=J;p+=l.engineForce*b;m/=p;l.slipInfo*=m}l.forwardImpulse=0;l.skidInfo=1;r&&(l.skidInfo=1,r=l.suspensionForce*b*l.frictionSlip,m=r*r,l.forwardImpulse=p,p=0.5*l.forwardImpulse,t=1*l.sideImpulse,p=p*p+t*t,l.sliding=!1,p>m&&(this.sliding=!0,l.sliding=!0,m=r/Math.sqrt(p),l.skidInfo*=m))}if(this.sliding)for(n=0;n<e;n++)l=d[n],0!==l.sideImpulse&&1>l.skidInfo&&(l.forwardImpulse*=l.skidInfo,l.sideImpulse*=l.skidInfo);
for(n=0;n<e;n++)l=d[n],b=new f,b.copy(l.raycastResult.hitPointWorld),0!==l.forwardImpulse&&(r=new f,x[n].scale(l.forwardImpulse,r),g.applyImpulse(r,b)),0!==l.sideImpulse&&(r=l.raycastResult.body,m=new f,m.copy(l.raycastResult.hitPointWorld),p=new f,z[n].scale(l.sideImpulse,p),g.pointToLocalFrame(b,b),b["xyz"[this.indexUpAxis]]*=l.rollInfluence,g.pointToWorldFrame(b,b),g.applyImpulse(p,b),p.scale(-1,p),r.applyImpulse(p,m))};var B=new f,A=new f,D=new f,I=new f,y=new f,C=new f,J=new f,M=new f,O=new f,
N=new f},{"../collision/Ray":9,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Vec3":30,"../objects/WheelInfo":36,"./Body":31}],33:[function(b,e){function d(b){this.wheelBodies=[];this.coordinateSystem="undefined"===typeof b.coordinateSystem?new l(1,2,3):b.coordinateSystem.clone();this.chassisBody=b.chassisBody;this.chassisBody||(b=new p(new l(5,2,0.5)),this.chassisBody=new j(1,b));this.constraints=[];this.wheelAxes=[];this.wheelForces=[]}var j=b("./Body"),f=b("../shapes/Sphere"),
p=b("../shapes/Box"),l=b("../math/Vec3"),g=b("../constraints/HingeConstraint");e.exports=d;d.prototype.addWheel=function(b){b=b||{};var d=b.body;d||(d=new j(1,new f(1.2)));this.wheelBodies.push(d);this.wheelForces.push(0);new l;var e="undefined"!==typeof b.position?b.position.clone():new l,m=new l;this.chassisBody.pointToWorldFrame(e,m);d.position.set(m.x,m.y,m.z);b="undefined"!==typeof b.axis?b.axis.clone():new l(0,1,0);this.wheelAxes.push(b);d=new g(this.chassisBody,d,{pivotA:e,axisA:b,pivotB:l.ZERO,
axisB:b,collideConnected:!1});this.constraints.push(d);return this.wheelBodies.length-1};d.prototype.setSteeringValue=function(b,d){var e=this.wheelAxes[d],g=Math.cos(b),f=Math.sin(b),m=e.x,e=e.y;this.constraints[d].axisA.set(g*m-f*e,f*m+g*e,0)};d.prototype.setMotorSpeed=function(b,d){var e=this.constraints[d];e.enableMotor();e.motorTargetVelocity=b};d.prototype.disableMotor=function(b){this.constraints[b].disableMotor()};var m=new l;d.prototype.setWheelForce=function(b,d){this.wheelForces[d]=b};
d.prototype.applyWheelForce=function(b,d){var e=this.wheelBodies[d],g=e.torque;this.wheelAxes[d].scale(b,m);e.vectorToWorldFrame(m,m);g.vadd(m,g)};d.prototype.addToWorld=function(b){for(var d=this.constraints,e=this.wheelBodies.concat([this.chassisBody]),g=0;g<e.length;g++)b.add(e[g]);for(g=0;g<d.length;g++)b.addConstraint(d[g]);b.addEventListener("preStep",this._update.bind(this))};d.prototype._update=function(){for(var b=this.wheelForces,d=0;d<b.length;d++)this.applyWheelForce(b[d],d)};d.prototype.removeFromWorld=
function(b){for(var d=this.constraints,e=this.wheelBodies.concat([this.chassisBody]),g=0;g<e.length;g++)b.remove(e[g]);for(g=0;g<d.length;g++)b.removeConstraint(d[g])};var n=new l;d.prototype.getWheelSpeed=function(b){var d=this.wheelBodies[b].angularVelocity;this.chassisBody.vectorToWorldFrame(this.wheelAxes[b],n);return d.dot(n)}},{"../constraints/HingeConstraint":15,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Sphere":44,"./Body":31}],34:[function(b,e){function d(){this.particles=[];this.speedOfSound=
this.smoothingRadius=this.density=1;this.viscosity=0.01;this.eps=1E-6;this.pressures=[];this.densities=[];this.neighbors=[]}e.exports=d;b("../shapes/Shape");var j=b("../math/Vec3");b("../math/Quaternion");b("../shapes/Particle");b("../objects/Body");b("../material/Material");d.prototype.add=function(b){this.particles.push(b);this.neighbors.length<this.particles.length&&this.neighbors.push([])};d.prototype.remove=function(b){b=this.particles.indexOf(b);-1!==b&&(this.particles.splice(b,1),this.neighbors.length>
this.particles.length&&this.neighbors.pop())};var f=new j;d.prototype.getNeighbors=function(b,d){for(var e=this.particles.length,g=b.id,m=this.smoothingRadius*this.smoothingRadius,j=0;j!==e;j++){var n=this.particles[j];n.position.vsub(b.position,f);g!==n.id&&f.norm2()<m&&d.push(n)}};var p=new j,l=new j,g=new j,m=new j,n=new j,r=new j;d.prototype.update=function(){for(var b=this.particles.length,d=this.speedOfSound,e=this.eps,f=0;f!==b;f++){var j=this.particles[f],x=this.neighbors[f];x.length=0;this.getNeighbors(j,
x);x.push(this.particles[f]);for(var B=x.length,A=0,D=0;D!==B;D++){j.position.vsub(x[D].position,p);var I=p.norm(),I=this.w(I),A=A+x[D].mass*I}this.densities[f]=A;this.pressures[f]=d*d*(this.densities[f]-this.density)}for(f=0;f!==b;f++){d=this.particles[f];l.set(0,0,0);g.set(0,0,0);x=this.neighbors[f];B=x.length;for(D=0;D!==B;D++)A=x[D],d.position.vsub(A.position,n),I=n.norm(),j=-A.mass*(this.pressures[f]/(this.densities[f]*this.densities[f]+e)+this.pressures[D]/(this.densities[D]*this.densities[D]+
e)),this.gradw(n,m),m.mult(j,m),l.vadd(m,l),A.velocity.vsub(d.velocity,r),r.mult(1/(1E-4+this.densities[f]*this.densities[D])*this.viscosity*A.mass,r),j=this.nablaw(I),r.mult(j,r),g.vadd(r,g);g.mult(d.mass,g);l.mult(d.mass,l);d.force.vadd(g,d.force);d.force.vadd(l,d.force)}};d.prototype.w=function(b){var d=this.smoothingRadius;return 315/(64*Math.PI*Math.pow(d,9))*Math.pow(d*d-b*b,3)};d.prototype.gradw=function(b,d){var e=b.norm(),g=this.smoothingRadius;b.mult(945/(32*Math.PI*Math.pow(g,9))*Math.pow(g*
g-e*e,2),d)};d.prototype.nablaw=function(b){var d=this.smoothingRadius;return 945/(32*Math.PI*Math.pow(d,9))*(d*d-b*b)*(7*b*b-3*d*d)}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Particle":41,"../shapes/Shape":43}],35:[function(b,e){function d(b,d,e){e=e||{};this.restLength="number"===typeof e.restLength?e.restLength:1;this.stiffness=e.stiffness||100;this.damping=e.damping||1;this.bodyA=b;this.bodyB=d;this.localAnchorA=new j;this.localAnchorB=
new j;e.localAnchorA&&this.localAnchorA.copy(e.localAnchorA);e.localAnchorB&&this.localAnchorB.copy(e.localAnchorB);e.worldAnchorA&&this.setWorldAnchorA(e.worldAnchorA);e.worldAnchorB&&this.setWorldAnchorB(e.worldAnchorB)}var j=b("../math/Vec3");e.exports=d;d.prototype.setWorldAnchorA=function(b){this.bodyA.pointToLocalFrame(b,this.localAnchorA)};d.prototype.setWorldAnchorB=function(b){this.bodyB.pointToLocalFrame(b,this.localAnchorB)};d.prototype.getWorldAnchorA=function(b){this.bodyA.pointToWorldFrame(this.localAnchorA,
b)};d.prototype.getWorldAnchorB=function(b){this.bodyB.pointToWorldFrame(this.localAnchorB,b)};var f=new j,p=new j,l=new j,g=new j,m=new j,n=new j,r=new j,s=new j,t=new j,u=new j,v=new j;d.prototype.applyForce=function(){var b=this.stiffness,d=this.damping,e=this.restLength,j=this.bodyA,D=this.bodyB;this.getWorldAnchorA(m);this.getWorldAnchorB(n);m.vsub(j.position,r);n.vsub(D.position,s);n.vsub(m,f);var I=f.norm();p.copy(f);p.normalize();D.velocity.vsub(j.velocity,l);D.angularVelocity.cross(s,v);
l.vadd(v,l);j.angularVelocity.cross(r,v);l.vsub(v,l);p.mult(-b*(I-e)-d*l.dot(p),g);j.force.vsub(g,j.force);D.force.vadd(g,D.force);r.cross(g,t);s.cross(g,u);j.torque.vsub(t,j.torque);D.torque.vadd(u,D.torque)}},{"../math/Vec3":30}],36:[function(b,e){function d(b){b=l.defaults(b,{chassisConnectionPointLocal:new j,chassisConnectionPointWorld:new j,directionLocal:new j,directionWorld:new j,axleLocal:new j,axleWorld:new j,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,
dampingRelaxation:10,frictionSlip:1E4,steering:0,rotation:0,deltaRotation:0,rollInfluence:0.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-0.1});this.maxSuspensionTravel=b.maxSuspensionTravel;this.customSlidingRotationalSpeed=b.customSlidingRotationalSpeed;this.useCustomSlidingRotationalSpeed=b.useCustomSlidingRotationalSpeed;
this.sliding=!1;this.chassisConnectionPointLocal=b.chassisConnectionPointLocal.clone();this.chassisConnectionPointWorld=b.chassisConnectionPointWorld.clone();this.directionLocal=b.directionLocal.clone();this.directionWorld=b.directionWorld.clone();this.axleLocal=b.axleLocal.clone();this.axleWorld=b.axleWorld.clone();this.suspensionRestLength=b.suspensionRestLength;this.suspensionMaxLength=b.suspensionMaxLength;this.radius=b.radius;this.suspensionStiffness=b.suspensionStiffness;this.dampingCompression=
b.dampingCompression;this.dampingRelaxation=b.dampingRelaxation;this.frictionSlip=b.frictionSlip;this.deltaRotation=this.rotation=this.steering=0;this.rollInfluence=b.rollInfluence;this.maxSuspensionForce=b.maxSuspensionForce;this.brake=this.engineForce=0;this.isFrontWheel=b.isFrontWheel;this.clippedInvContactDotSuspension=1;this.forwardImpulse=this.sideImpulse=this.suspensionLength=this.skidInfo=this.suspensionForce=this.suspensionRelativeVelocity=0;this.raycastResult=new p;this.worldTransform=new f;
this.isInContact=!1}var j=b("../math/Vec3"),f=b("../math/Transform"),p=b("../collision/RaycastResult"),l=b("../utils/Utils");e.exports=d;var g=new j,m=new j,g=new j;d.prototype.updateWheel=function(b){var d=this.raycastResult;if(this.isInContact){var e=d.hitNormalWorld.dot(d.directionWorld);d.hitPointWorld.vsub(b.position,m);b.getVelocityAtWorldPoint(m,g);b=d.hitNormalWorld.dot(g);-0.1<=e?(this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=10):(e=-1/e,this.suspensionRelativeVelocity=
b*e,this.clippedInvContactDotSuspension=e)}else d.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,d.directionWorld.scale(-1,d.hitNormalWorld),this.clippedInvContactDotSuspension=1}},{"../collision/RaycastResult":10,"../math/Transform":29,"../math/Vec3":30,"../utils/Utils":53}],37:[function(b,e){function d(b){j.call(this);this.type=j.types.BOX;this.halfExtents=b;this.convexPolyhedronRepresentation=null;this.updateConvexPolyhedronRepresentation();this.updateBoundingSphereRadius()}
e.exports=d;var j=b("./Shape"),f=b("../math/Vec3"),p=b("./ConvexPolyhedron");d.prototype=new j;d.prototype.constructor=d;d.prototype.updateConvexPolyhedronRepresentation=function(){var b=this.halfExtents.x,d=this.halfExtents.y,e=this.halfExtents.z,b=[new f(-b,-d,-e),new f(b,-d,-e),new f(b,d,-e),new f(-b,d,-e),new f(-b,-d,e),new f(b,-d,e),new f(b,d,e),new f(-b,d,e)];new f(0,0,1);new f(0,1,0);new f(1,0,0);this.convexPolyhedronRepresentation=b=new p(b,[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,
3],[1,2,6,5]]);b.material=this.material};d.prototype.calculateLocalInertia=function(b,e){e=e||new f;d.calculateInertia(this.halfExtents,b,e);return e};d.calculateInertia=function(b,d,e){e.x=1/12*d*(4*b.y*b.y+4*b.z*b.z);e.y=1/12*d*(4*b.x*b.x+4*b.z*b.z);e.z=1/12*d*(4*b.y*b.y+4*b.x*b.x)};d.prototype.getSideNormals=function(b,d){var e=this.halfExtents;b[0].set(e.x,0,0);b[1].set(0,e.y,0);b[2].set(0,0,e.z);b[3].set(-e.x,0,0);b[4].set(0,-e.y,0);b[5].set(0,0,-e.z);if(void 0!==d)for(e=0;e!==b.length;e++)d.vmult(b[e],
b[e]);return b};d.prototype.volume=function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.halfExtents.norm()};var l=new f;new f;d.prototype.forEachWorldCorner=function(b,d,e){for(var g=this.halfExtents,g=[[g.x,g.y,g.z],[-g.x,g.y,g.z],[-g.x,-g.y,g.z],[-g.x,-g.y,-g.z],[g.x,-g.y,-g.z],[g.x,g.y,-g.z],[-g.x,g.y,-g.z],[g.x,-g.y,g.z]],f=0;f<g.length;f++)l.set(g[f][0],g[f][1],g[f][2]),d.vmult(l,l),b.vadd(l,
l),e(l.x,l.y,l.z)};var g=[new f,new f,new f,new f,new f,new f,new f,new f];d.prototype.calculateWorldAABB=function(b,d,e,f){var j=this.halfExtents;g[0].set(j.x,j.y,j.z);g[1].set(-j.x,j.y,j.z);g[2].set(-j.x,-j.y,j.z);g[3].set(-j.x,-j.y,-j.z);g[4].set(j.x,-j.y,-j.z);g[5].set(j.x,j.y,-j.z);g[6].set(-j.x,j.y,-j.z);g[7].set(j.x,-j.y,j.z);var l=g[0];d.vmult(l,l);b.vadd(l,l);f.copy(l);e.copy(l);for(j=1;8>j;j++){l=g[j];d.vmult(l,l);b.vadd(l,l);var p=l.x,z=l.y,l=l.z;p>f.x&&(f.x=p);z>f.y&&(f.y=z);l>f.z&&(f.z=
l);p<e.x&&(e.x=p);z<e.y&&(e.y=z);l<e.z&&(e.z=l)}}},{"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],38:[function(b,e){function d(b,d,e){j.call(this);this.type=j.types.CONVEXPOLYHEDRON;this.vertices=b||[];this.worldVertices=[];this.worldVerticesNeedsUpdate=!0;this.faces=d||[];this.faceNormals=[];this.computeNormals();this.worldFaceNormalsNeedsUpdate=!0;this.worldFaceNormals=[];this.uniqueEdges=[];this.uniqueAxes=e?e.slice():null;this.computeEdges();this.updateBoundingSphereRadius()}e.exports=
d;var j=b("./Shape"),f=b("../math/Vec3");b("../math/Quaternion");var p=b("../math/Transform");d.prototype=new j;d.prototype.constructor=d;var l=new f;d.prototype.computeEdges=function(){for(var b=this.faces,d=this.vertices,e=this.uniqueEdges,g=e.length=0;g!==b.length;g++)for(var f=b[g],j=f.length,m=0;m!==j;m++){d[f[m]].vsub(d[f[(m+1)%j]],l);l.normalize();for(var n=!1,r=0;r!==e.length;r++)if(e[r].almostEquals(l)||e[r].almostEquals(l)){n=!0;break}n||e.push(l.clone())}};d.prototype.computeNormals=function(){this.faceNormals.length=
this.faces.length;for(var b=0;b<this.faces.length;b++){for(var d=0;d<this.faces[b].length;d++)if(!this.vertices[this.faces[b][d]])throw Error("Vertex "+this.faces[b][d]+" not found!");d=this.faceNormals[b]||new f;this.getFaceNormal(b,d);d.negate(d);this.faceNormals[b]=d;if(0>d.dot(this.vertices[this.faces[b][0]])){console.error(".faceNormals["+b+"] = Vec3("+d.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");
for(d=0;d<this.faces[b].length;d++)console.warn(".vertices["+this.faces[b][d]+"] = Vec3("+this.vertices[this.faces[b][d]].toString()+")")}}};var g=new f,m=new f;d.computeNormal=function(b,d,e,f){d.vsub(b,m);e.vsub(d,g);g.cross(m,f);f.isZero()||f.normalize()};d.prototype.getFaceNormal=function(b,e){var g=this.faces[b];return d.computeNormal(this.vertices[g[0]],this.vertices[g[1]],this.vertices[g[2]],e)};var n=new f;d.prototype.clipAgainstHull=function(b,d,e,g,j,m,l,r,s){for(var p=-1,t=-Number.MAX_VALUE,
u=0;u<e.faces.length;u++){n.copy(e.faceNormals[u]);j.vmult(n,n);var v=n.dot(m);v>t&&(t=v,p=u)}for(var t=[],u=e.faces[p],v=u.length,y=0;y<v;y++){var z=e.vertices[u[y]],x=new f;x.copy(z);j.vmult(x,x);g.vadd(x,x);t.push(x)}0<=p&&this.clipFaceAgainstHull(m,b,d,t,l,r,s)};var r=new f,s=new f,t=new f,u=new f,v=new f,z=new f;d.prototype.findSeparatingAxis=function(b,d,e,g,f,j,m,n){var l=Number.MAX_VALUE,p=0;if(this.uniqueAxes)for(x=0;x!==this.uniqueAxes.length;x++){e.vmult(this.uniqueAxes[x],r);C=this.testSepAxis(r,
b,d,e,g,f);if(!1===C)return!1;C<l&&(l=C,j.copy(r))}else for(var y=m?m.length:this.faces.length,x=0;x<y;x++){C=m?m[x]:x;r.copy(this.faceNormals[C]);e.vmult(r,r);var C=this.testSepAxis(r,b,d,e,g,f);if(!1===C)return!1;C<l&&(l=C,j.copy(r))}if(b.uniqueAxes)for(x=0;x!==b.uniqueAxes.length;x++){f.vmult(b.uniqueAxes[x],s);p++;C=this.testSepAxis(s,b,d,e,g,f);if(!1===C)return!1;C<l&&(l=C,j.copy(s))}else{m=n?n.length:b.faces.length;for(x=0;x<m;x++){C=n?n[x]:x;s.copy(b.faceNormals[C]);f.vmult(s,s);p++;C=this.testSepAxis(s,
b,d,e,g,f);if(!1===C)return!1;C<l&&(l=C,j.copy(s))}}for(n=0;n!==this.uniqueEdges.length;n++){e.vmult(this.uniqueEdges[n],u);for(p=0;p!==b.uniqueEdges.length;p++)if(f.vmult(b.uniqueEdges[p],v),u.cross(v,z),!z.almostZero()){z.normalize();x=this.testSepAxis(z,b,d,e,g,f);if(!1===x)return!1;x<l&&(l=x,j.copy(z))}}g.vsub(d,t);0<t.dot(j)&&j.negate(j);return!0};var x=[],B=[];d.prototype.testSepAxis=function(b,e,g,f,j,m){d.project(this,b,g,f,x);d.project(e,b,j,m,B);g=x[0];b=x[1];e=B[0];f=B[1];if(g<f||e<b)return!1;
g-=f;b=e-b;return g<b?g:b};var A=new f,D=new f;d.prototype.calculateLocalInertia=function(b,d){this.computeLocalAABB(A,D);var e=D.x-A.x,g=D.y-A.y,f=D.z-A.z;d.x=1/12*b*(4*g*g+4*f*f);d.y=1/12*b*(4*e*e+4*f*f);d.z=1/12*b*(4*g*g+4*e*e)};d.prototype.getPlaneConstantOfFace=function(b){return-this.faceNormals[b].dot(this.vertices[this.faces[b][0]])};var I=new f,y=new f,C=new f,J=new f,M=new f,O=new f,N=new f,K=new f;d.prototype.clipFaceAgainstHull=function(b,d,e,g,f,j,m){for(var n=[],l=-1,r=Number.MAX_VALUE,
s=0;s<this.faces.length;s++){I.copy(this.faceNormals[s]);e.vmult(I,I);var p=I.dot(b);p<r&&(r=p,l=s)}if(!(0>l)){b=this.faces[l];b.connectedFaces=[];for(r=0;r<this.faces.length;r++)for(s=0;s<this.faces[r].length;s++)-1!==b.indexOf(this.faces[r][s])&&(r!==l&&-1===b.connectedFaces.indexOf(r))&&b.connectedFaces.push(r);r=b.length;for(s=0;s<r;s++){p=this.vertices[b[s]];p.vsub(this.vertices[b[(s+1)%r]],y);C.copy(y);e.vmult(C,C);d.vadd(C,C);J.copy(this.faceNormals[l]);e.vmult(J,J);d.vadd(J,J);C.cross(J,M);
M.negate(M);O.copy(p);e.vmult(O,O);d.vadd(O,O);O.dot(M);p=b.connectedFaces[s];N.copy(this.faceNormals[p]);p=this.getPlaneConstantOfFace(p);K.copy(N);e.vmult(K,K);p-=K.dot(d);for(this.clipFaceAgainstPlane(g,n,K,p);g.length;)g.shift();for(;n.length;)g.push(n.shift())}N.copy(this.faceNormals[l]);p=this.getPlaneConstantOfFace(l);K.copy(N);e.vmult(K,K);p-=K.dot(d);for(r=0;r<g.length;r++)d=K.dot(g[r])+p,d<=f&&(console.log("clamped: depth="+d+" to minDist="+(f+"")),d=f),d<=j&&(e=g[r],0>=d&&m.push({point:e,
normal:K,depth:d}))}};d.prototype.clipFaceAgainstPlane=function(b,d,e,g){var j,m,n=b.length;if(2>n)return d;var l=b[b.length-1],r=b[0];j=e.dot(l)+g;for(var s=0;s<n;s++){r=b[s];m=e.dot(r)+g;if(0>j){if(0>m){var p=new f;p.copy(r)}else p=new f,l.lerp(r,j/(j-m),p);d.push(p)}else 0>m&&(p=new f,l.lerp(r,j/(j-m),p),d.push(p),d.push(r));l=r;j=m}return d};d.prototype.computeWorldVertices=function(b,d){for(var e=this.vertices.length;this.worldVertices.length<e;)this.worldVertices.push(new f);for(var g=this.vertices,
j=this.worldVertices,m=0;m!==e;m++)d.vmult(g[m],j[m]),b.vadd(j[m],j[m]);this.worldVerticesNeedsUpdate=!1};new f;d.prototype.computeLocalAABB=function(b,d){var e=this.vertices.length,g=this.vertices;b.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);d.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var f=0;f<e;f++){var j=g[f];j.x<b.x?b.x=j.x:j.x>d.x&&(d.x=j.x);j.y<b.y?b.y=j.y:j.y>d.y&&(d.y=j.y);j.z<b.z?b.z=j.z:j.z>d.z&&(d.z=j.z)}};d.prototype.computeWorldFaceNormals=function(b){for(var d=
this.faceNormals.length;this.worldFaceNormals.length<d;)this.worldFaceNormals.push(new f);for(var e=this.faceNormals,g=this.worldFaceNormals,j=0;j!==d;j++)b.vmult(e[j],g[j]);this.worldFaceNormalsNeedsUpdate=!1};d.prototype.updateBoundingSphereRadius=function(){for(var b=0,d=this.vertices,e=0,g=d.length;e!==g;e++){var f=d[e].norm2();f>b&&(b=f)}this.boundingSphereRadius=Math.sqrt(b)};var W=new f;d.prototype.calculateWorldAABB=function(b,d,e,g){for(var f=this.vertices.length,j=this.vertices,m,n,l,r,
s,p,t=0;t<f;t++){W.copy(j[t]);d.vmult(W,W);b.vadd(W,W);var u=W;if(u.x<m||void 0===m)m=u.x;else if(u.x>r||void 0===r)r=u.x;if(u.y<n||void 0===n)n=u.y;else if(u.y>s||void 0===s)s=u.y;if(u.z<l||void 0===l)l=u.z;else if(u.z>p||void 0===p)p=u.z}e.set(m,n,l);g.set(r,s,p)};d.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3};d.prototype.getAveragePointLocal=function(b){b=b||new f;for(var d=this.vertices.length,e=this.vertices,g=0;g<d;g++)b.vadd(e[g],b);b.mult(1/d,b);return b};d.prototype.transformAllPoints=
function(b,d){var e=this.vertices.length,g=this.vertices;if(d){for(var f=0;f<e;f++){var j=g[f];d.vmult(j,j)}for(f=0;f<this.faceNormals.length;f++)j=this.faceNormals[f],d.vmult(j,j)}if(b)for(f=0;f<e;f++)j=g[f],j.vadd(b,j)};var ea=new f,F=new f,H=new f;d.prototype.pointIsInside=function(b){var d=this.vertices.length,e=this.vertices,g=this.faces,f=this.faceNormals,j=this.faces.length;this.getAveragePointLocal(ea);for(var m=0;m<j;m++){var d=f[m],n=e[g[m][0]],l=F;b.vsub(n,l);var l=d.dot(l),r=H;ea.vsub(n,
r);d=d.dot(r);if(0>l&&0<d||0<l&&0>d)return!1}return-1};new f;var ia=new f,R=new f;d.project=function(b,d,e,g,f){var j=b.vertices.length,m=0,n=0;b=b.vertices;R.setZero();p.vectorToLocalFrame(e,g,d,ia);p.pointToLocalFrame(e,g,R,R);d=R.dot(ia);n=m=b[0].dot(ia);for(e=1;e<j;e++)g=b[e].dot(ia),g>m&&(m=g),g<n&&(n=g);n-=d;m-=d;n>m&&(j=n,n=m,m=j);f[0]=m;f[1]=n}},{"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"./Shape":43}],39:[function(b,e){function d(b,d,e,n){var r=[],s=[],t=[],u=[],v=
[],z=Math.cos,x=Math.sin;r.push(new f(d*z(0),d*x(0),0.5*-e));u.push(0);r.push(new f(b*z(0),b*x(0),0.5*e));v.push(1);for(var B=0;B<n;B++){var A=2*Math.PI/n*(B+1),D=2*Math.PI/n*(B+0.5);B<n-1?(r.push(new f(d*z(A),d*x(A),0.5*-e)),u.push(2*B+2),r.push(new f(b*z(A),b*x(A),0.5*e)),v.push(2*B+3),t.push([2*B+2,2*B+3,2*B+1,2*B])):t.push([0,1,2*B+1,2*B]);(1===n%2||B<n/2)&&s.push(new f(z(D),x(D),0))}t.push(v);s.push(new f(0,0,1));b=[];for(B=0;B<u.length;B++)b.push(u[u.length-B-1]);t.push(b);this.type=j.types.CONVEXPOLYHEDRON;
p.call(this,r,t,s)}e.exports=d;var j=b("./Shape"),f=b("../math/Vec3");b("../math/Quaternion");var p=b("./ConvexPolyhedron");d.prototype=new p},{"../math/Quaternion":28,"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],40:[function(b,e){function d(b,d){d=l.defaults(d,{maxValue:null,minValue:null,elementSize:1});this.data=b;this.maxValue=d.maxValue;this.minValue=d.minValue;this.elementSize=d.elementSize;null===d.minValue&&this.updateMinValue();null===d.maxValue&&this.updateMaxValue();this.cacheEnabled=
!0;j.call(this);this.pillarConvex=new f;this.pillarOffset=new p;this.type=j.types.HEIGHTFIELD;this.updateBoundingSphereRadius();this._cachedPillars={}}var j=b("./Shape"),f=b("./ConvexPolyhedron"),p=b("../math/Vec3"),l=b("../utils/Utils");e.exports=d;d.prototype=new j;d.prototype.update=function(){this._cachedPillars={}};d.prototype.updateMinValue=function(){for(var b=this.data,d=b[0][0],e=0;e!==b.length;e++)for(var f=0;f!==b[e].length;f++){var j=b[e][f];j<d&&(d=j)}this.minValue=d};d.prototype.updateMaxValue=
function(){for(var b=this.data,d=b[0][0],e=0;e!==b.length;e++)for(var f=0;f!==b[e].length;f++){var j=b[e][f];j>d&&(d=j)}this.maxValue=d};d.prototype.setHeightValueAtIndex=function(b,d,e){this.data[b][d]=e;this.clearCachedConvexTrianglePillar(b,d,!1);0<b&&(this.clearCachedConvexTrianglePillar(b-1,d,!0),this.clearCachedConvexTrianglePillar(b-1,d,!1));0<d&&(this.clearCachedConvexTrianglePillar(b,d-1,!0),this.clearCachedConvexTrianglePillar(b,d-1,!1));0<d&&0<b&&this.clearCachedConvexTrianglePillar(b-
1,d-1,!0)};d.prototype.getRectMinMax=function(b,d,e,f,j){j=j||[];for(var l=this.data,p=this.minValue;b<=e;b++)for(var v=d;v<=f;v++){var z=l[b][v];z>p&&(p=z)}j[0]=this.minValue;j[1]=p};d.prototype.getIndexOfPosition=function(b,d,e,f){var j=this.elementSize,l=this.data;b=Math.floor(b/j);d=Math.floor(d/j);e[0]=b;e[1]=d;f&&(0>b&&(b=0),0>d&&(d=0),b>=l.length-1&&(b=l.length-1),d>=l[0].length-1&&(d=l[0].length-1));return 0>b||0>d||b>=l.length-1||d>=l[0].length-1?!1:!0};d.prototype.getHeightAt=function(b,
d,e){var f=[];this.getIndexOfPosition(b,d,f,e);b=[];this.getRectMinMax(f[0],f[1]+1,f[0],f[1]+1,b);return(b[0]+b[1])/2};d.prototype.getCacheConvexTrianglePillarKey=function(b,d,e){return b+"_"+d+"_"+(e?1:0)};d.prototype.getCachedConvexTrianglePillar=function(b,d,e){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(b,d,e)]};d.prototype.setCachedConvexTrianglePillar=function(b,d,e,f,j){this._cachedPillars[this.getCacheConvexTrianglePillarKey(b,d,e)]={convex:f,offset:j}};d.prototype.clearCachedConvexTrianglePillar=
function(b,d,e){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(b,d,e)]};d.prototype.getConvexTrianglePillar=function(b,d,e){var j=this.pillarConvex,l=this.pillarOffset;if(this.cacheEnabled){var t=this.getCachedConvexTrianglePillar(b,d,e);if(t){this.pillarConvex=t.convex;this.pillarOffset=t.offset;return}j=new f;l=new p;this.pillarConvex=j;this.pillarOffset=l}var t=this.data,u=this.elementSize,v=j.faces;j.vertices.length=6;for(var z=0;6>z;z++)j.vertices[z]||(j.vertices[z]=new p);v.length=
5;for(z=0;5>z;z++)v[z]||(v[z]=[]);var z=j.vertices,x=(Math.min(t[b][d],t[b+1][d],t[b][d+1],t[b+1][d+1])-this.minValue)/2+this.minValue;e?(l.set((b+0.75)*u,(d+0.75)*u,x),z[0].set(0.25*u,0.25*u,t[b+1][d+1]-x),z[1].set(-0.75*u,0.25*u,t[b][d+1]-x),z[2].set(0.25*u,-0.75*u,t[b+1][d]-x),z[3].set(0.25*u,0.25*u,-x-1),z[4].set(-0.75*u,0.25*u,-x-1),z[5].set(0.25*u,-0.75*u,-x-1),v[0][0]=0,v[0][1]=1,v[0][2]=2,v[1][0]=5,v[1][1]=4,v[1][2]=3,v[2][0]=2,v[2][1]=5,v[2][2]=3,v[2][3]=0,v[3][0]=3,v[3][1]=4,v[3][2]=1,v[3][3]=
0,v[4][0]=1,v[4][1]=4,v[4][2]=5,v[4][3]=2):(l.set((b+0.25)*u,(d+0.25)*u,x),z[0].set(-0.25*u,-0.25*u,t[b][d]-x),z[1].set(0.75*u,-0.25*u,t[b+1][d]-x),z[2].set(-0.25*u,0.75*u,t[b][d+1]-x),z[3].set(-0.25*u,-0.25*u,-x-1),z[4].set(0.75*u,-0.25*u,-x-1),z[5].set(-0.25*u,0.75*u,-x-1),v[0][0]=0,v[0][1]=1,v[0][2]=2,v[1][0]=5,v[1][1]=4,v[1][2]=3,v[2][0]=0,v[2][1]=2,v[2][2]=5,v[2][3]=3,v[3][0]=1,v[3][1]=0,v[3][2]=3,v[3][3]=4,v[4][0]=4,v[4][1]=5,v[4][2]=2,v[4][3]=1);j.computeNormals();j.computeEdges();j.updateBoundingSphereRadius();
this.setCachedConvexTrianglePillar(b,d,e,j,l)};d.prototype.calculateLocalInertia=function(b,d){d=d||new p;d.set(0,0,0);return d};d.prototype.volume=function(){return Number.MAX_VALUE};d.prototype.calculateWorldAABB=function(b,d,e,f){e.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);f.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)};d.prototype.updateBoundingSphereRadius=function(){var b=this.data,d=this.elementSize;this.boundingSphereRadius=(new p(b.length*d,b[0].length*d,Math.max(Math.abs(this.maxValue),
Math.abs(this.minValue)))).norm()}},{"../math/Vec3":30,"../utils/Utils":53,"./ConvexPolyhedron":38,"./Shape":43}],41:[function(b,e){function d(){j.call(this);this.type=j.types.PARTICLE}e.exports=d;var j=b("./Shape"),f=b("../math/Vec3");d.prototype=new j;d.prototype.constructor=d;d.prototype.calculateLocalInertia=function(b,d){d=d||new f;d.set(0,0,0);return d};d.prototype.volume=function(){return 0};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=0};d.prototype.calculateWorldAABB=
function(b,d,e,f){e.copy(b);f.copy(b)}},{"../math/Vec3":30,"./Shape":43}],42:[function(b,e){function d(){j.call(this);this.type=j.types.PLANE;this.worldNormal=new f;this.worldNormalNeedsUpdate=!0;this.boundingSphereRadius=Number.MAX_VALUE}e.exports=d;var j=b("./Shape"),f=b("../math/Vec3");d.prototype=new j;d.prototype.constructor=d;d.prototype.computeWorldNormal=function(b){var d=this.worldNormal;d.set(0,0,1);b.vmult(d,d);this.worldNormalNeedsUpdate=!1};d.prototype.calculateLocalInertia=function(b,
d){return d=d||new f};d.prototype.volume=function(){return Number.MAX_VALUE};var p=new f;d.prototype.calculateWorldAABB=function(b,d,e,f){p.set(0,0,1);d.vmult(p,p);d=Number.MAX_VALUE;e.set(-d,-d,-d);f.set(d,d,d);1===p.x&&(f.x=b.x);1===p.y&&(f.y=b.y);1===p.z&&(f.z=b.z);-1===p.x&&(e.x=b.x);-1===p.y&&(e.y=b.y);-1===p.z&&(e.z=b.z)};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=Number.MAX_VALUE}},{"../math/Vec3":30,"./Shape":43}],43:[function(b,e){function d(){this.id=d.idCounter++;
this.boundingSphereRadius=this.type=0;this.collisionResponse=!0;this.material=null}e.exports=d;d=b("./Shape");b("../math/Vec3");b("../math/Quaternion");b("../material/Material");d.prototype.constructor=d;d.prototype.updateBoundingSphereRadius=function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type;};d.prototype.volume=function(){throw"volume() not implemented for shape type "+this.type;};d.prototype.calculateLocalInertia=function(){throw"calculateLocalInertia() not implemented for shape type "+
this.type;};d.idCounter=0;d.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"./Shape":43}],44:[function(b,e){function d(b){j.call(this);this.radius=void 0!==b?Number(b):1;this.type=j.types.SPHERE;if(0>this.radius)throw Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}e.exports=d;var j=b("./Shape"),f=b("../math/Vec3");d.prototype=new j;
d.prototype.constructor=d;d.prototype.calculateLocalInertia=function(b,d){d=d||new f;var e=2*b*this.radius*this.radius/5;d.x=e;d.y=e;d.z=e;return d};d.prototype.volume=function(){return 4*Math.PI*this.radius/3};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.radius};d.prototype.calculateWorldAABB=function(b,d,e,f){d=this.radius;for(var j=["x","y","z"],r=0;r<j.length;r++){var s=j[r];e[s]=b[s]-d;f[s]=b[s]+d}}},{"../math/Vec3":30,"./Shape":43}],45:[function(b,e){function d(b,
d){j.call(this);this.type=j.types.TRIMESH;this.vertices=new Float32Array(b);this.indices=new Int16Array(d);this.normals=new Float32Array(d.length);this.aabb=new l;this.edges=null;this.scale=new f(1,1,1);this.tree=new g;this.updateEdges();this.updateNormals();this.updateAABB();this.updateBoundingSphereRadius();this.updateTree()}e.exports=d;var j=b("./Shape"),f=b("../math/Vec3");b("../math/Quaternion");var p=b("../math/Transform"),l=b("../collision/AABB"),g=b("../utils/Octree");d.prototype=new j;d.prototype.constructor=
d;var m=new f;d.prototype.updateTree=function(){var b=this.tree;b.reset();b.aabb.copy(this.aabb);var d=this.scale;b.aabb.lowerBound.x*=1/d.x;b.aabb.lowerBound.y*=1/d.y;b.aabb.lowerBound.z*=1/d.z;b.aabb.upperBound.x*=1/d.x;b.aabb.upperBound.y*=1/d.y;b.aabb.upperBound.z*=1/d.z;for(var d=new l,e=new f,g=new f,j=new f,m=[e,g,j],n=0;n<this.indices.length/3;n++){var r=3*n;this._getUnscaledVertex(this.indices[r],e);this._getUnscaledVertex(this.indices[r+1],g);this._getUnscaledVertex(this.indices[r+2],j);
d.setFromPoints(m);b.insert(d,n)}b.removeEmptyNodes()};var n=new l;d.prototype.getTrianglesInAABB=function(b,d){n.copy(b);var e=this.scale,g=e.x,f=e.y,e=e.z,j=n.lowerBound,m=n.upperBound;j.x/=g;j.y/=f;j.z/=e;m.x/=g;m.y/=f;m.z/=e;return this.tree.aabbQuery(n,d)};d.prototype.setScale=function(b){var d=b.x===b.y===b.z;this.scale.x===this.scale.y===this.scale.z&&d||this.updateNormals();this.scale.copy(b);this.updateAABB();this.updateBoundingSphereRadius()};d.prototype.updateNormals=function(){for(var b=
this.normals,e=0;e<this.indices.length/3;e++){var g=3*e,f=this.indices[g+1],j=this.indices[g+2];this.getVertex(this.indices[g],v);this.getVertex(f,z);this.getVertex(j,x);d.computeNormal(z,v,x,m);b[g]=m.x;b[g+1]=m.y;b[g+2]=m.z}};d.prototype.updateEdges=function(){for(var b={},d=function(){b[f<j?f+"_"+j:j+"_"+f]=!0},e=0;e<this.indices.length/3;e++){var g=3*e,f=this.indices[g],j=this.indices[g+1],g=this.indices[g+2];d(f,j);d(j,g);d(g,f)}d=Object.keys(b);this.edges=new Int16Array(2*d.length);for(e=0;e<
d.length;e++)g=d[e].split("_"),this.edges[2*e]=parseInt(g[0],10),this.edges[2*e+1]=parseInt(g[1],10)};d.prototype.getEdgeVertex=function(b,d,e){this.getVertex(this.edges[2*b+(d?1:0)],e)};var r=new f,s=new f;d.prototype.getEdgeVector=function(b,d){this.getEdgeVertex(b,0,r);this.getEdgeVertex(b,1,s);s.vsub(r,d)};var t=new f,u=new f;d.computeNormal=function(b,d,e,g){d.vsub(b,u);e.vsub(d,t);t.cross(u,g);g.isZero()||g.normalize()};var v=new f,z=new f,x=new f;d.prototype.getVertex=function(b,d){var e=this.scale;
this._getUnscaledVertex(b,d);d.x*=e.x;d.y*=e.y;d.z*=e.z;return d};d.prototype._getUnscaledVertex=function(b,d){var e=3*b,g=this.vertices;return d.set(g[e],g[e+1],g[e+2])};d.prototype.getWorldVertex=function(b,d,e,g){this.getVertex(b,g);p.pointToWorldFrame(d,e,g,g);return g};d.prototype.getTriangleVertices=function(b,d,e,g){b*=3;this.getVertex(this.indices[b],d);this.getVertex(this.indices[b+1],e);this.getVertex(this.indices[b+2],g)};d.prototype.getNormal=function(b,d){var e=3*b;return d.set(this.normals[e],
this.normals[e+1],this.normals[e+2])};var B=new l;d.prototype.calculateLocalInertia=function(b,d){this.computeLocalAABB(B);var e=B.upperBound.x-B.lowerBound.x,g=B.upperBound.y-B.lowerBound.y,f=B.upperBound.z-B.lowerBound.z;return d.set(1/12*b*(4*g*g+4*f*f),1/12*b*(4*e*e+4*f*f),1/12*b*(4*g*g+4*e*e))};var A=new f;d.prototype.computeLocalAABB=function(b){var d=b.lowerBound;b=b.upperBound;var e=this.vertices.length;this.getVertex(0,A);d.copy(A);b.copy(A);for(var g=0;g!==e;g++)this.getVertex(g,A),A.x<
d.x?d.x=A.x:A.x>b.x&&(b.x=A.x),A.y<d.y?d.y=A.y:A.y>b.y&&(b.y=A.y),A.z<d.z?d.z=A.z:A.z>b.z&&(b.z=A.z)};d.prototype.updateAABB=function(){this.computeLocalAABB(this.aabb)};d.prototype.updateBoundingSphereRadius=function(){for(var b=0,d=this.vertices,e=new f,g=0,d=d.length/3;g!==d;g++){this.getVertex(g,e);var j=e.norm2();j>b&&(b=j)}this.boundingSphereRadius=Math.sqrt(b)};new f;var D=new p,I=new l;d.prototype.calculateWorldAABB=function(b,d,e,g){D.position=b;D.quaternion=d;this.aabb.toWorldFrame(D,I);
e.copy(I.lowerBound);g.copy(I.upperBound)};d.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3};d.createTorus=function(b,e,g,f,j){b=b||1;e=e||0.5;g=g||8;f=f||6;j=j||2*Math.PI;for(var m=[],n=[],l=0;l<=g;l++)for(var r=0;r<=f;r++){var p=r/f*j,s=2*l/g*Math.PI,t=(b+e*Math.cos(s))*Math.cos(p),p=(b+e*Math.cos(s))*Math.sin(p),s=e*Math.sin(s);m.push(t,p,s)}for(l=1;l<=g;l++)for(r=1;r<=f;r++)b=(f+1)*(l-1)+r-1,e=(f+1)*(l-1)+r,j=(f+1)*l+r,n.push((f+1)*l+r-1,b,j),n.push(b,e,j);return new d(m,
n)}},{"../collision/AABB":3,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../utils/Octree":50,"./Shape":43}],46:[function(b,e){function d(){j.call(this);this.iterations=10;this.tolerance=1E-7}e.exports=d;b("../math/Vec3");b("../math/Quaternion");var j=b("./Solver");d.prototype=new j;var f=[],p=[],l=[];d.prototype.solve=function(b,d){var e=0,j=this.iterations,s=this.tolerance*this.tolerance,t=this.equations,u=t.length,v=d.bodies,z=v.length,x,B,A,D,I;if(0!==u)for(A=0;A!==z;A++)v[A].updateSolveMassProperties();
p.length=u;l.length=u;f.length=u;for(A=0;A!==u;A++){var y=t[A];f[A]=0;l[A]=y.computeB(b);p[A]=1/y.computeC()}if(0!==u){for(A=0;A!==z;A++)y=v[A],e=y.wlambda,y.vlambda.set(0,0,0),e&&e.set(0,0,0);for(e=0;e!==j;e++){for(var C=A=0;C!==u;C++)y=t[C],x=l[C],B=p[C],I=f[C],D=y.computeGWlambda(),x=B*(x-D-y.eps*I),I+x<y.minForce?x=y.minForce-I:I+x>y.maxForce&&(x=y.maxForce-I),f[C]+=x,A+=0<x?x:-x,y.addToWlambda(x);if(A*A<s)break}for(A=0;A!==z;A++)y=v[A],j=y.velocity,s=y.angularVelocity,j.vadd(y.vlambda,j),s&&
s.vadd(y.wlambda,s)}return e}},{"../math/Quaternion":28,"../math/Vec3":30,"./Solver":47}],47:[function(b,e){function d(){this.equations=[]}e.exports=d;d.prototype.solve=function(){return 0};d.prototype.addEquation=function(b){b.enabled&&this.equations.push(b)};d.prototype.removeEquation=function(b){var d=this.equations;b=d.indexOf(b);-1!==b&&d.splice(b,1)};d.prototype.removeAllEquations=function(){this.equations.length=0}},{}],48:[function(b,e){function d(b){l.call(this);this.iterations=10;this.tolerance=
1E-7;this.subsolver=b;this.nodes=[];for(this.nodePool=[];128>this.nodePool.length;)this.nodePool.push(this.createNode())}function j(b){for(var d=b.length,e=0;e!==d;e++){var g=b[e];if(!g.visited&&!(g.body.type&s))return g}return!1}function f(b,d,e){d.push(b.body);d=b.eqs.length;for(var g=0;g!==d;g++){var f=b.eqs[g];-1===e.indexOf(f)&&e.push(f)}}function p(b,d){return d.id-b.id}e.exports=d;b("../math/Vec3");b("../math/Quaternion");var l=b("./Solver"),g=b("../objects/Body");d.prototype=new l;var m=[],
n=[],r={bodies:[]},s=g.STATIC,t=[];d.prototype.createNode=function(){return{body:null,children:[],eqs:[],visited:!1}};d.prototype.solve=function(b,d){for(var e=this.nodePool,g=d.bodies,l=this.equations,s=l.length,D=g.length,I=this.subsolver;e.length<D;)e.push(this.createNode());m.length=D;for(var y=0;y<D;y++)m[y]=e[y];for(y=0;y!==D;y++)e=m[y],e.body=g[y],e.children.length=0,e.eqs.length=0,e.visited=!1;for(D=0;D!==s;D++){var e=l[D],y=g.indexOf(e.bi),C=g.indexOf(e.bj),y=m[y],C=m[C];y.children.push(C);
y.eqs.push(e);C.children.push(y);C.eqs.push(e)}g=0;l=n;I.tolerance=this.tolerance;for(I.iterations=this.iterations;y=j(m);){l.length=0;r.bodies.length=0;e=y;y=f;s=r.bodies;D=l;t.push(e);e.visited=!0;for(y(e,s,D);t.length;)for(e=t.pop();C=j(e.children);)C.visited=!0,y(C,s,D),t.push(C);s=l.length;l=l.sort(p);for(y=0;y!==s;y++)I.addEquation(l[y]);I.solve(b,r);I.removeAllEquations();g++}return g}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"./Solver":47}],49:[function(b,e){var d=
function(){};e.exports=d;d.prototype={constructor:d,addEventListener:function(b,d){void 0===this._listeners&&(this._listeners={});var e=this._listeners;void 0===e[b]&&(e[b]=[]);-1===e[b].indexOf(d)&&e[b].push(d);return this},hasEventListener:function(b,d){if(void 0===this._listeners)return!1;var e=this._listeners;return void 0!==e[b]&&-1!==e[b].indexOf(d)?!0:!1},removeEventListener:function(b,d){if(void 0===this._listeners)return this;var e=this._listeners;if(void 0===e[b])return this;var l=e[b].indexOf(d);
-1!==l&&e[b].splice(l,1);return this},dispatchEvent:function(b){if(void 0===this._listeners)return this;var d=this._listeners[b.type];if(void 0!==d){b.target=this;for(var e=0,l=d.length;e<l;e++)d[e].call(this,b)}return this}}},{}],50:[function(b,e){function d(b){b=b||{};this.root=b.root||null;this.aabb=b.aabb?b.aabb.clone():new f;this.data=[];this.children=[]}function j(b,e){e=e||{};e.root=null;e.aabb=b;d.call(this,e);this.maxDepth="undefined"!==typeof e.maxDepth?e.maxDepth:8}var f=b("../collision/AABB"),
p=b("../math/Vec3");e.exports=j;j.prototype=new d;d.prototype.reset=function(){this.children.length=this.data.length=0};d.prototype.insert=function(b,d,e){var g=this.data;e=e||0;if(!this.aabb.contains(b))return!1;var f=this.children;if(e<(this.maxDepth||this.root.maxDepth)){var j=!1;f.length||(this.subdivide(),j=!0);for(var l=0;8!==l;l++)if(f[l].insert(b,d,e+1))return!0;j&&(f.length=0)}g.push(d);return!0};var l=new p;d.prototype.subdivide=function(){var b=this.aabb,e=b.lowerBound,g=b.upperBound,b=
this.children;b.push(new d({aabb:new f({lowerBound:new p(0,0,0)})}),new d({aabb:new f({lowerBound:new p(1,0,0)})}),new d({aabb:new f({lowerBound:new p(1,1,0)})}),new d({aabb:new f({lowerBound:new p(1,1,1)})}),new d({aabb:new f({lowerBound:new p(0,1,1)})}),new d({aabb:new f({lowerBound:new p(0,0,1)})}),new d({aabb:new f({lowerBound:new p(1,0,1)})}),new d({aabb:new f({lowerBound:new p(0,1,0)})}));g.vsub(e,l);l.scale(0.5,l);for(var g=this.root||this,j=0;8!==j;j++){var t=b[j];t.root=g;var u=t.aabb.lowerBound;
u.x*=l.x;u.y*=l.y;u.z*=l.z;u.vadd(e,u);u.vadd(l,t.aabb.upperBound)}};d.prototype.aabbQuery=function(b,d){for(var e=[this];e.length;){var g=e.pop();g.aabb.overlaps(b)&&Array.prototype.push.apply(d,g.data);Array.prototype.push.apply(e,g.children)}return d};var g=new f;d.prototype.rayQuery=function(b,d,e){b.getAABB(g);g.toLocalFrame(d,g);this.aabbQuery(g,e);return e};d.prototype.removeEmptyNodes=function(){for(var b=[this];b.length;){for(var d=b.pop(),e=d.children.length-1;0<=e;e--)d.children[e].data.length||
d.children.splice(e,1);Array.prototype.push.apply(b,d.children)}}},{"../collision/AABB":3,"../math/Vec3":30}],51:[function(b,e){function d(){this.objects=[];this.type=Object}e.exports=d;d.prototype.release=function(){for(var b=arguments.length,d=0;d!==b;d++)this.objects.push(arguments[d])};d.prototype.get=function(){return 0===this.objects.length?this.constructObject():this.objects.pop()};d.prototype.constructObject=function(){throw Error("constructObject() not implemented in this Pool subclass yet!");
}},{}],52:[function(b,e){function d(){this.data={keys:[]}}e.exports=d;d.prototype.get=function(b,d){if(b>d){var e=d;d=b;b=e}return this.data[b+"-"+d]};d.prototype.set=function(b,d,e){if(b>d){var l=d;d=b;b=l}l=b+"-"+d;this.get(b,d)||this.data.keys.push(l);this.data[l]=e};d.prototype.reset=function(){for(var b=this.data,d=b.keys;0<d.length;){var e=d.pop();delete b[e]}}},{}],53:[function(b,e){function d(){}e.exports=d;d.defaults=function(b,d){b=b||{};for(var e in d)e in b||(b[e]=d[e]);return b}},{}],
54:[function(b,e){function d(){f.call(this);this.type=j}e.exports=d;var j=b("../math/Vec3"),f=b("./Pool");d.prototype=new f;d.prototype.constructObject=function(){return new j}},{"../math/Vec3":30,"./Pool":51}],55:[function(b,e){function d(b){this.contactPointPool=[];this.frictionEquationPool=[];this.result=[];this.frictionResult=[];this.v3pool=new n;this.world=b;this.currentContactMaterial=null;this.enableFrictionReduction=!1}e.exports=d;var j=b("../collision/AABB"),f=b("../shapes/Shape"),p=b("../collision/Ray"),
l=b("../math/Vec3"),g=b("../math/Transform");b("../shapes/ConvexPolyhedron");var m=b("../math/Quaternion");b("../solver/Solver");var n=b("../utils/Vec3Pool"),r=b("../equations/ContactEquation"),s=b("../equations/FrictionEquation");d.prototype.createContactEquation=function(b,d,e,g,f,j){var m;this.contactPointPool.length?(m=this.contactPointPool.pop(),m.bi=b,m.bj=d):m=new r(b,d);m.enabled=b.collisionResponse&&d.collisionResponse&&e.collisionResponse&&g.collisionResponse;var n=this.currentContactMaterial;
m.restitution=n.restitution;m.setSpookParams(n.contactEquationStiffness,n.contactEquationRelaxation,this.world.dt);b=e.material||b.material;d=g.material||d.material;b&&(d&&0<=b.restitution&&0<=d.restitution)&&(m.restitution=b.restitution*d.restitution);m.si=f||e;m.sj=j||g;return m};d.prototype.createFrictionEquationsFromContact=function(b,d){var e=b.bi,g=b.bj,f=this.world,j=this.currentContactMaterial,m=j.friction,n=b.si.material||e.material,l=b.sj.material||g.material;n&&(l&&0<=n.friction&&0<=l.friction)&&
(m=n.friction*l.friction);if(0<m){m*=f.gravity.length();n=e.invMass+g.invMass;0<n&&(n=1/n);var r=this.frictionEquationPool,l=r.length?r.pop():new s(e,g,m*n),r=r.length?r.pop():new s(e,g,m*n);l.bi=r.bi=e;l.bj=r.bj=g;l.minForce=r.minForce=-m*n;l.maxForce=r.maxForce=m*n;l.ri.copy(b.ri);l.rj.copy(b.rj);r.ri.copy(b.ri);r.rj.copy(b.rj);b.ni.tangents(l.t,r.t);l.setSpookParams(j.frictionEquationStiffness,j.frictionEquationRelaxation,f.dt);r.setSpookParams(j.frictionEquationStiffness,j.frictionEquationRelaxation,
f.dt);l.enabled=r.enabled=b.enabled;d.push(l,r);return!0}return!1};var t=new l,u=new l,v=new l;d.prototype.createFrictionFromAverage=function(b){var d=this.result[this.result.length-1];if(this.createFrictionEquationsFromContact(d,this.frictionResult)&&1!==b){var e=this.frictionResult[this.frictionResult.length-2],g=this.frictionResult[this.frictionResult.length-1];t.setZero();u.setZero();v.setZero();for(var f=d.bi,j=0;j!==b;j++)d=this.result[this.result.length-1-j],d.bodyA!==f?(t.vadd(d.ni,t),u.vadd(d.ri,
u),v.vadd(d.rj,v)):(t.vsub(d.ni,t),u.vadd(d.rj,u),v.vadd(d.ri,v));b=1/b;u.scale(b,e.ri);v.scale(b,e.rj);g.ri.copy(e.ri);g.rj.copy(e.rj);t.normalize();t.tangents(e.t,g.t)}};var z=new l,x=new l,B=new m,A=new m;d.prototype.getContacts=function(b,d,e,g,f,j,m){this.contactPointPool=f;this.frictionEquationPool=m;this.result=g;this.frictionResult=j;g=0;for(f=b.length;g!==f;g++){j=b[g];m=d[g];var n=null;j.material&&m.material&&(n=e.getContactMaterial(j.material,m.material)||null);for(var l=0;l<j.shapes.length;l++){j.quaternion.mult(j.shapeOrientations[l],
B);j.quaternion.vmult(j.shapeOffsets[l],z);z.vadd(j.position,z);for(var r=j.shapes[l],s=0;s<m.shapes.length;s++){m.quaternion.mult(m.shapeOrientations[s],A);m.quaternion.vmult(m.shapeOffsets[s],x);x.vadd(m.position,x);var p=m.shapes[s];if(!(z.distanceTo(x)>r.boundingSphereRadius+p.boundingSphereRadius)){var q=null;r.material&&p.material&&(q=e.getContactMaterial(r.material,p.material)||null);this.currentContactMaterial=q||n||e.defaultContactMaterial;(q=this[r.type|p.type])&&(r.type<p.type?q.call(this,
r,p,z,x,B,A,j,m,r,p):q.call(this,p,r,x,z,A,B,m,j,r,p))}}}}};d.prototype[f.types.BOX|f.types.BOX]=d.prototype.boxBox=function(b,d,e,g,f,j,m,n){b.convexPolyhedronRepresentation.material=b.material;d.convexPolyhedronRepresentation.material=d.material;b.convexPolyhedronRepresentation.collisionResponse=b.collisionResponse;d.convexPolyhedronRepresentation.collisionResponse=d.collisionResponse;this.convexConvex(b.convexPolyhedronRepresentation,d.convexPolyhedronRepresentation,e,g,f,j,m,n,b,d)};d.prototype[f.types.BOX|
f.types.CONVEXPOLYHEDRON]=d.prototype.boxConvex=function(b,d,e,g,f,j,m,n){b.convexPolyhedronRepresentation.material=b.material;b.convexPolyhedronRepresentation.collisionResponse=b.collisionResponse;this.convexConvex(b.convexPolyhedronRepresentation,d,e,g,f,j,m,n,b,d)};d.prototype[f.types.BOX|f.types.PARTICLE]=d.prototype.boxParticle=function(b,d,e,g,f,j,m,n){b.convexPolyhedronRepresentation.material=b.material;b.convexPolyhedronRepresentation.collisionResponse=b.collisionResponse;this.convexParticle(b.convexPolyhedronRepresentation,
d,e,g,f,j,m,n,b,d)};d.prototype[f.types.SPHERE]=d.prototype.sphereSphere=function(b,d,e,g,f,j,m,n){f=this.createContactEquation(m,n,b,d);g.vsub(e,f.ni);f.ni.normalize();f.ri.copy(f.ni);f.rj.copy(f.ni);f.ri.mult(b.radius,f.ri);f.rj.mult(-d.radius,f.rj);f.ri.vadd(e,f.ri);f.ri.vsub(m.position,f.ri);f.rj.vadd(g,f.rj);f.rj.vsub(n.position,f.rj);this.result.push(f);this.createFrictionEquationsFromContact(f,this.frictionResult)};var D=new l,I=new l,y=new l;d.prototype[f.types.PLANE|f.types.TRIMESH]=d.prototype.planeTrimesh=
function(b,d,e,f,j,m,n,r){var s=new l;D.set(0,0,1);j.vmult(D,D);for(j=0;j<d.vertices.length/3;j++){d.getVertex(j,s);var p=new l;p.copy(s);g.pointToWorldFrame(f,m,p,s);p=I;s.vsub(e,p);if(0>=D.dot(p)){var q=this.createContactEquation(n,r,b,d);q.ni.copy(D);var t=y;D.scale(p.dot(D),t);s.vsub(t,t);q.ri.copy(t);q.ri.vsub(n.position,q.ri);q.rj.copy(s);q.rj.vsub(r.position,q.rj);this.result.push(q);this.createFrictionEquationsFromContact(q,this.frictionResult)}}};var C=new l,J=new l;new l;var M=new l,O=new l,
N=new l,K=new l,W=new l,ea=new l,F=new l,H=new l,ia=new l,R=new l,L=new l,U=new j,Q=[];d.prototype[f.types.SPHERE|f.types.TRIMESH]=d.prototype.sphereTrimesh=function(b,d,e,f,j,m,n,l){g.pointToLocalFrame(f,m,e,F);j=b.radius;U.lowerBound.set(F.x-j,F.y-j,F.z-j);U.upperBound.set(F.x+j,F.y+j,F.z+j);d.getTrianglesInAABB(U,Q);var r=b.radius*b.radius;for(j=0;j<Q.length;j++)for(var s=0;3>s;s++)if(d.getVertex(d.indices[3*Q[j]+s],M),M.vsub(F,J),J.norm2()<=r){O.copy(M);g.pointToWorldFrame(f,m,O,M);M.vsub(e,J);
var q=this.createContactEquation(n,l,b,d);q.ni.copy(J);q.ni.normalize();q.ri.copy(q.ni);q.ri.scale(b.radius,q.ri);q.ri.vadd(e,q.ri);q.ri.vsub(n.position,q.ri);q.rj.copy(M);q.rj.vsub(l.position,q.rj);this.result.push(q);this.createFrictionEquationsFromContact(q,this.frictionResult)}for(j=0;j<Q.length;j++)for(s=0;3>s;s++)d.getVertex(d.indices[3*Q[j]+s],N),d.getVertex(d.indices[3*Q[j]+(s+1)%3],K),K.vsub(N,W),F.vsub(K,H),e=H.dot(W),F.vsub(N,H),q=H.dot(W),0<q&&0>e&&(F.vsub(N,H),ea.copy(W),ea.normalize(),
q=H.dot(ea),ea.scale(q,H),H.vadd(N,H),e=H.distanceTo(F),e<b.radius&&(q=this.createContactEquation(n,l,b,d),H.vsub(F,q.ni),q.ni.normalize(),q.ni.scale(b.radius,q.ri),g.pointToWorldFrame(f,m,H,H),H.vsub(l.position,q.rj),g.vectorToWorldFrame(m,q.ni,q.ni),g.vectorToWorldFrame(m,q.ri,q.ri),this.result.push(q),this.createFrictionEquationsFromContact(q,this.frictionResult)));j=0;for(s=Q.length;j!==s;j++)d.getTriangleVertices(Q[j],ia,R,L),d.getNormal(Q[j],C),F.vsub(ia,H),e=H.dot(C),C.scale(e,H),F.vsub(H,
H),e=H.distanceTo(F),p.pointInTriangle(H,ia,R,L)&&e<b.radius&&(q=this.createContactEquation(n,l,b,d),H.vsub(F,q.ni),q.ni.normalize(),q.ni.scale(b.radius,q.ri),g.pointToWorldFrame(f,m,H,H),H.vsub(l.position,q.rj),g.vectorToWorldFrame(m,q.ni,q.ni),g.vectorToWorldFrame(m,q.ri,q.ri),this.result.push(q),this.createFrictionEquationsFromContact(q,this.frictionResult));Q.length=0};var aa=new l,ba=new l;d.prototype[f.types.SPHERE|f.types.PLANE]=d.prototype.spherePlane=function(b,d,e,g,f,j,m,n){d=this.createContactEquation(m,
n,b,d);d.ni.set(0,0,1);j.vmult(d.ni,d.ni);d.ni.negate(d.ni);d.ni.normalize();d.ni.mult(b.radius,d.ri);e.vsub(g,aa);d.ni.mult(d.ni.dot(aa),ba);aa.vsub(ba,d.rj);-aa.dot(d.ni)<=b.radius&&(b=d.ri,j=d.rj,b.vadd(e,b),b.vsub(m.position,b),j.vadd(g,j),j.vsub(n.position,j),this.result.push(d),this.createFrictionEquationsFromContact(d,this.frictionResult))};var la=new l,qa=new l,fa=new l,oa=new l,E=new l,V=new l,ha=new l,G=[new l,new l,new l,new l,new l,new l],Xa=new l,pa=new l,Ia=new l,Oa=new l;d.prototype[f.types.SPHERE|
f.types.BOX]=d.prototype.sphereBox=function(b,d,e,g,f,j,m,n){f=this.v3pool;e.vsub(g,oa);d.getSideNormals(G,j);j=b.radius;for(var l=!1,r=null,q=0,s=0,p=0,t=null,u=0,v=G.length;u!==v&&!1===l;u++){var x=E;x.copy(G[u]);var z=x.norm();x.normalize();var y=oa.dot(x);if(y<z+j&&0<y){var F=V,A=ha;F.copy(G[(u+1)%3]);A.copy(G[(u+2)%3]);var B=F.norm(),H=A.norm();F.normalize();A.normalize();var D=oa.dot(F),C=oa.dot(A);if(D<B&&(D>-B&&C<H&&C>-H)&&(y=Math.abs(y-z-j),null===t||y<t))t=y,s=D,p=C,r=z,pa.copy(x),Ia.copy(F),
Oa.copy(A),q++}}q&&(l=!0,q=this.createContactEquation(m,n,b,d),pa.mult(-j,q.ri),q.ni.copy(pa),q.ni.negate(q.ni),pa.mult(r,pa),Ia.mult(s,Ia),pa.vadd(Ia,pa),Oa.mult(p,Oa),pa.vadd(Oa,q.rj),q.ri.vadd(e,q.ri),q.ri.vsub(m.position,q.ri),q.rj.vadd(g,q.rj),q.rj.vsub(n.position,q.rj),this.result.push(q),this.createFrictionEquationsFromContact(q,this.frictionResult));y=f.get();for(r=0;2!==r&&!l;r++)for(s=0;2!==s&&!l;s++)for(p=0;2!==p&&!l;p++)y.set(0,0,0),r?y.vadd(G[0],y):y.vsub(G[0],y),s?y.vadd(G[1],y):y.vsub(G[1],
y),p?y.vadd(G[2],y):y.vsub(G[2],y),g.vadd(y,Xa),Xa.vsub(e,Xa),Xa.norm2()<j*j&&(l=!0,q=this.createContactEquation(m,n,b,d),q.ri.copy(Xa),q.ri.normalize(),q.ni.copy(q.ri),q.ri.mult(j,q.ri),q.rj.copy(y),q.ri.vadd(e,q.ri),q.ri.vsub(m.position,q.ri),q.rj.vadd(g,q.rj),q.rj.vsub(n.position,q.rj),this.result.push(q),this.createFrictionEquationsFromContact(q,this.frictionResult));f.release(y);t=f.get();u=f.get();q=f.get();v=f.get();y=f.get();x=G.length;for(r=0;r!==x&&!l;r++)for(s=0;s!==x&&!l;s++)if(r%3!==
s%3){G[s].cross(G[r],t);t.normalize();G[r].vadd(G[s],u);q.copy(e);q.vsub(u,q);q.vsub(g,q);z=q.dot(t);t.mult(z,v);for(p=0;p===r%3||p===s%3;)p++;y.copy(e);y.vsub(v,y);y.vsub(u,y);y.vsub(g,y);z=Math.abs(z);F=y.norm();z<G[p].norm()&&F<j&&(l=!0,p=this.createContactEquation(m,n,b,d),u.vadd(v,p.rj),p.rj.copy(p.rj),y.negate(p.ni),p.ni.normalize(),p.ri.copy(p.rj),p.ri.vadd(g,p.ri),p.ri.vsub(e,p.ri),p.ri.normalize(),p.ri.mult(j,p.ri),p.ri.vadd(e,p.ri),p.ri.vsub(m.position,p.ri),p.rj.vadd(g,p.rj),p.rj.vsub(n.position,
p.rj),this.result.push(p),this.createFrictionEquationsFromContact(p,this.frictionResult))}f.release(t,u,q,v,y)};var Va=new l,cb=new l,vb=new l,db=new l,wb=new l,Lb=new l,ca=new l,q=new l,Mb=new l,Nb=new l;d.prototype[f.types.SPHERE|f.types.CONVEXPOLYHEDRON]=d.prototype.sphereConvex=function(b,d,e,g,f,j,m,n){f=this.v3pool;e.vsub(g,Va);for(var l=d.faceNormals,r=d.faces,p=d.vertices,s=b.radius,t=0;t!==p.length;t++){var u=wb;j.vmult(p[t],u);g.vadd(u,u);var v=db;u.vsub(e,v);if(v.norm2()<s*s){b=this.createContactEquation(m,
n,b,d);b.ri.copy(v);b.ri.normalize();b.ni.copy(b.ri);b.ri.mult(s,b.ri);u.vsub(g,b.rj);b.ri.vadd(e,b.ri);b.ri.vsub(m.position,b.ri);b.rj.vadd(g,b.rj);b.rj.vsub(n.position,b.rj);this.result.push(b);this.createFrictionEquationsFromContact(b,this.frictionResult);return}}t=0;for(u=r.length;t!==u;t++){var v=r[t],y=Lb;j.vmult(l[t],y);var x=ca;j.vmult(p[v[0]],x);x.vadd(g,x);var z=q;y.mult(-s,z);e.vadd(z,z);var F=Mb;z.vsub(x,F);z=F.dot(y);F=Nb;e.vsub(x,F);if(0>z&&0<F.dot(y)){for(var x=[],F=0,E=v.length;F!==
E;F++){var A=f.get();j.vmult(p[v[F]],A);g.vadd(A,A);x.push(A)}a:{for(var F=x,E=y,A=e,B=null,H=F.length,D=0;D!==H;D++){var C=F[D],V=la;F[(D+1)%H].vsub(C,V);var U=qa;V.cross(E,U);V=fa;A.vsub(C,V);C=U.dot(V);if(null===B||0<C&&!0===B||0>=C&&!1===B)null===B&&(B=0<C);else{F=!1;break a}}F=!0}if(F){b=this.createContactEquation(m,n,b,d);y.mult(-s,b.ri);y.negate(b.ni);d=f.get();y.mult(-z,d);j=f.get();y.mult(-s,j);e.vsub(g,b.rj);b.rj.vadd(j,b.rj);b.rj.vadd(d,b.rj);b.rj.vadd(g,b.rj);b.rj.vsub(n.position,b.rj);
b.ri.vadd(e,b.ri);b.ri.vsub(m.position,b.ri);f.release(d);f.release(j);this.result.push(b);this.createFrictionEquationsFromContact(b,this.frictionResult);F=0;for(v=x.length;F!==v;F++)f.release(x[F]);break}else for(F=0;F!==v.length;F++){y=f.get();z=f.get();j.vmult(p[v[(F+1)%v.length]],y);j.vmult(p[v[(F+2)%v.length]],z);g.vadd(y,y);g.vadd(z,z);H=cb;z.vsub(y,H);B=vb;H.unit(B);E=f.get();A=f.get();e.vsub(y,A);D=A.dot(B);B.mult(D,E);E.vadd(y,E);B=f.get();E.vsub(e,B);if(0<D&&D*D<H.norm2()&&B.norm2()<s*s){b=
this.createContactEquation(m,n,b,d);E.vsub(g,b.rj);E.vsub(e,b.ni);b.ni.normalize();b.ni.mult(s,b.ri);b.rj.vadd(g,b.rj);b.rj.vsub(n.position,b.rj);b.ri.vadd(e,b.ri);b.ri.vsub(m.position,b.ri);this.result.push(b);this.createFrictionEquationsFromContact(b,this.frictionResult);F=0;for(v=x.length;F!==v;F++)f.release(x[F]);f.release(y);f.release(z);f.release(E);f.release(B);f.release(A);return}f.release(y);f.release(z);f.release(E);f.release(B);f.release(A)}F=0;for(v=x.length;F!==v;F++)f.release(x[F])}}};
new l;new l;d.prototype[f.types.PLANE|f.types.BOX]=d.prototype.planeBox=function(b,d,e,g,f,j,m,n){d.convexPolyhedronRepresentation.material=d.material;d.convexPolyhedronRepresentation.collisionResponse=d.collisionResponse;this.planeConvex(b,d.convexPolyhedronRepresentation,e,g,f,j,m,n)};var Da=new l,Ja=new l,va=new l,lb=new l;d.prototype[f.types.PLANE|f.types.CONVEXPOLYHEDRON]=d.prototype.planeConvex=function(b,d,e,g,f,j,m,n){Ja.set(0,0,1);f.vmult(Ja,Ja);for(var l=f=0;l!==d.vertices.length;l++)if(Da.copy(d.vertices[l]),
j.vmult(Da,Da),g.vadd(Da,Da),Da.vsub(e,va),0>=Ja.dot(va)){var r=this.createContactEquation(m,n,b,d),q=lb;Ja.mult(Ja.dot(va),q);Da.vsub(q,q);q.vsub(e,r.ri);r.ni.copy(Ja);Da.vsub(g,r.rj);r.ri.vadd(e,r.ri);r.ri.vsub(m.position,r.ri);r.rj.vadd(g,r.rj);r.rj.vsub(n.position,r.rj);this.result.push(r);f++;this.enableFrictionReduction||this.createFrictionEquationsFromContact(r,this.frictionResult)}this.enableFrictionReduction&&f&&this.createFrictionFromAverage(f)};var Y=new l,Ra=new l;d.prototype[f.types.CONVEXPOLYHEDRON]=
d.prototype.convexConvex=function(b,d,e,g,f,j,m,n,l,r,q,p){if(!(e.distanceTo(g)>b.boundingSphereRadius+d.boundingSphereRadius)&&b.findSeparatingAxis(d,e,f,g,j,Y,q,p)){q=[];b.clipAgainstHull(e,f,d,g,j,Y,-100,100,q);for(j=f=0;j!==q.length;j++){p=this.createContactEquation(m,n,b,d,l,r);var s=p.ri,t=p.rj;Y.negate(p.ni);q[j].normal.negate(Ra);Ra.mult(q[j].depth,Ra);q[j].point.vadd(Ra,s);t.copy(q[j].point);s.vsub(e,s);t.vsub(g,t);s.vadd(e,s);s.vsub(m.position,s);t.vadd(g,t);t.vsub(n.position,t);this.result.push(p);
f++;this.enableFrictionReduction||this.createFrictionEquationsFromContact(p,this.frictionResult)}this.enableFrictionReduction&&f&&this.createFrictionFromAverage(f)}};var ja=new l,sa=new l,Sa=new l;d.prototype[f.types.PLANE|f.types.PARTICLE]=d.prototype.planeParticle=function(b,d,e,g,f,j,m,n){ja.set(0,0,1);m.quaternion.vmult(ja,ja);g.vsub(m.position,sa);0>=ja.dot(sa)&&(b=this.createContactEquation(n,m,d,b),b.ni.copy(ja),b.ni.negate(b.ni),b.ri.set(0,0,0),ja.mult(ja.dot(g),Sa),g.vsub(Sa,Sa),b.rj.copy(Sa),
this.result.push(b),this.createFrictionEquationsFromContact(b,this.frictionResult))};var Ka=new l;d.prototype[f.types.PARTICLE|f.types.SPHERE]=d.prototype.sphereParticle=function(b,d,e,g,f,j,m,n){Ka.set(0,0,1);g.vsub(e,Ka);Ka.norm2()<=b.radius*b.radius&&(d=this.createContactEquation(n,m,d,b),Ka.normalize(),d.rj.copy(Ka),d.rj.mult(b.radius,d.rj),d.ni.copy(Ka),d.ni.negate(d.ni),d.ri.set(0,0,0),this.result.push(d),this.createFrictionEquationsFromContact(d,this.frictionResult))};var zb=new m,Ta=new l;
new l;var eb=new l,Fa=new l,Ea=new l;d.prototype[f.types.PARTICLE|f.types.CONVEXPOLYHEDRON]=d.prototype.convexParticle=function(b,d,e,g,f,j,m,n){var l=-1;j=null;var r=0;Ta.copy(g);Ta.vsub(e,Ta);f.conjugate(zb);zb.vmult(Ta,Ta);if(b.pointIsInside(Ta)){b.worldVerticesNeedsUpdate&&b.computeWorldVertices(e,f);b.worldFaceNormalsNeedsUpdate&&b.computeWorldFaceNormals(f);f=0;for(var q=b.faces.length;f!==q;f++){var p=b.worldFaceNormals[f];g.vsub(b.worldVertices[b.faces[f][0]],Fa);var s=-p.dot(Fa);if(null===
j||Math.abs(s)<Math.abs(j))j=s,l=f,eb.copy(p),r++}-1!==l?(b=this.createContactEquation(n,m,d,b),eb.mult(j,Ea),Ea.vadd(g,Ea),Ea.vsub(e,Ea),b.rj.copy(Ea),eb.negate(b.ni),b.ri.set(0,0,0),d=b.ri,j=b.rj,d.vadd(g,d),d.vsub(n.position,d),j.vadd(e,j),j.vsub(m.position,j),this.result.push(b),this.createFrictionEquationsFromContact(b,this.frictionResult)):console.warn("Point found inside convex, but did not find penetrating face!")}};d.prototype[f.types.BOX|f.types.HEIGHTFIELD]=d.prototype.boxHeightfield=function(b,
d,e,g,f,j,m,n){b.convexPolyhedronRepresentation.material=b.material;b.convexPolyhedronRepresentation.collisionResponse=b.collisionResponse;this.convexHeightfield(b.convexPolyhedronRepresentation,d,e,g,f,j,m,n)};var Ga=new l,za=new l,Ya=[0];d.prototype[f.types.CONVEXPOLYHEDRON|f.types.HEIGHTFIELD]=d.prototype.convexHeightfield=function(b,d,e,f,j,m,n,l){var r=d.data,q=d.elementSize,p=b.boundingSphereRadius;g.pointToLocalFrame(f,m,e,Ga);var s=Math.floor((Ga.x-p)/q)-1,t=Math.ceil((Ga.x+p)/q)+1,u=Math.floor((Ga.y-
p)/q)-1,q=Math.ceil((Ga.y+p)/q)+1;if(!(0>t||0>q||s>r.length||u>r[0].length)){0>s&&(s=0);0>t&&(t=0);0>u&&(u=0);0>q&&(q=0);s>=r.length&&(s=r.length-1);t>=r.length&&(t=r.length-1);q>=r[0].length&&(q=r[0].length-1);u>=r[0].length&&(u=r[0].length-1);r=[];d.getRectMinMax(s,u,t,q,r);var v=r[0];if(!(Ga.z-p>r[1]||Ga.z+p<v))for(p=s;p<t;p++)for(s=u;s<q;s++)d.getConvexTrianglePillar(p,s,!1),g.pointToWorldFrame(f,m,d.pillarOffset,za),e.distanceTo(za)<d.pillarConvex.boundingSphereRadius+b.boundingSphereRadius&&
this.convexConvex(b,d.pillarConvex,e,za,j,m,n,l,null,null,Ya,null),d.getConvexTrianglePillar(p,s,!0),g.pointToWorldFrame(f,m,d.pillarOffset,za),e.distanceTo(za)<d.pillarConvex.boundingSphereRadius+b.boundingSphereRadius&&this.convexConvex(b,d.pillarConvex,e,za,j,m,n,l,null,null,Ya,null)}};var Aa=new l,Ba=new l;d.prototype[f.types.SPHERE|f.types.HEIGHTFIELD]=d.prototype.sphereHeightfield=function(b,d,e,f,j,m,n,l){var r=d.data,q=b.radius,p=d.elementSize;g.pointToLocalFrame(f,m,e,Aa);var s=Math.floor((Aa.x-
q)/p)-1,t=Math.ceil((Aa.x+q)/p)+1,u=Math.floor((Aa.y-q)/p)-1,p=Math.ceil((Aa.y+q)/p)+1;if(!(0>t||0>p||s>r.length||p>r[0].length)){0>s&&(s=0);0>t&&(t=0);0>u&&(u=0);0>p&&(p=0);s>=r.length&&(s=r.length-1);t>=r.length&&(t=r.length-1);p>=r[0].length&&(p=r[0].length-1);u>=r[0].length&&(u=r[0].length-1);r=[];d.getRectMinMax(s,u,t,p,r);var v=r[0];if(!(Aa.z-q>r[1]||Aa.z+q<v))for(q=this.result;s<t;s++)for(r=u;r<p;r++)if(v=q.length,d.getConvexTrianglePillar(s,r,!1),g.pointToWorldFrame(f,m,d.pillarOffset,Ba),
e.distanceTo(Ba)<d.pillarConvex.boundingSphereRadius+b.boundingSphereRadius&&this.sphereConvex(b,d.pillarConvex,e,Ba,j,m,n,l),d.getConvexTrianglePillar(s,r,!0),g.pointToWorldFrame(f,m,d.pillarOffset,Ba),e.distanceTo(Ba)<d.pillarConvex.boundingSphereRadius+b.boundingSphereRadius&&this.sphereConvex(b,d.pillarConvex,e,Ba,j,m,n,l),2<q.length-v)return}}},{"../collision/AABB":3,"../collision/Ray":9,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../math/Quaternion":28,"../math/Transform":29,
"../math/Vec3":30,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43,"../solver/Solver":47,"../utils/Vec3Pool":54}],56:[function(b,e){function d(){g.apply(this);this.dt=-1;this.allowSleep=!1;this.contacts=[];this.frictionEquations=[];this.quatNormalizeSkip=0;this.quatNormalizeFast=!1;this.stepnumber=this.time=0;this.default_dt=1/60;this.nextId=0;this.gravity=new j;this.broadphase=new x;this.bodies=[];this.solver=new p;this.constraints=[];this.narrowphase=new l(this);this.collisionMatrix=new m;this.collisionMatrixPrevious=
new m;this.materials=[];this.contactmaterials=[];this.contactMaterialTable=new t;this.defaultMaterial=new n("default");this.defaultContactMaterial=new r(this.defaultMaterial,this.defaultMaterial,{friction:0.3,restitution:0});this.doProfiling=!1;this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0};this.subsystems=[];this.addBodyEvent={type:"addBody",body:null};this.removeBodyEvent={type:"removeBody",body:null}}e.exports=d;b("../shapes/Shape");var j=b("../math/Vec3"),
f=b("../math/Quaternion"),p=b("../solver/GSSolver");b("../utils/Vec3Pool");b("../equations/ContactEquation");b("../equations/FrictionEquation");var l=b("./Narrowphase"),g=b("../utils/EventTarget"),m=b("../collision/ArrayCollisionMatrix"),n=b("../material/Material"),r=b("../material/ContactMaterial"),s=b("../objects/Body"),t=b("../utils/TupleDictionary"),u=b("../collision/RaycastResult"),v=b("../collision/AABB"),z=b("../collision/Ray"),x=b("../collision/NaiveBroadphase");d.prototype=new g;new v;var B=
new z;d.prototype.getContactMaterial=function(b,d){return this.contactMaterialTable.get(b.id,d.id)};d.prototype.numObjects=function(){return this.bodies.length};d.prototype.collisionMatrixTick=function(){var b=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix;this.collisionMatrix=b;this.collisionMatrix.reset()};d.prototype.add=d.prototype.addBody=function(b){-1===this.bodies.indexOf(b)&&(b.index=this.bodies.length,this.bodies.push(b),b.world=this,b.initPosition.copy(b.position),
b.initVelocity.copy(b.velocity),b.timeLastSleepy=this.time,b instanceof s&&(b.initAngularVelocity.copy(b.angularVelocity),b.initQuaternion.copy(b.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=b,this.dispatchEvent(this.addBodyEvent))};d.prototype.addConstraint=function(b){this.constraints.push(b)};d.prototype.removeConstraint=function(b){b=this.constraints.indexOf(b);-1!==b&&this.constraints.splice(b,1)};d.prototype.rayTest=function(b,d,e){e instanceof u?
this.raycastClosest(b,d,{skipBackfaces:!0},e):this.raycastAll(b,d,{skipBackfaces:!0},e)};d.prototype.raycastAll=function(b,d,e,g){e.mode=z.ALL;e.from=b;e.to=d;e.callback=g;return B.intersectWorld(this,e)};d.prototype.raycastAny=function(b,d,e,g){e.mode=z.ANY;e.from=b;e.to=d;e.result=g;return B.intersectWorld(this,e)};d.prototype.raycastClosest=function(b,d,e,g){e.mode=z.CLOSEST;e.from=b;e.to=d;e.result=g;return B.intersectWorld(this,e)};d.prototype.remove=function(b){b.world=null;var d=this.bodies.length-
1,e=this.bodies,g=e.indexOf(b);if(-1!==g){e.splice(g,1);for(g=0;g!==e.length;g++)e[g].index=g;this.collisionMatrix.setNumObjects(d);this.removeBodyEvent.body=b;this.dispatchEvent(this.removeBodyEvent)}};d.prototype.removeBody=d.prototype.remove;d.prototype.addMaterial=function(b){this.materials.push(b)};d.prototype.addContactMaterial=function(b){this.contactmaterials.push(b);this.contactMaterialTable.set(b.materials[0].id,b.materials[1].id,b)};"undefined"===typeof performance&&(performance={});if(!performance.now){var A=
Date.now();performance.timing&&performance.timing.navigationStart&&(A=performance.timing.navigationStart);performance.now=function(){return Date.now()-A}}var D=new j;d.prototype.step=function(b,d,e){e=e||10;d=d||0;if(0===d)this.internalStep(b),this.time+=b;else{var g=Math.floor((this.time+d)/b)-Math.floor(this.time/b),g=Math.min(g,e);e=performance.now();for(var f=0;f!==g&&!(this.internalStep(b),performance.now()-e>1E3*b);f++);this.time+=d;b=this.time%b/b;d=this.bodies;for(g=0;g!==d.length;g++)e=d[g],
e.type!==s.STATIC&&e.sleepState!==s.SLEEPING?(e.position.vsub(e.previousPosition,D),D.scale(b,D),e.position.vadd(D,e.interpolatedPosition)):(e.interpolatedPosition.copy(e.position),e.interpolatedQuaternion.copy(e.quaternion))}};var I={type:"postStep"},y={type:"preStep"},C={type:"collide",body:null,contact:null},J=[],M=[],O=[],N=[];new j;new j;new j;new j;new j;new j;new j;new j;new j;new f;var K=new f,W=new f,ea=new j;d.prototype.internalStep=function(b){this.dt=b;var d=this.contacts,e=this.numObjects(),
g=this.bodies,f=this.solver,j=this.gravity,m=this.doProfiling,n=this.profile,l=s.DYNAMIC,r,p=this.constraints;j.norm();var t=j.x,u=j.y,v=j.z,j=0;m&&(r=performance.now());for(j=0;j!==e;j++){var x=g[j];if(x.type&l){var z=x.force,x=x.mass;z.x+=x*t;z.y+=x*u;z.z+=x*v}}j=0;for(x=this.subsystems.length;j!==x;j++)this.subsystems[j].update();m&&(r=performance.now());O.length=0;N.length=0;this.broadphase.collisionPairs(this,O,N);m&&(n.broadphase=performance.now()-r);x=p.length;for(j=0;j!==x;j++)if(t=p[j],!t.collideConnected)for(u=
O.length-1;0<=u;u-=1)if(t.bodyA===O[u]&&t.bodyB===N[u]||t.bodyB===O[u]&&t.bodyA===N[u])O.splice(u,1),N.splice(u,1);this.collisionMatrixTick();m&&(r=performance.now());x=d.length;for(j=0;j!==x;j++)J.push(d[j]);d.length=0;x=this.frictionEquations.length;for(j=0;j!==x;j++)M.push(this.frictionEquations[j]);this.frictionEquations.length=0;this.narrowphase.getContacts(O,N,this,d,J,this.frictionEquations,M);m&&(n.narrowphase=performance.now()-r);m&&(r=performance.now());for(j=0;j<this.frictionEquations.length;j++)f.addEquation(this.frictionEquations[j]);
j=d.length;for(u=0;u!==j;u++){t=d[u];x=t.bi;v=t.bj;x.material&&v.material&&this.getContactMaterial(x.material,v.material);x.material&&v.material&&(0<=x.material.restitution&&0<=v.material.restitution)&&(t.restitution=x.material.restitution*v.material.restitution);f.addEquation(t);if(x.allowSleep&&x.type===s.DYNAMIC&&x.sleepState===s.SLEEPING&&v.sleepState===s.AWAKE&&v.type!==s.STATIC){var z=v.velocity.norm2()+v.angularVelocity.norm2(),A=Math.pow(v.sleepSpeedLimit,2);z>=2*A&&(x._wakeUpAfterNarrowphase=
!0)}v.allowSleep&&(v.type===s.DYNAMIC&&v.sleepState===s.SLEEPING&&x.sleepState===s.AWAKE&&x.type!==s.STATIC)&&(z=x.velocity.norm2()+x.angularVelocity.norm2(),A=Math.pow(x.sleepSpeedLimit,2),z>=2*A&&(v._wakeUpAfterNarrowphase=!0));this.collisionMatrix.set(x,v,!0);this.collisionMatrixPrevious.get(x,v)||(C.body=v,C.contact=t,x.dispatchEvent(C),C.body=x,v.dispatchEvent(C))}m&&(n.makeContactConstraints=performance.now()-r,r=performance.now());for(j=0;j!==e;j++)x=g[j],x._wakeUpAfterNarrowphase&&(x.wakeUp(),
x._wakeUpAfterNarrowphase=!1);x=p.length;for(j=0;j!==x;j++){t=p[j];t.update();u=0;for(d=t.equations.length;u!==d;u++)f.addEquation(t.equations[u])}f.solve(b,this);m&&(n.solve=performance.now()-r);f.removeAllEquations();f=Math.pow;for(j=0;j!==e;j++)if(x=g[j],x.type&l&&(p=f(1-x.linearDamping,b),d=x.velocity,d.mult(p,d),p=x.angularVelocity))d=f(1-x.angularDamping,b),p.mult(d,p);this.dispatchEvent(y);for(j=0;j!==e;j++)x=g[j],x.preStep&&x.preStep.call(x);m&&(r=performance.now());l=s.DYNAMIC|s.KINEMATIC;
f=0===this.stepnumber%(this.quatNormalizeSkip+1);p=this.quatNormalizeFast;d=0.5*b;for(j=0;j!==e;j++)if(x=g[j],t=x.force,u=x.torque,x.type&l&&x.sleepState!==s.SLEEPING){var v=x.velocity,z=x.angularVelocity,A=x.position,B=x.quaternion,D=x.invMass,Ia=x.invInertiaWorld;v.x+=t.x*D*b;v.y+=t.y*D*b;v.z+=t.z*D*b;x.angularVelocity&&(Ia.vmult(u,ea),ea.mult(b,ea),ea.vadd(z,z));A.x+=v.x*b;A.y+=v.y*b;A.z+=v.z*b;x.angularVelocity&&(K.set(z.x,z.y,z.z,0),K.mult(B,W),B.x+=d*W.x,B.y+=d*W.y,B.z+=d*W.z,B.w+=d*W.w,f&&
(p?B.normalizeFast():B.normalize()));x.aabb&&(x.aabbNeedsUpdate=!0);x.updateInertiaWorld&&x.updateInertiaWorld()}this.clearForces();this.broadphase.dirty=!0;m&&(n.integrate=performance.now()-r);this.time+=b;this.stepnumber+=1;this.dispatchEvent(I);for(j=0;j!==e;j++)x=g[j],(b=x.postStep)&&b.call(x);if(this.allowSleep)for(j=0;j!==e;j++)g[j].sleepTick(this.time)};d.prototype.clearForces=function(){for(var b=this.bodies,d=b.length,e=0;e!==d;e++){var g=b[e];g.force.set(0,0,0);g.torque.set(0,0,0)}}},{"../collision/AABB":3,
"../collision/ArrayCollisionMatrix":4,"../collision/NaiveBroadphase":7,"../collision/Ray":9,"../collision/RaycastResult":10,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../material/ContactMaterial":24,"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Shape":43,"../solver/GSSolver":46,"../utils/EventTarget":49,"../utils/TupleDictionary":52,"../utils/Vec3Pool":54,"./Narrowphase":55}]},{},[2])(2)});function getInternetExplorerVersion(){var c=-1;"Microsoft Internet Explorer"==navigator.appName&&null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(c=parseFloat(RegExp.$1));return c}var ie=getInternetExplorerVersion();function getQueryVariable(c){for(var b=window.location.search.substring(1).split("&"),e=0;e<b.length;e++){var d=b[e].match(/([^=]+?)=(.+)/);if(d&&decodeURIComponent(d[1])==c)return decodeURIComponent(d[2])}};this.jukebox={};
jukebox.Player=function(c,b){this.id=++jukebox.__jukeboxId;this.origin=b||null;this.settings={};for(var e in this.defaults)this.settings[e]=this.defaults[e];if("[object Object]"===Object.prototype.toString.call(c))for(var d in c)this.settings[d]=c[d];"[object Function]"===Object.prototype.toString.call(jukebox.Manager)&&(jukebox.Manager=new jukebox.Manager);this.resource=this.isPlaying=null;this.resource="[object Object]"===Object.prototype.toString.call(jukebox.Manager)?jukebox.Manager.getPlayableResource(this.settings.resources):this.settings.resources[0]||
null;if(null===this.resource)throw"Your browser can't playback the given resources - or you have missed to include jukebox.Manager";this.__init();return this};jukebox.__jukeboxId=0;
jukebox.Player.prototype={defaults:{resources:[],autoplay:!1,spritemap:{},flashMediaElement:"./swf/FlashMediaElement.swf",timeout:1E3},__addToManager:function(){!0!==this.__wasAddedToManager&&(jukebox.Manager.add(this),this.__wasAddedToManager=!0)},__init:function(){var c=this,b=this.settings,e={},d;jukebox.Manager&&void 0!==jukebox.Manager.features&&(e=jukebox.Manager.features);if(!0===e.html5audio){this.context=new Audio;this.context.src=this.resource;if(null===this.origin){var j=function(b){c.__addToManager(b)};
this.context.addEventListener("canplaythrough",j,!0);window.setTimeout(function(){c.context.removeEventListener("canplaythrough",j,!0);j("timeout")},b.timeout)}this.context.autobuffer=!0;this.context.preload=!0;for(d in this.HTML5API)this[d]=this.HTML5API[d];1<e.channels?!0===b.autoplay?this.context.autoplay=!0:void 0!==b.spritemap[b.autoplay]&&this.play(b.autoplay):1===e.channels&&void 0!==b.spritemap[b.autoplay]&&(this.backgroundMusic=b.spritemap[b.autoplay],this.backgroundMusic.started=Date.now?
Date.now():+new Date,this.play(b.autoplay));1==e.channels&&!0!==b.canPlayBackground&&(window.addEventListener("pagehide",function(){null!==c.isPlaying&&(c.pause(),c.__wasAutoPaused=!0)}),window.addEventListener("pageshow",function(){c.__wasAutoPaused&&(c.resume(),delete c._wasAutoPaused)}))}else if(!0===e.flashaudio){for(d in this.FLASHAPI)this[d]=this.FLASHAPI[d];e=["id=jukebox-flashstream-"+this.id,"autoplay="+b.autoplay,"file="+window.encodeURIComponent(this.resource)];this.__initFlashContext(e);
!0===b.autoplay?this.play(0):b.spritemap[b.autoplay]&&this.play(b.autoplay)}else throw"Your Browser does not support Flash Audio or HTML5 Audio.";},__initFlashContext:function(c){var b,e=this.settings.flashMediaElement,d,j={flashvars:c.join("&"),quality:"high",bgcolor:"#000000",wmode:"transparent",allowscriptaccess:"always",allowfullscreen:"true"};if(navigator.userAgent.match(/MSIE/)){b=document.createElement("div");document.getElementsByTagName("body")[0].appendChild(b);var f=document.createElement("object");
f.id="jukebox-flashstream-"+this.id;f.setAttribute("type","application/x-shockwave-flash");f.setAttribute("classid","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000");f.setAttribute("width","0");f.setAttribute("height","0");j.movie=e+"?x="+(Date.now?Date.now():+new Date);j.flashvars=c.join("&amp;");for(d in j)c=document.createElement("param"),c.setAttribute("name",d),c.setAttribute("value",j[d]),f.appendChild(c);b.outerHTML=f.outerHTML;this.context=document.getElementById("jukebox-flashstream-"+this.id)}else{b=
document.createElement("embed");b.id="jukebox-flashstream-"+this.id;b.setAttribute("type","application/x-shockwave-flash");b.setAttribute("width","100");b.setAttribute("height","100");j.play=!1;j.loop=!1;j.src=e+"?x="+(Date.now?Date.now():+new Date);for(d in j)b.setAttribute(d,j[d]);document.getElementsByTagName("body")[0].appendChild(b);this.context=b}},backgroundHackForiOS:function(){if(void 0!==this.backgroundMusic){var c=Date.now?Date.now():+new Date;void 0===this.backgroundMusic.started?(this.backgroundMusic.started=
c,this.setCurrentTime(this.backgroundMusic.start)):(this.backgroundMusic.lastPointer=(c-this.backgroundMusic.started)/1E3%(this.backgroundMusic.end-this.backgroundMusic.start)+this.backgroundMusic.start,this.play(this.backgroundMusic.lastPointer))}},play:function(c,b){if(null!==this.isPlaying&&!0!==b)void 0!==jukebox.Manager&&jukebox.Manager.addToQueue(c,this.id);else{var e=this.settings.spritemap,d;if(void 0!==e[c])d=e[c].start;else if("number"===typeof c){d=c;for(var j in e)if(d>=e[j].start&&d<=
e[j].end){c=j;break}}void 0!==d&&"[object Object]"===Object.prototype.toString.call(e[c])&&(this.isPlaying=this.settings.spritemap[c],this.context.play&&this.context.play(),this.wasReady=this.setCurrentTime(d))}},stop:function(){this.__lastPosition=0;this.isPlaying=null;this.backgroundMusic?this.backgroundHackForiOS():this.context.pause();return!0},pause:function(){this.isPlaying=null;this.__lastPosition=this.getCurrentTime();this.context.pause();return this.__lastPosition},resume:function(c){c="number"===
typeof c?c:this.__lastPosition;if(null!==c)return this.play(c),this.__lastPosition=null,!0;this.context.play();return!1},HTML5API:{getVolume:function(){return this.context.volume||1},setVolume:function(c){this.context.volume=c;return 1E-4>Math.abs(this.context.volume-c)?!0:!1},getCurrentTime:function(){return this.context.currentTime||0},setCurrentTime:function(c){try{return this.context.currentTime=c,!0}catch(b){return!1}}},FLASHAPI:{getVolume:function(){return this.context&&"function"===typeof this.context.getVolume?
this.context.getVolume():1},setVolume:function(c){return this.context&&"function"===typeof this.context.setVolume?(this.context.setVolume(c),!0):!1},getCurrentTime:function(){return this.context&&"function"===typeof this.context.getCurrentTime?this.context.getCurrentTime():0},setCurrentTime:function(c){return this.context&&"function"===typeof this.context.setCurrentTime?this.context.setCurrentTime(c):!1}}};
if(void 0===this.jukebox)throw"jukebox.Manager requires jukebox.Player (Player.js) to run properly.";
jukebox.Manager=function(c){this.features={};this.codecs={};this.__players={};this.__playersLength=0;this.__clones={};this.__queue=[];this.settings={};for(var b in this.defaults)this.settings[b]=this.defaults[b];if("[object Object]"===Object.prototype.toString.call(c))for(var e in c)this.settings[e]=c[e];this.__detectFeatures();jukebox.Manager.__initialized=!1===this.settings.useGameLoop?window.setInterval(function(){jukebox.Manager.loop()},20):!0};
jukebox.Manager.prototype={defaults:{useFlash:!1,useGameLoop:!1},__detectFeatures:function(){var c=window.Audio&&new Audio;if(c&&c.canPlayType&&!1===this.settings.useFlash){for(var b=[{e:"3gp",m:["audio/3gpp","audio/amr"]},{e:"aac",m:["audio/aac","audio/aacp"]},{e:"amr",m:["audio/amr","audio/3gpp"]},{e:"caf",m:["audio/IMA-ADPCM","audio/x-adpcm",'audio/x-aiff; codecs="IMA-ADPCM, ADPCM"']},{e:"m4a",m:'audio/mp4{audio/mp4; codecs="mp4a.40.2,avc1.42E01E"{audio/mpeg4{audio/mpeg4-generic{audio/mp4a-latm{audio/MP4A-LATM{audio/x-m4a'.split("{")},
{e:"mp3",m:["audio/mp3","audio/mpeg",'audio/mpeg; codecs="mp3"',"audio/MPA","audio/mpa-robust"]},{e:"mpga",m:["audio/MPA","audio/mpa-robust","audio/mpeg","video/mpeg"]},{e:"mp4",m:["audio/mp4","video/mp4"]},{e:"ogg",m:["application/ogg","audio/ogg",'audio/ogg; codecs="theora, vorbis"',"video/ogg",'video/ogg; codecs="theora, vorbis"']},{e:"wav",m:["audio/wave","audio/wav",'audio/wav; codecs="1"',"audio/x-wav","audio/x-pn-wav"]},{e:"webm",m:["audio/webm",'audio/webm; codecs="vorbis"',"video/webm"]}],
e,d,j=0,f=b.length;j<f;j++)if(d=b[j].e,b[j].m.length&&"object"===typeof b[j].m)for(var p=0,l=b[j].m.length;p<l;p++)if(e=b[j].m[p],""!==c.canPlayType(e)){this.codecs[d]=e;break}else this.codecs[d]||(this.codecs[d]=!1);this.features.html5audio=!(!this.codecs.mp3&&!this.codecs.ogg&&!this.codecs.webm&&!this.codecs.wav);this.features.channels=8;c.volume=0.1337;this.features.volume=!!(1E-4>Math.abs(c.volume-0.1337));navigator.userAgent.match(/iPhone|iPod|iPad/i)&&(this.features.channels=1)}this.features.flashaudio=
!!navigator.mimeTypes["application/x-shockwave-flash"]||!!navigator.plugins["Shockwave Flash"]||!1;if(window.ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash.10"),this.features.flashaudio=!0}catch(g){}!0===this.settings.useFlash&&(this.features.flashaudio=!0);!0===this.features.flashaudio&&!this.features.html5audio&&(this.codecs.mp3="audio/mp3",this.codecs.mpga="audio/mpeg",this.codecs.mp4="audio/mp4",this.codecs.m4a="audio/mp4",this.codecs["3gp"]="audio/3gpp",this.codecs.amr="audio/amr",
this.features.volume=!0,this.features.channels=1)},__getPlayerById:function(c){return this.__players&&void 0!==this.__players[c]?this.__players[c]:null},__getClone:function(c,b){for(var e in this.__clones){var d=this.__clones[e];if(null===d.isPlaying&&d.origin===c)return d}if("[object Object]"===Object.prototype.toString.call(b)){e={};for(var j in b)e[j]=b[j];e.autoplay=!1;j=new jukebox.Player(e,c);j.isClone=!0;j.wasReady=!1;return this.__clones[j.id]=j}return null},loop:function(){if(0!==this.__playersLength)if(this.__queue.length&&
this.__playersLength<this.features.channels){var c=this.__queue[0],b=this.__getPlayerById(c.origin);if(null!==b){var e=this.__getClone(c.origin,b.settings);null!==e&&(!0===this.features.volume&&(b=this.__players[c.origin])&&e.setVolume(b.getVolume()),this.add(e),e.play(c.pointer,!0))}this.__queue.splice(0,1)}else for(e in this.__queue.length&&1===this.features.channels&&(c=this.__queue[0],b=this.__getPlayerById(c.origin),null!==b&&b.play(c.pointer,!0),this.__queue.splice(0,1)),this.__players)c=this.__players[e],
b=c.getCurrentTime()||0,c.isPlaying&&!1===c.wasReady?c.wasReady=c.setCurrentTime(c.isPlaying.start):c.isPlaying&&!0===c.wasReady?b>c.isPlaying.end&&(!0===c.isPlaying.loop?c.play(c.isPlaying.start,!0):c.stop()):c.isClone&&null===c.isPlaying?this.remove(c):void 0!==c.backgroundMusic&&null===c.isPlaying&&b>c.backgroundMusic.end&&c.backgroundHackForiOS()},getPlayableResource:function(c){"[object Array]"!==Object.prototype.toString.call(c)&&(c=[c]);for(var b=0,e=c.length;b<e;b++){var d=c[b],j=d.match(/\.([^\.]*)$/)[1];
if(j&&this.codecs[j])return d}return null},add:function(c){return c instanceof jukebox.Player&&void 0===this.__players[c.id]?(this.__playersLength++,this.__players[c.id]=c,!0):!1},remove:function(c){return c instanceof jukebox.Player&&void 0!==this.__players[c.id]?(this.__playersLength--,delete this.__players[c.id],!0):!1},addToQueue:function(c,b){return("string"===typeof c||"number"===typeof c)&&void 0!==this.__players[b]?(this.__queue.push({pointer:c,origin:b}),!0):!1}};(function(){var c=function(){this.init()};c.prototype={init:function(){var c=this||b;c._counter=1E3;c._html5AudioPool=[];c.html5PoolSize=10;c._codecs={};c._howls=[];c._muted=!1;c._volume=1;c._canPlayEvent="canplaythrough";c._navigator="undefined"!==typeof window&&window.navigator?window.navigator:null;c.masterGain=null;c.noAudio=!1;c.usingWebAudio=!0;c.autoSuspend=!1;c.ctx=null;c.autoUnlock=!0;c._setup();return c},volume:function(c){var d=this||b;c=parseFloat(c);d.ctx||l();if("undefined"!==typeof c&&
0<=c&&1>=c){d._volume=c;if(d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(c,b.ctx.currentTime);for(var e=0;e<d._howls.length;e++)if(!d._howls[e]._webAudio)for(var f=d._howls[e]._getSoundIds(),j=0;j<f.length;j++){var p=d._howls[e]._soundById(f[j]);p&&p._node&&(p._node.volume=p._volume*c)}return d}return d._volume},mute:function(c){var d=this||b;d.ctx||l();d._muted=c;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(c?0:d._volume,b.ctx.currentTime);for(var e=0;e<d._howls.length;e++)if(!d._howls[e]._webAudio)for(var f=
d._howls[e]._getSoundIds(),j=0;j<f.length;j++){var p=d._howls[e]._soundById(f[j]);p&&p._node&&(p._node.muted=c?!0:p._muted)}return d},stop:function(){for(var c=this||b,d=0;d<c._howls.length;d++)c._howls[d].stop();return c},unload:function(){for(var c=this||b,d=c._howls.length-1;0<=d;d--)c._howls[d].unload();c.usingWebAudio&&(c.ctx&&"undefined"!==typeof c.ctx.close)&&(c.ctx.close(),c.ctx=null,l());return c},codecs:function(c){return(this||b)._codecs[c.replace(/^x-/,"")]},_setup:function(){var c=this||
b;c.state=c.ctx?c.ctx.state||"suspended":"suspended";c._autoSuspend();if(!c.usingWebAudio)if("undefined"!==typeof Audio)try{var d=new Audio;"undefined"===typeof d.oncanplaythrough&&(c._canPlayEvent="canplay")}catch(e){c.noAudio=!0}else c.noAudio=!0;try{d=new Audio,d.muted&&(c.noAudio=!0)}catch(f){}c.noAudio||c._setupCodecs();return c},_setupCodecs:function(){var c=this||b,d=null;try{d="undefined"!==typeof Audio?new Audio:null}catch(e){return c}if(!d||"function"!==typeof d.canPlayType)return c;var f=
d.canPlayType("audio/mpeg;").replace(/^no$/,""),j=c._navigator&&c._navigator.userAgent.match(/OPR\/([0-6].)/g),j=j&&33>parseInt(j[0].split("/")[1],10);c._codecs={mp3:!(j||!f&&!d.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!f,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!d.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),
aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(d.canPlayType("audio/x-m4b;")||d.canPlayType("audio/m4b;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,
""),webm:!!d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")};return c},_unlockAudio:function(){var c=this||b;if(!c._audioUnlocked&&c.ctx){c._audioUnlocked=!1;c.autoUnlock=!1;!c._mobileUnloaded&&44100!==c.ctx.sampleRate&&(c._mobileUnloaded=!0,c.unload());c._scratchBuffer=c.ctx.createBuffer(1,1,22050);var d=function(){for(;c._html5AudioPool.length<
c.html5PoolSize;)try{var b=new Audio;b._unlocked=!0;c._releaseHtml5Audio(b)}catch(e){c.noAudio=!0;break}for(b=0;b<c._howls.length;b++)if(!c._howls[b]._webAudio)for(var f=c._howls[b]._getSoundIds(),j=0;j<f.length;j++){var l=c._howls[b]._soundById(f[j]);l&&(l._node&&!l._node._unlocked)&&(l._node._unlocked=!0,l._node.load())}c._autoResume();var p=c.ctx.createBufferSource();p.buffer=c._scratchBuffer;p.connect(c.ctx.destination);"undefined"===typeof p.start?p.noteOn(0):p.start(0);"function"===typeof c.ctx.resume&&
c.ctx.resume();p.onended=function(){p.disconnect(0);c._audioUnlocked=!0;document.removeEventListener("touchstart",d,!0);document.removeEventListener("touchend",d,!0);document.removeEventListener("click",d,!0);for(var b=0;b<c._howls.length;b++)c._howls[b]._emit("unlock")}};document.addEventListener("touchstart",d,!0);document.addEventListener("touchend",d,!0);document.addEventListener("click",d,!0);return c}},_obtainHtml5Audio:function(){var c=this||b;if(c._html5AudioPool.length)return c._html5AudioPool.pop();
(c=(new Audio).play())&&("undefined"!==typeof Promise&&(c instanceof Promise||"function"===typeof c.then))&&c.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")});return new Audio},_releaseHtml5Audio:function(c){var d=this||b;c._unlocked&&d._html5AudioPool.push(c);return d},_autoSuspend:function(){var c=this;if(c.autoSuspend&&c.ctx&&"undefined"!==typeof c.ctx.suspend&&b.usingWebAudio){for(var d=0;d<c._howls.length;d++)if(c._howls[d]._webAudio)for(var e=
0;e<c._howls[d]._sounds.length;e++)if(!c._howls[d]._sounds[e]._paused)return c;c._suspendTimer&&clearTimeout(c._suspendTimer);c._suspendTimer=setTimeout(function(){if(c.autoSuspend){c._suspendTimer=null;c.state="suspending";var b=function(){c.state="suspended";c._resumeAfterSuspend&&(delete c._resumeAfterSuspend,c._autoResume())};c.ctx.suspend().then(b,b)}},3E4);return c}},_autoResume:function(){var c=this;if(c.ctx&&"undefined"!==typeof c.ctx.resume&&b.usingWebAudio)return"running"===c.state&&"interrupted"!==
c.ctx.state&&c._suspendTimer?(clearTimeout(c._suspendTimer),c._suspendTimer=null):"suspended"===c.state||"running"===c.state&&"interrupted"===c.ctx.state?(c.ctx.resume().then(function(){c.state="running";for(var b=0;b<c._howls.length;b++)c._howls[b]._emit("resume")}),c._suspendTimer&&(clearTimeout(c._suspendTimer),c._suspendTimer=null)):"suspending"===c.state&&(c._resumeAfterSuspend=!0),c}};var b=new c,e=function(b){!b.src||0===b.src.length?console.error("An array of source files must be passed with any new Howl."):
this.init(b)};e.prototype={init:function(c){var d=this;b.ctx||l();d._autoplay=c.autoplay||!1;d._format="string"!==typeof c.format?c.format:[c.format];d._html5=c.html5||!1;d._muted=c.mute||!1;d._loop=c.loop||!1;d._pool=c.pool||5;d._preload="boolean"===typeof c.preload||"metadata"===c.preload?c.preload:!0;d._rate=c.rate||1;d._sprite=c.sprite||{};d._src="string"!==typeof c.src?c.src:[c.src];d._volume=void 0!==c.volume?c.volume:1;d._xhr={method:c.xhr&&c.xhr.method?c.xhr.method:"GET",headers:c.xhr&&c.xhr.headers?
c.xhr.headers:null,withCredentials:c.xhr&&c.xhr.withCredentials?c.xhr.withCredentials:!1};d._duration=0;d._state="unloaded";d._sounds=[];d._endTimers={};d._queue=[];d._playLock=!1;d._onend=c.onend?[{fn:c.onend}]:[];d._onfade=c.onfade?[{fn:c.onfade}]:[];d._onload=c.onload?[{fn:c.onload}]:[];d._onloaderror=c.onloaderror?[{fn:c.onloaderror}]:[];d._onplayerror=c.onplayerror?[{fn:c.onplayerror}]:[];d._onpause=c.onpause?[{fn:c.onpause}]:[];d._onplay=c.onplay?[{fn:c.onplay}]:[];d._onstop=c.onstop?[{fn:c.onstop}]:
[];d._onmute=c.onmute?[{fn:c.onmute}]:[];d._onvolume=c.onvolume?[{fn:c.onvolume}]:[];d._onrate=c.onrate?[{fn:c.onrate}]:[];d._onseek=c.onseek?[{fn:c.onseek}]:[];d._onunlock=c.onunlock?[{fn:c.onunlock}]:[];d._onresume=[];d._webAudio=b.usingWebAudio&&!d._html5;"undefined"!==typeof b.ctx&&(b.ctx&&b.autoUnlock)&&b._unlockAudio();b._howls.push(d);d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}});d._preload&&"none"!==d._preload&&d.load();return d},load:function(){var c=null;if(b.noAudio)this._emit("loaderror",
null,"No audio support.");else{"string"===typeof this._src&&(this._src=[this._src]);for(var e=0;e<this._src.length;e++){var n,l;if(this._format&&this._format[e])n=this._format[e];else{l=this._src[e];if("string"!==typeof l){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(n=/^data:audio\/([^;,]+);/i.exec(l))||(n=/\.([^.]+)$/.exec(l.split("?",1)[0]));n&&(n=n[1].toLowerCase())}n||console.warn('No file extension was found. Consider using the "format" property or specify an extension.');
if(n&&b.codecs(n)){c=this._src[e];break}}if(c){this._src=c;this._state="loading";"https:"===window.location.protocol&&"http:"===c.slice(0,5)&&(this._html5=!0,this._webAudio=!1);new d(this);if(this._webAudio){var s=this,t=s._src;if(j[t])s._duration=j[t].duration,p(s);else if(/^data:[^;]+;base64,/.test(t)){c=atob(t.split(",")[1]);e=new Uint8Array(c.length);for(n=0;n<c.length;++n)e[n]=c.charCodeAt(n);f(e.buffer,s)}else{var u=new XMLHttpRequest;u.open(s._xhr.method,t,!0);u.withCredentials=s._xhr.withCredentials;
u.responseType="arraybuffer";s._xhr.headers&&Object.keys(s._xhr.headers).forEach(function(b){u.setRequestHeader(b,s._xhr.headers[b])});u.onload=function(){var b=(u.status+"")[0];"0"!==b&&"2"!==b&&"3"!==b?s._emit("loaderror",null,"Failed loading audio file with status: "+u.status+"."):f(u.response,s)};u.onerror=function(){s._webAudio&&(s._html5=!0,s._webAudio=!1,s._sounds=[],delete j[t],s.load())};try{u.send()}catch(v){u.onerror()}}}return this}this._emit("loaderror",null,"No codec support for selected audio sources.")}},
play:function(c,d){var e=this,f=null;if("number"===typeof c)f=c,c=null;else{if("string"===typeof c&&"loaded"===e._state&&!e._sprite[c])return null;if("undefined"===typeof c&&(c="__default",!e._playLock)){for(var j=0,l=0;l<e._sounds.length;l++)e._sounds[l]._paused&&!e._sounds[l]._ended&&(j++,f=e._sounds[l]._id);1===j?c=null:f=null}}var p=f?e._soundById(f):e._inactiveSound();if(!p)return null;f&&!c&&(c=p._sprite||"__default");if("loaded"!==e._state){p._sprite=c;p._ended=!1;var v=p._id;e._queue.push({event:"play",
action:function(){e.play(v)}});return v}if(f&&!p._paused)return d||e._loadQueue("play"),p._id;e._webAudio&&b._autoResume();var z=Math.max(0,0<p._seek?p._seek:e._sprite[c][0]/1E3),x=Math.max(0,(e._sprite[c][0]+e._sprite[c][1])/1E3-z),B=1E3*x/Math.abs(p._rate),A=e._sprite[c][0]/1E3,D=(e._sprite[c][0]+e._sprite[c][1])/1E3;p._sprite=c;p._ended=!1;var I=function(){p._paused=!1;p._seek=z;p._start=A;p._stop=D;p._loop=!(!p._loop&&!e._sprite[c][2])};if(z>=D)e._ended(p);else{var y=p._node;if(e._webAudio)f=
function(){e._playLock=!1;I();e._refreshBuffer(p);y.gain.setValueAtTime(p._muted||e._muted?0:p._volume,b.ctx.currentTime);p._playStart=b.ctx.currentTime;"undefined"===typeof y.bufferSource.start?p._loop?y.bufferSource.noteGrainOn(0,z,86400):y.bufferSource.noteGrainOn(0,z,x):p._loop?y.bufferSource.start(0,z,86400):y.bufferSource.start(0,z,x);Infinity!==B&&(e._endTimers[p._id]=setTimeout(e._ended.bind(e,p),B));d||setTimeout(function(){e._emit("play",p._id);e._loadQueue()},0)},"running"===b.state&&"interrupted"!==
b.ctx.state?f():(e._playLock=!0,e.once("resume",f),e._clearTimer(p._id));else{var C=function(){y.currentTime=z;y.muted=p._muted||e._muted||b._muted||y.muted;y.volume=p._volume*b.volume();y.playbackRate=p._rate;try{var f=y.play();f&&"undefined"!==typeof Promise&&(f instanceof Promise||"function"===typeof f.then)?(e._playLock=!0,I(),f.then(function(){e._playLock=!1;y._unlocked=!0;d||(e._emit("play",p._id),e._loadQueue())}).catch(function(){e._playLock=!1;e._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");
p._ended=!0;p._paused=!0})):d||(e._playLock=!1,I(),e._emit("play",p._id),e._loadQueue());y.playbackRate=p._rate;y.paused?e._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."):"__default"!==c||p._loop?e._endTimers[p._id]=setTimeout(e._ended.bind(e,p),B):(e._endTimers[p._id]=function(){e._ended(p);y.removeEventListener("ended",e._endTimers[p._id],!1)},y.addEventListener("ended",e._endTimers[p._id],
!1))}catch(j){e._emit("playerror",p._id,j)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===y.src&&(y.src=e._src,y.load());f=window&&window.ejecta||!y.readyState&&b._navigator.isCocoonJS;if(3<=y.readyState||f)C();else{e._playLock=!0;var J=function(){C();y.removeEventListener(b._canPlayEvent,J,!1)};y.addEventListener(b._canPlayEvent,J,!1);e._clearTimer(p._id)}}return p._id}},pause:function(b,c){var d=this;if("loaded"!==d._state||d._playLock)return d._queue.push({event:"pause",
action:function(){d.pause(b)}}),d;for(var e=d._getSoundIds(b),f=0;f<e.length;f++){d._clearTimer(e[f]);var j=d._soundById(e[f]);if(j&&!j._paused&&(j._seek=d.seek(e[f]),j._rateSeek=0,j._paused=!0,d._stopFade(e[f]),j._node))if(d._webAudio){if(!j._node.bufferSource)continue;"undefined"===typeof j._node.bufferSource.stop?j._node.bufferSource.noteOff(0):j._node.bufferSource.stop(0);d._cleanBuffer(j._node)}else(!isNaN(j._node.duration)||Infinity===j._node.duration)&&j._node.pause();c||d._emit("pause",j?
j._id:null)}return d},stop:function(b,c){var d=this;if("loaded"!==d._state||d._playLock)return d._queue.push({event:"stop",action:function(){d.stop(b)}}),d;for(var e=d._getSoundIds(b),f=0;f<e.length;f++){d._clearTimer(e[f]);var j=d._soundById(e[f]);if(j){j._seek=j._start||0;j._rateSeek=0;j._paused=!0;j._ended=!0;d._stopFade(e[f]);if(j._node)if(d._webAudio)j._node.bufferSource&&("undefined"===typeof j._node.bufferSource.stop?j._node.bufferSource.noteOff(0):j._node.bufferSource.stop(0),d._cleanBuffer(j._node));
else if(!isNaN(j._node.duration)||Infinity===j._node.duration)j._node.currentTime=j._start||0,j._node.pause(),Infinity===j._node.duration&&d._clearSound(j._node);c||d._emit("stop",j._id)}}return d},mute:function(c,d){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"mute",action:function(){e.mute(c,d)}}),e;if("undefined"===typeof d)if("boolean"===typeof c)e._muted=c;else return e._muted;for(var f=e._getSoundIds(d),j=0;j<f.length;j++){var l=e._soundById(f[j]);l&&(l._muted=
c,l._interval&&e._stopFade(l._id),e._webAudio&&l._node?l._node.gain.setValueAtTime(c?0:l._volume,b.ctx.currentTime):l._node&&(l._node.muted=b._muted?!0:c),e._emit("mute",l._id))}return e},volume:function(){var c=this,d=arguments,e,f;if(0===d.length)return c._volume;1===d.length||2===d.length&&"undefined"===typeof d[1]?0<=c._getSoundIds().indexOf(d[0])?f=parseInt(d[0],10):e=parseFloat(d[0]):2<=d.length&&(e=parseFloat(d[0]),f=parseInt(d[1],10));var j;if("undefined"!==typeof e&&0<=e&&1>=e){if("loaded"!==
c._state||c._playLock)return c._queue.push({event:"volume",action:function(){c.volume.apply(c,d)}}),c;"undefined"===typeof f&&(c._volume=e);f=c._getSoundIds(f);for(var l=0;l<f.length;l++)if(j=c._soundById(f[l]))j._volume=e,d[2]||c._stopFade(f[l]),c._webAudio&&j._node&&!j._muted?j._node.gain.setValueAtTime(e,b.ctx.currentTime):j._node&&!j._muted&&(j._node.volume=e*b.volume()),c._emit("volume",j._id)}else return(j=f?c._soundById(f):c._sounds[0])?j._volume:0;return c},fade:function(c,d,e,f){var j=this;
if("loaded"!==j._state||j._playLock)return j._queue.push({event:"fade",action:function(){j.fade(c,d,e,f)}}),j;c=Math.min(Math.max(0,parseFloat(c)),1);d=Math.min(Math.max(0,parseFloat(d)),1);e=parseFloat(e);j.volume(c,f);for(var l=j._getSoundIds(f),p=0;p<l.length;p++){var v=j._soundById(l[p]);if(v){f||j._stopFade(l[p]);if(j._webAudio&&!v._muted){var z=b.ctx.currentTime,x=z+e/1E3;v._volume=c;v._node.gain.setValueAtTime(c,z);v._node.gain.linearRampToValueAtTime(d,x)}j._startFadeInterval(v,c,d,e,l[p],
"undefined"===typeof f)}}return j},_startFadeInterval:function(b,c,d,e,f,j){var l=this,p=c,z=d-c;f=Math.abs(z/0.01);f=Math.max(4,0<f?e/f:e);var x=Date.now();b._fadeTo=d;b._interval=setInterval(function(){var f=(Date.now()-x)/e;x=Date.now();p+=z*f;p=0>z?Math.max(d,p):Math.min(d,p);p=Math.round(100*p)/100;l._webAudio?b._volume=p:l.volume(p,b._id,!0);j&&(l._volume=p);if(d<c&&p<=d||d>c&&p>=d)clearInterval(b._interval),b._interval=null,b._fadeTo=null,l.volume(d,b._id),l._emit("fade",b._id)},f)},_stopFade:function(c){var d=
this._soundById(c);d&&d._interval&&(this._webAudio&&d._node.gain.cancelScheduledValues(b.ctx.currentTime),clearInterval(d._interval),d._interval=null,this.volume(d._fadeTo,c),d._fadeTo=null,this._emit("fade",c));return this},loop:function(){var b=arguments,c,d;if(0===b.length)return this._loop;if(1===b.length)if("boolean"===typeof b[0])this._loop=c=b[0];else return(b=this._soundById(parseInt(b[0],10)))?b._loop:!1;else 2===b.length&&(c=b[0],d=parseInt(b[1],10));d=this._getSoundIds(d);for(var e=0;e<
d.length;e++)if(b=this._soundById(d[e]))if(b._loop=c,this._webAudio&&(b._node&&b._node.bufferSource)&&(b._node.bufferSource.loop=c))b._node.bufferSource.loopStart=b._start||0,b._node.bufferSource.loopEnd=b._stop;return this},rate:function(){var c=this,d=arguments,e,f;0===d.length?f=c._sounds[0]._id:1===d.length?0<=c._getSoundIds().indexOf(d[0])?f=parseInt(d[0],10):e=parseFloat(d[0]):2===d.length&&(e=parseFloat(d[0]),f=parseInt(d[1],10));var j;if("number"===typeof e){if("loaded"!==c._state||c._playLock)return c._queue.push({event:"rate",
action:function(){c.rate.apply(c,d)}}),c;"undefined"===typeof f&&(c._rate=e);f=c._getSoundIds(f);for(var l=0;l<f.length;l++)if(j=c._soundById(f[l])){c.playing(f[l])&&(j._rateSeek=c.seek(f[l]),j._playStart=c._webAudio?b.ctx.currentTime:j._playStart);j._rate=e;c._webAudio&&j._node&&j._node.bufferSource?j._node.bufferSource.playbackRate.setValueAtTime(e,b.ctx.currentTime):j._node&&(j._node.playbackRate=e);var p=c.seek(f[l]),p=1E3*((c._sprite[j._sprite][0]+c._sprite[j._sprite][1])/1E3-p)/Math.abs(j._rate);
if(c._endTimers[f[l]]||!j._paused)c._clearTimer(f[l]),c._endTimers[f[l]]=setTimeout(c._ended.bind(c,j),p);c._emit("rate",j._id)}}else return(j=c._soundById(f))?j._rate:c._rate;return c},seek:function(){var c=this,d=arguments,e,f;0===d.length?f=c._sounds[0]._id:1===d.length?0<=c._getSoundIds().indexOf(d[0])?f=parseInt(d[0],10):c._sounds.length&&(f=c._sounds[0]._id,e=parseFloat(d[0])):2===d.length&&(e=parseFloat(d[0]),f=parseInt(d[1],10));if("undefined"===typeof f)return c;if("loaded"!==c._state||c._playLock)return c._queue.push({event:"seek",
action:function(){c.seek.apply(c,d)}}),c;var j=c._soundById(f);if(j)if("number"===typeof e&&0<=e){var l=c.playing(f);l&&c.pause(f,!0);j._seek=e;j._ended=!1;c._clearTimer(f);!c._webAudio&&(j._node&&!isNaN(j._node.duration))&&(j._node.currentTime=e);var p=function(){c._emit("seek",f);l&&c.play(f,!0)};if(l&&!c._webAudio){var v=function(){c._playLock?setTimeout(v,0):p()};setTimeout(v,0)}else p()}else return c._webAudio?(e=c.playing(f)?b.ctx.currentTime-j._playStart:0,j._seek+((j._rateSeek?j._rateSeek-
j._seek:0)+e*Math.abs(j._rate))):j._node.currentTime;return c},playing:function(b){if("number"===typeof b)return(b=this._soundById(b))?!b._paused:!1;for(b=0;b<this._sounds.length;b++)if(!this._sounds[b]._paused)return!0;return!1},duration:function(b){var c=this._duration;(b=this._soundById(b))&&(c=this._sprite[b._sprite][1]/1E3);return c},state:function(){return this._state},unload:function(){for(var c=this._sounds,d=0;d<c.length;d++)c[d]._paused||this.stop(c[d]._id),this._webAudio||(this._clearSound(c[d]._node),
c[d]._node.removeEventListener("error",c[d]._errorFn,!1),c[d]._node.removeEventListener(b._canPlayEvent,c[d]._loadFn,!1),b._releaseHtml5Audio(c[d]._node)),delete c[d]._node,this._clearTimer(c[d]._id);d=b._howls.indexOf(this);0<=d&&b._howls.splice(d,1);c=!0;for(d=0;d<b._howls.length;d++)if(b._howls[d]._src===this._src||0<=this._src.indexOf(b._howls[d]._src)){c=!1;break}j&&c&&delete j[this._src];b.noAudio=!1;this._state="unloaded";this._sounds=[];return null},on:function(b,c,d,e){b=this["_on"+b];"function"===
typeof c&&b.push(e?{id:d,fn:c,once:e}:{id:d,fn:c});return this},off:function(b,c,d){var e=this["_on"+b],f=0;"number"===typeof c&&(d=c,c=null);if(c||d)for(f=0;f<e.length;f++){if(b=d===e[f].id,c===e[f].fn&&b||!c&&b){e.splice(f,1);break}}else if(b)this["_on"+b]=[];else{c=Object.keys(this);for(f=0;f<c.length;f++)0===c[f].indexOf("_on")&&Array.isArray(this[c[f]])&&(this[c[f]]=[])}return this},once:function(b,c,d){this.on(b,c,d,1);return this},_emit:function(b,c,d){for(var e=this["_on"+b],f=e.length-1;0<=
f;f--)if(!e[f].id||e[f].id===c||"load"===b)setTimeout(function(b){b.call(this,c,d)}.bind(this,e[f].fn),0),e[f].once&&this.off(b,e[f].fn,e[f].id);this._loadQueue(b);return this},_loadQueue:function(b){if(0<this._queue.length){var c=this._queue[0];c.event===b&&(this._queue.shift(),this._loadQueue());b||c.action()}return this},_ended:function(c){var d=c._sprite;if(!this._webAudio&&c._node&&!c._node.paused&&!c._node.ended&&c._node.currentTime<c._stop)return setTimeout(this._ended.bind(this,c),100),this;
d=!(!c._loop&&!this._sprite[d][2]);this._emit("end",c._id);!this._webAudio&&d&&this.stop(c._id,!0).play(c._id);if(this._webAudio&&d){this._emit("play",c._id);c._seek=c._start||0;c._rateSeek=0;c._playStart=b.ctx.currentTime;var e=1E3*(c._stop-c._start)/Math.abs(c._rate);this._endTimers[c._id]=setTimeout(this._ended.bind(this,c),e)}this._webAudio&&!d&&(c._paused=!0,c._ended=!0,c._seek=c._start||0,c._rateSeek=0,this._clearTimer(c._id),this._cleanBuffer(c._node),b._autoSuspend());!this._webAudio&&!d&&
this.stop(c._id,!0);return this},_clearTimer:function(b){if(this._endTimers[b]){if("function"!==typeof this._endTimers[b])clearTimeout(this._endTimers[b]);else{var c=this._soundById(b);c&&c._node&&c._node.removeEventListener("ended",this._endTimers[b],!1)}delete this._endTimers[b]}return this},_soundById:function(b){for(var c=0;c<this._sounds.length;c++)if(b===this._sounds[c]._id)return this._sounds[c];return null},_inactiveSound:function(){this._drain();for(var b=0;b<this._sounds.length;b++)if(this._sounds[b]._ended)return this._sounds[b].reset();
return new d(this)},_drain:function(){var b=this._pool,c=0,d=0;if(!(this._sounds.length<b)){for(d=0;d<this._sounds.length;d++)this._sounds[d]._ended&&c++;for(d=this._sounds.length-1;0<=d&&!(c<=b);d--)this._sounds[d]._ended&&(this._webAudio&&this._sounds[d]._node&&this._sounds[d]._node.disconnect(0),this._sounds.splice(d,1),c--)}},_getSoundIds:function(b){if("undefined"===typeof b){b=[];for(var c=0;c<this._sounds.length;c++)b.push(this._sounds[c]._id);return b}return[b]},_refreshBuffer:function(c){c._node.bufferSource=
b.ctx.createBufferSource();c._node.bufferSource.buffer=j[this._src];c._panner?c._node.bufferSource.connect(c._panner):c._node.bufferSource.connect(c._node);if(c._node.bufferSource.loop=c._loop)c._node.bufferSource.loopStart=c._start||0,c._node.bufferSource.loopEnd=c._stop||0;c._node.bufferSource.playbackRate.setValueAtTime(c._rate,b.ctx.currentTime);return this},_cleanBuffer:function(c){var d=b._navigator&&0<=b._navigator.vendor.indexOf("Apple");if(b._scratchBuffer&&c.bufferSource&&(c.bufferSource.onended=
null,c.bufferSource.disconnect(0),d))try{c.bufferSource.buffer=b._scratchBuffer}catch(e){}c.bufferSource=null;return this},_clearSound:function(c){/MSIE |Trident\//.test(b._navigator&&b._navigator.userAgent)||(c.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var d=function(b){this._parent=b;this.init()};d.prototype={init:function(){var c=this._parent;this._muted=c._muted;this._loop=c._loop;this._volume=c._volume;this._rate=c._rate;this._seek=0;this._ended=
this._paused=!0;this._sprite="__default";this._id=++b._counter;c._sounds.push(this);this.create();return this},create:function(){var c=this._parent,d=b._muted||this._muted||this._parent._muted?0:this._volume;c._webAudio?(this._node="undefined"===typeof b.ctx.createGain?b.ctx.createGainNode():b.ctx.createGain(),this._node.gain.setValueAtTime(d,b.ctx.currentTime),this._node.paused=!0,this._node.connect(b.masterGain)):b.noAudio||(this._node=b._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),
this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(b._canPlayEvent,this._loadFn,!1),this._node.src=c._src,this._node.preload=!0===c._preload?"auto":c._preload,this._node.volume=d*b.volume(),this._node.load());return this},reset:function(){var c=this._parent;this._muted=c._muted;this._loop=c._loop;this._volume=c._volume;this._rate=c._rate;this._rateSeek=this._seek=0;this._ended=this._paused=!0;this._sprite="__default";this._id=
++b._counter;return this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0);this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var c=this._parent;c._duration=Math.ceil(10*this._node.duration)/10;0===Object.keys(c._sprite).length&&(c._sprite={__default:[0,1E3*c._duration]});"loaded"!==c._state&&(c._state="loaded",c._emit("load"),c._loadQueue());this._node.removeEventListener(b._canPlayEvent,this._loadFn,!1)}};
var j={},f=function(c,d){var e=function(){d._emit("loaderror",null,"Decoding audio data failed.")},f=function(b){b&&0<d._sounds.length?(j[d._src]=b,p(d,b)):e()};"undefined"!==typeof Promise&&1===b.ctx.decodeAudioData.length?b.ctx.decodeAudioData(c).then(f).catch(e):b.ctx.decodeAudioData(c,f,e)},p=function(b,c){c&&!b._duration&&(b._duration=c.duration);0===Object.keys(b._sprite).length&&(b._sprite={__default:[0,1E3*b._duration]});"loaded"!==b._state&&(b._state="loaded",b._emit("load"),b._loadQueue())},
l=function(){if(b.usingWebAudio){try{"undefined"!==typeof AudioContext?b.ctx=new AudioContext:"undefined"!==typeof webkitAudioContext?b.ctx=new webkitAudioContext:b.usingWebAudio=!1}catch(c){b.usingWebAudio=!1}b.ctx||(b.usingWebAudio=!1);var d=/iP(hone|od|ad)/.test(b._navigator&&b._navigator.platform),e=b._navigator&&b._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),e=e?parseInt(e[1],10):null;d&&(e&&9>e)&&(d=/safari/.test(b._navigator&&b._navigator.userAgent.toLowerCase()),b._navigator&&!d&&
(b.usingWebAudio=!1));b.usingWebAudio&&(b.masterGain="undefined"===typeof b.ctx.createGain?b.ctx.createGainNode():b.ctx.createGain(),b.masterGain.gain.setValueAtTime(b._muted?0:b._volume,b.ctx.currentTime),b.masterGain.connect(b.ctx.destination));b._setup()}};"function"===typeof define&&define.amd&&define([],function(){return{Howler:b,Howl:e}});"undefined"!==typeof exports&&(exports.Howler=b,exports.Howl=e);"undefined"!==typeof global?(global.HowlerGlobal=c,global.Howler=b,global.Howl=e,global.Sound=
d):"undefined"!==typeof window&&(window.HowlerGlobal=c,window.Howler=b,window.Howl=e,window.Sound=d)})();
(function(){HowlerGlobal.prototype._pos=[0,0,0];HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0];HowlerGlobal.prototype.stereo=function(b){if(!this.ctx||!this.ctx.listener)return this;for(var c=this._howls.length-1;0<=c;c--)this._howls[c].stereo(b);return this};HowlerGlobal.prototype.pos=function(b,c,d){if(!this.ctx||!this.ctx.listener)return this;c="number"!==typeof c?this._pos[1]:c;d="number"!==typeof d?this._pos[2]:d;if("number"===typeof b)this._pos=[b,c,d],"undefined"!==typeof this.ctx.listener.positionX?
(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,0.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,0.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,0.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]);else return this._pos;return this};HowlerGlobal.prototype.orientation=function(b,c,d,e,g,m){if(!this.ctx||!this.ctx.listener)return this;var n=this._orientation;c="number"!==
typeof c?n[1]:c;d="number"!==typeof d?n[2]:d;e="number"!==typeof e?n[3]:e;g="number"!==typeof g?n[4]:g;m="number"!==typeof m?n[5]:m;if("number"===typeof b)this._orientation=[b,c,d,e,g,m],"undefined"!==typeof this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(b,Howler.ctx.currentTime,0.1),this.ctx.listener.forwardY.setTargetAtTime(c,Howler.ctx.currentTime,0.1),this.ctx.listener.forwardZ.setTargetAtTime(d,Howler.ctx.currentTime,0.1),this.ctx.listener.upX.setTargetAtTime(e,Howler.ctx.currentTime,
0.1),this.ctx.listener.upY.setTargetAtTime(g,Howler.ctx.currentTime,0.1),this.ctx.listener.upZ.setTargetAtTime(m,Howler.ctx.currentTime,0.1)):this.ctx.listener.setOrientation(b,c,d,e,g,m);else return n;return this};var c=Howl.prototype.init;Howl.prototype.init=function(b){this._orientation=b.orientation||[1,0,0];this._stereo=b.stereo||null;this._pos=b.pos||null;this._pannerAttr={coneInnerAngle:"undefined"!==typeof b.coneInnerAngle?b.coneInnerAngle:360,coneOuterAngle:"undefined"!==typeof b.coneOuterAngle?
b.coneOuterAngle:360,coneOuterGain:"undefined"!==typeof b.coneOuterGain?b.coneOuterGain:0,distanceModel:"undefined"!==typeof b.distanceModel?b.distanceModel:"inverse",maxDistance:"undefined"!==typeof b.maxDistance?b.maxDistance:1E4,panningModel:"undefined"!==typeof b.panningModel?b.panningModel:"HRTF",refDistance:"undefined"!==typeof b.refDistance?b.refDistance:1,rolloffFactor:"undefined"!==typeof b.rolloffFactor?b.rolloffFactor:1};this._onstereo=b.onstereo?[{fn:b.onstereo}]:[];this._onpos=b.onpos?
[{fn:b.onpos}]:[];this._onorientation=b.onorientation?[{fn:b.onorientation}]:[];return c.call(this,b)};Howl.prototype.stereo=function(b,c){var e=this;if(!e._webAudio)return e;if("loaded"!==e._state)return e._queue.push({event:"stereo",action:function(){e.stereo(b,c)}}),e;var l="undefined"===typeof Howler.ctx.createStereoPanner?"spatial":"stereo";if("undefined"===typeof c)if("number"===typeof b)e._stereo=b,e._pos=[b,0,0];else return e._stereo;for(var g=e._getSoundIds(c),m=0;m<g.length;m++){var n=e._soundById(g[m]);
if(n)if("number"===typeof b)n._stereo=b,n._pos=[b,0,0],n._node&&(n._pannerAttr.panningModel="equalpower",(!n._panner||!n._panner.pan)&&d(n,l),"spatial"===l?"undefined"!==typeof n._panner.positionX?(n._panner.positionX.setValueAtTime(b,Howler.ctx.currentTime),n._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),n._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):n._panner.setPosition(b,0,0):n._panner.pan.setValueAtTime(b,Howler.ctx.currentTime)),e._emit("stereo",n._id);else return n._stereo}return e};
Howl.prototype.pos=function(b,c,e,l){var g=this;if(!g._webAudio)return g;if("loaded"!==g._state)return g._queue.push({event:"pos",action:function(){g.pos(b,c,e,l)}}),g;c="number"!==typeof c?0:c;e="number"!==typeof e?-0.5:e;if("undefined"===typeof l)if("number"===typeof b)g._pos=[b,c,e];else return g._pos;for(var m=g._getSoundIds(l),n=0;n<m.length;n++){var r=g._soundById(m[n]);if(r)if("number"===typeof b)r._pos=[b,c,e],r._node&&((!r._panner||r._panner.pan)&&d(r,"spatial"),"undefined"!==typeof r._panner.positionX?
(r._panner.positionX.setValueAtTime(b,Howler.ctx.currentTime),r._panner.positionY.setValueAtTime(c,Howler.ctx.currentTime),r._panner.positionZ.setValueAtTime(e,Howler.ctx.currentTime)):r._panner.setPosition(b,c,e)),g._emit("pos",r._id);else return r._pos}return g};Howl.prototype.orientation=function(b,c,e,l){var g=this;if(!g._webAudio)return g;if("loaded"!==g._state)return g._queue.push({event:"orientation",action:function(){g.orientation(b,c,e,l)}}),g;c="number"!==typeof c?g._orientation[1]:c;e=
"number"!==typeof e?g._orientation[2]:e;if("undefined"===typeof l)if("number"===typeof b)g._orientation=[b,c,e];else return g._orientation;for(var m=g._getSoundIds(l),n=0;n<m.length;n++){var r=g._soundById(m[n]);if(r)if("number"===typeof b)r._orientation=[b,c,e],r._node&&(r._panner||(r._pos||(r._pos=g._pos||[0,0,-0.5]),d(r,"spatial")),"undefined"!==typeof r._panner.orientationX?(r._panner.orientationX.setValueAtTime(b,Howler.ctx.currentTime),r._panner.orientationY.setValueAtTime(c,Howler.ctx.currentTime),
r._panner.orientationZ.setValueAtTime(e,Howler.ctx.currentTime)):r._panner.setOrientation(b,c,e)),g._emit("orientation",r._id);else return r._orientation}return g};Howl.prototype.pannerAttr=function(){var b=arguments,c,e;if(!this._webAudio)return this;if(0===b.length)return this._pannerAttr;if(1===b.length)if("object"===typeof b[0])c=b[0],"undefined"===typeof e&&(c.pannerAttr||(c.pannerAttr={coneInnerAngle:c.coneInnerAngle,coneOuterAngle:c.coneOuterAngle,coneOuterGain:c.coneOuterGain,distanceModel:c.distanceModel,
maxDistance:c.maxDistance,refDistance:c.refDistance,rolloffFactor:c.rolloffFactor,panningModel:c.panningModel}),this._pannerAttr={coneInnerAngle:"undefined"!==typeof c.pannerAttr.coneInnerAngle?c.pannerAttr.coneInnerAngle:this._coneInnerAngle,coneOuterAngle:"undefined"!==typeof c.pannerAttr.coneOuterAngle?c.pannerAttr.coneOuterAngle:this._coneOuterAngle,coneOuterGain:"undefined"!==typeof c.pannerAttr.coneOuterGain?c.pannerAttr.coneOuterGain:this._coneOuterGain,distanceModel:"undefined"!==typeof c.pannerAttr.distanceModel?
c.pannerAttr.distanceModel:this._distanceModel,maxDistance:"undefined"!==typeof c.pannerAttr.maxDistance?c.pannerAttr.maxDistance:this._maxDistance,refDistance:"undefined"!==typeof c.pannerAttr.refDistance?c.pannerAttr.refDistance:this._refDistance,rolloffFactor:"undefined"!==typeof c.pannerAttr.rolloffFactor?c.pannerAttr.rolloffFactor:this._rolloffFactor,panningModel:"undefined"!==typeof c.pannerAttr.panningModel?c.pannerAttr.panningModel:this._panningModel});else return(b=this._soundById(parseInt(b[0],
10)))?b._pannerAttr:this._pannerAttr;else 2===b.length&&(c=b[0],e=parseInt(b[1],10));e=this._getSoundIds(e);for(var l=0;l<e.length;l++)if(b=this._soundById(e[l])){var g=b._pannerAttr,g={coneInnerAngle:"undefined"!==typeof c.coneInnerAngle?c.coneInnerAngle:g.coneInnerAngle,coneOuterAngle:"undefined"!==typeof c.coneOuterAngle?c.coneOuterAngle:g.coneOuterAngle,coneOuterGain:"undefined"!==typeof c.coneOuterGain?c.coneOuterGain:g.coneOuterGain,distanceModel:"undefined"!==typeof c.distanceModel?c.distanceModel:
g.distanceModel,maxDistance:"undefined"!==typeof c.maxDistance?c.maxDistance:g.maxDistance,refDistance:"undefined"!==typeof c.refDistance?c.refDistance:g.refDistance,rolloffFactor:"undefined"!==typeof c.rolloffFactor?c.rolloffFactor:g.rolloffFactor,panningModel:"undefined"!==typeof c.panningModel?c.panningModel:g.panningModel},m=b._panner;m?(m.coneInnerAngle=g.coneInnerAngle,m.coneOuterAngle=g.coneOuterAngle,m.coneOuterGain=g.coneOuterGain,m.distanceModel=g.distanceModel,m.maxDistance=g.maxDistance,
m.refDistance=g.refDistance,m.rolloffFactor=g.rolloffFactor,m.panningModel=g.panningModel):(b._pos||(b._pos=this._pos||[0,0,-0.5]),d(b,"spatial"))}return this};var b=Sound.prototype.init;Sound.prototype.init=function(){var c=this._parent;this._orientation=c._orientation;this._stereo=c._stereo;this._pos=c._pos;this._pannerAttr=c._pannerAttr;b.call(this);this._stereo?c.stereo(this._stereo):this._pos&&c.pos(this._pos[0],this._pos[1],this._pos[2],this._id)};var e=Sound.prototype.reset;Sound.prototype.reset=
function(){var b=this._parent;this._orientation=b._orientation;this._stereo=b._stereo;this._pos=b._pos;this._pannerAttr=b._pannerAttr;this._stereo?b.stereo(this._stereo):this._pos?b.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,b._refreshBuffer(this));return e.call(this)};var d=function(b,c){"spatial"===(c||"spatial")?(b._panner=Howler.ctx.createPanner(),b._panner.coneInnerAngle=b._pannerAttr.coneInnerAngle,b._panner.coneOuterAngle=
b._pannerAttr.coneOuterAngle,b._panner.coneOuterGain=b._pannerAttr.coneOuterGain,b._panner.distanceModel=b._pannerAttr.distanceModel,b._panner.maxDistance=b._pannerAttr.maxDistance,b._panner.refDistance=b._pannerAttr.refDistance,b._panner.rolloffFactor=b._pannerAttr.rolloffFactor,b._panner.panningModel=b._pannerAttr.panningModel,"undefined"!==typeof b._panner.positionX?(b._panner.positionX.setValueAtTime(b._pos[0],Howler.ctx.currentTime),b._panner.positionY.setValueAtTime(b._pos[1],Howler.ctx.currentTime),
b._panner.positionZ.setValueAtTime(b._pos[2],Howler.ctx.currentTime)):b._panner.setPosition(b._pos[0],b._pos[1],b._pos[2]),"undefined"!==typeof b._panner.orientationX?(b._panner.orientationX.setValueAtTime(b._orientation[0],Howler.ctx.currentTime),b._panner.orientationY.setValueAtTime(b._orientation[1],Howler.ctx.currentTime),b._panner.orientationZ.setValueAtTime(b._orientation[2],Howler.ctx.currentTime)):b._panner.setOrientation(b._orientation[0],b._orientation[1],b._orientation[2])):(b._panner=
Howler.ctx.createStereoPanner(),b._panner.pan.setValueAtTime(b._stereo,Howler.ctx.currentTime));b._panner.connect(b._node);b._paused||b._parent.pause(b._id,!0).play(b._id,!0)}})();!function(c,b){"object"==typeof exports&&"undefined"!=typeof module?b():"function"==typeof define&&define.amd?define(b):b()}(0,function(){function c(b){var c=this.constructor;return this.then(function(d){return c.resolve(b()).then(function(){return d})},function(d){return c.resolve(b()).then(function(){return c.reject(d)})})}function b(){}function e(b){if(!(this instanceof e))throw new TypeError("Promises must be constructed via new");if("function"!=typeof b)throw new TypeError("not a function");
this._state=0;this._handled=!1;this._value=void 0;this._deferreds=[];l(b,this)}function d(b,c){for(;3===b._state;)b=b._value;0!==b._state?(b._handled=!0,e._immediateFn(function(){var d=1===b._state?c.onFulfilled:c.onRejected;if(null!==d){var e;try{e=d(b._value)}catch(g){return void f(c.promise,g)}j(c.promise,e)}else(1===b._state?j:f)(c.promise,b._value)})):b._deferreds.push(c)}function j(b,c){try{if(c===b)throw new TypeError("A promise cannot be resolved with itself.");if(c&&("object"==typeof c||
"function"==typeof c)){var d=c.then;if(c instanceof e)return b._state=3,b._value=c,void p(b);if("function"==typeof d)return void l(function(){d.apply(c,arguments)},b)}b._state=1;b._value=c;p(b)}catch(g){f(b,g)}}function f(b,c){b._state=2;b._value=c;p(b)}function p(b){2===b._state&&0===b._deferreds.length&&e._immediateFn(function(){b._handled||e._unhandledRejectionFn(b._value)});for(var c=0,f=b._deferreds.length;f>c;c++)d(b,b._deferreds[c]);b._deferreds=null}function l(b,c){var d=!1;try{b(function(b){d||
(d=!0,j(c,b))},function(b){d||(d=!0,f(c,b))})}catch(e){d||(d=!0,f(c,e))}}var g=setTimeout;e.prototype["catch"]=function(b){return this.then(null,b)};e.prototype.then=function(c,e){var f=new this.constructor(b);return d(this,new function(b,c,d){this.onFulfilled="function"==typeof b?b:null;this.onRejected="function"==typeof c?c:null;this.promise=d}(c,e,f)),f};e.prototype["finally"]=c;e.all=function(b){return new e(function(c,d){function e(b,j){try{if(j&&("object"==typeof j||"function"==typeof j)){var l=
j.then;if("function"==typeof l)return void l.call(j,function(c){e(b,c)},d)}f[b]=j;0==--g&&c(f)}catch(m){d(m)}}if(!b||"undefined"==typeof b.length)throw new TypeError("Promise.all accepts an array");var f=Array.prototype.slice.call(b);if(0===f.length)return c([]);for(var g=f.length,j=0;f.length>j;j++)e(j,f[j])})};e.resolve=function(b){return b&&"object"==typeof b&&b.constructor===e?b:new e(function(c){c(b)})};e.reject=function(b){return new e(function(c,d){d(b)})};e.race=function(b){return new e(function(c,
d){for(var e=0,f=b.length;f>e;e++)b[e].then(c,d)})};e._immediateFn="function"==typeof setImmediate&&function(b){setImmediate(b)}||function(b){g(b,0)};e._unhandledRejectionFn=function(b){void 0!==console&&console&&console.warn("Possible Unhandled Promise Rejection:",b)};var m=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("unable to locate global object");}();"Promise"in m?m.Promise.prototype["finally"]||
(m.Promise.prototype["finally"]=c):m.Promise=e});(function(){function c(b,c){document.addEventListener?b.addEventListener("scroll",c,!1):b.attachEvent("scroll",c)}function b(b){this.a=document.createElement("div");this.a.setAttribute("aria-hidden","true");this.a.appendChild(document.createTextNode(b));this.b=document.createElement("span");this.c=document.createElement("span");this.h=document.createElement("span");this.f=document.createElement("span");this.g=-1;this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";
this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;";this.b.appendChild(this.h);this.c.appendChild(this.f);this.a.appendChild(this.b);this.a.appendChild(this.c)}function e(b,c){b.a.style.cssText=
"max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+c+";"}function d(b){var c=b.a.offsetWidth,d=c+100;b.f.style.width=d+"px";b.c.scrollLeft=d;b.b.scrollLeft=b.b.scrollWidth+100;return b.g!==c?(b.g=c,!0):!1}function j(b,e){function f(){var b=g;d(b)&&b.a.parentNode&&e(b.g)}var g=b;c(b.b,f);c(b.c,f);d(b)}function f(b,c){var d=c||{};this.family=b;this.style=d.style||
"normal";this.weight=d.weight||"normal";this.stretch=d.stretch||"normal"}function p(){null===s&&(s=!!document.fonts);return s}function l(){if(null===r){var b=document.createElement("div");try{b.style.font="condensed 100px sans-serif"}catch(c){}r=""!==b.style.font}return r}function g(b,c){return[b.style,b.weight,l()?b.stretch:"","100px",c].join(" ")}var m=null,n=null,r=null,s=null;f.prototype.load=function(c,d){var f=this,l=c||"BESbswy",r=0,s=d||3E3,A=(new Date).getTime();return new Promise(function(c,
d){var t;if(t=p())null===n&&(p()&&/Apple/.test(window.navigator.vendor)?(t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),n=!!t&&603>parseInt(t[1],10)):n=!1),t=!n;if(t){t=new Promise(function(b,c){function d(){(new Date).getTime()-A>=s?c(Error(""+s+"ms timeout exceeded")):document.fonts.load(g(f,'"'+f.family+'"'),l).then(function(c){1<=c.length?b():setTimeout(d,25)},c)}d()});var u=new Promise(function(b,c){r=setTimeout(function(){c(Error(""+s+"ms timeout exceeded"))},
s)});Promise.race([u,t]).then(function(){clearTimeout(r);c(f)},d)}else{var J=function(){function n(){var b;if(b=-1!=C&&-1!=F||-1!=C&&-1!=H||-1!=F&&-1!=H)(b=C!=F&&C!=H&&F!=H)||(null===m&&(b=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),m=!!b&&(536>parseInt(b[1],10)||536===parseInt(b[1],10)&&11>=parseInt(b[2],10))),b=m&&(C==J&&F==J&&H==J||C==R&&F==R&&H==R||C==L&&F==L&&H==L)),b=!b;b&&(U.parentNode&&U.parentNode.removeChild(U),clearTimeout(r),c(f))}function p(){if((new Date).getTime()-
A>=s)U.parentNode&&U.parentNode.removeChild(U),d(Error(""+s+"ms timeout exceeded"));else{var b=document.hidden;if(!0===b||void 0===b)C=t.a.offsetWidth,F=u.a.offsetWidth,H=y.a.offsetWidth,n();r=setTimeout(p,50)}}var t=new b(l),u=new b(l),y=new b(l),C=-1,F=-1,H=-1,J=-1,R=-1,L=-1,U=document.createElement("div");U.dir="ltr";e(t,g(f,"sans-serif"));e(u,g(f,"serif"));e(y,g(f,"monospace"));U.appendChild(t.a);U.appendChild(u.a);U.appendChild(y.a);document.body.appendChild(U);J=t.a.offsetWidth;R=u.a.offsetWidth;
L=y.a.offsetWidth;p();j(t,function(b){C=b;n()});e(t,g(f,'"'+f.family+'",sans-serif'));j(u,function(b){F=b;n()});e(u,g(f,'"'+f.family+'",serif'));j(y,function(b){H=b;n()});e(y,g(f,'"'+f.family+'",monospace'))};document.body?J():document.addEventListener?document.addEventListener("DOMContentLoaded",function O(){document.removeEventListener("DOMContentLoaded",O);J()}):document.attachEvent("onreadystatechange",function N(){if("interactive"==document.readyState||"complete"==document.readyState)document.detachEvent("onreadystatechange",
N),J()})}})};"object"===typeof module?module.exports=f:(window.FontFaceObserver=f,window.FontFaceObserver.prototype.load=f.prototype.load)})();(function(c){Number.prototype.map=function(b,c,d,e){return d+(e-d)*((this-b)/(c-b))};Number.prototype.limit=function(b,c){return Math.min(c,Math.max(b,this))};Number.prototype.round=function(b){b=Math.pow(10,b||0);return Math.round(this*b)/b};Number.prototype.floor=function(){return Math.floor(this)};Number.prototype.ceil=function(){return Math.ceil(this)};Number.prototype.toInt=function(){return this|0};Number.prototype.toRad=function(){return this/180*Math.PI};Number.prototype.toDeg=function(){return 180*
this/Math.PI};Array.prototype.erase=function(b){for(var c=this.length;c--;)this[c]===b&&this.splice(c,1);return this};Array.prototype.random=function(){return this[Math.floor(Math.random()*this.length)]};Function.prototype.bind=Function.prototype.bind||function(b){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var c=Array.prototype.slice.call(arguments,1),d=this,e=function(){},f=function(){return d.apply(this instanceof e&&b?
this:b,c.concat(Array.prototype.slice.call(arguments)))};e.prototype=this.prototype;f.prototype=new e;return f};c.ig={game:null,debug:null,version:"1.23",global:c,modules:{},resources:[],ready:!1,baked:!1,nocache:"",ua:{},prefix:c.ImpactPrefix||"",lib:"lib/",_current:null,_loadQueue:[],_waitForOnload:0,$:function(b){return"#"==b.charAt(0)?document.getElementById(b.substr(1)):document.getElementsByTagName(b)},$new:function(b){return document.createElement(b)},copy:function(b){if(!b||"object"!=typeof b||
b instanceof HTMLElement||b instanceof ig.Class)return b;if(b instanceof Array)for(var c=[],d=0,e=b.length;d<e;d++)c[d]=ig.copy(b[d]);else for(d in c={},b)c[d]=ig.copy(b[d]);return c},merge:function(b,c){for(var d in c)if(!("_mesh"===d||"_camera"===d)){var e=c[d];if("object"!=typeof e||e instanceof HTMLElement||e instanceof ig.Class||null===e)b[d]=e;else{if(!b[d]||"object"!=typeof b[d])b[d]=e instanceof Array?[]:{};ig.merge(b[d],e)}}return b},ksort:function(b){if(!b||"object"!=typeof b)return[];var c=
[],d=[],e;for(e in b)c.push(e);c.sort();for(e=0;e<c.length;e++)d.push(b[c[e]]);return d},setVendorAttribute:function(b,c,d){var e=c.charAt(0).toUpperCase()+c.substr(1);b[c]="undefined"!==typeof b.imageSmoothingEnabled?b["ms"+e]=b["moz"+e]=b["o"+e]=d:b["ms"+e]=b["moz"+e]=b["webkit"+e]=b["o"+e]=d},getVendorAttribute:function(b,c){var d=c.charAt(0).toUpperCase()+c.substr(1);return"undefined"!==typeof b.imageSmoothingEnabled?b[c]||b["ms"+d]||b["moz"+d]||b["o"+d]:b[c]||b["ms"+d]||b["moz"+d]||b["webkit"+
d]||b["o"+d]},normalizeVendorAttribute:function(b,c){var d=ig.getVendorAttribute(b,c);!b[c]&&d&&(b[c]=d)},getImagePixels:function(b,c,d,e,f){var j=ig.$new("canvas");j.width=b.width;j.height=b.height;var p=j.getContext("2d");ig.System.SCALE.CRISP(j,p);var u=ig.getVendorAttribute(p,"backingStorePixelRatio")||1;ig.normalizeVendorAttribute(p,"getImageDataHD");var v=b.width/u,z=b.height/u;j.width=Math.ceil(v);j.height=Math.ceil(z);p.drawImage(b,0,0,v,z);return 1===u?p.getImageData(c,d,e,f):p.getImageDataHD(c,
d,e,f)},module:function(b){if(ig._current)throw"Module '"+ig._current.name+"' defines nothing";if(ig.modules[b]&&ig.modules[b].body)throw"Module '"+b+"' is already defined";ig._current={name:b,requires:[],loaded:!1,body:null};ig.modules[b]=ig._current;ig._loadQueue.push(ig._current);return ig},requires:function(){ig._current.requires=Array.prototype.slice.call(arguments);return ig},defines:function(b){ig._current.body=b;ig._current=null;ig._initDOMReady()},addResource:function(b){ig.resources.push(b)},
setNocache:function(b){ig.nocache=b?"?"+Date.now():""},log:function(){},assert:function(){},show:function(){},mark:function(){},_loadScript:function(b,c){ig.modules[b]={name:b,requires:[],loaded:!1,body:null};ig._waitForOnload++;var d=ig.prefix+ig.lib+b.replace(/\./g,"/")+".js"+ig.nocache,e=ig.$new("script");e.type="text/javascript";e.src=d;e.onload=function(){ig._waitForOnload--;ig._execModules()};e.onerror=function(){throw"Failed to load module "+b+" at "+d+" required from "+c;};ig.$("head")[0].appendChild(e)},
_execModules:function(){for(var b=!1,c=0;c<ig._loadQueue.length;c++){for(var d=ig._loadQueue[c],e=!0,f=0;f<d.requires.length;f++){var j=d.requires[f];ig.modules[j]?ig.modules[j].loaded||(e=!1):(e=!1,ig._loadScript(j,d.name))}e&&d.body&&(ig._loadQueue.splice(c,1),d.loaded=!0,d.body(),b=!0,c--)}if(b)ig._execModules();else if(!ig.baked&&0==ig._waitForOnload&&0!=ig._loadQueue.length){b=[];for(c=0;c<ig._loadQueue.length;c++){e=[];j=ig._loadQueue[c].requires;for(f=0;f<j.length;f++)d=ig.modules[j[f]],(!d||
!d.loaded)&&e.push(j[f]);b.push(ig._loadQueue[c].name+" (requires: "+e.join(", ")+")")}throw"Unresolved (or circular?) dependencies. Most likely there's a name/path mismatch for one of the listed modules or a previous syntax error prevents a module from loading:\n"+b.join("\n");}},_DOMReady:function(){if(!ig.modules["dom.ready"].loaded){if(!document.body)return setTimeout(ig._DOMReady,13);ig.modules["dom.ready"].loaded=!0;ig._waitForOnload--;ig._execModules()}return 0},_boot:function(){document.location.href.match(/\?nocache/)&&
ig.setNocache(!0);ig.ua.pixelRatio=c.devicePixelRatio||1;ig.ua.viewport={width:c.innerWidth,height:c.innerHeight};ig.ua.screen={width:c.screen.availWidth*ig.ua.pixelRatio,height:c.screen.availHeight*ig.ua.pixelRatio};ig.ua.iPhone=/iPhone/i.test(navigator.userAgent);ig.ua.iPhone4=ig.ua.iPhone&&2==ig.ua.pixelRatio;ig.ua.iPad=/iPad/i.test(navigator.userAgent);ig.ua.android=/android/i.test(navigator.userAgent);ig.ua.winPhone=/Windows Phone/i.test(navigator.userAgent);ig.ua.is_uiwebview=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);
ig.ua.is_safari_or_uiwebview=/(iPhone|iPod|iPad).*AppleWebKit/i.test(navigator.userAgent);ig.ua.iOS=ig.ua.iPhone||ig.ua.iPad;ig.ua.iOS6_tag=/OS 6_/i.test(navigator.userAgent);ig.ua.iOS6=(ig.ua.iPhone||ig.ua.iPad)&&ig.ua.iOS6_tag;ig.ua.iOSgt5=ig.ua.iOS&&5<parseInt(navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/)[1]);ig.ua.HTCONE=/HTC_One/i.test(navigator.userAgent);ig.ua.winPhone=/Windows Phone/i.test(navigator.userAgent);ig.ua.Kindle=/Silk/i.test(navigator.userAgent);ig.ua.touchDevice="ontouchstart"in
c||c.navigator.msMaxTouchPoints;ig.ua.mobile=ig.ua.iOS||ig.ua.android||ig.ua.iOS6||ig.ua.winPhone||ig.ua.Kindle||/mobile/i.test(navigator.userAgent)},_initDOMReady:function(){ig.modules["dom.ready"]?ig._execModules():(ig._boot(),ig.modules["dom.ready"]={requires:[],loaded:!1,body:null},ig._waitForOnload++,"complete"===document.readyState?ig._DOMReady():(document.addEventListener("DOMContentLoaded",ig._DOMReady,!1),c.addEventListener("load",ig._DOMReady,!1)))}};ig.normalizeVendorAttribute(c,"requestAnimationFrame");
if(c.requestAnimationFrame){var b=1,e={};c.ig.setAnimation=function(d){var f=b++;e[f]=!0;var j=function(){e[f]&&(c.requestAnimationFrame(j),d())};c.requestAnimationFrame(j);return f};c.ig.clearAnimation=function(b){delete e[b]}}else c.ig.setAnimation=function(b){return c.setInterval(b,1E3/60)},c.ig.clearAnimation=function(b){c.clearInterval(b)};var d=!1,j=/xyz/.test(function(){xyz})?/\bparent\b/:/.*/,f=0;c.ig.Class=function(){};var p=function(b){var c=this.prototype,d={},e;for(e in b)"function"==
typeof b[e]&&"function"==typeof c[e]&&j.test(b[e])?(d[e]=c[e],c[e]=function(b,c){return function(){var e=this.parent;this.parent=d[b];var f=c.apply(this,arguments);this.parent=e;return f}}(e,b[e])):c[e]=b[e]};c.ig.Class.extend=function(b){function e(){if(!d){if(this.staticInstantiate){var b=this.staticInstantiate.apply(this,arguments);if(b)return b}for(var c in this)"object"==typeof this[c]&&(this[c]=ig.copy(this[c]));this.init&&this.init.apply(this,arguments)}return this}var m=this.prototype;d=!0;
var n=new this;d=!1;for(var r in b)n[r]="function"==typeof b[r]&&"function"==typeof m[r]&&j.test(b[r])?function(b,c){return function(){var d=this.parent;this.parent=m[b];var e=c.apply(this,arguments);this.parent=d;return e}}(r,b[r]):b[r];e.prototype=n;e.prototype.constructor=e;e.extend=c.ig.Class.extend;e.inject=p;e.classId=n.classId=++f;return e};c.ImpactMixin&&ig.merge(ig,c.ImpactMixin)})(window);ig.baked=!0;
ig.module("impact.image").defines(function(){ig.Image=ig.Class.extend({data:null,width:0,height:0,loaded:!1,failed:!1,loadCallback:null,path:"",staticInstantiate:function(c){return ig.Image.cache[c]||null},init:function(c){this.path=c;this.load()},load:function(c){this.loaded?c&&c(this.path,!0):(!this.loaded&&ig.ready?(this.loadCallback=c||null,this.data=new Image,this.data.onload=this.onload.bind(this),this.data.onerror=this.onerror.bind(this),this.data.src=ig.prefix+this.path+ig.nocache):ig.addResource(this),
ig.Image.cache[this.path]=this)},reload:function(){this.loaded=!1;this.data=new Image;this.data.onload=this.onload.bind(this);this.data.src=this.path+"?"+Date.now()},onload:function(){this.width=this.data.width;this.height=this.data.height;this.loaded=!0;1!=ig.system.scale&&this.resize(ig.system.scale);this.loadCallback&&this.loadCallback(this.path,!0)},onerror:function(){this.failed=!0;this.loadCallback&&this.loadCallback(this.path,!1)},resize:function(c){var b=ig.getImagePixels(this.data,0,0,this.width,
this.height),e=this.width*c,d=this.height*c,j=ig.$new("canvas");j.width=e;j.height=d;for(var f=j.getContext("2d"),p=f.getImageData(0,0,e,d),l=0;l<d;l++)for(var g=0;g<e;g++){var m=4*(Math.floor(l/c)*this.width+Math.floor(g/c)),n=4*(l*e+g);p.data[n]=b.data[m];p.data[n+1]=b.data[m+1];p.data[n+2]=b.data[m+2];p.data[n+3]=b.data[m+3]}f.putImageData(p,0,0);this.data=j},draw:function(c,b,e,d,j,f){if(this.loaded){var p=ig.system.scale;j=(j?j:this.width)*p;f=(f?f:this.height)*p;ig.system.context.drawImage(this.data,
e?e*p:0,d?d*p:0,j,f,ig.system.getDrawPos(c),ig.system.getDrawPos(b),j,f);ig.Image.drawCount++}},drawTile:function(c,b,e,d,j,f,p){j=j?j:d;if(this.loaded&&!(d>this.width||j>this.height)){var l=ig.system.scale,g=Math.floor(d*l),m=Math.floor(j*l),n=f?-1:1,r=p?-1:1;if(f||p)ig.system.context.save(),ig.system.context.scale(n,r);ig.system.context.drawImage(this.data,Math.floor(e*d)%this.width*l,Math.floor(e*d/this.width)*j*l,g,m,ig.system.getDrawPos(c)*n-(f?g:0),ig.system.getDrawPos(b)*r-(p?m:0),g,m);(f||
p)&&ig.system.context.restore();ig.Image.drawCount++}}});ig.Image.drawCount=0;ig.Image.cache={};ig.Image.reloadCache=function(){for(var c in ig.Image.cache)ig.Image.cache[c].reload()}});ig.baked=!0;
ig.module("impact.font").requires("impact.image").defines(function(){ig.Font=ig.Image.extend({widthMap:[],indices:[],firstChar:32,alpha:1,letterSpacing:1,lineSpacing:0,onload:function(c){this._loadMetrics(this.data);this.parent(c)},widthForString:function(c){if(-1!==c.indexOf("\n")){c=c.split("\n");for(var b=0,e=0;e<c.length;e++)b=Math.max(b,this._widthForLine(c[e]));return b}return this._widthForLine(c)},_widthForLine:function(c){for(var b=0,e=0;e<c.length;e++)b+=this.widthMap[c.charCodeAt(e)-this.firstChar]+
this.letterSpacing;return b},heightForString:function(c){return c.split("\n").length*(this.height+this.lineSpacing)},draw:function(c,b,e,d){"string"!=typeof c&&(c=c.toString());if(-1!==c.indexOf("\n")){c=c.split("\n");for(var j=this.height+this.lineSpacing,f=0;f<c.length;f++)this.draw(c[f],b,e+f*j,d)}else{if(d==ig.Font.ALIGN.RIGHT||d==ig.Font.ALIGN.CENTER)f=this._widthForLine(c),b-=d==ig.Font.ALIGN.CENTER?f/2:f;1!==this.alpha&&(ig.system.context.globalAlpha=this.alpha);for(f=0;f<c.length;f++)d=c.charCodeAt(f),
b+=this._drawChar(d-this.firstChar,b,e);1!==this.alpha&&(ig.system.context.globalAlpha=1);ig.Image.drawCount+=c.length}},_drawChar:function(c,b,e){if(!this.loaded||0>c||c>=this.indices.length)return 0;var d=ig.system.scale,j=this.widthMap[c]*d,f=(this.height-2)*d;ig.system.context.drawImage(this.data,this.indices[c]*d,0,j,f,ig.system.getDrawPos(b),ig.system.getDrawPos(e),j,f);return this.widthMap[c]+this.letterSpacing},_loadMetrics:function(c){this.height=c.height-1;this.widthMap=[];this.indices=
[];for(var b=ig.getImagePixels(c,0,c.height-1,c.width,1),e=0,d=0,j=0;j<c.width;j++){var f=4*j+3;127<b.data[f]?d++:128>b.data[f]&&d&&(this.widthMap.push(d),this.indices.push(j-d),e++,d=0)}this.widthMap.push(d);this.indices.push(j-d)}});ig.Font.ALIGN={LEFT:0,RIGHT:1,CENTER:2}});ig.baked=!0;
ig.module("impact.sound").defines(function(){ig.SoundManager=ig.Class.extend({clips:{},volume:1,format:null,init:function(){if(!ig.Sound.enabled||!window.Audio)ig.Sound.enabled=!1;else{for(var c=new Audio,b=0;b<ig.Sound.use.length;b++){var e=ig.Sound.use[b];if(c.canPlayType(e.mime)){this.format=e;break}}this.format||(ig.Sound.enabled=!1)}},load:function(c,b,e){var d=ig.prefix+c.replace(/[^\.]+$/,this.format.ext)+ig.nocache;if(this.clips[c]){if(b&&this.clips[c].length<ig.Sound.channels)for(b=this.clips[c].length;b<
ig.Sound.channels;b++){var j=new Audio(d);j.load();this.clips[c].push(j)}return this.clips[c][0]}var f=new Audio(d);e&&(f.addEventListener("canplaythrough",function l(b){f.removeEventListener("canplaythrough",l,!1);e(c,!0,b)},!1),f.addEventListener("error",function(b){e(c,!1,b)},!1));f.preload="auto";f.load();this.clips[c]=[f];if(b)for(b=1;b<ig.Sound.channels;b++)j=new Audio(d),j.load(),this.clips[c].push(j);return f},get:function(c){c=this.clips[c];for(var b=0,e;e=c[b++];)if(e.paused||e.ended)return e.ended&&
(e.currentTime=0),e;c[0].pause();c[0].currentTime=0;return c[0]}});ig.Music=ig.Class.extend({tracks:[],namedTracks:{},currentTrack:null,currentIndex:0,random:!1,_volume:1,_loop:!1,_fadeInterval:0,_fadeTimer:null,_endedCallbackBound:null,init:function(){this._endedCallbackBound=this._endedCallback.bind(this);Object.defineProperty?(Object.defineProperty(this,"volume",{get:this.getVolume.bind(this),set:this.setVolume.bind(this)}),Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)})):
this.__defineGetter__&&(this.__defineGetter__("volume",this.getVolume.bind(this)),this.__defineSetter__("volume",this.setVolume.bind(this)),this.__defineGetter__("loop",this.getLooping.bind(this)),this.__defineSetter__("loop",this.setLooping.bind(this)))},add:function(c,b){if(ig.Sound.enabled){var e=ig.soundManager.load(c instanceof ig.Sound?c.path:c,!1);e.loop=this._loop;e.volume=this._volume;e.addEventListener("ended",this._endedCallbackBound,!1);this.tracks.push(e);b&&(this.namedTracks[b]=e);this.currentTrack||
(this.currentTrack=e)}},next:function(){this.tracks.length&&(this.stop(),this.currentIndex=this.random?Math.floor(Math.random()*this.tracks.length):(this.currentIndex+1)%this.tracks.length,this.currentTrack=this.tracks[this.currentIndex],this.play())},pause:function(){this.currentTrack&&this.currentTrack.pause()},stop:function(){this.currentTrack&&(this.currentTrack.pause(),this.currentTrack.currentTime=0)},play:function(c){if(c&&this.namedTracks[c])c=this.namedTracks[c],c!=this.currentTrack&&(this.stop(),
this.currentTrack=c);else if(!this.currentTrack)return;this.currentTrack.play()},getLooping:function(){return this._loop},setLooping:function(c){this._loop=c;for(var b in this.tracks)this.tracks[b].loop=c},getVolume:function(){return this._volume},setVolume:function(c){this._volume=c.limit(0,1);for(var b in this.tracks)this.tracks[b].volume=this._volume},fadeOut:function(c){this.currentTrack&&(clearInterval(this._fadeInterval),this.fadeTimer=new ig.Timer(c),this._fadeInterval=setInterval(this._fadeStep.bind(this),
50))},_fadeStep:function(){var c=this.fadeTimer.delta().map(-this.fadeTimer.target,0,1,0).limit(0,1)*this._volume;0.01>=c?(this.stop(),this.currentTrack.volume=this._volume,clearInterval(this._fadeInterval)):this.currentTrack.volume=c},_endedCallback:function(){this._loop?this.play():this.next()}});ig.Sound=ig.Class.extend({path:"",volume:1,currentClip:null,multiChannel:!0,init:function(c,b){this.path=c;this.multiChannel=!1!==b;this.load()},load:function(c){ig.Sound.enabled?ig.ready?ig.soundManager.load(this.path,
this.multiChannel,c):ig.addResource(this):c&&c(this.path,!0)},play:function(){ig.Sound.enabled&&(this.currentClip=ig.soundManager.get(this.path),this.currentClip.volume=ig.soundManager.volume*this.volume,this.currentClip.play())},stop:function(){this.currentClip&&(this.currentClip.pause(),this.currentClip.currentTime=0)}});ig.Sound.FORMAT={MP3:{ext:"mp3",mime:"audio/mpeg"},M4A:{ext:"m4a",mime:"audio/mp4; codecs=mp4a"},OGG:{ext:"ogg",mime:"audio/ogg; codecs=vorbis"},WEBM:{ext:"webm",mime:"audio/webm; codecs=vorbis"},
CAF:{ext:"caf",mime:"audio/x-caf"}};ig.Sound.use=[ig.Sound.FORMAT.OGG,ig.Sound.FORMAT.MP3];ig.Sound.channels=4;ig.Sound.enabled=!0});ig.baked=!0;
ig.module("impact.loader").requires("impact.image","impact.font","impact.sound").defines(function(){ig.Loader=ig.Class.extend({resources:[],gameClass:null,status:0,done:!1,_unloaded:[],_drawStatus:0,_intervalId:0,_loadCallbackBound:null,init:function(c,b){this.gameClass=c;this.resources=b;this._loadCallbackBound=this._loadCallback.bind(this);for(var e=0;e<this.resources.length;e++)this._unloaded.push(this.resources[e].path)},load:function(){ig.system.clear("#000");if(this.resources.length){for(var c=
0;c<this.resources.length;c++)this.loadResource(this.resources[c]);this._intervalId=setInterval(this.draw.bind(this),16)}else this.end()},loadResource:function(c){c.load(this._loadCallbackBound)},end:function(){this.done||(this.done=!0,clearInterval(this._intervalId))},draw:function(){},_loadCallback:function(c,b){if(b)this._unloaded.erase(c);else throw"Failed to load resource: "+c;this.status=1-this._unloaded.length/this.resources.length;0==this._unloaded.length&&setTimeout(this.end.bind(this),250)}})});
ig.baked=!0;
ig.module("impact.timer").defines(function(){ig.Timer=ig.Class.extend({target:0,base:0,last:0,pausedAt:0,init:function(c){this.last=this.base=ig.Timer.time;this.target=c||0},set:function(c){this.target=c||0;this.base=ig.Timer.time;this.pausedAt=0},reset:function(){this.base=ig.Timer.time;this.pausedAt=0},tick:function(){var c=ig.Timer.time-this.last;this.last=ig.Timer.time;return this.pausedAt?0:c},delta:function(){return(this.pausedAt||ig.Timer.time)-this.base-this.target},pause:function(){this.pausedAt||(this.pausedAt=
ig.Timer.time)},unpause:function(){this.pausedAt&&(this.base+=ig.Timer.time-this.pausedAt,this.pausedAt=0)}});ig.Timer._last=0;ig.Timer.time=Number.MIN_VALUE;ig.Timer.timeScale=1;ig.Timer.maxStep=0.05;ig.Timer.step=function(){var c=Date.now();ig.Timer.time+=Math.min((c-ig.Timer._last)/1E3,ig.Timer.maxStep)*ig.Timer.timeScale;ig.Timer._last=c}});ig.baked=!0;
ig.module("impact.system").requires("impact.timer","impact.image").defines(function(){ig.System=ig.Class.extend({fps:30,width:320,height:240,realWidth:320,realHeight:240,scale:1,tick:0,animationId:0,newGameClass:null,running:!1,delegate:null,clock:null,canvas:null,context:null,init:function(c,b,e,d,j){this.fps=b;this.clock=new ig.Timer;this.canvas=ig.$(c);this.resize(e,d,j);this.context=this.canvas.getContext("2d");this.getDrawPos=ig.System.drawMode;1!=this.scale&&(ig.System.scaleMode=ig.System.SCALE.CRISP);
ig.System.scaleMode(this.canvas,this.context)},resize:function(c,b,e){this.width=c;this.height=b;this.scale=e||this.scale;this.realWidth=this.width*this.scale;this.realHeight=this.height*this.scale;this.canvas.width=this.realWidth;this.canvas.height=this.realHeight},setGame:function(c){this.running?this.newGameClass=c:this.setGameNow(c)},setGameNow:function(c){ig.game=new c;ig.system.setDelegate(ig.game)},setDelegate:function(c){if("function"==typeof c.run)this.delegate=c,this.startRunLoop();else throw"System.setDelegate: No run() function in object";
},stopRunLoop:function(){ig.clearAnimation(this.animationId);this.running=!1},startRunLoop:function(){this.stopRunLoop();this.animationId=ig.setAnimation(this.run.bind(this));this.running=!0},clear:function(c){this.context.fillStyle=c;this.context.fillRect(0,0,this.realWidth,this.realHeight)},run:function(){ig.Timer.step();this.tick=this.clock.tick();this.delegate.run();ig.input.clearPressed();this.newGameClass&&(this.setGameNow(this.newGameClass),this.newGameClass=null)},getDrawPos:null});ig.System.DRAW=
{AUTHENTIC:function(c){return Math.round(c)*this.scale},SMOOTH:function(c){return Math.round(c*this.scale)},SUBPIXEL:function(c){return c*this.scale}};ig.System.drawMode=ig.System.DRAW.SMOOTH;ig.System.SCALE={CRISP:function(c,b){ig.setVendorAttribute(b,"imageSmoothingEnabled",!1);c.style.imageRendering="-moz-crisp-edges";c.style.imageRendering="-o-crisp-edges";c.style.imageRendering="-webkit-optimize-contrast";c.style.imageRendering="crisp-edges";c.style.msInterpolationMode="nearest-neighbor"},SMOOTH:function(c,
b){ig.setVendorAttribute(b,"imageSmoothingEnabled",!0);c.style.imageRendering="";c.style.msInterpolationMode=""}};ig.System.scaleMode=ig.System.SCALE.SMOOTH});ig.baked=!0;
ig.module("impact.input").defines(function(){ig.KEY={MOUSE1:-1,MOUSE2:-3,MWHEEL_UP:-4,MWHEEL_DOWN:-5,BACKSPACE:8,TAB:9,ENTER:13,PAUSE:19,CAPS:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,_0:48,_1:49,_2:50,_3:51,_4:52,_5:53,_6:54,_7:55,_8:56,_9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,
NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SHIFT:16,CTRL:17,ALT:18,PLUS:187,COMMA:188,MINUS:189,PERIOD:190};ig.Input=ig.Class.extend({bindings:{},actions:{},presses:{},locks:{},delayedKeyup:{},isUsingMouse:!1,isUsingKeyboard:!1,isUsingAccelerometer:!1,mouse:{x:0,y:0},accel:{x:0,y:0,z:0},initMouse:function(){if(!this.isUsingMouse){this.isUsingMouse=
!0;var c=this.mousewheel.bind(this);ig.system.canvas.addEventListener("wheel",c,!1);ig.system.canvas.addEventListener("mousewheel",c,!1);ig.system.canvas.addEventListener("DOMMouseScroll",c,!1);ig.system.canvas.addEventListener("contextmenu",this.contextmenu.bind(this),!1);ig.system.canvas.addEventListener("mousedown",this.keydown.bind(this),!1);ig.system.canvas.addEventListener("mouseup",this.keyup.bind(this),!1);ig.system.canvas.addEventListener("mousemove",this.mousemove.bind(this),!1);ig.ua.touchDevice&&
(ig.system.canvas.addEventListener("touchstart",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.mousemove.bind(this),!1),ig.system.canvas.addEventListener("MSPointerDown",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("MSPointerUp",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",this.mousemove.bind(this),!1),ig.system.canvas.style.msTouchAction="none")}},
initKeyboard:function(){this.isUsingKeyboard||(this.isUsingKeyboard=!0,window.addEventListener("keydown",this.keydown.bind(this),!1),window.addEventListener("keyup",this.keyup.bind(this),!1))},initAccelerometer:function(){this.isUsingAccelerometer||window.addEventListener("devicemotion",this.devicemotion.bind(this),!1)},mousewheel:function(c){var b=this.bindings[0<(c.wheelDelta?c.wheelDelta:-1*c.detail)?ig.KEY.MWHEEL_UP:ig.KEY.MWHEEL_DOWN];b&&(this.actions[b]=!0,this.presses[b]=!0,this.delayedKeyup[b]=
!0,c.stopPropagation(),c.preventDefault())},mousemove:function(c){var b=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth;ig.ua.mobile&&(b=ig.system.realWidth);var b=ig.system.scale*(b/ig.system.realWidth),e={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());c=c.touches?c.touches[0]:c;this.mouse.x=(c.clientX-e.left)/b;this.mouse.y=(c.clientY-e.top)/b},contextmenu:function(c){this.bindings[ig.KEY.MOUSE2]&&(c.stopPropagation(),c.preventDefault())},
keydown:function(c){var b=c.target.tagName;"INPUT"==b||"TEXTAREA"==b||(b="keydown"==c.type?c.keyCode:2==c.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1,("touchstart"==c.type||"mousedown"==c.type)&&this.mousemove(c),b=this.bindings[b],console.log(b),b&&(this.actions[b]=!0,this.locks[b]||(this.presses[b]=!0,this.locks[b]=!0),c.stopPropagation(),c.preventDefault()))},keyup:function(c){var b=c.target.tagName;if(!("INPUT"==b||"TEXTAREA"==b))if(b=this.bindings["keyup"==c.type?c.keyCode:2==c.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1])this.delayedKeyup[b]=
!0,c.stopPropagation(),c.preventDefault()},devicemotion:function(c){this.accel=c.accelerationIncludingGravity},bind:function(c,b){0>c?this.initMouse():0<c&&this.initKeyboard();this.bindings[c]=b},bindTouch:function(c,b){var e=ig.$(c),d=this;e.addEventListener("touchstart",function(c){d.touchStart(c,b)},!1);e.addEventListener("touchend",function(c){d.touchEnd(c,b)},!1);e.addEventListener("MSPointerDown",function(c){d.touchStart(c,b)},!1);e.addEventListener("MSPointerUp",function(c){d.touchEnd(c,b)},
!1)},unbind:function(c){this.delayedKeyup[this.bindings[c]]=!0;this.bindings[c]=null},unbindAll:function(){this.bindings={};this.actions={};this.presses={};this.locks={};this.delayedKeyup={}},state:function(c){return this.actions[c]},pressed:function(c){return this.presses[c]},released:function(c){return!!this.delayedKeyup[c]},clearPressed:function(){for(var c in this.delayedKeyup)this.actions[c]=!1,this.locks[c]=!1;this.delayedKeyup={};this.presses={}},touchStart:function(c,b){this.actions[b]=!0;
this.presses[b]=!0;c.stopPropagation();c.preventDefault();return!1},touchEnd:function(c,b){this.delayedKeyup[b]=!0;c.stopPropagation();c.preventDefault();return!1}})});ig.baked=!0;ig.module("impact.impact").requires("dom.ready","impact.loader","impact.system","impact.input","impact.sound").defines(function(){ig.main=function(c,b,e,d,j,f,p){ig.system=new ig.System(c,e,d,j,f||1);ig.input=new ig.Input;ig.soundManager=new ig.SoundManager;ig.music=new ig.Music;ig.ready=!0;(new (p||ig.Loader)(b,ig.resources)).load()}});
ig.baked=!0;
ig.module("impact.animation").requires("impact.timer","impact.image").defines(function(){ig.AnimationSheet=ig.Class.extend({width:8,height:8,image:null,init:function(c,b,e){this.width=b;this.height=e;this.image=new ig.Image(c)}});ig.Animation=ig.Class.extend({sheet:null,timer:null,sequence:[],flip:{x:!1,y:!1},pivot:{x:0,y:0},frame:0,tile:0,loopCount:0,alpha:1,angle:0,init:function(c,b,e,d){this.sheet=c;this.pivot={x:c.width/2,y:c.height/2};this.timer=new ig.Timer;this.frameTime=b;this.sequence=e;
this.stop=!!d;this.tile=this.sequence[0]},rewind:function(){this.timer.set();this.frame=this.loopCount=0;this.tile=this.sequence[0];return this},gotoFrame:function(c){this.timer.set(this.frameTime*-c-1E-4);this.update()},gotoRandomFrame:function(){this.gotoFrame(Math.floor(Math.random()*this.sequence.length))},update:function(){var c=Math.floor(this.timer.delta()/this.frameTime);this.loopCount=Math.floor(c/this.sequence.length);this.frame=this.stop&&0<this.loopCount?this.sequence.length-1:c%this.sequence.length;
this.tile=this.sequence[this.frame]},draw:function(c,b){var e=Math.max(this.sheet.width,this.sheet.height);c>ig.system.width||(b>ig.system.height||0>c+e||0>b+e)||(1!=this.alpha&&(ig.system.context.globalAlpha=this.alpha),0==this.angle?this.sheet.image.drawTile(c,b,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y):(ig.system.context.save(),ig.system.context.translate(ig.system.getDrawPos(c+this.pivot.x),ig.system.getDrawPos(b+this.pivot.y)),ig.system.context.rotate(this.angle),
this.sheet.image.drawTile(-this.pivot.x,-this.pivot.y,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y),ig.system.context.restore()),1!=this.alpha&&(ig.system.context.globalAlpha=1))}})});ig.baked=!0;
ig.module("impact.entity").requires("impact.animation","impact.impact").defines(function(){ig.Entity=ig.Class.extend({id:0,settings:{},size:{x:16,y:16},offset:{x:0,y:0},pos:{x:0,y:0},last:{x:0,y:0},vel:{x:0,y:0},accel:{x:0,y:0},friction:{x:0,y:0},maxVel:{x:100,y:100},zIndex:0,gravityFactor:1,standing:!1,bounciness:0,minBounceVelocity:40,anims:{},animSheet:null,currentAnim:null,health:10,type:0,checkAgainst:0,collides:0,_killed:!1,slopeStanding:{min:(44).toRad(),max:(136).toRad()},init:function(c,
b,e){this.id=++ig.Entity._lastId;this.pos.x=this.last.x=c;this.pos.y=this.last.y=b;ig.merge(this,e)},reset:function(c,b,e){var d=this.constructor.prototype;this.pos.x=c;this.pos.y=b;this.last.x=c;this.last.y=b;this.vel.x=d.vel.x;this.vel.y=d.vel.y;this.accel.x=d.accel.x;this.accel.y=d.accel.y;this.health=d.health;this._killed=d._killed;this.standing=d.standing;this.type=d.type;this.checkAgainst=d.checkAgainst;this.collides=d.collides;ig.merge(this,e)},addAnim:function(c,b,e,d){if(!this.animSheet)throw"No animSheet to add the animation "+
c+" to.";b=new ig.Animation(this.animSheet,b,e,d);this.anims[c]=b;this.currentAnim||(this.currentAnim=b);return b},update:function(){this.last.x=this.pos.x;this.last.y=this.pos.y;this.vel.y+=ig.game.gravity*ig.system.tick*this.gravityFactor;this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x);this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y,this.friction.y,this.maxVel.y);var c=ig.game.collisionMap.trace(this.pos.x,this.pos.y,this.vel.x*ig.system.tick,this.vel.y*
ig.system.tick,this.size.x,this.size.y);this.handleMovementTrace(c);this.currentAnim&&this.currentAnim.update()},getNewVelocity:function(c,b,e,d){return b?(c+b*ig.system.tick).limit(-d,d):e?(b=e*ig.system.tick,0<c-b?c-b:0>c+b?c+b:0):c.limit(-d,d)},handleMovementTrace:function(c){this.standing=!1;c.collision.y&&(0<this.bounciness&&Math.abs(this.vel.y)>this.minBounceVelocity?this.vel.y*=-this.bounciness:(0<this.vel.y&&(this.standing=!0),this.vel.y=0));c.collision.x&&(this.vel.x=0<this.bounciness&&Math.abs(this.vel.x)>
this.minBounceVelocity?this.vel.x*-this.bounciness:0);if(c.collision.slope){var b=c.collision.slope;if(0<this.bounciness){var e=this.vel.x*b.nx+this.vel.y*b.ny;this.vel.x=(this.vel.x-2*b.nx*e)*this.bounciness;this.vel.y=(this.vel.y-2*b.ny*e)*this.bounciness}else e=(this.vel.x*b.x+this.vel.y*b.y)/(b.x*b.x+b.y*b.y),this.vel.x=b.x*e,this.vel.y=b.y*e,b=Math.atan2(b.x,b.y),b>this.slopeStanding.min&&b<this.slopeStanding.max&&(this.standing=!0)}this.pos=c.pos},draw:function(){this.currentAnim&&this.currentAnim.draw(this.pos.x-
this.offset.x-ig.game._rscreen.x,this.pos.y-this.offset.y-ig.game._rscreen.y)},kill:function(){ig.game.removeEntity(this)},receiveDamage:function(c){this.health-=c;0>=this.health&&this.kill()},touches:function(c){return!(this.pos.x>=c.pos.x+c.size.x||this.pos.x+this.size.x<=c.pos.x||this.pos.y>=c.pos.y+c.size.y||this.pos.y+this.size.y<=c.pos.y)},distanceTo:function(c){var b=this.pos.x+this.size.x/2-(c.pos.x+c.size.x/2);c=this.pos.y+this.size.y/2-(c.pos.y+c.size.y/2);return Math.sqrt(b*b+c*c)},angleTo:function(c){return Math.atan2(c.pos.y+
c.size.y/2-(this.pos.y+this.size.y/2),c.pos.x+c.size.x/2-(this.pos.x+this.size.x/2))},check:function(){},collideWith:function(){},ready:function(){},erase:function(){}});ig.Entity._lastId=0;ig.Entity.COLLIDES={NEVER:0,LITE:1,PASSIVE:2,ACTIVE:4,FIXED:8};ig.Entity.TYPE={NONE:0,A:1,B:2,BOTH:3};ig.Entity.checkPair=function(c,b){c.checkAgainst&b.type&&c.check(b);b.checkAgainst&c.type&&b.check(c);c.collides&&(b.collides&&c.collides+b.collides>ig.Entity.COLLIDES.ACTIVE)&&ig.Entity.solveCollision(c,b)};ig.Entity.solveCollision=
function(c,b){var e=null;if(c.collides==ig.Entity.COLLIDES.LITE||b.collides==ig.Entity.COLLIDES.FIXED)e=c;else if(b.collides==ig.Entity.COLLIDES.LITE||c.collides==ig.Entity.COLLIDES.FIXED)e=b;c.last.x+c.size.x>b.last.x&&c.last.x<b.last.x+b.size.x?(c.last.y<b.last.y?ig.Entity.seperateOnYAxis(c,b,e):ig.Entity.seperateOnYAxis(b,c,e),c.collideWith(b,"y"),b.collideWith(c,"y")):c.last.y+c.size.y>b.last.y&&c.last.y<b.last.y+b.size.y&&(c.last.x<b.last.x?ig.Entity.seperateOnXAxis(c,b,e):ig.Entity.seperateOnXAxis(b,
c,e),c.collideWith(b,"x"),b.collideWith(c,"x"))};ig.Entity.seperateOnXAxis=function(c,b,e){var d=c.pos.x+c.size.x-b.pos.x;e?(e.vel.x=-e.vel.x*e.bounciness+(c===e?b:c).vel.x,b=ig.game.collisionMap.trace(e.pos.x,e.pos.y,e==c?-d:d,0,e.size.x,e.size.y),e.pos.x=b.pos.x):(e=(c.vel.x-b.vel.x)/2,c.vel.x=-e,b.vel.x=e,e=ig.game.collisionMap.trace(c.pos.x,c.pos.y,-d/2,0,c.size.x,c.size.y),c.pos.x=Math.floor(e.pos.x),c=ig.game.collisionMap.trace(b.pos.x,b.pos.y,d/2,0,b.size.x,b.size.y),b.pos.x=Math.ceil(c.pos.x))};
ig.Entity.seperateOnYAxis=function(c,b,e){var d=c.pos.y+c.size.y-b.pos.y;if(e){b=c===e?b:c;e.vel.y=-e.vel.y*e.bounciness+b.vel.y;var j=0;e==c&&Math.abs(e.vel.y-b.vel.y)<e.minBounceVelocity&&(e.standing=!0,j=b.vel.x*ig.system.tick);c=ig.game.collisionMap.trace(e.pos.x,e.pos.y,j,e==c?-d:d,e.size.x,e.size.y);e.pos.y=c.pos.y;e.pos.x=c.pos.x}else ig.game.gravity&&(b.standing||0<c.vel.y)?(e=ig.game.collisionMap.trace(c.pos.x,c.pos.y,0,-(c.pos.y+c.size.y-b.pos.y),c.size.x,c.size.y),c.pos.y=e.pos.y,0<c.bounciness&&
c.vel.y>c.minBounceVelocity?c.vel.y*=-c.bounciness:(c.standing=!0,c.vel.y=0)):(e=(c.vel.y-b.vel.y)/2,c.vel.y=-e,b.vel.y=e,j=b.vel.x*ig.system.tick,e=ig.game.collisionMap.trace(c.pos.x,c.pos.y,j,-d/2,c.size.x,c.size.y),c.pos.y=e.pos.y,c=ig.game.collisionMap.trace(b.pos.x,b.pos.y,0,d/2,b.size.x,b.size.y),b.pos.y=c.pos.y)}});ig.baked=!0;
ig.module("impact.map").defines(function(){ig.Map=ig.Class.extend({tilesize:8,width:1,height:1,data:[[]],name:null,init:function(c,b){this.tilesize=c;this.data=b;this.height=b.length;this.width=b[0].length;this.pxWidth=this.width*this.tilesize;this.pxHeight=this.height*this.tilesize},getTile:function(c,b){var e=Math.floor(c/this.tilesize),d=Math.floor(b/this.tilesize);return 0<=e&&e<this.width&&0<=d&&d<this.height?this.data[d][e]:0},setTile:function(c,b,e){c=Math.floor(c/this.tilesize);b=Math.floor(b/
this.tilesize);0<=c&&c<this.width&&(0<=b&&b<this.height)&&(this.data[b][c]=e)}})});ig.baked=!0;
ig.module("impact.collision-map").requires("impact.map").defines(function(){ig.CollisionMap=ig.Map.extend({lastSlope:1,tiledef:null,init:function(b,c,j){this.parent(b,c);this.tiledef=j||ig.CollisionMap.defaultTileDef;for(var f in this.tiledef)f|0>this.lastSlope&&(this.lastSlope=f|0)},trace:function(b,c,j,f,p,l){var g={collision:{x:!1,y:!1,slope:!1},pos:{x:b,y:c},tile:{x:0,y:0}},m=Math.ceil(Math.max(Math.abs(j),Math.abs(f))/this.tilesize);if(1<m)for(var n=j/m,r=f/m,s=0;s<m&&(n||r)&&!(this._traceStep(g,
b,c,n,r,p,l,j,f,s),b=g.pos.x,c=g.pos.y,g.collision.x&&(j=n=0),g.collision.y&&(f=r=0),g.collision.slope);s++);else this._traceStep(g,b,c,j,f,p,l,j,f,0);return g},_traceStep:function(b,c,j,f,p,l,g,m,n,r){b.pos.x+=f;b.pos.y+=p;var s=0;if(f){var t=0<f?l:0,u=0>f?this.tilesize:0,s=Math.max(Math.floor(j/this.tilesize),0),v=Math.min(Math.ceil((j+g)/this.tilesize),this.height);f=Math.floor((b.pos.x+t)/this.tilesize);var z=Math.floor((c+t)/this.tilesize);if(0<r||f==z||0>z||z>=this.width)z=-1;if(0<=f&&f<this.width)for(var x=
s;x<v&&!(-1!=z&&(s=this.data[x][z],1<s&&s<=this.lastSlope&&this._checkTileDef(b,s,c,j,m,n,l,g,z,x)));x++)if(s=this.data[x][f],1==s||s>this.lastSlope||1<s&&this._checkTileDef(b,s,c,j,m,n,l,g,f,x)){if(1<s&&s<=this.lastSlope&&b.collision.slope)break;b.collision.x=!0;b.tile.x=s;c=b.pos.x=f*this.tilesize-t+u;m=0;break}}if(p){t=0<p?g:0;p=0>p?this.tilesize:0;s=Math.max(Math.floor(b.pos.x/this.tilesize),0);u=Math.min(Math.ceil((b.pos.x+l)/this.tilesize),this.width);x=Math.floor((b.pos.y+t)/this.tilesize);
v=Math.floor((j+t)/this.tilesize);if(0<r||x==v||0>v||v>=this.height)v=-1;if(0<=x&&x<this.height)for(f=s;f<u&&!(-1!=v&&(s=this.data[v][f],1<s&&s<=this.lastSlope&&this._checkTileDef(b,s,c,j,m,n,l,g,f,v)));f++)if(s=this.data[x][f],1==s||s>this.lastSlope||1<s&&this._checkTileDef(b,s,c,j,m,n,l,g,f,x)){if(1<s&&s<=this.lastSlope&&b.collision.slope)break;b.collision.y=!0;b.tile.y=s;b.pos.y=x*this.tilesize-t+p;break}}},_checkTileDef:function(b,c,j,f,p,l,g,m,n,r){var s=this.tiledef[c];if(!s)return!1;c=(s[2]-
s[0])*this.tilesize;var t=(s[3]-s[1])*this.tilesize,u=s[4];g=j+p+(0>t?g:0)-(n+s[0])*this.tilesize;m=f+l+(0<c?m:0)-(r+s[1])*this.tilesize;if(0<c*m-t*g){if(0>p*-t+l*c)return u;n=Math.sqrt(c*c+t*t);r=t/n;n=-c/n;var v=g*r+m*n,s=r*v,v=n*v;if(s*s+v*v>=p*p+l*l)return u||0.5>c*(m-l)-t*(g-p);b.pos.x=j+p-s;b.pos.y=f+l-v;b.collision.slope={x:c,y:t,nx:r,ny:n};return!0}return!1}});var c=1/3,b=2/3;ig.CollisionMap.defaultTileDef={5:[0,1,1,b,!0],6:[0,b,1,c,!0],7:[0,c,1,0,!0],3:[0,1,1,0.5,!0],4:[0,0.5,1,0,!0],2:[0,
1,1,0,!0],10:[0.5,1,1,0,!0],21:[0,1,0.5,0,!0],32:[b,1,1,0,!0],43:[c,1,b,0,!0],54:[0,1,c,0,!0],27:[0,0,1,c,!0],28:[0,c,1,b,!0],29:[0,b,1,1,!0],25:[0,0,1,0.5,!0],26:[0,0.5,1,1,!0],24:[0,0,1,1,!0],11:[0,0,0.5,1,!0],22:[0.5,0,1,1,!0],33:[0,0,c,1,!0],44:[c,0,b,1,!0],55:[b,0,1,1,!0],16:[1,c,0,0,!0],17:[1,b,0,c,!0],18:[1,1,0,b,!0],14:[1,0.5,0,0,!0],15:[1,1,0,0.5,!0],13:[1,1,0,0,!0],8:[0.5,1,0,0,!0],19:[1,1,0.5,0,!0],30:[c,1,0,0,!0],41:[b,1,c,0,!0],52:[1,1,b,0,!0],38:[1,b,0,1,!0],39:[1,c,0,b,!0],40:[1,0,
0,c,!0],36:[1,0.5,0,1,!0],37:[1,0,0,0.5,!0],35:[1,0,0,1,!0],9:[1,0,0.5,1,!0],20:[0.5,0,0,1,!0],31:[1,0,b,1,!0],42:[b,0,c,1,!0],53:[c,0,0,1,!0],12:[0,0,1,0,!1],23:[1,1,0,1,!1],34:[1,0,1,1,!1],45:[0,1,0,0,!1]};ig.CollisionMap.staticNoCollision={trace:function(b,c,j,f){return{collision:{x:!1,y:!1,slope:!1},pos:{x:b+j,y:c+f},tile:{x:0,y:0}}}}});ig.baked=!0;
ig.module("impact.background-map").requires("impact.map","impact.image").defines(function(){ig.BackgroundMap=ig.Map.extend({tiles:null,scroll:{x:0,y:0},distance:1,repeat:!1,tilesetName:"",foreground:!1,enabled:!0,preRender:!1,preRenderedChunks:null,chunkSize:512,debugChunks:!1,anims:{},init:function(c,b,e){this.parent(c,b);this.setTileset(e)},setTileset:function(c){this.tilesetName=c instanceof ig.Image?c.path:c;this.tiles=new ig.Image(this.tilesetName);this.preRenderedChunks=null},setScreenPos:function(c,
b){this.scroll.x=c/this.distance;this.scroll.y=b/this.distance},preRenderMapToChunks:function(){var c=this.width*this.tilesize*ig.system.scale,b=this.height*this.tilesize*ig.system.scale;this.chunkSize=Math.min(Math.max(c,b),this.chunkSize);var e=Math.ceil(c/this.chunkSize),d=Math.ceil(b/this.chunkSize);this.preRenderedChunks=[];for(var j=0;j<d;j++){this.preRenderedChunks[j]=[];for(var f=0;f<e;f++)this.preRenderedChunks[j][f]=this.preRenderChunk(f,j,f==e-1?c-f*this.chunkSize:this.chunkSize,j==d-1?
b-j*this.chunkSize:this.chunkSize)}},preRenderChunk:function(c,b,e,d){var j=e/this.tilesize/ig.system.scale+1,f=d/this.tilesize/ig.system.scale+1,p=c*this.chunkSize/ig.system.scale%this.tilesize,l=b*this.chunkSize/ig.system.scale%this.tilesize;c=Math.floor(c*this.chunkSize/this.tilesize/ig.system.scale);b=Math.floor(b*this.chunkSize/this.tilesize/ig.system.scale);var g=ig.$new("canvas");g.width=e;g.height=d;g.retinaResolutionEnabled=!1;d=g.getContext("2d");ig.System.scaleMode(g,d);e=ig.system.context;
ig.system.context=d;for(d=0;d<j;d++)for(var m=0;m<f;m++)if(d+c<this.width&&m+b<this.height){var n=this.data[m+b][d+c];n&&this.tiles.drawTile(d*this.tilesize-p,m*this.tilesize-l,n-1,this.tilesize)}ig.system.context=e;return g},draw:function(){this.tiles.loaded&&this.enabled&&(this.preRender?this.drawPreRendered():this.drawTiled())},drawPreRendered:function(){this.preRenderedChunks||this.preRenderMapToChunks();var c=ig.system.getDrawPos(this.scroll.x),b=ig.system.getDrawPos(this.scroll.y);if(this.repeat)var e=
this.width*this.tilesize*ig.system.scale,c=(c%e+e)%e,e=this.height*this.tilesize*ig.system.scale,b=(b%e+e)%e;var e=Math.max(Math.floor(c/this.chunkSize),0),d=Math.max(Math.floor(b/this.chunkSize),0),j=Math.ceil((c+ig.system.realWidth)/this.chunkSize),f=Math.ceil((b+ig.system.realHeight)/this.chunkSize),p=this.preRenderedChunks[0].length,l=this.preRenderedChunks.length;this.repeat||(j=Math.min(j,p),f=Math.min(f,l));for(var g=0;d<f;d++){for(var m=0,n=e;n<j;n++){var r=this.preRenderedChunks[d%l][n%p],
s=-c+n*this.chunkSize-m,t=-b+d*this.chunkSize-g;ig.system.context.drawImage(r,s,t);ig.Image.drawCount++;this.debugChunks&&(ig.system.context.strokeStyle="#f0f",ig.system.context.strokeRect(s,t,this.chunkSize,this.chunkSize));this.repeat&&(r.width<this.chunkSize&&s+r.width<ig.system.realWidth)&&(m+=this.chunkSize-r.width,j++)}this.repeat&&(r.height<this.chunkSize&&t+r.height<ig.system.realHeight)&&(g+=this.chunkSize-r.height,f++)}},drawTiled:function(){for(var c=0,b=null,e=(this.scroll.x/this.tilesize).toInt(),
d=(this.scroll.y/this.tilesize).toInt(),j=this.scroll.x%this.tilesize,f=this.scroll.y%this.tilesize,p=-j-this.tilesize,j=ig.system.width+this.tilesize-j,l=ig.system.height+this.tilesize-f,g=-1,f=-f-this.tilesize;f<l;g++,f+=this.tilesize){var m=g+d;if(m>=this.height||0>m){if(!this.repeat)continue;m=(m%this.height+this.height)%this.height}for(var n=-1,r=p;r<j;n++,r+=this.tilesize){c=n+e;if(c>=this.width||0>c){if(!this.repeat)continue;c=(c%this.width+this.width)%this.width}if(c=this.data[m][c])(b=this.anims[c-
1])?b.draw(r,f):this.tiles.drawTile(r,f,c-1,this.tilesize)}}}})});ig.baked=!0;
ig.module("impact.game").requires("impact.impact","impact.entity","impact.collision-map","impact.background-map").defines(function(){ig.Game=ig.Class.extend({clearColor:"#000000",gravity:0,screen:{x:0,y:0},_rscreen:{x:0,y:0},entities:[],namedEntities:{},collisionMap:ig.CollisionMap.staticNoCollision,backgroundMaps:[],backgroundAnims:{},autoSort:!1,sortBy:null,cellSize:64,_deferredKill:[],_levelToLoad:null,_doSortEntities:!1,staticInstantiate:function(){this.sortBy=this.sortBy||ig.Game.SORT.Z_INDEX;
ig.game=this;return null},loadLevel:function(c){this.screen={x:0,y:0};this.entities=[];this.namedEntities={};for(var b=0;b<c.entities.length;b++){var e=c.entities[b];this.spawnEntity(e.type,e.x,e.y,e.settings)}this.sortEntities();this.collisionMap=ig.CollisionMap.staticNoCollision;this.backgroundMaps=[];for(b=0;b<c.layer.length;b++)if(e=c.layer[b],"collision"==e.name)this.collisionMap=new ig.CollisionMap(e.tilesize,e.data);else{var d=new ig.BackgroundMap(e.tilesize,e.data,e.tilesetName);d.anims=this.backgroundAnims[e.tilesetName]||
{};d.repeat=e.repeat;d.distance=e.distance;d.foreground=!!e.foreground;d.preRender=!!e.preRender;d.name=e.name;this.backgroundMaps.push(d)}for(b=0;b<this.entities.length;b++)this.entities[b].ready()},loadLevelDeferred:function(c){this._levelToLoad=c},getMapByName:function(c){if("collision"==c)return this.collisionMap;for(var b=0;b<this.backgroundMaps.length;b++)if(this.backgroundMaps[b].name==c)return this.backgroundMaps[b];return null},getEntityByName:function(c){return this.namedEntities[c]},getEntitiesByType:function(c){c=
"string"===typeof c?ig.global[c]:c;for(var b=[],e=0;e<this.entities.length;e++){var d=this.entities[e];d instanceof c&&!d._killed&&b.push(d)}return b},spawnEntity:function(c,b,e,d){var j="string"===typeof c?ig.global[c]:c;if(!j)throw"Can't spawn entity of type "+c;c=new j(b,e,d||{});this.entities.push(c);c.name&&(this.namedEntities[c.name]=c);return c},sortEntities:function(){this.entities.sort(this.sortBy)},sortEntitiesDeferred:function(){this._doSortEntities=!0},removeEntity:function(c){c.name&&
delete this.namedEntities[c.name];c._killed=!0;c.type=ig.Entity.TYPE.NONE;c.checkAgainst=ig.Entity.TYPE.NONE;c.collides=ig.Entity.COLLIDES.NEVER;this._deferredKill.push(c)},run:function(){this.update();this.draw()},update:function(){this._levelToLoad&&(this.loadLevel(this._levelToLoad),this._levelToLoad=null);this.updateEntities();this.checkEntities();for(var c=0;c<this._deferredKill.length;c++)this._deferredKill[c].erase(),this.entities.erase(this._deferredKill[c]);this._deferredKill=[];if(this._doSortEntities||
this.autoSort)this.sortEntities(),this._doSortEntities=!1;for(var b in this.backgroundAnims){var c=this.backgroundAnims[b],e;for(e in c)c[e].update()}},updateEntities:function(){for(var c=0;c<this.entities.length;c++){var b=this.entities[c];b._killed||b.update()}},draw:function(){this.clearColor&&ig.system.clear(this.clearColor);this._rscreen.x=ig.system.getDrawPos(this.screen.x)/ig.system.scale;this._rscreen.y=ig.system.getDrawPos(this.screen.y)/ig.system.scale;var c;for(c=0;c<this.backgroundMaps.length;c++){var b=
this.backgroundMaps[c];if(b.foreground)break;b.setScreenPos(this.screen.x,this.screen.y);b.draw()}this.drawEntities();for(c;c<this.backgroundMaps.length;c++)b=this.backgroundMaps[c],b.setScreenPos(this.screen.x,this.screen.y),b.draw()},drawEntities:function(){for(var c=0;c<this.entities.length;c++)this.entities[c].draw()},checkEntities:function(){for(var c={},b=0;b<this.entities.length;b++){var e=this.entities[b];if(!(e.type==ig.Entity.TYPE.NONE&&e.checkAgainst==ig.Entity.TYPE.NONE&&e.collides==ig.Entity.COLLIDES.NEVER))for(var d=
{},j=Math.floor(e.pos.y/this.cellSize),f=Math.floor((e.pos.x+e.size.x)/this.cellSize)+1,p=Math.floor((e.pos.y+e.size.y)/this.cellSize)+1,l=Math.floor(e.pos.x/this.cellSize);l<f;l++)for(var g=j;g<p;g++)if(c[l])if(c[l][g]){for(var m=c[l][g],n=0;n<m.length;n++)e.touches(m[n])&&!d[m[n].id]&&(d[m[n].id]=!0,ig.Entity.checkPair(e,m[n]));m.push(e)}else c[l][g]=[e];else c[l]={},c[l][g]=[e]}}});ig.Game.SORT={Z_INDEX:function(c,b){return c.zIndex-b.zIndex},POS_X:function(c,b){return c.pos.x+c.size.x-(b.pos.x+
b.size.x)},POS_Y:function(c,b){return c.pos.y+c.size.y-(b.pos.y+b.size.y)}}});ig.baked=!0;
ig.module("impact.debug.menu").requires("dom.ready","impact.system").defines(function(){ig.System.inject({run:function(){ig.debug.beforeRun();this.parent();ig.debug.afterRun()},setGameNow:function(c){this.parent(c);ig.debug.ready()}});ig.Debug=ig.Class.extend({options:{},panels:{},numbers:{},container:null,panelMenu:null,activePanel:null,debugTime:0,debugTickAvg:0.016,debugRealTime:Date.now(),init:function(){var c=ig.$new("link");c.rel="stylesheet";c.type="text/css";c.href=ig.prefix+"lib/impact/debug/debug.css";
ig.$("body")[0].appendChild(c);this.container=ig.$new("div");this.container.className="ig_debug";ig.$("body")[0].appendChild(this.container);this.panelMenu=ig.$new("div");this.panelMenu.innerHTML='<div class="ig_debug_head">Impact.Debug:</div>';this.panelMenu.className="ig_debug_panel_menu";this.container.appendChild(this.panelMenu);this.numberContainer=ig.$new("div");this.numberContainer.className="ig_debug_stats";this.panelMenu.appendChild(this.numberContainer);window.console&&(window.console.log&&
window.console.assert)&&(ig.log=console.log.bind?console.log.bind(console):console.log,ig.assert=console.assert.bind?console.assert.bind(console):console.assert);ig.show=this.showNumber.bind(this)},addNumber:function(c){var b=ig.$new("span");this.numberContainer.appendChild(b);this.numberContainer.appendChild(document.createTextNode(c));this.numbers[c]=b},showNumber:function(c,b,e){this.numbers[c]||this.addNumber(c,e);this.numbers[c].textContent=b},addPanel:function(c){var b=new c.type(c.name,c.label);
if(c.options)for(var e=0;e<c.options.length;e++){var d=c.options[e];b.addOption(new ig.DebugOption(d.name,d.object,d.property))}this.panels[b.name]=b;b.container.style.display="none";this.container.appendChild(b.container);c=ig.$new("div");c.className="ig_debug_menu_item";c.textContent=b.label;c.addEventListener("click",function(){this.togglePanel(b)}.bind(this),!1);b.menuItem=c;d=!1;for(e=1;e<this.panelMenu.childNodes.length;e++){var j=this.panelMenu.childNodes[e];if(j.textContent>b.label){this.panelMenu.insertBefore(c,
j);d=!0;break}}d||this.panelMenu.appendChild(c)},showPanel:function(c){this.togglePanel(this.panels[c])},togglePanel:function(c){c!=this.activePanel&&this.activePanel&&(this.activePanel.toggle(!1),this.activePanel.menuItem.className="ig_debug_menu_item",this.activePanel=null);var b="block"!=c.container.style.display;c.toggle(b);c.menuItem.className="ig_debug_menu_item"+(b?" active":"");b&&(this.activePanel=c)},ready:function(){for(var c in this.panels)this.panels[c].ready()},beforeRun:function(){var c=
Date.now();this.debugTickAvg=0.8*this.debugTickAvg+0.2*(c-this.debugRealTime);this.debugRealTime=c;this.activePanel&&this.activePanel.beforeRun()},afterRun:function(){var c=Date.now()-this.debugRealTime;this.debugTime=0.8*this.debugTime+0.2*c;this.activePanel&&this.activePanel.afterRun();this.showNumber("ms",this.debugTime.toFixed(2));this.showNumber("fps",Math.round(1E3/this.debugTickAvg));this.showNumber("draws",ig.Image.drawCount);ig.game&&ig.game.entities&&this.showNumber("entities",ig.game.entities.length);
ig.Image.drawCount=0}});ig.DebugPanel=ig.Class.extend({active:!1,container:null,options:[],panels:[],label:"",name:"",init:function(c,b){this.name=c;this.label=b;this.container=ig.$new("div");this.container.className="ig_debug_panel "+this.name},toggle:function(c){this.active=c;this.container.style.display=c?"block":"none"},addPanel:function(c){this.panels.push(c);this.container.appendChild(c.container)},addOption:function(c){this.options.push(c);this.container.appendChild(c.container)},ready:function(){},
beforeRun:function(){},afterRun:function(){}});ig.DebugOption=ig.Class.extend({name:"",labelName:"",className:"ig_debug_option",label:null,mark:null,container:null,active:!1,colors:{enabled:"#fff",disabled:"#444"},init:function(c,b,e){this.name=c;this.object=b;this.property=e;this.active=this.object[this.property];this.container=ig.$new("div");this.container.className="ig_debug_option";this.label=ig.$new("span");this.label.className="ig_debug_label";this.label.textContent=this.name;this.mark=ig.$new("span");
this.mark.className="ig_debug_label_mark";this.container.appendChild(this.mark);this.container.appendChild(this.label);this.container.addEventListener("click",this.click.bind(this),!1);this.setLabel()},setLabel:function(){this.mark.style.backgroundColor=this.active?this.colors.enabled:this.colors.disabled},click:function(c){this.active=!this.active;this.object[this.property]=this.active;this.setLabel();c.stopPropagation();c.preventDefault();return!1}});ig.debug=new ig.Debug});ig.baked=!0;
ig.module("impact.debug.entities-panel").requires("impact.debug.menu","impact.entity").defines(function(){ig.Entity.inject({colors:{names:"#fff",velocities:"#0f0",boxes:"#f00"},pos:{x:0,y:0},draw:function(){this.parent();ig.Entity._debugShowBoxes&&(ig.system.context.strokeStyle=this.colors.boxes,ig.system.context.lineWidth=1,ig.system.context.strokeRect(ig.system.getDrawPos(this.pos.x.round()-ig.game.screen.x)-0.5,ig.system.getDrawPos(this.pos.y.round()-ig.game.screen.y)-0.5,this.size.x*ig.system.scale,
this.size.y*ig.system.scale));if(ig.Entity._debugShowVelocities){var c=this.pos.x+this.size.x/2,b=this.pos.y+this.size.y/2;this._debugDrawLine(this.colors.velocities,c,b,c+this.vel.x,b+this.vel.y)}if(ig.Entity._debugShowNames&&(this.name&&(ig.system.context.fillStyle=this.colors.names,ig.system.context.fillText(this.name,ig.system.getDrawPos(this.pos.x-ig.game.screen.x),ig.system.getDrawPos(this.pos.y-ig.game.screen.y))),"object"==typeof this.target))for(var e in this.target)(c=ig.game.getEntityByName(this.target[e]))&&
this._debugDrawLine(this.colors.names,this.pos.x+this.size.x/2,this.pos.y+this.size.y/2,c.pos.x+c.size.x/2,c.pos.y+c.size.y/2)},_debugDrawLine:function(c,b,e,d,j){ig.system.context.strokeStyle=c;ig.system.context.lineWidth=1;ig.system.context.beginPath();ig.system.context.moveTo(ig.system.getDrawPos(b-ig.game.screen.x),ig.system.getDrawPos(e-ig.game.screen.y));ig.system.context.lineTo(ig.system.getDrawPos(d-ig.game.screen.x),ig.system.getDrawPos(j-ig.game.screen.y));ig.system.context.stroke();ig.system.context.closePath()}});
ig.Entity._debugEnableChecks=!0;ig.Entity._debugShowBoxes=!1;ig.Entity._debugShowVelocities=!1;ig.Entity._debugShowNames=!1;ig.Entity.oldCheckPair=ig.Entity.checkPair;ig.Entity.checkPair=function(c,b){ig.Entity._debugEnableChecks&&ig.Entity.oldCheckPair(c,b)};ig.debug.addPanel({type:ig.DebugPanel,name:"entities",label:"Entities",options:[{name:"Checks & Collisions",object:ig.Entity,property:"_debugEnableChecks"},{name:"Show Collision Boxes",object:ig.Entity,property:"_debugShowBoxes"},{name:"Show Velocities",
object:ig.Entity,property:"_debugShowVelocities"},{name:"Show Names & Targets",object:ig.Entity,property:"_debugShowNames"}]})});ig.baked=!0;
ig.module("impact.debug.maps-panel").requires("impact.debug.menu","impact.game","impact.background-map").defines(function(){ig.Game.inject({loadLevel:function(c){this.parent(c);ig.debug.panels.maps.load(this)}});ig.DebugMapsPanel=ig.DebugPanel.extend({maps:[],mapScreens:[],init:function(c,b){this.parent(c,b);this.load()},load:function(c){this.options=[];this.panels=[];if(!c||!c.backgroundMaps.length)this.container.innerHTML="<em>No Maps Loaded</em>";else{this.maps=c.backgroundMaps;this.mapScreens=
[];this.container.innerHTML="";for(c=0;c<this.maps.length;c++){var b=this.maps[c],e=new ig.DebugPanel(c,"Layer "+c),d=new ig.$new("strong");d.textContent=c+": "+b.tiles.path;e.container.appendChild(d);e.addOption(new ig.DebugOption("Enabled",b,"enabled"));e.addOption(new ig.DebugOption("Pre Rendered",b,"preRender"));e.addOption(new ig.DebugOption("Show Chunks",b,"debugChunks"));this.generateMiniMap(e,b,c);this.addPanel(e)}}},generateMiniMap:function(c,b,e){var d=ig.system.scale,j=ig.$new("canvas"),
f=j.getContext("2d"),p=b.tiles.width*d,l=b.tiles.height*d,g=p/b.tilesize,m=l/b.tilesize;j.width=g;j.height=m;f.drawImage(b.tiles.data,0,0,p,l,0,0,g,m);f=ig.$new("canvas");f.width=b.width*d;f.height=b.height*d;m=f.getContext("2d");ig.game.clearColor&&(m.fillStyle=ig.game.clearColor,m.fillRect(0,0,p,l));for(l=p=0;l<b.width;l++)for(var n=0;n<b.height;n++)(p=b.data[n][l])&&m.drawImage(j,Math.floor((p-1)*d%g),Math.floor((p-1)*d/g)*d,d,d,l*d,n*d,d,d);j=ig.$new("div");j.className="ig_debug_map_container";
j.style.width=b.width*d+"px";j.style.height=b.height*d+"px";g=ig.$new("div");g.className="ig_debug_map_screen";g.style.width=ig.system.width/b.tilesize*d-2+"px";g.style.height=ig.system.height/b.tilesize*d-2+"px";this.mapScreens[e]=g;j.appendChild(f);j.appendChild(g);c.container.appendChild(j)},afterRun:function(){for(var c=ig.system.scale,b=0;b<this.maps.length;b++){var e=this.maps[b],d=this.mapScreens[b];if(e&&d){var j=e.scroll.x/e.tilesize,f=e.scroll.y/e.tilesize;e.repeat&&(j%=e.width,f%=e.height);
d.style.left=j*c+"px";d.style.top=f*c+"px"}}}});ig.debug.addPanel({type:ig.DebugMapsPanel,name:"maps",label:"Background Maps"})});ig.baked=!0;
ig.module("impact.debug.graph-panel").requires("impact.debug.menu","impact.system","impact.game","impact.image").defines(function(){ig.Game.inject({draw:function(){ig.graph.beginClock("draw");this.parent();ig.graph.endClock("draw")},update:function(){ig.graph.beginClock("update");this.parent();ig.graph.endClock("update")},checkEntities:function(){ig.graph.beginClock("checks");this.parent();ig.graph.endClock("checks")}});ig.DebugGraphPanel=ig.DebugPanel.extend({clocks:{},marks:[],textY:0,height:128,
ms:64,timeBeforeRun:0,init:function(c,b){this.parent(c,b);this.mark16ms=(this.height-16*(this.height/this.ms)).round();this.mark33ms=(this.height-33*(this.height/this.ms)).round();this.msHeight=this.height/this.ms;this.graph=ig.$new("canvas");this.graph.width=window.innerWidth;this.graph.height=this.height;this.container.appendChild(this.graph);this.ctx=this.graph.getContext("2d");this.ctx.fillStyle="#444";this.ctx.fillRect(0,this.mark16ms,this.graph.width,1);this.ctx.fillRect(0,this.mark33ms,this.graph.width,
1);this.addGraphMark("16ms",this.mark16ms);this.addGraphMark("33ms",this.mark33ms);this.addClock("draw","Draw","#13baff");this.addClock("update","Entity Update","#bb0fff");this.addClock("checks","Entity Checks & Collisions","#a2e908");this.addClock("lag","System Lag","#f26900");ig.mark=this.mark.bind(this);ig.graph=this},addGraphMark:function(c,b){var e=ig.$new("span");e.className="ig_debug_graph_mark";e.textContent=c;e.style.top=b.round()+"px";this.container.appendChild(e)},addClock:function(c,b,
e){var d=ig.$new("span");d.className="ig_debug_legend_color";d.style.backgroundColor=e;var j=ig.$new("span");j.className="ig_debug_legend_number";j.appendChild(document.createTextNode("0"));var f=ig.$new("span");f.className="ig_debug_legend";f.appendChild(d);f.appendChild(document.createTextNode(b+" ("));f.appendChild(j);f.appendChild(document.createTextNode("ms)"));this.container.appendChild(f);this.clocks[c]={description:b,color:e,current:0,start:Date.now(),avg:0,html:j}},beginClock:function(c,
b){this.clocks[c].start=Date.now()+(b||0)},endClock:function(c){c=this.clocks[c];c.current=Math.round(Date.now()-c.start);c.avg=0.8*c.avg+0.2*c.current},mark:function(c,b){this.active&&this.marks.push({msg:c,color:b||"#fff"})},beforeRun:function(){this.endClock("lag");this.timeBeforeRun=Date.now()},afterRun:function(){var c=Date.now()-this.timeBeforeRun;this.beginClock("lag",Math.max(1E3/ig.system.fps-c,0));var c=this.graph.width-1,b=this.height;this.ctx.drawImage(this.graph,-1,0);this.ctx.fillStyle=
"#000";this.ctx.fillRect(c,0,1,this.height);this.ctx.fillStyle="#444";this.ctx.fillRect(c,this.mark16ms,1,1);this.ctx.fillStyle="#444";this.ctx.fillRect(c,this.mark33ms,1,1);for(var e in this.clocks){var d=this.clocks[e];d.html.textContent=d.avg.toFixed(2);if(d.color&&0<d.current){this.ctx.fillStyle=d.color;var j=d.current*this.msHeight,b=b-j;this.ctx.fillRect(c,b,1,j);d.current=0}}this.ctx.textAlign="right";this.ctx.textBaseline="top";this.ctx.globalAlpha=0.5;for(e=0;e<this.marks.length;e++)b=this.marks[e],
this.ctx.fillStyle=b.color,this.ctx.fillRect(c,0,1,this.height),b.msg&&(this.ctx.fillText(b.msg,c-1,this.textY),this.textY=(this.textY+8)%32);this.ctx.globalAlpha=1;this.marks=[]}});ig.debug.addPanel({type:ig.DebugGraphPanel,name:"graph",label:"Performance"})});ig.baked=!0;ig.module("impact.debug.debug").requires("impact.debug.entities-panel","impact.debug.maps-panel","impact.debug.graph-panel").defines(function(){});ig.baked=!0;
ig.module("plugins.patches.timer-patch").requires("impact.timer").defines(function(){ig.Timer.step=function(){var c=Date.now(),b=(c-ig.Timer._last)/1E3;0>b&&(b=0);ig.Timer.time+=Math.min(b,ig.Timer.maxStep)*ig.Timer.timeScale;ig.Timer._last=c}});ig.baked=!0;
ig.module("plugins.patches.user-agent-patch").defines(function(){ig.ua.touchDevice="ontouchstart"in window||window.navigator.msMaxTouchPoints||window.navigator.maxTouchPoints;ig.ua.is_mac="MacIntel"===navigator.platform;ig.ua.iOS=ig.ua.touchDevice&&ig.ua.is_mac||ig.ua.iOS;ig.ua.mobile=ig.ua.iOS||ig.ua.mobile});ig.baked=!0;
ig.module("plugins.patches.webkit-image-smoothing-patch").defines(function(){ig.System&&(ig.System.SCALE={CRISP:function(c,b){b.imageSmoothingEnabled=b.msImageSmoothingEnabled=b.mozImageSmoothingEnabled=b.oImageSmoothingEnabled=!1;c.style.imageRendering="-moz-crisp-edges";c.style.imageRendering="-o-crisp-edges";c.style.imageRendering="-webkit-optimize-contrast";c.style.imageRendering="crisp-edges";c.style.msInterpolationMode="nearest-neighbor"},SMOOTH:function(c,b){b.imageSmoothingEnabled=b.msImageSmoothingEnabled=
b.mozImageSmoothingEnabled=b.oImageSmoothingEnabled=!0;c.style.imageRendering="";c.style.msInterpolationMode=""}},ig.System.scaleMode=ig.System.SCALE.SMOOTH)});ig.baked=!0;
ig.module("plugins.patches.windowfocus-onMouseDown-patch").requires("impact.input").defines(function(){var c=!1;try{c=window.self!==window.top,!1===c&&(c=0<window.frames.length)}catch(b){c=!0}ig.Input.inject({keydown:function(b){var d=b.target.tagName;if(!("INPUT"==d||"TEXTAREA"==d))if(d="keydown"==b.type?b.keyCode:2==b.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1,c&&0>d&&window.focus(),("touchstart"==b.type||"mousedown"==b.type)&&this.mousemove(b),d=this.bindings[d])this.actions[d]=!0,this.locks[d]||(this.presses[d]=
!0,this.locks[d]=!0),b.stopPropagation(),b.preventDefault()}})});ig.baked=!0;
ig.module("plugins.patches.input-patch").requires("impact.input").defines(function(){ig.Input.inject({move:new BABYLON.Vector2(0,0),initMouse:function(){if(!this.isUsingMouse){this.isUsingMouse=!0;var c=this.mousewheel.bind(this);ig.system.canvas.addEventListener("mousewheel",c,!1);ig.system.canvas.addEventListener("DOMMouseScroll",c,!1);ig.system.canvas.addEventListener("contextmenu",this.contextmenu.bind(this),!1);ig.system.canvas.addEventListener("mousedown",this.keydown.bind(this),!1);ig.system.canvas.addEventListener("mouseup",
this.keyup.bind(this),!1);ig.system.canvas.addEventListener("mousemove",this.mousemove.bind(this),!1);ig.ua.touchDevice&&(ig.system.canvas.addEventListener("touchstart",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.mousemove.bind(this),!1),ig.system.canvas.addEventListener("MSPointerDown",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("MSPointerUp",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",
this.mousemove.bind(this),!1),ig.system.canvas.style.msTouchAction="none")}},mousemove:function(c){var b=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth;ig.ua.mobile&&(b=ig.system.realWidth);var b=ig.system.scale*(b/ig.system.realWidth),e={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());var d=c.touches?c.touches[0]:c;this.mouse.x=(d.clientX-e.left)/b;this.mouse.y=(d.clientY-e.top)/b;void 0!==typeof c.movementX?(this.move.x=c.movementX,
this.move.y=c.movementY):(this.move.x=0,this.move.y=0);try{ig.soundHandler.unlockWebAudio()}catch(j){}},keyup:function(c){var b=c.target.tagName;if(!("INPUT"==b||"TEXTAREA"==b)){if(b=this.bindings["keyup"==c.type?c.keyCode:2==c.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1])this.delayedKeyup[b]=!0,c.stopPropagation(),c.preventDefault();if(ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(e){}}}})});ig.baked=!0;
ig.module("plugins.data.vector").defines(function(){Vector2=ig.Class.extend({x:null,y:null,valType:"number",init:function(c,b){typeof c===this.valType&&typeof b===this.valType&&(this.x=c,this.y=b)},row:function(c){typeof c===this.valType&&(this.y=c);return this.y},col:function(c){typeof c===this.valType&&(this.x=c);return this.x},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},unitVector:function(){var c=this.magnitude();if(0<c)return new Vector2(this.x/c,this.y/c);throw"Divide by 0 error in unitVector function of vector:"+
this;},add:function(c){return new Vector2(this.x+c.x,this.y+c.y)},subtract:function(c){return new Vector2(this.x-c.x,this.y-c.y)},dotProduct:function(c){return this.x*c.x+this.y*c.y},multiplyByScalar:function(c){return new Vector2(c*this.x,c*this.y)}})});ig.baked=!0;
ig.module("plugins.data.color-rgb").defines(function(){ColorRGB=function(c,b,e,d){this.r=c||0;this.g=b||0;this.b=e||0;this.a=d||0};ColorRGB.prototype={setRandomColor:function(){this.r=Math.round(255*Math.random());this.g=Math.round(255*Math.random());this.b=Math.round(255*Math.random())},getStyle:function(){return"rgba("+this.r+","+this.g+","+this.b+","+this.a+")"},getHex:function(){for(var c=this.r.toString(16),b=this.g.toString(16),e=this.b.toString(16);2>c.length;)c="0"+c;for(;2>b.length;)b="0"+
b;for(;2>e.length;)e="0"+e;return"#"+c+b+e},getInvertedColor:function(){return new ColorRGB(255-this.r,255-this.g,255-this.b,255-this.a)},clone:function(){return new ColorRGB(this.r,this.g,this.b,this.a)}}});ig.baked=!0;
ig.module("plugins.font.font-info").requires("impact.impact").defines(function(){ig.FontInfo=ig.Class.extend({fonts:[{name:"mainfont",source:"media/fonts/mainfont"}],init:function(){this.registerCssFont()},getKeys:function(){for(var c={},b=0;b<this.fonts.length;b++){for(var e=this.fonts[b].name,d=e.split("-"),j="",f=0;f<d.length;f++)j+=d[f];c[j]=e}return c},registerCssFont:function(){if(0<this.fonts.length){var c=document.createElement("style");c.type="text/css";for(var b="",e=0;e<this.fonts.length;e++)var d=
this.fonts[e],b=b+("@font-face {font-family: '"+d.name+"';src: url('"+d.source+".eot');src: url('"+d.source+".eot?#iefix') format('embedded-opentype'),url('"+d.source+".woff2') format('woff2'),url('"+d.source+".woff') format('woff'),url('"+d.source+".ttf') format('truetype'),url('"+d.source+".svg#svgFontName') format('svg')}");c.appendChild(document.createTextNode(b));document.head.appendChild(c)}},isValid:function(){for(var c=0;c<this.fonts.length;c++)if(!this._isValidName(this.fonts[c].source))return!1;
return!0},_isValidName:function(c){return-1==c.search(/^[a-z0-9-\/]+$/)?!1:!0}})});ig.baked=!0;
ig.module("plugins.font.font-loader").requires("impact.impact","plugins.font.font-info","impact.loader").defines(function(){ig.FontLoader=ig.Class.extend({fontInfo:new ig.FontInfo,onload:!1,onerror:!1,init:function(c,b){this.onload=c;this.onerror=b},load:function(){this.fontInfo.isValid()?this._loadByLib():console.error("Only lowercased alphanumeric and dash are allowed for font file name!. Please check the font path")},_loadByLib:function(){for(var c=[],b=0;b<this.fontInfo.fonts.length;b++){var e=
new FontFaceObserver(this.fontInfo.fonts[b].name);c.push(e.load())}Promise.all(c).then(this.onload).catch(this.onerror)}});ig.Loader.inject({parentLoad:!1,load:function(){this.parentLoad=this.parent;this.fontLoader=(new ig.FontLoader(this.onFontLoad.bind(this),this.onFontError.bind(this))).load()},onFontLoad:function(){this.parentLoad()},onFontError:function(){console.error("Font is not loaded")}})});ig.baked=!0;
ig.module("plugins.handlers.dom-handler").defines(function(){ig.DomHandler=ig.Class.extend({JQUERYAVAILABLE:!1,init:function(){this.JQUERYAVAILABLE=this._jqueryAvailable()},_jqueryAvailable:function(){return"undefined"!==typeof jQuery},addEvent:function(c,b,e,d){if(this.JQUERYAVAILABLE)c.on(b,e);else c.addEventListener(b,e,d)},create:function(c){return this.JQUERYAVAILABLE?$("<"+c+">"):ig.$new(c)},getElementByClass:function(c){return this.JQUERYAVAILABLE?$("."+c):document.getElementsByClassName(c)},
getElementById:function(c){return this.JQUERYAVAILABLE?0<$(c).length?$(c):null:ig.$(c)},appendChild:function(c,b){this.JQUERYAVAILABLE?c.append(b):c.appendChild(b)},appendToBody:function(c){this.JQUERYAVAILABLE?$("body").append(c):document.body.appendChild(c)},resize:function(c,b,e){if(this.JQUERYAVAILABLE)c.width(b.toFixed(2)),c.height(e.toFixed(2));else{var d=c.style.visibility;b="width:"+b.toFixed(2)+"px; height:"+e.toFixed(2)+"px;";this.attr(c,"style",b);c.style.visibility=d}},resizeOffsetLeft:function(c,
b,e,d){if(this.JQUERYAVAILABLE)c.width(b.toFixed(2)),c.height(e.toFixed(2)),c.css("left",d);else{var j=c.style.visibility;b="width:"+b.toFixed(2)+"px; height:"+e.toFixed(2)+"px; left: "+d.toFixed(2)+"px;";this.attr(c,"style",b);c.style.visibility=j}},resizeOffset:function(c,b,e,d,j){if(this.JQUERYAVAILABLE)c.width(b.toFixed(2)),c.height(e.toFixed(2)),c.css("left",d),c.css("top",j);else{var f=c.style.visibility;b="width:"+b.toFixed(2)+"px; height:"+e.toFixed(2)+"px; left: "+d.toFixed(2)+"px; top: "+
j.toFixed(2)+"px;";this.attr(c,"style",b);c.style.visibility=f}},css:function(c,b){if(this.JQUERYAVAILABLE)c.css(b);else{var e="",d;for(d in b)e+=d+":"+b[d]+";";this.attr(c,"style",e)}},getOffsets:function(c){return this.JQUERYAVAILABLE?(c=c.offset(),{left:c.left,top:c.top}):{left:c.offsetLeft,top:c.offsetTop}},attr:function(c,b,e){if("undefined"===typeof e)return this.JQUERYAVAILABLE?c.attr(b):c.getAttribute(b);this.JQUERYAVAILABLE?c.attr(b,e):c.setAttribute(b,e)},show:function(c){this.JQUERYAVAILABLE?
(c.show(),c.css("visibility","visible")):c&&(c.style?c.style.visibility="visible":c[0]&&(c[0].style.visibility="visible"))},hide:function(c){this.JQUERYAVAILABLE?(c.hide(),c.css("visibility","hidden")):c&&(c.style?c.style.visibility="hidden":c[0]&&(c[0].style.visibility="hidden"))},getQueryVariable:function(c){for(var b=window.location.search.substring(1).split("&"),e=0;e<b.length;e++){var d=b[e].match(/([^=]+?)=(.+)/);if(d&&decodeURIComponent(d[1])==c)return decodeURIComponent(d[2])}},forcedDeviceDetection:function(){var c=
this.getQueryVariable("device");if(c)switch(c){case "mobile":console.log("serving mobile version ...");ig.ua.mobile=!0;break;case "desktop":console.log("serving desktop version ...");ig.ua.mobile=!1;break;default:console.log("serving universal version ...")}else console.log("serving universal version ...")},forcedDeviceRotation:function(){var c=this.getQueryVariable("force-rotate");if(c)switch(c){case "portrait":console.log("force rotate to portrait");window.orientation=0;break;case "landscape":console.log("force rotate to horizontal");
window.orientation=90;break;default:alert("wrong command/type in param force-rotate. Defaulting value to portrait"),window.orientation=0}},setZIndex:function(c,b){this.JQUERYAVAILABLE?c.css("zIndex",b):c&&(c.style?c.style.zIndex=b:c[0]&&(c[0].style.zIndex=b))}})});ig.baked=!0;
ig.module("plugins.handlers.size-handler").defines(function(){ig.SizeHandler=ig.Class.extend({portraitMode:!0,disableStretchToFitOnMobileFlag:!1,enableStretchToFitOnAntiPortraitModeFlag:!0,enableScalingLimitsOnMobileFlag:!1,minScalingOnMobile:0,maxScalingOnMobile:1,enableStretchToFitOnDesktopFlag:!1,enableScalingLimitsOnDesktopFlag:!1,minScalingOnDesktop:0,maxScalingOnDesktop:1,desktop:{actualSize:new BABYLON.Vector2(window.innerWidth,window.innerHeight),actualResolution:new BABYLON.Vector2(540,960)},
mobile:{actualSize:new BABYLON.Vector2(window.innerWidth,window.innerHeight),actualResolution:new BABYLON.Vector2(540,960)},windowSize:new BABYLON.Vector2(window.innerWidth,window.innerHeight),scaleRatioMultiplier:new BABYLON.Vector2(1,1),sizeRatio:new BABYLON.Vector2(1,1),scale:1,domHandler:null,dynamicClickableEntityDivs:{},coreDivsToResize:["#webglcanvas","#canvas","#play","#orientate"],adsToResize:{MobileAdInGamePreroll:{"box-width":_SETTINGS.Ad.Mobile.Preroll.Width+2,"box-height":_SETTINGS.Ad.Mobile.Preroll.Height+
20},MobileAdInGameEnd:{"box-width":_SETTINGS.Ad.Mobile.End.Width+2,"box-height":_SETTINGS.Ad.Mobile.End.Height+20},MobileAdInGamePreroll2:{"box-width":_SETTINGS.Ad.Mobile.Preroll.Width+2,"box-height":_SETTINGS.Ad.Mobile.Preroll.Height+20},MobileAdInGameEnd2:{"box-width":_SETTINGS.Ad.Mobile.End.Width+2,"box-height":_SETTINGS.Ad.Mobile.End.Height+20},MobileAdInGamePreroll3:{"box-width":_SETTINGS.Ad.Mobile.Preroll.Width+2,"box-height":_SETTINGS.Ad.Mobile.Preroll.Height+20},MobileAdInGameEnd3:{"box-width":_SETTINGS.Ad.Mobile.End.Width+
2,"box-height":_SETTINGS.Ad.Mobile.End.Height+20}},init:function(c){this.domHandler=c;if("undefined"===typeof c)throw"undefined Dom Handler for Size Handler";this.sizeCalcs();this.eventListenerSetup();this.samsungFix()},sizeCalcs:function(){this.windowSize=new Vector2(window.innerWidth,window.innerHeight);if(ig.ua.mobile){this.mobile.actualSize=new Vector2(window.innerWidth,window.innerHeight);var c=new Vector2(this.mobile.actualResolution.x,this.mobile.actualResolution.y);this.scaleRatioMultiplier=
new Vector2(this.mobile.actualSize.x/c.x,this.mobile.actualSize.y/c.y);if(this.disableStretchToFitOnMobileFlag){var b=Math.min(this.scaleRatioMultiplier.x,this.scaleRatioMultiplier.y);this.enableScalingLimitsOnMobileFlag&&(b=b.limit(this.minScalingOnMobile,this.maxScalingOnMobile));this.mobile.actualSize.x=c.x*b;this.mobile.actualSize.y=c.y*b;this.scaleRatioMultiplier.x=b;this.scaleRatioMultiplier.y=b}else this.sizeRatio.x=this.scaleRatioMultiplier.x,this.sizeRatio.y=this.scaleRatioMultiplier.y,this.scaleRatioMultiplier.x=
1,this.scaleRatioMultiplier.y=1}else this.desktop.actualSize=new Vector2(window.innerWidth,window.innerHeight),c=new Vector2(this.desktop.actualResolution.x,this.desktop.actualResolution.y),this.scaleRatioMultiplier=new Vector2(this.desktop.actualSize.x/c.x,this.desktop.actualSize.y/c.y),this.enableStretchToFitOnDesktopFlag?(this.sizeRatio.x=this.scaleRatioMultiplier.x,this.sizeRatio.y=this.scaleRatioMultiplier.y,this.scaleRatioMultiplier.x=1,this.scaleRatioMultiplier.y=1):(b=Math.min(this.scaleRatioMultiplier.x,
this.scaleRatioMultiplier.y),this.enableScalingLimitsOnDesktopFlag&&(b=b.limit(this.minScalingOnDesktop,this.maxScalingOnDesktop)),this.desktop.actualSize.x=c.x*b,this.desktop.actualSize.y=c.y*b,this.scaleRatioMultiplier.x=b,this.scaleRatioMultiplier.y=b)},resizeLayers:function(){for(var c=0;c<this.coreDivsToResize.length;c++){var b=ig.domHandler.getElementById(this.coreDivsToResize[c]);if(ig.ua.mobile)if(this.disableStretchToFitOnMobileFlag){var e=Math.floor(ig.sizeHandler.windowSize.x/2-ig.sizeHandler.mobile.actualSize.x/
2),d=Math.floor(ig.sizeHandler.windowSize.y/2-ig.sizeHandler.mobile.actualSize.y/2);0>e&&(e=0);0>d&&(d=0);ig.domHandler.resizeOffset(b,Math.floor(ig.sizeHandler.mobile.actualSize.x),Math.floor(ig.sizeHandler.mobile.actualSize.y),e,d);var j=!1;if(j=this.portraitMode?window.innerHeight<window.innerWidth:window.innerHeight>window.innerWidth)if(this.enableStretchToFitOnAntiPortraitModeFlag)ig.domHandler.resizeOffset(b,Math.floor(window.innerWidth),Math.floor(window.innerHeight),0,0);else{var j=new Vector2(window.innerWidth/
this.mobile.actualResolution.y,window.innerHeight/this.mobile.actualResolution.x),e=Math.min(j.x,j.y),j=this.mobile.actualResolution.y*e,f=this.mobile.actualResolution.x*e,e=Math.floor(ig.sizeHandler.windowSize.x/2-j/2),d=Math.floor(ig.sizeHandler.windowSize.y/2-f/2);0>e&&(e=0);0>d&&(d=0);ig.domHandler.resizeOffset(b,Math.floor(j),Math.floor(f),e,d)}}else ig.domHandler.resize(b,Math.floor(ig.sizeHandler.mobile.actualSize.x),Math.floor(ig.sizeHandler.mobile.actualSize.y));else this.enableStretchToFitOnDesktopFlag?
ig.domHandler.resize(b,Math.floor(ig.sizeHandler.desktop.actualSize.x),Math.floor(ig.sizeHandler.desktop.actualSize.y)):(e=Math.floor(ig.sizeHandler.windowSize.x/2-ig.sizeHandler.desktop.actualSize.x/2),d=Math.floor(ig.sizeHandler.windowSize.y/2-ig.sizeHandler.desktop.actualSize.y/2),0>e&&(e=0),0>d&&(d=0),ig.domHandler.resizeOffset(b,Math.floor(ig.sizeHandler.desktop.actualSize.x),Math.floor(ig.sizeHandler.desktop.actualSize.y),e,d))}for(var p in this.adsToResize)c=ig.domHandler.getElementById("#"+
p),b=ig.domHandler.getElementById("#"+p+"-Box"),j=(window.innerWidth-this.adsToResize[p]["box-width"])/2+"px",e=(window.innerHeight-this.adsToResize[p]["box-height"])/2+"px",c&&ig.domHandler.css(c,{width:window.innerWidth,height:window.innerHeight}),b&&ig.domHandler.css(b,{left:j,top:e});c=ig.domHandler.getElementById("#canvas");b=ig.domHandler.getOffsets(c);c=b.left;b=b.top;j=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);for(p in this.dynamicClickableEntityDivs){e=
ig.domHandler.getElementById("#"+p);if(ig.ua.mobile){var f=this.dynamicClickableEntityDivs[p].entity_pos_x,l=this.dynamicClickableEntityDivs[p].entity_pos_y,g=this.dynamicClickableEntityDivs[p].width,d=this.dynamicClickableEntityDivs[p].height;this.disableStretchToFitOnMobileFlag?(f=Math.floor(c+f*this.scaleRatioMultiplier.x)+"px",l=Math.floor(b+l*this.scaleRatioMultiplier.y)+"px",g=Math.floor(g*this.scaleRatioMultiplier.x)+"px",d=Math.floor(d*this.scaleRatioMultiplier.y)+"px"):(f=Math.floor(f*this.sizeRatio.x)+
"px",l=Math.floor(l*this.sizeRatio.y)+"px",g=Math.floor(g*this.sizeRatio.x)+"px",d=Math.floor(d*this.sizeRatio.y)+"px")}else f=this.dynamicClickableEntityDivs[p].entity_pos_x,l=this.dynamicClickableEntityDivs[p].entity_pos_y,g=this.dynamicClickableEntityDivs[p].width,d=this.dynamicClickableEntityDivs[p].height,this.enableStretchToFitOnDesktopFlag?(f=Math.floor(f*this.sizeRatio.x)+"px",l=Math.floor(l*this.sizeRatio.y)+"px",g=Math.floor(g*this.sizeRatio.x)+"px",d=Math.floor(d*this.sizeRatio.y)+"px"):
(f=Math.floor(c+f*this.scaleRatioMultiplier.x)+"px",l=Math.floor(b+l*this.scaleRatioMultiplier.y)+"px",g=Math.floor(g*this.scaleRatioMultiplier.x)+"px",d=Math.floor(d*this.scaleRatioMultiplier.y)+"px");ig.domHandler.css(e,{"float":"left",position:"absolute",left:f,top:l,width:g,height:d,"z-index":3});this.dynamicClickableEntityDivs[p]["font-size"]&&ig.domHandler.css(e,{"font-size":this.dynamicClickableEntityDivs[p]["font-size"]*j+"px"})}$("#ajaxbar").width(this.windowSize.x);$("#ajaxbar").height(this.windowSize.y)},
resize:function(){this.sizeCalcs();this.resizeLayers()},reorient:function(){console.log("changing orientation ...");if(ig.ua.mobile){var c=!1,c=this.portraitMode?window.innerHeight<window.innerWidth:window.innerHeight>window.innerWidth,b=this.domHandler.getElementById("#orientate"),e=this.domHandler.getElementById("#game");c?(this.domHandler.show(b),this.domHandler.hide(e),console.log("portrait"+window.innerWidth+","+window.innerHeight)):(this.domHandler.show(e),this.domHandler.hide(b),console.log("landscape"+
window.innerWidth+","+window.innerHeight))}ig.ua.mobile?(this.resize(),this.resizeAds()):this.resize()},resizeAds:function(){for(var c in this.adsToResize){var b=ig.domHandler.getElementById("#"+c),e=ig.domHandler.getElementById("#"+c+"-Box"),d=(window.innerWidth-this.adsToResize[c]["box-width"]>>1)+"px",j=(window.innerHeight-this.adsToResize[c]["box-height"]>>1)+"px";b&&ig.domHandler.css(b,{width:window.innerWidth,height:window.innerHeight});e&&ig.domHandler.css(e,{left:d,top:j})}},samsungFix:function(){ig.ua.android&&
(!(4.2>parseFloat(navigator.userAgent.slice(navigator.userAgent.indexOf("Android")+8,navigator.userAgent.indexOf("Android")+11)))&&!(0>navigator.userAgent.indexOf("GT"))&&!(0<navigator.userAgent.indexOf("Chrome"))&&!(0<navigator.userAgent.indexOf("Firefox")))&&(document.addEventListener("touchstart",function(c){c.preventDefault();return!1},!1),document.addEventListener("touchmove",function(c){c.preventDefault();return!1},!1),document.addEventListener("touchend",function(c){c.preventDefault();return!1},
!1))},orientationInterval:null,orientationTimeout:null,orientationHandler:function(){this.reorient();window.scrollTo(0,1)},orientationDelayHandler:function(){null==this.orientationInterval&&(this.orientationInterval=window.setInterval(this.orientationHandler.bind(this),100));null==this.orientationTimeout&&(this.orientationTimeout=window.setTimeout(function(){this.clearAllIntervals()}.bind(this),2E3))},clearAllIntervals:function(){window.clearInterval(this.orientationInterval);this.orientationInterval=
null;window.clearTimeout(this.orientationTimeout);this.orientationTimeout=null},eventListenerSetup:function(){ig.isXiaomiBrowser=/XiaoMi/i.test(navigator.userAgent)||/MiuiBrowser/i.test(navigator.userAgent)||/Mint/i.test(navigator.userAgent);ig.ua.iOS||ig.isXiaomiBrowser?(window.addEventListener("orientationchange",this.orientationDelayHandler.bind(this)),window.addEventListener("resize",this.orientationDelayHandler.bind(this))):(window.addEventListener("orientationchange",this.orientationHandler.bind(this)),
window.addEventListener("resize",this.orientationHandler.bind(this)));document.ontouchmove=function(){window.scrollTo(0,1)};this.chromePullDownRefreshFix()},chromePullDownRefreshFix:function(){var c=window.chrome||navigator.userAgent.match("CriOS"),b="ontouchstart"in document.documentElement;if(c&&b){var e=c=!1,d=0,j=!1;try{CSS.supports("overscroll-behavior-y","contain")&&(c=!0)}catch(f){}try{if(c)return document.body.style.overscrollBehaviorY="contain"}catch(p){}c=document.head||document.body;b=
document.createElement("style");b.type="text/css";b.styleSheet?b.styleSheet.cssText="\n      ::-webkit-scrollbar {\n        width: 500x;\n      }\n      ::-webkit-scrollbar-thumb {\n        border-radius: 500px;\n        background-color: rgba(0, 0, 0, 0.2);\n      }\n      body {\n        -webkit-overflow-scrolling: auto!important;\n      }\n    ":b.appendChild(document.createTextNode("\n      ::-webkit-scrollbar {\n        width: 500px;\n      }\n      ::-webkit-scrollbar-thumb {\n        border-radius: 500px;\n        background-color: rgba(0, 0, 0, 0.2);\n      }\n      body {\n        -webkit-overflow-scrolling: auto!important;\n      }\n    "));
c.appendChild(b);try{addEventListener("test",null,{get passive(){e=!0}})}catch(l){}document.addEventListener("touchstart",function(b){1===b.touches.length&&(d=b.touches[0].clientY,j=0===window.pageYOffset)},!!e&&{passive:!0});document.addEventListener("touchmove",function(b){var c;if(c=j){j=!1;c=b.touches[0].clientY;var e=c-d;c=(d=c,0<e)}if(c)return b.preventDefault()},!!e&&{passive:!1})}}})});ig.baked=!0;
ig.module("plugins.handlers.api-handler").defines(function(){ig.ApiHandler=ig.Class.extend({apiAvailable:{MJSPreroll:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS&&_SETTINGS.Ad.Mobile.Preroll.Enabled&&MobileAdInGamePreroll.Initialize()},MJSHeader:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS.Ad.Mobile.Header.Enabled&&MobileAdInGameHeader.Initialize()},MJSFooter:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS.Ad.Mobile.Footer.Enabled&&MobileAdInGameFooter.Initialize()},
MJSEnd:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS.Ad.Mobile.End.Enabled&&MobileAdInGameEnd.Initialize()}},run:function(c,b){if(this.apiAvailable[c])this.apiAvailable[c](b)}})});ig.baked=!0;
ig.module("plugins.audio.sound-player").defines(function(){SoundPlayer=ig.Class.extend({tagName:"SoundPlayer",stayMuteFlag:!1,debug:!1,init:function(){this.debug&&console.log(this.tagName)},play:function(c){this.debug&&console.log("play sound ",c)},stop:function(){this.debug&&console.log("stop sound ")},volume:function(){this.debug&&console.log("set volume")},mute:function(c){this.debug&&console.log("mute");"undefined"===typeof c?this.stayMuteFlag=!0:c&&(this.stayMuteFlag=!0)},unmute:function(c){this.debug&&
console.log("unmute");"undefined"===typeof c?this.stayMuteFlag=!1:c&&(this.stayMuteFlag=!1)}})});ig.baked=!0;
ig.module("plugins.audio.impact-music-player").requires("plugins.audio.sound-player").defines(function(){ImpactMusicPlayer=SoundPlayer.extend({tagName:"ImpactMusicPlayer",bgmPlaying:!1,soundList:{},init:function(c,b){this.parent(c,b);for(var e in c)this.soundList[e]=e,ig.music.add(c[e].path+".*",e);b&&b.loop&&(ig.music.loop=b.loop)},play:function(c){this.stayMuteFlag||(this.bgmPlaying=!0,"undefined"===typeof c?ig.music.play(c):ig.music.play())},stop:function(){this.bgmPlaying=!1;ig.music.pause()},
volume:function(c){console.log("impactmusic:",c);ig.music.volume=0>c?0:isNaN(c)?1:1<c?1:c},getVolume:function(){return ig.music.volume},mute:function(c){this.parent(c);this.bgmPlaying&&this.stop()},unmute:function(c){this.parent(c);this.play()}})});ig.baked=!0;
ig.module("plugins.audio.impact-sound-player").requires("plugins.audio.sound-player").defines(function(){ImpactSoundPlayer=SoundPlayer.extend({tagName:"ImpactSoundPlayer",soundList:{},init:function(c,b){this.parent(c,b);for(var e in c){var d=new ig.Sound(c[e].path+".*");this.soundList[e]=d}},play:function(c){this.stayMuteFlag||("object"===typeof c?(console.log(c+" exists"),c.play()):"string"===typeof c&&this.soundList[c].play())},stop:function(c){this.parent(c);c.stop()},volume:function(c){ig.soundManager.volume=
0>c?0:isNaN(c)?1:1<c?1:c},getVolume:function(){return ig.soundManager.volume},mute:function(c){this.parent(c);ig.Sound.enabled=!1},unmute:function(c){this.parent(c);ig.Sound.enabled=!0}})});ig.baked=!0;
ig.module("plugins.audio.howler-player").requires("plugins.audio.sound-player").defines(function(){HowlerPlayer=SoundPlayer.extend({tagName:"HowlerPlayer",soundList:{},init:function(c,b){this.parent(c,b);for(var e in c){var d=c[e].path,d=new Howl({src:[d+"."+ig.Sound.FORMAT.OGG.ext,d+"."+ig.Sound.FORMAT.MP3.ext]});this.soundList[e]=d}},play:function(c){if(Howler.ctx&&"running"!==Howler.ctx.state)return Howler.ctx.resume();this.stayMuteFlag||("object"===typeof c?c.play():"string"===typeof c&&this.soundList[c].play())},
stop:function(c){this.parent(c);"object"===typeof c?c.stop():"string"===typeof c&&this.soundList[c].stop()},volume:function(c){for(var b in this.soundList){if(0>c){this.soundList[b].volume(0);break}isNaN(c)?this.soundList[b].volume(1):1<c?this.soundList[b].volume(1):this.soundList[b].volume(c)}},getVolume:function(){for(var c in this.soundList)return this.soundList[c].volume()},mute:function(c){this.parent(c);Howler.mute(!0)},unmute:function(c){this.parent(c);Howler.mute(!1)}})});ig.baked=!0;
ig.module("plugins.audio.howler-music-player").requires("plugins.audio.sound-player").defines(function(){HowlerMusicPlayer=SoundPlayer.extend({tagName:"HowlerMusicPlayer",bgmPlaying:!1,soundList:{},init:function(c,b){this.parent(c,b);for(var e in c){var d=c[e].path,d=new Howl({src:[d+"."+ig.Sound.FORMAT.OGG.ext,d+"."+ig.Sound.FORMAT.MP3.ext],loop:!0,autoplay:!1,onend:function(){}.bind(this)});this.soundList[e]=d}},play:function(c){if(!this.stayMuteFlag&&!this.bgmPlaying)if("object"===typeof c)this.bgmPlaying=
!0,c.play();else if("string"===typeof c)this.bgmPlaying=!0,this.soundList[c].play();else for(var b in this.soundList){this.soundList[b].play();this.bgmPlaying=!0;break}},stop:function(c){this.parent(c);if(this.bgmPlaying){for(var b in this.soundList)this.soundList[b].stop();this.bgmPlaying=!1}},volume:function(c){for(var b in this.soundList){if(0>c){this.soundList[b].volume(0);break}isNaN(c)?this.soundList[b].volume(1):1<c?this.soundList[b].volume(1):this.soundList[b].volume(c)}},getVolume:function(){for(var c in this.soundList)return this.soundList[c].volume()},
mute:function(c){this.parent(c);Howler.mute(!0)},unmute:function(c){this.parent(c);Howler.mute(!1)}})});ig.baked=!0;
ig.module("plugins.audio.jukebox-player").requires("plugins.audio.sound-player").defines(function(){JukeboxPlayer=SoundPlayer.extend({tagName:"JukeboxPlayer",bgmPlaying:!1,soundList:{},jukeboxPlayer:null,pausePosition:0,premuteVolume:0,minVolume:0.001,init:function(c,b){this.parent(c,b);for(var e in c){this.soundList[e]=e;var d=c[e].path;this.jukeboxPlayer=new jukebox.Player({resources:[d+"."+ig.Sound.FORMAT.OGG.ext,d+"."+ig.Sound.FORMAT.MP3.ext],autoplay:!1,spritemap:{music:{start:c[e].startMp3,
end:c[e].endMp3,loop:!0}}})}},play:function(){this.stayMuteFlag||(this.bgmPlaying=!0,this.pausePosition?(console.log("resume"),this.jukeboxPlayer.resume(this.pausePosition)):(console.log("play"),this.jukeboxPlayer.play(this.jukeboxPlayer.settings.spritemap.music.start,!0)),this.premuteVolume=this.getVolume())},stop:function(){this.bgmPlaying=!1;this.pausePosition=this.jukeboxPlayer.pause()},volume:function(c){console.log("jukebox:",c);0>=c?this.jukeboxPlayer.setVolume(this.minVolume):isNaN(c)?this.jukeboxPlayer.setVolume(1):
1<c?this.jukeboxPlayer.setVolume(1):this.jukeboxPlayer.setVolume(c)},getVolume:function(){return this.jukeboxPlayer.getVolume()},mute:function(c){this.parent(c);this.bgmPlaying&&(console.log("jukebox",this.premuteVolume),this.stayMuteFlag||(this.premuteVolume=this.getVolume()),this.jukeboxPlayer.pause(),this.jukeboxPlayer.setVolume(this.minVolume))},unmute:function(c){this.parent(c);this.stayMuteFlag||(console.log("jukebox",this.premuteVolume),this.jukeboxPlayer.setVolume(this.premuteVolume),this.jukeboxPlayer.resume())}})});
ig.baked=!0;
ig.module("plugins.audio.webaudio-music-player").requires("plugins.audio.sound-player").defines(function(){WebaudioMusicPlayer=SoundPlayer.extend({tagName:"WebaudioMusicPlayer",bgmPlaying:!1,isSupported:!1,muteFlag:!1,pausedTime:0,webaudio:null,useHTML5Audio:!1,audio:null,inactiveAudio:null,codecs:null,reinitOnPlay:!1,inputList:null,_volume:1,soundList:{},init:function(c){this.webaudio={compatibility:{},gainNode:null,buffer:null,source_loop:{},source_once:{}};try{Howler&&Howler.ctx?this.webaudio.context=Howler.ctx:
ig&&ig.webaudio_ctx?this.webaudio.context=ig.webaudio_ctx:(this.AudioContext=window.AudioContext||window.webkitAudioContext,this.webaudio.context=new this.AudioContext,ig.webaudio_ctx=this.webaudio.context),this.isSupported=!0}catch(b){console.log("Web Audio API not supported in this browser."),this.webaudio=null,this.useHTML5Audio=!0}if(this.useHTML5Audio)if("undefined"!==typeof Audio)try{new Audio}catch(e){this.useHTML5Audio=!1}else this.useHTML5Audio=!1;this.useHTML5Audio&&(this.audio=new Audio,
this.isSupported=!0,this.initHTML5Audio(c));if(!this.isSupported)return null;this.webaudio&&(this.inputList=c,this.initWebAudio(c))},initWebAudio:function(c){ig.ua.iOS&&this.initIOSWebAudioUnlock();this.webaudio.gainNode=this.webaudio.context.createGain();this.webaudio.gainNode.connect(this.webaudio.context.destination);this.webaudio.gainNode.gain.value=this._volume;this.webaudio.buffer=null;var b="start",e="stop",d=this.webaudio.context.createBufferSource();"function"!==typeof d.start&&(b="noteOn");
this.webaudio.compatibility.start=b;"function"!==typeof d.stop&&(e="noteOff");this.webaudio.compatibility.stop=e;for(var j in c){this.soundList[j]=j;var e=c[j].path,b=e+"."+ig.Sound.FORMAT.MP3.ext,f=e+"."+ig.Sound.FORMAT.OGG.ext;ig.ua.mobile?ig.ua.iOS&&(f=b):(e=navigator.userAgent.toLowerCase(),-1!=e.indexOf("safari")&&-1>=e.indexOf("chrome")&&(f=b),e.indexOf("win64")&&(f=b));var p=new XMLHttpRequest;p.open("GET",f,!0);p.responseType="arraybuffer";p.onload=function(){this.webaudio.context.decodeAudioData(p.response,
function(b){this.webaudio.buffer=b;this.webaudio.source_loop={};this.bgmPlaying?this.play(null,!0):this.stop()}.bind(this),function(){console.log('Error decoding audio "'+f+'".')})}.bind(this);p.send();if(4==p.readyState&&"undefined"!==typeof Audio){this.useHTML5Audio=!0;try{new Audio}catch(l){this.useHTML5Audio=!1}this.useHTML5Audio&&(console.log("Using HTML5 Audio"),this.webaudio=null,this.audio=new Audio,this.isSupported=!0,this.initHTML5Audio(c))}break}},initIOSWebAudioUnlock:function(){if(this.webaudio){webaudio=
this.webaudio;var c=function(){var b=webaudio.context,e=b.createBuffer(1,1,22050),d=b.createBufferSource();d.buffer=e;d.connect(b.destination);"undefined"===typeof d.start?d.noteOn(0):d.start(0);setTimeout(function(){(d.playbackState===d.PLAYING_STATE||d.playbackState===d.FINISHED_STATE)&&window.removeEventListener("touchend",c,!1)}.bind(this),0)};window.addEventListener("touchend",c,!1)}},initHTML5Audio:function(c){if(this.useHTML5Audio&&this.audio){var b=this.audio;this.codecs={};this.codecs={mp3:!!b.canPlayType("audio/mpeg;").replace(/^no$/,
""),opus:!!b.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!b.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!b.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!b.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(b.canPlayType("audio/x-m4a;")||b.canPlayType("audio/m4a;")||b.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(b.canPlayType("audio/x-mp4;")||b.canPlayType("audio/mp4;")||b.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!b.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,
"")};this.is={ff:Boolean(null!=window.mozInnerScreenX&&/firefox/.test(navigator.userAgent.toLowerCase())),ie:Boolean(document.all&&!window.opera),opera:Boolean(window.opera),chrome:Boolean(window.chrome),safari:Boolean(!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase())&&window.getComputedStyle&&!window.globalStorage&&!window.opera)};this.playDelay=-60;this.stopDelay=30;this.is.chrome&&(this.playDelay=-25);this.is.chrome&&(this.stopDelay=25);this.is.ff&&(this.playDelay=-25);this.is.ff&&
(this.stopDelay=85);this.is.opera&&(this.playDelay=5);this.is.opera&&(this.stopDelay=0);for(var e in c){this.soundList[e]=e;var d=c[e].path,b=d+"."+ig.Sound.FORMAT.OGG.ext,d=d+"."+ig.Sound.FORMAT.MP3.ext,j=null;this.codecs[ig.Sound.FORMAT.OGG.ext.toLowerCase()]?j=b:this.codecs[ig.Sound.FORMAT.MP3.ext.toLowerCase()]&&(j=d);if(j){ig.ua.mobile?ig.ua.iOS&&(j=d):(c=navigator.userAgent.toLowerCase(),-1!=c.indexOf("safari")&&-1>=c.indexOf("chrome")&&(j=d));this.audio.addEventListener("error",function(){this.audio.error&&
4===this.audio.error.code&&(this.isSupported=!1)},!1);this.audio.src=j;this.audio._pos=0;this.audio.preload="auto";this.audio.volume=this._volume;this.inactiveAudio=new Audio;this.inactiveAudio.src=j;this.inactiveAudio._pos=0;this.inactiveAudio.preload="auto";this.inactiveAudio.volume=this._volume;this.inactiveAudio.load();var f=function(){this._duration=this.audio.duration;this._loaded||(this._loaded=!0);this.bgmPlaying?this.play(null,!0):this.stop();this.audio.removeEventListener("canplaythrough",
f,!1)}.bind(this);this.audio.addEventListener("canplaythrough",f,!1);this.audio.load();break}}}},play:function(c,b){if(this.isSupported)if(this.bgmPlaying=!0,this.webaudio){if(!b&&this.reinitOnPlay&&this.webaudio.source_loop.buffer==this.webaudio.buffer){if(this.webaudio.source_loop._playing&&(this.webaudio.source_loop[this.webaudio.compatibility.stop](0),this.webaudio.source_loop._playing=!1,this.pausedTime+=this.webaudio.context.currentTime-this.webaudio.source_loop._startTime,this.pausedTime%=
this.webaudio.source_loop.buffer.duration,this.webaudio.source_loop._startTime=0,"noteOn"===this.webaudio.compatibility.start))this.webaudio.source_once[this.webaudio.compatibility.stop](0);try{this.webaudio.context.close();this.webaudio.context=new this.AudioContext;this.webaudio.gainNode=this.webaudio.context.createGain();this.webaudio.gainNode.connect(this.webaudio.context.destination);this.webaudio.gainNode.gain.value=this._volume;var e="start",d="stop",j=this.webaudio.context.createBufferSource();
"function"!==typeof j.start&&(e="noteOn");this.webaudio.compatibility.start=e;"function"!==typeof j.stop&&(d="noteOff");this.webaudio.compatibility.stop=d;this.webaudio.source_loop={};this.play(null,!0)}catch(f){}}if(this.webaudio.buffer){if(!this.muteFlag&&(this.bgmPlaying=!0,!this.webaudio.source_loop._playing)){this.webaudio.source_loop=this.webaudio.context.createBufferSource();this.webaudio.source_loop.buffer=this.webaudio.buffer;this.webaudio.source_loop.loop=!0;this.webaudio.source_loop.connect(this.webaudio.gainNode);
if(null==c||isNaN(c))c=0,this.pausedTime&&(c=this.pausedTime);this.webaudio.source_loop._startTime=this.webaudio.context.currentTime;if("noteOn"===this.webaudio.compatibility.start)this.webaudio.source_once=this.webaudio.context.createBufferSource(),this.webaudio.source_once.buffer=this.webaudio.buffer,this.webaudio.source_once.connect(this.webaudio.gainNode),this.webaudio.source_once.noteGrainOn(0,c,this.webaudio.buffer.duration-c),this.webaudio.source_loop[this.webaudio.compatibility.start](this.webaudio.context.currentTime+
(this.webaudio.buffer.duration-c));else this.webaudio.source_loop[this.webaudio.compatibility.start](0,c);this.webaudio.source_loop._playing=!0}}else this.bgmPlaying=!0}else if(this.audio){var p=this.audio;if(!this.muteFlag)if(this.bgmPlaying=!0,isNaN(c)&&(c=0,this.pausedTime&&(c=this.pausedTime)),e=this._duration-c,this._onEndTimer&&(clearTimeout(this._onEndTimer),this._onEndTimer=null),this._onEndTimer=setTimeout(function(){this.audio.currentTime=0;this.audio.pause();this.pausedTime=0;if(this.inactiveAudio){var b=
this.audio;this.audio=this.inactiveAudio;this.inactiveAudio=b}this.play()}.bind(this),1E3*e+this.playDelay),4===p.readyState||!p.readyState&&navigator.isCocoonJS)p.readyState=4,p.currentTime=c,p.muted=this.muteFlag||p.muted,p.volume=this._volume,setTimeout(function(){p.play()},0);else{clearTimeout(this._onEndTimer);this._onEndTimer=null;var l=function(){typeof("function"==this.play)&&(this.play(),p.removeEventListener("canplaythrough",l,!1))}.bind(this);p.addEventListener("canplaythrough",l,!1)}}},
stop:function(){this.bgmPlaying=!1;if(this.isSupported)if(this.webaudio){if(this.webaudio.source_loop._playing&&(this.webaudio.source_loop[this.webaudio.compatibility.stop](0),this.webaudio.source_loop._playing=!1,this.pausedTime+=this.webaudio.context.currentTime-this.webaudio.source_loop._startTime,this.pausedTime%=this.webaudio.source_loop.buffer.duration,this.webaudio.source_loop._startTime=0,"noteOn"===this.webaudio.compatibility.start))this.webaudio.source_once[this.webaudio.compatibility.stop](0)}else if(this.audio){var c=
this.audio;4==c.readyState&&(this.pausedTime=c.currentTime,c.currentTime=0,c.pause(),clearTimeout(this._onEndTimer),this._onEndTimer=null)}},volume:function(c){if(isNaN(c)||null==c)return this.getVolume();this.isSupported&&(this._volume=c,0>this._volume?this._volume=0:1<this._volume&&(this._volume=1),this.webaudio?this.webaudio.gainNode&&(this.webaudio.gainNode.gain.value=this._volume):this.audio&&(this.audio.volume=this._volume,this.inactiveAudio&&(this.inactiveAudio.volume=this._volume)))},getVolume:function(){return!this.isSupported?
0:this._volume},mute:function(c){this.parent(c);!1==this.muteFlag&&(this.muteFlag=!0,this.bgmPlaying&&(this.stop(),this.bgmPlaying=!0))},unmute:function(c){this.parent(c);!this.stayMuteFlag&&!0==this.muteFlag&&(this.muteFlag=!1,this.bgmPlaying&&this.play())}})});ig.baked=!0;
ig.module("plugins.audio.sound-info").defines(function(){SoundInfo=ig.Class.extend({FORMATS:{OGG:".ogg",MP3:".mp3"},sfx:{kittyopeningSound:{path:"media/audio/opening/kittyopening"},staticSound:{path:"media/audio/play/static"},openingSound:{path:"media/audio/opening/opening"}},bgm:{background:{path:"media/audio/bgm",startOgg:0,endOgg:21.463,startMp3:0,endMp3:21.463}}})});ig.baked=!0;
ig.module("plugins.audio.sound-handler").requires("plugins.audio.impact-music-player","plugins.audio.impact-sound-player","plugins.audio.howler-player","plugins.audio.howler-music-player","plugins.audio.jukebox-player","plugins.audio.webaudio-music-player","plugins.audio.sound-info").defines(function(){ig.SoundHandler=ig.Class.extend({bgmPlayer:null,sfxPlayer:null,focusBlurMute:!1,soundInfo:new SoundInfo,init:function(){console.log("Initiating sound handler");this.sfxPlayer=new HowlerPlayer(this.soundInfo.sfx);
ig.ua.mobile?(this.initPowerButtonFix(),this.bgmPlayer=new WebaudioMusicPlayer(this.soundInfo.bgm,{loop:!0}),this.bgmPlayer.isSupported||(this.bgmPlayer=new JukeboxPlayer(this.soundInfo.bgm,{loop:!0}))):(this.bgmPlayer=new WebaudioMusicPlayer(this.soundInfo.bgm,{loop:!0}),this.bgmPlayer.isSupported||(this.bgmPlayer=new ImpactMusicPlayer(this.soundInfo.bgm,{loop:!0})))},unlockWebAudio:function(){Howler&&(Howler.ctx&&"running"!==Howler.ctx.state&&Howler.ctx.resume(),Howler._audioUnlocked||"function"===
typeof Howler._unlockAudio&&Howler._unlockAudio());ig&&ig.webaudio_ctx&&ig.webaudio_ctx.state&&"running"!==ig.webaudio_ctx.state&&ig.webaudio_ctx.resume();this.bgmPlayer.webaudio&&this.bgmPlayer.webaudio.context&&this.bgmPlayer.webaudio.context.state&&"running"!==this.bgmPlayer.webaudio.context.state&&this.bgmPlayer.webaudio.context.resume()},checkBGM:function(){return this.bgmPlayer.stayMuteFlag},checkSFX:function(){return this.sfxPlayer.stayMuteFlag},muteSFX:function(c){this.sfxPlayer&&this.sfxPlayer.mute(c)},
muteBGM:function(c){this.bgmPlayer&&this.bgmPlayer.mute(c)},unmuteSFX:function(c){this.sfxPlayer&&this.sfxPlayer.unmute(c)},unmuteBGM:function(c){this.bgmPlayer&&this.bgmPlayer.unmute(c)},muteAll:function(c){this.muteSFX(c);this.muteBGM(c)},unmuteAll:function(c){this.unlockWebAudio();this.unmuteSFX(c);this.unmuteBGM(c)},forceMuteAll:function(){this.focusBlurMute||this.muteAll(!1);this.focusBlurMute=!0},forceUnMuteAll:function(){this.focusBlurMute&&(this.unmuteAll(!1),this.focusBlurMute=!1)},initWindowHandler:function(){"true"===
ig.domHandler.getQueryVariable("webview")?($(window).focus(function(){wgl.system&&wgl.system.startRender();ig.soundHandler&&ig.soundHandler.forceUnMuteAll()}),$(window).blur(function(){wgl.system&&wgl.system.stopRender();ig.soundHandler&&ig.soundHandler.forceMuteAll()})):(window.onfocus=function(){wgl.system&&wgl.system.startRender();ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},window.onblur=function(){wgl.system&&wgl.system.stopRender();ig.soundHandler&&ig.soundHandler.forceMuteAll()})},initPowerButtonFix:function(){var c=
this.getHiddenProp();c&&(c=c.replace(/[H|h]idden/,"")+"visibilitychange",document.addEventListener(c,this.visChange));window.addEventListener("pagehide",function(){ig.soundHandler&&ig.soundHandler.forceMuteAll()},!1);window.addEventListener("pageshow",function(){ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},!1)},getHiddenProp:function(){var c=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var b=0;b<c.length;b++)if(c[b]+"Hidden"in document)return c[b]+"Hidden";return null},
isHidden:function(){var c=this.getHiddenProp();return!c?!1:document[c]},visChange:function(){ig.soundHandler.isHidden()?ig.soundHandler&&ig.soundHandler.forceMuteAll():ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},saveVolume:function(){this.sfxPlayer&&ig.game.io.storageSet("soundVolume",this.sfxPlayer.getVolume());this.bgmPlayer&&ig.game.io.storageSet("musicVolume",this.bgmPlayer.getVolume())},forceLoopBGM:function(){var c;if(!this.focusBlurMute&&this.bgmPlayer.bgmPlaying&&this.bgmPlayer){var b=
this.bgmPlayer.jukeboxPlayer;if(b){null!=window.mozInnerScreenX&&/firefox/.test(navigator.userAgent.toLowerCase());c=Boolean(window.chrome);!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase());var e=0.1;ig.ua.mobile&&(e=0.115,ig.ua.android&&(e=0.45,c&&(e=0.3)));b.settings.spritemap.music&&(c=b.settings.spritemap.music.end-e,b.getCurrentTime()>=c&&(c=b.settings.spritemap.music.start,ig.ua.android?this.forcelooped||(b.play(c,!0),this.forcelooped=!0,setTimeout(function(){ig.soundHandler.forcelooped=
!1},e)):b.setCurrentTime(c)))}else"ImpactMusicPlayer"==this.bgmPlayer.tagName&&(null!=window.mozInnerScreenX&&/firefox/.test(navigator.userAgent.toLowerCase()),c=Boolean(window.chrome),!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase()),e=0.1,ig.ua.mobile&&(e=0.115,ig.ua.android&&(e=0.45,c&&(e=0.3))),b=0,"mp3"==ig.soundManager.format.ext&&(b=0.05),ig.music.currentTrack&&(c=ig.music.currentTrack.duration-e,ig.music.currentTrack.currentTime>=c&&(ig.ua.android?this.forcelooped||(ig.music.currentTrack.pause(),
ig.music.currentTrack.currentTime=b,ig.music.currentTrack.play(),this.forcelooped=!0,setTimeout(function(){ig.soundHandler.forcelooped=!1},e)):ig.music.currentTrack.currentTime=b)))}}})});ig.baked=!0;
ig.module("plugins.handlers.visibility-handler").requires("plugins.audio.sound-handler").defines(function(){ig.VisibilityHandler=ig.Class.extend({version:"1.0.2",config:{allowResumeWithoutFocus:{desktop:!0,mobile:{kaios:!1,"default":!0}},handlerDelay:{desktop:0,mobile:{kaios:0,"default":0}},autoFocusOnResume:{desktop:!0,mobile:{kaios:!1,"default":!0}},autoFocusAfterResume:{desktop:!0,mobile:{kaios:!1,"default":!0}}},browserPrefixes:["o","ms","moz","webkit"],browserPrefix:null,hiddenPropertyName:null,
visibilityEventName:null,visibilityStateName:null,isShowingOverlay:!1,isFocused:!1,isPaused:!1,init:function(){this.initVisibilityHandler();this.initFocusHandler();this.initPageTransitionHandler();ig.visibilityHandler=this},pauseHandler:function(){ig.game&&ig.game.pauseGame();wgl.system&&wgl.system.stopRender();ig.soundHandler&&ig.soundHandler.forceMuteAll()},resumeHandler:function(){ig.game&&ig.game.resumeGame();wgl.system&&wgl.system.startRender();ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},
initVisibilityHandler:function(){this.browserPrefix=this.getBrowserPrefix();this.hiddenPropertyName=this.getHiddenPropertyName(this.browserPrefix);this.visibilityEventName=this.getVisibilityEventName(this.browserPrefix);this.visibilityStateName=this.getVisibilityStateName(this.browserPrefix);this.visibilityEventName&&document.addEventListener(this.visibilityEventName,this.onChange.bind(this),!0)},initFocusHandler:function(){window.addEventListener("blur",this.onChange.bind(this),!0);document.addEventListener("blur",
this.onChange.bind(this),!0);document.addEventListener("focusout",this.onChange.bind(this),!0);window.addEventListener("focus",this.onChange.bind(this),!0);document.addEventListener("focus",this.onChange.bind(this),!0);document.addEventListener("focusin",this.onChange.bind(this),!0)},initPageTransitionHandler:function(){window.addEventListener("pagehide",this.onChange.bind(this),!0);window.addEventListener("pageshow",this.onChange.bind(this),!0)},getBrowserPrefix:function(){var c=null;this.browserPrefixes.forEach(function(b){if(this.getHiddenPropertyName(b)in
document)return c=b}.bind(this));return c},getHiddenPropertyName:function(c){return c?c+"Hidden":"hidden"},getVisibilityEventName:function(c){return(c?c:"")+"visibilitychange"},getVisibilityStateName:function(c){return c?c+"VisibilityState":"visibilityState"},hasView:function(){return!(document[this.hiddenPropertyName]||"visible"!==document[this.visibilityStateName])},hasFocus:function(){return document.hasFocus()||this.isFocused},onOverlayShow:function(){this.systemPaused();this.isShowingOverlay=
!0},onOverlayHide:function(){this.isShowingOverlay=!1;this.systemResumed()},systemPaused:function(){if(this.isPaused)return!1;this.pauseHandler();return this.isPaused=!0},systemResumed:function(){if(!this.isPaused||!this.hasView()||this.isShowingOverlay)return!1;if(!this.hasFocus())if(ig.ua.mobile)if(this.isKaiOS()){if(!this.config.allowResumeWithoutFocus.mobile.kaios)return!1}else{if(!this.config.allowResumeWithoutFocus.mobile.default)return!1}else if(!this.config.allowResumeWithoutFocus.desktop)return!1;
this.focusOnResume();this.resumeHandler();this.focusAfterResume();this.isPaused=!1;return!0},isKaiOS:function(){return/KAIOS/.test(navigator.userAgent)||!1},focusOnResume:function(){var c=!1;return c=ig.ua.mobile?this.isKaiOS()?this.config.autoFocusOnResume.mobile.kaios:this.config.autoFocusOnResume.mobile.default:this.config.autoFocusOnResume.desktop},focusAfterResume:function(){var c=!1;return c=ig.ua.mobile?this.isKaiOS()?this.config.autoFocusAfterResume.mobile.kaios:this.config.autoFocusAfterResume.mobile.default:
this.config.autoFocusAfterResume.desktop},focus:function(c){window.focus&&c&&window.focus()},handleDelayedEvent:function(c){if(!this.hasView()||"pause"===c.type||"pageHide"===c.type||"blur"===c.type||"focusout"===c.type){if("blur"===c.type||"focusout"===c.type)this.isFocused=!1;return this.systemPaused(c)}if("focus"===c.type||"focusin"===c.type)this.isFocused=!0;return this.systemResumed(c)},startDelayedEventHandler:function(c){ig.ua.mobile?this.isKaiOS()?0<this.config.handlerDelay.mobile.kaios?window.setTimeout(function(b){this.handleDelayedEvent(b)}.bind(this,
c),this.config.handlerDelay.mobile):this.handleDelayedEvent(c):0<this.config.handlerDelay.mobile.default?window.setTimeout(function(b){this.handleDelayedEvent(b)}.bind(this,c),this.config.handlerDelay.mobile):this.handleDelayedEvent(c):0<this.config.handlerDelay.desktop?window.setTimeout(function(b){this.handleDelayedEvent(b)}.bind(this,c),this.config.handlerDelay.desktop):this.handleDelayedEvent(c)},onChange:function(c){this.startDelayedEventHandler(c)}})});ig.baked=!0;
ig.module("plugins.io.storage").defines(function(){ig.Storage=ig.Class.extend({staticInstantiate:function(){return!ig.Storage.instance?null:ig.Storage.instance},init:function(){ig.Storage.instance=this},isCapable:function(){return"undefined"!==typeof window.localStorage},isSet:function(c){return null!==this.get(c)},initUnset:function(c,b){null===this.get(c)&&this.set(c,b)},get:function(c){if(!this.isCapable())return null;try{return JSON.parse(localStorage.getItem(c))}catch(b){return window.localStorage.getItem(c)}},
getInt:function(c){return~~this.get(c)},getFloat:function(c){return parseFloat(this.get(c))},getBool:function(c){return!!this.get(c)},key:function(c){return this.isCapable()?window.localStorage.key(c):null},set:function(c,b){if(!this.isCapable())return null;try{window.localStorage.setItem(c,JSON.stringify(b))}catch(e){console.log(e)}},setHighest:function(c,b){b>this.getFloat(c)&&this.set(c,b)},remove:function(c){if(!this.isCapable())return null;window.localStorage.removeItem(c)},clear:function(){if(!this.isCapable())return null;
window.localStorage.clear()}})});ig.baked=!0;
ig.module("plugins.io.mouse").requires("plugins.data.vector").defines(function(){Mouse=ig.Class.extend({bindings:{click:[ig.KEY.MOUSE1]},pos:new BABYLON.Vector2.Zero,init:function(){ig.input.initMouse();for(var c in this.bindings){this[c]=c;for(var b=0;b<this.bindings[c].length;b++)ig.input.bind(this.bindings[c][b],c)}},getWglPos:function(){var c=ig.sizeHandler.mobile.actualResolution.x,b=ig.sizeHandler.mobile.actualResolution.y,e=wgl.system.engine.getRenderWidth(),d=wgl.system.engine.getRenderHeight(),
c=e/c,b=d/b,d=ig.game.io.getClickPos();ig.ua.mobile?(c=d.x*ig.sizeHandler.sizeRatio.x,b=d.y*ig.sizeHandler.sizeRatio.y):(c*=d.x,b*=d.y);return new BABYLON.Vector2(c,b)},getLast:function(){return this.pos},getPos:function(){if(ig.ua.mobile)var c=ig.input.mouse.x/ig.sizeHandler.scaleRatioMultiplier.x,b=ig.input.mouse.y/ig.sizeHandler.scaleRatioMultiplier.y;else c=ig.input.mouse.x,b=ig.input.mouse.y;this.pos=new BABYLON.Vector2(c,b);return this.pos.clone()}})});ig.baked=!0;
ig.module("plugins.io.keyboard").defines(function(){Keyboard=ig.Class.extend({bindings:{up:[ig.KEY.W,ig.KEY.UP_ARROW],right:[ig.KEY.D,ig.KEY.RIGHT_ARROW],left:[ig.KEY.A,ig.KEY.LEFT_ARROW],down:[ig.KEY.S,ig.KEY.DOWN_ARROW,ig.KEY.SPACE]},init:function(){for(var c in this.bindings){this[c]=c;for(var b=0;b<this.bindings[c].length;b++)ig.input.bind(this.bindings[c][b],c)}}})});ig.baked=!0;
ig.module("plugins.io.gamepad-input").defines(function(){ig.PADKEY={BUTTON_0:0,PADBUTTON_1:1,BUTTON_2:2,BUTTON_3:3,BUTTON_LEFT_BUMPER:4,BUTTON_RIGHT_BUMPER:5,BUTTON_LEFT_TRIGGER:6,BUTTON_RIGHT_TRIGGER:7,BUTTON_LEFT_JOYSTICK:10,BUTTON_RIGHT_JOYSTICK:11,BUTTON_DPAD_UP:12,BUTTON_DPAD_DOWN:13,BUTTON_DPAD_LEFT:14,BUTTON_DPAD_RIGHT:15,BUTTON_MENU:16,AXIS_LEFT_JOYSTICK_X:0,AXIS_LEFT_JOYSTICK_Y:1,AXIS_RIGHT_JOYSTICK_X:2,AXIS_RIGHT_JOYSTICK_Y:3};ig.GamepadInput=ig.Class.extend({isInit:!1,isSupported:!1,list:[],
bindings:{},states:{},presses:{},releases:{},downLocks:{},upLocks:{},leftStick:{x:0,y:0},rightStick:{x:0,y:0},start:function(){if(!this.isInit){this.isInit=!0;var c=navigator.getGamepads||navigator.webkitGetGamepads;c&&(!navigator.getGamepads&&navigator.webkitGetGamepads&&(navigator.getGamepads=navigator.webkitGetGamepads),this.list=navigator.getGamepads());this.isSupported=c}},isAvailable:function(){return this.isInit&&this.isSupported},buttonPressed:function(c){return"object"==typeof c?c.pressed:
1==c},buttonDown:function(c){if(c=this.bindings[c])this.states[c]=!0,this.downLocks[c]||(this.presses[c]=!0,this.downLocks[c]=!0)},buttonUp:function(c){if((c=this.bindings[c])&&this.downLocks[c]&&!this.upLocks[c])this.states[c]=!1,this.releases[c]=!0,this.upLocks[c]=!0},clearPressed:function(){for(var c in this.releases)this.states[c]=!1,this.downLocks[c]=!1;this.releases={};this.presses={};this.upLocks={}},bind:function(c,b){this.bindings[c]=b},unbind:function(c){this.releases[this.bindings[c]]=
!0;this.bindings[c]=null},unbindAll:function(){this.bindings={};this.states={};this.presses={};this.releases={};this.downLocks={};this.upLocks={}},state:function(c){return this.states[c]},pressed:function(c){return this.presses[c]},released:function(c){return this.releases[c]},clamp:function(c,b,e){return c<b?b:c>e?e:c},pollGamepads:function(){if(this.isSupported){this.leftStick.x=0;this.leftStick.y=0;this.rightStick.x=0;this.rightStick.y=0;this.list=navigator.getGamepads();for(var c in this.bindings){for(var b=
!1,e=0;e<this.list.length;e++){var d=this.list[e];if(d&&d.buttons&&this.buttonPressed(d.buttons[c])){b=!0;break}}b?this.buttonDown(c):this.buttonUp(c)}for(e=0;e<this.list.length;e++)if((d=this.list[e])&&d.axes){c=d.axes[ig.GAMEPADINPUT.AXIS_LEFT_JOYSTICK_X];var b=d.axes[ig.GAMEPADINPUT.AXIS_LEFT_JOYSTICK_Y],j=d.axes[ig.GAMEPADINPUT.AXIS_RIGHT_JOYSTICK_X],d=d.axes[ig.GAMEPADINPUT.AXIS_RIGHT_JOYSTICK_Y];this.leftStick.x+=isNaN(c)?0:c;this.leftStick.y+=isNaN(b)?0:b;this.rightStick.x+=isNaN(j)?0:j;this.rightStick.y+=
isNaN(d)?0:d}0<this.list.length&&(this.leftStick.x=this.clamp(this.leftStick.x,-1,1),this.leftStick.y=this.clamp(this.leftStick.y,-1,1),this.rightStick.x=this.clamp(this.rightStick.x,-1,1),this.rightStick.y=this.clamp(this.rightStick.y,-1,1))}}})});ig.baked=!0;
ig.module("plugins.io.gamepad").requires("plugins.io.gamepad-input").defines(function(){Gamepad=ig.Class.extend({bindings:{padJump:[ig.PADKEY.BUTTON_0]},init:function(){ig.gamepadInput.start();for(var c in this.bindings)for(var b=0;b<this.bindings[c].length;b++)ig.gamepadInput.bind(this.bindings[c][b],c)},press:function(){},held:function(){},release:function(){}})});ig.baked=!0;
ig.module("plugins.io.multitouch").defines(function(){Multitouch=ig.Class.extend({init:function(){ig.multitouchInput.start()},getTouchesPos:function(){if(ig.ua.mobile){if(0<ig.multitouchInput.touches.length){for(var c=[],b=0;b<ig.multitouchInput.touches.length;b++){var e=ig.multitouchInput.touches[b];c.push({x:e.x,y:e.y})}return c}return null}}})});ig.baked=!0;
ig.module("plugins.io.multitouch-input").defines(function(){ig.MultitouchInput=ig.Class.extend({isStart:!1,touches:{},pressed:[],state:[],released:[],multitouchCapable:!1,lastEventUp:null,internalWidth:1,internalHeight:1,scaleX:1,scaleY:1,start:function(){this.isStart||(this.isStart=!0,navigator.maxTouchPoints&&1<navigator.maxTouchPoints&&(this.multitouchCapable=!0),ig.ua.touchDevice&&(window.navigator.msPointerEnabled&&(ig.system.canvas.addEventListener("MSPointerDown",this.touchdown.bind(this),
!1),ig.system.canvas.addEventListener("MSPointerUp",this.touchup.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",this.touchmove.bind(this),!1),ig.system.canvas.style.msContentZooming="none",ig.system.canvas.style.msTouchAction="none"),ig.system.canvas.addEventListener("touchstart",this.touchdown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.touchup.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.touchmove.bind(this),!1)))},touchdown:function(c){if(ig.ua.touchDevice)if(this.updateSizeProperties(),
window.navigator.msPointerEnabled)this.windowKeyDown(c);else if(c.touches){this.pollMultitouch(c.touches.length);this.updateSizeProperties();var b={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(b=ig.system.canvas.getBoundingClientRect());for(var e=[],d=0;d<c.touches.length;d++)e.push(c.touches[d]);this.spliceFromArray(e,this.pressed);this.spliceFromArray(e,this.state);this.spliceFromArray(e,this.released);for(d=0;d<e.length;d++)c=e[d],this.pressed.push({identifier:c.identifier,x:(c.clientX-
b.left)/this.scaleX,y:(c.clientY-b.top)/this.scaleY})}},touchmove:function(c){if(ig.ua.touchDevice){this.updateSizeProperties();if(window.navigator.msPointerEnabled)this.windowMove(c);else if(c.touches){this.pollMultitouch(c.touches.length);for(var b=0;b<c.touches.length;b++){var e=c.touches[b];this.upgrade(this.pressed,this.state,e);this.updateArray(this.state,e)}}try{ig.soundHandler.unlockWebAudio()}catch(d){}}},touchup:function(c){if(ig.ua.touchDevice){this.updateSizeProperties();if(window.navigator.msPointerEnabled)this.windowKeyUp(c);
else if(this.lastEventUp=c,c.touches)for(var b=0;b<c.changedTouches.length;b++){var e=c.changedTouches[b];this.upgrade(this.state,this.released,e);this.upgrade(this.pressed,this.released,e)}if(ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(d){}}},windowKeyDown:function(c){c=c.changedTouches?c.changedTouches:[c];this.pollMultitouch(c.length);this.updateSizeProperties();for(var b=[],e=0;e<c.length;e++)b.push(c[e]);var d={left:0,top:0};ig.system.canvas.getBoundingClientRect&&
(d=ig.system.canvas.getBoundingClientRect());this.spliceFromArray(b,this.pressed);this.spliceFromArray(b,this.state);this.spliceFromArray(b,this.released);for(e=0;e<b.length;e++){var j=c[e];this.pressed.push({identifier:"undefined"!=typeof j.identifier?j.identifier:"undefined"!=typeof j.pointerId?j.pointerId:1,x:(j.clientX-d.left)/this.scaleX,y:(j.clientY-d.top)/this.scaleY})}},windowKeyUp:function(c){this.lastEventUp=c;c=c.changedTouches?c.changedTouches:[c];for(var b=0;b<c.length;b++){var e=c[b],
e={identifier:"undefined"!=typeof e.identifier?e.identifier:"undefined"!=typeof e.pointerId?e.pointerId:1,clientX:e.clientX,clientY:e.clientY};this.upgrade(this.state,this.released,e);this.upgrade(this.pressed,this.released,e)}if(ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(d){}},windowMove:function(c){c=c.changedTouches?c.changedTouches:[c];this.pollMultitouch(c.length);for(var b=0;b<c.length;b++){var e=c[b],e={identifier:e.pointerId,clientX:e.clientX,
clientY:e.clientY};this.upgrade(this.pressed,this.state,e);this.updateArray(this.state,e)}try{ig.soundHandler.unlockWebAudio()}catch(d){}},clear:function(){for(var c=0;c<this.released.length;++c)this.released[c]&&(this.released.splice(c,1),c--)},pollMultitouch:function(c){!this.multitouchCapable&&1<c&&(this.multitouchCapable=!0)},spliceFromArray:function(c,b){for(var e=0;e<b.length;e++)for(var d=0;d<c.length;d++)c[d].identifier===b[e].identifier&&(c.splice(d,1),d--)},updateSizeProperties:function(){var c=
parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth,b=parseInt(ig.system.canvas.offsetHeight)||ig.system.realHeight;this.scaleX=ig.system.scale*(c/ig.system.realWidth);this.scaleY=ig.system.scale*(b/ig.system.realHeight)},upgrade:function(c,b,e){var d={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(d=ig.system.canvas.getBoundingClientRect());for(var j=(e.clientX-d.left)/this.scaleX,d=(e.clientY-d.top)/this.scaleY,f=0;f<c.length;f++)if(void 0!==typeof c[f].identifier&&void 0!==typeof e.identifier&&
e.identifier===c[f].identifier){c.splice(f,1);b.push({identifier:e.identifier,x:j,y:d});break}},updateArray:function(c,b){var e={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());for(var d=(b.clientX-e.left)/this.scaleX,e=(b.clientY-e.top)/this.scaleY,j=0;j<c.length;j++)if(void 0!==typeof c[j].identifier&&void 0!==typeof b.identifier&&b.identifier===c[j].identifier){c[j].x=d;c[j].y=e;break}}})});ig.baked=!0;
ig.module("plugins.io.fake-storage").requires("impact.game").defines(function(){ig.FakeStorage=ig.Class.extend({tempData:{},init:function(){ig.FakeStorage.instance=this},initUnset:function(c,b){null===this.get(c)&&this.set(c,b)},set:function(c,b){this.tempData[c]=JSON.stringify(b)},setHighest:function(c,b){b>this.getFloat(c)&&this.set(c,b)},get:function(c){return"undefined"==typeof this.tempData[c]?null:JSON.parse(this.tempData[c])},getInt:function(c){return~~this.get(c)},getFloat:function(c){return parseFloat(this.get(c))},
getBool:function(c){return!!this.get(c)},isSet:function(c){return null!==this.get(c)},remove:function(c){delete this.tempData[c]},clear:function(){this.tempData={}}})});ig.baked=!0;
ig.module("plugins.io.io-manager").requires("plugins.io.storage","plugins.io.mouse","plugins.io.keyboard","plugins.io.gamepad","plugins.io.multitouch","plugins.io.multitouch-input","plugins.io.gamepad-input","plugins.io.fake-storage").defines(function(){IoManager=ig.Class.extend({version:"1.0.0",storage:null,localStorageSupport:!1,mouse:null,keyboard:null,multitouch:null,gamepad:null,init:function(){ig.multitouchInput=new ig.MultitouchInput;ig.gamepadInput=new ig.GamepadInput;this.unbindAll();this.initStorage();
this.initMouse();this.initKeyboard()},unbindAll:function(){ig.input.unbindAll();ig.gamepadInput.unbindAll()},initStorage:function(){try{window.localStorage.setItem("test","test"),window.localStorage.removeItem("test"),this.storage=new ig.Storage}catch(c){console.log("using fake storage"),this.storage=new ig.FakeStorage}},initMouse:function(){this.mouse=new Mouse},initKeyboard:function(){this.keyboard=new Keyboard},initMultitouch:function(){this.multitouch=new Multitouch},initGamepad:function(){this.gamepad=
new Gamepad},press:function(c){return ig.input.pressed(c)||this.gamepad&&this.gamepad.press(c)?!0:!1},held:function(c){return ig.input.state(c)||this.gamepad&&this.gamepad.state(c)?!0:!1},release:function(c){return ig.input.released(c)||this.gamepad&&this.gamepad.released(c)?!0:!1},getClickPos:function(){return this.mouse.getPos()},getLastClickPos:function(){return this.mouse.getLast()},getTouchesPos:function(){return this.multitouch.getTouchesPos()},checkOverlap:function(c,b,e,d,j){return c.x>b+
d||c.x<b||c.y>e+j||c.y<e?!1:!0},clear:function(){ig.multitouchInput.clear()},_supportsLocalStorage:function(){try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),this.localStorageSupport="localStorage"in window&&null!==window.localStorage}catch(c){return this.localStorageSupport}},storageIsSet:function(c){return"function"===typeof this.storage.isSet?this.storage.isSet(c):null},storageGet:function(c){return"function"===typeof this.storage.get?this.storage.get(c):null},storageSet:function(c,
b){return"function"===typeof this.storage.set?this.storage.set(c,b):null},assert:function(c,b,e){if(b!==e)throw"actualValue:"+b+" not equal to testValue:"+e+" at "+c;}})});ig.baked=!0;
ig.module("plugins.io.storage-manager").requires("impact.game","plugins.io.io-manager").defines(function(){ig.Game.prototype.name="MJS-Game";ig.Game.prototype.version="1.0";ig.Game.prototype.sessionData={};ig.Game.prototype.initData=function(){return this.sessionData={sound:0.5,music:0.5,level:1,score:0}};ig.Game.prototype.setupStorageManager=function(){"undefined"===typeof this.name?console.error("Cannot found Game Name, Storage Manager Cancelled."):"undefined"===typeof this.version?console.error("Cannot found Game Version, Storage Manager Cancelled."):
(this.io||(this.io=new IoManager,console.log("IO Manager doesn't existed. Initialize...")),console.log("Plug in Storage Manager"),this.storage=this.io.storage,this.storageName=this.name+"-v"+this.version,this.loadAll())};ig.Game.prototype.loadAll=function(){var c=this.storage.get(this.storageName);if(null===c||"undefined"===typeof c)c=this.initData();for(var b in c)this.sessionData[b]=c[b];this.storage.set(this.storageName,c)};ig.Game.prototype.saveAll=function(){var c=this.storage.get(this.storageName),
b;for(b in c)c[b]=this.sessionData[b];this.storage.set(this.storageName,c)};ig.Game.prototype.load=function(c){return this.storage.get(this.storageName)[c]};ig.Game.prototype.save=function(c,b){var e=this.storage.get(this.storageName);e[c]=b;this.storage.set(this.storageName,e)}});ig.baked=!0;
ig.module("plugins.splash-loader").requires("impact.loader","impact.animation").defines(function(){ig.SplashLoader=ig.Loader.extend({desktopCoverDIVID:"play-desktop",init:function(c,b){this.parent(c,b);var e=ig.domHandler.getElementById("#game"),d=ig.domHandler.getElementById("#webgl");ig.domHandler.setZIndex(e,1);ig.domHandler.setZIndex(d,0);ig.apiHandler.run("MJSPreroll")},end:function(){this.parent();this._drawStatus=1;this.draw();ig.altBabylon.scene?this.startGame():ig.altBabylon.onSceneReady.addOnce(this.startGame.bind(this))},
startGame:function(){this._drawStatus=1;this.draw();_SETTINGS.TapToStartAudioUnlock.Enabled?this.tapToStartDiv(function(){ig.system.setGame(MyGame)}):ig.system.setGame(MyGame)},tapToStartDiv:function(c){this.desktopCoverDIV=document.getElementById(this.desktopCoverDIVID);if(!this.desktopCoverDIV){this.desktopCoverDIV=document.createElement("div");this.desktopCoverDIV.id=this.desktopCoverDIVID;this.desktopCoverDIV.setAttribute("class","play");this.desktopCoverDIV.setAttribute("style","position: absolute; display: block; z-index: 999999; background-color: rgba(23, 32, 53, 0.7); visibility: visible; font-size: 10vmin; text-align: center; vertical-align: middle; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;");
this.desktopCoverDIV.innerHTML="<div style='color:white;background-color: rgba(255, 255, 255, 0.3); border: 2px solid #fff; font-size:20px; border-radius: 5px; position: relative; float: left; top: 50%; left: 50%; transform: translate(-50%, -50%);'><div style='padding:20px 50px; font-family: montserrat;'>"+_STRINGS.Splash.TapToStart+"</div></div>";(document.getElementById("play").parentNode||document.getElementById("ajaxbar")).appendChild(this.desktopCoverDIV);try{"undefined"!==typeof ig.sizeHandler?
"undefined"!==typeof ig.sizeHandler.coreDivsToResize&&(ig.sizeHandler.coreDivsToResize.push("#"+this.desktopCoverDIVID),"function"===typeof ig.sizeHandler.reorient&&ig.sizeHandler.reorient()):"undefined"!==typeof coreDivsToResize&&(coreDivsToResize.push(this.desktopCoverDIVID),"function"===typeof sizeHandler&&sizeHandler())}catch(b){console.log(b)}this.desktopCoverDIV.addEventListener("click",function(){ig.soundHandler.unlockWebAudio();this.setAttribute("style","visibility: hidden;");"function"===
typeof c&&c()})}},draw:function(){var c=ig.system.context;c.save();c.fillStyle="#f8c85c";c.fillRect(0,0,ig.system.width,ig.system.height);var b=ig.responsive.toAnchor(0,0,"default");if(ig.babylonJSSupport){this._drawStatus+=(this.status-this._drawStatus)/5;!ig.altBabylon.scene&&0.95<this._drawStatus&&(this._drawStatus=0.95);c.globalAlpha=0.5;c.lineWidth=2;c.fillStyle="#ffffff";c.strokeStyle="#ffffff";c.globalAlpha=1;ig.drawRoundRect(c,b.x+50,b.y+870,440,30,19,!0,!0);c.lineWidth=4;c.fillStyle="#ed0049";
c.strokeStyle="#ffffff";c.globalAlpha=1;ig.drawRoundRect(c,b.x+50,b.y+870,440,30,17,!1,!0);c.fillStyle="#ed0049";c.strokeStyle="#ed0049";var e=430*this._drawStatus;22>e&&(e=22);ig.drawRoundRect(c,b.x+50+5,b.y+870+5,e,20,12,!0,!1);c.restore()}else c=ig.system.context,c.fillStyle="#ffffff",c.strokeStyle="#000000",c.lineWidth=8,c.lineJoin="round",c.textAlign="center",c.font="54px mainfont",c.strokeText("UNABLE TO RUN GAME",b.x+270,760),c.fillText("UNABLE TO RUN GAME",b.x+270,760),c.font="28px mainfont",
c.strokeText("THIS BROWSER DOES NOT SUPPORT WEBGL",b.x+270,800),c.fillText("THIS BROWSER DOES NOT SUPPORT WEBGL",b.x+270,800)}})});ig.baked=!0;
ig.module("plugins.tween").requires("impact.entity").defines(function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(c){for(var b=0;b<this.length;++b)if(this[b]===c)return b;return-1});ig.Entity.prototype.tweens=[];ig.Entity.prototype._preTweenUpdate=ig.Entity.prototype.update;ig.Entity.prototype.update=function(){this._preTweenUpdate();if(0<this.tweens.length){for(var c=[],b=0;b<this.tweens.length;b++)this.tweens[b].update(),this.tweens[b].complete||c.push(this.tweens[b]);this.tweens=
c}};ig.Entity.prototype.tween=function(c,b,e){c=new ig.Tween(this,c,b,e);this.tweens.push(c);return c};ig.Entity.prototype.pauseTweens=function(){for(var c=0;c<this.tweens.length;c++)this.tweens[c].pause()};ig.Entity.prototype.resumeTweens=function(){for(var c=0;c<this.tweens.length;c++)this.tweens[c].resume()};ig.Entity.prototype.stopTweens=function(c){for(var b=0;b<this.tweens.length;b++)this.tweens[b].stop(c)};ig.Tween=function(c,b,e,d){var j={},f={},p={},l=0,g=!1,m=!1,n=!1;this.duration=e;this.paused=
this.complete=!1;this.easing=ig.Tween.Easing.Linear.EaseNone;this.onComplete=!1;this.loop=this.delay=0;this.loopCount=-1;ig.merge(this,d);this.loopNum=this.loopCount;this.chain=function(b){n=b};this.initEnd=function(b,c,d){if("object"!==typeof c[b])d[b]=c[b];else for(subprop in c[b])d[b]||(d[b]={}),this.initEnd(subprop,c[b],d[b])};this.initStart=function(b,c,d,e){if("object"!==typeof d[b])"undefined"!==typeof c[b]&&(e[b]=d[b]);else for(subprop in d[b])e[b]||(e[b]={}),"undefined"!==typeof c[b]&&this.initStart(subprop,
c[b],d[b],e[b])};this.start=function(){this.paused=this.complete=!1;this.loopNum=this.loopCount;l=0;-1==c.tweens.indexOf(this)&&c.tweens.push(this);m=!0;g=new ig.Timer;for(var d in b)this.initEnd(d,b,f);for(d in f)this.initStart(d,f,c,j),this.initDelta(d,p,c,f)};this.initDelta=function(b,c,d,e){if("object"!==typeof e[b])c[b]=e[b]-d[b];else for(subprop in e[b])c[b]||(c[b]={}),this.initDelta(subprop,c[b],d[b],e[b])};this.propUpdate=function(b,c,d,e,f){if("object"!==typeof d[b])c[b]="undefined"!=typeof d[b]?
d[b]+e[b]*f:c[b];else for(subprop in d[b])this.propUpdate(subprop,c[b],d[b],e[b],f)};this.propSet=function(b,c,d){if("object"!==typeof c[b])d[b]=c[b];else for(subprop in c[b])d[b]||(d[b]={}),this.propSet(subprop,c[b],d[b])};this.update=function(){if(!m)return!1;if(this.delay){if(g.delta()<this.delay)return;this.delay=0;g.reset()}if(this.paused||this.complete)return!1;var b=(g.delta()+l)/this.duration,b=1<b?1:b,d=this.easing(b);for(property in p)this.propUpdate(property,c,j,p,d);if(1<=b){if(0==this.loopNum||
!this.loop){this.complete=!0;if(this.onComplete)this.onComplete();n&&n.start();return!1}if(this.loop==ig.Tween.Loop.Revert){for(property in j)this.propSet(property,j,c);l=0;g.reset();-1!=this.loopNum&&this.loopNum--}else if(this.loop==ig.Tween.Loop.Reverse){b={};d={};ig.merge(b,f);ig.merge(d,j);ig.merge(j,b);ig.merge(f,d);for(property in f)this.initDelta(property,p,c,f);l=0;g.reset();-1!=this.loopNum&&this.loopNum--}}};this.pause=function(){this.paused=!0;g&&g.delta&&(l+=g.delta())};this.resume=function(){this.paused=
!1;g&&g.reset&&g.reset()};this.stop=function(b){b&&(this.loop=this.complete=this.paused=!1,l+=e,this.update());this.complete=!0}};ig.Tween.Loop={Revert:1,Reverse:2};ig.Tween.Easing={Linear:{},Quadratic:{},Cubic:{},Quartic:{},Quintic:{},Sinusoidal:{},Exponential:{},Circular:{},Elastic:{},Back:{},Bounce:{}};ig.Tween.Easing.Linear.EaseNone=function(c){return c};ig.Tween.Easing.Quadratic.EaseIn=function(c){return c*c};ig.Tween.Easing.Quadratic.EaseOut=function(c){return-c*(c-2)};ig.Tween.Easing.Quadratic.EaseInOut=
function(c){return 1>(c*=2)?0.5*c*c:-0.5*(--c*(c-2)-1)};ig.Tween.Easing.Cubic.EaseIn=function(c){return c*c*c};ig.Tween.Easing.Cubic.EaseOut=function(c){return--c*c*c+1};ig.Tween.Easing.Cubic.EaseInOut=function(c){return 1>(c*=2)?0.5*c*c*c:0.5*((c-=2)*c*c+2)};ig.Tween.Easing.Quartic.EaseIn=function(c){return c*c*c*c};ig.Tween.Easing.Quartic.EaseOut=function(c){return-(--c*c*c*c-1)};ig.Tween.Easing.Quartic.EaseInOut=function(c){return 1>(c*=2)?0.5*c*c*c*c:-0.5*((c-=2)*c*c*c-2)};ig.Tween.Easing.Quintic.EaseIn=
function(c){return c*c*c*c*c};ig.Tween.Easing.Quintic.EaseOut=function(c){return(c-=1)*c*c*c*c+1};ig.Tween.Easing.Quintic.EaseInOut=function(c){return 1>(c*=2)?0.5*c*c*c*c*c:0.5*((c-=2)*c*c*c*c+2)};ig.Tween.Easing.Sinusoidal.EaseIn=function(c){return-Math.cos(c*Math.PI/2)+1};ig.Tween.Easing.Sinusoidal.EaseOut=function(c){return Math.sin(c*Math.PI/2)};ig.Tween.Easing.Sinusoidal.EaseInOut=function(c){return-0.5*(Math.cos(Math.PI*c)-1)};ig.Tween.Easing.Exponential.EaseIn=function(c){return 0==c?0:Math.pow(2,
10*(c-1))};ig.Tween.Easing.Exponential.EaseOut=function(c){return 1==c?1:-Math.pow(2,-10*c)+1};ig.Tween.Easing.Exponential.EaseInOut=function(c){return 0==c?0:1==c?1:1>(c*=2)?0.5*Math.pow(2,10*(c-1)):0.5*(-Math.pow(2,-10*(c-1))+2)};ig.Tween.Easing.Circular.EaseIn=function(c){return-(Math.sqrt(1-c*c)-1)};ig.Tween.Easing.Circular.EaseOut=function(c){return Math.sqrt(1- --c*c)};ig.Tween.Easing.Circular.EaseInOut=function(c){return 1>(c/=0.5)?-0.5*(Math.sqrt(1-c*c)-1):0.5*(Math.sqrt(1-(c-=2)*c)+1)};ig.Tween.Easing.Elastic.EaseIn=
function(c){var b,e=0.1,d=0.4;if(0==c)return 0;if(1==c)return 1;d||(d=0.3);!e||1>e?(e=1,b=d/4):b=d/(2*Math.PI)*Math.asin(1/e);return-(e*Math.pow(2,10*(c-=1))*Math.sin((c-b)*2*Math.PI/d))};ig.Tween.Easing.Elastic.EaseOut=function(c){var b,e=0.1,d=0.4;if(0==c)return 0;if(1==c)return 1;d||(d=0.3);!e||1>e?(e=1,b=d/4):b=d/(2*Math.PI)*Math.asin(1/e);return e*Math.pow(2,-10*c)*Math.sin((c-b)*2*Math.PI/d)+1};ig.Tween.Easing.Elastic.EaseInOut=function(c){var b,e=0.1,d=0.4;if(0==c)return 0;if(1==c)return 1;
d||(d=0.3);!e||1>e?(e=1,b=d/4):b=d/(2*Math.PI)*Math.asin(1/e);return 1>(c*=2)?-0.5*e*Math.pow(2,10*(c-=1))*Math.sin((c-b)*2*Math.PI/d):0.5*e*Math.pow(2,-10*(c-=1))*Math.sin((c-b)*2*Math.PI/d)+1};ig.Tween.Easing.Back.EaseIn=function(c){return c*c*(2.70158*c-1.70158)};ig.Tween.Easing.Back.EaseOut=function(c){return(c-=1)*c*(2.70158*c+1.70158)+1};ig.Tween.Easing.Back.EaseInOut=function(c){return 1>(c*=2)?0.5*c*c*(3.5949095*c-2.5949095):0.5*((c-=2)*c*(3.5949095*c+2.5949095)+2)};ig.Tween.Easing.Bounce.EaseIn=
function(c){return 1-ig.Tween.Easing.Bounce.EaseOut(1-c)};ig.Tween.Easing.Bounce.EaseOut=function(c){return(c/=1)<1/2.75?7.5625*c*c:c<2/2.75?7.5625*(c-=1.5/2.75)*c+0.75:c<2.5/2.75?7.5625*(c-=2.25/2.75)*c+0.9375:7.5625*(c-=2.625/2.75)*c+0.984375};ig.Tween.Easing.Bounce.EaseInOut=function(c){return 0.5>c?0.5*ig.Tween.Easing.Bounce.EaseIn(2*c):0.5*ig.Tween.Easing.Bounce.EaseOut(2*c-1)+0.5};ig.Tween.Interpolation={Linear:function(c,b){var e=c.length-1,d=e*b,j=Math.floor(d),f=TWEEN.Interpolation.Utils.Linear;
return 0>b?f(c[0],c[1],d):1<b?f(c[e],c[e-1],e-d):f(c[j],c[j+1>e?e:j+1],d-j)}}});ig.baked=!0;
ig.module("plugins.patches.entity-patch").requires("impact.entity").defines(function(){ig.Entity.inject({handleMovementTrace:function(c){this.standing=!1;c.collision.y&&(0<this.bounciness&&Math.abs(this.vel.y)>this.minBounceVelocity?this.vel.y*=-this.bounciness:(0<this.vel.y&&(this.standing=!0),this.vel.y=0));c.collision.x&&(this.vel.x=0<this.bounciness&&Math.abs(this.vel.x)>this.minBounceVelocity?this.vel.x*-this.bounciness:0);if(c.collision.slope){var b=c.collision.slope;if(0<this.bounciness){var e=
this.vel.x*b.nx+this.vel.y*b.ny;this.vel.x=(this.vel.x-2*b.nx*e)*this.bounciness;this.vel.y=(this.vel.y-2*b.ny*e)*this.bounciness}else e=(this.vel.x*b.x+this.vel.y*b.y)/(b.x*b.x+b.y*b.y),this.vel.x=b.x*e,this.vel.y=b.y*e,b=Math.atan2(b.x,b.y),b>this.slopeStanding.min&&b<this.slopeStanding.max&&(this.standing=!0)}this.pos.x=c.pos.x;this.pos.y=c.pos.y}})});ig.baked=!0;
ig.module("plugins.tweens-handler").requires("impact.entity","plugins.tween","plugins.patches.entity-patch").defines(function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(b){for(var c=0;c<this.length;++c)if(this[c]===b)return c;return-1});ig.TweensHandler=ig.Class.extend({_tweens:[],_systemPausedTweens:[],init:function(){},getAll:function(){return this._tweens},removeAll:function(){this._tweens=[]},add:function(b){this._tweens.push(b)},remove:function(b){b=this._tweens.indexOf(b);
-1!==b&&this._tweens.splice(b,1)},onSystemPause:function(){if(0===this._tweens.length)return!1;for(var b=0,c=null;b<this._tweens.length;)c=this._tweens[b],c._isPlaying&&(this._systemPausedTweens.push(c),c.pause()),b++;return!0},onSystemResume:function(){if(0===this._systemPausedTweens.length)return!1;for(var b=0;b<this._systemPausedTweens.length;)this._systemPausedTweens[b].resume(),b++;this._systemPausedTweens=[];return!0},update:function(b,c){if(0===this._tweens.length)return!1;var d=0;for(b=void 0!==
b?b:ig.game.tweens.now();d<this._tweens.length;)this._tweens[d].update(b)||c?d++:this._tweens.splice(d,1);return!0},now:function(){return Date.now()}});ig.TweenDef=ig.Class.extend({_ent:null,_valuesStart:{},_valuesEnd:{},_valuesStartRepeat:{},_duration:1E3,_repeat:0,_yoyo:!1,_isPlaying:!1,_reversed:!1,_delayTime:0,_startTime:null,_pauseTime:null,_easingFunction:ig.Tween.Easing.Linear.EaseNone,_interpolationFunction:ig.Tween.Interpolation.Linear,_chainedTweens:[],_onStartCallback:null,_onStartCallbackFired:!1,
_onUpdateCallback:null,_onCompleteCallback:null,_onStopCallback:null,_onPauseCallback:null,_onResumeCallback:null,_currentElapsed:0,init:function(b){this._object=b},to:function(b,c){this._valuesEnd=b;void 0!==c&&(this._duration=c);return this},start:function(b){if(this._isPlaying)return this;ig.game.tweens.add(this);this._isPlaying=!0;this._onStartCallbackFired=!1;this._startTime=void 0!==b?b:ig.game.tweens.now();this._startTime+=this._delayTime;for(var c in this._valuesEnd){if(this._valuesEnd[c]instanceof
Array){if(0===this._valuesEnd[c].length)continue;this._valuesEnd[c]=[this._object[c]].concat(this._valuesEnd[c])}void 0!==this._object[c]&&(this._valuesStart[c]=this._object[c],!1===this._valuesStart[c]instanceof Array&&(this._valuesStart[c]*=1),this._valuesStartRepeat[c]=this._valuesStart[c]||0)}return this},stop:function(){if(!this._isPlaying)return this;ig.game.tweens.remove(this);this._isPlaying=!1;null!==this._onStopCallback&&this._onStopCallback.call(this._object,this._object);this.stopChainedTweens();
return this},pause:function(){if(!this._isPlaying)return this;ig.game.tweens.remove(this);this._isPlaying=!1;this._pauseTime=ig.game.tweens.now();null!==this._onPauseCallback&&this._onPauseCallback.call(this._object,this._object);return this},resume:function(){if(this._isPlaying||!this._pauseTime)return this;var b=ig.game.tweens.now()-this._pauseTime;this._startTime+=b;ig.game.tweens.add(this);this._isPlaying=!0;null!==this._onResumeCallback&&this._onResumeCallback.call(this._object,this._object);
this._pauseTime=null;return this},end:function(){this.update(this._startTime+this._duration);return this},stopChainedTweens:function(){for(var b=0,c=this._chainedTweens.length;b<c;b++)this._chainedTweens[b].stop()},delay:function(b){this._delayTime=b;return this},repeat:function(b){this._repeat=b;return this},repeatDelay:function(b){this._repeatDelayTime=b;return this},yoyo:function(b){this._yoyo=b;return this},easing:function(b){this._easingFunction=b;return this},interpolation:function(b){this._interpolationFunction=
b;return this},chain:function(){this._chainedTweens=arguments;return this},onStart:function(b){this._onStartCallback=b;return this},onUpdate:function(b){this._onUpdateCallback=b;return this},onComplete:function(b){this._onCompleteCallback=b;return this},onStop:function(b){this._onStopCallback=b;return this},onPause:function(b){this._onPauseCallback=b;return this},onResume:function(b){this._onResumeCallback=b;return this},update:function(b){var c,d,j;if(b<this._startTime)return!0;!1===this._onStartCallbackFired&&
(null!==this._onStartCallback&&this._onStartCallback.call(this._object,this._object),this._onStartCallbackFired=!0);d=(b-this._startTime)/this._duration;this._currentElapsed=d=1<d?1:d;j=this._easingFunction(d);for(c in this._valuesEnd)if(void 0!==this._valuesStart[c]){var f=this._valuesStart[c]||0,p=this._valuesEnd[c];p instanceof Array?this._object[c]=this._interpolationFunction(p,j):("string"===typeof p&&(p="+"===p.charAt(0)||"-"===p.charAt(0)?f+parseFloat(p):parseFloat(p)),"number"===typeof p&&
(this._object[c]=f+(p-f)*j))}null!==this._onUpdateCallback&&this._onUpdateCallback.call(this._object,this._object,j);if(1===d)if(0<this._repeat){isFinite(this._repeat)&&this._repeat--;for(c in this._valuesStartRepeat)"string"===typeof this._valuesEnd[c]&&(this._valuesStartRepeat[c]=_valuesStartRepeat[c]+parseFloat(_valuesEnd[c])),this._yoyo&&(d=this._valuesStartRepeat[c],this._valuesStartRepeat[c]=this._valuesEnd[c],this._valuesEnd[c]=d),this._valuesStart[c]=this._valuesStartRepeat[c];this._yoyo&&
(this._reversed=!this._reversed);this._startTime=void 0!==this._repeatDelayTime?b+this._repeatDelayTime:b+this._delayTime}else{null!==this._onCompleteCallback&&this._onCompleteCallback.call(this._object,this._object);b=0;for(c=this._chainedTweens.length;b<c;b++)this._chainedTweens[b].start(this._startTime+this._duration);return!1}return!0}});var c=[1];ig.Tween.Interpolation={Linear:function(b,c){var d=b.length-1,j=d*c,f=Math.floor(j),p=ig.Tween.Interpolation.Utils.Linear;return 0>c?p(b[0],b[1],j):
1<c?p(b[d],b[d-1],d-j):p(b[f],b[f+1>d?d:f+1],j-f)},Bezier:function(b,c){for(var d=0,j=b.length-1,f=Math.pow,p=ig.Tween.Interpolation.Utils.Bernstein,l=0;l<=j;l++)d+=f(1-c,j-l)*f(c,l)*b[l]*p(j,l);return d},CatmullRom:function(b,c){var d=b.length-1,j=d*c,f=Math.floor(j),p=ig.Tween.Interpolation.Utils.CatmullRom;return b[0]===b[d]?(0>c&&(f=Math.floor(j=d*(1+c))),p(b[(f-1+d)%d],b[f],b[(f+1)%d],b[(f+2)%d],j-f)):0>c?b[0]-(p(b[0],b[0],b[1],b[1],-j)-b[0]):1<c?b[d]-(p(b[d],b[d],b[d-1],b[d-1],j-d)-b[d]):p(b[f?
f-1:0],b[f],b[d<f+1?d:f+1],b[d<f+2?d:f+2],j-f)},Utils:{Linear:function(b,c,d){return(c-b)*d+b},Bernstein:function(b,c){var d=ig.Tween.Interpolation.Utils.Factorial;return d(b)/d(c)/d(b-c)},Factorial:function(b){var e=1;if(c[b])return c[b];for(var d=b;1<d;d--)e*=d;return c[b]=e},CatmullRom:function(b,c,d,j,f){b=0.5*(d-b);j=0.5*(j-c);var p=f*f;return(2*c-2*d+b+j)*f*p+(-3*c+3*d-2*b-j)*p+b*f+c}}}});ig.baked=!0;
ig.module("plugins.url-parameters").defines(function(){ig.UrlParameters=ig.Class.extend({init:function(){switch(getQueryVariable("iphone")){case "true":ig.ua.iPhone=!0,console.log("iPhone mode")}var c=getQueryVariable("webview");if(c)switch(c){case "true":ig.ua.is_uiwebview=!0,console.log("webview mode")}if(c=getQueryVariable("debug"))switch(c){case "true":ig.game.showDebugMenu(),console.log("debug mode")}if(c=getQueryVariable("debugwgl"))switch(c){case "true":wgl.debug.debug=!0,console.log("wgl debug mode")}switch(getQueryVariable("view")){case "stats":ig.game.resetPlayerStats(),
ig.game.endGame()}getQueryVariable("ad")}})});ig.baked=!0;
ig.module("plugins.director").requires("impact.impact").defines(function(){ig.Director=ig.Class.extend({init:function(c,b){this.game=c;this.levels=[];this.currentLevel=0;this.append(b)},loadLevel:function(c){for(var b in ig.sizeHandler.dynamicClickableEntityDivs){var e=ig.domHandler.getElementById("#"+b);ig.domHandler.hide(e)}this.currentLevel=c;this.game.loadLevel(this.levels[c]);return!0},loadLevelWithoutEntities:function(c){this.currentLevel=c;this.game.loadLevelWithoutEntities(this.levels[c]);
return!0},append:function(c){newLevels=[];return"object"===typeof c?(c.constructor===[].constructor?newLevels=c:newLevels[0]=c,this.levels=this.levels.concat(newLevels),!0):!1},nextLevel:function(){return this.currentLevel+1<this.levels.length?this.loadLevel(this.currentLevel+1):!1},previousLevel:function(){return 0<=this.currentLevel-1?this.loadLevel(this.currentLevel-1):!1},jumpTo:function(c){var b=null;for(i=0;i<this.levels.length;i++)this.levels[i]==c&&(b=i);return 0<=b?this.loadLevel(b):!1},
firstLevel:function(){return this.loadLevel(0)},lastLevel:function(){return this.loadLevel(this.levels.length-1)},reloadLevel:function(){return this.loadLevel(this.currentLevel)}})});ig.baked=!0;
ig.module("plugins.impact-storage").requires("impact.game").defines(function(){ig.Storage=ig.Class.extend({staticInstantiate:function(){return!ig.Storage.instance?null:ig.Storage.instance},init:function(){ig.Storage.instance=this},isCapable:function(){return"undefined"!==typeof window.localStorage},isSet:function(c){return null!==this.get(c)},initUnset:function(c,b){null===this.get(c)&&this.set(c,b)},get:function(c){if(!this.isCapable())return null;try{return JSON.parse(localStorage.getItem(c))}catch(b){return window.localStorage.getItem(c)}},
getInt:function(c){return~~this.get(c)},getFloat:function(c){return parseFloat(this.get(c))},getBool:function(c){return!!this.get(c)},key:function(c){return this.isCapable()?window.localStorage.key(c):null},set:function(c,b){if(!this.isCapable())return null;try{window.localStorage.setItem(c,JSON.stringify(b))}catch(e){console.log(e)}},setHighest:function(c,b){b>this.getFloat(c)&&this.set(c,b)},remove:function(c){if(!this.isCapable())return null;window.localStorage.removeItem(c)},clear:function(){if(!this.isCapable())return null;
window.localStorage.clear()}})});ig.baked=!0;
ig.module("plugins.responsive.responsive-utils").requires("impact.system").defines(function(){ig.responsive={width:0,height:0,halfWidth:0,halfHeight:0,originalWidth:0,originalHeight:0,fillScale:1,scaleX:1,scaleY:1,toAnchor:function(c,b,e){switch(e){case "top-left":case "left-top":return this.toAnchorTopLeft(c,b);case "top-center":case "center-top":case "top":return this.toAnchorTopCenter(c,b);case "top-right":case "right-top":return this.toAnchorTopRight(c,b);case "left-middle":case "middle-left":case "left":return this.toAnchorLeftMiddle(c,
b);case "center-middle":case "middle-center":case "middle":case "center":return this.toAnchorCenterMiddle(c,b);case "right-middle":case "middle-right":case "right":return toAnchorRightMiddle(c,b);case "bottom-left":case "left-bottom":return this.toAnchorBottomLeft(c,b);case "bottom-center":case "center-bottom":case "bottom":return this.toAnchorBottomCenter(c,b);case "bottom-right":case "right-bottom":return this.toAnchorBottomRight(c,b);default:return this.toAnchorDefault(c,b)}},toAnchorDefault:function(c,
b){return{x:c+(this.width-this.originalWidth)/2,y:b+(this.height-this.originalHeight)/2}},toAnchorCenterMiddle:function(c,b){return{x:c+this.halfWidth,y:b+this.halfHeight}},toAnchorLeftMiddle:function(c,b){return{x:c,y:b+this.halfHeight}},toAnchorTopCenter:function(c,b){return{x:c+this.halfWidth,y:b}},toAnchorRightMiddle:function(c,b){return{x:c+this.width,y:b+this.halfHeight}},toAnchorBottomCenter:function(c,b){return{x:c+this.halfWidth,y:b+this.height}},toAnchorTopLeft:function(c,b){return{x:c,
y:b}},toAnchorBottomLeft:function(c,b){return{x:c,y:b+this.height}},toAnchorTopRight:function(c,b){return{x:c+this.width,y:b}},toAnchorBottomRight:function(c,b){return{x:c+this.width,y:b+this.height}},drawScaledImage:function(c,b,e,d,j,f,p){f||(f=0);p||(p=0);var l=ig.system.context;l.save();l.translate(b,e);(1!=d||1!=j)&&l.scale(d,j);c.draw(-c.width*f,-c.height*p);l.restore()}}});ig.baked=!0;
ig.module("plugins.responsive.responsive-plugin").requires("impact.system","impact.entity","plugins.handlers.size-handler","plugins.responsive.responsive-utils").defines(function(){ig.SizeHandler.inject({resize:function(){this.parent()},sizeCalcs:function(){this.originalResolution||(this.originalResolution=new BABYLON.Vector2(this.desktop.actualResolution.x,this.desktop.actualResolution.y),ig.responsive.originalWidth=this.desktop.actualResolution.x,ig.responsive.originalHeight=this.desktop.actualResolution.y);
var c=window.innerWidth,b=window.innerHeight,e=c/b,d=this.originalResolution.x/this.originalResolution.y,j=0,f=0;this.windowSize=new BABYLON.Vector2(c,b);e<d?(j=this.originalResolution.x,f=j/e,ig.responsive.scaleX=1,ig.responsive.scaleY=f/this.originalResolution.y):(f=this.originalResolution.y,j=f*e,ig.responsive.scaleX=j/this.originalResolution.x,ig.responsive.scaleY=1);this.scaleRatioMultiplier=new BABYLON.Vector2(c/j,b/f);this.desktop.actualResolution=new BABYLON.Vector2(j,f);this.mobile.actualResolution=
new BABYLON.Vector2(j,f);this.desktop.actualSize=new BABYLON.Vector2(c,b);this.mobile.actualSize=new BABYLON.Vector2(c,b);ig.responsive.width=j;ig.responsive.height=f;ig.responsive.halfWidth=j/2;ig.responsive.halfHeight=f/2;ig.responsive.fillScale=Math.max(ig.responsive.scaleX,ig.responsive.scaleY)},resizeLayers:function(){ig.system.resize(ig.sizeHandler.desktop.actualResolution.x,ig.sizeHandler.desktop.actualResolution.y);for(var c=0;c<this.coreDivsToResize.length;c++){var b=ig.domHandler.getElementById(this.coreDivsToResize[c]),
e=Math.floor(ig.sizeHandler.windowSize.x/2-ig.sizeHandler.desktop.actualSize.x/2),d=Math.floor(ig.sizeHandler.windowSize.y/2-ig.sizeHandler.desktop.actualSize.y/2);0>e&&(e=0);0>d&&(d=0);ig.domHandler.resizeOffset(b,Math.floor(ig.sizeHandler.desktop.actualSize.x),Math.floor(ig.sizeHandler.desktop.actualSize.y),e,d)}for(var j in this.adsToResize)c=ig.domHandler.getElementById("#"+j),b=ig.domHandler.getElementById("#"+j+"-Box"),e=(window.innerWidth-this.adsToResize[j]["box-width"])/2+"px",d=(window.innerHeight-
this.adsToResize[j]["box-height"])/2+"px",c&&ig.domHandler.css(c,{width:window.innerWidth,height:window.innerHeight}),b&&ig.domHandler.css(b,{left:e,top:d});c=ig.domHandler.getElementById("#canvas");b=ig.domHandler.getOffsets(c);c=b.left;b=b.top;e=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);for(j in this.dynamicClickableEntityDivs)d=ig.domHandler.getElementById("#"+j),ig.domHandler.css(d,{"float":"left",position:"absolute",left:Math.floor(c+this.dynamicClickableEntityDivs[j].entity_pos_x*
this.scaleRatioMultiplier.x)+"px",top:Math.floor(b+this.dynamicClickableEntityDivs[j].entity_pos_y*this.scaleRatioMultiplier.y)+"px",width:Math.floor(this.dynamicClickableEntityDivs[j].width*this.scaleRatioMultiplier.x)+"px",height:Math.floor(this.dynamicClickableEntityDivs[j].height*this.scaleRatioMultiplier.y)+"px","z-index":3}),this.dynamicClickableEntityDivs[j]["font-size"]&&ig.domHandler.css(d,{"font-size":this.dynamicClickableEntityDivs[j]["font-size"]*e+"px"});$("#ajaxbar").width(this.windowSize.x);
$("#ajaxbar").height(this.windowSize.y)},reorient:function(){ig.ua.mobile?(this.resize(),this.resizeAds()):this.resize();this.resizeBabylon();ig.game&&(ig.game.update(),ig.game.draw())},resizeBabylon:function(){var c=window.innerWidth,b=window.innerHeight,e=c/b,d=ig.responsive.originalWidth,j=ig.responsive.originalHeight,f=d/j,p=2560;ig.ua.mobile&&(p=640);minSize=Math.min(d,j);e>f?(b>j&&(b=j),c=Math.floor(window.innerWidth/window.innerHeight*b),c>p&&(c=p),b=Math.floor(window.innerHeight/window.innerWidth*
c)):(c>d&&(c=d),b=Math.floor(window.innerHeight/window.innerWidth*c),b>p&&(b=p),c=Math.floor(window.innerWidth/window.innerHeight*b));d=e=1;window.innerWidth>p&&(e=window.innerWidth/p);window.innerHeight>p&&(d=window.innerHeight/p);p=null;window.wgl&&(wgl.system&&wgl.system.engine)&&(p=wgl.system.engine);ig.altBabylon&&(p=ig.altBabylon.engine);p.setSize(c,b);p.resize();p.setHardwareScalingLevel(Math.max(e,d));console.log("babylon renderSize : ",p.getRenderWidth(),p.getRenderHeight(),"hwScalingLevel : ",
p.getHardwareScalingLevel().toFixed(2))}});ig.Entity.inject({init:function(c,b,e){this.parent(c,b,e);this.anchorType="none";this.anchoredPositionX=c;this.anchoredPositionY=b},setAnchoredPosition:function(c,b,e){e||(e="default");this.anchorType=e;this.anchoredPositionX=c;this.anchoredPositionY=b},update:function(){this.parent();if(""!=this.anchorType&&"none"!=this.anchorType){var c=ig.responsive.toAnchor(this.anchoredPositionX,this.anchoredPositionY,this.anchorType);this.pos.x=c.x;this.pos.y=c.y}}})});
this.START_BRANDING_SPLASH;ig.baked=!0;
ig.module("plugins.branding.splash").requires("impact.impact","impact.entity").defines(function(){ig.BrandingSplash=ig.Class.extend({init:function(){ig.game.spawnEntity(EntityBranding,0,0)}});EntityBranding=ig.Entity.extend({autoUpdateScale:!1,gravityFactor:0,size:{x:32,y:32},splash:new ig.Image("branding/splash1.png"),init:function(c,b,e){this.parent(c,b,e);320>=ig.system.width?(this.size.x=320,this.size.y=200):(this.size.x=480,this.size.y=240);this.pos.x=(ig.system.width-this.size.x)/2;this.pos.y=
-this.size.y-200;this.endPosY=(ig.system.height-this.size.y)/2;c=this.tween({pos:{y:this.endPosY}},0.5,{easing:ig.Tween.Easing.Bounce.EaseIn});b=this.tween({},2.5,{onComplete:function(){ig.game.director.loadLevel(ig.game.director.currentLevel)}});c.chain(b);c.start();this.currentAnim=this.anims.idle},createClickableLayer:function(){console.log("Build clickable layer");this.checkClickableLayer("branding-splash",_SETTINGS.Branding.Logo.Link,_SETTINGS.Branding.Logo.NewWindow)},doesClickableLayerExist:function(c){for(k in dynamicClickableEntityDivs)if(k==
c)return!0;return!1},checkClickableLayer:function(c,b,e){"undefined"==typeof wm&&(this.doesClickableLayerExist(c)?(ig.game.showOverlay([c]),$("#"+c).find("[href]").attr("href",b)):this.createClickableOutboundLayer(c,b,"media/graphics/misc/invisible.png",e))},createClickableOutboundLayer:function(c,b,e,d){var j=ig.$new("div");j.id=c;document.body.appendChild(j);j=$("#"+j.id);j.css("float","left");j.css("position","absolute");if(ig.ua.mobile){var f=window.innerHeight/mobileHeight,p=window.innerWidth/
mobileWidth;j.css("left",this.pos.x*p);j.css("top",this.pos.y*f);j.css("width",this.size.x*p);j.css("height",this.size.y*f)}else f=w/2-destW/2,p=h/2-destH/2,console.log(f,p),j.css("left",f+this.pos.x*multiplier),j.css("top",p+this.pos.y*multiplier),j.css("width",this.size.x*multiplier),j.css("height",this.size.y*multiplier);d?j.html("<a target='_blank' href='"+b+"'><img style='width:100%;height:100%' src='"+e+"'></a>"):j.html("<a href='"+b+"'><img style='width:100%;height:100%' src='"+e+"'></a>");
dynamicClickableEntityDivs[c]={};dynamicClickableEntityDivs[c].width=this.size.x*multiplier;dynamicClickableEntityDivs[c].height=this.size.y*multiplier;dynamicClickableEntityDivs[c].entity_pos_x=this.pos.x;dynamicClickableEntityDivs[c].entity_pos_y=this.pos.y},draw:function(){ig.system.context.fillStyle="#ffffff";ig.system.context.fillRect(0,0,ig.system.width,ig.system.height);ig.system.context.fillStyle="#000";ig.system.context.font="12px Arial";ig.system.context.textAlign="left";320>=ig.system.width?
ig.system.context.fillText("powered by MarketJS.com",ig.system.width-150,ig.system.height-15):ig.system.context.fillText("powered by MarketJS.com",ig.system.width-160,ig.system.height-15);this.parent();this.splash&&ig.system.context.drawImage(this.splash.data,0,0,this.splash.data.width,this.splash.data.height,this.pos.x,this.pos.y,this.size.x,this.size.y)}})});this.END_BRANDING_SPLASH;ig.baked=!0;
ig.module("plugins.datastructure.binary-heap").defines(function(){BinaryHeap=ig.Class.extend({content:[],getValue:null,minHeap:!0,tagName:"BinaryHeap",init:function(c,b){this.getValue=c;b&&(this.minHeap=!1)},push:function(c){this.content.push(c);this.sinkDown(this.content.length-1)},pop:function(){var c=this.content[0],b=this.content.pop();0<this.content.length&&(this.content[0]=b,this.bubbleUp(0));return c},remove:function(c){var b=this.content.indexOf(c),e=this.content.pop();b!==this.content.length-
1&&(this.content[b]=e,this.minHeap?this.getValue(e)<this.getValue(c)?this.sinkDown(b):this.bubbleUp(b):this.getValue(e)>this.getValue(c)?this.sinkDown(b):this.bubbleUp(b))},size:function(){return this.content.length},rescoreElement:function(c){this.sinkDown(this.content.indexOf(c))},sinkDown:function(c){for(var b=this.content[c];0<c;){var e=(c+1>>1)-1,d=this.content[e];if(this.minHeap)if(this.getValue(b)<this.getValue(d))this.content[e]=b,this.content[c]=d,c=e;else break;else if(this.getValue(b)>
this.getValue(d))this.content[e]=b,this.content[c]=d,c=e;else break}},bubbleUp:function(c){for(var b=this.content.length,e=this.content[c],d=this.getValue(e);;){var j=c+1<<1,f=j-1,p=null,l;f<b&&(l=this.getValue(this.content[f]),this.minHeap?l<d&&(p=f):l>d&&(p=f));if(j<b)if(f=this.getValue(this.content[j]),this.minHeap){if(f<(null===p?d:l))p=j}else if(f>(null===p?d:l))p=j;if(null!==p)this.content[c]=this.content[p],this.content[p]=e,c=p;else break}},empty:function(){for(;0<this.content.length;)this.content.pop()}})});
ig.baked=!0;
ig.module("game.entities.buttons.button").requires("impact.entity").defines(function(){EntityButton=ig.Entity.extend({collides:ig.Entity.COLLIDES.NEVER,type:ig.Entity.TYPE.A,size:new BABYLON.Vector2(48,48),fillColor:null,zIndex:95E3,pos:{x:0,y:0},name:"button",init:function(c,b,e){this.parent(c,b,e);!ig.global.wm&&(e&&!isNaN(e.zIndex))&&(this.zIndex=e.zIndex);c=Math.floor(256*Math.random());b=Math.floor(256*Math.random());e=Math.floor(256*Math.random());this.fillColor="rgba("+c+","+e+","+b+",1)"},
clicked:function(){throw"no implementation on clicked()";},clicking:function(){throw"no implementation on clicking()";},released:function(){throw"no implementation on released()";}})});ig.baked=!0;
ig.module("plugins.clickable-div-layer").defines(function(){ClickableDivLayer=ig.Class.extend({pos:new BABYLON.Vector2(0,0),size:new BABYLON.Vector2(0,0),identifier:null,invisImagePath:"media/graphics/misc/invisible.png",init:function(c){this.pos=new BABYLON.Vector2(c.pos.x,c.pos.y);this.size=new BABYLON.Vector2(c.size.x,c.size.y);var b="more-games",e="www.google.com",d=!1;c.div_layer_name&&(b=c.div_layer_name);c.link&&(e=c.link);c.newWindow&&(d=c.newWindow);this.createClickableLayer(b,e,d)},createClickableLayer:function(c,
b,e){this.identifier=c;var d=ig.domHandler.getElementById("#"+c);d?(ig.domHandler.show(d),ig.domHandler.attr(d,"href",b)):this.createClickableOutboundLayer(c,b,this.invisImagePath,e)},update:function(c,b,e,d){this.pos.x==c&&this.pos.y==b||(this.pos.x=c,this.pos.y=b,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier]={},ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].width=e,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].height=d,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].entity_pos_x=
this.pos.x,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].entity_pos_y=this.pos.y,ig.sizeHandler.resizeLayers())},createClickableOutboundLayer:function(c,b,e,d){var j=ig.domHandler.create("div");ig.domHandler.attr(j,"id",c);var f=ig.domHandler.create("a");ig.domHandler.addEvent(j,"mousedown",function(b){b.preventDefault()});d?(ig.domHandler.attr(f,"href",b),ig.domHandler.attr(f,"target","_blank")):ig.domHandler.attr(f,"href",b);b=ig.domHandler.create("img");ig.domHandler.css(b,{width:"100%",
height:"100%"});ig.domHandler.attr(b,"src",e);e=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);if(ig.ua.mobile){d=Math.floor(this.pos.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px";var p=Math.floor(this.pos.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px",l=Math.floor(this.size.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px";e=Math.floor(this.size.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px"}else d=ig.domHandler.getElementById("#canvas"),d=ig.domHandler.getOffsets(d),
p=d.top,d=Math.floor(d.left+this.pos.x*e)+"px",p=Math.floor(p+this.pos.y*e)+"px",l=Math.floor(this.size.x*e)+"px",e=Math.floor(this.size.y*e)+"px";ig.domHandler.css(j,{"float":"left",position:"absolute",left:d,top:p,width:l,height:e,"z-index":3});ig.domHandler.addEvent(j,"mousemove",ig.input.mousemove.bind(ig.input),!1);ig.domHandler.appendChild(f,b);ig.domHandler.appendChild(j,f);ig.domHandler.appendToBody(j);ig.sizeHandler.dynamicClickableEntityDivs[c]={};ig.sizeHandler.dynamicClickableEntityDivs[c].width=
this.size.x;ig.sizeHandler.dynamicClickableEntityDivs[c].height=this.size.y;ig.sizeHandler.dynamicClickableEntityDivs[c].entity_pos_x=this.pos.x;ig.sizeHandler.dynamicClickableEntityDivs[c].entity_pos_y=this.pos.y}})});ig.baked=!0;
ig.module("game.entities.buttons.button-branding-logo").requires("game.entities.buttons.button","plugins.clickable-div-layer").defines(function(){EntityButtonBrandingLogo=EntityButton.extend({type:ig.Entity.TYPE.A,gravityFactor:0,logo:new ig.AnimationSheet("branding/logo.png",_SETTINGS.Branding.Logo.Width,_SETTINGS.Branding.Logo.Height),zIndex:10001,size:{x:64,y:66},clickableLayer:null,link:null,newWindow:!1,div_layer_name:"branding-logo",name:"brandinglogo",init:function(c,b,e){this.parent(c,b,e);
if(!ig.global.wm){ig.responsive&&(this.anchorType="default");if("undefined"==typeof wm)if(_SETTINGS.Branding.Logo.Enabled)this.size.x=_SETTINGS.Branding.Logo.Width,this.size.y=_SETTINGS.Branding.Logo.Height,this.anims.idle=new ig.Animation(this.logo,0,[0],!0),this.currentAnim=this.anims.idle,e&&e.centralize&&(this.pos.x=(ig.system.width>>>1)-(this.size.x>>>1),console.log("centralize true ... centering branded logo ...")),_SETTINGS.Branding.Logo.LinkEnabled&&(this.link=_SETTINGS.Branding.Logo.Link,
this.newWindow=_SETTINGS.Branding.Logo.NewWindow,this.clickableLayer=new ClickableDivLayer(this));else{this.kill();return}this.div_layer_name=e.div_layer_name?e.div_layer_name:"branding-logo"}},show:function(){var c=ig.domHandler.getElementById("#"+this.div_layer_name);ig.domHandler.show(c)},hide:function(){var c=ig.domHandler.getElementById("#"+this.div_layer_name);ig.domHandler.hide(c)},clicked:function(){},clicking:function(){},released:function(){}})});ig.baked=!0;
ig.module("game.entities.branding-logo-placeholder").requires("impact.entity","game.entities.buttons.button-branding-logo").defines(function(){EntityBrandingLogoPlaceholder=ig.Entity.extend({gravityFactor:0,size:{x:32,y:32},_wmDrawBox:!0,_wmBoxColor:"rgba(0, 0, 255, 0.7)",init:function(c,b,e){this.parent(c,b,e);ig.responsive&&(this.anchorType="default");if(e)switch(console.log("settings found ... using that div layer name"),c=e.div_layer_name,console.log("settings.centralize:",e.centralize),e.centralize){case "true":console.log("centralize true");
centralize=!0;break;case "false":console.log("centralize false");centralize=!1;break;default:console.log("default ... centralize false"),centralize=!1}else c="branding-logo",centralize=!1;if("undefined"==typeof wm){if(_SETTINGS.Branding.Logo.Enabled)try{ig.game.spawnEntity(EntityButtonBrandingLogo,this.pos.x,this.pos.y,{div_layer_name:c,centralize:centralize})}catch(d){console.log(d)}this.kill()}}})});ig.baked=!0;
ig.module("game.entities.buttons.button-more-games").requires("game.entities.buttons.button","plugins.clickable-div-layer").defines(function(){EntityButtonMoreGames=EntityButton.extend({type:ig.Entity.TYPE.A,gravityFactor:0,logo:new ig.AnimationSheet("media/graphics/sprites/btn_more_games.png",64,66),size:{x:64,y:66},zIndex:750,clickableLayer:null,link:null,newWindow:!1,div_layer_name:"more-games",name:"moregames",init:function(c,b,e){this.parent(c,b,e);ig.global.wm||(ig.responsive&&(this.anchorType=
"default"),this.div_layer_name=e.div_layer_name?e.div_layer_name:"more-games",_SETTINGS.MoreGames.Enabled?(this.anims.idle=new ig.Animation(this.logo,0,[0],!0),this.currentAnim=this.anims.idle,_SETTINGS.MoreGames.Link&&(this.link=_SETTINGS.MoreGames.Link),_SETTINGS.MoreGames.NewWindow&&(this.newWindow=_SETTINGS.MoreGames.NewWindow),this.clickableLayer=new ClickableDivLayer(this)):this.kill())},update:function(){this.parent();this.clickableLayer.update(this.pos.x,this.pos.y,this.size.x,this.size.y)},
show:function(){var c=ig.domHandler.getElementById("#"+this.div_layer_name);ig.domHandler.show(c)},hide:function(){var c=ig.domHandler.getElementById("#"+this.div_layer_name);ig.domHandler.hide(c)},clicked:function(){},clicking:function(){},released:function(){}})});ig.baked=!0;
ig.module("game.entities.opening-kitty").requires("impact.entity").defines(function(){EntityOpeningKitty=ig.Entity.extend({size:{x:48,y:48},kittyAnim:-1,kittyImage:new ig.Image("media/graphics/opening/kitty.png"),kittyTitleImage:new ig.Image("media/graphics/opening/kittytitle.png"),soundKey:"kittyopeningSound",init:function(c,b,e){this.parent(c,b,e)},ready:function(){ig.wm||(_SETTINGS.DeveloperBranding.Splash.Enabled?this.initTimer=new ig.Timer(0.1):(ig.game.director.nextLevel(),ig.system.context.globalAlpha=
1,this.kill()))},update:function(){this.parent();this.updateKittyOpening();this.unlockWebAudio()},unlockWebAudio:function(){if(ig.input.released("click"))try{ig.soundHandler.unlockWebAudio()}catch(c){}},draw:function(){this.parent();ig.global.wm||(this.nextLevelTimer&&0>this.nextLevelTimer.delta()&&(ig.system.context.globalAlpha=-this.nextLevelTimer.delta()),this.drawKittyOpening())},updateKittyOpening:function(){if(this.initTimer&&0<this.initTimer.delta()){this.initTimer=null;try{ig.soundHandler.sfxPlayer.play(this.soundKey)}catch(c){console.log(c)}this.kittyTimer=
new ig.Timer(0.15)}this.kittyTimer&&0<this.kittyTimer.delta()&&(7>this.kittyAnim?(this.kittyAnim++,this.kittyTimer.reset()):(this.kittyTimer=null,this.nextLevelTimer=new ig.Timer(2)));this.nextLevelTimer&&0<this.nextLevelTimer.delta()&&(this.nextLevelTimer=null,ig.game.director.nextLevel(),ig.system.context.globalAlpha=1)},drawKittyOpening:function(){var c=ig.system.context.createLinearGradient(0,0,0,ig.system.height);c.addColorStop(0,"#ffed94");c.addColorStop(1,"#ffcd85");ig.system.context.fillStyle=
c;ig.system.context.fillRect(0,0,ig.system.width,ig.system.height);0<=this.kittyAnim&&(this.kittyImage.drawTile((ig.system.width>>>1)-(this.kittyImage.width>>>3),(ig.system.height>>>1)-(this.kittyImage.height>>>2),this.kittyAnim,218,325),this.kittyTitleImage.drawTile((ig.system.width>>>1)-(this.kittyTitleImage.width>>>1),(ig.system.height>>>1)+(this.kittyImage.height>>>2)+10,this.kittyAnim,380,37));ig.system.context.globalAlpha=1}})});ig.baked=!0;
ig.module("game.entities.pointer").requires("impact.entity").defines(function(){EntityPointer=ig.Entity.extend({checkAgainst:ig.Entity.TYPE.BOTH,isFirstPressed:!1,isPressed:!1,isReleased:!1,isHovering:!1,hoveringItem:null,objectArray:[],clickedObjectList:[],ignorePause:!0,zIndex:5E3,name:"pointer",check:function(c){this.objectArray.push(c)},clickObject:function(c){this.isFirstPressed&&"function"==typeof c.clicked&&(c.clicked(),this.addToClickedObjectList(c));this.isPressed&&!this.isReleased&&"function"==
typeof c.clicking&&c.clicking();this.isReleased&&"function"==typeof c.released&&(c.released(),this.removeFromClickedObjectList(c))},refreshPos:function(){this.pos=ig.game.io.getClickPos()},update:function(){this.parent();this.refreshPos();var c=null,b=-1;for(a=this.objectArray.length-1;-1<a;a--)this.objectArray[a].zIndex>b&&(b=this.objectArray[a].zIndex,c=this.objectArray[a]);if(null!=c)null!=this.hoveringItem?this.hoveringItem!=c&&("function"==typeof this.hoveringItem.leave&&this.hoveringItem.leave(),
"function"==typeof c.over&&c.over()):"function"==typeof c.over&&c.over(),this.hoveringItem=this.lastEnt=c,this.clickObject(c),this.objectArray=[];else if(null!=this.hoveringItem&&"function"==typeof this.hoveringItem.leave&&(this.hoveringItem.leave(),this.hoveringItem=null),this.isReleased){for(c=0;c<this.clickedObjectList.length;c++)b=this.clickedObjectList[c],"function"==typeof b.releasedOutside&&b.releasedOutside();this.lastEnt&&(this.lastEnt.released&&this.lastEnt.released(),this.lastEnt=null);
this.clickedObjectList=[]}this.isFirstPressed=ig.input.pressed("click");this.isReleased=ig.input.released("click");this.isPressed=ig.input.state("click")},addToClickedObjectList:function(c){this.clickedObjectList.push(c)},removeFromClickedObjectList:function(c){for(var b=[],e=0;e<this.clickedObjectList.length;e++){var d=this.clickedObjectList[e];d!=c&&b.push(d)}this.clickedObjectList=b}})});ig.baked=!0;
ig.module("game.entities.pointer-selector").requires("game.entities.pointer").defines(function(){EntityPointerSelector=EntityPointer.extend({zIndex:1E3,_wmDrawBox:!0,_wmBoxColor:"rgba(0, 0, 255, 0.7)",size:{x:20,y:20},init:function(c,b,e){this.parent(c,b,e)}})});ig.baked=!0;
ig.module("game.entities.select").requires("impact.entity").defines(function(){EntitySelect=ig.Entity.extend({type:ig.Entity.TYPE.B,checkAgainst:ig.Entity.TYPE.A,collides:ig.Entity.COLLIDES.NEVER,canSelect:!1,canSelectTimerDuration:0.35,zIndex:99999,isHovering:!1,isSelected:!1,init:function(c,b,e){this.parent(c,b,e);this.canSelectTimer=new ig.Timer(this.canSelectTimerDuration)},doesClickableLayerExist:function(c){for(k in dynamicClickableEntityDivs)if(k==c)return!0;return!1},checkClickableLayer:function(c,
b,e){"undefined"==typeof wm&&(this.doesClickableLayerExist(c)?(ig.game.showOverlay([c]),$("#"+c).find("[href]").attr("href",b)):this.createClickableOutboundLayer(c,b,"media/graphics/misc/invisible.png",e))},createClickableOutboundLayer:function(c,b,e,d){var j=ig.$new("div");j.id=c;document.body.appendChild(j);$("#"+j.id).css("float","left");$("#"+j.id).css("width",this.size.x*multiplier);$("#"+j.id).css("height",this.size.y*multiplier);$("#"+j.id).css("position","absolute");var f=w/2-destW/2,p=h/
2-destH/2;w==mobileWidth?($("#"+j.id).css("left",this.pos.x),$("#"+j.id).css("top",this.pos.y)):($("#"+j.id).css("left",f+this.pos.x*multiplier),$("#"+j.id).css("top",p+this.pos.y*multiplier));d?$("#"+j.id).html("<a target='_blank' href='"+b+"'><img style='width:100%;height:100%' src='"+e+"'></a>"):$("#"+j.id).html("<a href='"+b+"'><img style='width:100%;height:100%' src='"+e+"'></a>");dynamicClickableEntityDivs[c]={};dynamicClickableEntityDivs[c].width=$("#"+j.id).width();dynamicClickableEntityDivs[c].height=
$("#"+j.id).height();dynamicClickableEntityDivs[c].entity_pos_x=this.pos.x;dynamicClickableEntityDivs[c].entity_pos_y=this.pos.y},hovered:function(){this.isHovering=!0;this.dehoverOthers()},dehoverOthers:function(){var c=ig.game.getEntitiesByType(EntitySelect);for(i=0;i<c.length;i++)c[i]!=this&&(c[i].isHovering=!1)},deselectOthers:function(){var c=ig.game.getEntitiesByType(EntitySelect);for(i=0;i<c.length;i++)c[i]!=this&&(c[i].isSelected=!1)},update:function(){this.parent();this.canSelectTimer&&0<
this.canSelectTimer.delta()&&(this.canSelect=!0,this.canSelectTimer=null)}})});ig.baked=!0;ig.module("game.levels.opening").requires("impact.image","game.entities.opening-kitty").defines(function(){LevelOpening={entities:[{type:"EntityOpeningKitty",x:520,y:212}],layer:[]}});ig.baked=!0;
ig.module("game.toybox.objects.game-object").requires("impact.entity").defines(function(){EntityGameObject=ig.Entity.extend({gravityFactor:0,idleSheetInfo:null,singleFrameImage:null,visible:!0,alpha:1,zIndex:1E3,drawAsRect:!1,drawAsOutline:!1,outlineWidth:1,rectColor:"#FFFFFF",outlineColor:"#000000",entryDelay:0,entryDuration:0.25,entryType:null,exitDelay:0,exitDuration:0.25,exitType:null,killOnExit:!0,scaleX:1,scaleY:1,angle:0,anchorX:0,anchorY:0,forceDraw:!1,width:32,height:32,onInputDown:null,
onInputUp:null,onClicked:null,hasTouchInside:!1,inputEnabled:!1,isClicking:!1,boundLeft:0,boundRight:0,boundTop:0,boundBottom:0,isFinishEntering:!1,fixedOnCamera:!1,timedLife:-999,size:{x:32,y:32},init:function(c,b,e){this.onInputDown=new ig.Signal;this.onInputUp=new ig.Signal;this.onClicked=new ig.Signal;e.singleFrameImage?this.singleFrameImage=e.singleFrameImage:e.image&&(this.image=this.singleFrameImage=e.image);null!=this.singleFrameImage?(this.idleSheetInfo={sheetImage:this.singleFrameImage,
sheetX:1,sheetY:1},this.setSpriteSheet("idle"),this.setSize("idle"),this.addAnimation("idle","idleSheet",1,[0],!1,!0)):null!=this.idleSheetInfo&&(this.setSpriteSheet("idle"),this.setSize("idle"));this.parent(c,b,e);!1===e.visible&&(this.visible=!1);this.anchorType=e.anchorType?e.anchorType:"default";this.enter()},swapImage:function(c){this.idleSheetInfo.sheetImage=c;this.idleSheet.image=c},onFinishEntering:function(){},enter:function(){this.visible=!0;if(ig.responsive){var c=ig.responsive.toAnchor(this.anchoredPositionX,
this.anchoredPositionY,this.anchorType);this.pos.x=c.x;this.pos.y=c.y}null!=this.entryType?(this[this.entryType](),this.delayedCall(this.entryDelay+this.entryDuration,function(){this.onFinishEntering();this.isFinishEntering=!0}.bind(this))):(this.isFinishEntering=!0,this.onFinishEntering())},exit:function(){if(null!=this.exitType)this[this.exitType]();else this.alpha0();this.delayedCall(this.exitDuration+this.exitDelay,function(){this.checkKill()}.bind(this))},setSpriteSheet:function(c){this[c+"Sheet"]=
new ig.AnimationSheet(this[c+"SheetInfo"].sheetImage.path,this[c+"SheetInfo"].sheetImage.width/this[c+"SheetInfo"].sheetX,this[c+"SheetInfo"].sheetImage.height/this[c+"SheetInfo"].sheetY)},setSize:function(c){this.width=this[c+"SheetInfo"].sheetImage.width/this[c+"SheetInfo"].sheetX;this.height=this[c+"SheetInfo"].sheetImage.height/this[c+"SheetInfo"].sheetY},addAnimation:function(c,b,e,d,j,f){this[c]=new ig.Animation(this[b],e,d,!j);!0==f&&(this.currentAnim=this[c])},makeFramesArray:function(c,b,
e){for(var d=[],j=c;j<=b;j++)d.push(j);if(e)for(j=b;j>=c;j--)d.push(j);return d},draw:function(){if(this.visible&&(this.forceDraw||this.currentAnim||this.drawAsRect||this.drawAsOutline)){var c=ig.system.context;c.save();var b=0,e=0;this.fixedOnCamera?(b=ig.system.getDrawPos(this.pos.x.round()-this.offset.x),e=ig.system.getDrawPos(this.pos.y.round()-this.offset.y)):(b=ig.system.getDrawPos(this.pos.x.round()-this.offset.x-ig.game.screen.x),e=ig.system.getDrawPos(this.pos.y.round()-this.offset.y-ig.game.screen.y));
c.translate(b,e);(1!=this.scaleX||1!=this.scaleY)&&c.scale(this.scaleX,this.scaleY);b=-this.anchorX*this.width;e=-this.anchorY*this.height;0<this.shakeValue&&(this.shakeValue-=ig.system.tick*this.shakeReductionMultiplier,b+=ig.random.float(-this.shakeValue,this.shakeValue),e+=ig.random.float(-this.shakeValue,this.shakeValue));this.drawObject(b,e);c.restore()}},drawObject:function(c,b){var e=ig.system.context,d=ig.hexToRgb(this.rectColor);this.drawAsRect&&(e.fillStyle=1>this.alpha?"rgba("+d.r+","+
d.g+","+d.b+","+this.alpha+")":d.hex,e.fillRect(c,b,this.width,this.height));d=ig.hexToRgb(this.outlineColor);this.drawAsOutline?(e.lineWidth=this.outlineWidth,e.strokeStyle=1>this.alpha?"rgba("+d.r+","+d.g+","+d.b+","+this.alpha+")":d.hex,e.strokeRect(c,b,this.width,this.height)):null!=this.currentAnim&&(this.currentAnim.alpha=this.alpha,this.currentAnim.draw(c,b))},update:function(){ig.game.entities&&this.parent();if(this.inputEnabled&&this.isFinishEntering&&this.visible){var c=!1;this.hasTouchInside=
!1;for(var b=0;b<ig.multitouchInput.touches.length;b++){var c=!0,e=ig.multitouchInput.touches[b];this.processInput(e.x,e.y)}for(b=0;b<ig.ToyboxTouch.touches.length;b++)c=!0,e=ig.ToyboxTouch.touches[b],this.processInput(e.x,e.y);!c&&ig.input.state("click")&&(c=!0,b=ig.game.io.mouse.getPos(),this.processInput(b.x,b.y));c?this.hasTouchInside||(this.isClicking=!1):(this.isClicking&&(this.onInputUp.dispatch(this),this.onClicked.dispatch(this)),this.isClicking=!1)}-999!=this.timedLife&&this.isFinishEntering&&
(this.timedLife-=ig.system.tick,0>=this.timedLife&&(this.timedLife=-999,this.exit()))},processInput:function(c,b){this.isInsideBounds(c,b)&&(this.hasTouchInside=!0,this.isClicking||(this.isClicking=!0,this.onInputDown.dispatch(this)))},isInsideBounds:function(c,b){var e=this.scaleX*this.width,d=this.scaleY*this.height;this.boundLeft=this.pos.x-e*this.anchorX;this.boundTop=this.pos.y-d*this.anchorY;this.boundRight=this.boundLeft+e;this.boundBottom=this.boundTop+d;this.boundLeft>this.boundRight&&(e=
this.boundLeft,this.boundLeft=this.boundRight,this.boundRight=e);this.boundTop>this.boundBottom&&(e=this.boundTop,this.boundTop=this.boundBottom,this.boundBottom=e);return c<this.boundLeft||b<this.boundTop||c>this.boundRight||b>this.boundBottom?!1:!0},getBounds:function(){this._bounds||(this._bounds={});var c=this._bounds,b=this.scaleX*this.width,e=this.scaleY*this.height;c.left=this.pos.x-b*this.anchorX;c.top=this.pos.y-e*this.anchorY;c.right=c.left+b;c.bottom=c.top+e;c.width=Math.abs(b);c.height=
Math.abs(e);c.left>c.right&&(b=c.left,c.left=c.right,c.right=b);c.top>c.bottom&&(b=c.top,c.top=c.bottom,c.bottom=b);c.x=c.left;c.y=c.top;return c},isCollidingWith:function(c){var b=this.getBounds();c=c.getBounds();return b.right<c.left||b.left>c.right||b.bottom<c.top||b.top>c.bottom?!1:!0},shakeValue:0,shakeReductionMultiplier:0,shake:function(c,b){c||(c=5);b||(b=10);this.shakeValue=c;this.shakeReductionMultiplier=b},fadeBounceRightIn:function(){this.alpha=0;var c=this.pos.x;this.pos.x-=100;this.tween({alpha:1},
0.75*this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start();this.tween({pos:{x:c}},this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Back.EaseOut}).start()},fadeBounceRightOut:function(){this.tween({alpha:0},0.75*this.exitDuration,{delay:this.exitDelay+0.25*this.exitDuration,easing:ig.Tween.Easing.Quadratic.EaseOut}).start();this.tween({pos:{x:this.pos.x-100}},this.exitDuration,{delay:this.exitDelay,easing:ig.Tween.Easing.Back.EaseIn}).start()},
fadeBounceLeftIn:function(){this.alpha=0;var c=this.pos.x;this.pos.x+=100;this.tween({alpha:1},0.75*this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start();this.tween({pos:{x:c}},this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Back.EaseOut}).start()},fadeBounceLeftOut:function(){this.tween({alpha:0},0.75*this.exitDuration,{delay:this.exitDelay+0.25*this.exitDuration,easing:ig.Tween.Easing.Quadratic.EaseOut}).start();this.tween({pos:{x:this.pos.x+
100}},this.exitDuration,{delay:this.exitDelay,easing:ig.Tween.Easing.Back.EaseIn}).start()},fadeJumpIn:function(){this.alpha=0;var c=this.pos.y;this.pos.y+=100;this.tween({alpha:1},0.75*this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start();this.tween({pos:{y:c}},this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Back.EaseOut}).start()},fadeJumpOut:function(){this.tween({alpha:0},0.75*this.exitDuration,{delay:this.exitDelay+0.25*this.exitDuration,
easing:ig.Tween.Easing.Quadratic.EaseOut}).start();this.tween({pos:{y:this.pos.y+100}},this.exitDuration,{delay:this.exitDelay,easing:ig.Tween.Easing.Back.EaseIn}).start()},fadeIn:function(){var c=this.alpha;this.alpha=0;this.tween({alpha:c},this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start()},fadeInLinear:function(){var c=this.alpha;this.alpha=0;this.tween({alpha:c},this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Linear.EaseNone}).start()},
fadeOut:function(){this.tween({alpha:0},this.exitDuration,{delay:this.exitDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start()},fadeOutLinear:function(){this.tween({alpha:0},this.exitDuration,{delay:this.exitDelay,easing:ig.Tween.Easing.Linear.EaseNone}).start()},expandIn:function(){this.alpha=0;this.tween({alpha:1},this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start()},expandOut:function(){this.tween({alpha:0},this.exitDuration,{delay:this.exitDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start()},
dropBoinkIn:function(){this.alpha=0;var c=this.pos.y,b=1.2*this.scaleX,e=0.8*this.scaleY,d=this.scaleX,j=this.scaleY;this.pos.y-=0<this.height?3*this.height:3*this.size.y;b=this.tween({scaleX:b,scaleY:e},0.2*this.entryDuration,{delay:this.entryDelay+0.6*this.entryDuration,easing:ig.Tween.Easing.Quadratic.EaseOut});d=this.tween({scaleX:d,scaleY:j},0.2*this.entryDuration,{easing:ig.Tween.Easing.Quadratic.EaseIn});b.chain(d);b.start();this.tween({alpha:1},0.6*this.entryDuration,{delay:this.entryDelay,
easing:ig.Tween.Easing.Quadratic.EaseIn}).start();this.tween({pos:{y:c}},0.6*this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Quartic.EaseIn}).start()},alpha0:function(){this.alpha=0},alpha1:function(){this.alpha=1},checkKill:function(){this.killOnExit&&this.kill()}})});ig.baked=!0;
ig.module("game.toybox.objects.ui.buttons.simple-button").requires("game.toybox.objects.game-object").defines(function(){EntitySimpleButton=EntityGameObject.extend({originalX:0,originalY:0,transitionInDelay:0,zIndex:7E3,text:"",font:"48px Arial",textColor:"#FFFFFF",align:"center",offsetX:0,offsetY:0,anchorX:0.5,anchorY:0.5,lineSpacing:1,valign:"center",enableShadow:!1,shadowColor:"#000000",shadowOffsetX:0,shadowOffsetY:4,shadowAlpha:0.4,outlineWeight:0,outlineColor:"#000000",outlineCap:"square",outlineJoin:"bevel",
normalScale:1,usePressedTween:!0,textRenderer:null,forceDraw:!0,init:function(c,b,e){this.parent(c,b,e);this.textRenderer=new ig.TextRenderer;if(e.textString)throw Error("old text field detected");},update:function(){this.parent();if(this.usePressedTween&&this.visible){var c=0.9*this.normalScale,b=0.9*this.normalScale,c=0.9*this.normalScale,c=this.hasTouchInside?0.9*this.normalScale:this.normalScale,b=0>this.scaleX?-1*c:c,c=0>this.scaleY?-1*c:c;this.scaleX+=(b-this.scaleX)/3;this.scaleY+=(c-this.scaleY)/
3}},drawObject:function(c,b){this.parent(c,b);this.visible&&(this.textRenderer.text=this.text,this.textRenderer.font=this.font,this.textRenderer.color=this.textColor,this.textRenderer.alpha=this.alpha,this.textRenderer.align=this.align,this.textRenderer.offsetX=this.offsetX,this.textRenderer.offsetY=this.offsetY,this.textRenderer.lineSpacing=this.lineSpacing,this.textRenderer.valign=this.valign,this.textRenderer.enableShadow=this.enableShadow,this.textRenderer.shadowAlpha=this.shadowAlpha,this.textRenderer.shadowColor=
this.shadowColor,this.textRenderer.shadowOffsetX=this.shadowOffsetX,this.textRenderer.shadowOffsetY=this.shadowOffsetY,this.textRenderer.outlineWeight=this.outlineWeight,this.textRenderer.outlineColor=this.outlineColor,this.textRenderer.outlineCap=this.outlineCap,this.textRenderer.outlineJoin=this.outlineJoin,this.textRenderer.draw(c+this.width/2,b+this.height/2))},onFinishEntering:function(){this.inputEnabled=!0}})});ig.baked=!0;
ig.module("game.toybox.objects.ui.fade-black").requires("game.toybox.objects.game-object").defines(function(){ig.hasFadeBlack=!1;EntityFadeBlack=EntityGameObject.extend({zIndex:99999,isIn:!1,nextLevelID:-1,rectColor:"#000000",init:function(c,b,e){this.parent(c,b,e);this.size.x=ig.system.width;this.size.y=ig.system.height;ig.game.sortEntitiesDeferred()},enter:function(){this.visible=!0;this.isIn?(this.alpha=0,this.tween({alpha:1},0.35,{easing:ig.Tween.Easing.Quadratic.EaseIn,onComplete:function(){0<=
this.nextLevelID&&ig.game.director.loadLevel(this.nextLevelID)}.bind(this)}).start()):(this.alpha=1,this.tween({alpha:0},0.35,{easing:ig.Tween.Easing.Quadratic.EaseOut,onComplete:function(){this.kill()}.bind(this)}).start())},drawObject:function(c,b){if(this.visible){var e=ig.system.context;e.save();var d=this.rectColor;e.fillStyle=1>this.alpha?"rgba("+d.r+","+d.g+","+d.b+","+this.alpha+")":d.hex;e.fillRect(this.pos.x,this.pos.y,this.size.x,this.size.y);e.restore()}this.parent(c,b)}});ig.dropCurtain=
function(c){void 0===c&&(c=-1);ig.hasFadeBlack=!0;ig.game.spawnEntity(EntityFadeBlack,0,0,{isIn:!0,nextLevelID:c})};ig.liftCurtain=function(){ig.hasFadeBlack=!1;ig.game.spawnEntity(EntityFadeBlack,0,0,{isIn:!1})}});ig.baked=!0;
ig.module("game.toybox.controllers.controller").requires("impact.entity","game.entities.pointer","game.toybox.objects.ui.fade-black").defines(function(){EntityController=ig.Entity.extend({gravityFactor:0,isAllowInput:!0,pointer:null,liftCurtainOnStart:!0,onInputDown:null,onInputUp:null,lastTouchY:0,lastTouchX:0,size:{x:960,y:540},init:function(c,b,e){this.parent(c,b,e);this.pointer=ig.game.getEntitiesByType(EntityPointer)[0];this.onInputDown=new ig.Signal;this.onInputUp=new ig.Signal;this.liftCurtainOnStart&&
ig.liftCurtain()},goToLevel:function(c){this.isAllowInput=!1;ig.dropCurtain(c)},showPopup:function(c,b){b||(b={});b.controller=this;this.isAllowInput=!1;ig.game.spawnEntity(c,0,0,b);ig.game.sortEntitiesDeferred()},onPopupFinished:function(){this.isAllowInput=!0},update:function(){this.parent();for(var c=!1,b=0;b<ig.multitouchInput.touches.length;b++){var c=!0,e=ig.multitouchInput.touches[b];this.processInput(e.x,e.y)}!c&&ig.input.state("click")&&(c=!0,b=ig.game.io.mouse.getPos(),this.processInput(b.x,
b.y));c||(this.isClicking&&this.onInputUp.dispatch(this),this.isClicking=!1)},processInput:function(c,b){this.currentTouchX=c;this.currentTouchY=b;this.isInsideBounds(c,b)&&!this.isClicking&&(this.isClicking=!0,this.lastTouchX=c,this.lastTouchY=b,this.onInputDown.dispatch(this))},isInsideBounds:function(c,b){var e=this.scaleX*this.width,d=this.scaleY*this.height;this.boundLeft=this.pos.x-e*this.anchorX;this.boundTop=this.pos.y-d*this.anchorY;this.boundRight=this.boundLeft+e;this.boundBottom=this.boundTop+
d;this.boundLeft>this.boundRight&&(e=this.boundLeft,this.boundLeft=this.boundRight,this.boundRight=e);this.boundTop>this.boundBottom&&(e=this.boundTop,this.boundTop=this.boundBottom,this.boundBottom=e);return c<this.boundLeft||b<this.boundTop||c>this.boundRight||b>this.boundBottom?!1:!0}})});ig.baked=!0;
ig.module("game.entities.controllers.main-menu-controller").requires("impact.entity","game.toybox.objects.ui.buttons.simple-button","game.toybox.controllers.controller").defines(function(){EntityMainMenuController=EntityController.extend({titleImage:new ig.Image("media/graphics/game/title.png"),playBtnImage:new ig.Image("media/graphics/game/play-btn.png"),settingsBtnImage:new ig.Image("media/graphics/game/settings-btn.png"),moreGamesBtnImage:new ig.Image("media/graphics/game/more-games-btn.png"),
bgAlpha:0,init:function(c,b,e){this.parent(c,b,e);ig.game.spawnEntity(EntityGameObject,270,250,{image:this.titleImage,entryType:"fadeIn",exitType:"fadeOut",anchorX:0.5,anchorY:0.5});c=ig.game.spawnEntity(EntitySimpleButton,270,650,{image:this.playBtnImage,entryType:"fadeIn",exitType:"fadeOut"});c.onClicked.add(this.onClickPlay,this);b=ig.game.spawnEntity(EntitySimpleButton,410,650,{image:this.settingsBtnImage,entryType:"fadeIn",exitType:"fadeOut"});b.onClicked.add(this.onClickSettings,this);_SETTINGS.MoreGames.Enabled?
(b=ig.game.spawnEntity(EntitySimpleButton,130,650,{image:this.moreGamesBtnImage,entryType:"fadeIn",exitType:"fadeOut"}),b.size.x=this.moreGamesBtnImage.width,b.size.y=this.moreGamesBtnImage.height,this.moreGamesButton=b,_SETTINGS.MoreGames.Link&&(b.link=_SETTINGS.MoreGames.Link),_SETTINGS.MoreGames.NewWindow&&(b.newWindow=_SETTINGS.MoreGames.NewWindow),c.normalScale=1.2,this.clickableLayer=new ClickableDivLayer(b)):(c.normalScale=1.3,b.anchoredPositionX=270,b.anchoredPositionY=800);this.fullscreenbtn=
ig.game.spawnEntity(ig.FullscreenButton,-82,20,{enterImage:new ig.Image("media/graphics/game/button-maximize.png"),exitImage:new ig.Image("media/graphics/game/button-minimize.png")});this.fullscreenbtn.anchorType="right-top";ig.game.backFromSettings?(ig.game.backFromSettings=!1,this.bgAlpha=0):(ig.babylonSceneController.update(0),this.bgAlpha=1.5);ig.babylonSceneController.paused=!0},onClickSettings:function(){ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);ig.game.goToLevel("MainMenuSettings")},
onClickPlay:function(){ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);ig.game.sessionData.hasShownTutorial?ig.game.goToLevel("Gameplay"):(ig.game.sessionData.hasShownTutorial=!0,ig.game.saveAll(),ig.game.goToLevel("Tutorial"))},update:function(){this.parent();if(this.clickableLayer){var c=this.moreGamesButton;this.clickableLayer.update(c.pos.x-c.width/2,c.pos.y-c.height/2,c.width,c.height)}},draw:function(){this.parent();var c=ig.system.context;c.clearRect(0,0,ig.system.width,
ig.system.height);0<this.bgAlpha&&(this.bgAlpha-=2*ig.system.tick,0.05>this.bgAlpha&&(this.bgAlpha=0),c.save(),c.globalAlpha=1<this.bgAlpha?1:this.bgAlpha,c.fillStyle="#f8c85c",c.fillRect(0,0,ig.system.width,ig.system.height),c.restore(),c.globalAlpha=1)}})});ig.baked=!0;ig.module("game.levels.main-menu").requires("impact.image","game.entities.controllers.main-menu-controller").defines(function(){LevelMainMenu={entities:[{type:"EntityMainMenuController",x:0,y:0}],layer:[]}});ig.baked=!0;
ig.module("game.toybox.objects.ui.popups.popup").requires("game.toybox.objects.game-object").defines(function(){EntityPopup=EntityGameObject.extend({gravityFactor:0,zIndex:1E4,controller:null,members:[],entryType:"fadeIn",exitType:"fadeOut",exitDelay:0.5,isAllowInput:!1,memberZIndex:10001,init:function(c,b,e){this.parent(c,b,e)},spawnMember:function(c,b,e,d,j){j&&(d.zIndex=j);c=ig.game.spawnEntity(c,b,e,d);!j&&c.zIndex<this.zIndex&&(c.zIndex=this.memberZIndex++);this.members.push(c);this.fixedOnCamera&&
(c.fixedOnCamera=!0);return c},enter:function(){this.parent();this.delayedCall(this.entryDelay+this.entryDuration,function(){this.isAllowInput=!0}.bind(this))},exit:function(){this.parent();this.isAllowInput=!1;this.callControllerCallback();for(var c=0;c<this.members.length;c++)this.members[c].exit()},callControllerCallback:function(){if(this.controller&&this.controller.onPopupFinished){var c=this.exitDelay+this.exitDuration-0.1;if(0>=c)this.controller.onPopupFinished(this.name);else this.delayedCall(c,
function(){this.controller.onPopupFinished(this.name)}.bind(this))}}})});ig.baked=!0;
ig.module("game.toybox.objects.ui.texts.text-field").requires("game.toybox.objects.game-object").defines(function(){EntityTextField=EntityGameObject.extend({text:"",font:"48px Arial",color:"#FFFFFF",align:"start",offsetX:0,offsetY:0,lineSpacing:1,valign:"top",textRenderer:null,forceDraw:!0,enableShadow:!1,shadowColor:"#000000",shadowOffsetX:0,shadowOffsetY:4,shadowAlpha:0.4,outlineWeight:0,outlineColor:"#000000",outlineCap:"square",outlineJoin:"bevel",zIndex:7E3,init:function(c,b,e){this.parent(c,
b,e);this.textRenderer=new ig.TextRenderer},drawObject:function(c,b){this.parent(c,b);this.visible&&(this.applyProperties(),this.textRenderer.draw(c,b))},applyProperties:function(){this.textRenderer.text=this.text;this.textRenderer.font=this.font;this.textRenderer.color=this.color;this.textRenderer.alpha=this.alpha;this.textRenderer.align=this.align;this.textRenderer.offsetX=this.offsetX;this.textRenderer.offsetY=this.offsetY;this.textRenderer.lineSpacing=this.lineSpacing;this.textRenderer.valign=
this.valign;this.textRenderer.enableShadow=this.enableShadow;this.textRenderer.shadowAlpha=this.shadowAlpha;this.textRenderer.shadowColor=this.shadowColor;this.textRenderer.shadowOffsetX=this.shadowOffsetX;this.textRenderer.shadowOffsetY=this.shadowOffsetY;this.textRenderer.outlineWeight=this.outlineWeight;this.textRenderer.outlineColor=this.outlineColor;this.textRenderer.outlineCap=this.outlineCap;this.textRenderer.outlineJoin=this.outlineJoin},getTextWidth:function(){this.applyProperties();return this.textRenderer.measureTextWidth()}})});
ig.baked=!0;
ig.module("game.entities.popups.settings-popup").requires("game.toybox.objects.ui.popups.popup","game.toybox.objects.ui.buttons.simple-button","game.toybox.objects.ui.texts.text-field").defines(function(){EntitySettingsPopup=EntityPopup.extend({bgImg:new ig.Image("media/graphics/game/blank.png"),homeBtnImg:new ig.Image("media/graphics/game/home-btn.png"),sfxOnIconImg:new ig.Image("media/graphics/game/sfx-icon-on.png"),sfxOffIconImg:new ig.Image("media/graphics/game/sfx-icon-off.png"),bgmOnIconImg:new ig.Image("media/graphics/game/bgm-icon-on.png"),
bgmOffIconImg:new ig.Image("media/graphics/game/bgm-icon-off.png"),toggleOffImg:new ig.Image("media/graphics/game/button-off.png"),toggleOnImg:new ig.Image("media/graphics/game/button-on.png"),homeButton:null,bgmButton:null,sfxButton:null,title:null,exitDelay:0,exitDuration:0.25,init:function(c,b,e){this.parent(c,b,e);b=this.spawnMember(EntityGameObject,270,480,{image:this.bgImg,anchorX:0.5,anchorY:0.5,entryType:"fadeIn",exitType:"fadeOut",zIndex:0});c=b.anchoredPositionX;b=b.anchoredPositionY;this.title=
this.spawnMember(EntityTextField,c+15,b-70,{zIndex:7E3,anchorX:0.5,anchorY:0.5,text:_STRINGS.Game.Settings,font:"64px titlefont",align:"center",color:"#ffffff",entryType:"fadeIn",exitType:"fadeOut"});this.homeButton=this.spawnMember(EntitySimpleButton,c,b+150,{image:this.homeBtnImg,entryType:"fadeIn",exitType:"fadeOut"});this.homeButton.onClicked.addOnce(this.onClickHome,this);this.bgmButton=this.spawnMember(EntitySimpleButton,c-80,b,{image:this.toggleOnImg,text:"",font:"48px sans-serif",align:"center",
color:"#ffffff",offsetY:-5,entryType:"fadeIn",exitType:"fadeOut"});this.bgmButton.onClicked.add(this.onValueToggleBgm,this);this.sfxButton=this.spawnMember(EntitySimpleButton,c+80,b,{image:this.toggleOnImg,text:"",font:"48px sans-serif",align:"center",color:"#ffffff",offsetY:-5,entryType:"fadeIn",exitType:"fadeOut"});this.sfxButton.onClicked.add(this.onValueToggleSfx,this);this.bgmIcon=this.spawnMember(EntityGameObject,this.bgmButton.anchoredPositionX,this.bgmButton.anchoredPositionY,{image:this.bgmOnIconImg,
anchorX:0.5,anchorY:0.5,entryType:"fadeIn",exitType:"fadeOut"});this.sfxIcon=this.spawnMember(EntityGameObject,this.sfxButton.anchoredPositionX,this.sfxButton.anchoredPositionY,{image:this.sfxOnIconImg,anchorX:0.5,anchorY:0.5,entryType:"fadeIn",exitType:"fadeOut"});ig.game.sortEntitiesDeferred();this.refreshToggleButton()},refreshToggleButton:function(){0<ig.game.sessionData.music?(this.bgmButton.swapImage(this.toggleOnImg),this.bgmIcon.swapImage(this.bgmOnIconImg)):(this.bgmButton.swapImage(this.toggleOffImg),
this.bgmIcon.swapImage(this.bgmOffIconImg));0<ig.game.sessionData.sound?(this.sfxButton.swapImage(this.toggleOnImg),this.sfxIcon.swapImage(this.sfxOnIconImg)):(this.sfxButton.swapImage(this.toggleOffImg),this.sfxIcon.swapImage(this.sfxOffIconImg))},onValueToggleSfx:function(){ig.game.sessionData.sound=0<ig.game.sessionData.sound?0:ig.game.sfxDefaultVolume;ig.game.saveAll();ig.soundHandler.sfxPlayer.volume(ig.game.sessionData.sound);ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);
this.refreshToggleButton()},onValueToggleBgm:function(){ig.game.sessionData.music=0<ig.game.sessionData.music?0:ig.game.bgmDefaultVolume;ig.game.saveAll();ig.soundHandler.bgmPlayer.volume(ig.game.sessionData.music);ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);this.refreshToggleButton()},onClickHome:function(){this.isAllowInput&&(this.isAllowInput=!1,this.exit(),ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click))}})});ig.baked=!0;
ig.module("game.entities.controllers.main-menu-settings-controller").requires("impact.entity","game.toybox.controllers.controller","game.toybox.objects.game-object","game.toybox.objects.ui.buttons.simple-button","game.entities.popups.settings-popup").defines(function(){EntityMainMenuSettingsController=EntityController.extend({init:function(c,b,e){this.parent(c,b,e);this.delayedCall(0.1,function(){this.showPopup(EntitySettingsPopup)}.bind(this))},onPopupFinished:function(c){this.parent(c);this.isAllowInput&&
(this.isAllowInput=!1,setTimeout(function(){ig.game.backFromSettings=!0;ig.game.goToLevel("MainMenu")}.bind(this),100))},update:function(){this.parent()},draw:function(){this.parent();ig.system.context.clearRect(0,0,ig.system.width,ig.system.height)}})});ig.baked=!0;ig.module("game.levels.main-menu-settings").requires("impact.image","game.entities.controllers.main-menu-settings-controller").defines(function(){LevelMainMenuSettings={entities:[{type:"EntityMainMenuSettingsController",x:0,y:0}],layer:[]}});
ig.baked=!0;
ig.module("game.entities.controllers.game-over-controller").requires("impact.entity","game.toybox.objects.ui.buttons.simple-button","game.toybox.controllers.controller").defines(function(){EntityGameOverController=EntityController.extend({playBtnImage:new ig.Image("media/graphics/game/play-btn.png"),homeBtnImage:new ig.Image("media/graphics/game/home-btn.png"),scoreBgImage:new ig.Image("media/graphics/game/score-bg.png"),bestBgImage:new ig.Image("media/graphics/game/best-bg.png"),init:function(c,b,
e){this.parent(c,b,e);ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.gameover);ig.game.spawnEntity(EntityTextField,270,250,{font:"72px titlefont",text:_STRINGS.Game.GameOver,align:"center",entryType:"fadeIn",exitType:"fadeOut"});c=Math.round(ig.gameScene3D.player.score);c>ig.game.sessionData.score&&(ig.game.sessionData.score=c,ig.game.saveAll());b=ig.game.spawnEntity(EntityGameObject,270,350,{anchorX:0.5,anchorY:0.5,image:this.scoreBgImage,entryType:"fadeIn",exitType:"fadeOut"});
e=ig.game.spawnEntity(EntityGameObject,270,470,{anchorX:0.5,anchorY:0.5,image:this.bestBgImage,entryType:"fadeIn",exitType:"fadeOut"});ig.game.spawnEntity(EntityTextField,100,b.anchoredPositionY+13,{font:"40px mainfont",text:_STRINGS.Game.Score,align:"left",entryType:"fadeIn",exitType:"fadeOut",color:"#ed0049"});ig.game.spawnEntity(EntityTextField,100,e.anchoredPositionY+13,{font:"40px mainfont",text:_STRINGS.Game.Best,align:"left",entryType:"fadeIn",exitType:"fadeOut"});ig.game.spawnEntity(EntityTextField,
440,b.anchoredPositionY+22,{font:"64px mainfont",text:""+c,align:"right",entryType:"fadeIn",exitType:"fadeOut",color:"#ed0049"});ig.game.spawnEntity(EntityTextField,440,e.anchoredPositionY+22,{font:"64px mainfont",text:""+ig.game.sessionData.score,align:"right",entryType:"fadeIn",exitType:"fadeOut"});ig.game.spawnEntity(EntitySimpleButton,340,600,{image:this.playBtnImage,entryType:"fadeIn",exitType:"fadeOut"}).onClicked.add(this.onClickPlay,this);ig.game.spawnEntity(EntitySimpleButton,200,600,{image:this.homeBtnImage,
entryType:"fadeIn",exitType:"fadeOut"}).onClicked.add(this.onClickHome,this);this.isAllowInput=!0;ig.gameScene3D.reset()},onClickPlay:function(){ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);ig.game.goToLevel("Gameplay")},onClickHome:function(){ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);ig.game.goToLevel("MainMenu")},update:function(){this.parent();ig.input.state("jump")&&this.isAllowInput&&(this.isAllowInput=!1,this.onClickPlay())},draw:function(){this.parent();
var c=ig.system.context;c.save();c.fillStyle="#f8c85c";c.fillRect(0,0,ig.system.width,ig.system.height);c.restore()}})});ig.baked=!0;ig.module("game.levels.game-over").requires("impact.image","game.entities.controllers.game-over-controller").defines(function(){LevelGameOver={entities:[{type:"EntityGameOverController",x:0,y:0}],layer:[]}});ig.baked=!0;
ig.module("game.entities.popups.pause-popup").requires("game.entities.popups.settings-popup").defines(function(){EntityPausePopup=EntitySettingsPopup.extend({resumeBtnImg:new ig.Image("media/graphics/game/small-play-btn.png"),replayBtnImg:new ig.Image("media/graphics/game/replay-btn.png"),showCover:!1,init:function(c,b,e){this.parent(c,b,e);this.resumeButton=this.spawnMember(EntitySimpleButton,270,this.homeButton.anchoredPositionY,{usePressedTween:!0,image:this.resumeBtnImg,anchorX:0.5,anchorY:0.5,
entryType:"fadeIn",exitType:"fadeOut",entryDuration:0.25,exitDuration:0.25});this.resumeButton.onClicked.addOnce(this.onClickResume,this);this.replayButton=this.spawnMember(EntitySimpleButton,390,this.homeButton.anchoredPositionY,{usePressedTween:!0,image:this.replayBtnImg,anchorX:0.5,anchorY:0.5,entryType:"fadeIn",exitType:"fadeOut",entryDuration:0.25,exitDuration:0.25});this.replayButton.onClicked.addOnce(this.onClickReplay,this);this.homeButton.anchoredPositionX=150;this.title.text=_STRINGS.Game.Paused;
ig.game.sortEntitiesDeferred()},update:function(){this.parent()},draw:function(){this.parent();if(this.showCover){var c=ig.system.context;c.save();c.fillStyle="#f8c85c";c.fillRect(0,0,ig.system.width,ig.system.height);c.restore()}},onClickHome:function(){if(this.isAllowInput){this.showCover=!0;ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);this.isAllowInput=!1;ig.gameScene3D.reset();ig.gameScene3D.paused=!0;ig.gameScene3D.player.mesh.isVisible=!1;this.delayedCall(0.1,function(){ig.game.goToLevel("MainMenu")}.bind(this));
for(var c=0;c<this.members.length;c++)this.members[c].exit()}},onClickResume:function(){this.isAllowInput&&(this.isAllowInput=!1,this.exit(),ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click))},onClickReplay:function(){if(this.isAllowInput){this.showCover=!0;ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);this.isAllowInput=!1;ig.gameScene3D.reset();ig.gameScene3D.paused=!0;ig.gameScene3D.player.mesh.isVisible=!1;this.delayedCall(0.1,function(){ig.game.goToLevel("Gameplay")}.bind(this));
for(var c=0;c<this.members.length;c++)this.members[c].exit()}}})});ig.baked=!0;
ig.module("game.entities.controllers.gameplay-controller").requires("impact.entity","game.entities.popups.pause-popup","game.toybox.objects.ui.buttons.simple-button","game.toybox.controllers.controller").defines(function(){EntityGameplayController=EntityController.extend({pauseImage:new ig.Image("media/graphics/game/pause-btn.png"),targetImage:new ig.Image("media/graphics/game/target.png"),gameOverDelay:2,allowShooting:!0,isAiming:!1,aimCenterX:0,aimCenterY:0,aimControlX:0,aimControlY:0,aimMinimumSpeed:150,
crosshairX:0,crosshairY:0,crosshairAreaRadius:500,crosshairSpeedMultiplier:5,cameraPositionRatio:0.02,showAimController:!1,init:function(c,b,e){this.parent(c,b,e);this.scoreTf=ig.game.spawnEntity(EntityTextField,0,100,{font:"72px mainfont",text:"0",align:"center",entryType:"fadeIn",exitType:"fadeOut",anchorType:"top"});this.pauseButton=ig.game.spawnEntity(EntitySimpleButton,-50,45,{anchorX:1,anchorY:0,anchorType:"top-right",image:this.pauseImage,entryType:"fadeIn",exitType:"fadeOut",anchorX:0.5,anchorY:0.5,
entryDelay:1.5});this.pauseButton.onClicked.add(this.onClickPause,this);this.scoreTf.visible=!1;this.pauseButton.visible=!1;ig.babylonSceneController.paused=!1;this.allowShooting=!0;this.isAiming=!1;ig.babylonSceneController.arrow.onLanded.add(this.onArrowLanded,this)},onArrowLanded:function(){ig.meshManager.crosshairPoint.position.x=ig.meshManager.target.position.x;ig.meshManager.crosshairPoint.position.y=ig.meshManager.target.position.y;this.delayedCall(1,function(){this.allowShooting=!0;this.isAiming=
!1;ig.babylonSceneController.arrow.resetNextFrame=!0}.bind(this))},onClickPause:function(){this.isAllowInput&&(this.showPopup(EntityPausePopup),ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click),this.isAllowInput=!1,ig.babylonSceneController.paused=!0,this.pauseButton.usePressedTween=!1,console.log("pause"))},onPopupFinished:function(c){this.parent(c);this.isAllowInput=!1;this.delayedCall(0.25,function(){this.isAllowInput=!0;ig.babylonSceneController.paused=!1;this.pauseButton.usePressedTween=
!0;console.log("resume")}.bind(this))},update:function(){this.parent();this.updateInput()},updateInput:function(){if(!ig.babylonSceneController.paused){for(var c=!1,b=0,e=0,d=0;d<ig.ToyboxTouch.touches.length;d++){var j=ig.ToyboxTouch.touches[d];100<j.y&&(c=!0,b=j.x,e=j.y)}!c&&(ig.input.state("click")&&100<ig.game.io.mouse.getPos().y)&&(c=!0,b=ig.game.io.mouse.getPos().x,e=ig.game.io.mouse.getPos().y);this.allowShooting&&(c?(ig.cameraControl.targetFov=ig.cameraControl.fovAim,this.isAiming||(this.aimCenterX=
b+ig.random.int(-50,50),this.aimCenterY=e+ig.random.int(-50,50),this.crosshairX=2*ig.random.int(-this.crosshairAreaRadius,this.crosshairAreaRadius),this.crosshairY=2*ig.random.int(-this.crosshairAreaRadius,this.crosshairAreaRadius)),this.isAiming=!0,this.aimControlX=b,this.aimControlY=e,e=ig.system.tick,c=(this.aimControlX-this.aimCenterX)*e*this.crosshairSpeedMultiplier,b=(this.aimCenterY-this.aimControlY)*e*this.crosshairSpeedMultiplier,e*=this.aimMinimumSpeed,c*c+b*b<e*e&&(b=ig.utils.normalize2(c,
b,e),c=b.x,b=b.y),this.crosshairX+=c,this.crosshairY+=b,this.crosshairX<-this.crosshairAreaRadius&&(this.crosshairX=-this.crosshairAreaRadius),this.crosshairX>this.crosshairAreaRadius&&(this.crosshairX=this.crosshairAreaRadius),this.crosshairY<-this.crosshairAreaRadius&&(this.crosshairY=-this.crosshairAreaRadius),this.crosshairY>this.crosshairAreaRadius&&(this.crosshairY=this.crosshairAreaRadius),ig.meshManager.crosshairPoint.position.x=ig.meshManager.target.position.x+this.crosshairX*this.cameraPositionRatio,
ig.meshManager.crosshairPoint.position.y=ig.meshManager.target.position.y+this.crosshairY*this.cameraPositionRatio):(ig.cameraControl.targetFov=ig.cameraControl.fovRelaxing,this.isAiming&&(this.allowShooting=this.isAiming=!1,ig.babylonSceneController.arrow.launchNextFrame=!0)));ig.babylonSceneController.arrow.isAiming=this.isAiming}},draw:function(){this.parent();var c=ig.system.context;c.clearRect(0,0,ig.system.width,ig.system.height);c.save();this.isAiming&&(c.save(),c.translate(ig.system.width/
2,ig.system.height/2),c.fillStyle="#000000",c.beginPath(),c.arc(0,0,2,0,2*Math.PI),c.fill(),c.strokeStyle="#000000",c.lineWidth=2,c.beginPath(),c.moveTo(-20,0),c.lineTo(-5,0),c.stroke(),c.beginPath(),c.moveTo(20,0),c.lineTo(5,0),c.stroke(),c.beginPath(),c.moveTo(0,-20),c.lineTo(0,-5),c.stroke(),c.beginPath(),c.moveTo(0,20),c.lineTo(0,5),c.stroke(),c.restore(),this.showAimController&&(c.fillStyle="#000000",c.strokeStyle="#000000",c.lineWidth=2,c.beginPath(),c.arc(this.aimCenterX,this.aimCenterY,10,
0,2*Math.PI),c.fill(),c.beginPath(),c.arc(this.aimCenterX,this.aimCenterY,50,0,2*Math.PI),c.stroke(),c.beginPath(),c.arc(this.aimControlX,this.aimControlY,5,0,2*Math.PI),c.fill(),c.beginPath(),c.moveTo(this.aimCenterX,this.aimCenterY),c.lineTo(this.aimControlX,this.aimControlY),c.stroke()));c.restore()}})});ig.baked=!0;
ig.module("game.levels.gameplay").requires("impact.image","game.entities.controllers.gameplay-controller").defines(function(){LevelGameplay={entities:[{type:"EntityGameplayController",x:0,y:0}],layer:[]}});ig.baked=!0;
ig.module("game.entities.controllers.tutorial-controller").requires("impact.entity","game.toybox.objects.ui.buttons.simple-button","game.toybox.controllers.controller").defines(function(){EntityTutorialController=EntityController.extend({init:function(c,b,e){this.parent(c,b,e);for(c=0;4>c;c++)b=ig.game.spawnEntity(EntityTextField,270,250+60*c,{font:"38px mainfont",text:"",align:"center",entryType:"fadeIn",exitType:"fadeOut",enableShadow:!0,shadowColor:"#f36d61"}),b.text=ig.ua.mobile?_STRINGS.Game.TutorialMobile[c]:
_STRINGS.Game.TutorialDesktop[c],3==c&&(b.anchoredPositionY=650);this.isAllowInput=!0;ig.gameScene3D.paused=!0;ig.gameScene3D.player.mesh.isVisible=!1},update:function(){this.parent();ig.ua.mobile?this.isClicking&&this.isAllowInput&&(this.isAllowInput=!1,this.onClickPlay()):ig.input.state("jump")&&this.isAllowInput&&(this.isAllowInput=!1,this.onClickPlay())},onClickPlay:function(){ig.game.goToLevel("Gameplay")},timer:1,draw:function(){this.parent();var c=ig.system.context;c.clearRect(0,0,ig.system.width,
ig.system.height);ig.ua.mobile&&(this.timer-=ig.system.tick/2,0>this.timer&&(this.timer=1),c.save(),c.fillStyle="rgba(255,255,255,0.2)",0.5>this.timer?c.fillRect(0,0,ig.system.width/2,ig.system.height):c.fillRect(ig.system.width/2,0,ig.system.width/2,ig.system.height),c.restore())}})});ig.baked=!0;ig.module("game.levels.tutorial").requires("impact.image","game.entities.controllers.tutorial-controller").defines(function(){LevelTutorial={entities:[{type:"EntityTutorialController",x:0,y:0}],layer:[]}});
ig.baked=!0;
ig.module("game.scene3d.utils.camera-control").defines(function(){ig.cameraControl={camera:null,targetMesh:null,zero:null,light:null,tempVec1:null,tempVec2:null,tempVec3:null,targetRelativePosition:null,isFrozen:!1,targetFov:1.6,fovAim:0.5,fovRelaxing:0.9,init:function(){var c=ig.altBabylon.scene;c.clearColor.set(248/255,200/255,92/255,1);this.light=c.getLightByName("Light");this.light.intensity=1;this.light.diffuse=new BABYLON.Color3(0.5,0.5,0.5);this.camera=c.getCameraByName("Camera");this.zero=
new BABYLON.Vector3(0,0,0);this.targetRelativePosition=new BABYLON.Vector3(0,0,-10);this.camera.minZ=0;this.camera.maxZ=2E3;this.camera.fov=0.8;this.zero=new BABYLON.Vector3(0,0,0);this.tempVec1=new BABYLON.Vector3(0,0,0);this.tempVec2=new BABYLON.Vector3(0,0,0);this.tempVec3=new BABYLON.Vector3(0,0,0);this.pointCameraToVec3(new BABYLON.Vector3(0,20,0),0,!0)},turnSpeed:0,turnAcc:10,update:function(){this.targetMesh&&this.pointCameraToTarget();this.camera.fov!=this.targetFov&&(this.camera.fov+=(this.targetFov-
this.camera.fov)/10,0.03>Math.abs(this.camera.fov-this.targetFov)&&(this.camera.fov=this.targetFov))},followMesh:function(c){this.targetMesh=c},unfollowMesh:function(){this.targetMesh=null},reset:function(){this.camera.position.set(0,20,20);this.camera.setTarget(new BABYLON.Vector3(0,0,50));this.light.position.set(this.camera.position.x,this.camera.position.y+10,this.camera.position.z)},pointCameraToTarget:function(c){this.pointCameraToVec3(this.targetMesh.position,0,c)},pointCameraToVec3:function(c,
b,e){b=this.tempVec1;b.copyFrom(this.camera.target);e?(b.x=c.x,b.y=c.y,b.z=c.z):(b.x+=(c.x-b.x)/10,b.y+=(c.y-b.y)/10,b.z+=(c.z-b.z)/10);this.camera.position.set(b.x+this.targetRelativePosition.x,b.y+this.targetRelativePosition.y,b.z+this.targetRelativePosition.z);this.camera.setTarget(b)}}});ig.baked=!0;
ig.module("game.scene3d.utils.mesh-manager").defines(function(){ig.meshManager={ground:null,post:null,target:null,bow:null,arrowTip:null,arrowBody:null,crosshairPoint:null,targetDistance:350,targetHeight:20,init:function(){this.initGround();this.initPost();this.initTarget();this.initArrow();this.initBow();setTimeout(function(){ig.altBabylon.scene.getMaterialByName("default material")&&(ig.altBabylon.scene.getMaterialByName("default material").disableLighting=!0)}.bind(this),200)},initGround:function(){var c=
ig.altBabylon.scene;this.groundMaterial=new BABYLON.StandardMaterial("groundMaterial",c);this.groundMaterial.emissiveColor=BABYLON.Color3.FromHexString("#fa9368");this.groundMaterial.ambientColor=BABYLON.Color3.FromHexString("#fa9368");this.groundMaterial.diffuseColor=BABYLON.Color3.FromHexString("#fa9368");this.ground=BABYLON.MeshBuilder.CreateGround("ground",{width:5E3,height:5E3},c);this.ground.position.set(0,0,0);this.ground.material=this.groundMaterial},initPost:function(){var c=ig.altBabylon.scene;
this.postMaterial=new BABYLON.StandardMaterial("postMaterial",c);this.postMaterial.emissiveColor=BABYLON.Color3.FromHexString("#804000");this.postMaterial.ambientColor=BABYLON.Color3.FromHexString("#804000");this.postMaterial.diffuseColor=BABYLON.Color3.FromHexString("#804000");this.post=BABYLON.MeshBuilder.CreateCylinder("post",{diameter:2,height:this.targetHeight,tessellation:8},c);this.post.position.set(0,this.targetHeight/2,this.targetDistance);this.post.material=this.postMaterial},initTarget:function(){var c=
ig.altBabylon.scene;this.targetDynamicTexture=new BABYLON.DynamicTexture("targetTexture",512,c,!0);this.targetTextureHasDrawn=!1;this.targetMaterial=new BABYLON.StandardMaterial("targetMaterial",c);this.targetMaterial.emissiveTexture=this.targetDynamicTexture;this.targetMaterial.diffuseTexture=this.targetDynamicTexture;this.targetMaterial.opacityTexture=this.targetDynamicTexture;var b=[new BABYLON.Vector4(0,0,1,1),new BABYLON.Vector4(0,0,0.01,0.01),new BABYLON.Vector4(0,0,0.01,0.01)],e=[BABYLON.Color4.FromHexString("#ffffa6ff"),
BABYLON.Color4.FromHexString("#a60000ff"),BABYLON.Color4.FromHexString("#a60000ff")];this.target=BABYLON.MeshBuilder.CreateCylinder("target",{diameter:15,height:3,tessellation:64,faceUV:b,faceColors:e},c);this.target.position.set(0,this.targetHeight,this.post.position.z);this.target.rotation.set(Math.PI/2,0,0);this.target.material=this.targetMaterial},initArrow:function(){var c=ig.altBabylon.scene;this.arrowTip=BABYLON.MeshBuilder.CreateSphere("arrowTip",{diameter:0.1},c);this.arrowTip.position.set(0,
20,0);this.arrowBody=BABYLON.MeshBuilder.CreateBox("arrowBody",{width:0.1,height:0.1,depth:10},c);this.arrowBody.position.set(0,20,0);this.aftershotCamPos=BABYLON.MeshBuilder.CreateSphere("arrowTip",{diameter:0.1},c);this.aftershotCamPos.position.copyFrom(this.target.position);this.aftershotCamPos.position.x-=5;this.aftershotCamPos.position.y+=5;this.aftershotCamPos.position.z-=15;this.aftershotCamPos.isVisible=!1;this.crosshairPoint=BABYLON.MeshBuilder.CreateSphere("crosshairPoint",{diameter:0.1},
c);this.crosshairPoint.position.copyFrom(this.target.position);this.crosshairPoint.isVisible=!1},initBow:function(){},update:function(){if(!this.targetTextureHasDrawn){var c=new ig.Image("media/graphics/game/target.png");c.loaded&&(this.targetDynamicTexture.getContext().drawImage(c.data,0,0),this.targetDynamicTexture.update(),this.targetTextureHasDrawn=!0,console.log("targetDrawn"))}},normalize2:function(c,b,e){var d=Math.sqrt(c*c+b*b);return{x:e*c/d,y:e*b/d}},getCenterVec3:function(c,b){var e=new BABYLON.Vector3(0,
0,0);e.x=(c.x+b.x)/2;e.y=(c.y+b.y)/2;e.z=(c.z+b.z)/2;return e},normalizeYToCenter:function(c,b,e,d){var j=c.x-b,f=c.z-e,p=Math.sqrt(j*j+f*f);c.x=d*j/p+b;c.z=d*f/p+e},rotateOnYAxis:function(c,b,e,d){var j=Math.sin(d);d=Math.cos(d);c.x=(c.x-b)*d-(c.z-e)*j+b;c.z=(c.x-b)*j+(c.z-e)*d+e}}});ig.baked=!0;
ig.module("game.scene3d.objects.mesh-object").defines(function(){ig.MeshObject=ig.Class.extend({mesh:null,timedLife:-1,init:function(c,b,e,d,j,f){j?(this.mesh=d.clone("clonedMesh"),this.mesh.sourceName=d.name):this.mesh=f?d.createInstance("meshInstance"):d;this.mesh.position.set(c,b,e)},update:function(c){0<this.timedLife&&(this.timedLife-=c,0>=this.timedLife&&this.destroy())},destroy:function(){this.mesh.dispose()}})});ig.baked=!0;
ig.module("game.scene3d.objects.arrow-tip").requires("game.scene3d.objects.mesh-object").defines(function(){ig.ArrowTip=ig.MeshObject.extend({isFlying:!1,gravity:null,speed:null,wind:null,arrowPower:200,arrowBody:null,isAiming:!1,onLanded:null,launchNextFrame:!1,resetNextFrame:!1,init:function(){this.parent(0,0,0,ig.meshManager.arrowTip,!1,!1);this.speed=new BABYLON.Vector3(0,0,0);this.wind=new BABYLON.Vector3(0,0,0);this.gravity=new BABYLON.Vector3(0,-10,0);this.arrowBody=ig.meshManager.arrowBody;
this.reset();this.onLanded=new ig.Signal},update:function(c){this.parent(c);if(this.isFlying){var b=this.mesh;this.speed.x+=(this.gravity.x+this.wind.x)*c;this.speed.y+=(this.gravity.y+this.wind.y)*c;this.speed.z+=(this.gravity.z+this.wind.z)*c;b.position.x+=this.speed.x*c;b.position.y+=this.speed.y*c;b.position.z+=this.speed.z*c;if(this.mesh.intersectsMesh(ig.meshManager.target)||0>this.mesh.position.y)this.isFlying=!1,setTimeout(function(){ig.cameraControl.followMesh(ig.meshManager.aftershotCamPos);
this.onLanded.dispatch()}.bind(this),500)}else this.isAiming&&this.mesh.position.set(ig.cameraControl.camera.position.x+1,ig.cameraControl.camera.position.y-2,ig.cameraControl.camera.position.z+10);this.arrowBody.position.copyFrom(this.mesh.position);this.arrowBody.position.z-=5;this.launchNextFrame&&(this.launch(),this.launchNextFrame=!1);this.resetNextFrame&&(this.reset(),this.resetNextFrame=!1)},reset:function(){this.mesh.position.set(1,ig.meshManager.target.position.y-2,0);this.isFlying=!1;ig.cameraControl.targetRelativePosition.set(0,
0,-ig.meshManager.target.position.z-10);ig.cameraControl.followMesh(ig.meshManager.crosshairPoint);ig.cameraControl.pointCameraToTarget(!0)},launch:function(){this.isFlying=!0;this.mesh.position.x=ig.cameraControl.camera.position.x;this.mesh.position.y=ig.cameraControl.camera.position.y;this.speed.set(0,-this.gravity.y*((ig.meshManager.target.position.z-this.mesh.position.z)/this.arrowPower/2),this.arrowPower);ig.cameraControl.targetRelativePosition.set(-2,2,-10);ig.cameraControl.followMesh(this.mesh);
ig.cameraControl.pointCameraToTarget(!0)}})});ig.baked=!0;
ig.module("game.scene3d.babylon-scene-controller").requires("game.scene3d.utils.camera-control","game.scene3d.utils.mesh-manager","game.scene3d.objects.arrow-tip").defines(function(){ig.babylonSceneController={hasInitialized:!1,paused:!1,player:null,dtAccumulator:0,arrow:null,shadowGenerator:null,init:function(){console.log("WebGL Version",ig.altBabylon.engine.webGLVersion);ig.meshManager.init();ig.cameraControl.init();ig.showStats=!1;this.arrow=new ig.ArrowTip;ig.altBabylon.onUpdate.add(this.update.bind(this));
this.paused=this.hasInitialized=!0;this.reset()},reset:function(){},initDebug:function(){ig.debug&&(ig.sceneInstrumentation=new BABYLON.SceneInstrumentation(ig.altBabylon.scene),ig.sceneInstrumentation.captureActiveMeshesEvaluationTime=!0,ig.sceneInstrumentation.captureRenderTargetsRenderTime=!0,ig.sceneInstrumentation.captureDrawCalls=!0,ig.sceneInstrumentation.captureFrameTime=!0,ig.sceneInstrumentation.captureRenderTime=!0,ig.sceneInstrumentation.captureCameraRenderTime=!0)},update:function(c){!this.paused&&
this.hasInitialized&&(ig.cameraControl.update(c),ig.meshManager.update(c),this.arrow.update(c),this.updateTarget(c))},updateTarget:function(){}}});ig.baked=!0;ig.module("game.toybox.utils.tween-patch").requires("plugins.tween").defines(function(){ig.Entity.prototype.delayedCall=function(c,b,e){void 0===e&&(e=!0);c=new ig.Tween(this,{},c,{onComplete:b});this.tweens.push(c);e&&c.start();return c}});ig.baked=!0;
ig.module("game.toybox.objects.ui.texts.text-renderer").requires("impact.impact").defines(function(){ig.TextRenderer=ig.Class.extend({text:"",font:"48px Arial",color:"#000000",alpha:1,align:"start",offsetX:0,offsetY:0,lineSpacing:1,valign:"default",enableShadow:!1,shadowColor:"#000000",shadowOffsetX:0,shadowOffsetY:4,shadowAlpha:1,outlineWeight:0,outlineColor:"#000000",outlineCap:"square",outlineJoin:"bevel",_previousText:"",_multiline:!1,_lines:[],_lineHeightInPixel:0,init:function(){},draw:function(c,
b){void 0===c&&(c=0);void 0===b&&(b=0);this.enableShadow&&this.drawText(c+this.shadowOffsetX,b+this.shadowOffsetY,this.shadowAlpha*this.alpha,this.shadowColor,this.shadowColor);this.drawText(c,b,this.alpha,this.color,this.outlineColor)},drawText:function(c,b,e,d,j){if(0<this.text.length){this._previousTextString!=this.text&&(this._previousTextString=this.text,this._lines=this.text.split(/\r?\n/),this._multiline=1<this._lines.length?!0:!1,this._lineHeightInPixel=parseInt(this.font.split("px")[0].split(" ").pop())*
this.lineSpacing,isNaN(this._lineHeightInPixel)&&console.error("'"+this.font+"' is a wrong font string format, error when rendering "+this.text));var f=ig.system.context;f.save();f.font=this.font;f.textAlign=this.align;f.lineWidth=2*this.outlineWeight;f.lineCap=this.outlineCap;f.lineJoin=this.outlineJoin;f.miterLimit=2*this.outlineWeight;1>e?(d=ig.hexToRgb(d),f.fillStyle="rgba("+d.r+","+d.g+","+d.b+","+e+")",d=ig.hexToRgb(j),f.strokeStyle="rgba("+d.r+","+d.g+","+d.b+","+e+")"):(f.fillStyle=d,f.strokeStyle=
j);c+=this.offsetX;e=b+this.offsetY;if(this._multiline){b=e;"center"==this.valign&&(b=e-(this._lines.length-1)*this._lineHeightInPixel/2);for(e=0;e<this._lines.length;e++)j=this._lines[e],0<this.outlineWeight&&f.strokeText(j,c,b+e*this._lineHeightInPixel),f.fillText(j,c,b+e*this._lineHeightInPixel)}else"center"==this.valign&&(e+=this._lineHeightInPixel/2),0<this.outlineWeight&&f.strokeText(this.text,c,e),f.fillText(this.text,c,e);f.restore()}},measureTextWidth:function(){var c=ig.system.context;c.save();
c.font=this.font;c.textAlign="left";var b=c.measureText(this.text);c.restore();return b.width}})});ig.baked=!0;
ig.module("game.toybox.utils.random").defines(function(){ig.random={chance:function(c){return Math.random()<c},bool:function(){return 0.5>Math.random()},"int":function(c,b){return c+Math.floor((b-c+1)*Math.random())},"float":function(c,b){return c+(b-c)*Math.random()},string:function(c,b){void 0===b&&(b="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789");for(var e="",d=0;d<c;d++)e+=b.charAt(Random.int(0,b.length-1));return e},fromArray:function(c){return null!=c&&0<c.length?c[this.int(0,
c.length-1)]:null},shuffle:function(c){if(null!=c)for(var b=0;b<c.length;b++){var e=this.int(0,c.length-1),d=c[b];c[b]=c[e];c[e]=d}return c}}});ig.baked=!0;
ig.module("game.toybox.utils.signal").requires("impact.impact").defines(function(){ig.Signal=ig.Class.extend({signalListeners:null,id:0,init:function(){this.id=++ig.Signal._lastId;this.signalListeners=[]},addOnce:function(c,b){this.signalListeners.push({signalListener:c,signalContext:b,isOnce:!0})},add:function(c,b){this.signalListeners.push({signalListener:c,signalContext:b,isOnce:!1})},dispatch:function(){for(var c=0;c<this.signalListeners.length;){var b=this.signalListeners[c];b.signalListener.apply(b.signalContext,
arguments);b.isOnce?this.signalListeners.splice(c,1):c++}}});ig.Signal._lastId=0});ig.baked=!0;
ig.module("game.toybox.utils.toybox-touch").requires("impact.impact").defines(function(){ig.ToyboxTouch={touches:[],init:function(){ig.ua.touchDevice&&(window.navigator.msPointerEnabled&&(ig.system.canvas.addEventListener("MSPointerDown",this.touchDown.bind(this),!1),ig.system.canvas.addEventListener("MSPointerUp",this.touchUp.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",this.touchMove.bind(this),!1),ig.system.canvas.style.msContentZooming="none",ig.system.canvas.style.msTouchAction=
"none"),ig.system.canvas.addEventListener("touchstart",this.touchDown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.touchUp.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.touchMove.bind(this),!1))},touchDown:function(c){this.processTouch(c.touches)},touchUp:function(c){this.processTouch(c.touches)},touchMove:function(c){this.processTouch(c.touches)},processTouch:function(c){var b=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth,e=parseInt(ig.system.canvas.offsetHeight)||
ig.system.realHeight;this.scaleX=ig.system.scale*(b/ig.system.realWidth);this.scaleY=ig.system.scale*(e/ig.system.realHeight);b={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(b=ig.system.canvas.getBoundingClientRect());this.touches=[];for(e=0;e<c.length;e++){var d=c[e];this.touches.push({x:(d.clientX-b.left)/this.scaleX,y:(d.clientY-b.top)/this.scaleY})}}}});ig.baked=!0;
ig.module("game.toybox.babylon.alt-babylon").defines(function(){ig.altBabylon={onSceneLoaded:null,onUpdate:null,scene:null,engine:null,canvas:null,canvasId:null,loadScene:function(c,b,e){this.scene&&this.scene.dispose();this.scene=null;this.onSceneLoaded=new ig.Signal;this.onUpdate=new ig.Signal;BABYLON.Engine.isSupported()&&(this.engine||(e?this.canvasId=e:this.canvasId||(this.canvasId="webgl"),this.canvas=ig.$(e),this.engine=new BABYLON.Engine(this.canvas,!1),this.runEngineLoop()),BABYLON.SceneLoader.ShowLoadingScreen=
!1,BABYLON.SceneLoader.Load(c,b,this.engine,this.onLoadSuccess.bind(this),null,this.onLoadError.bind(this)));return this},stopEngineLoop:function(){this.engine.stopRenderLoop()},runEngineLoop:function(){this.engine.runRenderLoop(ig.altBabylon.loop.bind(ig.altBabylon))},loop:function(){if(this.scene){if(this.onUpdate){var c=this.engine.getDeltaTime()/1E3;this.onUpdate.dispatch(c)}this.scene.render()}},onLoadSuccess:function(c){this.scene=c;this.onSceneLoaded.dispatch()},onLoadError:function(c,b,e){console.log("ERROR LOADING SCENE");
console.log(c);console.log(b);console.log(e)}}});ig.baked=!0;
ig.module("game.toybox.content").requires("impact.entity","game.toybox.utils.tween-patch","game.toybox.controllers.controller","game.toybox.objects.game-object","game.toybox.objects.ui.texts.text-field","game.toybox.objects.ui.texts.text-renderer","game.toybox.objects.ui.buttons.simple-button","game.toybox.utils.random","game.toybox.utils.signal","game.toybox.utils.toybox-touch","game.toybox.babylon.alt-babylon").defines(function(){setTimeout(function(){console.log("toybox 0.4.5");ig.ToyboxTouch.init()},
1E3);ig.drawRoundRect=function(c,b,e,d,j,f,p,l){"undefined"==typeof l&&(l=!0);"undefined"===typeof f&&(f=5);c.beginPath();c.moveTo(b+f,e);c.lineTo(b+d-f,e);c.quadraticCurveTo(b+d,e,b+d,e+f);c.lineTo(b+d,e+j-f);c.quadraticCurveTo(b+d,e+j,b+d-f,e+j);c.lineTo(b+f,e+j);c.quadraticCurveTo(b,e+j,b,e+j-f);c.lineTo(b,e+f);c.quadraticCurveTo(b,e,b+f,e);c.closePath();l&&c.stroke();p&&c.fill()};ig.hexToRgb=function(c){ig.hexToRgbTable||(ig.hexToRgbTable={});if(ig.hexToRgbTable[c])return ig.hexToRgbTable[c];
var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(c);if(b)return ig.hexToRgbTable[c]={r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16),hex:c},ig.hexToRgbTable[c];console.log("cannot convert to rgb from hex :",c);return null};ig.utils={};ig.utils.normalize2=function(c,b,e){var d=Math.sqrt(c*c+b*b);return{x:e*c/d,y:e*b/d}};ig.utils.lerp=function(c,b,e){return(1-e)*c+e*b};ig.utils.lerpDt=function(c,b,e){return this.lerp(c,b,e*ig.system.tick)};ig.utils.lerpPerfectDt=function(c,b,e,d,j){j||
(j=0.01);if(Math.abs(c-b)<j)return b;e=1-Math.pow(e,d);return this.lerp(c,b,e)};ig.utils.setFaceDirection=function(c,b){c.rotationQuaternion||(c.rotationQuaternion=BABYLON.Quaternion.Identity());b.normalize();var e=BABYLON.Matrix.Identity(),d=BABYLON.Vector3.Up(),d=BABYLON.Vector3.Cross(b,d),j=BABYLON.Vector3.Cross(d,b);e.m[0]=d.x;e.m[1]=d.y;e.m[2]=d.z;e.m[4]=b.x;e.m[5]=b.y;e.m[6]=b.z;e.m[8]=j.x;e.m[9]=j.y;e.m[10]=j.z;BABYLON.Quaternion.FromRotationMatrixToRef(e,c.rotationQuaternion)};ig.utils.showAxis3d=
function(c){var b=wgl.game.currentScene,e=function(c,e,f){var p=new BABYLON.DynamicTexture("DynamicTexture",50,b,!0);p.hasAlpha=!0;p.drawText(c,5,40,"bold 36px Arial",e,"transparent",!0);c=new BABYLON.Mesh.CreatePlane("TextPlane",f,b,!0);c.material=new BABYLON.StandardMaterial("TextPlaneMaterial",b);c.material.backFaceCulling=!1;c.material.specularColor=new BABYLON.Color3(0,0,0);c.material.diffuseTexture=p;return c};BABYLON.Mesh.CreateLines("axisX",[new BABYLON.Vector3.Zero,new BABYLON.Vector3(c,
0,0),new BABYLON.Vector3(0.95*c,0.05*c,0),new BABYLON.Vector3(c,0,0),new BABYLON.Vector3(0.95*c,-0.05*c,0)],b).color=new BABYLON.Color3(1,0,0);e("X","red",c/10).position=new BABYLON.Vector3(0.9*c,-0.05*c,0);BABYLON.Mesh.CreateLines("axisY",[new BABYLON.Vector3.Zero,new BABYLON.Vector3(0,c,0),new BABYLON.Vector3(-0.05*c,0.95*c,0),new BABYLON.Vector3(0,c,0),new BABYLON.Vector3(0.05*c,0.95*c,0)],b).color=new BABYLON.Color3(0,1,0);e("Y","green",c/10).position=new BABYLON.Vector3(0,0.9*c,-0.05*c);BABYLON.Mesh.CreateLines("axisZ",
[new BABYLON.Vector3.Zero,new BABYLON.Vector3(0,0,c),new BABYLON.Vector3(0,-0.05*c,0.95*c),new BABYLON.Vector3(0,0,c),new BABYLON.Vector3(0,0.05*c,0.95*c)],b).color=new BABYLON.Color3(0,0,1);e("Z","blue",c/10).position=new BABYLON.Vector3(0,0.05*c,0.9*c)}});ig.baked=!0;
ig.module("plugins.fullscreen").requires("impact.entity","plugins.handlers.size-handler","plugins.director").defines(function(){ig.Fullscreen={enableFullscreenButton:!0,_isEnabled:"notChecked",isEnabled:function(){"notChecked"==this._isEnabled&&(this._isEnabled=document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled?!0:!1);return this._isEnabled},isFullscreen:function(){return ig.Fullscreen.isEnabled()&&(document.fullscreenElement||
document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)?!0:!1},toggleFullscreen:function(){ig.Fullscreen.isFullscreen()?ig.Fullscreen.exitFullscreen():ig.Fullscreen.requestFullscreen();ig.sizeHandler.orientationDelayHandler();if(ig&&ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(c){}},requestFullscreen:function(){var c=document.documentElement;c.requestFullscreen?c.requestFullscreen():c.webkitRequestFullscreen?
c.webkitRequestFullscreen():c.mozRequestFullScreen?c.mozRequestFullScreen():c.msRequestFullscreen?c.msRequestFullscreen():console.log("no request fullscreen method available")},exitFullscreen:function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():console.log("no exit fullscreen method available")},divs:{}};ig.Director.inject({loadLevel:function(c){var b=
ig.Fullscreen.divs,e;for(e in b)b=ig.domHandler.getElementById("#"+e),ig.domHandler.hide(b);return this.parent(c)}});ig.SizeHandler.inject({resize:function(){this.parent();var c=ig.Fullscreen.divs,b;for(b in c){var e=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y),d=ig.domHandler.getElementById("#"+b),j=c[b].entity_pos_x,f=c[b].entity_pos_y,p=c[b].width,l=c[b].height,g=ig.domHandler.getElementById("#canvas"),g=ig.domHandler.getOffsets(g);ig.domHandler.css(d,{"float":"left",
position:"absolute",left:Math.floor(g.left+j*e)+"px",top:Math.floor(g.top+f*e)+"px",width:Math.floor(p*e)+"px",height:Math.floor(l*e)+"px","z-index":3})}}});ig.FullscreenButton=ig.Entity.extend({enterImage:null,exitImage:null,isReady:!1,zIndex:999999,identifier:null,prevPos:{x:0,y:0},invisImagePath:"media/graphics/misc/invisible.png",init:function(c,b,e){this.parent(c,b,e);ig.Fullscreen.isEnabled()&&ig.Fullscreen.enableFullscreenButton?this.enterImage.loaded?this.initSize():this.enterImage.loadCallback=
function(){this.initSize()}.bind(this):this.kill()},kill:function(){this.parent()},destroy:function(){this.parent();console.log("destroy")},initSize:function(){this.size.x=this.enterImage.width;this.size.y=this.enterImage.height;this.createClickableLayer();this.isReady=!0},createClickableLayer:function(){this.identifier="fullscreen-button-layer";var c=ig.domHandler.getElementById("#"+this.identifier);c?(ig.domHandler.show(c),ig.domHandler.attr(c,"onclick","ig.Fullscreen.toggleFullscreen()")):this.createClickableOutboundLayer()},
update:function(c,b){this.parent();c=this.pos.x;b=this.pos.y;this.isReady&&!(this.prevPos.x==c&&this.prevPos.y==b)&&(console.log(c,b),this.prevPos.x=c,this.prevPos.y=b,ig.Fullscreen.divs[this.identifier]={},ig.Fullscreen.divs[this.identifier].width=this.size.x,ig.Fullscreen.divs[this.identifier].height=this.size.y,ig.Fullscreen.divs[this.identifier].entity_pos_x=this.pos.x,ig.Fullscreen.divs[this.identifier].entity_pos_y=this.pos.y,ig.sizeHandler.resize())},draw:function(){this.isReady&&(ig.Fullscreen.isFullscreen()?
this.exitImage.draw(this.pos.x,this.pos.y):this.enterImage.draw(this.pos.x,this.pos.y))},createClickableOutboundLayer:function(){var c=this.identifier,b=this.invisImagePath,e=ig.domHandler.create("div");ig.domHandler.attr(e,"id",c);ig.domHandler.attr(e,"onclick","ig.Fullscreen.toggleFullscreen()");var d=ig.domHandler.create("a"),j=ig.domHandler.create("img");ig.domHandler.css(j,{width:"100%",height:"100%"});ig.domHandler.attr(j,"src",b);b=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);
if(ig.ua.mobile){var f=ig.domHandler.getElementById("#canvas"),f=ig.domHandler.getOffsets(f),p=f.left,l=f.top;console.log(f.left);ig.sizeHandler.disableStretchToFitOnMobileFlag?(f=Math.floor(p+this.pos.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px",l=Math.floor(l+this.pos.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px",p=Math.floor(this.size.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px",b=Math.floor(this.size.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px"):(f=Math.floor(this.pos.x*ig.sizeHandler.sizeRatio.x)+
"px",l=Math.floor(this.pos.y*ig.sizeHandler.sizeRatio.y)+"px",p=Math.floor(this.size.x*ig.sizeHandler.sizeRatio.x)+"px",b=Math.floor(this.size.y*ig.sizeHandler.sizeRatio.y)+"px")}else f=ig.domHandler.getElementById("#canvas"),f=ig.domHandler.getOffsets(f),p=f.left,l=f.top,ig.sizeHandler.enableStretchToFitOnDesktopFlag?(f=Math.floor(p+this.pos.x*ig.sizeHandler.sizeRatio.x)+"px",l=Math.floor(l+this.pos.y*ig.sizeHandler.sizeRatio.y)+"px",p=Math.floor(this.size.x*ig.sizeHandler.sizeRatio.x)+"px",b=Math.floor(this.size.y*
ig.sizeHandler.sizeRatio.y)+"px"):(f=Math.floor(p+this.pos.x*b)+"px",l=Math.floor(l+this.pos.y*b)+"px",p=Math.floor(this.size.x*b)+"px",b=Math.floor(this.size.y*b)+"px");ig.domHandler.css(e,{"float":"left",position:"absolute",left:f,top:l,width:p,height:b,"z-index":3});ig.domHandler.addEvent(e,"mousemove",ig.input.mousemove.bind(ig.input),!1);ig.domHandler.appendChild(d,j);ig.domHandler.appendChild(e,d);ig.domHandler.appendToBody(e);ig.Fullscreen.divs[c]={};ig.Fullscreen.divs[c].width=this.size.x;
ig.Fullscreen.divs[c].height=this.size.y;ig.Fullscreen.divs[c].entity_pos_x=this.pos.x;ig.Fullscreen.divs[c].entity_pos_y=this.pos.y}})});ig.baked=!0;
ig.module("game.main").requires("impact.game","impact.debug.debug","plugins.patches.timer-patch","plugins.patches.user-agent-patch","plugins.patches.webkit-image-smoothing-patch","plugins.patches.windowfocus-onMouseDown-patch","plugins.patches.input-patch","plugins.data.vector","plugins.data.color-rgb","plugins.font.font-loader","plugins.handlers.dom-handler","plugins.handlers.size-handler","plugins.handlers.api-handler","plugins.handlers.visibility-handler","plugins.audio.sound-handler","plugins.io.io-manager",
"plugins.io.storage-manager","plugins.splash-loader","plugins.tween","plugins.tweens-handler","plugins.url-parameters","plugins.director","plugins.impact-storage","plugins.responsive.responsive-plugin","plugins.branding.splash","plugins.datastructure.binary-heap","game.entities.branding-logo-placeholder","game.entities.buttons.button-more-games","game.entities.opening-kitty","game.entities.pointer","game.entities.pointer-selector","game.entities.select","game.levels.opening","game.levels.main-menu",
"game.levels.main-menu-settings","game.levels.game-over","game.levels.gameplay","game.levels.tutorial","game.scene3d.babylon-scene-controller","game.toybox.content","plugins.fullscreen").defines(function(){this.START_OBFUSCATION;this.FRAMEBREAKER;MyGame=ig.Game.extend({name:"MJS-Cool-Archer-Proto",version:"1.0.0",frameworkVersion:"1.4.5",io:null,paused:!1,lastDraw:[],scorelist:null,score:0,init:function(){this.tweens=new ig.TweensHandler;this.io=new IoManager;this.setupUrlParams=new ig.UrlParameters;
this.removeLoadingWheel();this.setupStorageManager();this.finalize()},finalize:function(){this.start();ig.sizeHandler.reorient()},removeLoadingWheel:function(){try{$("#ajaxbar").css("background","none")}catch(c){console.log(c)}},showDebugMenu:function(){console.log("showing debug menu ...");ig.Entity._debugShowBoxes=!0;$(".ig_debug").show()},start:function(){this.resetPlayerStats();this.director=new ig.Director(this,[LevelOpening,LevelMainMenu,LevelGameplay,LevelMainMenuSettings,LevelGameOver,LevelTutorial]);
if(_SETTINGS.Branding.Splash.Enabled)try{this.branding=new ig.BrandingSplash}catch(c){console.log(c),console.log("Loading original levels ..."),this.startGame()}else this.startGame();this.spawnEntity(EntityPointerSelector,50,50);ig.input.bind(ig.KEY.UP_ARROW,"jump");ig.input.bind(ig.KEY.LEFT_ARROW,"left");ig.input.bind(ig.KEY.RIGHT_ARROW,"right");ig.input.bind(ig.KEY.W,"jump");ig.input.bind(ig.KEY.A,"left");ig.input.bind(ig.KEY.D,"right");ig.input.bind(ig.KEY.SPACE,"jump")},startGame:function(){this.goToLevel("Gameplay")},
goToLevel:function(c){this.director.loadLevel(this.getLevelID(c))},getLevelID:function(c){for(var b=0;b<this.director.levels.length;b++){var e=this.director.levels[b];if(e.entities&&e.entities[0].type=="Entity"+c+"Controller")return b}console.error("Cannot find level named : "+c);return 0},fpsCount:function(){this.fpsTimer||(this.fpsTimer=new ig.Timer(1));this.fpsTimer&&0>this.fpsTimer.delta()?null!=this.fpsCounter?this.fpsCounter++:this.fpsCounter=0:(ig.game.fps=this.fpsCounter,this.fpsCounter=0,
this.fpsTimer.reset())},endGame:function(){console.log("End game");ig.soundHandler.bgmPlayer.stop();ig.apiHandler.run("MJSEnd")},resetPlayerStats:function(){ig.log("resetting player stats ...");this.playerStats={id:this.playerStats?this.playerStats.id:null}},splashClick:function(){var c=ig.domHandler.getElementById("#play");ig.domHandler.hide(c);ig.apiHandler.run("MJSFooter");ig.apiHandler.run("MJSHeader");ig.game.start()},pauseGame:function(){ig.system.stopRunLoop.call(ig.system);ig.game.tweens.onSystemPause();
ig.babylonSceneController.paused=!0;console.log("Game Paused")},resumeGame:function(){ig.system.startRunLoop.call(ig.system);ig.game.tweens.onSystemResume();ig.babylonSceneController.paused=!1;console.log("Game Resumed")},showOverlay:function(c){for(i=0;i<c.length;i++)$("#"+c[i])&&$("#"+c[i]).show(),document.getElementById(c[i])&&(document.getElementById(c[i]).style.visibility="visible")},hideOverlay:function(c){for(i=0;i<c.length;i++)$("#"+c[i])&&$("#"+c[i]).hide(),document.getElementById(c[i])&&
(document.getElementById(c[i]).style.visibility="hidden")},currentBGMVolume:1,addition:0.1,update:function(){this.paused?(this.updateWhilePaused(),this.checkEntities()):(this.parent(),ig.ua.mobile&&ig.soundHandler&&ig.soundHandler.forceLoopBGM());this.io.clear()},updateWhilePaused:function(){for(var c=0;c<this.entities.length;c++)this.entities[c].ignorePause&&this.entities[c].update()},draw:function(){this.parent();this.drawFPS();for(var c=0;c<this.lastDraw.length;c++)this.lastDraw[c]();this.dctf()},
dctf:function(){this.COPYRIGHT},drawFPS:function(){var c=Math.round(1E3/ig.debug.debugTickAvg);this.fillStrokeText("[ WEBGL "+ig.altBabylon.engine.webGLVersion+" ][ FPS C "+c+" ][ FPS B "+ig.altBabylon.engine.performanceMonitor.averageFPS.toFixed()+" ]",5,953)},fillStrokeText:function(c,b,e){var d=ig.system.context,j=d.measureText(c).width+4;d.save();d.fillStyle="#333333";d.fillRect(b-3,e-11,j+4,16);d.fillStyle="#ffffff";d.fillText(c,b,e);d.restore()},clearCanvas:function(c,b,e){var d=c.canvas;c.clearRect(0,
0,b,e);d.style.display="none";d.offsetHeight;d.style.display="inherit"},drawDebug:function(){if(!ig.global.wm&&(this.debugEnable(),this.viewDebug&&(ig.system.context.fillStyle="#000000",ig.system.context.globalAlpha=0.35,ig.system.context.fillRect(0,0,ig.system.width/4,ig.system.height),ig.system.context.globalAlpha=1,this.debug&&0<this.debug.length)))for(i=0;i<this.debug.length;i++)ig.system.context.font="10px Arial",ig.system.context.fillStyle="#ffffff",ig.system.context.fillText(this.debugLine-
this.debug.length+i+": "+this.debug[i],10,50+10*i)},debugCL:function(c){this.debug?(50>this.debug.length||this.debug.splice(0,1),this.debug.push(c),this.debugLine++):(this.debug=[],this.debugLine=1,this.debug.push(c));console.log(c)},debugEnable:function(){ig.input.pressed("click")&&(this.debugEnableTimer=new ig.Timer(2));this.debugEnableTimer&&0>this.debugEnableTimer.delta()?ig.input.released("click")&&(this.debugEnableTimer=null):this.debugEnableTimer&&0<this.debugEnableTimer.delta()&&(this.debugEnableTimer=
null,this.viewDebug=this.viewDebug?!1:!0)}});ig.babylonJSSupport=!0;ig.domHandler=null;ig.domHandler=new ig.DomHandler;ig.domHandler.forcedDeviceDetection();ig.domHandler.forcedDeviceRotation();ig.apiHandler=new ig.ApiHandler;ig.sizeHandler=new ig.SizeHandler(ig.domHandler);ig.visibilityHandler=new ig.VisibilityHandler;ig.soundHandler=null;ig.soundHandler=new ig.SoundHandler;ig.fontInfo=null;ig.fontInfo=new ig.FontInfo;ig.altBabylon.loadScene("media/scenes/","game-scene.babylon","#webglcanvas").onSceneLoaded.addOnce(ig.babylonSceneController.init.bind(ig.babylonSceneController));
ig.main("#canvas",MyGame,60,ig.sizeHandler.desktop.actualResolution.x,ig.sizeHandler.desktop.actualResolution.y,ig.sizeHandler.scale,ig.SplashLoader);ig.sizeHandler.reorient();this.DOMAINLOCK_BREAKOUT_ATTEMPT;this.END_OBFUSCATION});
