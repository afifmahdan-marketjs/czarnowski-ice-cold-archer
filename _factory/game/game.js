!function(b,c){"object"==typeof module&&"object"==typeof module.exports?module.exports=b.document?c(b,!0):function(b){if(!b.document)throw Error("jQuery requires a window with a document");return c(b)}:c(b)}("undefined"!=typeof window?window:this,function(b,c){function e(b,c){c=c||M;var d=c.createElement("script");d.text=b;c.head.appendChild(d).parentNode.removeChild(d)}function d(b){var c=!!b&&"length"in b&&b.length,d=p.type(b);return"function"!==d&&!p.isWindow(b)&&("array"===d||0===c||"number"==
typeof c&&0<c&&c-1 in b)}function g(b,c){return b.nodeName&&b.nodeName.toLowerCase()===c.toLowerCase()}function f(b,c,d){return p.isFunction(c)?p.grep(b,function(b,e){return!!c.call(b,e,b)!==d}):c.nodeType?p.grep(b,function(b){return b===c!==d}):"string"!=typeof c?p.grep(b,function(b){return-1<Ua.call(c,b)!==d}):Fc.test(c)?p.filter(c,b,d):(c=p.filter(c,b),p.grep(b,function(b){return-1<Ua.call(c,b)!==d&&1===b.nodeType}))}function m(b,c){for(;(b=b[c])&&1!==b.nodeType;);return b}function l(b){return b}
function j(b){throw b;}function n(b,c,d,e){var j;try{b&&p.isFunction(j=b.promise)?j.call(b).done(c).fail(d):b&&p.isFunction(j=b.then)?j.call(b,c,d):c.apply(void 0,[b].slice(e))}catch(f){d.apply(void 0,[f])}}function r(){M.removeEventListener("DOMContentLoaded",r);b.removeEventListener("load",r);p.ready()}function q(){this.expando=p.expando+q.uid++}function s(b,c,d){var e;if(void 0===d&&1===b.nodeType)if(e="data-"+c.replace(Gc,"-$&").toLowerCase(),d=b.getAttribute(e),"string"==typeof d){try{d="true"===
d||"false"!==d&&("null"===d?null:d===+d+""?+d:Hc.test(d)?JSON.parse(d):d)}catch(j){}pa.set(b,c,d)}else d=void 0;return d}function t(b,c,d,e){var j,f=1,g=20,r=e?function(){return e.cur()}:function(){return p.css(b,c,"")},n=r(),l=d&&d[3]||(p.cssNumber[c]?"":"px"),q=(p.cssNumber[c]||"px"!==l&&+n)&&jb.exec(p.css(b,c));if(q&&q[3]!==l){l=l||q[3];d=d||[];q=+n||1;do f=f||".5",q/=f,p.style(b,c,q+l);while(f!==(f=r()/n)&&1!==f&&--g)}return d&&(q=+q||+n||0,j=d[1]?q+(d[1]+1)*d[2]:+d[2],e&&(e.unit=l,e.start=q,
e.end=j)),j}function u(b,c){for(var d,e,j=[],f=0,g=b.length;f<g;f++)if(e=b[f],e.style)if(d=e.style.display,c){if("none"===d&&(j[f]=T.get(e,"display")||null,j[f]||(e.style.display="")),""===e.style.display&&rb(e)){d=j;var r=f,n,l=void 0;n=e.ownerDocument;var q=e.nodeName;n=(e=Vb[q])?e:(l=n.body.appendChild(n.createElement(q)),e=p.css(l,"display"),l.parentNode.removeChild(l),"none"===e&&(e="block"),Vb[q]=e,e);d[r]=n}}else"none"!==d&&(j[f]="none",T.set(e,"display",d));for(f=0;f<g;f++)null!=j[f]&&(b[f].style.display=
j[f]);return b}function v(b,c){var d;return d="undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(c||"*"):"undefined"!=typeof b.querySelectorAll?b.querySelectorAll(c||"*"):[],void 0===c||c&&g(b,c)?p.merge([b],d):d}function x(b,c){for(var d=0,e=b.length;d<e;d++)T.set(b[d],"globalEval",!c||T.get(c[d],"globalEval"))}function y(b,c,d,e,j){for(var f,g,n,r,l=c.createDocumentFragment(),q=[],m=0,s=b.length;m<s;m++)if(f=b[m],f||0===f)if("object"===p.type(f))p.merge(q,f.nodeType?[f]:f);else if(Ic.test(f)){g=
g||l.appendChild(c.createElement("div"));n=(Wb.exec(f)||["",""])[1].toLowerCase();n=ra[n]||ra._default;g.innerHTML=n[1]+p.htmlPrefilter(f)+n[2];for(n=n[0];n--;)g=g.lastChild;p.merge(q,g.childNodes);g=l.firstChild;g.textContent=""}else q.push(c.createTextNode(f));l.textContent="";for(m=0;f=q[m++];)if(e&&-1<p.inArray(f,e))j&&j.push(f);else if(r=p.contains(f.ownerDocument,f),g=v(l.appendChild(f),"script"),r&&x(g),d)for(n=0;f=g[n++];)Xb.test(f.type||"")&&d.push(f);return l}function A(){return!0}function B(){return!1}
function C(){try{return M.activeElement}catch(b){}}function I(b,c,d,e,j,f){var g,n;if("object"==typeof c){"string"!=typeof d&&(e=e||d,d=void 0);for(n in c)I(b,n,d,e,c[n],f);return b}if(null==e&&null==j?(j=d,e=d=void 0):null==j&&("string"==typeof d?(j=e,e=void 0):(j=e,e=d,d=void 0)),!1===j)j=B;else if(!j)return b;return 1===f&&(g=j,j=function(b){return p().off(b),g.apply(this,arguments)},j.guid=g.guid||(g.guid=p.guid++)),b.each(function(){p.event.add(this,c,j,e,d)})}function z(b,c){return g(b,"table")&&
g(11!==c.nodeType?c:c.firstChild,"tr")?p(">tbody",b)[0]||b:b}function D(b){return b.type=(null!==b.getAttribute("type"))+"/"+b.type,b}function F(b){var c=Jc.exec(b.type);return c?b.type=c[1]:b.removeAttribute("type"),b}function L(b,c){var d,e,j,f,g,n;if(1===c.nodeType){if(T.hasData(b)&&(d=T.access(b),e=T.set(c,d),n=d.events))for(j in delete e.handle,e.events={},n){d=0;for(e=n[j].length;d<e;d++)p.event.add(c,j,n[j][d])}pa.hasData(b)&&(f=pa.access(b),g=p.extend({},f),pa.set(c,g))}}function R(b,c,d,
j){c=Ha.apply([],c);var f,g,n,r,l=0,q=b.length,m=q-1,s=c[0],t=p.isFunction(s);if(t||1<q&&"string"==typeof s&&!aa.checkClone&&Kc.test(s))return b.each(function(e){var f=b.eq(e);t&&(c[0]=s.call(this,e,f.html()));R(f,c,d,j)});if(q&&(f=y(c,b[0].ownerDocument,!1,b,j),g=f.firstChild,1===f.childNodes.length&&(f=g),g||j)){g=p.map(v(f,"script"),D);for(n=g.length;l<q;l++)r=f,l!==m&&(r=p.clone(r,!0,!0),n&&p.merge(g,v(r,"script"))),d.call(b[l],r,l);if(n){f=g[g.length-1].ownerDocument;p.map(g,F);for(l=0;l<n;l++)r=
g[l],Xb.test(r.type||"")&&!T.access(r,"globalEval")&&p.contains(f,r)&&(r.src?p._evalUrl&&p._evalUrl(r.src):e(r.textContent.replace(Mc,""),f))}}return b}function O(b,c,d){for(var e=c?p.filter(c,b):b,j=0;null!=(c=e[j]);j++)d||1!==c.nodeType||p.cleanData(v(c)),c.parentNode&&(d&&p.contains(c.ownerDocument,c)&&x(v(c,"script")),c.parentNode.removeChild(c));return b}function N(b,c,d){var e,j,f,g,n=b.style;return d=d||sb(b),d&&(g=d.getPropertyValue(c)||d[c],""!==g||p.contains(b.ownerDocument,b)||(g=p.style(b,
c)),!aa.pixelMarginRight()&&Ib.test(g)&&Yb.test(c)&&(e=n.width,j=n.minWidth,f=n.maxWidth,n.minWidth=n.maxWidth=n.width=g,g=d.width,n.width=e,n.minWidth=j,n.maxWidth=f)),void 0!==g?g+"":g}function V(b,c){return{get:function(){return b()?void delete this.get:(this.get=c).apply(this,arguments)}}}function da(b){var c=p.cssProps[b];if(!c){var c=p.cssProps,d;a:if(d=b,!(d in Zb)){for(var e=d[0].toUpperCase()+d.slice(1),j=$b.length;j--;)if(d=$b[j]+e,d in Zb)break a;d=void 0}c=c[b]=d||b}return c}function G(b,
c,d){return(b=jb.exec(c))?Math.max(0,b[2]-(d||0))+(b[3]||"px"):c}function E(b,c,d,e,j){var f=0;for(c=d===(e?"border":"content")?4:"width"===c?1:0;4>c;c+=2)"margin"===d&&(f+=p.css(b,d+Va[c],!0,j)),e?("content"===d&&(f-=p.css(b,"padding"+Va[c],!0,j)),"margin"!==d&&(f-=p.css(b,"border"+Va[c]+"Width",!0,j))):(f+=p.css(b,"padding"+Va[c],!0,j),"padding"!==d&&(f+=p.css(b,"border"+Va[c]+"Width",!0,j)));return f}function ha(b,c,d){var e,j=sb(b),f=N(b,c,j),g="border-box"===p.css(b,"boxSizing",!1,j);return Ib.test(f)?
f:(e=g&&(aa.boxSizingReliable()||f===b.style[c]),"auto"===f&&(f=b["offset"+c[0].toUpperCase()+c.slice(1)]),f=parseFloat(f)||0,f+E(b,c,d||(g?"border":"content"),e,j)+"px")}function S(b,c,d,e,j){return new S.prototype.init(b,c,d,e,j)}function J(){tb&&(!1===M.hidden&&b.requestAnimationFrame?b.requestAnimationFrame(J):b.setTimeout(J,p.fx.interval),p.fx.tick())}function K(){return b.setTimeout(function(){ab=void 0}),ab=p.now()}function P(b,c){var d,e=0,j={height:b};for(c=c?1:0;4>e;e+=2-c)d=Va[e],j["margin"+
d]=j["padding"+d]=b;return c&&(j.opacity=j.width=b),j}function Y(b,c,d){for(var e,j=(Z.tweeners[c]||[]).concat(Z.tweeners["*"]),f=0,g=j.length;f<g;f++)if(e=j[f].call(d,c,b))return e}function Z(b,c,d){var e,j,f=0,g=Z.prefilters.length,n=p.Deferred().always(function(){delete r.elem}),r=function(){if(j)return!1;for(var c=ab||K(),c=Math.max(0,l.startTime+l.duration-c),d=1-(c/l.duration||0),e=0,f=l.tweens.length;e<f;e++)l.tweens[e].run(d);return n.notifyWith(b,[l,d,c]),1>d&&f?c:(f||n.notifyWith(b,[l,1,
0]),n.resolveWith(b,[l]),!1)},l=n.promise({elem:b,props:p.extend({},c),opts:p.extend(!0,{specialEasing:{},easing:p.easing._default},d),originalProperties:c,originalOptions:d,startTime:ab||K(),duration:d.duration,tweens:[],createTween:function(c,d){var e=p.Tween(b,l.opts,c,d,l.opts.specialEasing[c]||l.opts.easing);return l.tweens.push(e),e},stop:function(c){var d=0,e=c?l.tweens.length:0;if(j)return this;for(j=!0;d<e;d++)l.tweens[d].run(1);return c?(n.notifyWith(b,[l,1,0]),n.resolveWith(b,[l,c])):n.rejectWith(b,
[l,c]),this}});c=l.props;d=l.opts.specialEasing;var q,m,s,t;for(e in c)if(q=p.camelCase(e),m=d[q],s=c[e],Array.isArray(s)&&(m=s[1],s=c[e]=s[0]),e!==q&&(c[q]=s,delete c[e]),t=p.cssHooks[q],t&&"expand"in t)for(e in s=t.expand(s),delete c[q],s)e in c||(c[e]=s[e],d[e]=m);else d[q]=m;for(;f<g;f++)if(e=Z.prefilters[f].call(l,b,c,l.opts))return p.isFunction(e.stop)&&(p._queueHooks(l.elem,l.opts.queue).stop=p.proxy(e.stop,e)),e;return p.map(c,Y,l),p.isFunction(l.opts.start)&&l.opts.start.call(b,l),l.progress(l.opts.progress).done(l.opts.done,
l.opts.complete).fail(l.opts.fail).always(l.opts.always),p.fx.timer(p.extend(r,{elem:b,anim:l,queue:l.opts.queue})),l}function ka(b){return(b.match(sa)||[]).join(" ")}function oa(b){return b.getAttribute&&b.getAttribute("class")||""}function ea(b,c,d,e){var j;if(Array.isArray(c))p.each(c,function(c,j){d||Nc.test(b)?e(b,j):ea(b+"["+("object"==typeof j&&null!=j?c:"")+"]",j,d,e)});else if(d||"object"!==p.type(c))e(b,c);else for(j in c)ea(b+"["+j+"]",c[j],d,e)}function ma(b){return function(c,d){"string"!=
typeof c&&(d=c,c="*");var e,j=0,f=c.toLowerCase().match(sa)||[];if(p.isFunction(d))for(;e=f[j++];)"+"===e[0]?(e=e.slice(1)||"*",(b[e]=b[e]||[]).unshift(d)):(b[e]=b[e]||[]).push(d)}}function H(b,c,d,e){function j(n){var r;return f[n]=!0,p.each(b[n]||[],function(b,ia){var n=ia(c,d,e);return"string"!=typeof n||g||f[n]?g?!(r=n):void 0:(c.dataTypes.unshift(n),j(n),!1)}),r}var f={},g=b===Jb;return j(c.dataTypes[0])||!f["*"]&&j("*")}function ta(b,c){var d,e,j=p.ajaxSettings.flatOptions||{};for(d in c)void 0!==
c[d]&&((j[d]?b:e||(e={}))[d]=c[d]);return e&&p.extend(!0,b,e),b}var ba=[],M=b.document,Wa=Object.getPrototypeOf,na=ba.slice,Ha=ba.concat,Na=ba.push,Ua=ba.indexOf,bb={},ub=bb.toString,cb=bb.hasOwnProperty,vb=cb.toString,Kb=vb.call(Object),aa={},p=function(b,c){return new p.fn.init(b,c)},Lb=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Mb=/^-ms-/,Ca=/-([a-z])/g,Ia=function(b,c){return c.toUpperCase()};p.fn=p.prototype={jquery:"3.2.1",constructor:p,length:0,toArray:function(){return na.call(this)},get:function(b){return null==
b?na.call(this):0>b?this[b+this.length]:this[b]},pushStack:function(b){b=p.merge(this.constructor(),b);return b.prevObject=this,b},each:function(b){return p.each(this,b)},map:function(b){return this.pushStack(p.map(this,function(c,d){return b.call(c,d,c)}))},slice:function(){return this.pushStack(na.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(b){var c=this.length;b=+b+(0>b?c:0);return this.pushStack(0<=b&&b<c?[this[b]]:[])},end:function(){return this.prevObject||
this.constructor()},push:Na,sort:ba.sort,splice:ba.splice};p.extend=p.fn.extend=function(){var b,c,d,e,j,f,g=arguments[0]||{},n=1,r=arguments.length,l=!1;"boolean"==typeof g&&(l=g,g=arguments[n]||{},n++);"object"==typeof g||p.isFunction(g)||(g={});for(n===r&&(g=this,n--);n<r;n++)if(null!=(b=arguments[n]))for(c in b)d=g[c],e=b[c],g!==e&&(l&&e&&(p.isPlainObject(e)||(j=Array.isArray(e)))?(j?(j=!1,f=d&&Array.isArray(d)?d:[]):f=d&&p.isPlainObject(d)?d:{},g[c]=p.extend(l,f,e)):void 0!==e&&(g[c]=e));return g};
p.extend({expando:"jQuery"+("3.2.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(b){throw Error(b);},noop:function(){},isFunction:function(b){return"function"===p.type(b)},isWindow:function(b){return null!=b&&b===b.window},isNumeric:function(b){var c=p.type(b);return("number"===c||"string"===c)&&!isNaN(b-parseFloat(b))},isPlainObject:function(b){var c,d;return!(!b||"[object Object]"!==ub.call(b))&&(!(c=Wa(b))||(d=cb.call(c,"constructor")&&c.constructor,"function"==typeof d&&vb.call(d)===
Kb))},isEmptyObject:function(b){for(var c in b)return!1;return!0},type:function(b){return null==b?b+"":"object"==typeof b||"function"==typeof b?bb[ub.call(b)]||"object":typeof b},globalEval:function(b){e(b)},camelCase:function(b){return b.replace(Mb,"ms-").replace(Ca,Ia)},each:function(b,c){var e,j=0;if(d(b))for(e=b.length;j<e&&!1!==c.call(b[j],j,b[j]);j++);else for(j in b)if(!1===c.call(b[j],j,b[j]))break;return b},trim:function(b){return null==b?"":(b+"").replace(Lb,"")},makeArray:function(b,c){var e=
c||[];return null!=b&&(d(Object(b))?p.merge(e,"string"==typeof b?[b]:b):Na.call(e,b)),e},inArray:function(b,c,d){return null==c?-1:Ua.call(c,b,d)},merge:function(b,c){for(var d=+c.length,e=0,j=b.length;e<d;e++)b[j++]=c[e];return b.length=j,b},grep:function(b,c,d){for(var e=[],j=0,f=b.length,g=!d;j<f;j++)d=!c(b[j],j),d!==g&&e.push(b[j]);return e},map:function(b,c,e){var j,f,g=0,n=[];if(d(b))for(j=b.length;g<j;g++)f=c(b[g],g,e),null!=f&&n.push(f);else for(g in b)f=c(b[g],g,e),null!=f&&n.push(f);return Ha.apply([],
n)},guid:1,proxy:function(b,c){var d,e,j;if("string"==typeof c&&(d=b[c],c=b,b=d),p.isFunction(b))return e=na.call(arguments,2),j=function(){return b.apply(c||this,e.concat(na.call(arguments)))},j.guid=b.guid=b.guid||p.guid++,j},now:Date.now,support:aa});"function"==typeof Symbol&&(p.fn[Symbol.iterator]=ba[Symbol.iterator]);p.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(b,c){bb["[object "+c+"]"]=c.toLowerCase()});var ua,kb=b,X=function(b,c,d,e){var j,
f,g,n,r,l=c&&c.ownerDocument,q=c?c.nodeType:9;if(d=d||[],"string"!=typeof b||!b||1!==q&&9!==q&&11!==q)return d;if(!e&&((c?c.ownerDocument||c:va)!==W&&Oa(c),c=c||W,wa)){if(11!==q&&(n=Oc.exec(b)))if(j=n[1])if(9===q){if(!(f=c.getElementById(j)))return d;if(f.id===j)return d.push(f),d}else{if(l&&(f=l.getElementById(j))&&lb(c,f)&&f.id===j)return d.push(f),d}else{if(n[2])return Pa.apply(d,c.getElementsByTagName(b)),d;if((j=n[3])&&fa.getElementsByClassName&&c.getElementsByClassName)return Pa.apply(d,c.getElementsByClassName(j)),
d}if(fa.qsa&&!wb[b+" "]&&(!la||!la.test(b))){if(1!==q)l=c,r=b;else if("object"!==c.nodeName.toLowerCase()){(g=c.getAttribute("id"))?g=g.replace(ac,bc):c.setAttribute("id",g=ca);f=mb(b);for(j=f.length;j--;)f[j]="#"+g+" "+ya(f[j]);r=f.join(",");l=Nb.test(b)&&Da(c.parentNode)||c}if(r)try{return Pa.apply(d,l.querySelectorAll(r)),d}catch(s){}finally{g===ca&&c.removeAttribute("id")}}}return cc(b.replace(xb,"$1"),c,d,e)},Qa=function(){function b(d,e){return c.push(d+" ")>Q.cacheLength&&delete b[c.shift()],
b[d+" "]=e}var c=[];return b},ja=function(b){return b[ca]=!0,b},qa=function(b){var c=W.createElement("fieldset");try{return!!b(c)}catch(d){return!1}finally{c.parentNode&&c.parentNode.removeChild(c)}},Ra=function(b,c){for(var d=b.split("|"),e=d.length;e--;)Q.attrHandle[d[e]]=c},Ja=function(b,c){var d=c&&b,e=d&&1===b.nodeType&&1===c.nodeType&&b.sourceIndex-c.sourceIndex;if(e)return e;if(d)for(;d=d.nextSibling;)if(d===c)return-1;return b?1:-1},yb=function(b){return function(c){return"input"===c.nodeName.toLowerCase()&&
c.type===b}},Sa=function(b){return function(c){var d=c.nodeName.toLowerCase();return("input"===d||"button"===d)&&c.type===b}},db=function(b){return function(c){return"form"in c?c.parentNode&&!1===c.disabled?"label"in c?"label"in c.parentNode?c.parentNode.disabled===b:c.disabled===b:c.isDisabled===b||c.isDisabled!==!b&&Pc(c)===b:c.disabled===b:"label"in c&&c.disabled===b}},Ea=function(b){return ja(function(c){return c=+c,ja(function(d,e){for(var j,f=b([],d.length,c),g=f.length;g--;)d[j=f[g]]&&(d[j]=
!(e[j]=d[j]))})})},Da=function(b){return b&&"undefined"!=typeof b.getElementsByTagName&&b},Fa=function(){},ya=function(b){for(var c=0,d=b.length,e="";c<d;c++)e+=b[c].value;return e},Xa=function(b,c,d){var e=c.dir,j=c.next,f=j||e,g=d&&"parentNode"===f,n=Qc++;return c.first?function(c,d,j){for(;c=c[e];)if(1===c.nodeType||g)return b(c,d,j);return!1}:function(c,d,r){var l,q,ga,s=[Ga,n];if(r)for(;c=c[e];){if((1===c.nodeType||g)&&b(c,d,r))return!0}else for(;c=c[e];)if(1===c.nodeType||g)if(ga=c[ca]||(c[ca]=
{}),q=ga[c.uniqueID]||(ga[c.uniqueID]={}),j&&j===c.nodeName.toLowerCase())c=c[e]||c;else{if((l=q[f])&&l[0]===Ga&&l[1]===n)return s[2]=l[2];if(q[f]=s,s[2]=b(c,d,r))return!0}return!1}},za=function(b){return 1<b.length?function(c,d,e){for(var j=b.length;j--;)if(!b[j](c,d,e))return!1;return!0}:b[0]},Aa=function(b,c,d,e,j){for(var f,g=[],n=0,r=b.length,l=null!=c;n<r;n++)(f=b[n])&&(d&&!d(f,e,j)||(g.push(f),l&&c.push(n)));return g},U=function(b,c,d,e,j,f){return e&&!e[ca]&&(e=U(e)),j&&!j[ca]&&(j=U(j,f)),
ja(function(f,g,n,r){var l,q,s=[],m=[],t=g.length,p;if(!(p=f)){p=c||"*";for(var u=n.nodeType?[n]:n,H=[],v=0,x=u.length;v<x;v++)X(p,u[v],H);p=H}p=!b||!f&&c?p:Aa(p,s,b,n,r);u=d?j||(f?b:t||e)?[]:g:p;if(d&&d(p,u,n,r),e){l=Aa(u,m);e(l,[],n,r);for(n=l.length;n--;)(q=l[n])&&(u[m[n]]=!(p[m[n]]=q))}if(f){if(j||b){if(j){l=[];for(n=u.length;n--;)(q=u[n])&&l.push(p[n]=q);j(null,u=[],l,r)}for(n=u.length;n--;)(q=u[n])&&-1<(l=j?Ya(f,q):s[n])&&(f[l]=!(g[l]=q))}}else u=Aa(u===g?u.splice(t,u.length):u),j?j(null,g,
u,r):Pa.apply(g,u)})},Ob=function(b){var c,d,e,j=b.length,f=Q.relative[b[0].type];d=f||Q.relative[" "];for(var g=f?1:0,n=Xa(function(b){return b===c},d,!0),r=Xa(function(b){return-1<Ya(c,b)},d,!0),l=[function(b,d,e){b=!f&&(e||d!==eb)||((c=d).nodeType?n(b,d,e):r(b,d,e));return c=null,b}];g<j;g++)if(d=Q.relative[b[g].type])l=[Xa(za(l),d)];else{if(d=Q.filter[b[g].type].apply(null,b[g].matches),d[ca]){for(e=++g;e<j&&!Q.relative[b[e].type];e++);return U(1<g&&za(l),1<g&&ya(b.slice(0,g-1).concat({value:" "===
b[g-2].type?"*":""})).replace(xb,"$1"),d,g<e&&Ob(b.slice(g,e)),e<j&&Ob(b=b.slice(e)),e<j&&ya(b))}l.push(d)}return za(l)},fb,fa,Q,zb,dc,mb,Pb,cc,eb,Ta,gb,Oa,W,xa,wa,la,Za,Ab,lb,ca="sizzle"+1*new Date,va=kb.document,Ga=0,Qc=0,ec=Qa(),fc=Qa(),wb=Qa(),Qb=function(b,c){return b===c&&(gb=!0),0},Rc={}.hasOwnProperty,$a=[],Sc=$a.pop,Tc=$a.push,Pa=$a.push,gc=$a.slice,Ya=function(b,c){for(var d=0,e=b.length;d<e;d++)if(b[d]===c)return d;return-1},Uc=/[\x20\t\r\n\f]+/g,xb=/^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g,
Vc=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,Wc=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,Xc=/=[\x20\t\r\n\f]*([^\]'"]*?)[\x20\t\r\n\f]*\]/g,Yc=RegExp(":((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),
Zc=/^(?:\\.|[\w-]|[^\x00-\xa0])+$/,Bb={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:/^((?:\\.|[\w-]|[^\x00-\xa0])+|[*])/,ATTR:RegExp("^\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\]"),PSEUDO:RegExp("^:((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),
CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)",
"i")},$c=/^(?:input|select|textarea|button)$/i,ad=/^h\d$/i,nb=/^[^{]+\{\s*\[native \w/,Oc=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Nb=/[+~]/,Ka=/\\([\da-f]{1,6}[\x20\t\r\n\f]?|([\x20\t\r\n\f])|.)/ig,La=function(b,c,d){b="0x"+c-65536;return b!==b||d?c:0>b?String.fromCharCode(b+65536):String.fromCharCode(b>>10|55296,1023&b|56320)},ac=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,bc=function(b,c){return c?"\x00"===b?"\ufffd":b.slice(0,-1)+"\\"+b.charCodeAt(b.length-1).toString(16)+" ":"\\"+b},hc=function(){Oa()},
Pc=Xa(function(b){return!0===b.disabled&&("form"in b||"label"in b)},{dir:"parentNode",next:"legend"});try{Pa.apply($a=gc.call(va.childNodes),va.childNodes),$a[va.childNodes.length].nodeType}catch(Dd){Pa={apply:$a.length?function(b,c){Tc.apply(b,gc.call(c))}:function(b,c){for(var d=b.length,e=0;b[d++]=c[e++];);b.length=d-1}}}fa=X.support={};dc=X.isXML=function(b){b=b&&(b.ownerDocument||b).documentElement;return!!b&&"HTML"!==b.nodeName};Oa=X.setDocument=function(b){var c,d;b=b?b.ownerDocument||b:va;
return b!==W&&9===b.nodeType&&b.documentElement?(W=b,xa=W.documentElement,wa=!dc(W),va!==W&&(d=W.defaultView)&&d.top!==d&&(d.addEventListener?d.addEventListener("unload",hc,!1):d.attachEvent&&d.attachEvent("onunload",hc)),fa.attributes=qa(function(b){return b.className="i",!b.getAttribute("className")}),fa.getElementsByTagName=qa(function(b){return b.appendChild(W.createComment("")),!b.getElementsByTagName("*").length}),fa.getElementsByClassName=nb.test(W.getElementsByClassName),fa.getById=qa(function(b){return xa.appendChild(b).id=
ca,!W.getElementsByName||!W.getElementsByName(ca).length}),fa.getById?(Q.filter.ID=function(b){var c=b.replace(Ka,La);return function(b){return b.getAttribute("id")===c}},Q.find.ID=function(b,c){if("undefined"!=typeof c.getElementById&&wa){var d=c.getElementById(b);return d?[d]:[]}}):(Q.filter.ID=function(b){var c=b.replace(Ka,La);return function(b){return(b="undefined"!=typeof b.getAttributeNode&&b.getAttributeNode("id"))&&b.value===c}},Q.find.ID=function(b,c){if("undefined"!=typeof c.getElementById&&
wa){var d,e,j,f=c.getElementById(b);if(f){if(d=f.getAttributeNode("id"),d&&d.value===b)return[f];j=c.getElementsByName(b);for(e=0;f=j[e++];)if(d=f.getAttributeNode("id"),d&&d.value===b)return[f]}return[]}}),Q.find.TAG=fa.getElementsByTagName?function(b,c){return"undefined"!=typeof c.getElementsByTagName?c.getElementsByTagName(b):fa.qsa?c.querySelectorAll(b):void 0}:function(b,c){var d,e=[],j=0,f=c.getElementsByTagName(b);if("*"===b){for(;d=f[j++];)1===d.nodeType&&e.push(d);return e}return f},Q.find.CLASS=
fa.getElementsByClassName&&function(b,c){if("undefined"!=typeof c.getElementsByClassName&&wa)return c.getElementsByClassName(b)},Za=[],la=[],(fa.qsa=nb.test(W.querySelectorAll))&&(qa(function(b){xa.appendChild(b).innerHTML="<a id='"+ca+"'></a><select id='"+ca+"-\r\\' msallowcapture=''><option selected=''></option></select>";b.querySelectorAll("[msallowcapture^='']").length&&la.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");b.querySelectorAll("[selected]").length||la.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");
b.querySelectorAll("[id~="+ca+"-]").length||la.push("~=");b.querySelectorAll(":checked").length||la.push(":checked");b.querySelectorAll("a#"+ca+"+*").length||la.push(".#.+[+~]")}),qa(function(b){b.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var c=W.createElement("input");c.setAttribute("type","hidden");b.appendChild(c).setAttribute("name","D");b.querySelectorAll("[name=d]").length&&la.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?=");2!==b.querySelectorAll(":enabled").length&&
la.push(":enabled",":disabled");xa.appendChild(b).disabled=!0;2!==b.querySelectorAll(":disabled").length&&la.push(":enabled",":disabled");b.querySelectorAll("*,:x");la.push(",.*:")})),(fa.matchesSelector=nb.test(Ab=xa.matches||xa.webkitMatchesSelector||xa.mozMatchesSelector||xa.oMatchesSelector||xa.msMatchesSelector))&&qa(function(b){fa.disconnectedMatch=Ab.call(b,"*");Ab.call(b,"[s!='']:x");Za.push("!=",":((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)")}),
la=la.length&&RegExp(la.join("|")),Za=Za.length&&RegExp(Za.join("|")),c=nb.test(xa.compareDocumentPosition),lb=c||nb.test(xa.contains)?function(b,c){var d=9===b.nodeType?b.documentElement:b,e=c&&c.parentNode;return b===e||!(!e||1!==e.nodeType||!(d.contains?d.contains(e):b.compareDocumentPosition&&16&b.compareDocumentPosition(e)))}:function(b,c){if(c)for(;c=c.parentNode;)if(c===b)return!0;return!1},Qb=c?function(b,c){if(b===c)return gb=!0,0;var d=!b.compareDocumentPosition-!c.compareDocumentPosition;
return d?d:(d=(b.ownerDocument||b)===(c.ownerDocument||c)?b.compareDocumentPosition(c):1,1&d||!fa.sortDetached&&c.compareDocumentPosition(b)===d?b===W||b.ownerDocument===va&&lb(va,b)?-1:c===W||c.ownerDocument===va&&lb(va,c)?1:Ta?Ya(Ta,b)-Ya(Ta,c):0:4&d?-1:1)}:function(b,c){if(b===c)return gb=!0,0;var d,e=0;d=b.parentNode;var j=c.parentNode,f=[b],g=[c];if(!d||!j)return b===W?-1:c===W?1:d?-1:j?1:Ta?Ya(Ta,b)-Ya(Ta,c):0;if(d===j)return Ja(b,c);for(d=b;d=d.parentNode;)f.unshift(d);for(d=c;d=d.parentNode;)g.unshift(d);
for(;f[e]===g[e];)e++;return e?Ja(f[e],g[e]):f[e]===va?-1:g[e]===va?1:0},W):W};X.matches=function(b,c){return X(b,null,null,c)};X.matchesSelector=function(b,c){if((b.ownerDocument||b)!==W&&Oa(b),c=c.replace(Xc,"='$1']"),fa.matchesSelector&&wa&&!wb[c+" "]&&(!Za||!Za.test(c))&&(!la||!la.test(c)))try{var d=Ab.call(b,c);if(d||fa.disconnectedMatch||b.document&&11!==b.document.nodeType)return d}catch(e){}return 0<X(c,W,null,[b]).length};X.contains=function(b,c){return(b.ownerDocument||b)!==W&&Oa(b),lb(b,
c)};X.attr=function(b,c){(b.ownerDocument||b)!==W&&Oa(b);var d=Q.attrHandle[c.toLowerCase()],d=d&&Rc.call(Q.attrHandle,c.toLowerCase())?d(b,c,!wa):void 0;return void 0!==d?d:fa.attributes||!wa?b.getAttribute(c):(d=b.getAttributeNode(c))&&d.specified?d.value:null};X.escape=function(b){return(b+"").replace(ac,bc)};X.error=function(b){throw Error("Syntax error, unrecognized expression: "+b);};X.uniqueSort=function(b){var c,d=[],e=0,j=0;if(gb=!fa.detectDuplicates,Ta=!fa.sortStable&&b.slice(0),b.sort(Qb),
gb){for(;c=b[j++];)c===b[j]&&(e=d.push(j));for(;e--;)b.splice(d[e],1)}return Ta=null,b};zb=X.getText=function(b){var c,d="",e=0;if(c=b.nodeType)if(1===c||9===c||11===c){if("string"==typeof b.textContent)return b.textContent;for(b=b.firstChild;b;b=b.nextSibling)d+=zb(b)}else{if(3===c||4===c)return b.nodeValue}else for(;c=b[e++];)d+=zb(c);return d};Q=X.selectors={cacheLength:50,createPseudo:ja,match:Bb,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",
first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(b){return b[1]=b[1].replace(Ka,La),b[3]=(b[3]||b[4]||b[5]||"").replace(Ka,La),"~="===b[2]&&(b[3]=" "+b[3]+" "),b.slice(0,4)},CHILD:function(b){return b[1]=b[1].toLowerCase(),"nth"===b[1].slice(0,3)?(b[3]||X.error(b[0]),b[4]=+(b[4]?b[5]+(b[6]||1):2*("even"===b[3]||"odd"===b[3])),b[5]=+(b[7]+b[8]||"odd"===b[3])):b[3]&&X.error(b[0]),b},PSEUDO:function(b){var c,d=!b[6]&&b[2];return Bb.CHILD.test(b[0])?null:(b[3]?b[2]=b[4]||b[5]||"":d&&Yc.test(d)&&
(c=mb(d,!0))&&(c=d.indexOf(")",d.length-c)-d.length)&&(b[0]=b[0].slice(0,c),b[2]=d.slice(0,c)),b.slice(0,3))}},filter:{TAG:function(b){var c=b.replace(Ka,La).toLowerCase();return"*"===b?function(){return!0}:function(b){return b.nodeName&&b.nodeName.toLowerCase()===c}},CLASS:function(b){var c=ec[b+" "];return c||(c=RegExp("(^|[\\x20\\t\\r\\n\\f])"+b+"([\\x20\\t\\r\\n\\f]|$)"))&&ec(b,function(b){return c.test("string"==typeof b.className&&b.className||"undefined"!=typeof b.getAttribute&&b.getAttribute("class")||
"")})},ATTR:function(b,c,d){return function(e){e=X.attr(e,b);return null==e?"!="===c:!c||(e+="","="===c?e===d:"!="===c?e!==d:"^="===c?d&&0===e.indexOf(d):"*="===c?d&&-1<e.indexOf(d):"$="===c?d&&e.slice(-d.length)===d:"~="===c?-1<(" "+e.replace(Uc," ")+" ").indexOf(d):"|="===c&&(e===d||e.slice(0,d.length+1)===d+"-"))}},CHILD:function(b,c,d,e,j){var f="nth"!==b.slice(0,3),g="last"!==b.slice(-4),n="of-type"===c;return 1===e&&0===j?function(b){return!!b.parentNode}:function(c,d,r){var l,q,s,m,ga,t;d=
f!==g?"nextSibling":"previousSibling";var u=c.parentNode,p=n&&c.nodeName.toLowerCase();r=!r&&!n;var H=!1;if(u){if(f){for(;d;){for(m=c;m=m[d];)if(n?m.nodeName.toLowerCase()===p:1===m.nodeType)return!1;t=d="only"===b&&!t&&"nextSibling"}return!0}if(t=[g?u.firstChild:u.lastChild],g&&r){m=u;s=m[ca]||(m[ca]={});q=s[m.uniqueID]||(s[m.uniqueID]={});l=q[b]||[];H=(ga=l[0]===Ga&&l[1])&&l[2];for(m=ga&&u.childNodes[ga];m=++ga&&m&&m[d]||(H=ga=0)||t.pop();)if(1===m.nodeType&&++H&&m===c){q[b]=[Ga,ga,H];break}}else if(r&&
(m=c,s=m[ca]||(m[ca]={}),q=s[m.uniqueID]||(s[m.uniqueID]={}),l=q[b]||[],ga=l[0]===Ga&&l[1],H=ga),!1===H)for(;(m=++ga&&m&&m[d]||(H=ga=0)||t.pop())&&(!(n?m.nodeName.toLowerCase()===p:1===m.nodeType)||!++H||!(r&&(s=m[ca]||(m[ca]={}),q=s[m.uniqueID]||(s[m.uniqueID]={}),q[b]=[Ga,H]),m===c)););return H-=j,H===e||0===H%e&&0<=H/e}}},PSEUDO:function(b,c){var d,e=Q.pseudos[b]||Q.setFilters[b.toLowerCase()]||X.error("unsupported pseudo: "+b);return e[ca]?e(c):1<e.length?(d=[b,b,"",c],Q.setFilters.hasOwnProperty(b.toLowerCase())?
ja(function(b,d){for(var j,f=e(b,c),g=f.length;g--;)j=Ya(b,f[g]),b[j]=!(d[j]=f[g])}):function(b){return e(b,0,d)}):e}},pseudos:{not:ja(function(b){var c=[],d=[],e=Pb(b.replace(xb,"$1"));return e[ca]?ja(function(b,c,d,j){var f;d=e(b,null,j,[]);for(j=b.length;j--;)(f=d[j])&&(b[j]=!(c[j]=f))}):function(b,j,f){return c[0]=b,e(c,null,f,d),c[0]=null,!d.pop()}}),has:ja(function(b){return function(c){return 0<X(b,c).length}}),contains:ja(function(b){return b=b.replace(Ka,La),function(c){return-1<(c.textContent||
c.innerText||zb(c)).indexOf(b)}}),lang:ja(function(b){return Zc.test(b||"")||X.error("unsupported lang: "+b),b=b.replace(Ka,La).toLowerCase(),function(c){var d;do if(d=wa?c.lang:c.getAttribute("xml:lang")||c.getAttribute("lang"))return d=d.toLowerCase(),d===b||0===d.indexOf(b+"-");while((c=c.parentNode)&&1===c.nodeType);return!1}}),target:function(b){var c=kb.location&&kb.location.hash;return c&&c.slice(1)===b.id},root:function(b){return b===xa},focus:function(b){return b===W.activeElement&&(!W.hasFocus||
W.hasFocus())&&!(!b.type&&!b.href&&!~b.tabIndex)},enabled:db(!1),disabled:db(!0),checked:function(b){var c=b.nodeName.toLowerCase();return"input"===c&&!!b.checked||"option"===c&&!!b.selected},selected:function(b){return b.parentNode&&b.parentNode.selectedIndex,!0===b.selected},empty:function(b){for(b=b.firstChild;b;b=b.nextSibling)if(6>b.nodeType)return!1;return!0},parent:function(b){return!Q.pseudos.empty(b)},header:function(b){return ad.test(b.nodeName)},input:function(b){return $c.test(b.nodeName)},
button:function(b){var c=b.nodeName.toLowerCase();return"input"===c&&"button"===b.type||"button"===c},text:function(b){var c;return"input"===b.nodeName.toLowerCase()&&"text"===b.type&&(null==(c=b.getAttribute("type"))||"text"===c.toLowerCase())},first:Ea(function(){return[0]}),last:Ea(function(b,c){return[c-1]}),eq:Ea(function(b,c,d){return[0>d?d+c:d]}),even:Ea(function(b,c){for(var d=0;d<c;d+=2)b.push(d);return b}),odd:Ea(function(b,c){for(var d=1;d<c;d+=2)b.push(d);return b}),lt:Ea(function(b,c,
d){for(c=0>d?d+c:d;0<=--c;)b.push(c);return b}),gt:Ea(function(b,c,d){for(d=0>d?d+c:d;++d<c;)b.push(d);return b})}};Q.pseudos.nth=Q.pseudos.eq;for(fb in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Q.pseudos[fb]=yb(fb);for(fb in{submit:!0,reset:!0})Q.pseudos[fb]=Sa(fb);Fa.prototype=Q.filters=Q.pseudos;Q.setFilters=new Fa;mb=X.tokenize=function(b,c){var d,e,j,f,g,n,r;if(g=fc[b+" "])return c?0:g.slice(0);g=b;n=[];for(r=Q.preFilter;g;){d&&!(e=Vc.exec(g))||(e&&(g=g.slice(e[0].length)||g),n.push(j=
[]));d=!1;(e=Wc.exec(g))&&(d=e.shift(),j.push({value:d,type:e[0].replace(xb," ")}),g=g.slice(d.length));for(f in Q.filter)!(e=Bb[f].exec(g))||r[f]&&!(e=r[f](e))||(d=e.shift(),j.push({value:d,type:f,matches:e}),g=g.slice(d.length));if(!d)break}return c?g.length:g?X.error(b):fc(b,n).slice(0)};ua=(Pb=X.compile=function(b,c){var d,e=[],j=[],f=wb[b+" "];if(!f){c||(c=mb(b));for(d=c.length;d--;)f=Ob(c[d]),f[ca]?e.push(f):j.push(f);d=wb;var g=0<e.length,n=0<j.length,f=function(b,c,d,f,r){var l,ia,q,m=0,s=
"0",t=b&&[],ga=[],u=eb,p=b||n&&Q.find.TAG("*",r),H=Ga+=null==u?1:Math.random()||0.1,v=p.length;for(r&&(eb=c===W||c||r);s!==v&&null!=(l=p[s]);s++){if(n&&l){ia=0;for(c||l.ownerDocument===W||(Oa(l),d=!wa);q=j[ia++];)if(q(l,c||W,d)){f.push(l);break}r&&(Ga=H)}g&&((l=!q&&l)&&m--,b&&t.push(l))}if(m+=s,g&&s!==m){for(ia=0;q=e[ia++];)q(t,ga,c,d);if(b){if(0<m)for(;s--;)t[s]||ga[s]||(ga[s]=Sc.call(f));ga=Aa(ga)}Pa.apply(f,ga);r&&!b&&0<ga.length&&1<m+e.length&&X.uniqueSort(f)}return r&&(Ga=H,eb=u),t},f=g?ja(f):
f,f=d(b,f);f.selector=b}return f},cc=X.select=function(b,c,d,e){var j,f,g,n,r,l="function"==typeof b&&b,q=!e&&mb(b=l.selector||b);if(d=d||[],1===q.length){if(f=q[0]=q[0].slice(0),2<f.length&&"ID"===(g=f[0]).type&&9===c.nodeType&&wa&&Q.relative[f[1].type]){if(c=(Q.find.ID(g.matches[0].replace(Ka,La),c)||[])[0],!c)return d;l&&(c=c.parentNode);b=b.slice(f.shift().value.length)}for(j=Bb.needsContext.test(b)?0:f.length;j--&&!(g=f[j],Q.relative[n=g.type]);)if((r=Q.find[n])&&(e=r(g.matches[0].replace(Ka,
La),Nb.test(f[0].type)&&Da(c.parentNode)||c))){if(f.splice(j,1),b=e.length&&ya(f),!b)return Pa.apply(d,e),d;break}}return(l||Pb(b,q))(e,c,!wa,d,!c||Nb.test(b)&&Da(c.parentNode)||c),d},fa.sortStable=ca.split("").sort(Qb).join("")===ca,fa.detectDuplicates=!!gb,Oa(),fa.sortDetached=qa(function(b){return 1&b.compareDocumentPosition(W.createElement("fieldset"))}),qa(function(b){return b.innerHTML="<a href='#'></a>","#"===b.firstChild.getAttribute("href")})||Ra("type|href|height|width",function(b,c,d){if(!d)return b.getAttribute(c,
"type"===c.toLowerCase()?1:2)}),fa.attributes&&qa(function(b){return b.innerHTML="<input/>",b.firstChild.setAttribute("value",""),""===b.firstChild.getAttribute("value")})||Ra("value",function(b,c,d){if(!d&&"input"===b.nodeName.toLowerCase())return b.defaultValue}),qa(function(b){return null==b.getAttribute("disabled")})||Ra("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(b,c,d){var e;if(!d)return!0===b[c]?c.toLowerCase():
(e=b.getAttributeNode(c))&&e.specified?e.value:null}),X);p.find=ua;p.expr=ua.selectors;p.expr[":"]=p.expr.pseudos;p.uniqueSort=p.unique=ua.uniqueSort;p.text=ua.getText;p.isXMLDoc=ua.isXML;p.contains=ua.contains;p.escapeSelector=ua.escape;var hb=function(b,c,d){for(var e=[],j=void 0!==d;(b=b[c])&&9!==b.nodeType;)if(1===b.nodeType){if(j&&p(b).is(d))break;e.push(b)}return e},ic=function(b,c){for(var d=[];b;b=b.nextSibling)1===b.nodeType&&b!==c&&d.push(b);return d},jc=p.expr.match.needsContext,kc=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,
Fc=/^.[^:#\[\.,]*$/;p.filter=function(b,c,d){var e=c[0];return d&&(b=":not("+b+")"),1===c.length&&1===e.nodeType?p.find.matchesSelector(e,b)?[e]:[]:p.find.matches(b,p.grep(c,function(b){return 1===b.nodeType}))};p.fn.extend({find:function(b){var c,d,e=this.length,j=this;if("string"!=typeof b)return this.pushStack(p(b).filter(function(){for(c=0;c<e;c++)if(p.contains(j[c],this))return!0}));d=this.pushStack([]);for(c=0;c<e;c++)p.find(b,j[c],d);return 1<e?p.uniqueSort(d):d},filter:function(b){return this.pushStack(f(this,
b||[],!1))},not:function(b){return this.pushStack(f(this,b||[],!0))},is:function(b){return!!f(this,"string"==typeof b&&jc.test(b)?p(b):b||[],!1).length}});var lc,bd=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(p.fn.init=function(b,c,d){var e,j;if(!b)return this;if(d=d||lc,"string"==typeof b){if(e="<"===b[0]&&">"===b[b.length-1]&&3<=b.length?[null,b,null]:bd.exec(b),!e||!e[1]&&c)return!c||c.jquery?(c||d).find(b):this.constructor(c).find(b);if(e[1]){if(c=c instanceof p?c[0]:c,p.merge(this,p.parseHTML(e[1],
c&&c.nodeType?c.ownerDocument||c:M,!0)),kc.test(e[1])&&p.isPlainObject(c))for(e in c)p.isFunction(this[e])?this[e](c[e]):this.attr(e,c[e]);return this}return j=M.getElementById(e[2]),j&&(this[0]=j,this.length=1),this}return b.nodeType?(this[0]=b,this.length=1,this):p.isFunction(b)?void 0!==d.ready?d.ready(b):b(p):p.makeArray(b,this)}).prototype=p.fn;lc=p(M);var cd=/^(?:parents|prev(?:Until|All))/,dd={children:!0,contents:!0,next:!0,prev:!0};p.fn.extend({has:function(b){var c=p(b,this),d=c.length;
return this.filter(function(){for(var b=0;b<d;b++)if(p.contains(this,c[b]))return!0})},closest:function(b,c){var d,e=0,j=this.length,f=[],g="string"!=typeof b&&p(b);if(!jc.test(b))for(;e<j;e++)for(d=this[e];d&&d!==c;d=d.parentNode)if(11>d.nodeType&&(g?-1<g.index(d):1===d.nodeType&&p.find.matchesSelector(d,b))){f.push(d);break}return this.pushStack(1<f.length?p.uniqueSort(f):f)},index:function(b){return b?"string"==typeof b?Ua.call(p(b),this[0]):Ua.call(this,b.jquery?b[0]:b):this[0]&&this[0].parentNode?
this.first().prevAll().length:-1},add:function(b,c){return this.pushStack(p.uniqueSort(p.merge(this.get(),p(b,c))))},addBack:function(b){return this.add(null==b?this.prevObject:this.prevObject.filter(b))}});p.each({parent:function(b){return(b=b.parentNode)&&11!==b.nodeType?b:null},parents:function(b){return hb(b,"parentNode")},parentsUntil:function(b,c,d){return hb(b,"parentNode",d)},next:function(b){return m(b,"nextSibling")},prev:function(b){return m(b,"previousSibling")},nextAll:function(b){return hb(b,
"nextSibling")},prevAll:function(b){return hb(b,"previousSibling")},nextUntil:function(b,c,d){return hb(b,"nextSibling",d)},prevUntil:function(b,c,d){return hb(b,"previousSibling",d)},siblings:function(b){return ic((b.parentNode||{}).firstChild,b)},children:function(b){return ic(b.firstChild)},contents:function(b){return g(b,"iframe")?b.contentDocument:(g(b,"template")&&(b=b.content||b),p.merge([],b.childNodes))}},function(b,c){p.fn[b]=function(d,e){var j=p.map(this,c,d);return"Until"!==b.slice(-5)&&
(e=d),e&&"string"==typeof e&&(j=p.filter(e,j)),1<this.length&&(dd[b]||p.uniqueSort(j),cd.test(b)&&j.reverse()),this.pushStack(j)}});var sa=/[^\x20\t\r\n\f]+/g;p.Callbacks=function(b){var c;if("string"==typeof b){var d={};c=(p.each(b.match(sa)||[],function(b,c){d[c]=!0}),d)}else c=p.extend({},b);b=c;var e,j,f,g,n=[],r=[],l=-1,q=function(){g=g||b.once;for(f=e=!0;r.length;l=-1)for(j=r.shift();++l<n.length;)!1===n[l].apply(j[0],j[1])&&b.stopOnFalse&&(l=n.length,j=!1);b.memory||(j=!1);e=!1;g&&(n=j?[]:
"")},m={add:function(){return n&&(j&&!e&&(l=n.length-1,r.push(j)),function Lc(c){p.each(c,function(c,d){p.isFunction(d)?b.unique&&m.has(d)||n.push(d):d&&d.length&&"string"!==p.type(d)&&Lc(d)})}(arguments),j&&!e&&q()),this},remove:function(){return p.each(arguments,function(b,c){for(var d;-1<(d=p.inArray(c,n,d));)n.splice(d,1),d<=l&&l--}),this},has:function(b){return b?-1<p.inArray(b,n):0<n.length},empty:function(){return n&&(n=[]),this},disable:function(){return g=r=[],n=j="",this},disabled:function(){return!n},
lock:function(){return g=r=[],j||e||(n=j=""),this},locked:function(){return!!g},fireWith:function(b,c){return g||(c=c||[],c=[b,c.slice?c.slice():c],r.push(c),e||q()),this},fire:function(){return m.fireWith(this,arguments),this},fired:function(){return!!f}};return m};p.extend({Deferred:function(c){var d=[["notify","progress",p.Callbacks("memory"),p.Callbacks("memory"),2],["resolve","done",p.Callbacks("once memory"),p.Callbacks("once memory"),0,"resolved"],["reject","fail",p.Callbacks("once memory"),
p.Callbacks("once memory"),1,"rejected"]],e="pending",f={state:function(){return e},always:function(){return g.done(arguments).fail(arguments),this},"catch":function(b){return f.then(null,b)},pipe:function(){var b=arguments;return p.Deferred(function(c){p.each(d,function(d,e){var j=p.isFunction(b[e[4]])&&b[e[4]];g[e[1]](function(){var b=j&&j.apply(this,arguments);b&&p.isFunction(b.promise)?b.promise().progress(c.notify).done(c.resolve).fail(c.reject):c[e[0]+"With"](this,j?[b]:arguments)})});b=null}).promise()},
then:function(c,e,f){function g(c,d,e,f){return function(){var r=this,q=arguments,m=function(){var b,m;if(!(c<n)){if(b=e.apply(r,q),b===d.promise())throw new TypeError("Thenable self-resolution");m=b&&("object"==typeof b||"function"==typeof b)&&b.then;p.isFunction(m)?f?m.call(b,g(n,d,l,f),g(n,d,j,f)):(n++,m.call(b,g(n,d,l,f),g(n,d,j,f),g(n,d,l,d.notifyWith))):(e!==l&&(r=void 0,q=[b]),(f||d.resolveWith)(r,q))}},ia=f?m:function(){try{m()}catch(b){p.Deferred.exceptionHook&&p.Deferred.exceptionHook(b,
ia.stackTrace),c+1>=n&&(e!==j&&(r=void 0,q=[b]),d.rejectWith(r,q))}};c?ia():(p.Deferred.getStackHook&&(ia.stackTrace=p.Deferred.getStackHook()),b.setTimeout(ia))}}var n=0;return p.Deferred(function(b){d[0][3].add(g(0,b,p.isFunction(f)?f:l,b.notifyWith));d[1][3].add(g(0,b,p.isFunction(c)?c:l));d[2][3].add(g(0,b,p.isFunction(e)?e:j))}).promise()},promise:function(b){return null!=b?p.extend(b,f):f}},g={};return p.each(d,function(b,c){var j=c[2],n=c[5];f[c[1]]=j.add;n&&j.add(function(){e=n},d[3-b][2].disable,
d[0][2].lock);j.add(c[3].fire);g[c[0]]=function(){return g[c[0]+"With"](this===g?void 0:this,arguments),this};g[c[0]+"With"]=j.fireWith}),f.promise(g),c&&c.call(g,g),g},when:function(b){var c=arguments.length,d=c,e=Array(d),j=na.call(arguments),f=p.Deferred(),g=function(b){return function(d){e[b]=this;j[b]=1<arguments.length?na.call(arguments):d;--c||f.resolveWith(e,j)}};if(1>=c&&(n(b,f.done(g(d)).resolve,f.reject,!c),"pending"===f.state()||p.isFunction(j[d]&&j[d].then)))return f.then();for(;d--;)n(j[d],
g(d),f.reject);return f.promise()}});var ed=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;p.Deferred.exceptionHook=function(c,d){b.console&&b.console.warn&&c&&ed.test(c.name)&&b.console.warn("jQuery.Deferred exception: "+c.message,c.stack,d)};p.readyException=function(c){b.setTimeout(function(){throw c;})};var Rb=p.Deferred();p.fn.ready=function(b){return Rb.then(b)["catch"](function(b){p.readyException(b)}),this};p.extend({isReady:!1,readyWait:1,ready:function(b){(!0===b?--p.readyWait:
p.isReady)||(p.isReady=!0,!0!==b&&0<--p.readyWait||Rb.resolveWith(M,[p]))}});p.ready.then=Rb.then;"complete"===M.readyState||"loading"!==M.readyState&&!M.documentElement.doScroll?b.setTimeout(p.ready):(M.addEventListener("DOMContentLoaded",r),b.addEventListener("load",r));var Ma=function(b,c,d,e,j,f,g){var n=0,r=b.length,l=null==d;if("object"===p.type(d))for(n in j=!0,d)Ma(b,c,n,d[n],!0,f,g);else if(void 0!==e&&(j=!0,p.isFunction(e)||(g=!0),l&&(g?(c.call(b,e),c=null):(l=c,c=function(b,c,d){return l.call(p(b),
d)})),c))for(;n<r;n++)c(b[n],d,g?e:e.call(b[n],n,c(b[n],d)));return j?b:l?c.call(b):r?c(b[0],d):f},Cb=function(b){return 1===b.nodeType||9===b.nodeType||!+b.nodeType};q.uid=1;q.prototype={cache:function(b){var c=b[this.expando];return c||(c={},Cb(b)&&(b.nodeType?b[this.expando]=c:Object.defineProperty(b,this.expando,{value:c,configurable:!0}))),c},set:function(b,c,d){var e;b=this.cache(b);if("string"==typeof c)b[p.camelCase(c)]=d;else for(e in c)b[p.camelCase(e)]=c[e];return b},get:function(b,c){return void 0===
c?this.cache(b):b[this.expando]&&b[this.expando][p.camelCase(c)]},access:function(b,c,d){return void 0===c||c&&"string"==typeof c&&void 0===d?this.get(b,c):(this.set(b,c,d),void 0!==d?d:c)},remove:function(b,c){var d,e=b[this.expando];if(void 0!==e){if(void 0!==c){Array.isArray(c)?c=c.map(p.camelCase):(c=p.camelCase(c),c=c in e?[c]:c.match(sa)||[]);for(d=c.length;d--;)delete e[c[d]]}(void 0===c||p.isEmptyObject(e))&&(b.nodeType?b[this.expando]=void 0:delete b[this.expando])}},hasData:function(b){b=
b[this.expando];return void 0!==b&&!p.isEmptyObject(b)}};var T=new q,pa=new q,Hc=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Gc=/[A-Z]/g;p.extend({hasData:function(b){return pa.hasData(b)||T.hasData(b)},data:function(b,c,d){return pa.access(b,c,d)},removeData:function(b,c){pa.remove(b,c)},_data:function(b,c,d){return T.access(b,c,d)},_removeData:function(b,c){T.remove(b,c)}});p.fn.extend({data:function(b,c){var d,e,j,f=this[0],g=f&&f.attributes;if(void 0===b){if(this.length&&(j=pa.get(f),1===f.nodeType&&!T.get(f,
"hasDataAttrs"))){for(d=g.length;d--;)g[d]&&(e=g[d].name,0===e.indexOf("data-")&&(e=p.camelCase(e.slice(5)),s(f,e,j[e])));T.set(f,"hasDataAttrs",!0)}return j}return"object"==typeof b?this.each(function(){pa.set(this,b)}):Ma(this,function(c){var d;if(f&&void 0===c){if((d=pa.get(f,b),void 0!==d)||(d=s(f,b),void 0!==d))return d}else this.each(function(){pa.set(this,b,c)})},null,c,1<arguments.length,null,!0)},removeData:function(b){return this.each(function(){pa.remove(this,b)})}});p.extend({queue:function(b,
c,d){var e;if(b)return c=(c||"fx")+"queue",e=T.get(b,c),d&&(!e||Array.isArray(d)?e=T.access(b,c,p.makeArray(d)):e.push(d)),e||[]},dequeue:function(b,c){c=c||"fx";var d=p.queue(b,c),e=d.length,j=d.shift(),f=p._queueHooks(b,c),g=function(){p.dequeue(b,c)};"inprogress"===j&&(j=d.shift(),e--);j&&("fx"===c&&d.unshift("inprogress"),delete f.stop,j.call(b,g,f));!e&&f&&f.empty.fire()},_queueHooks:function(b,c){var d=c+"queueHooks";return T.get(b,d)||T.access(b,d,{empty:p.Callbacks("once memory").add(function(){T.remove(b,
[c+"queue",d])})})}});p.fn.extend({queue:function(b,c){var d=2;return"string"!=typeof b&&(c=b,b="fx",d--),arguments.length<d?p.queue(this[0],b):void 0===c?this:this.each(function(){var d=p.queue(this,b,c);p._queueHooks(this,b);"fx"===b&&"inprogress"!==d[0]&&p.dequeue(this,b)})},dequeue:function(b){return this.each(function(){p.dequeue(this,b)})},clearQueue:function(b){return this.queue(b||"fx",[])},promise:function(b,c){var d,e=1,j=p.Deferred(),f=this,g=this.length,n=function(){--e||j.resolveWith(f,
[f])};"string"!=typeof b&&(c=b,b=void 0);for(b=b||"fx";g--;)(d=T.get(f[g],b+"queueHooks"))&&d.empty&&(e++,d.empty.add(n));return n(),j.promise(c)}});var mc=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,jb=RegExp("^(?:([+-])=|)("+mc+")([a-z%]*)$","i"),Va=["Top","Right","Bottom","Left"],rb=function(b,c){return b=c||b,"none"===b.style.display||""===b.style.display&&p.contains(b.ownerDocument,b)&&"none"===p.css(b,"display")},nc=function(b,c,d,e){var j,f={};for(j in c)f[j]=b.style[j],b.style[j]=c[j];d=
d.apply(b,e||[]);for(j in c)b.style[j]=f[j];return d},Vb={};p.fn.extend({show:function(){return u(this,!0)},hide:function(){return u(this)},toggle:function(b){return"boolean"==typeof b?b?this.show():this.hide():this.each(function(){rb(this)?p(this).show():p(this).hide()})}});var oc=/^(?:checkbox|radio)$/i,Wb=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Xb=/^$|\/(?:java|ecma)script/i,ra={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],
tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ra.optgroup=ra.option;ra.tbody=ra.tfoot=ra.colgroup=ra.caption=ra.thead;ra.th=ra.td;var Ic=/<|&#?\w+;/,Db=M.createDocumentFragment().appendChild(M.createElement("div")),Eb=M.createElement("input");Eb.setAttribute("type","radio");Eb.setAttribute("checked","checked");Eb.setAttribute("name","t");Db.appendChild(Eb);aa.checkClone=Db.cloneNode(!0).cloneNode(!0).lastChild.checked;Db.innerHTML=
"<textarea>x</textarea>";aa.noCloneChecked=!!Db.cloneNode(!0).lastChild.defaultValue;!0;var Fb=M.documentElement,fd=/^key/,gd=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,pc=/^([^.]*)(?:\.(.+)|)/;p.event={global:{},add:function(b,c,d,e,j){var f,g,n,r,l,q,m,s,t,u;if(l=T.get(b)){d.handler&&(f=d,d=f.handler,j=f.selector);j&&p.find.matchesSelector(Fb,j);d.guid||(d.guid=p.guid++);(r=l.events)||(r=l.events={});(g=l.handle)||(g=l.handle=function(c){return"undefined"!=typeof p&&p.event.triggered!==c.type?
p.event.dispatch.apply(b,arguments):void 0});c=(c||"").match(sa)||[""];for(l=c.length;l--;)n=pc.exec(c[l])||[],t=u=n[1],n=(n[2]||"").split(".").sort(),t&&(m=p.event.special[t]||{},t=(j?m.delegateType:m.bindType)||t,m=p.event.special[t]||{},q=p.extend({type:t,origType:u,data:e,handler:d,guid:d.guid,selector:j,needsContext:j&&p.expr.match.needsContext.test(j),namespace:n.join(".")},f),(s=r[t])||(s=r[t]=[],s.delegateCount=0,m.setup&&!1!==m.setup.call(b,e,n,g)||b.addEventListener&&b.addEventListener(t,
g)),m.add&&(m.add.call(b,q),q.handler.guid||(q.handler.guid=d.guid)),j?s.splice(s.delegateCount++,0,q):s.push(q),p.event.global[t]=!0)}},remove:function(b,c,d,e,j){var f,g,n,r,l,q,m,s,t,u,H,v=T.hasData(b)&&T.get(b);if(v&&(r=v.events)){c=(c||"").match(sa)||[""];for(l=c.length;l--;)if(n=pc.exec(c[l])||[],t=H=n[1],u=(n[2]||"").split(".").sort(),t){m=p.event.special[t]||{};t=(e?m.delegateType:m.bindType)||t;s=r[t]||[];n=n[2]&&RegExp("(^|\\.)"+u.join("\\.(?:.*\\.|)")+"(\\.|$)");for(g=f=s.length;f--;)q=
s[f],!j&&H!==q.origType||d&&d.guid!==q.guid||n&&!n.test(q.namespace)||e&&e!==q.selector&&("**"!==e||!q.selector)||(s.splice(f,1),q.selector&&s.delegateCount--,m.remove&&m.remove.call(b,q));g&&!s.length&&(m.teardown&&!1!==m.teardown.call(b,u,v.handle)||p.removeEvent(b,t,v.handle),delete r[t])}else for(t in r)p.event.remove(b,t+c[l],d,e,!0);p.isEmptyObject(r)&&T.remove(b,"handle events")}},dispatch:function(b){var c=p.event.fix(b),d,e,j,f,g,n,r=Array(arguments.length);e=(T.get(this,"events")||{})[c.type]||
[];var l=p.event.special[c.type]||{};r[0]=c;for(d=1;d<arguments.length;d++)r[d]=arguments[d];if(c.delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,c)){n=p.event.handlers.call(this,c,e);for(d=0;(f=n[d++])&&!c.isPropagationStopped();){c.currentTarget=f.elem;for(e=0;(g=f.handlers[e++])&&!c.isImmediatePropagationStopped();)c.rnamespace&&!c.rnamespace.test(g.namespace)||(c.handleObj=g,c.data=g.data,j=((p.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,r),void 0!==j&&!1===
(c.result=j)&&(c.preventDefault(),c.stopPropagation()))}return l.postDispatch&&l.postDispatch.call(this,c),c.result}},handlers:function(b,c){var d,e,j,f,g,n=[],r=c.delegateCount,l=b.target;if(r&&l.nodeType&&!("click"===b.type&&1<=b.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==b.type||!0!==l.disabled)){f=[];g={};for(d=0;d<r;d++)e=c[d],j=e.selector+" ",void 0===g[j]&&(g[j]=e.needsContext?-1<p(j,this).index(l):p.find(j,this,null,[l]).length),g[j]&&f.push(e);f.length&&n.push({elem:l,
handlers:f})}return l=this,r<c.length&&n.push({elem:l,handlers:c.slice(r)}),n},addProp:function(b,c){Object.defineProperty(p.Event.prototype,b,{enumerable:!0,configurable:!0,get:p.isFunction(c)?function(){if(this.originalEvent)return c(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[b]},set:function(c){Object.defineProperty(this,b,{enumerable:!0,configurable:!0,writable:!0,value:c})}})},fix:function(b){return b[p.expando]?b:new p.Event(b)},special:{load:{noBubble:!0},
focus:{trigger:function(){if(this!==C()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===C()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&g(this,"input"))return this.click(),!1},_default:function(b){return g(b.target,"a")}},beforeunload:{postDispatch:function(b){void 0!==b.result&&b.originalEvent&&(b.originalEvent.returnValue=b.result)}}}};p.removeEvent=function(b,c,d){b.removeEventListener&&
b.removeEventListener(c,d)};p.Event=function(b,c){return this instanceof p.Event?(b&&b.type?(this.originalEvent=b,this.type=b.type,this.isDefaultPrevented=b.defaultPrevented||void 0===b.defaultPrevented&&!1===b.returnValue?A:B,this.target=b.target&&3===b.target.nodeType?b.target.parentNode:b.target,this.currentTarget=b.currentTarget,this.relatedTarget=b.relatedTarget):this.type=b,c&&p.extend(this,c),this.timeStamp=b&&b.timeStamp||p.now(),void(this[p.expando]=!0)):new p.Event(b,c)};p.Event.prototype=
{constructor:p.Event,isDefaultPrevented:B,isPropagationStopped:B,isImmediatePropagationStopped:B,isSimulated:!1,preventDefault:function(){var b=this.originalEvent;this.isDefaultPrevented=A;b&&!this.isSimulated&&b.preventDefault()},stopPropagation:function(){var b=this.originalEvent;this.isPropagationStopped=A;b&&!this.isSimulated&&b.stopPropagation()},stopImmediatePropagation:function(){var b=this.originalEvent;this.isImmediatePropagationStopped=A;b&&!this.isSimulated&&b.stopImmediatePropagation();
this.stopPropagation()}};p.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(b){var c=b.button;return null==b.which&&fd.test(b.type)?null!=b.charCode?b.charCode:b.keyCode:!b.which&&void 0!==c&&gd.test(b.type)?
1&c?1:2&c?3:4&c?2:0:b.which}},p.event.addProp);p.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(b,c){p.event.special[b]={delegateType:c,bindType:c,handle:function(b){var d,e=b.relatedTarget,j=b.handleObj;return e&&(e===this||p.contains(this,e))||(b.type=j.origType,d=j.handler.apply(this,arguments),b.type=c),d}}});p.fn.extend({on:function(b,c,d,e){return I(this,b,c,d,e)},one:function(b,c,d,e){return I(this,b,c,d,e,1)},off:function(b,
c,d){var e,j;if(b&&b.preventDefault&&b.handleObj)return e=b.handleObj,p(b.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this;if("object"==typeof b){for(j in b)this.off(j,c,b[j]);return this}return!1!==c&&"function"!=typeof c||(d=c,c=void 0),!1===d&&(d=B),this.each(function(){p.event.remove(this,b,d,c)})}});var hd=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,id=/<script|<style|<link/i,Kc=/checked\s*(?:[^=]|=\s*.checked.)/i,
Jc=/^true\/(.*)/,Mc=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;p.extend({htmlPrefilter:function(b){return b.replace(hd,"<$1></$2>")},clone:function(b,c,d){var e,j,f,g,n=b.cloneNode(!0),r=p.contains(b.ownerDocument,b);if(!aa.noCloneChecked&&!(1!==b.nodeType&&11!==b.nodeType||p.isXMLDoc(b))){g=v(n);f=v(b);e=0;for(j=f.length;e<j;e++){var l=f[e],q=g[e],m=q.nodeName.toLowerCase();"input"===m&&oc.test(l.type)?q.checked=l.checked:"input"!==m&&"textarea"!==m||(q.defaultValue=l.defaultValue)}}if(c)if(d){f=
f||v(b);g=g||v(n);e=0;for(j=f.length;e<j;e++)L(f[e],g[e])}else L(b,n);return g=v(n,"script"),0<g.length&&x(g,!r&&v(b,"script")),n},cleanData:function(b){for(var c,d,e,j=p.event.special,f=0;void 0!==(d=b[f]);f++)if(Cb(d)){if(c=d[T.expando]){if(c.events)for(e in c.events)j[e]?p.event.remove(d,e):p.removeEvent(d,e,c.handle);d[T.expando]=void 0}d[pa.expando]&&(d[pa.expando]=void 0)}}});p.fn.extend({detach:function(b){return O(this,b,!0)},remove:function(b){return O(this,b)},text:function(b){return Ma(this,
function(b){return void 0===b?p.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=b)})},null,b,arguments.length)},append:function(){return R(this,arguments,function(b){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&z(this,b).appendChild(b)})},prepend:function(){return R(this,arguments,function(b){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var c=z(this,b);c.insertBefore(b,c.firstChild)}})},before:function(){return R(this,
arguments,function(b){this.parentNode&&this.parentNode.insertBefore(b,this)})},after:function(){return R(this,arguments,function(b){this.parentNode&&this.parentNode.insertBefore(b,this.nextSibling)})},empty:function(){for(var b,c=0;null!=(b=this[c]);c++)1===b.nodeType&&(p.cleanData(v(b,!1)),b.textContent="");return this},clone:function(b,c){return b=null!=b&&b,c=null==c?b:c,this.map(function(){return p.clone(this,b,c)})},html:function(b){return Ma(this,function(b){var c=this[0]||{},d=0,e=this.length;
if(void 0===b&&1===c.nodeType)return c.innerHTML;if("string"==typeof b&&!id.test(b)&&!ra[(Wb.exec(b)||["",""])[1].toLowerCase()]){b=p.htmlPrefilter(b);try{for(;d<e;d++)c=this[d]||{},1===c.nodeType&&(p.cleanData(v(c,!1)),c.innerHTML=b);c=0}catch(j){}}c&&this.empty().append(b)},null,b,arguments.length)},replaceWith:function(){var b=[];return R(this,arguments,function(c){var d=this.parentNode;0>p.inArray(this,b)&&(p.cleanData(v(this)),d&&d.replaceChild(c,this))},b)}});p.each({appendTo:"append",prependTo:"prepend",
insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(b,c){p.fn[b]=function(b){for(var d=[],e=p(b),j=e.length-1,f=0;f<=j;f++)b=f===j?this:this.clone(!0),p(e[f])[c](b),Na.apply(d,b.get());return this.pushStack(d)}});var Yb=/^margin/,Ib=RegExp("^("+mc+")(?!px)[a-z%]+$","i"),sb=function(c){var d=c.ownerDocument.defaultView;return d&&d.opener||(d=b),d.getComputedStyle(c)},Hb=function(){if(Ba){Ba.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%";
Ba.innerHTML="";Fb.appendChild(Gb);var c=b.getComputedStyle(Ba);qc="1%"!==c.top;rc="2px"===c.marginLeft;sc="4px"===c.width;Ba.style.marginRight="50%";tc="4px"===c.marginRight;Fb.removeChild(Gb);Ba=null}},qc,sc,tc,rc,Gb=M.createElement("div"),Ba=M.createElement("div");Ba.style&&(Ba.style.backgroundClip="content-box",Ba.cloneNode(!0).style.backgroundClip="",aa.clearCloneStyle="content-box"===Ba.style.backgroundClip,Gb.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",
Gb.appendChild(Ba),p.extend(aa,{pixelPosition:function(){return Hb(),qc},boxSizingReliable:function(){return Hb(),sc},pixelMarginRight:function(){return Hb(),tc},reliableMarginLeft:function(){return Hb(),rc}}));!0;var jd=/^(none|table(?!-c[ea]).+)/,uc=/^--/,kd={position:"absolute",visibility:"hidden",display:"block"},vc={letterSpacing:"0",fontWeight:"400"},$b=["Webkit","Moz","ms"],Zb=M.createElement("div").style;p.extend({cssHooks:{opacity:{get:function(b,c){if(c){var d=N(b,"opacity");return""===
d?"1":d}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(b,c,d,e){if(b&&3!==b.nodeType&&8!==b.nodeType&&b.style){var j,f,g,n=p.camelCase(c),r=uc.test(c),l=b.style;return r||(c=da(n)),g=p.cssHooks[c]||p.cssHooks[n],void 0===d?g&&"get"in g&&void 0!==(j=g.get(b,!1,e))?j:l[c]:(f=typeof d,"string"===f&&(j=jb.exec(d))&&j[1]&&
(d=t(b,c,j),f="number"),null!=d&&d===d&&("number"===f&&(d+=j&&j[3]||(p.cssNumber[n]?"":"px")),aa.clearCloneStyle||""!==d||0!==c.indexOf("background")||(l[c]="inherit"),g&&"set"in g&&void 0===(d=g.set(b,d,e))||(r?l.setProperty(c,d):l[c]=d)),void 0)}},css:function(b,c,d,e){var j,f,g,n=p.camelCase(c);return uc.test(c)||(c=da(n)),g=p.cssHooks[c]||p.cssHooks[n],g&&"get"in g&&(j=g.get(b,!0,d)),void 0===j&&(j=N(b,c,e)),"normal"===j&&c in vc&&(j=vc[c]),""===d||d?(f=parseFloat(j),!0===d||isFinite(f)?f||0:
j):j}});p.each(["height","width"],function(b,c){p.cssHooks[c]={get:function(b,d,e){if(d)return!jd.test(p.css(b,"display"))||b.getClientRects().length&&b.getBoundingClientRect().width?ha(b,c,e):nc(b,kd,function(){return ha(b,c,e)})},set:function(b,d,e){var j,f=e&&sb(b);e=e&&E(b,c,e,"border-box"===p.css(b,"boxSizing",!1,f),f);return e&&(j=jb.exec(d))&&"px"!==(j[3]||"px")&&(b.style[c]=d,d=p.css(b,c)),G(b,d,e)}}});p.cssHooks.marginLeft=V(aa.reliableMarginLeft,function(b,c){if(c)return(parseFloat(N(b,
"marginLeft"))||b.getBoundingClientRect().left-nc(b,{marginLeft:0},function(){return b.getBoundingClientRect().left}))+"px"});p.each({margin:"",padding:"",border:"Width"},function(b,c){p.cssHooks[b+c]={expand:function(d){var e=0,j={};for(d="string"==typeof d?d.split(" "):[d];4>e;e++)j[b+Va[e]+c]=d[e]||d[e-2]||d[0];return j}};Yb.test(b)||(p.cssHooks[b+c].set=G)});p.fn.extend({css:function(b,c){return Ma(this,function(b,c,d){var e,j={},f=0;if(Array.isArray(c)){d=sb(b);for(e=c.length;f<e;f++)j[c[f]]=
p.css(b,c[f],!1,d);return j}return void 0!==d?p.style(b,c,d):p.css(b,c)},b,c,1<arguments.length)}});p.Tween=S;S.prototype={constructor:S,init:function(b,c,d,e,j,f){this.elem=b;this.prop=d;this.easing=j||p.easing._default;this.options=c;this.start=this.now=this.cur();this.end=e;this.unit=f||(p.cssNumber[d]?"":"px")},cur:function(){var b=S.propHooks[this.prop];return b&&b.get?b.get(this):S.propHooks._default.get(this)},run:function(b){var c,d=S.propHooks[this.prop];return this.options.duration?this.pos=
c=p.easing[this.easing](b,this.options.duration*b,0,1,this.options.duration):this.pos=c=b,this.now=(this.end-this.start)*c+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),d&&d.set?d.set(this):S.propHooks._default.set(this),this}};S.prototype.init.prototype=S.prototype;S.propHooks={_default:{get:function(b){var c;return 1!==b.elem.nodeType||null!=b.elem[b.prop]&&null==b.elem.style[b.prop]?b.elem[b.prop]:(c=p.css(b.elem,b.prop,""),c&&"auto"!==c?c:0)},set:function(b){p.fx.step[b.prop]?
p.fx.step[b.prop](b):1!==b.elem.nodeType||null==b.elem.style[p.cssProps[b.prop]]&&!p.cssHooks[b.prop]?b.elem[b.prop]=b.now:p.style(b.elem,b.prop,b.now+b.unit)}}};S.propHooks.scrollTop=S.propHooks.scrollLeft={set:function(b){b.elem.nodeType&&b.elem.parentNode&&(b.elem[b.prop]=b.now)}};p.easing={linear:function(b){return b},swing:function(b){return 0.5-Math.cos(b*Math.PI)/2},_default:"swing"};p.fx=S.prototype.init;p.fx.step={};var ab,tb,ld=/^(?:toggle|show|hide)$/,md=/queueHooks$/;p.Animation=p.extend(Z,
{tweeners:{"*":[function(b,c){var d=this.createTween(b,c);return t(d.elem,b,jb.exec(c),d),d}]},tweener:function(b,c){p.isFunction(b)?(c=b,b=["*"]):b=b.match(sa);for(var d,e=0,j=b.length;e<j;e++)d=b[e],Z.tweeners[d]=Z.tweeners[d]||[],Z.tweeners[d].unshift(c)},prefilters:[function(b,c,d){var e,j,f,g,n,r,l,q,m="width"in c||"height"in c,s=this,t={},H=b.style,v=b.nodeType&&rb(b),x=T.get(b,"fxshow");d.queue||(g=p._queueHooks(b,"fx"),null==g.unqueued&&(g.unqueued=0,n=g.empty.fire,g.empty.fire=function(){g.unqueued||
n()}),g.unqueued++,s.always(function(){s.always(function(){g.unqueued--;p.queue(b,"fx").length||g.empty.fire()})}));for(e in c)if(j=c[e],ld.test(j)){if(delete c[e],f=f||"toggle"===j,j===(v?"hide":"show")){if("show"!==j||!x||void 0===x[e])continue;v=!0}t[e]=x&&x[e]||p.style(b,e)}if(r=!p.isEmptyObject(c),r||!p.isEmptyObject(t))for(e in m&&1===b.nodeType&&(d.overflow=[H.overflow,H.overflowX,H.overflowY],l=x&&x.display,null==l&&(l=T.get(b,"display")),q=p.css(b,"display"),"none"===q&&(l?q=l:(u([b],!0),
l=b.style.display||l,q=p.css(b,"display"),u([b]))),("inline"===q||"inline-block"===q&&null!=l)&&"none"===p.css(b,"float")&&(r||(s.done(function(){H.display=l}),null==l&&(q=H.display,l="none"===q?"":q)),H.display="inline-block")),d.overflow&&(H.overflow="hidden",s.always(function(){H.overflow=d.overflow[0];H.overflowX=d.overflow[1];H.overflowY=d.overflow[2]})),r=!1,t)r||(x?"hidden"in x&&(v=x.hidden):x=T.access(b,"fxshow",{display:l}),f&&(x.hidden=!v),v&&u([b],!0),s.done(function(){v||u([b]);T.remove(b,
"fxshow");for(e in t)p.style(b,e,t[e])})),r=Y(v?x[e]:0,e,s),e in x||(x[e]=r.start,v&&(r.end=r.start,r.start=0))}],prefilter:function(b,c){c?Z.prefilters.unshift(b):Z.prefilters.push(b)}});p.speed=function(b,c,d){var e=b&&"object"==typeof b?p.extend({},b):{complete:d||!d&&c||p.isFunction(b)&&b,duration:b,easing:d&&c||c&&!p.isFunction(c)&&c};return p.fx.off?e.duration=0:"number"!=typeof e.duration&&(e.duration in p.fx.speeds?e.duration=p.fx.speeds[e.duration]:e.duration=p.fx.speeds._default),null!=
e.queue&&!0!==e.queue||(e.queue="fx"),e.old=e.complete,e.complete=function(){p.isFunction(e.old)&&e.old.call(this);e.queue&&p.dequeue(this,e.queue)},e};p.fn.extend({fadeTo:function(b,c,d,e){return this.filter(rb).css("opacity",0).show().end().animate({opacity:c},b,d,e)},animate:function(b,c,d,e){var j=p.isEmptyObject(b),f=p.speed(c,d,e);c=function(){var c=Z(this,p.extend({},b),f);(j||T.get(this,"finish"))&&c.stop(!0)};return c.finish=c,j||!1===f.queue?this.each(c):this.queue(f.queue,c)},stop:function(b,
c,d){var e=function(b){var c=b.stop;delete b.stop;c(d)};return"string"!=typeof b&&(d=c,c=b,b=void 0),c&&!1!==b&&this.queue(b||"fx",[]),this.each(function(){var c=!0,j=null!=b&&b+"queueHooks",f=p.timers,g=T.get(this);if(j)g[j]&&g[j].stop&&e(g[j]);else for(j in g)g[j]&&g[j].stop&&md.test(j)&&e(g[j]);for(j=f.length;j--;)f[j].elem!==this||null!=b&&f[j].queue!==b||(f[j].anim.stop(d),c=!1,f.splice(j,1));!c&&d||p.dequeue(this,b)})},finish:function(b){return!1!==b&&(b=b||"fx"),this.each(function(){var c,
d=T.get(this),e=d[b+"queue"];c=d[b+"queueHooks"];var j=p.timers,f=e?e.length:0;d.finish=!0;p.queue(this,b,[]);c&&c.stop&&c.stop.call(this,!0);for(c=j.length;c--;)j[c].elem===this&&j[c].queue===b&&(j[c].anim.stop(!0),j.splice(c,1));for(c=0;c<f;c++)e[c]&&e[c].finish&&e[c].finish.call(this);delete d.finish})}});p.each(["toggle","show","hide"],function(b,c){var d=p.fn[c];p.fn[c]=function(b,e,j){return null==b||"boolean"==typeof b?d.apply(this,arguments):this.animate(P(c,!0),b,e,j)}});p.each({slideDown:P("show"),
slideUp:P("hide"),slideToggle:P("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(b,c){p.fn[b]=function(b,d,e){return this.animate(c,b,d,e)}});p.timers=[];p.fx.tick=function(){var b,c=0,d=p.timers;for(ab=p.now();c<d.length;c++)b=d[c],b()||d[c]!==b||d.splice(c--,1);d.length||p.fx.stop();ab=void 0};p.fx.timer=function(b){p.timers.push(b);p.fx.start()};p.fx.interval=13;p.fx.start=function(){tb||(tb=!0,J())};p.fx.stop=function(){tb=null};p.fx.speeds={slow:600,
fast:200,_default:400};p.fn.delay=function(c,d){return c=p.fx?p.fx.speeds[c]||c:c,d=d||"fx",this.queue(d,function(d,e){var j=b.setTimeout(d,c);e.stop=function(){b.clearTimeout(j)}})};var ib=M.createElement("input"),nd=M.createElement("select").appendChild(M.createElement("option"));ib.type="checkbox";aa.checkOn=""!==ib.value;aa.optSelected=nd.selected;ib=M.createElement("input");ib.value="t";ib.type="radio";aa.radioValue="t"===ib.value;var wc,ob=p.expr.attrHandle;p.fn.extend({attr:function(b,c){return Ma(this,
p.attr,b,c,1<arguments.length)},removeAttr:function(b){return this.each(function(){p.removeAttr(this,b)})}});p.extend({attr:function(b,c,d){var e,j,f=b.nodeType;if(3!==f&&8!==f&&2!==f)return"undefined"==typeof b.getAttribute?p.prop(b,c,d):(1===f&&p.isXMLDoc(b)||(j=p.attrHooks[c.toLowerCase()]||(p.expr.match.bool.test(c)?wc:void 0)),void 0!==d?null===d?void p.removeAttr(b,c):j&&"set"in j&&void 0!==(e=j.set(b,d,c))?e:(b.setAttribute(c,d+""),d):j&&"get"in j&&null!==(e=j.get(b,c))?e:(e=p.find.attr(b,
c),null==e?void 0:e))},attrHooks:{type:{set:function(b,c){if(!aa.radioValue&&"radio"===c&&g(b,"input")){var d=b.value;return b.setAttribute("type",c),d&&(b.value=d),c}}}},removeAttr:function(b,c){var d,e=0,j=c&&c.match(sa);if(j&&1===b.nodeType)for(;d=j[e++];)b.removeAttribute(d)}});wc={set:function(b,c,d){return!1===c?p.removeAttr(b,d):b.setAttribute(d,d),d}};p.each(p.expr.match.bool.source.match(/\w+/g),function(b,c){var d=ob[c]||p.find.attr;ob[c]=function(b,c,e){var j,f,g=c.toLowerCase();return e||
(f=ob[g],ob[g]=j,j=null!=d(b,c,e)?g:null,ob[g]=f),j}});var od=/^(?:input|select|textarea|button)$/i,pd=/^(?:a|area)$/i;p.fn.extend({prop:function(b,c){return Ma(this,p.prop,b,c,1<arguments.length)},removeProp:function(b){return this.each(function(){delete this[p.propFix[b]||b]})}});p.extend({prop:function(b,c,d){var e,j,f=b.nodeType;if(3!==f&&8!==f&&2!==f)return 1===f&&p.isXMLDoc(b)||(c=p.propFix[c]||c,j=p.propHooks[c]),void 0!==d?j&&"set"in j&&void 0!==(e=j.set(b,d,c))?e:b[c]=d:j&&"get"in j&&null!==
(e=j.get(b,c))?e:b[c]},propHooks:{tabIndex:{get:function(b){var c=p.find.attr(b,"tabindex");return c?parseInt(c,10):od.test(b.nodeName)||pd.test(b.nodeName)&&b.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}});aa.optSelected||(p.propHooks.selected={get:function(b){b=b.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null},set:function(b){b=b.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex)}});p.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),
function(){p.propFix[this.toLowerCase()]=this});p.fn.extend({addClass:function(b){var c,d,e,j,f,g,n=0;if(p.isFunction(b))return this.each(function(c){p(this).addClass(b.call(this,c,oa(this)))});if("string"==typeof b&&b)for(c=b.match(sa)||[];d=this[n++];)if(j=oa(d),e=1===d.nodeType&&" "+ka(j)+" "){for(g=0;f=c[g++];)0>e.indexOf(" "+f+" ")&&(e+=f+" ");e=ka(e);j!==e&&d.setAttribute("class",e)}return this},removeClass:function(b){var c,d,e,j,f,g,n=0;if(p.isFunction(b))return this.each(function(c){p(this).removeClass(b.call(this,
c,oa(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof b&&b)for(c=b.match(sa)||[];d=this[n++];)if(j=oa(d),e=1===d.nodeType&&" "+ka(j)+" "){for(g=0;f=c[g++];)for(;-1<e.indexOf(" "+f+" ");)e=e.replace(" "+f+" "," ");e=ka(e);j!==e&&d.setAttribute("class",e)}return this},toggleClass:function(b,c){var d=typeof b;return"boolean"==typeof c&&"string"===d?c?this.addClass(b):this.removeClass(b):p.isFunction(b)?this.each(function(d){p(this).toggleClass(b.call(this,d,oa(this),c),
c)}):this.each(function(){var c,e,j,f;if("string"===d){e=0;j=p(this);for(f=b.match(sa)||[];c=f[e++];)j.hasClass(c)?j.removeClass(c):j.addClass(c)}else void 0!==b&&"boolean"!==d||(c=oa(this),c&&T.set(this,"__className__",c),this.setAttribute&&this.setAttribute("class",c||!1===b?"":T.get(this,"__className__")||""))})},hasClass:function(b){var c,d=0;for(b=" "+b+" ";c=this[d++];)if(1===c.nodeType&&-1<(" "+ka(oa(c))+" ").indexOf(b))return!0;return!1}});var qd=/\r/g;p.fn.extend({val:function(b){var c,d,
e,j=this[0];if(arguments.length)return e=p.isFunction(b),this.each(function(d){var j;1===this.nodeType&&(j=e?b.call(this,d,p(this).val()):b,null==j?j="":"number"==typeof j?j+="":Array.isArray(j)&&(j=p.map(j,function(b){return null==b?"":b+""})),c=p.valHooks[this.type]||p.valHooks[this.nodeName.toLowerCase()],c&&"set"in c&&void 0!==c.set(this,j,"value")||(this.value=j))});if(j)return c=p.valHooks[j.type]||p.valHooks[j.nodeName.toLowerCase()],c&&"get"in c&&void 0!==(d=c.get(j,"value"))?d:(d=j.value,
"string"==typeof d?d.replace(qd,""):null==d?"":d)}});p.extend({valHooks:{option:{get:function(b){var c=p.find.attr(b,"value");return null!=c?c:ka(p.text(b))}},select:{get:function(b){var c,d,e=b.options,j=b.selectedIndex,f="select-one"===b.type,n=f?null:[],r=f?j+1:e.length;for(d=0>j?r:f?j:0;d<r;d++)if(c=e[d],(c.selected||d===j)&&!c.disabled&&(!c.parentNode.disabled||!g(c.parentNode,"optgroup"))){if(b=p(c).val(),f)return b;n.push(b)}return n},set:function(b,c){for(var d,e,j=b.options,f=p.makeArray(c),
g=j.length;g--;)e=j[g],(e.selected=-1<p.inArray(p.valHooks.option.get(e),f))&&(d=!0);return d||(b.selectedIndex=-1),f}}}});p.each(["radio","checkbox"],function(){p.valHooks[this]={set:function(b,c){if(Array.isArray(c))return b.checked=-1<p.inArray(p(b).val(),c)}};aa.checkOn||(p.valHooks[this].get=function(b){return null===b.getAttribute("value")?"on":b.value})});var xc=/^(?:focusinfocus|focusoutblur)$/;p.extend(p.event,{trigger:function(c,d,e,j){var f,g,n,r,l,q,m,s=[e||M],t=cb.call(c,"type")?c.type:
c;f=cb.call(c,"namespace")?c.namespace.split("."):[];if(g=n=e=e||M,3!==e.nodeType&&8!==e.nodeType&&!xc.test(t+p.event.triggered)&&(-1<t.indexOf(".")&&(f=t.split("."),t=f.shift(),f.sort()),l=0>t.indexOf(":")&&"on"+t,c=c[p.expando]?c:new p.Event(t,"object"==typeof c&&c),c.isTrigger=j?2:3,c.namespace=f.join("."),c.rnamespace=c.namespace?RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,c.result=void 0,c.target||(c.target=e),d=null==d?[c]:p.makeArray(d,[c]),m=p.event.special[t]||{},j||!m.trigger||
!1!==m.trigger.apply(e,d))){if(!j&&!m.noBubble&&!p.isWindow(e)){r=m.delegateType||t;for(xc.test(r+t)||(g=g.parentNode);g;g=g.parentNode)s.push(g),n=g;n===(e.ownerDocument||M)&&s.push(n.defaultView||n.parentWindow||b)}for(f=0;(g=s[f++])&&!c.isPropagationStopped();)c.type=1<f?r:m.bindType||t,(q=(T.get(g,"events")||{})[c.type]&&T.get(g,"handle"))&&q.apply(g,d),(q=l&&g[l])&&q.apply&&Cb(g)&&(c.result=q.apply(g,d),!1===c.result&&c.preventDefault());return c.type=t,j||c.isDefaultPrevented()||m._default&&
!1!==m._default.apply(s.pop(),d)||!Cb(e)||l&&p.isFunction(e[t])&&!p.isWindow(e)&&(n=e[l],n&&(e[l]=null),p.event.triggered=t,e[t](),p.event.triggered=void 0,n&&(e[l]=n)),c.result}},simulate:function(b,c,d){b=p.extend(new p.Event,d,{type:b,isSimulated:!0});p.event.trigger(b,null,c)}});p.fn.extend({trigger:function(b,c){return this.each(function(){p.event.trigger(b,c,this)})},triggerHandler:function(b,c){var d=this[0];if(d)return p.event.trigger(b,c,d,!0)}});p.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),
function(b,c){p.fn[c]=function(b,d){return 0<arguments.length?this.on(c,null,b,d):this.trigger(c)}});p.fn.extend({hover:function(b,c){return this.mouseenter(b).mouseleave(c||b)}});aa.focusin="onfocusin"in b;aa.focusin||p.each({focus:"focusin",blur:"focusout"},function(b,c){var d=function(b){p.event.simulate(c,b.target,p.event.fix(b))};p.event.special[c]={setup:function(){var e=this.ownerDocument||this,j=T.access(e,c);j||e.addEventListener(b,d,!0);T.access(e,c,(j||0)+1)},teardown:function(){var e=
this.ownerDocument||this,j=T.access(e,c)-1;j?T.access(e,c,j):(e.removeEventListener(b,d,!0),T.remove(e,c))}}});var pb=b.location,yc=p.now(),Sb=/\?/;p.parseXML=function(c){var d;if(!c||"string"!=typeof c)return null;try{d=(new b.DOMParser).parseFromString(c,"text/xml")}catch(e){d=void 0}return d&&!d.getElementsByTagName("parsererror").length||p.error("Invalid XML: "+c),d};var Nc=/\[\]$/,zc=/\r?\n/g,rd=/^(?:submit|button|image|reset|file)$/i,sd=/^(?:input|select|textarea|keygen)/i;p.param=function(b,
c){var d,e=[],j=function(b,c){var d=p.isFunction(c)?c():c;e[e.length]=encodeURIComponent(b)+"="+encodeURIComponent(null==d?"":d)};if(Array.isArray(b)||b.jquery&&!p.isPlainObject(b))p.each(b,function(){j(this.name,this.value)});else for(d in b)ea(d,b[d],c,j);return e.join("&")};p.fn.extend({serialize:function(){return p.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var b=p.prop(this,"elements");return b?p.makeArray(b):this}).filter(function(){var b=this.type;return this.name&&
!p(this).is(":disabled")&&sd.test(this.nodeName)&&!rd.test(b)&&(this.checked||!oc.test(b))}).map(function(b,c){var d=p(this).val();return null==d?null:Array.isArray(d)?p.map(d,function(b){return{name:c.name,value:b.replace(zc,"\r\n")}}):{name:c.name,value:d.replace(zc,"\r\n")}}).get()}});var td=/%20/g,ud=/#.*$/,vd=/([?&])_=[^&]*/,wd=/^(.*?):[ \t]*([^\r\n]*)$/gm,xd=/^(?:GET|HEAD)$/,yd=/^\/\//,Ac={},Jb={},Bc="*/".concat("*"),Tb=M.createElement("a");Tb.href=pb.href;p.extend({active:0,lastModified:{},
etag:{},ajaxSettings:{url:pb.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(pb.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Bc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,
"text html":!0,"text json":JSON.parse,"text xml":p.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(b,c){return c?ta(ta(b,p.ajaxSettings),c):ta(p.ajaxSettings,b)},ajaxPrefilter:ma(Ac),ajaxTransport:ma(Jb),ajax:function(c,d){function e(c,d,n,l){var s,t,H,y,ba=d;if(!q){q=!0;r&&b.clearTimeout(r);j=void 0;g=l||"";U.readyState=0<c?4:0;l=200<=c&&300>c||304===c;if(n){H=u;for(var z=U,J,A,N,L,M=H.contents,E=H.dataTypes;"*"===E[0];)E.shift(),void 0===J&&(J=H.mimeType||z.getResponseHeader("Content-Type"));
if(J)for(A in M)if(M[A]&&M[A].test(J)){E.unshift(A);break}if(E[0]in n)N=E[0];else{for(A in n){if(!E[0]||H.converters[A+" "+E[0]]){N=A;break}L||(L=A)}N=N||L}n=N?(N!==E[0]&&E.unshift(N),n[N]):void 0;H=n}var G;a:{n=u;J=H;A=U;N=l;var Q,Y,ia;H={};z=n.dataTypes.slice();if(z[1])for(Q in n.converters)H[Q.toLowerCase()]=n.converters[Q];for(L=z.shift();L;)if(n.responseFields[L]&&(A[n.responseFields[L]]=J),!ia&&N&&n.dataFilter&&(J=n.dataFilter(J,n.dataType)),ia=L,L=z.shift())if("*"===L)L=ia;else if("*"!==ia&&
ia!==L){if(Q=H[ia+" "+L]||H["* "+L],!Q)for(G in H)if(Y=G.split(" "),Y[1]===L&&(Q=H[ia+" "+Y[0]]||H["* "+Y[0]])){!0===Q?Q=H[G]:!0!==H[G]&&(L=Y[0],z.unshift(Y[1]));break}if(!0!==Q)if(Q&&n["throws"])J=Q(J);else try{J=Q(J)}catch(eb){G={state:"parsererror",error:Q?eb:"No conversion from "+ia+" to "+L};break a}}G={state:"success",data:J}}H=G;l?(u.ifModified&&(y=U.getResponseHeader("Last-Modified"),y&&(p.lastModified[f]=y),y=U.getResponseHeader("etag"),y&&(p.etag[f]=y)),204===c||"HEAD"===u.type?ba="nocontent":
304===c?ba="notmodified":(ba=H.state,s=H.data,t=H.error,l=!t)):(t=ba,!c&&ba||(ba="error",0>c&&(c=0)));U.status=c;U.statusText=(d||ba)+"";l?ta.resolveWith(v,[s,ba,U]):ta.rejectWith(v,[U,ba,t]);U.statusCode(P);P=void 0;m&&x.trigger(l?"ajaxSuccess":"ajaxError",[U,u,l?s:t]);K.fireWith(v,[U,ba]);m&&(x.trigger("ajaxComplete",[U,u]),--p.active||p.event.trigger("ajaxStop"))}}"object"==typeof c&&(d=c,c=void 0);d=d||{};var j,f,g,n,r,l,q,m,s,t,u=p.ajaxSetup({},d),v=u.context||u,x=u.context&&(v.nodeType||v.jquery)?
p(v):p.event,ta=p.Deferred(),K=p.Callbacks("once memory"),P=u.statusCode||{},y={},ba={},z="canceled",U={readyState:0,getResponseHeader:function(b){var c;if(q){if(!n)for(n={};c=wd.exec(g);)n[c[1].toLowerCase()]=c[2];c=n[b.toLowerCase()]}return null==c?null:c},getAllResponseHeaders:function(){return q?g:null},setRequestHeader:function(b,c){return null==q&&(b=ba[b.toLowerCase()]=ba[b.toLowerCase()]||b,y[b]=c),this},overrideMimeType:function(b){return null==q&&(u.mimeType=b),this},statusCode:function(b){var c;
if(b)if(q)U.always(b[U.status]);else for(c in b)P[c]=[P[c],b[c]];return this},abort:function(b){b=b||z;return j&&j.abort(b),e(0,b),this}};if(ta.promise(U),u.url=((c||u.url||pb.href)+"").replace(yd,pb.protocol+"//"),u.type=d.method||d.type||u.method||u.type,u.dataTypes=(u.dataType||"*").toLowerCase().match(sa)||[""],null==u.crossDomain){l=M.createElement("a");try{l.href=u.url,l.href=l.href,u.crossDomain=Tb.protocol+"//"+Tb.host!=l.protocol+"//"+l.host}catch(A){u.crossDomain=!0}}if(u.data&&u.processData&&
"string"!=typeof u.data&&(u.data=p.param(u.data,u.traditional)),H(Ac,u,d,U),q)return U;(m=p.event&&u.global)&&0===p.active++&&p.event.trigger("ajaxStart");u.type=u.type.toUpperCase();u.hasContent=!xd.test(u.type);f=u.url.replace(ud,"");u.hasContent?u.data&&u.processData&&0===(u.contentType||"").indexOf("application/x-www-form-urlencoded")&&(u.data=u.data.replace(td,"+")):(t=u.url.slice(f.length),u.data&&(f+=(Sb.test(f)?"&":"?")+u.data,delete u.data),!1===u.cache&&(f=f.replace(vd,"$1"),t=(Sb.test(f)?
"&":"?")+"_="+yc++ +t),u.url=f+t);u.ifModified&&(p.lastModified[f]&&U.setRequestHeader("If-Modified-Since",p.lastModified[f]),p.etag[f]&&U.setRequestHeader("If-None-Match",p.etag[f]));(u.data&&u.hasContent&&!1!==u.contentType||d.contentType)&&U.setRequestHeader("Content-Type",u.contentType);U.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+Bc+"; q=0.01":""):u.accepts["*"]);for(s in u.headers)U.setRequestHeader(s,u.headers[s]);
if(u.beforeSend&&(!1===u.beforeSend.call(v,U,u)||q))return U.abort();if(z="abort",K.add(u.complete),U.done(u.success),U.fail(u.error),j=H(Jb,u,d,U)){if(U.readyState=1,m&&x.trigger("ajaxSend",[U,u]),q)return U;u.async&&0<u.timeout&&(r=b.setTimeout(function(){U.abort("timeout")},u.timeout));try{q=!1,j.send(y,e)}catch(J){if(q)throw J;e(-1,J)}}else e(-1,"No Transport");return U},getJSON:function(b,c,d){return p.get(b,c,d,"json")},getScript:function(b,c){return p.get(b,void 0,c,"script")}});p.each(["get",
"post"],function(b,c){p[c]=function(b,d,e,j){return p.isFunction(d)&&(j=j||e,e=d,d=void 0),p.ajax(p.extend({url:b,type:c,dataType:j,data:d,success:e},p.isPlainObject(b)&&b))}});p._evalUrl=function(b){return p.ajax({url:b,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})};p.fn.extend({wrapAll:function(b){var c;return this[0]&&(p.isFunction(b)&&(b=b.call(this[0])),c=p(b,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&c.insertBefore(this[0]),c.map(function(){for(var b=
this;b.firstElementChild;)b=b.firstElementChild;return b}).append(this)),this},wrapInner:function(b){return p.isFunction(b)?this.each(function(c){p(this).wrapInner(b.call(this,c))}):this.each(function(){var c=p(this),d=c.contents();d.length?d.wrapAll(b):c.append(b)})},wrap:function(b){var c=p.isFunction(b);return this.each(function(d){p(this).wrapAll(c?b.call(this,d):b)})},unwrap:function(b){return this.parent(b).not("body").each(function(){p(this).replaceWith(this.childNodes)}),this}});p.expr.pseudos.hidden=
function(b){return!p.expr.pseudos.visible(b)};p.expr.pseudos.visible=function(b){return!(!b.offsetWidth&&!b.offsetHeight&&!b.getClientRects().length)};p.ajaxSettings.xhr=function(){try{return new b.XMLHttpRequest}catch(c){}};var zd={"0":200,1223:204},qb=p.ajaxSettings.xhr();aa.cors=!!qb&&"withCredentials"in qb;aa.ajax=qb=!!qb;p.ajaxTransport(function(c){var d,e;if(aa.cors||qb&&!c.crossDomain)return{send:function(j,f){var g,n=c.xhr();if(n.open(c.type,c.url,c.async,c.username,c.password),c.xhrFields)for(g in c.xhrFields)n[g]=
c.xhrFields[g];c.mimeType&&n.overrideMimeType&&n.overrideMimeType(c.mimeType);c.crossDomain||j["X-Requested-With"]||(j["X-Requested-With"]="XMLHttpRequest");for(g in j)n.setRequestHeader(g,j[g]);d=function(b){return function(){d&&(d=e=n.onload=n.onerror=n.onabort=n.onreadystatechange=null,"abort"===b?n.abort():"error"===b?"number"!=typeof n.status?f(0,"error"):f(n.status,n.statusText):f(zd[n.status]||n.status,n.statusText,"text"!==(n.responseType||"text")||"string"!=typeof n.responseText?{binary:n.response}:
{text:n.responseText},n.getAllResponseHeaders()))}};n.onload=d();e=n.onerror=d("error");void 0!==n.onabort?n.onabort=e:n.onreadystatechange=function(){4===n.readyState&&b.setTimeout(function(){d&&e()})};d=d("abort");try{n.send(c.hasContent&&c.data||null)}catch(r){if(d)throw r;}},abort:function(){d&&d()}}});p.ajaxPrefilter(function(b){b.crossDomain&&(b.contents.script=!1)});p.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},
converters:{"text script":function(b){return p.globalEval(b),b}}});p.ajaxPrefilter("script",function(b){void 0===b.cache&&(b.cache=!1);b.crossDomain&&(b.type="GET")});p.ajaxTransport("script",function(b){if(b.crossDomain){var c,d;return{send:function(e,j){c=p("<script>").prop({charset:b.scriptCharset,src:b.url}).on("load error",d=function(b){c.remove();d=null;b&&j("error"===b.type?404:200,b.type)});M.head.appendChild(c[0])},abort:function(){d&&d()}}}});var Cc=[],Ub=/(=)\?(?=&|$)|\?\?/;p.ajaxSetup({jsonp:"callback",
jsonpCallback:function(){var b=Cc.pop()||p.expando+"_"+yc++;return this[b]=!0,b}});p.ajaxPrefilter("json jsonp",function(c,d,e){var j,f,g,n=!1!==c.jsonp&&(Ub.test(c.url)?"url":"string"==typeof c.data&&0===(c.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ub.test(c.data)&&"data");if(n||"jsonp"===c.dataTypes[0])return j=c.jsonpCallback=p.isFunction(c.jsonpCallback)?c.jsonpCallback():c.jsonpCallback,n?c[n]=c[n].replace(Ub,"$1"+j):!1!==c.jsonp&&(c.url+=(Sb.test(c.url)?"&":"?")+c.jsonp+
"="+j),c.converters["script json"]=function(){return g||p.error(j+" was not called"),g[0]},c.dataTypes[0]="json",f=b[j],b[j]=function(){g=arguments},e.always(function(){void 0===f?p(b).removeProp(j):b[j]=f;c[j]&&(c.jsonpCallback=d.jsonpCallback,Cc.push(j));g&&p.isFunction(f)&&f(g[0]);g=f=void 0}),"script"});var Ad=aa,Dc,Ec=M.implementation.createHTMLDocument("").body;Dc=(Ec.innerHTML="<form></form><form></form>",2===Ec.childNodes.length);Ad.createHTMLDocument=Dc;p.parseHTML=function(b,c,d){if("string"!=
typeof b)return[];"boolean"==typeof c&&(d=c,c=!1);var e,j,f;return c||(aa.createHTMLDocument?(c=M.implementation.createHTMLDocument(""),e=c.createElement("base"),e.href=M.location.href,c.head.appendChild(e)):c=M),j=kc.exec(b),f=!d&&[],j?[c.createElement(j[1])]:(j=y([b],c,f),f&&f.length&&p(f).remove(),p.merge([],j.childNodes))};p.fn.load=function(b,c,d){var e,j,f,g=this,n=b.indexOf(" ");return-1<n&&(e=ka(b.slice(n)),b=b.slice(0,n)),p.isFunction(c)?(d=c,c=void 0):c&&"object"==typeof c&&(j="POST"),0<
g.length&&p.ajax({url:b,type:j||"GET",dataType:"html",data:c}).done(function(b){f=arguments;g.html(e?p("<div>").append(p.parseHTML(b)).find(e):b)}).always(d&&function(b,c){g.each(function(){d.apply(this,f||[b.responseText,c,b])})}),this};p.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(b,c){p.fn[c]=function(b){return this.on(c,b)}});p.expr.pseudos.animated=function(b){return p.grep(p.timers,function(c){return b===c.elem}).length};p.offset={setOffset:function(b,
c,d){var e,j,f,g,n,r,l=p.css(b,"position"),q=p(b),m={};"static"===l&&(b.style.position="relative");n=q.offset();f=p.css(b,"top");r=p.css(b,"left");("absolute"===l||"fixed"===l)&&-1<(f+r).indexOf("auto")?(e=q.position(),g=e.top,j=e.left):(g=parseFloat(f)||0,j=parseFloat(r)||0);p.isFunction(c)&&(c=c.call(b,d,p.extend({},n)));null!=c.top&&(m.top=c.top-n.top+g);null!=c.left&&(m.left=c.left-n.left+j);"using"in c?c.using.call(b,m):q.css(m)}};p.fn.extend({offset:function(b){if(arguments.length)return void 0===
b?this:this.each(function(c){p.offset.setOffset(this,b,c)});var c,d,e,j,f=this[0];if(f)return f.getClientRects().length?(e=f.getBoundingClientRect(),c=f.ownerDocument,d=c.documentElement,j=c.defaultView,{top:e.top+j.pageYOffset-d.clientTop,left:e.left+j.pageXOffset-d.clientLeft}):{top:0,left:0}},position:function(){if(this[0]){var b,c,d=this[0],e={top:0,left:0};return"fixed"===p.css(d,"position")?c=d.getBoundingClientRect():(b=this.offsetParent(),c=this.offset(),g(b[0],"html")||(e=b.offset()),e={top:e.top+
p.css(b[0],"borderTopWidth",!0),left:e.left+p.css(b[0],"borderLeftWidth",!0)}),{top:c.top-e.top-p.css(d,"marginTop",!0),left:c.left-e.left-p.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var b=this.offsetParent;b&&"static"===p.css(b,"position");)b=b.offsetParent;return b||Fb})}});p.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d="pageYOffset"===c;p.fn[b]=function(e){return Ma(this,function(b,e,j){var f;return p.isWindow(b)?f=b:9===b.nodeType&&
(f=b.defaultView),void 0===j?f?f[c]:b[e]:void(f?f.scrollTo(d?f.pageXOffset:j,d?j:f.pageYOffset):b[e]=j)},b,e,arguments.length)}});p.each(["top","left"],function(b,c){p.cssHooks[c]=V(aa.pixelPosition,function(b,d){if(d)return d=N(b,c),Ib.test(d)?p(b).position()[c]+"px":d})});p.each({Height:"height",Width:"width"},function(b,c){p.each({padding:"inner"+b,content:c,"":"outer"+b},function(d,e){p.fn[e]=function(j,f){var g=arguments.length&&(d||"boolean"!=typeof j),n=d||(!0===j||!0===f?"margin":"border");
return Ma(this,function(c,d,j){var f;return p.isWindow(c)?0===e.indexOf("outer")?c["inner"+b]:c.document.documentElement["client"+b]:9===c.nodeType?(f=c.documentElement,Math.max(c.body["scroll"+b],f["scroll"+b],c.body["offset"+b],f["offset"+b],f["client"+b])):void 0===j?p.css(c,d,n):p.style(c,d,j,n)},c,g?j:void 0,g)}})});p.fn.extend({bind:function(b,c,d){return this.on(b,null,c,d)},unbind:function(b,c){return this.off(b,null,c)},delegate:function(b,c,d,e){return this.on(c,b,d,e)},undelegate:function(b,
c,d){return 1===arguments.length?this.off(b,"**"):this.off(c,b||"**",d)}});p.holdReady=function(b){b?p.readyWait++:p.ready(!0)};p.isArray=Array.isArray;p.parseJSON=JSON.parse;p.nodeName=g;"function"==typeof define&&define.amd&&define("jquery",[],function(){return p});var Bd=b.jQuery,Cd=b.$;return p.noConflict=function(c){return b.$===p&&(b.$=Cd),c&&b.jQuery===p&&(b.jQuery=Bd),p},c||(b.jQuery=b.$=p),p});!function(b,c){"object"==typeof exports&&"undefined"!=typeof module?module.exports=c():"function"==typeof define&&define.amd?define(c):b.PointerEventsPolyfill=c()}(this,function(){function b(b,c){c=c||Object.create(null);var d=document.createEvent("Event");d.initEvent(b,c.bubbles||!1,c.cancelable||!1);for(var e,f=2;f<j.length;f++)e=j[f],d[e]=c[e]||n[f];d.buttons=c.buttons||0;e=0;return e=c.pressure&&d.buttons?c.pressure:d.buttons?0.5:0,d.x=d.clientX,d.y=d.clientY,d.pointerId=c.pointerId||0,d.width=
c.width||0,d.height=c.height||0,d.pressure=e,d.tiltX=c.tiltX||0,d.tiltY=c.tiltY||0,d.twist=c.twist||0,d.tangentialPressure=c.tangentialPressure||0,d.pointerType=c.pointerType||"",d.hwTimestamp=c.hwTimestamp||0,d.isPrimary=c.isPrimary||!1,d}function c(){this.array=[];this.size=0}function e(b,c,d,e){this.addCallback=b.bind(e);this.removeCallback=c.bind(e);this.changedCallback=d.bind(e);I&&(this.observer=new I(this.mutationWatcher.bind(this)))}function d(b){return"body /shadow-deep/ "+g(b)}function g(b){return'[touch-action="'+
b+'"]'}function f(b){return"{ -ms-touch-action: "+b+"; touch-action: "+b+"; }"}function m(b){if(!v.pointermap.has(b))throw b=Error("InvalidPointerId"),b.name="InvalidPointerId",b;}function l(b){for(var c=b.parentNode;c&&c!==b.ownerDocument;)c=c.parentNode;if(!c)throw b=Error("InvalidStateError"),b.name="InvalidStateError",b;}var j="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget pageX pageY".split(" "),n=[!1,!1,null,null,0,0,0,0,
!1,!1,!1,!1,0,null,0,0],r=window.Map&&window.Map.prototype.forEach?Map:c;c.prototype={set:function(b,c){return void 0===c?this["delete"](b):(this.has(b)||this.size++,void(this.array[b]=c))},has:function(b){return void 0!==this.array[b]},"delete":function(b){this.has(b)&&(delete this.array[b],this.size--)},get:function(b){return this.array[b]},clear:function(){this.size=this.array.length=0},forEach:function(b,c){return this.array.forEach(function(d,e){b.call(c,d,e,this)},this)}};var q="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget buttons pointerId width height pressure tiltX tiltY pointerType hwTimestamp isPrimary type target currentTarget which pageX pageY timeStamp".split(" "),
s=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],t={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},u="undefined"!=typeof SVGElementInstance,v={pointermap:new r,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(b,c){var d=c.events;d&&(d.forEach(function(b){c[b]&&(this.eventMap[b]=c[b].bind(c))},this),this.eventSources[b]=c,this.eventSourceList.push(c))},register:function(b){for(var c,
d=this.eventSourceList.length,e=0;e<d&&(c=this.eventSourceList[e]);e++)c.register.call(c,b)},unregister:function(b){for(var c,d=this.eventSourceList.length,e=0;e<d&&(c=this.eventSourceList[e]);e++)c.unregister.call(c,b)},contains:function(b,c){try{return b.contains(c)}catch(d){return!1}},down:function(b){b.bubbles=!0;this.fireEvent("pointerdown",b)},move:function(b){b.bubbles=!0;this.fireEvent("pointermove",b)},up:function(b){b.bubbles=!0;this.fireEvent("pointerup",b)},enter:function(b){b.bubbles=
!1;this.fireEvent("pointerenter",b)},leave:function(b){b.bubbles=!1;this.fireEvent("pointerleave",b)},over:function(b){b.bubbles=!0;this.fireEvent("pointerover",b)},out:function(b){b.bubbles=!0;this.fireEvent("pointerout",b)},cancel:function(b){b.bubbles=!0;this.fireEvent("pointercancel",b)},leaveOut:function(b){this.out(b);this.propagate(b,this.leave,!1)},enterOver:function(b){this.over(b);this.propagate(b,this.enter,!0)},eventHandler:function(b){if(!b._handledByPE){var c=b.type;(c=this.eventMap&&
this.eventMap[c])&&c(b);b._handledByPE=!0}},listen:function(b,c){c.forEach(function(c){this.addEvent(b,c)},this)},unlisten:function(b,c){c.forEach(function(c){this.removeEvent(b,c)},this)},addEvent:function(b,c){b.addEventListener(c,this.boundHandler)},removeEvent:function(b,c){b.removeEventListener(c,this.boundHandler)},makeEvent:function(c,d){this.captureInfo[d.pointerId]&&(d.relatedTarget=null);var e=new b(c,d);return d.preventDefault&&(e.preventDefault=d.preventDefault),e._target=e._target||d.target,
e},fireEvent:function(b,c){var d=this.makeEvent(b,c);return this.dispatchEvent(d)},cloneEvent:function(b){for(var c,d=Object.create(null),e=0;e<q.length;e++)c=q[e],d[c]=b[c]||s[e],!u||"target"!==c&&"relatedTarget"!==c||d[c]instanceof SVGElementInstance&&(d[c]=d[c].correspondingUseElement);return b.preventDefault&&(d.preventDefault=function(){b.preventDefault()}),d},getTarget:function(b){var c=this.captureInfo[b.pointerId];return c?b._target!==c&&b.type in t?void 0:c:b._target},propagate:function(b,
c,d){for(var e=b.target,j=[];e!==document&&!e.contains(b.relatedTarget);)if(j.push(e),e=e.parentNode,!e)return;d&&j.reverse();j.forEach(function(d){b.target=d;c.call(this,b)},this)},setCapture:function(c,d,e){this.captureInfo[c]&&this.releaseCapture(c,e);this.captureInfo[c]=d;this.implicitRelease=this.releaseCapture.bind(this,c,e);document.addEventListener("pointerup",this.implicitRelease);document.addEventListener("pointercancel",this.implicitRelease);var j=new b("gotpointercapture");j.pointerId=
c;j._target=d;e||this.asyncDispatchEvent(j)},releaseCapture:function(c,d){var e=this.captureInfo[c];if(e){this.captureInfo[c]=void 0;document.removeEventListener("pointerup",this.implicitRelease);document.removeEventListener("pointercancel",this.implicitRelease);var j=new b("lostpointercapture");j.pointerId=c;j._target=e;d||this.asyncDispatchEvent(j)}},dispatchEvent:function(b){var c=this.getTarget(b);if(c)return c.dispatchEvent(b)},asyncDispatchEvent:function(b){requestAnimationFrame(this.dispatchEvent.bind(this,
b))}};v.boundHandler=v.eventHandler.bind(v);var x={shadow:function(b){if(b)return b.shadowRoot||b.webkitShadowRoot},canTarget:function(b){return b&&Boolean(b.elementFromPoint)},targetingShadow:function(b){b=this.shadow(b);if(this.canTarget(b))return b},olderShadow:function(b){var c=b.olderShadowRoot;c||(b=b.querySelector("shadow"))&&(c=b.olderShadowRoot);return c},allShadows:function(b){var c=[];for(b=this.shadow(b);b;)c.push(b),b=this.olderShadow(b);return c},searchRoot:function(b,c,d){if(b){var e,
j=b.elementFromPoint(c,d);for(e=this.targetingShadow(j);e;){if(b=e.elementFromPoint(c,d))return e=this.targetingShadow(b),this.searchRoot(e,c,d)||b;e=this.olderShadow(e)}return j}},owner:function(b){for(;b.parentNode;)b=b.parentNode;return b.nodeType!==Node.DOCUMENT_NODE&&b.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(b=document),b},findTarget:function(b){var c=b.clientX,d=b.clientY;b=this.owner(b.target);return b.elementFromPoint(c,d)||(b=document),this.searchRoot(b,c,d)}},y=Array.prototype.forEach.call.bind(Array.prototype.forEach),
A=Array.prototype.map.call.bind(Array.prototype.map),B=Array.prototype.slice.call.bind(Array.prototype.slice),C=Array.prototype.filter.call.bind(Array.prototype.filter),I=window.MutationObserver||window.WebKitMutationObserver,z={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};e.prototype={watchSubtree:function(b){this.observer&&x.canTarget(b)&&this.observer.observe(b,z)},enableOnSubtree:function(b){this.watchSubtree(b);b===document&&"complete"!==document.readyState?
this.installOnLoad():this.installNewSubtree(b)},installNewSubtree:function(b){y(this.findElements(b),this.addElement,this)},findElements:function(b){return b.querySelectorAll?b.querySelectorAll("[touch-action]"):[]},removeElement:function(b){this.removeCallback(b)},addElement:function(b){this.addCallback(b)},elementChanged:function(b,c){this.changedCallback(b,c)},concatLists:function(b,c){return b.concat(B(c))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===
document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(b){return b.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(b){var c=A(b,this.findElements,this);return c.push(C(b,this.isElement)),c.reduce(this.concatLists,[])},mutationWatcher:function(b){b.forEach(this.mutationHandler,this)},mutationHandler:function(b){"childList"===b.type?(this.flattenMutationTree(b.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(b.removedNodes).forEach(this.removeElement,
this)):"attributes"===b.type&&this.elementChanged(b.target,b.oldValue)}};var D=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],F="",L=window.PointerEvent||window.MSPointerEvent,R=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,O=v.pointermap,N=[1,4,2,8,16],V=!1;try{V=1===(new MouseEvent("test",{buttons:1})).buttons}catch(da){}var G,E={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(b){v.listen(b,
this.events)},unregister:function(b){v.unlisten(b,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(b){var c,d=this.lastTouches,e=b.clientX;b=b.clientY;for(var j=0,f=d.length;j<f&&(c=d[j]);j++){var g=Math.abs(e-c.x),n=Math.abs(b-c.y);if(25>=g&&25>=n)return!0}},prepareEvent:function(b){var c=v.cloneEvent(b),d=c.preventDefault;return c.preventDefault=function(){b.preventDefault();d()},c.pointerId=this.POINTER_ID,c.isPrimary=!0,c.pointerType=this.POINTER_TYPE,c},prepareButtonsForMove:function(b,
c){var d=O.get(this.POINTER_ID);0!==c.which&&d?b.buttons=d.buttons:b.buttons=0;c.buttons=b.buttons},mousedown:function(b){if(!this.isEventSimulatedFromTouch(b)){var c=O.get(this.POINTER_ID),d=this.prepareEvent(b);V||(d.buttons=N[d.button],c&&(d.buttons|=c.buttons),b.buttons=d.buttons);O.set(this.POINTER_ID,b);c&&0!==c.buttons?v.move(d):v.down(d)}},mousemove:function(b){if(!this.isEventSimulatedFromTouch(b)){var c=this.prepareEvent(b);V||this.prepareButtonsForMove(c,b);c.button=-1;O.set(this.POINTER_ID,
b);v.move(c)}},mouseup:function(b){if(!this.isEventSimulatedFromTouch(b)){var c=O.get(this.POINTER_ID),d=this.prepareEvent(b);if(!V){var e=N[d.button];d.buttons=c?c.buttons&~e:0;b.buttons=d.buttons}O.set(this.POINTER_ID,b);d.buttons&=~N[d.button];0===d.buttons?v.up(d):v.move(d)}},mouseover:function(b){if(!this.isEventSimulatedFromTouch(b)){var c=this.prepareEvent(b);V||this.prepareButtonsForMove(c,b);c.button=-1;O.set(this.POINTER_ID,b);v.enterOver(c)}},mouseout:function(b){if(!this.isEventSimulatedFromTouch(b)){var c=
this.prepareEvent(b);V||this.prepareButtonsForMove(c,b);c.button=-1;v.leaveOut(c)}},cancel:function(b){b=this.prepareEvent(b);v.cancel(b);this.deactivateMouse()},deactivateMouse:function(){O["delete"](this.POINTER_ID)}},ha=v.captureInfo,S=x.findTarget.bind(x),J=x.allShadows.bind(x),K=v.pointermap,P={events:["touchstart","touchmove","touchend","touchcancel"],register:function(b){G.enableOnSubtree(b)},unregister:function(){},elementAdded:function(b){var c=b.getAttribute("touch-action"),d=this.touchActionToScrollType(c);
d&&(b._scrollType=d,v.listen(b,this.events),J(b).forEach(function(b){b._scrollType=d;v.listen(b,this.events)},this))},elementRemoved:function(b){b._scrollType=void 0;v.unlisten(b,this.events);J(b).forEach(function(b){b._scrollType=void 0;v.unlisten(b,this.events)},this)},elementChanged:function(b,c){var d=b.getAttribute("touch-action"),e=this.touchActionToScrollType(d),d=this.touchActionToScrollType(c);e&&d?(b._scrollType=e,J(b).forEach(function(b){b._scrollType=e},this)):d?this.elementRemoved(b):
e&&this.elementAdded(b)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(b){var c=this.scrollTypes;return"none"===b?"none":b===c.XSCROLLER?"X":b===c.YSCROLLER?"Y":c.SCROLLER.exec(b)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(b){return this.firstTouch===b.identifier},setPrimaryTouch:function(b){(0===K.size||1===K.size&&K.has(1))&&(this.firstTouch=b.identifier,this.firstXY=
{X:b.clientX,Y:b.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(b){b.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var b=function(){this.clickCount=0;this.resetId=null}.bind(this);this.resetId=setTimeout(b,200)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(b){return 0},touchToPointer:function(b){var c=this.currentTouchEvent,
d=v.cloneEvent(b),e=d.pointerId=b.identifier+2;d.target=ha[e]||S(d);d.bubbles=!0;d.cancelable=!0;d.detail=this.clickCount;d.button=0;d.buttons=this.typeToButtons(c.type);d.width=2*(b.radiusX||b.webkitRadiusX||0);d.height=2*(b.radiusY||b.webkitRadiusY||0);d.pressure=b.force||b.webkitForce||0.5;d.isPrimary=this.isPrimaryTouch(b);d.pointerType=this.POINTER_TYPE;d.altKey=c.altKey;d.ctrlKey=c.ctrlKey;d.metaKey=c.metaKey;d.shiftKey=c.shiftKey;var j=this;return d.preventDefault=function(){j.scrolling=!1;
j.firstXY=null;c.preventDefault()},d},processTouches:function(b,c){var d=b.changedTouches;this.currentTouchEvent=b;for(var e,j=0;j<d.length;j++)e=d[j],c.call(this,this.touchToPointer(e))},shouldScroll:function(b){if(this.firstXY){var c;c=b.currentTarget._scrollType;if("none"===c)c=!1;else if("XY"===c)c=!0;else{b=b.changedTouches[0];var d="Y"===c?"X":"Y";c=Math.abs(b["client"+c]-this.firstXY[c]);b=Math.abs(b["client"+d]-this.firstXY[d]);c=c>=b}return this.firstXY=null,c}},findTouch:function(b,c){for(var d,
e=0,j=b.length;e<j&&(d=b[e]);e++)if(d.identifier===c)return!0},vacuumTouches:function(b){var c=b.touches;if(K.size>=c.length){var d=[];K.forEach(function(b,e){1!==e&&!this.findTouch(c,e-2)&&d.push(b.out)},this);d.forEach(this.cancelOut,this)}},touchstart:function(b){this.vacuumTouches(b);this.setPrimaryTouch(b.changedTouches[0]);this.dedupSynthMouse(b);this.scrolling||(this.clickCount++,this.processTouches(b,this.overDown))},overDown:function(b){K.set(b.pointerId,{target:b.target,out:b,outTarget:b.target});
v.enterOver(b);v.down(b)},touchmove:function(b){this.scrolling||(this.shouldScroll(b)?(this.scrolling=!0,this.touchcancel(b)):(b.preventDefault(),this.processTouches(b,this.moveOverOut)))},moveOverOut:function(b){var c=K.get(b.pointerId);if(c){var d=c.out,e=c.outTarget;v.move(b);d&&e!==b.target&&(d.relatedTarget=b.target,b.relatedTarget=e,d.target=e,b.target?(v.leaveOut(d),v.enterOver(b)):(b.target=e,b.relatedTarget=null,this.cancelOut(b)));c.out=b;c.outTarget=b.target}},touchend:function(b){this.dedupSynthMouse(b);
this.processTouches(b,this.upOut)},upOut:function(b){this.scrolling||(v.up(b),v.leaveOut(b));this.cleanUpPointer(b)},touchcancel:function(b){this.processTouches(b,this.cancelOut)},cancelOut:function(b){v.cancel(b);v.leaveOut(b);this.cleanUpPointer(b)},cleanUpPointer:function(b){K["delete"](b.pointerId);this.removePrimaryPointer(b)},dedupSynthMouse:function(b){var c=E.lastTouches;b=b.changedTouches[0];this.isPrimaryTouch(b)&&(b={x:b.clientX,y:b.clientY},c.push(b),c=function(b,c){var d=b.indexOf(c);
-1<d&&b.splice(d,1)}.bind(null,c,b),setTimeout(c,2500))}};G=new e(P.elementAdded,P.elementRemoved,P.elementChanged,P);var Y,Z,ka,oa=v.pointermap,ea=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,ma={events:"MSPointerDown MSPointerMove MSPointerUp MSPointerOut MSPointerOver MSPointerCancel MSGotPointerCapture MSLostPointerCapture".split(" "),register:function(b){v.listen(b,this.events)},unregister:function(b){v.unlisten(b,this.events)},POINTER_TYPES:["","unavailable",
"touch","pen","mouse"],prepareEvent:function(b){var c=b;return ea&&(c=v.cloneEvent(b),c.pointerType=this.POINTER_TYPES[b.pointerType]),c},cleanup:function(b){oa["delete"](b)},MSPointerDown:function(b){oa.set(b.pointerId,b);b=this.prepareEvent(b);v.down(b)},MSPointerMove:function(b){b=this.prepareEvent(b);v.move(b)},MSPointerUp:function(b){var c=this.prepareEvent(b);v.up(c);this.cleanup(b.pointerId)},MSPointerOut:function(b){b=this.prepareEvent(b);v.leaveOut(b)},MSPointerOver:function(b){b=this.prepareEvent(b);
v.enterOver(b)},MSPointerCancel:function(b){var c=this.prepareEvent(b);v.cancel(c);this.cleanup(b.pointerId)},MSLostPointerCapture:function(b){b=v.makeEvent("lostpointercapture",b);v.dispatchEvent(b)},MSGotPointerCapture:function(b){b=v.makeEvent("gotpointercapture",b);v.dispatchEvent(b)}};window.navigator.msPointerEnabled?(Y=function(b){m(b);l(this);0!==v.pointermap.get(b).buttons&&(v.setCapture(b,this,!0),this.msSetPointerCapture(b))},Z=function(b){m(b);v.releaseCapture(b,!0);this.msReleasePointerCapture(b)}):
(Y=function(b){m(b);l(this);0!==v.pointermap.get(b).buttons&&v.setCapture(b,this)},Z=function(b){m(b);v.releaseCapture(b)});ka=function(b){return!!v.captureInfo[b]};L&&(D.forEach(function(b){String(b)===b?(F+=g(b)+f(b)+"\n",R&&(F+=d(b)+f(b)+"\n")):(F+=b.selectors.map(g)+f(b.rule)+"\n",R&&(F+=b.selectors.map(d)+f(b.rule)+"\n"))}),D=document.createElement("style"),D.textContent=F,document.head.appendChild(D));window.PointerEvent||((window.PointerEvent=b,window.navigator.msPointerEnabled)?(Object.defineProperty(window.navigator,
"maxTouchPoints",{value:window.navigator.msMaxTouchPoints,enumerable:!0}),v.registerSource("ms",ma)):(Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),v.registerSource("mouse",E),void 0!==window.ontouchstart&&v.registerSource("touch",P)),v.register(document));window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:Y},releasePointerCapture:{value:Z},hasPointerCapture:{value:ka}});return{dispatcher:v,Installer:e,
PointerEvent:b,PointerMap:r,targetFinding:x}});window.wgl={modules:{}};!function(b){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=b();else{var c;"undefined"!=typeof window?c=window:"undefined"!=typeof global?c=global:"undefined"!=typeof self&&(c=self);c.CANNON=b()}}(function(){return function c(e,d,g){function f(j,n){if(!d[j]){if(!e[j]){var r="function"==typeof require&&require;if(!n&&r)return r(j,!0);if(m)return m(j,!0);throw Error("Cannot find module '"+j+"'");}r=d[j]={exports:{}};e[j][0].call(r.exports,function(c){var d=e[j][1][c];return f(d?
d:c)},r,r.exports,c,e,d,g)}return d[j].exports}for(var m="function"==typeof require&&require,l=0;l<g.length;l++)f(g[l]);return f}({1:[function(c,e){e.exports={name:"cannon",version:"0.6.2",description:"A lightweight 3D physics engine written in JavaScript.",homepage:"https://github.com/schteppe/cannon.js",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["cannon.js","cannon","physics","engine","3d"],main:"./build/cannon.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/cannon.js.git"},
bugs:{url:"https://github.com/schteppe/cannon.js/issues"},licenses:[{type:"MIT"}],devDependencies:{jshint:"latest","uglify-js":"latest",nodeunit:"^0.9.0",grunt:"~0.4.0","grunt-contrib-jshint":"~0.1.1","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-concat":"~0.1.3","grunt-contrib-uglify":"^0.5.1","grunt-browserify":"^2.1.4","grunt-contrib-yuidoc":"^0.5.2",browserify:"*"},dependencies:{}}},{}],2:[function(c,e){e.exports={version:c("../package.json").version,AABB:c("./collision/AABB"),ArrayCollisionMatrix:c("./collision/ArrayCollisionMatrix"),
Body:c("./objects/Body"),Box:c("./shapes/Box"),Broadphase:c("./collision/Broadphase"),Constraint:c("./constraints/Constraint"),ContactEquation:c("./equations/ContactEquation"),Narrowphase:c("./world/Narrowphase"),ConeTwistConstraint:c("./constraints/ConeTwistConstraint"),ContactMaterial:c("./material/ContactMaterial"),ConvexPolyhedron:c("./shapes/ConvexPolyhedron"),Cylinder:c("./shapes/Cylinder"),DistanceConstraint:c("./constraints/DistanceConstraint"),Equation:c("./equations/Equation"),EventTarget:c("./utils/EventTarget"),
FrictionEquation:c("./equations/FrictionEquation"),GSSolver:c("./solver/GSSolver"),GridBroadphase:c("./collision/GridBroadphase"),Heightfield:c("./shapes/Heightfield"),HingeConstraint:c("./constraints/HingeConstraint"),LockConstraint:c("./constraints/LockConstraint"),Mat3:c("./math/Mat3"),Material:c("./material/Material"),NaiveBroadphase:c("./collision/NaiveBroadphase"),ObjectCollisionMatrix:c("./collision/ObjectCollisionMatrix"),Pool:c("./utils/Pool"),Particle:c("./shapes/Particle"),Plane:c("./shapes/Plane"),
PointToPointConstraint:c("./constraints/PointToPointConstraint"),Quaternion:c("./math/Quaternion"),Ray:c("./collision/Ray"),RaycastVehicle:c("./objects/RaycastVehicle"),RaycastResult:c("./collision/RaycastResult"),RigidVehicle:c("./objects/RigidVehicle"),RotationalEquation:c("./equations/RotationalEquation"),RotationalMotorEquation:c("./equations/RotationalMotorEquation"),SAPBroadphase:c("./collision/SAPBroadphase"),SPHSystem:c("./objects/SPHSystem"),Shape:c("./shapes/Shape"),Solver:c("./solver/Solver"),
Sphere:c("./shapes/Sphere"),SplitSolver:c("./solver/SplitSolver"),Spring:c("./objects/Spring"),Trimesh:c("./shapes/Trimesh"),Vec3:c("./math/Vec3"),Vec3Pool:c("./utils/Vec3Pool"),World:c("./world/World")}},{"../package.json":1,"./collision/AABB":3,"./collision/ArrayCollisionMatrix":4,"./collision/Broadphase":5,"./collision/GridBroadphase":6,"./collision/NaiveBroadphase":7,"./collision/ObjectCollisionMatrix":8,"./collision/Ray":9,"./collision/RaycastResult":10,"./collision/SAPBroadphase":11,"./constraints/ConeTwistConstraint":12,
"./constraints/Constraint":13,"./constraints/DistanceConstraint":14,"./constraints/HingeConstraint":15,"./constraints/LockConstraint":16,"./constraints/PointToPointConstraint":17,"./equations/ContactEquation":19,"./equations/Equation":20,"./equations/FrictionEquation":21,"./equations/RotationalEquation":22,"./equations/RotationalMotorEquation":23,"./material/ContactMaterial":24,"./material/Material":25,"./math/Mat3":27,"./math/Quaternion":28,"./math/Vec3":30,"./objects/Body":31,"./objects/RaycastVehicle":32,
"./objects/RigidVehicle":33,"./objects/SPHSystem":34,"./objects/Spring":35,"./shapes/Box":37,"./shapes/ConvexPolyhedron":38,"./shapes/Cylinder":39,"./shapes/Heightfield":40,"./shapes/Particle":41,"./shapes/Plane":42,"./shapes/Shape":43,"./shapes/Sphere":44,"./shapes/Trimesh":45,"./solver/GSSolver":46,"./solver/Solver":47,"./solver/SplitSolver":48,"./utils/EventTarget":49,"./utils/Pool":51,"./utils/Vec3Pool":54,"./world/Narrowphase":55,"./world/World":56}],3:[function(c,e){function d(c){c=c||{};this.lowerBound=
new g;c.lowerBound&&this.lowerBound.copy(c.lowerBound);this.upperBound=new g;c.upperBound&&this.upperBound.copy(c.upperBound)}var g=c("../math/Vec3");c("../utils/Utils");e.exports=d;var f=new g;d.prototype.setFromPoints=function(c,d,e,g){var q=this.lowerBound,m=this.upperBound;q.copy(c[0]);e&&e.vmult(q,q);m.copy(q);for(var t=1;t<c.length;t++){var u=c[t];e&&(e.vmult(u,f),u=f);u.x>m.x&&(m.x=u.x);u.x<q.x&&(q.x=u.x);u.y>m.y&&(m.y=u.y);u.y<q.y&&(q.y=u.y);u.z>m.z&&(m.z=u.z);u.z<q.z&&(q.z=u.z)}d&&(d.vadd(q,
q),d.vadd(m,m));g&&(q.x-=g,q.y-=g,q.z-=g,m.x+=g,m.y+=g,m.z+=g);return this};d.prototype.copy=function(c){this.lowerBound.copy(c.lowerBound);this.upperBound.copy(c.upperBound);return this};d.prototype.clone=function(){return(new d).copy(this)};d.prototype.extend=function(c){var d=c.lowerBound.x;this.lowerBound.x>d&&(this.lowerBound.x=d);d=c.upperBound.x;this.upperBound.x<d&&(this.upperBound.x=d);d=c.lowerBound.y;this.lowerBound.y>d&&(this.lowerBound.y=d);d=c.upperBound.y;this.upperBound.y<d&&(this.upperBound.y=
d);d=c.lowerBound.z;this.lowerBound.z>d&&(this.lowerBound.z=d);d=c.upperBound.z;this.upperBound.z<d&&(this.upperBound.z=d)};d.prototype.overlaps=function(c){var d=this.lowerBound,e=this.upperBound,f=c.lowerBound;c=c.upperBound;return(f.x<=e.x&&e.x<=c.x||d.x<=c.x&&c.x<=e.x)&&(f.y<=e.y&&e.y<=c.y||d.y<=c.y&&c.y<=e.y)&&(f.z<=e.z&&e.z<=c.z||d.z<=c.z&&c.z<=e.z)};d.prototype.contains=function(c){var d=this.lowerBound,e=this.upperBound,f=c.lowerBound;c=c.upperBound;return d.x<=f.x&&e.x>=c.x&&d.y<=f.y&&e.y>=
c.y&&d.z<=f.z&&e.z>=c.z};d.prototype.getCorners=function(c,d,e,f,g,m,t,u){var v=this.lowerBound,x=this.upperBound;c.copy(v);d.set(x.x,v.y,v.z);e.set(x.x,x.y,v.z);f.set(v.x,x.y,x.z);g.set(x.x,v.y,v.z);m.set(v.x,x.y,v.z);t.set(v.x,v.y,x.z);u.copy(x)};var m=[new g,new g,new g,new g,new g,new g,new g,new g];d.prototype.toLocalFrame=function(c,d){this.getCorners(m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7]);for(var e=0;8!==e;e++){var f=m[e];c.pointToLocal(f,f)}return d.setFromPoints(m)};d.prototype.toWorldFrame=
function(c,d){this.getCorners(m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7]);for(var e=0;8!==e;e++){var f=m[e];c.pointToWorld(f,f)}return d.setFromPoints(m)}},{"../math/Vec3":30,"../utils/Utils":53}],4:[function(c,e){function d(){this.matrix=[]}e.exports=d;d.prototype.get=function(c,d){c=c.index;d=d.index;if(d>c){var e=d;d=c;c=e}return this.matrix[(c*(c+1)>>1)+d-1]};d.prototype.set=function(c,d,e){c=c.index;d=d.index;if(d>c){var l=d;d=c;c=l}this.matrix[(c*(c+1)>>1)+d-1]=e?1:0};d.prototype.reset=function(){for(var c=
0,d=this.matrix.length;c!==d;c++)this.matrix[c]=0};d.prototype.setNumObjects=function(c){this.matrix.length=c*(c-1)>>1}},{}],5:[function(c,e){function d(){this.world=null;this.useBoundingBoxes=!1;this.dirty=!0}var g=c("../objects/Body"),f=c("../math/Vec3"),m=c("../math/Quaternion");c("../shapes/Shape");c("../shapes/Plane");e.exports=d;d.prototype.collisionPairs=function(){throw Error("collisionPairs not implemented for this BroadPhase class!");};var l=g.STATIC|g.KINEMATIC;d.prototype.needBroadphaseCollision=
function(c,d){return 0===(c.collisionFilterGroup&d.collisionFilterMask)||0===(d.collisionFilterGroup&c.collisionFilterMask)||(0!==(c.type&l)||c.sleepState===g.SLEEPING)&&(0!==(d.type&l)||d.sleepState===g.SLEEPING)?!1:!0};d.prototype.intersectionTest=function(c,d,e,j){this.useBoundingBoxes?this.doBoundingBoxBroadphase(c,d,e,j):this.doBoundingSphereBroadphase(c,d,e,j)};var j=new f;new f;new m;new f;d.prototype.doBoundingSphereBroadphase=function(c,d,e,f){d.position.vsub(c.position,j);var g=Math.pow(c.boundingRadius+
d.boundingRadius,2);j.norm2()<g&&(e.push(c),f.push(d))};d.prototype.doBoundingBoxBroadphase=function(c,d,e,j){c.aabbNeedsUpdate&&c.computeAABB();d.aabbNeedsUpdate&&d.computeAABB();c.aabb.overlaps(d.aabb)&&(e.push(c),j.push(d))};var n={keys:[]},r=[],q=[];d.prototype.makePairsUnique=function(c,d){for(var e=c.length,j=0;j!==e;j++)r[j]=c[j],q[j]=d[j];c.length=0;for(j=d.length=0;j!==e;j++){var f=r[j].id,g=q[j].id,f=f<g?f+","+g:g+","+f;n[f]=j;n.keys.push(f)}for(j=0;j!==n.keys.length;j++)f=n.keys.pop(),
e=n[f],c.push(r[e]),d.push(q[e]),delete n[f]};d.prototype.setWorld=function(){};var s=new f;d.boundingSphereCheck=function(c,d){c.position.vsub(d.position,s);return Math.pow(c.shape.boundingSphereRadius+d.shape.boundingSphereRadius,2)>s.norm2()};d.prototype.aabbQuery=function(){console.warn(".aabbQuery is not implemented in this Broadphase subclass.");return[]}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Plane":42,"../shapes/Shape":43}],6:[function(c,e){function d(c,
d,e,l,m){g.apply(this);this.nx=e||10;this.ny=l||10;this.nz=m||10;this.aabbMin=c||new f(100,100,100);this.aabbMax=d||new f(-100,-100,-100);c=this.nx*this.ny*this.nz;if(0>=c)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[];this.binLengths=[];this.bins.length=c;this.binLengths.length=c;for(d=0;d<c;d++)this.bins[d]=[],this.binLengths[d]=0}e.exports=d;var g=c("./Broadphase"),f=c("../math/Vec3"),m=c("../shapes/Shape");d.prototype=new g;d.prototype.constructor=d;var l=new f;new f;d.prototype.collisionPairs=
function(c,d,e){function f(c,d,e,j,g,n,r){c=(c-F)*O|0;d=(d-L)*N|0;e=(e-R)*V|0;j=K((j-F)*O);g=K((g-L)*N);n=K((n-R)*V);0>c?c=0:c>=v&&(c=v-1);0>d?d=0:d>=x&&(d=x-1);0>e?e=0:e>=y&&(e=y-1);0>j?j=0:j>=v&&(j=v-1);0>g?g=0:g>=x&&(g=x-1);0>n?n=0:n>=y&&(n=y-1);c*=A;d*=B;e*=C;j*=A;g*=B;for(n*=C;c<=j;c+=A)for(var l=d;l<=g;l+=B)for(var q=e;q<=n;q+=C){var m=c+l+q;S[m][J[m]++]=r}}var g=c.numObjects();c=c.bodies;for(var t=this.aabbMax,u=this.aabbMin,v=this.nx,x=this.ny,y=this.nz,A=x*y,B=y,C=1,I=t.x,z=t.y,D=t.z,F=u.x,
L=u.y,R=u.z,O=v/(I-F),N=x/(z-L),V=y/(D-R),I=(I-F)/v,da=(z-L)/x,D=(D-R)/y,G=0.5*Math.sqrt(I*I+da*da+D*D),z=m.types,E=z.SPHERE,ha=z.PLANE,S=this.bins,J=this.binLengths,z=this.bins.length,u=0;u!==z;u++)J[u]=0;for(var K=Math.ceil,u=Math.min,t=Math.max,u=0;u!==g;u++){var t=c[u],P=t.shape;switch(P.type){case E:var Y=t.position.x,Z=t.position.y,ka=t.position.z,P=P.radius;f(Y-P,Z-P,ka-P,Y+P,Z+P,ka+P,t);break;case ha:P.worldNormalNeedsUpdate&&P.computeWorldNormal(t.quaternion);var ka=P.worldNormal,P=L+0.5*
da-t.position.y,oa=R+0.5*D-t.position.z,ea=l;ea.set(F+0.5*I-t.position.x,P,oa);for(var ma=Y=0;Y!==v;Y++,ma+=A,ea.y=P,ea.x+=I)for(var H=Z=0;Z!==x;Z++,H+=B,ea.z=oa,ea.y+=da)for(var ta=0,ba=0;ta!==y;ta++,ba+=C,ea.z+=D)if(ea.dot(ka)<G){var M=ma+H+ba;S[M][J[M]++]=t}break;default:t.aabbNeedsUpdate&&t.computeAABB(),f(t.aabb.lowerBound.x,t.aabb.lowerBound.y,t.aabb.lowerBound.z,t.aabb.upperBound.x,t.aabb.upperBound.y,t.aabb.upperBound.z,t)}}for(u=0;u!==z;u++)if(g=J[u],1<g){c=S[u];for(Y=0;Y!==g;Y++){t=c[Y];
for(Z=0;Z!==Y;Z++)I=c[Z],this.needBroadphaseCollision(t,I)&&this.intersectionTest(t,I,d,e)}}this.makePairsUnique(d,e)}},{"../math/Vec3":30,"../shapes/Shape":43,"./Broadphase":5}],7:[function(c,e){function d(){g.apply(this)}e.exports=d;var g=c("./Broadphase"),f=c("./AABB");d.prototype=new g;d.prototype.constructor=d;d.prototype.collisionPairs=function(c,d,e){c=c.bodies;var f=c.length,g,q,s,t;for(g=0;g!==f;g++)for(q=0;q!==g;q++)s=c[g],t=c[q],this.needBroadphaseCollision(s,t)&&this.intersectionTest(s,
t,d,e)};new f;d.prototype.aabbQuery=function(c,d,e){e=e||[];for(var f=0;f<c.bodies.length;f++){var g=c.bodies[f];g.aabbNeedsUpdate&&g.computeAABB();g.aabb.overlaps(d)&&e.push(g)}return e}},{"./AABB":3,"./Broadphase":5}],8:[function(c,e){function d(){this.matrix={}}e.exports=d;d.prototype.get=function(c,d){c=c.id;d=d.id;if(d>c){var e=d;d=c;c=e}return c+"-"+d in this.matrix};d.prototype.set=function(c,d,e){c=c.id;d=d.id;if(d>c){var l=d;d=c;c=l}e?this.matrix[c+"-"+d]=!0:delete this.matrix[c+"-"+d]};
d.prototype.reset=function(){this.matrix={}};d.prototype.setNumObjects=function(){}},{}],9:[function(c,e){function d(c,e){this.from=c?c.clone():new f;this.to=e?e.clone():new f;this._direction=new f;this.precision=1E-4;this.checkCollisionResponse=!0;this.skipBackfaces=!1;this.collisionFilterGroup=this.collisionFilterMask=-1;this.mode=d.ANY;this.result=new j;this.hasHit=!1;this.callback=function(){}}function g(c,d,e,j){j.vsub(d,S);e.vsub(d,t);c.vsub(d,u);c=S.dot(S);d=S.dot(t);e=S.dot(u);j=t.dot(t);
var f=t.dot(u),g,n;return 0<=(g=j*e-d*f)&&0<=(n=c*f-d*e)&&g+n<c*j-d*d}e.exports=d;var f=c("../math/Vec3"),m=c("../math/Quaternion"),l=c("../math/Transform");c("../shapes/ConvexPolyhedron");c("../shapes/Box");var j=c("../collision/RaycastResult"),n=c("../shapes/Shape"),r=c("../collision/AABB");d.prototype.constructor=d;d.CLOSEST=1;d.ANY=2;d.ALL=4;var q=new r,s=[];d.prototype.intersectWorld=function(c,e){this.mode=e.mode||d.ANY;this.result=e.result||new j;this.skipBackfaces=!!e.skipBackfaces;this.collisionFilterMask=
"undefined"!==typeof e.collisionFilterMask?e.collisionFilterMask:-1;this.collisionFilterGroup="undefined"!==typeof e.collisionFilterGroup?e.collisionFilterGroup:-1;e.from&&this.from.copy(e.from);e.to&&this.to.copy(e.to);this.callback=e.callback||function(){};this.hasHit=!1;this.result.reset();this._updateDirection();this.getAABB(q);s.length=0;c.broadphase.aabbQuery(c,q,s);this.intersectBodies(s);return this.hasHit};var t=new f,u=new f;d.pointInTriangle=g;var v=new f,x=new m;d.prototype.intersectBody=
function(c,d){d&&(this.result=d,this._updateDirection());var e=this.checkCollisionResponse;if(!e||c.collisionResponse)if(!(0===(this.collisionFilterGroup&c.collisionFilterMask)||0===(c.collisionFilterGroup&this.collisionFilterMask)))for(var j=0,f=c.shapes.length;j<f;j++){var g=c.shapes[j];if(!e||g.collisionResponse)if(c.quaternion.mult(c.shapeOrientations[j],x),c.quaternion.vmult(c.shapeOffsets[j],v),v.vadd(c.position,v),this.intersectShape(g,x,v,c),this.result._shouldStop)break}};d.prototype.intersectBodies=
function(c,d){d&&(this.result=d,this._updateDirection());for(var e=0,j=c.length;!this.result._shouldStop&&e<j;e++)this.intersectBody(c[e])};d.prototype._updateDirection=function(){this.to.vsub(this.from,this._direction);this._direction.normalize()};d.prototype.intersectShape=function(c,d,e,j){var f=this.from,g=this._direction;e.vsub(f,S);var n=S.dot(g);g.mult(n,J);J.vadd(f,J);e.distanceTo(J)>c.boundingSphereRadius||(f=this[c.type])&&f.call(this,c,d,e,j)};new f;new f;var y=new f,A=new f,B=new f,C=
new f;new f;new j;d.prototype.intersectBox=function(c,d,e,j){return this.intersectConvex(c.convexPolyhedronRepresentation,d,e,j)};d.prototype[n.types.BOX]=d.prototype.intersectBox;d.prototype.intersectPlane=function(c,d,e,j){var g=this.from,n=this.to,r=this._direction,l=new f(0,0,1);d.vmult(l,l);var q=new f;g.vsub(e,q);d=q.dot(l);n.vsub(e,q);q=q.dot(l);if(!(0<d*q)&&!(g.distanceTo(n)<d)&&(q=l.dot(r),!(Math.abs(q)<this.precision))){var m=new f,n=new f;d=new f;g.vsub(e,m);e=-l.dot(m)/q;r.scale(e,n);
g.vadd(n,d);this.reportIntersection(l,d,c,j,-1)}};d.prototype[n.types.PLANE]=d.prototype.intersectPlane;d.prototype.getAABB=function(c){var d=this.to,e=this.from;c.lowerBound.x=Math.min(d.x,e.x);c.lowerBound.y=Math.min(d.y,e.y);c.lowerBound.z=Math.min(d.z,e.z);c.upperBound.x=Math.max(d.x,e.x);c.upperBound.y=Math.max(d.y,e.y);c.upperBound.z=Math.max(d.z,e.z)};var I={faceList:[0]};d.prototype.intersectHeightfield=function(c,e,j,g){var n=new f,r=new d(this.from,this.to);l.pointToLocalFrame(j,e,r.from,
r.from);l.pointToLocalFrame(j,e,r.to,r.to);var q=[],m=null,s=null,t=null,u=null,v=c.getIndexOfPosition(r.from.x,r.from.y,q,!1);v&&(m=q[0],s=q[1],t=q[0],u=q[1]);if(v=c.getIndexOfPosition(r.to.x,r.to.y,q,!1)){if(null===m||q[0]<m)m=q[0];if(null===t||q[0]>t)t=q[0];if(null===s||q[1]<s)s=q[1];if(null===u||q[1]>u)u=q[1]}if(null!==m){c.getRectMinMax(m,s,t,u,[]);for(r=m;r<=t;r++)for(q=s;q<=u;q++){if(this.result._shouldStop)return;c.getConvexTrianglePillar(r,q,!1);l.pointToWorldFrame(j,e,c.pillarOffset,n);
this.intersectConvex(c.pillarConvex,e,n,g,I);if(this.result._shouldStop)return;c.getConvexTrianglePillar(r,q,!0);l.pointToWorldFrame(j,e,c.pillarOffset,n);this.intersectConvex(c.pillarConvex,e,n,g,I)}}};d.prototype[n.types.HEIGHTFIELD]=d.prototype.intersectHeightfield;var z=new f,D=new f;d.prototype.intersectSphere=function(c,d,e,j){d=this.from;var f=this.to,g=c.radius,n=Math.pow(f.x-d.x,2)+Math.pow(f.y-d.y,2)+Math.pow(f.z-d.z,2),r=2*((f.x-d.x)*(d.x-e.x)+(f.y-d.y)*(d.y-e.y)+(f.z-d.z)*(d.z-e.z)),g=
Math.pow(d.x-e.x,2)+Math.pow(d.y-e.y,2)+Math.pow(d.z-e.z,2)-Math.pow(g,2),l=Math.pow(r,2)-4*n*g;0>l||(0===l?(d.lerp(f,l,z),z.vsub(e,D),D.normalize(),this.reportIntersection(D,z,c,j,-1)):(g=(-r-Math.sqrt(l))/(2*n),n=(-r+Math.sqrt(l))/(2*n),0<=g&&1>=g&&(d.lerp(f,g,z),z.vsub(e,D),D.normalize(),this.reportIntersection(D,z,c,j,-1)),!this.result._shouldStop&&(0<=n&&1>=n)&&(d.lerp(f,n,z),z.vsub(e,D),D.normalize(),this.reportIntersection(D,z,c,j,-1))))};d.prototype[n.types.SPHERE]=d.prototype.intersectSphere;
var F=new f;new f;new f;var L=new f;d.prototype.intersectConvex=function(c,d,e,j,f){f=f&&f.faceList||null;for(var n=c.faces,r=c.vertices,l=c.faceNormals,q=this._direction,m=this.from,s=m.distanceTo(this.to),t=f?f.length:n.length,u=this.result,v=0;!u._shouldStop&&v<t;v++){var x=f?f[v]:v,z=n[x],J=l[x],N=d,E=e;L.copy(r[z[0]]);N.vmult(L,L);L.vadd(E,L);L.vsub(m,L);N.vmult(J,F);J=q.dot(F);if(!(Math.abs(J)<this.precision)&&(J=F.dot(L)/J,!(0>J))){q.mult(J,y);y.vadd(m,y);A.copy(r[z[0]]);N.vmult(A,A);E.vadd(A,
A);for(J=1;!u._shouldStop&&J<z.length-1;J++){B.copy(r[z[J]]);C.copy(r[z[J+1]]);N.vmult(B,B);N.vmult(C,C);E.vadd(B,B);E.vadd(C,C);var G=y.distanceTo(m);!g(y,A,B,C)&&!g(y,B,A,C)||G>s||this.reportIntersection(F,y,c,j,x)}}}};d.prototype[n.types.CONVEXPOLYHEDRON]=d.prototype.intersectConvex;var R=new f,O=new f,N=new f,V=new f,da=new f,G=new f;new r;var E=[],ha=new l;d.prototype.intersectTrimesh=function(c,d,e,j){var f=c.indices,n=this.from,r=this.to,q=this._direction;ha.position.copy(e);ha.quaternion.copy(d);
l.vectorToLocalFrame(e,d,q,O);l.pointToLocalFrame(e,d,n,N);l.pointToLocalFrame(e,d,r,V);n=N.distanceSquared(V);c.tree.rayQuery(this,ha,E);r=0;for(q=E.length;!this.result._shouldStop&&r!==q;r++){var m=E[r];c.getNormal(m,R);c.getVertex(f[3*m],A);A.vsub(N,L);var s=O.dot(R),s=R.dot(L)/s;0>s||(O.scale(s,y),y.vadd(N,y),c.getVertex(f[3*m+1],B),c.getVertex(f[3*m+2],C),s=y.distanceSquared(N),!g(y,B,A,C)&&!g(y,A,B,C)||s>n||(l.vectorToWorldFrame(d,R,da),l.pointToWorldFrame(e,d,y,G),this.reportIntersection(da,
G,c,j,m)))}E.length=0};d.prototype[n.types.TRIMESH]=d.prototype.intersectTrimesh;d.prototype.reportIntersection=function(c,e,j,f,g){var n=this.from,r=this.to,l=n.distanceTo(e),q=this.result;if(!(this.skipBackfaces&&0<c.dot(this._direction)))switch(q.hitFaceIndex="undefined"!==typeof g?g:-1,this.mode){case d.ALL:this.hasHit=!0;q.set(n,r,c,e,j,f,l);q.hasHit=!0;this.callback(q);break;case d.CLOSEST:if(l<q.distance||!q.hasHit)this.hasHit=!0,q.hasHit=!0,q.set(n,r,c,e,j,f,l);break;case d.ANY:this.hasHit=
!0,q.hasHit=!0,q.set(n,r,c,e,j,f,l),q._shouldStop=!0}};var S=new f,J=new f},{"../collision/AABB":3,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/Box":37,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43}],10:[function(c,e){function d(){this.rayFromWorld=new g;this.rayToWorld=new g;this.hitNormalWorld=new g;this.hitPointWorld=new g;this.hasHit=!1;this.body=this.shape=null;this.distance=this.hitFaceIndex=-1;this._shouldStop=!1}var g=c("../math/Vec3");
e.exports=d;d.prototype.reset=function(){this.rayFromWorld.setZero();this.rayToWorld.setZero();this.hitNormalWorld.setZero();this.hitPointWorld.setZero();this.hasHit=!1;this.body=this.shape=null;this.distance=this.hitFaceIndex=-1;this._shouldStop=!1};d.prototype.abort=function(){this._shouldStop=!0};d.prototype.set=function(c,d,e,j,g,r,q){this.rayFromWorld.copy(c);this.rayToWorld.copy(d);this.hitNormalWorld.copy(e);this.hitPointWorld.copy(j);this.shape=g;this.body=r;this.distance=q}},{"../math/Vec3":30}],
11:[function(c,e){function d(c){g.apply(this);this.axisList=[];this.world=null;this.axisIndex=0;var d=this.axisList;this._addBodyHandler=function(c){d.push(c.body)};this._removeBodyHandler=function(c){c=d.indexOf(c.body);-1!==c&&d.splice(c,1)};c&&this.setWorld(c)}c("../shapes/Shape");var g=c("../collision/Broadphase");e.exports=d;d.prototype=new g;d.prototype.setWorld=function(c){for(var d=this.axisList.length=0;d<c.bodies.length;d++)this.axisList.push(c.bodies[d]);c.removeEventListener("addBody",
this._addBodyHandler);c.removeEventListener("removeBody",this._removeBodyHandler);c.addEventListener("addBody",this._addBodyHandler);c.addEventListener("removeBody",this._removeBodyHandler);this.world=c;this.dirty=!0};d.insertionSortX=function(c){for(var d=1,e=c.length;d<e;d++){for(var j=c[d],g=d-1;0<=g&&!(c[g].aabb.lowerBound.x<=j.aabb.lowerBound.x);g--)c[g+1]=c[g];c[g+1]=j}return c};d.insertionSortY=function(c){for(var d=1,e=c.length;d<e;d++){for(var j=c[d],g=d-1;0<=g&&!(c[g].aabb.lowerBound.y<=
j.aabb.lowerBound.y);g--)c[g+1]=c[g];c[g+1]=j}return c};d.insertionSortZ=function(c){for(var d=1,e=c.length;d<e;d++){for(var j=c[d],g=d-1;0<=g&&!(c[g].aabb.lowerBound.z<=j.aabb.lowerBound.z);g--)c[g+1]=c[g];c[g+1]=j}return c};d.prototype.collisionPairs=function(c,e,g){c=this.axisList;var j=c.length,n=this.axisIndex,r,q;this.dirty&&(this.sortList(),this.dirty=!1);for(r=0;r!==j;r++){var s=c[r];for(q=r+1;q<j;q++){var t=c[q];if(this.needBroadphaseCollision(s,t)){if(!d.checkBounds(s,t,n))break;this.intersectionTest(s,
t,e,g)}}}};d.prototype.sortList=function(){for(var c=this.axisList,e=this.axisIndex,g=c.length,j=0;j!==g;j++){var n=c[j];n.aabbNeedsUpdate&&n.computeAABB()}0===e?d.insertionSortX(c):1===e?d.insertionSortY(c):2===e&&d.insertionSortZ(c)};d.checkBounds=function(c,d,e){var j,g;0===e?(j=c.position.x,g=d.position.x):1===e?(j=c.position.y,g=d.position.y):2===e&&(j=c.position.z,g=d.position.z);return g-d.boundingRadius<j+c.boundingRadius};d.prototype.autoDetectAxis=function(){for(var c=0,d=0,e=0,j=0,g=0,
r=0,q=this.axisList,s=q.length,t=1/s,u=0;u!==s;u++)var v=q[u],x=v.position.x,c=c+x,d=d+x*x,x=v.position.y,e=e+x,j=j+x*x,v=v.position.z,g=g+v,r=r+v*v;c=d-c*c*t;e=j-e*e*t;g=r-g*g*t;this.axisIndex=c>e?c>g?0:2:e>g?1:2};d.prototype.aabbQuery=function(c,d,e){e=e||[];this.dirty&&(this.sortList(),this.dirty=!1);c=this.axisList;for(var j=0;j<c.length;j++){var g=c[j];g.aabbNeedsUpdate&&g.computeAABB();g.aabb.overlaps(d)&&e.push(g)}return e}},{"../collision/Broadphase":5,"../shapes/Shape":43}],12:[function(c,
e){function d(c,d,e){e=e||{};var q="undefined"!==typeof e.maxForce?e.maxForce:1E6,s=e.pivotA?e.pivotA.clone():new l,t=e.pivotB?e.pivotB.clone():new l;this.axisA=e.axisA?e.axisA.clone():new l;this.axisB=e.axisB?e.axisB.clone():new l;g.call(this,c,s,d,t,q);this.collideConnected=!!e.collideConnected;this.angle="undefined"!==typeof e.angle?e.angle:0;s=this.coneEquation=new f(c,d,e);c=this.twistEquation=new m(c,d,e);this.twistAngle="undefined"!==typeof e.twistAngle?e.twistAngle:0;s.maxForce=0;s.minForce=
-q;c.maxForce=0;c.minForce=-q;this.equations.push(s,c)}e.exports=d;c("./Constraint");var g=c("./PointToPointConstraint"),f=c("../equations/ConeEquation"),m=c("../equations/RotationalEquation");c("../equations/ContactEquation");var l=c("../math/Vec3");d.prototype=new g;d.constructor=d;new l;new l;d.prototype.update=function(){var c=this.bodyA,d=this.bodyB,e=this.coneEquation,f=this.twistEquation;g.prototype.update.call(this);c.vectorToWorldFrame(this.axisA,e.axisA);d.vectorToWorldFrame(this.axisB,
e.axisB);this.axisA.tangents(f.axisA,f.axisA);c.vectorToWorldFrame(f.axisA,f.axisA);this.axisB.tangents(f.axisB,f.axisB);d.vectorToWorldFrame(f.axisB,f.axisB);e.angle=this.angle;f.maxAngle=this.twistAngle}},{"../equations/ConeEquation":18,"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],13:[function(c,e){function d(c,e,l){l=g.defaults(l,{collideConnected:!0,wakeUpBodies:!0});this.equations=[];this.bodyA=c;this.bodyB=
e;this.id=d.idCounter++;this.collideConnected=l.collideConnected;l.wakeUpBodies&&(c&&c.wakeUp(),e&&e.wakeUp())}e.exports=d;var g=c("../utils/Utils");d.prototype.update=function(){throw Error("method update() not implmemented in this Constraint subclass!");};d.prototype.enable=function(){for(var c=this.equations,d=0;d<c.length;d++)c[d].enabled=!0};d.prototype.disable=function(){for(var c=this.equations,d=0;d<c.length;d++)c[d].enabled=!1};d.idCounter=0},{"../utils/Utils":53}],14:[function(c,e){function d(c,
d,e,n){g.call(this,c,d);"undefined"===typeof e&&(e=c.position.distanceTo(d.position));"undefined"===typeof n&&(n=1E6);this.distance=e;c=this.distanceEquation=new f(c,d);this.equations.push(c);c.minForce=-n;c.maxForce=n}e.exports=d;var g=c("./Constraint"),f=c("../equations/ContactEquation");d.prototype=new g;d.prototype.update=function(){var c=this.distanceEquation,d=0.5*this.distance,e=c.ni;this.bodyB.position.vsub(this.bodyA.position,e);e.normalize();e.mult(d,c.ri);e.mult(-d,c.rj)}},{"../equations/ContactEquation":19,
"./Constraint":13}],15:[function(c,e){function d(c,d,e){e=e||{};var j="undefined"!==typeof e.maxForce?e.maxForce:1E6,n=e.pivotA?e.pivotA.clone():new l,v=e.pivotB?e.pivotB.clone():new l;g.call(this,c,n,d,v,j);(this.axisA=e.axisA?e.axisA.clone():new l(1,0,0)).normalize();(this.axisB=e.axisB?e.axisB.clone():new l(1,0,0)).normalize();n=this.rotationalEquation1=new f(c,d,e);e=this.rotationalEquation2=new f(c,d,e);c=this.motorEquation=new m(c,d,j);c.enabled=!1;this.equations.push(n,e,c)}e.exports=d;c("./Constraint");
var g=c("./PointToPointConstraint"),f=c("../equations/RotationalEquation"),m=c("../equations/RotationalMotorEquation");c("../equations/ContactEquation");var l=c("../math/Vec3");d.prototype=new g;d.constructor=d;d.prototype.enableMotor=function(){this.motorEquation.enabled=!0};d.prototype.disableMotor=function(){this.motorEquation.enabled=!1};d.prototype.setMotorSpeed=function(c){this.motorEquation.targetVelocity=c};d.prototype.setMotorMaxForce=function(c){this.motorEquation.maxForce=c;this.motorEquation.minForce=
-c};var j=new l,n=new l;d.prototype.update=function(){var c=this.bodyA,d=this.bodyB,e=this.motorEquation,f=this.rotationalEquation1,l=this.rotationalEquation2,m=this.axisA,x=this.axisB;g.prototype.update.call(this);c.quaternion.vmult(m,j);d.quaternion.vmult(x,n);j.tangents(f.axisA,l.axisA);f.axisB.copy(n);l.axisB.copy(n);this.motorEquation.enabled&&(c.quaternion.vmult(this.axisA,e.axisA),d.quaternion.vmult(this.axisB,e.axisB))}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,
"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],16:[function(c,e){function d(c,d,e){e=e||{};var r="undefined"!==typeof e.maxForce?e.maxForce:1E6,q=new m,s=new m,t=new m;c.position.vadd(d.position,t);t.scale(0.5,t);d.pointToLocalFrame(t,s);c.pointToLocalFrame(t,q);g.call(this,c,q,d,s,r);r=this.rotationalEquation1=new f(c,d,e);q=this.rotationalEquation2=new f(c,d,e);c=this.rotationalEquation3=new f(c,d,e);this.equations.push(r,q,c)}e.exports=
d;c("./Constraint");var g=c("./PointToPointConstraint"),f=c("../equations/RotationalEquation");c("../equations/RotationalMotorEquation");c("../equations/ContactEquation");var m=c("../math/Vec3");d.prototype=new g;d.constructor=d;new m;new m;d.prototype.update=function(){var c=this.bodyA,d=this.bodyB,e=this.rotationalEquation1,f=this.rotationalEquation2,q=this.rotationalEquation3;g.prototype.update.call(this);c.vectorToWorldFrame(m.UNIT_X,e.axisA);d.vectorToWorldFrame(m.UNIT_Y,e.axisB);c.vectorToWorldFrame(m.UNIT_Y,
f.axisA);d.vectorToWorldFrame(m.UNIT_Z,f.axisB);c.vectorToWorldFrame(m.UNIT_Z,q.axisA);d.vectorToWorldFrame(m.UNIT_X,q.axisB)}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],17:[function(c,e){function d(c,d,e,r,q){g.call(this,c,e);q="undefined"!==typeof q?q:1E6;this.pivotA=d?d.clone():new m;this.pivotB=r?r.clone():new m;d=this.equationX=new f(c,e);r=this.equationY=
new f(c,e);c=this.equationZ=new f(c,e);this.equations.push(d,r,c);d.minForce=r.minForce=c.minForce=-q;d.maxForce=r.maxForce=c.maxForce=q;d.ni.set(1,0,0);r.ni.set(0,1,0);c.ni.set(0,0,1)}e.exports=d;var g=c("./Constraint"),f=c("../equations/ContactEquation"),m=c("../math/Vec3");d.prototype=new g;d.prototype.update=function(){var c=this.bodyB,d=this.equationX,e=this.equationY,f=this.equationZ;this.bodyA.quaternion.vmult(this.pivotA,d.ri);c.quaternion.vmult(this.pivotB,d.rj);e.ri.copy(d.ri);e.rj.copy(d.rj);
f.ri.copy(d.ri);f.rj.copy(d.rj)}},{"../equations/ContactEquation":19,"../math/Vec3":30,"./Constraint":13}],18:[function(c,e){function d(c,d,e){e=e||{};var l="undefined"!==typeof e.maxForce?e.maxForce:1E6;f.call(this,c,d,-l,l);this.axisA=e.axisA?e.axisA.clone():new g(1,0,0);this.axisB=e.axisB?e.axisB.clone():new g(0,1,0);this.angle="undefined"!==typeof e.angle?e.angle:0}e.exports=d;var g=c("../math/Vec3");c("../math/Mat3");var f=c("./Equation");d.prototype=new f;d.prototype.constructor=d;var m=new g,
l=new g;d.prototype.computeB=function(c){var d=this.a,e=this.b,f=this.axisA,g=this.axisB,t=this.jacobianElementA,u=this.jacobianElementB;f.cross(g,m);g.cross(f,l);t.rotational.copy(l);u.rotational.copy(m);f=Math.cos(this.angle)-f.dot(g);g=this.computeGW();t=this.computeGiMf();return-f*d-g*e-c*t}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],19:[function(c,e){function d(c,d,e){g.call(this,c,d,0,"undefined"!==typeof e?e:1E6);this.restitution=0;this.ri=new f;this.rj=new f;this.ni=new f}e.exports=
d;var g=c("./Equation"),f=c("../math/Vec3");c("../math/Mat3");d.prototype=new g;d.prototype.constructor=d;var m=new f,l=new f,j=new f;d.prototype.computeB=function(c){var d=this.a,e=this.b,f=this.bi,g=this.bj,n=this.ri,r=this.rj,q=f.velocity,s=f.angularVelocity,t=g.velocity,F=g.angularVelocity,L=this.jacobianElementA,R=this.jacobianElementB,O=this.ni;n.cross(O,m);r.cross(O,l);O.negate(L.spatial);m.negate(L.rotational);R.spatial.copy(O);R.rotational.copy(l);j.copy(g.position);j.vadd(r,j);j.vsub(f.position,
j);j.vsub(n,j);f=O.dot(j);g=this.restitution+1;q=g*t.dot(O)-g*q.dot(O)+F.dot(l)-s.dot(m);s=this.computeGiMf();return-f*d-q*e-c*s};var n=new f,r=new f,q=new f,s=new f,t=new f;d.prototype.getImpactVelocityAlongNormal=function(){this.bi.position.vadd(this.ri,q);this.bj.position.vadd(this.rj,s);this.bi.getVelocityAtWorldPoint(q,n);this.bj.getVelocityAtWorldPoint(s,r);n.vsub(r,t);return this.ni.dot(t)}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],20:[function(c,e){function d(c,e,j,f){this.id=
d.id++;this.minForce="undefined"===typeof j?-1E6:j;this.maxForce="undefined"===typeof f?1E6:f;this.bi=c;this.bj=e;this.eps=this.b=this.a=0;this.jacobianElementA=new g;this.jacobianElementB=new g;this.enabled=!0;this.setSpookParams(1E7,4,1/60)}e.exports=d;var g=c("../math/JacobianElement"),f=c("../math/Vec3");d.prototype.constructor=d;d.id=0;d.prototype.setSpookParams=function(c,d,e){this.a=4/(e*(1+4*d));this.b=4*d/(1+4*d);this.eps=4/(e*e*c*(1+4*d))};d.prototype.computeB=function(c,d,e){var j=this.computeGW(),
f=this.computeGq(),g=this.computeGiMf();return-f*c-j*d-g*e};d.prototype.computeGq=function(){var c=this.jacobianElementB,d=this.bj.position;return this.jacobianElementA.spatial.dot(this.bi.position)+c.spatial.dot(d)};var m=new f;d.prototype.computeGW=function(){var c=this.jacobianElementB,d=this.bi,e=this.bj,j=e.velocity,e=e.angularVelocity||m;return this.jacobianElementA.multiplyVectors(d.velocity,d.angularVelocity||m)+c.multiplyVectors(j,e)};d.prototype.computeGWlambda=function(){var c=this.jacobianElementB,
d=this.bi,e=this.bj,j=e.vlambda,e=e.wlambda||m;return this.jacobianElementA.multiplyVectors(d.vlambda,d.wlambda||m)+c.multiplyVectors(j,e)};var l=new f,j=new f,n=new f,r=new f;d.prototype.computeGiMf=function(){var c=this.jacobianElementA,d=this.jacobianElementB,e=this.bi,f=this.bj,g=e.force,q=e.torque,m=f.force,s=f.torque,I=e.invMassSolve,z=f.invMassSolve;e.invInertiaWorldSolve?e.invInertiaWorldSolve.vmult(q,n):n.set(0,0,0);f.invInertiaWorldSolve?f.invInertiaWorldSolve.vmult(s,r):r.set(0,0,0);g.mult(I,
l);m.mult(z,j);return c.multiplyVectors(l,n)+d.multiplyVectors(j,r)};var q=new f;d.prototype.computeGiMGt=function(){var c=this.jacobianElementA,d=this.jacobianElementB,e=this.bi,j=this.bj,f=e.invInertiaWorldSolve,g=j.invInertiaWorldSolve,e=e.invMassSolve+j.invMassSolve;f&&(f.vmult(c.rotational,q),e+=q.dot(c.rotational));g&&(g.vmult(d.rotational,q),e+=q.dot(d.rotational));return e};var s=new f;new f;new f;new f;new f;new f;d.prototype.addToWlambda=function(c){var d=this.jacobianElementA,e=this.jacobianElementB,
j=this.bi,f=this.bj;d.spatial.mult(j.invMassSolve*c,s);j.vlambda.vadd(s,j.vlambda);e.spatial.mult(f.invMassSolve*c,s);f.vlambda.vadd(s,f.vlambda);j.invInertiaWorldSolve&&(j.invInertiaWorldSolve.vmult(d.rotational,s),s.mult(c,s),j.wlambda.vadd(s,j.wlambda));f.invInertiaWorldSolve&&(f.invInertiaWorldSolve.vmult(e.rotational,s),s.mult(c,s),f.wlambda.vadd(s,f.wlambda))};d.prototype.computeC=function(){return this.computeGiMGt()+this.eps}},{"../math/JacobianElement":26,"../math/Vec3":30}],21:[function(c,
e){function d(c,d,e){g.call(this,c,d,-e,e);this.ri=new f;this.rj=new f;this.t=new f}e.exports=d;var g=c("./Equation"),f=c("../math/Vec3");c("../math/Mat3");d.prototype=new g;d.prototype.constructor=d;var m=new f,l=new f;d.prototype.computeB=function(c){var d=this.b,e=this.rj,f=this.t;this.ri.cross(f,m);e.cross(f,l);var e=this.jacobianElementA,g=this.jacobianElementB;f.negate(e.spatial);m.negate(e.rotational);g.spatial.copy(f);g.rotational.copy(l);f=this.computeGW();e=this.computeGiMf();return-f*d-
c*e}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],22:[function(c,e){function d(c,d,e){e=e||{};var l="undefined"!==typeof e.maxForce?e.maxForce:1E6;f.call(this,c,d,-l,l);this.axisA=e.axisA?e.axisA.clone():new g(1,0,0);this.axisB=e.axisB?e.axisB.clone():new g(0,1,0);this.maxAngle=Math.PI/2}e.exports=d;var g=c("../math/Vec3");c("../math/Mat3");var f=c("./Equation");d.prototype=new f;d.prototype.constructor=d;var m=new g,l=new g;d.prototype.computeB=function(c){var d=this.a,e=this.b,f=this.axisA,
g=this.axisB,t=this.jacobianElementA,u=this.jacobianElementB;f.cross(g,m);g.cross(f,l);t.rotational.copy(l);u.rotational.copy(m);f=Math.cos(this.maxAngle)-f.dot(g);g=this.computeGW();t=this.computeGiMf();return-f*d-g*e-c*t}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],23:[function(c,e){function d(c,d,e){e="undefined"!==typeof e?e:1E6;f.call(this,c,d,-e,e);this.axisA=new g;this.axisB=new g;this.targetVelocity=0}e.exports=d;var g=c("../math/Vec3");c("../math/Mat3");var f=c("./Equation");
d.prototype=new f;d.prototype.constructor=d;d.prototype.computeB=function(c){var d=this.b,e=this.axisB,f=this.jacobianElementB;this.jacobianElementA.rotational.copy(this.axisA);e.negate(f.rotational);e=this.computeGW()-this.targetVelocity;f=this.computeGiMf();return-e*d-c*f}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],24:[function(c,e){function d(c,e,l){l=g.defaults(l,{friction:0.3,restitution:0.3,contactEquationStiffness:1E7,contactEquationRelaxation:3,frictionEquationStiffness:1E7,frictionEquationRelaxation:3});
this.id=d.idCounter++;this.materials=[c,e];this.friction=l.friction;this.restitution=l.restitution;this.contactEquationStiffness=l.contactEquationStiffness;this.contactEquationRelaxation=l.contactEquationRelaxation;this.frictionEquationStiffness=l.frictionEquationStiffness;this.frictionEquationRelaxation=l.frictionEquationRelaxation}var g=c("../utils/Utils");e.exports=d;d.idCounter=0},{"../utils/Utils":53}],25:[function(c,e){function d(c){var e="";c=c||{};"string"===typeof c?(e=c,c={}):"object"===
typeof c&&(e="");this.name=e;this.id=d.idCounter++;this.friction="undefined"!==typeof c.friction?c.friction:-1;this.restitution="undefined"!==typeof c.restitution?c.restitution:-1}e.exports=d;d.idCounter=0},{}],26:[function(c,e){function d(){this.spatial=new g;this.rotational=new g}e.exports=d;var g=c("./Vec3");d.prototype.multiplyElement=function(c){return c.spatial.dot(this.spatial)+c.rotational.dot(this.rotational)};d.prototype.multiplyVectors=function(c,d){return c.dot(this.spatial)+d.dot(this.rotational)}},
{"./Vec3":30}],27:[function(c,e){function d(c){this.elements=c?c:[0,0,0,0,0,0,0,0,0]}e.exports=d;var g=c("./Vec3");d.prototype.identity=function(){var c=this.elements;c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=1;c[5]=0;c[6]=0;c[7]=0;c[8]=1};d.prototype.setZero=function(){var c=this.elements;c[0]=0;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=0;c[6]=0;c[7]=0;c[8]=0};d.prototype.setTrace=function(c){var d=this.elements;d[0]=c.x;d[4]=c.y;d[8]=c.z};d.prototype.getTrace=function(c){c=c||new g;var d=this.elements;c.x=d[0];c.y=
d[4];c.z=d[8]};d.prototype.vmult=function(c,d){d=d||new g;var e=this.elements,j=c.x,n=c.y,r=c.z;d.x=e[0]*j+e[1]*n+e[2]*r;d.y=e[3]*j+e[4]*n+e[5]*r;d.z=e[6]*j+e[7]*n+e[8]*r;return d};d.prototype.smult=function(c){for(var d=0;d<this.elements.length;d++)this.elements[d]*=c};d.prototype.mmult=function(c,e){for(var g=e||new d,j=0;3>j;j++)for(var n=0;3>n;n++){for(var r=0,q=0;3>q;q++)r+=c.elements[j+3*q]*this.elements[q+3*n];g.elements[j+3*n]=r}return g};d.prototype.scale=function(c,e){e=e||new d;for(var g=
this.elements,j=e.elements,n=0;3!==n;n++)j[3*n+0]=c.x*g[3*n+0],j[3*n+1]=c.y*g[3*n+1],j[3*n+2]=c.z*g[3*n+2];return e};d.prototype.solve=function(c,d){d=d||new g;for(var e=[],j=0;12>j;j++)e.push(0);for(var n,j=0;3>j;j++)for(n=0;3>n;n++)e[j+4*n]=this.elements[j+3*n];e[3]=c.x;e[7]=c.y;e[11]=c.z;var r=3,q=r,s,t;do{j=q-r;if(0===e[j+4*j])for(n=j+1;n<q;n++)if(0!==e[j+4*n]){s=4;do t=4-s,e[t+4*j]+=e[t+4*n];while(--s);break}if(0!==e[j+4*j])for(n=j+1;n<q;n++){var u=e[j+4*n]/e[j+4*j];s=4;do t=4-s,e[t+4*n]=t<=
j?0:e[t+4*n]-e[t+4*j]*u;while(--s)}}while(--r);d.z=e[11]/e[10];d.y=(e[7]-e[6]*d.z)/e[5];d.x=(e[3]-e[2]*d.z-e[1]*d.y)/e[0];if(isNaN(d.x)||isNaN(d.y)||isNaN(d.z)||Infinity===d.x||Infinity===d.y||Infinity===d.z)throw"Could not solve equation! Got x=["+d.toString()+"], b=["+c.toString()+"], A=["+this.toString()+"]";return d};d.prototype.e=function(c,d,e){if(void 0===e)return this.elements[d+3*c];this.elements[d+3*c]=e};d.prototype.copy=function(c){for(var d=0;d<c.elements.length;d++)this.elements[d]=
c.elements[d];return this};d.prototype.toString=function(){for(var c="",d=0;9>d;d++)c+=this.elements[d]+",";return c};d.prototype.reverse=function(c){c=c||new d;for(var e=[],g=0;18>g;g++)e.push(0);for(var j,g=0;3>g;g++)for(j=0;3>j;j++)e[g+6*j]=this.elements[g+3*j];e[3]=1;e[9]=0;e[15]=0;e[4]=0;e[10]=1;e[16]=0;e[5]=0;e[11]=0;e[17]=1;var n=3,r=n,q,s;do{g=r-n;if(0===e[g+6*g])for(j=g+1;j<r;j++)if(0!==e[g+6*j]){q=6;do s=6-q,e[s+6*g]+=e[s+6*j];while(--q);break}if(0!==e[g+6*g])for(j=g+1;j<r;j++){var t=e[g+
6*j]/e[g+6*g];q=6;do s=6-q,e[s+6*j]=s<=g?0:e[s+6*j]-e[s+6*g]*t;while(--q)}}while(--n);g=2;do{j=g-1;do{t=e[g+6*j]/e[g+6*g];q=6;do s=6-q,e[s+6*j]-=e[s+6*g]*t;while(--q)}while(j--)}while(--g);g=2;do{t=1/e[g+6*g];q=6;do s=6-q,e[s+6*g]*=t;while(--q)}while(g--);g=2;do{j=2;do{s=e[3+j+6*g];if(isNaN(s)||Infinity===s)throw"Could not reverse! A=["+this.toString()+"]";c.e(g,j,s)}while(j--)}while(g--);return c};d.prototype.setRotationFromQuaternion=function(c){var d=c.x,e=c.y,j=c.z,g=c.w,r=d+d,q=e+e,s=j+j;c=d*
r;var t=d*q,d=d*s,u=e*q,e=e*s,j=j*s,r=g*r,q=g*q,g=g*s,s=this.elements;s[0]=1-(u+j);s[1]=t-g;s[2]=d+q;s[3]=t+g;s[4]=1-(c+j);s[5]=e-r;s[6]=d-q;s[7]=e+r;s[8]=1-(c+u);return this};d.prototype.transpose=function(c){c=c||new d;for(var e=c.elements,g=this.elements,j=0;3!==j;j++)for(var n=0;3!==n;n++)e[3*j+n]=g[3*n+j];return c}},{"./Vec3":30}],28:[function(c,e){function d(c,d,e,j){this.x=void 0!==c?c:0;this.y=void 0!==d?d:0;this.z=void 0!==e?e:0;this.w=void 0!==j?j:1}e.exports=d;var g=c("./Vec3");d.prototype.set=
function(c,d,e,j){this.x=c;this.y=d;this.z=e;this.w=j};d.prototype.toString=function(){return this.x+","+this.y+","+this.z+","+this.w};d.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]};d.prototype.setFromAxisAngle=function(c,d){var e=Math.sin(0.5*d);this.x=c.x*e;this.y=c.y*e;this.z=c.z*e;this.w=Math.cos(0.5*d)};d.prototype.toAxisAngle=function(c){c=c||new g;this.normalize();var d=2*Math.acos(this.w),e=Math.sqrt(1-this.w*this.w);0.001>e?(c.x=this.x,c.y=this.y,c.z=this.z):(c.x=this.x/
e,c.y=this.y/e,c.z=this.z/e);return[c,d]};var f=new g,m=new g;d.prototype.setFromVectors=function(c,d){if(c.isAntiparallelTo(d))c.tangents(f,m),this.setFromAxisAngle(f,Math.PI);else{var e=c.cross(d);this.x=e.x;this.y=e.y;this.z=e.z;this.w=Math.sqrt(Math.pow(c.norm(),2)*Math.pow(d.norm(),2))+c.dot(d);this.normalize()}};var l=new g,j=new g,n=new g;d.prototype.mult=function(c,e){e=e||new d;var f=this.w;l.set(this.x,this.y,this.z);j.set(c.x,c.y,c.z);e.w=f*c.w-l.dot(j);l.cross(j,n);e.x=f*j.x+c.w*l.x+n.x;
e.y=f*j.y+c.w*l.y+n.y;e.z=f*j.z+c.w*l.z+n.z;return e};d.prototype.inverse=function(c){var e=this.x,j=this.y,f=this.z,g=this.w;c=c||new d;this.conjugate(c);e=1/(e*e+j*j+f*f+g*g);c.x*=e;c.y*=e;c.z*=e;c.w*=e;return c};d.prototype.conjugate=function(c){c=c||new d;c.x=-this.x;c.y=-this.y;c.z=-this.z;c.w=this.w;return c};d.prototype.normalize=function(){var c=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);0===c?this.w=this.z=this.y=this.x=0:(c=1/c,this.x*=c,this.y*=c,this.z*=c,this.w*=
c)};d.prototype.normalizeFast=function(){var c=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;0===c?this.w=this.z=this.y=this.x=0:(this.x*=c,this.y*=c,this.z*=c,this.w*=c)};d.prototype.vmult=function(c,d){d=d||new g;var e=c.x,j=c.y,f=c.z,n=this.x,l=this.y,m=this.z,A=this.w,B=A*e+l*f-m*j,C=A*j+m*e-n*f,I=A*f+n*j-l*e,e=-n*e-l*j-m*f;d.x=B*A+e*-n+C*-m-I*-l;d.y=C*A+e*-l+I*-n-B*-m;d.z=I*A+e*-m+B*-l-C*-n;return d};d.prototype.copy=function(c){this.x=c.x;this.y=c.y;this.z=c.z;this.w=c.w;return this};
d.prototype.toEuler=function(c,d){d=d||"YZX";var e,j,f,g=this.x,n=this.y,l=this.z,m=this.w;switch(d){case "YZX":var B=g*n+l*m;0.499<B&&(e=2*Math.atan2(g,m),j=Math.PI/2,f=0);-0.499>B&&(e=-2*Math.atan2(g,m),j=-Math.PI/2,f=0);if(isNaN(e)){f=g*g;var C=l*l;e=Math.atan2(2*n*m-2*g*l,1-2*n*n-2*C);j=Math.asin(2*B);f=Math.atan2(2*g*m-2*n*l,1-2*f-2*C)}break;default:throw Error("Euler order "+d+" not supported yet.");}c.y=e;c.z=j;c.x=f};d.prototype.setFromEuler=function(c,d,e,j){j=j||"XYZ";var f=Math.cos(c/2),
g=Math.cos(d/2),n=Math.cos(e/2);c=Math.sin(c/2);d=Math.sin(d/2);e=Math.sin(e/2);"XYZ"===j?(this.x=c*g*n+f*d*e,this.y=f*d*n-c*g*e,this.z=f*g*e+c*d*n,this.w=f*g*n-c*d*e):"YXZ"===j?(this.x=c*g*n+f*d*e,this.y=f*d*n-c*g*e,this.z=f*g*e-c*d*n,this.w=f*g*n+c*d*e):"ZXY"===j?(this.x=c*g*n-f*d*e,this.y=f*d*n+c*g*e,this.z=f*g*e+c*d*n,this.w=f*g*n-c*d*e):"ZYX"===j?(this.x=c*g*n-f*d*e,this.y=f*d*n+c*g*e,this.z=f*g*e-c*d*n,this.w=f*g*n+c*d*e):"YZX"===j?(this.x=c*g*n+f*d*e,this.y=f*d*n+c*g*e,this.z=f*g*e-c*d*n,this.w=
f*g*n-c*d*e):"XZY"===j&&(this.x=c*g*n-f*d*e,this.y=f*d*n-c*g*e,this.z=f*g*e+c*d*n,this.w=f*g*n+c*d*e);return this};d.prototype.clone=function(){return new d(this.x,this.y,this.z,this.w)}},{"./Vec3":30}],29:[function(c,e){function d(c){c=c||{};this.position=new g;c.position&&this.position.copy(c.position);this.quaternion=new f;c.quaternion&&this.quaternion.copy(c.quaternion)}var g=c("./Vec3"),f=c("./Quaternion");e.exports=d;var m=new f;d.pointToLocalFrame=function(c,d,e,f){f=f||new g;e.vsub(c,f);d.conjugate(m);
m.vmult(f,f);return f};d.prototype.pointToLocal=function(c,e){return d.pointToLocalFrame(this.position,this.quaternion,c,e)};d.pointToWorldFrame=function(c,d,e,f){f=f||new g;d.vmult(e,f);f.vadd(c,f);return f};d.prototype.pointToWorld=function(c,e){return d.pointToWorldFrame(this.position,this.quaternion,c,e)};d.prototype.vectorToWorldFrame=function(c,d){d=d||new g;this.quaternion.vmult(c,d);return d};d.vectorToWorldFrame=function(c,d,e){c.vmult(d,e);return e};d.vectorToLocalFrame=function(c,d,e,f){f=
f||new g;d.w*=-1;d.vmult(e,f);d.w*=-1;return f}},{"./Quaternion":28,"./Vec3":30}],30:[function(c,e){function d(c,d,e){this.x=c||0;this.y=d||0;this.z=e||0}e.exports=d;var g=c("./Mat3");d.ZERO=new d(0,0,0);d.UNIT_X=new d(1,0,0);d.UNIT_Y=new d(0,1,0);d.UNIT_Z=new d(0,0,1);d.prototype.cross=function(c,e){var f=c.x,g=c.y,l=c.z,m=this.x,u=this.y,v=this.z;e=e||new d;e.x=u*l-v*g;e.y=v*f-m*l;e.z=m*g-u*f;return e};d.prototype.set=function(c,d,e){this.x=c;this.y=d;this.z=e;return this};d.prototype.setZero=function(){this.x=
this.y=this.z=0};d.prototype.vadd=function(c,e){if(e)e.x=c.x+this.x,e.y=c.y+this.y,e.z=c.z+this.z;else return new d(this.x+c.x,this.y+c.y,this.z+c.z)};d.prototype.vsub=function(c,e){if(e)e.x=this.x-c.x,e.y=this.y-c.y,e.z=this.z-c.z;else return new d(this.x-c.x,this.y-c.y,this.z-c.z)};d.prototype.crossmat=function(){return new g([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])};d.prototype.normalize=function(){var c=this.x,d=this.y,e=this.z,c=Math.sqrt(c*c+d*d+e*e);0<c?(d=1/c,this.x*=d,this.y*=
d,this.z*=d):this.z=this.y=this.x=0;return c};d.prototype.unit=function(c){c=c||new d;var e=this.x,f=this.y,g=this.z,l=Math.sqrt(e*e+f*f+g*g);0<l?(l=1/l,c.x=e*l,c.y=f*l,c.z=g*l):(c.x=1,c.y=0,c.z=0);return c};d.prototype.norm=function(){var c=this.x,d=this.y,e=this.z;return Math.sqrt(c*c+d*d+e*e)};d.prototype.length=d.prototype.norm;d.prototype.norm2=function(){return this.dot(this)};d.prototype.lengthSquared=d.prototype.norm2;d.prototype.distanceTo=function(c){var d=this.x,e=this.y,f=this.z,g=c.x,
l=c.y;c=c.z;return Math.sqrt((g-d)*(g-d)+(l-e)*(l-e)+(c-f)*(c-f))};d.prototype.distanceSquared=function(c){var d=this.x,e=this.y,f=this.z,g=c.x,l=c.y;c=c.z;return(g-d)*(g-d)+(l-e)*(l-e)+(c-f)*(c-f)};d.prototype.mult=function(c,e){e=e||new d;var f=this.y,g=this.z;e.x=c*this.x;e.y=c*f;e.z=c*g;return e};d.prototype.scale=d.prototype.mult;d.prototype.dot=function(c){return this.x*c.x+this.y*c.y+this.z*c.z};d.prototype.isZero=function(){return 0===this.x&&0===this.y&&0===this.z};d.prototype.negate=function(c){c=
c||new d;c.x=-this.x;c.y=-this.y;c.z=-this.z;return c};var f=new d,m=new d;d.prototype.tangents=function(c,d){var e=this.norm();0<e?(e=1/e,f.set(this.x*e,this.y*e,this.z*e),0.9>Math.abs(f.x)?m.set(1,0,0):m.set(0,1,0),f.cross(m,c),f.cross(c,d)):(c.set(1,0,0),d.set(0,1,0))};d.prototype.toString=function(){return this.x+","+this.y+","+this.z};d.prototype.toArray=function(){return[this.x,this.y,this.z]};d.prototype.copy=function(c){this.x=c.x;this.y=c.y;this.z=c.z;return this};d.prototype.lerp=function(c,
d,e){var f=this.x,g=this.y,l=this.z;e.x=f+(c.x-f)*d;e.y=g+(c.y-g)*d;e.z=l+(c.z-l)*d};d.prototype.almostEquals=function(c,d){void 0===d&&(d=1E-6);return Math.abs(this.x-c.x)>d||Math.abs(this.y-c.y)>d||Math.abs(this.z-c.z)>d?!1:!0};d.prototype.almostZero=function(c){void 0===c&&(c=1E-6);return Math.abs(this.x)>c||Math.abs(this.y)>c||Math.abs(this.z)>c?!1:!0};var l=new d;d.prototype.isAntiparallelTo=function(c,d){this.negate(l);return l.almostEquals(c,d)};d.prototype.clone=function(){return new d(this.x,
this.y,this.z)}},{"./Mat3":27}],31:[function(c,e){function d(c){c=c||{};g.apply(this);this.id=d.idCounter++;this.postStep=this.preStep=this.world=null;this.vlambda=new f;this.collisionFilterGroup="number"===typeof c.collisionFilterGroup?c.collisionFilterGroup:1;this.collisionFilterMask="number"===typeof c.collisionFilterMask?c.collisionFilterMask:1;this.collisionResponse=!0;this.position=new f;c.position&&this.position.copy(c.position);this.previousPosition=new f;this.initPosition=new f;this.velocity=
new f;c.velocity&&this.velocity.copy(c.velocity);this.initVelocity=new f;this.force=new f;var e="number"===typeof c.mass?c.mass:0;this.mass=e;this.invMass=0<e?1/e:0;this.material=c.material||null;this.linearDamping="number"===typeof c.linearDamping?c.linearDamping:0.01;this.type=0>=e?d.STATIC:d.DYNAMIC;typeof c.type===typeof d.STATIC&&(this.type=c.type);this.allowSleep="undefined"!==typeof c.allowSleep?c.allowSleep:!0;this.sleepState=0;this.sleepSpeedLimit="undefined"!==typeof c.sleepSpeedLimit?c.sleepSpeedLimit:
0.1;this.sleepTimeLimit="undefined"!==typeof c.sleepTimeLimit?c.sleepTimeLimit:1;this.timeLastSleepy=0;this._wakeUpAfterNarrowphase=!1;this.torque=new f;this.quaternion=new l;c.quaternion&&this.quaternion.copy(c.quaternion);this.initQuaternion=new l;this.angularVelocity=new f;c.angularVelocity&&this.angularVelocity.copy(c.angularVelocity);this.initAngularVelocity=new f;this.interpolatedPosition=new f;this.interpolatedQuaternion=new l;this.shapes=[];this.shapeOffsets=[];this.shapeOrientations=[];this.inertia=
new f;this.invInertia=new f;this.invInertiaWorld=new m;this.invMassSolve=0;this.invInertiaSolve=new f;this.invInertiaWorldSolve=new m;this.fixedRotation="undefined"!==typeof c.fixedRotation?c.fixedRotation:!1;this.angularDamping="undefined"!==typeof c.angularDamping?c.angularDamping:0.01;this.aabb=new j;this.aabbNeedsUpdate=!0;this.wlambda=new f;c.shape&&this.addShape(c.shape);this.updateMassProperties()}e.exports=d;var g=c("../utils/EventTarget");c("../shapes/Shape");var f=c("../math/Vec3"),m=c("../math/Mat3"),
l=c("../math/Quaternion");c("../material/Material");var j=c("../collision/AABB"),n=c("../shapes/Box");d.prototype=new g;d.prototype.constructor=d;d.DYNAMIC=1;d.STATIC=2;d.KINEMATIC=4;d.AWAKE=0;d.SLEEPY=1;d.SLEEPING=2;d.idCounter=0;d.prototype.wakeUp=function(){var c=this.sleepState;this.sleepState=0;c===d.SLEEPING&&this.dispatchEvent({type:"wakeup"})};d.prototype.sleep=function(){this.sleepState=d.SLEEPING;this.velocity.set(0,0,0);this.angularVelocity.set(0,0,0)};d.sleepyEvent={type:"sleepy"};d.sleepEvent=
{type:"sleep"};d.prototype.sleepTick=function(c){if(this.allowSleep){var e=this.sleepState,j=this.velocity.norm2()+this.angularVelocity.norm2(),f=Math.pow(this.sleepSpeedLimit,2);e===d.AWAKE&&j<f?(this.sleepState=d.SLEEPY,this.timeLastSleepy=c,this.dispatchEvent(d.sleepyEvent)):e===d.SLEEPY&&j>f?this.wakeUp():e===d.SLEEPY&&c-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(d.sleepEvent))}};d.prototype.updateSolveMassProperties=function(){this.sleepState===d.SLEEPING||this.type===
d.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))};d.prototype.pointToLocalFrame=function(c,d){d=d||new f;c.vsub(this.position,d);this.quaternion.conjugate().vmult(d,d);return d};d.prototype.vectorToLocalFrame=function(c,d){d=d||new f;this.quaternion.conjugate().vmult(c,d);return d};d.prototype.pointToWorldFrame=function(c,
d){d=d||new f;this.quaternion.vmult(c,d);d.vadd(this.position,d);return d};d.prototype.vectorToWorldFrame=function(c,d){d=d||new f;this.quaternion.vmult(c,d);return d};var r=new f,q=new l;d.prototype.addShape=function(c,d,e){var j=new f,g=new l;d&&j.copy(d);e&&g.copy(e);this.shapes.push(c);this.shapeOffsets.push(j);this.shapeOrientations.push(g);this.updateMassProperties();this.updateBoundingRadius();this.aabbNeedsUpdate=!0;return this};d.prototype.updateBoundingRadius=function(){for(var c=this.shapes,
d=this.shapeOffsets,e=c.length,j=0,f=0;f!==e;f++){var g=c[f];g.updateBoundingSphereRadius();var n=d[f].norm(),g=g.boundingSphereRadius;n+g>j&&(j=n+g)}this.boundingRadius=j};var s=new j;d.prototype.computeAABB=function(){for(var c=this.shapes,d=this.shapeOffsets,e=this.shapeOrientations,j=c.length,f=this.quaternion,g=this.aabb,n=0;n!==j;n++){var l=c[n];e[n].mult(f,q);q.vmult(d[n],r);r.vadd(this.position,r);l.calculateWorldAABB(r,q,s.lowerBound,s.upperBound);0===n?g.copy(s):g.extend(s)}this.aabbNeedsUpdate=
!1};var t=new m,u=new m;new m;d.prototype.updateInertiaWorld=function(c){var d=this.invInertia;d.x===d.y&&d.y===d.z&&!c||(t.setRotationFromQuaternion(this.quaternion),t.transpose(u),t.scale(d,t),t.mmult(u,this.invInertiaWorld))};var v=new f,x=new f;d.prototype.applyForce=function(c,e){this.type===d.DYNAMIC&&(e.vsub(this.position,v),v.cross(c,x),this.force.vadd(c,this.force),this.torque.vadd(x,this.torque))};var y=new f,A=new f;d.prototype.applyLocalForce=function(c,e){this.type===d.DYNAMIC&&(this.vectorToWorldFrame(c,
y),this.pointToWorldFrame(e,A),this.applyForce(y,A))};var B=new f,C=new f,I=new f;d.prototype.applyImpulse=function(c,e){this.type===d.DYNAMIC&&(e.vsub(this.position,B),C.copy(c),C.mult(this.invMass,C),this.velocity.vadd(C,this.velocity),B.cross(c,I),this.invInertiaWorld.vmult(I,I),this.angularVelocity.vadd(I,this.angularVelocity))};var z=new f,D=new f;d.prototype.applyLocalImpulse=function(c,e){this.type===d.DYNAMIC&&(this.vectorToWorldFrame(c,z),this.pointToWorldFrame(e,D),this.applyImpulse(z,D))};
var F=new f;d.prototype.updateMassProperties=function(){this.invMass=0<this.mass?1/this.mass:0;var c=this.inertia,d=this.fixedRotation;this.computeAABB();F.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2);n.calculateInertia(F,this.mass,c);this.invInertia.set(0<c.x&&!d?1/c.x:0,0<c.y&&!d?1/c.y:0,0<c.z&&!d?1/c.z:0);this.updateInertiaWorld(!0)};d.prototype.getVelocityAtWorldPoint=function(c,d){var e=
new f;c.vsub(this.position,e);this.angularVelocity.cross(e,d);this.velocity.vadd(d,d);return d}},{"../collision/AABB":3,"../material/Material":25,"../math/Mat3":27,"../math/Quaternion":28,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Shape":43,"../utils/EventTarget":49}],32:[function(c,e){function d(c){this.chassisBody=c.chassisBody;this.wheelInfos=[];this.sliding=!1;this.world=null;this.indexRightAxis="undefined"!==typeof c.indexRightAxis?c.indexRightAxis:1;this.indexForwardAxis="undefined"!==
typeof c.indexForwardAxis?c.indexForwardAxis:0;this.indexUpAxis="undefined"!==typeof c.indexUpAxis?c.indexUpAxis:2}function g(c,d,e){var j=I,f=z,g=D,n=F;d.vsub(c.position,j);j.cross(e,f);c.invInertiaWorld.vmult(f,n);n.cross(j,g);return c.invMass+e.dot(g)}c("./Body");var f=c("../math/Vec3"),m=c("../math/Quaternion");c("../collision/RaycastResult");var l=c("../collision/Ray"),j=c("../objects/WheelInfo");e.exports=d;new f;new f;new f;var n=new f,r=new f,q=new f;new l;d.prototype.addWheel=function(c){c=
c||{};c=new j(c);var d=this.wheelInfos.length;this.wheelInfos.push(c);return d};d.prototype.setSteeringValue=function(c,d){this.wheelInfos[d].steering=c};new f;d.prototype.applyEngineForce=function(c,d){this.wheelInfos[d].engineForce=c};d.prototype.setBrake=function(c,d){this.wheelInfos[d].brake=c};d.prototype.addToWorld=function(c){c.add(this.chassisBody);var d=this;this.preStepCallback=function(){d.updateVehicle(c.dt)};c.addEventListener("preStep",this.preStepCallback);this.world=c};d.prototype.getVehicleAxisWorld=
function(c,d){d.set(0===c?1:0,1===c?1:0,2===c?1:0);this.chassisBody.vectorToWorldFrame(d,d)};d.prototype.updateVehicle=function(c){for(var d=this.wheelInfos,e=d.length,j=this.chassisBody,g=0;g<e;g++)this.updateWheelTransform(g);this.currentVehicleSpeedKmHour=3.6*j.velocity.norm();g=new f;this.getVehicleAxisWorld(this.indexForwardAxis,g);0>g.dot(j.velocity)&&(this.currentVehicleSpeedKmHour*=-1);for(g=0;g<e;g++)this.castRay(d[g]);this.updateSuspension(c);for(var n=new f,r=new f,g=0;g<e;g++){var l=d[g],
q=l.suspensionForce;q>l.maxSuspensionForce&&(q=l.maxSuspensionForce);l.raycastResult.hitNormalWorld.scale(q*c,n);l.raycastResult.hitPointWorld.vsub(j.position,r);j.applyImpulse(n,l.raycastResult.hitPointWorld)}this.updateFriction(c);n=new f;r=new f;q=new f;for(g=0;g<e;g++){l=d[g];j.getVelocityAtWorldPoint(l.chassisConnectionPointWorld,q);var m=1;switch(this.indexUpAxis){case 1:m=-1}if(l.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,r);var s=r.dot(l.raycastResult.hitNormalWorld);l.raycastResult.hitNormalWorld.scale(s,
n);r.vsub(n,r);s=r.dot(q);l.deltaRotation=m*s*c/l.radius}if((l.sliding||!l.isInContact)&&0!==l.engineForce&&l.useCustomSlidingRotationalSpeed)l.deltaRotation=(0<l.engineForce?1:-1)*l.customSlidingRotationalSpeed*c;Math.abs(l.brake)>Math.abs(l.engineForce)&&(l.deltaRotation=0);l.rotation+=l.deltaRotation;l.deltaRotation*=0.99}};d.prototype.updateSuspension=function(){for(var c=this.chassisBody.mass,d=this.wheelInfos,e=d.length,j=0;j<e;j++){var f=d[j];if(f.isInContact){var g;g=f.suspensionStiffness*
(f.suspensionRestLength-f.suspensionLength)*f.clippedInvContactDotSuspension;var n=f.suspensionRelativeVelocity;g-=(0>n?f.dampingCompression:f.dampingRelaxation)*n;f.suspensionForce=g*c;0>f.suspensionForce&&(f.suspensionForce=0)}else f.suspensionForce=0}};d.prototype.removeFromWorld=function(c){c.remove(this.chassisBody);c.removeEventListener("preStep",this.preStepCallback);this.world=null};var s=new f,t=new f;d.prototype.castRay=function(c){this.updateWheelTransformWorld(c);var d=this.chassisBody,
e=-1;c.directionWorld.scale(c.suspensionRestLength+c.radius,s);var j=c.chassisConnectionPointWorld;j.vadd(s,t);var g=c.raycastResult;g.reset();var n=d.collisionResponse;d.collisionResponse=!1;this.world.rayTest(j,t,g);d.collisionResponse=n;j=g.body;c.raycastResult.groundObject=0;j?(e=g.distance,c.raycastResult.hitNormalWorld=g.hitNormalWorld,c.isInContact=!0,c.suspensionLength=g.distance-c.radius,g=c.suspensionRestLength-c.maxSuspensionTravel,j=c.suspensionRestLength+c.maxSuspensionTravel,c.suspensionLength<
g&&(c.suspensionLength=g),c.suspensionLength>j&&(c.suspensionLength=j,c.raycastResult.reset()),g=c.raycastResult.hitNormalWorld.dot(c.directionWorld),j=new f,d.getVelocityAtWorldPoint(c.raycastResult.hitPointWorld,j),d=c.raycastResult.hitNormalWorld.dot(j),-0.1<=g?(c.suspensionRelativeVelocity=0,c.clippedInvContactDotSuspension=10):(g=-1/g,c.suspensionRelativeVelocity=d*g,c.clippedInvContactDotSuspension=g)):(c.suspensionLength=c.suspensionRestLength+0*c.maxSuspensionTravel,c.suspensionRelativeVelocity=
0,c.directionWorld.scale(-1,c.raycastResult.hitNormalWorld),c.clippedInvContactDotSuspension=1);return e};d.prototype.updateWheelTransformWorld=function(c){c.isInContact=!1;var d=this.chassisBody;d.pointToWorldFrame(c.chassisConnectionPointLocal,c.chassisConnectionPointWorld);d.vectorToWorldFrame(c.directionLocal,c.directionWorld);d.vectorToWorldFrame(c.axleLocal,c.axleWorld)};d.prototype.updateWheelTransform=function(c){c=this.wheelInfos[c];this.updateWheelTransformWorld(c);c.directionLocal.scale(-1,
n);r.copy(c.axleLocal);n.cross(r,q);q.normalize();r.normalize();var d=c.steering,e=new m;e.setFromAxisAngle(n,d);d=new m;d.setFromAxisAngle(r,c.rotation);var j=c.worldTransform.quaternion;this.chassisBody.quaternion.mult(e,j);j.mult(d,j);j.normalize();e=c.worldTransform.position;e.copy(c.directionWorld);e.scale(c.suspensionLength,e);e.vadd(c.chassisConnectionPointWorld,e)};var u=[new f(1,0,0),new f(0,1,0),new f(0,0,1)];d.prototype.getWheelTransformWorld=function(c){return this.wheelInfos[c].worldTransform};
var v=new f,x=[],y=[];d.prototype.updateFriction=function(c){for(var d=this.wheelInfos,e=d.length,j=this.chassisBody,n=0,r=0;r<e;r++){var l=d[r],q=l.raycastResult.body;q&&n++;l.sideImpulse=0;l.forwardImpulse=0;y[r]||(y[r]=new f);x[r]||(x[r]=new f)}for(r=0;r<e;r++)if(l=d[r],q=l.raycastResult.body){var m=x[r];this.getWheelTransformWorld(r).vectorToWorldFrame(u[this.indexRightAxis],m);var n=l.raycastResult.hitNormalWorld,s=m.dot(n);n.scale(s,v);m.vsub(v,m);m.normalize();n.cross(m,y[r]);y[r].normalize();
n=l;var s=j,t=l.raycastResult.hitPointWorld,z=l.raycastResult.hitPointWorld,D=void 0;if(1.1<m.norm2())q=0;else{var D=L,F=R,ea=O;s.getVelocityAtWorldPoint(t,D);q.getVelocityAtWorldPoint(z,F);D.vsub(F,ea);q=D=-0.2*m.dot(ea)*(1/(s.invMass+q.invMass))}n.sideImpulse=q;l.sideImpulse*=1}this.sliding=!1;for(r=0;r<e;r++){l=d[r];q=l.raycastResult.body;s=0;l.slipInfo=1;if(q){var n=l.brake?l.brake:0,D=j,t=q,z=l.raycastResult.hitPointWorld,m=y[r],s=n,F=0,F=z,ea=A,ma=B,H=C;D.getVelocityAtWorldPoint(F,ea);t.getVelocityAtWorldPoint(F,
ma);ea.vsub(ma,H);F=m.dot(H);D=g(D,z,m);t=g(t,z,m);F=-F*(1/(D+t));s<F&&(F=s);F<-s&&(F=-s);s=F;s+=l.engineForce*c;n/=s;l.slipInfo*=n}l.forwardImpulse=0;l.skidInfo=1;q&&(l.skidInfo=1,q=l.suspensionForce*c*l.frictionSlip,n=q*q,l.forwardImpulse=s,s=0.5*l.forwardImpulse,t=1*l.sideImpulse,s=s*s+t*t,l.sliding=!1,s>n&&(this.sliding=!0,l.sliding=!0,n=q/Math.sqrt(s),l.skidInfo*=n))}if(this.sliding)for(r=0;r<e;r++)l=d[r],0!==l.sideImpulse&&1>l.skidInfo&&(l.forwardImpulse*=l.skidInfo,l.sideImpulse*=l.skidInfo);
for(r=0;r<e;r++)l=d[r],c=new f,c.copy(l.raycastResult.hitPointWorld),0!==l.forwardImpulse&&(q=new f,y[r].scale(l.forwardImpulse,q),j.applyImpulse(q,c)),0!==l.sideImpulse&&(q=l.raycastResult.body,n=new f,n.copy(l.raycastResult.hitPointWorld),s=new f,x[r].scale(l.sideImpulse,s),j.pointToLocalFrame(c,c),c["xyz"[this.indexUpAxis]]*=l.rollInfluence,j.pointToWorldFrame(c,c),j.applyImpulse(s,c),s.scale(-1,s),q.applyImpulse(s,n))};var A=new f,B=new f,C=new f,I=new f,z=new f,D=new f,F=new f,L=new f,R=new f,
O=new f},{"../collision/Ray":9,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Vec3":30,"../objects/WheelInfo":36,"./Body":31}],33:[function(c,e){function d(c){this.wheelBodies=[];this.coordinateSystem="undefined"===typeof c.coordinateSystem?new l(1,2,3):c.coordinateSystem.clone();this.chassisBody=c.chassisBody;this.chassisBody||(c=new m(new l(5,2,0.5)),this.chassisBody=new g(1,c));this.constraints=[];this.wheelAxes=[];this.wheelForces=[]}var g=c("./Body"),f=c("../shapes/Sphere"),
m=c("../shapes/Box"),l=c("../math/Vec3"),j=c("../constraints/HingeConstraint");e.exports=d;d.prototype.addWheel=function(c){c=c||{};var d=c.body;d||(d=new g(1,new f(1.2)));this.wheelBodies.push(d);this.wheelForces.push(0);new l;var e="undefined"!==typeof c.position?c.position.clone():new l,n=new l;this.chassisBody.pointToWorldFrame(e,n);d.position.set(n.x,n.y,n.z);c="undefined"!==typeof c.axis?c.axis.clone():new l(0,1,0);this.wheelAxes.push(c);d=new j(this.chassisBody,d,{pivotA:e,axisA:c,pivotB:l.ZERO,
axisB:c,collideConnected:!1});this.constraints.push(d);return this.wheelBodies.length-1};d.prototype.setSteeringValue=function(c,d){var e=this.wheelAxes[d],j=Math.cos(c),f=Math.sin(c),g=e.x,e=e.y;this.constraints[d].axisA.set(j*g-f*e,f*g+j*e,0)};d.prototype.setMotorSpeed=function(c,d){var e=this.constraints[d];e.enableMotor();e.motorTargetVelocity=c};d.prototype.disableMotor=function(c){this.constraints[c].disableMotor()};var n=new l;d.prototype.setWheelForce=function(c,d){this.wheelForces[d]=c};
d.prototype.applyWheelForce=function(c,d){var e=this.wheelBodies[d],j=e.torque;this.wheelAxes[d].scale(c,n);e.vectorToWorldFrame(n,n);j.vadd(n,j)};d.prototype.addToWorld=function(c){for(var d=this.constraints,e=this.wheelBodies.concat([this.chassisBody]),j=0;j<e.length;j++)c.add(e[j]);for(j=0;j<d.length;j++)c.addConstraint(d[j]);c.addEventListener("preStep",this._update.bind(this))};d.prototype._update=function(){for(var c=this.wheelForces,d=0;d<c.length;d++)this.applyWheelForce(c[d],d)};d.prototype.removeFromWorld=
function(c){for(var d=this.constraints,e=this.wheelBodies.concat([this.chassisBody]),j=0;j<e.length;j++)c.remove(e[j]);for(j=0;j<d.length;j++)c.removeConstraint(d[j])};var r=new l;d.prototype.getWheelSpeed=function(c){var d=this.wheelBodies[c].angularVelocity;this.chassisBody.vectorToWorldFrame(this.wheelAxes[c],r);return d.dot(r)}},{"../constraints/HingeConstraint":15,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Sphere":44,"./Body":31}],34:[function(c,e){function d(){this.particles=[];this.speedOfSound=
this.smoothingRadius=this.density=1;this.viscosity=0.01;this.eps=1E-6;this.pressures=[];this.densities=[];this.neighbors=[]}e.exports=d;c("../shapes/Shape");var g=c("../math/Vec3");c("../math/Quaternion");c("../shapes/Particle");c("../objects/Body");c("../material/Material");d.prototype.add=function(c){this.particles.push(c);this.neighbors.length<this.particles.length&&this.neighbors.push([])};d.prototype.remove=function(c){c=this.particles.indexOf(c);-1!==c&&(this.particles.splice(c,1),this.neighbors.length>
this.particles.length&&this.neighbors.pop())};var f=new g;d.prototype.getNeighbors=function(c,d){for(var e=this.particles.length,j=c.id,g=this.smoothingRadius*this.smoothingRadius,n=0;n!==e;n++){var l=this.particles[n];l.position.vsub(c.position,f);j!==l.id&&f.norm2()<g&&d.push(l)}};var m=new g,l=new g,j=new g,n=new g,r=new g,q=new g;d.prototype.update=function(){for(var c=this.particles.length,d=this.speedOfSound,e=this.eps,f=0;f!==c;f++){var g=this.particles[f],y=this.neighbors[f];y.length=0;this.getNeighbors(g,
y);y.push(this.particles[f]);for(var A=y.length,B=0,C=0;C!==A;C++){g.position.vsub(y[C].position,m);var I=m.norm(),I=this.w(I),B=B+y[C].mass*I}this.densities[f]=B;this.pressures[f]=d*d*(this.densities[f]-this.density)}for(f=0;f!==c;f++){d=this.particles[f];l.set(0,0,0);j.set(0,0,0);y=this.neighbors[f];A=y.length;for(C=0;C!==A;C++)B=y[C],d.position.vsub(B.position,r),I=r.norm(),g=-B.mass*(this.pressures[f]/(this.densities[f]*this.densities[f]+e)+this.pressures[C]/(this.densities[C]*this.densities[C]+
e)),this.gradw(r,n),n.mult(g,n),l.vadd(n,l),B.velocity.vsub(d.velocity,q),q.mult(1/(1E-4+this.densities[f]*this.densities[C])*this.viscosity*B.mass,q),g=this.nablaw(I),q.mult(g,q),j.vadd(q,j);j.mult(d.mass,j);l.mult(d.mass,l);d.force.vadd(j,d.force);d.force.vadd(l,d.force)}};d.prototype.w=function(c){var d=this.smoothingRadius;return 315/(64*Math.PI*Math.pow(d,9))*Math.pow(d*d-c*c,3)};d.prototype.gradw=function(c,d){var e=c.norm(),j=this.smoothingRadius;c.mult(945/(32*Math.PI*Math.pow(j,9))*Math.pow(j*
j-e*e,2),d)};d.prototype.nablaw=function(c){var d=this.smoothingRadius;return 945/(32*Math.PI*Math.pow(d,9))*(d*d-c*c)*(7*c*c-3*d*d)}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Particle":41,"../shapes/Shape":43}],35:[function(c,e){function d(c,d,e){e=e||{};this.restLength="number"===typeof e.restLength?e.restLength:1;this.stiffness=e.stiffness||100;this.damping=e.damping||1;this.bodyA=c;this.bodyB=d;this.localAnchorA=new g;this.localAnchorB=
new g;e.localAnchorA&&this.localAnchorA.copy(e.localAnchorA);e.localAnchorB&&this.localAnchorB.copy(e.localAnchorB);e.worldAnchorA&&this.setWorldAnchorA(e.worldAnchorA);e.worldAnchorB&&this.setWorldAnchorB(e.worldAnchorB)}var g=c("../math/Vec3");e.exports=d;d.prototype.setWorldAnchorA=function(c){this.bodyA.pointToLocalFrame(c,this.localAnchorA)};d.prototype.setWorldAnchorB=function(c){this.bodyB.pointToLocalFrame(c,this.localAnchorB)};d.prototype.getWorldAnchorA=function(c){this.bodyA.pointToWorldFrame(this.localAnchorA,
c)};d.prototype.getWorldAnchorB=function(c){this.bodyB.pointToWorldFrame(this.localAnchorB,c)};var f=new g,m=new g,l=new g,j=new g,n=new g,r=new g,q=new g,s=new g,t=new g,u=new g,v=new g;d.prototype.applyForce=function(){var c=this.stiffness,d=this.damping,e=this.restLength,g=this.bodyA,C=this.bodyB;this.getWorldAnchorA(n);this.getWorldAnchorB(r);n.vsub(g.position,q);r.vsub(C.position,s);r.vsub(n,f);var I=f.norm();m.copy(f);m.normalize();C.velocity.vsub(g.velocity,l);C.angularVelocity.cross(s,v);
l.vadd(v,l);g.angularVelocity.cross(q,v);l.vsub(v,l);m.mult(-c*(I-e)-d*l.dot(m),j);g.force.vsub(j,g.force);C.force.vadd(j,C.force);q.cross(j,t);s.cross(j,u);g.torque.vsub(t,g.torque);C.torque.vadd(u,C.torque)}},{"../math/Vec3":30}],36:[function(c,e){function d(c){c=l.defaults(c,{chassisConnectionPointLocal:new g,chassisConnectionPointWorld:new g,directionLocal:new g,directionWorld:new g,axleLocal:new g,axleWorld:new g,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,
dampingRelaxation:10,frictionSlip:1E4,steering:0,rotation:0,deltaRotation:0,rollInfluence:0.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-0.1});this.maxSuspensionTravel=c.maxSuspensionTravel;this.customSlidingRotationalSpeed=c.customSlidingRotationalSpeed;this.useCustomSlidingRotationalSpeed=c.useCustomSlidingRotationalSpeed;
this.sliding=!1;this.chassisConnectionPointLocal=c.chassisConnectionPointLocal.clone();this.chassisConnectionPointWorld=c.chassisConnectionPointWorld.clone();this.directionLocal=c.directionLocal.clone();this.directionWorld=c.directionWorld.clone();this.axleLocal=c.axleLocal.clone();this.axleWorld=c.axleWorld.clone();this.suspensionRestLength=c.suspensionRestLength;this.suspensionMaxLength=c.suspensionMaxLength;this.radius=c.radius;this.suspensionStiffness=c.suspensionStiffness;this.dampingCompression=
c.dampingCompression;this.dampingRelaxation=c.dampingRelaxation;this.frictionSlip=c.frictionSlip;this.deltaRotation=this.rotation=this.steering=0;this.rollInfluence=c.rollInfluence;this.maxSuspensionForce=c.maxSuspensionForce;this.brake=this.engineForce=0;this.isFrontWheel=c.isFrontWheel;this.clippedInvContactDotSuspension=1;this.forwardImpulse=this.sideImpulse=this.suspensionLength=this.skidInfo=this.suspensionForce=this.suspensionRelativeVelocity=0;this.raycastResult=new m;this.worldTransform=new f;
this.isInContact=!1}var g=c("../math/Vec3"),f=c("../math/Transform"),m=c("../collision/RaycastResult"),l=c("../utils/Utils");e.exports=d;var j=new g,n=new g,j=new g;d.prototype.updateWheel=function(c){var d=this.raycastResult;if(this.isInContact){var e=d.hitNormalWorld.dot(d.directionWorld);d.hitPointWorld.vsub(c.position,n);c.getVelocityAtWorldPoint(n,j);c=d.hitNormalWorld.dot(j);-0.1<=e?(this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=10):(e=-1/e,this.suspensionRelativeVelocity=
c*e,this.clippedInvContactDotSuspension=e)}else d.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,d.directionWorld.scale(-1,d.hitNormalWorld),this.clippedInvContactDotSuspension=1}},{"../collision/RaycastResult":10,"../math/Transform":29,"../math/Vec3":30,"../utils/Utils":53}],37:[function(c,e){function d(c){g.call(this);this.type=g.types.BOX;this.halfExtents=c;this.convexPolyhedronRepresentation=null;this.updateConvexPolyhedronRepresentation();this.updateBoundingSphereRadius()}
e.exports=d;var g=c("./Shape"),f=c("../math/Vec3"),m=c("./ConvexPolyhedron");d.prototype=new g;d.prototype.constructor=d;d.prototype.updateConvexPolyhedronRepresentation=function(){var c=this.halfExtents.x,d=this.halfExtents.y,e=this.halfExtents.z,c=[new f(-c,-d,-e),new f(c,-d,-e),new f(c,d,-e),new f(-c,d,-e),new f(-c,-d,e),new f(c,-d,e),new f(c,d,e),new f(-c,d,e)];new f(0,0,1);new f(0,1,0);new f(1,0,0);this.convexPolyhedronRepresentation=c=new m(c,[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,
3],[1,2,6,5]]);c.material=this.material};d.prototype.calculateLocalInertia=function(c,e){e=e||new f;d.calculateInertia(this.halfExtents,c,e);return e};d.calculateInertia=function(c,d,e){e.x=1/12*d*(4*c.y*c.y+4*c.z*c.z);e.y=1/12*d*(4*c.x*c.x+4*c.z*c.z);e.z=1/12*d*(4*c.y*c.y+4*c.x*c.x)};d.prototype.getSideNormals=function(c,d){var e=this.halfExtents;c[0].set(e.x,0,0);c[1].set(0,e.y,0);c[2].set(0,0,e.z);c[3].set(-e.x,0,0);c[4].set(0,-e.y,0);c[5].set(0,0,-e.z);if(void 0!==d)for(e=0;e!==c.length;e++)d.vmult(c[e],
c[e]);return c};d.prototype.volume=function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.halfExtents.norm()};var l=new f;new f;d.prototype.forEachWorldCorner=function(c,d,e){for(var j=this.halfExtents,j=[[j.x,j.y,j.z],[-j.x,j.y,j.z],[-j.x,-j.y,j.z],[-j.x,-j.y,-j.z],[j.x,-j.y,-j.z],[j.x,j.y,-j.z],[-j.x,j.y,-j.z],[j.x,-j.y,j.z]],f=0;f<j.length;f++)l.set(j[f][0],j[f][1],j[f][2]),d.vmult(l,l),c.vadd(l,
l),e(l.x,l.y,l.z)};var j=[new f,new f,new f,new f,new f,new f,new f,new f];d.prototype.calculateWorldAABB=function(c,d,e,f){var g=this.halfExtents;j[0].set(g.x,g.y,g.z);j[1].set(-g.x,g.y,g.z);j[2].set(-g.x,-g.y,g.z);j[3].set(-g.x,-g.y,-g.z);j[4].set(g.x,-g.y,-g.z);j[5].set(g.x,g.y,-g.z);j[6].set(-g.x,g.y,-g.z);j[7].set(g.x,-g.y,g.z);var l=j[0];d.vmult(l,l);c.vadd(l,l);f.copy(l);e.copy(l);for(g=1;8>g;g++){l=j[g];d.vmult(l,l);c.vadd(l,l);var m=l.x,x=l.y,l=l.z;m>f.x&&(f.x=m);x>f.y&&(f.y=x);l>f.z&&(f.z=
l);m<e.x&&(e.x=m);x<e.y&&(e.y=x);l<e.z&&(e.z=l)}}},{"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],38:[function(c,e){function d(c,d,e){g.call(this);this.type=g.types.CONVEXPOLYHEDRON;this.vertices=c||[];this.worldVertices=[];this.worldVerticesNeedsUpdate=!0;this.faces=d||[];this.faceNormals=[];this.computeNormals();this.worldFaceNormalsNeedsUpdate=!0;this.worldFaceNormals=[];this.uniqueEdges=[];this.uniqueAxes=e?e.slice():null;this.computeEdges();this.updateBoundingSphereRadius()}e.exports=
d;var g=c("./Shape"),f=c("../math/Vec3");c("../math/Quaternion");var m=c("../math/Transform");d.prototype=new g;d.prototype.constructor=d;var l=new f;d.prototype.computeEdges=function(){for(var c=this.faces,d=this.vertices,e=this.uniqueEdges,j=e.length=0;j!==c.length;j++)for(var g=c[j],f=g.length,n=0;n!==f;n++){d[g[n]].vsub(d[g[(n+1)%f]],l);l.normalize();for(var r=!1,q=0;q!==e.length;q++)if(e[q].almostEquals(l)||e[q].almostEquals(l)){r=!0;break}r||e.push(l.clone())}};d.prototype.computeNormals=function(){this.faceNormals.length=
this.faces.length;for(var c=0;c<this.faces.length;c++){for(var d=0;d<this.faces[c].length;d++)if(!this.vertices[this.faces[c][d]])throw Error("Vertex "+this.faces[c][d]+" not found!");d=this.faceNormals[c]||new f;this.getFaceNormal(c,d);d.negate(d);this.faceNormals[c]=d;if(0>d.dot(this.vertices[this.faces[c][0]])){console.error(".faceNormals["+c+"] = Vec3("+d.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");
for(d=0;d<this.faces[c].length;d++)console.warn(".vertices["+this.faces[c][d]+"] = Vec3("+this.vertices[this.faces[c][d]].toString()+")")}}};var j=new f,n=new f;d.computeNormal=function(c,d,e,g){d.vsub(c,n);e.vsub(d,j);j.cross(n,g);g.isZero()||g.normalize()};d.prototype.getFaceNormal=function(c,e){var j=this.faces[c];return d.computeNormal(this.vertices[j[0]],this.vertices[j[1]],this.vertices[j[2]],e)};var r=new f;d.prototype.clipAgainstHull=function(c,d,e,j,g,n,l,q,m){for(var s=-1,t=-Number.MAX_VALUE,
u=0;u<e.faces.length;u++){r.copy(e.faceNormals[u]);g.vmult(r,r);var v=r.dot(n);v>t&&(t=v,s=u)}for(var t=[],u=e.faces[s],v=u.length,x=0;x<v;x++){var z=e.vertices[u[x]],y=new f;y.copy(z);g.vmult(y,y);j.vadd(y,y);t.push(y)}0<=s&&this.clipFaceAgainstHull(n,c,d,t,l,q,m)};var q=new f,s=new f,t=new f,u=new f,v=new f,x=new f;d.prototype.findSeparatingAxis=function(c,d,e,j,g,f,n,l){var r=Number.MAX_VALUE,m=0;if(this.uniqueAxes)for(y=0;y!==this.uniqueAxes.length;y++){e.vmult(this.uniqueAxes[y],q);A=this.testSepAxis(q,
c,d,e,j,g);if(!1===A)return!1;A<r&&(r=A,f.copy(q))}else for(var z=n?n.length:this.faces.length,y=0;y<z;y++){A=n?n[y]:y;q.copy(this.faceNormals[A]);e.vmult(q,q);var A=this.testSepAxis(q,c,d,e,j,g);if(!1===A)return!1;A<r&&(r=A,f.copy(q))}if(c.uniqueAxes)for(y=0;y!==c.uniqueAxes.length;y++){g.vmult(c.uniqueAxes[y],s);m++;A=this.testSepAxis(s,c,d,e,j,g);if(!1===A)return!1;A<r&&(r=A,f.copy(s))}else{n=l?l.length:c.faces.length;for(y=0;y<n;y++){A=l?l[y]:y;s.copy(c.faceNormals[A]);g.vmult(s,s);m++;A=this.testSepAxis(s,
c,d,e,j,g);if(!1===A)return!1;A<r&&(r=A,f.copy(s))}}for(l=0;l!==this.uniqueEdges.length;l++){e.vmult(this.uniqueEdges[l],u);for(m=0;m!==c.uniqueEdges.length;m++)if(g.vmult(c.uniqueEdges[m],v),u.cross(v,x),!x.almostZero()){x.normalize();y=this.testSepAxis(x,c,d,e,j,g);if(!1===y)return!1;y<r&&(r=y,f.copy(x))}}j.vsub(d,t);0<t.dot(f)&&f.negate(f);return!0};var y=[],A=[];d.prototype.testSepAxis=function(c,e,j,g,f,n){d.project(this,c,j,g,y);d.project(e,c,f,n,A);j=y[0];c=y[1];e=A[0];g=A[1];if(j<g||e<c)return!1;
j-=g;c=e-c;return j<c?j:c};var B=new f,C=new f;d.prototype.calculateLocalInertia=function(c,d){this.computeLocalAABB(B,C);var e=C.x-B.x,j=C.y-B.y,g=C.z-B.z;d.x=1/12*c*(4*j*j+4*g*g);d.y=1/12*c*(4*e*e+4*g*g);d.z=1/12*c*(4*j*j+4*e*e)};d.prototype.getPlaneConstantOfFace=function(c){return-this.faceNormals[c].dot(this.vertices[this.faces[c][0]])};var I=new f,z=new f,D=new f,F=new f,L=new f,R=new f,O=new f,N=new f;d.prototype.clipFaceAgainstHull=function(c,d,e,j,g,f,n){for(var l=[],r=-1,q=Number.MAX_VALUE,
m=0;m<this.faces.length;m++){I.copy(this.faceNormals[m]);e.vmult(I,I);var s=I.dot(c);s<q&&(q=s,r=m)}if(!(0>r)){c=this.faces[r];c.connectedFaces=[];for(q=0;q<this.faces.length;q++)for(m=0;m<this.faces[q].length;m++)-1!==c.indexOf(this.faces[q][m])&&(q!==r&&-1===c.connectedFaces.indexOf(q))&&c.connectedFaces.push(q);q=c.length;for(m=0;m<q;m++){s=this.vertices[c[m]];s.vsub(this.vertices[c[(m+1)%q]],z);D.copy(z);e.vmult(D,D);d.vadd(D,D);F.copy(this.faceNormals[r]);e.vmult(F,F);d.vadd(F,F);D.cross(F,L);
L.negate(L);R.copy(s);e.vmult(R,R);d.vadd(R,R);R.dot(L);s=c.connectedFaces[m];O.copy(this.faceNormals[s]);s=this.getPlaneConstantOfFace(s);N.copy(O);e.vmult(N,N);s-=N.dot(d);for(this.clipFaceAgainstPlane(j,l,N,s);j.length;)j.shift();for(;l.length;)j.push(l.shift())}O.copy(this.faceNormals[r]);s=this.getPlaneConstantOfFace(r);N.copy(O);e.vmult(N,N);s-=N.dot(d);for(q=0;q<j.length;q++)d=N.dot(j[q])+s,d<=g&&(console.log("clamped: depth="+d+" to minDist="+(g+"")),d=g),d<=f&&(e=j[q],0>=d&&n.push({point:e,
normal:N,depth:d}))}};d.prototype.clipFaceAgainstPlane=function(c,d,e,j){var g,n,l=c.length;if(2>l)return d;var r=c[c.length-1],q=c[0];g=e.dot(r)+j;for(var m=0;m<l;m++){q=c[m];n=e.dot(q)+j;if(0>g){if(0>n){var s=new f;s.copy(q)}else s=new f,r.lerp(q,g/(g-n),s);d.push(s)}else 0>n&&(s=new f,r.lerp(q,g/(g-n),s),d.push(s),d.push(q));r=q;g=n}return d};d.prototype.computeWorldVertices=function(c,d){for(var e=this.vertices.length;this.worldVertices.length<e;)this.worldVertices.push(new f);for(var j=this.vertices,
g=this.worldVertices,n=0;n!==e;n++)d.vmult(j[n],g[n]),c.vadd(g[n],g[n]);this.worldVerticesNeedsUpdate=!1};new f;d.prototype.computeLocalAABB=function(c,d){var e=this.vertices.length,j=this.vertices;c.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);d.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var g=0;g<e;g++){var f=j[g];f.x<c.x?c.x=f.x:f.x>d.x&&(d.x=f.x);f.y<c.y?c.y=f.y:f.y>d.y&&(d.y=f.y);f.z<c.z?c.z=f.z:f.z>d.z&&(d.z=f.z)}};d.prototype.computeWorldFaceNormals=function(c){for(var d=
this.faceNormals.length;this.worldFaceNormals.length<d;)this.worldFaceNormals.push(new f);for(var e=this.faceNormals,j=this.worldFaceNormals,g=0;g!==d;g++)c.vmult(e[g],j[g]);this.worldFaceNormalsNeedsUpdate=!1};d.prototype.updateBoundingSphereRadius=function(){for(var c=0,d=this.vertices,e=0,j=d.length;e!==j;e++){var g=d[e].norm2();g>c&&(c=g)}this.boundingSphereRadius=Math.sqrt(c)};var V=new f;d.prototype.calculateWorldAABB=function(c,d,e,j){for(var g=this.vertices.length,f=this.vertices,n,l,r,q,
m,s,t=0;t<g;t++){V.copy(f[t]);d.vmult(V,V);c.vadd(V,V);var u=V;if(u.x<n||void 0===n)n=u.x;else if(u.x>q||void 0===q)q=u.x;if(u.y<l||void 0===l)l=u.y;else if(u.y>m||void 0===m)m=u.y;if(u.z<r||void 0===r)r=u.z;else if(u.z>s||void 0===s)s=u.z}e.set(n,l,r);j.set(q,m,s)};d.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3};d.prototype.getAveragePointLocal=function(c){c=c||new f;for(var d=this.vertices.length,e=this.vertices,j=0;j<d;j++)c.vadd(e[j],c);c.mult(1/d,c);return c};d.prototype.transformAllPoints=
function(c,d){var e=this.vertices.length,j=this.vertices;if(d){for(var g=0;g<e;g++){var f=j[g];d.vmult(f,f)}for(g=0;g<this.faceNormals.length;g++)f=this.faceNormals[g],d.vmult(f,f)}if(c)for(g=0;g<e;g++)f=j[g],f.vadd(c,f)};var da=new f,G=new f,E=new f;d.prototype.pointIsInside=function(c){var d=this.vertices.length,e=this.vertices,j=this.faces,g=this.faceNormals,f=this.faces.length;this.getAveragePointLocal(da);for(var n=0;n<f;n++){var d=g[n],l=e[j[n][0]],r=G;c.vsub(l,r);var r=d.dot(r),q=E;da.vsub(l,
q);d=d.dot(q);if(0>r&&0<d||0<r&&0>d)return!1}return-1};new f;var ha=new f,S=new f;d.project=function(c,d,e,j,g){var f=c.vertices.length,n=0,l=0;c=c.vertices;S.setZero();m.vectorToLocalFrame(e,j,d,ha);m.pointToLocalFrame(e,j,S,S);d=S.dot(ha);l=n=c[0].dot(ha);for(e=1;e<f;e++)j=c[e].dot(ha),j>n&&(n=j),j<l&&(l=j);l-=d;n-=d;l>n&&(f=l,l=n,n=f);g[0]=n;g[1]=l}},{"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"./Shape":43}],39:[function(c,e){function d(c,d,e,r){var q=[],s=[],t=[],u=[],v=
[],x=Math.cos,y=Math.sin;q.push(new f(d*x(0),d*y(0),0.5*-e));u.push(0);q.push(new f(c*x(0),c*y(0),0.5*e));v.push(1);for(var A=0;A<r;A++){var B=2*Math.PI/r*(A+1),C=2*Math.PI/r*(A+0.5);A<r-1?(q.push(new f(d*x(B),d*y(B),0.5*-e)),u.push(2*A+2),q.push(new f(c*x(B),c*y(B),0.5*e)),v.push(2*A+3),t.push([2*A+2,2*A+3,2*A+1,2*A])):t.push([0,1,2*A+1,2*A]);(1===r%2||A<r/2)&&s.push(new f(x(C),y(C),0))}t.push(v);s.push(new f(0,0,1));c=[];for(A=0;A<u.length;A++)c.push(u[u.length-A-1]);t.push(c);this.type=g.types.CONVEXPOLYHEDRON;
m.call(this,q,t,s)}e.exports=d;var g=c("./Shape"),f=c("../math/Vec3");c("../math/Quaternion");var m=c("./ConvexPolyhedron");d.prototype=new m},{"../math/Quaternion":28,"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],40:[function(c,e){function d(c,d){d=l.defaults(d,{maxValue:null,minValue:null,elementSize:1});this.data=c;this.maxValue=d.maxValue;this.minValue=d.minValue;this.elementSize=d.elementSize;null===d.minValue&&this.updateMinValue();null===d.maxValue&&this.updateMaxValue();this.cacheEnabled=
!0;g.call(this);this.pillarConvex=new f;this.pillarOffset=new m;this.type=g.types.HEIGHTFIELD;this.updateBoundingSphereRadius();this._cachedPillars={}}var g=c("./Shape"),f=c("./ConvexPolyhedron"),m=c("../math/Vec3"),l=c("../utils/Utils");e.exports=d;d.prototype=new g;d.prototype.update=function(){this._cachedPillars={}};d.prototype.updateMinValue=function(){for(var c=this.data,d=c[0][0],e=0;e!==c.length;e++)for(var g=0;g!==c[e].length;g++){var f=c[e][g];f<d&&(d=f)}this.minValue=d};d.prototype.updateMaxValue=
function(){for(var c=this.data,d=c[0][0],e=0;e!==c.length;e++)for(var g=0;g!==c[e].length;g++){var f=c[e][g];f>d&&(d=f)}this.maxValue=d};d.prototype.setHeightValueAtIndex=function(c,d,e){this.data[c][d]=e;this.clearCachedConvexTrianglePillar(c,d,!1);0<c&&(this.clearCachedConvexTrianglePillar(c-1,d,!0),this.clearCachedConvexTrianglePillar(c-1,d,!1));0<d&&(this.clearCachedConvexTrianglePillar(c,d-1,!0),this.clearCachedConvexTrianglePillar(c,d-1,!1));0<d&&0<c&&this.clearCachedConvexTrianglePillar(c-
1,d-1,!0)};d.prototype.getRectMinMax=function(c,d,e,g,f){f=f||[];for(var l=this.data,m=this.minValue;c<=e;c++)for(var v=d;v<=g;v++){var x=l[c][v];x>m&&(m=x)}f[0]=this.minValue;f[1]=m};d.prototype.getIndexOfPosition=function(c,d,e,g){var f=this.elementSize,l=this.data;c=Math.floor(c/f);d=Math.floor(d/f);e[0]=c;e[1]=d;g&&(0>c&&(c=0),0>d&&(d=0),c>=l.length-1&&(c=l.length-1),d>=l[0].length-1&&(d=l[0].length-1));return 0>c||0>d||c>=l.length-1||d>=l[0].length-1?!1:!0};d.prototype.getHeightAt=function(c,
d,e){var g=[];this.getIndexOfPosition(c,d,g,e);c=[];this.getRectMinMax(g[0],g[1]+1,g[0],g[1]+1,c);return(c[0]+c[1])/2};d.prototype.getCacheConvexTrianglePillarKey=function(c,d,e){return c+"_"+d+"_"+(e?1:0)};d.prototype.getCachedConvexTrianglePillar=function(c,d,e){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(c,d,e)]};d.prototype.setCachedConvexTrianglePillar=function(c,d,e,g,f){this._cachedPillars[this.getCacheConvexTrianglePillarKey(c,d,e)]={convex:g,offset:f}};d.prototype.clearCachedConvexTrianglePillar=
function(c,d,e){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(c,d,e)]};d.prototype.getConvexTrianglePillar=function(c,d,e){var g=this.pillarConvex,l=this.pillarOffset;if(this.cacheEnabled){var t=this.getCachedConvexTrianglePillar(c,d,e);if(t){this.pillarConvex=t.convex;this.pillarOffset=t.offset;return}g=new f;l=new m;this.pillarConvex=g;this.pillarOffset=l}var t=this.data,u=this.elementSize,v=g.faces;g.vertices.length=6;for(var x=0;6>x;x++)g.vertices[x]||(g.vertices[x]=new m);v.length=
5;for(x=0;5>x;x++)v[x]||(v[x]=[]);var x=g.vertices,y=(Math.min(t[c][d],t[c+1][d],t[c][d+1],t[c+1][d+1])-this.minValue)/2+this.minValue;e?(l.set((c+0.75)*u,(d+0.75)*u,y),x[0].set(0.25*u,0.25*u,t[c+1][d+1]-y),x[1].set(-0.75*u,0.25*u,t[c][d+1]-y),x[2].set(0.25*u,-0.75*u,t[c+1][d]-y),x[3].set(0.25*u,0.25*u,-y-1),x[4].set(-0.75*u,0.25*u,-y-1),x[5].set(0.25*u,-0.75*u,-y-1),v[0][0]=0,v[0][1]=1,v[0][2]=2,v[1][0]=5,v[1][1]=4,v[1][2]=3,v[2][0]=2,v[2][1]=5,v[2][2]=3,v[2][3]=0,v[3][0]=3,v[3][1]=4,v[3][2]=1,v[3][3]=
0,v[4][0]=1,v[4][1]=4,v[4][2]=5,v[4][3]=2):(l.set((c+0.25)*u,(d+0.25)*u,y),x[0].set(-0.25*u,-0.25*u,t[c][d]-y),x[1].set(0.75*u,-0.25*u,t[c+1][d]-y),x[2].set(-0.25*u,0.75*u,t[c][d+1]-y),x[3].set(-0.25*u,-0.25*u,-y-1),x[4].set(0.75*u,-0.25*u,-y-1),x[5].set(-0.25*u,0.75*u,-y-1),v[0][0]=0,v[0][1]=1,v[0][2]=2,v[1][0]=5,v[1][1]=4,v[1][2]=3,v[2][0]=0,v[2][1]=2,v[2][2]=5,v[2][3]=3,v[3][0]=1,v[3][1]=0,v[3][2]=3,v[3][3]=4,v[4][0]=4,v[4][1]=5,v[4][2]=2,v[4][3]=1);g.computeNormals();g.computeEdges();g.updateBoundingSphereRadius();
this.setCachedConvexTrianglePillar(c,d,e,g,l)};d.prototype.calculateLocalInertia=function(c,d){d=d||new m;d.set(0,0,0);return d};d.prototype.volume=function(){return Number.MAX_VALUE};d.prototype.calculateWorldAABB=function(c,d,e,g){e.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);g.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)};d.prototype.updateBoundingSphereRadius=function(){var c=this.data,d=this.elementSize;this.boundingSphereRadius=(new m(c.length*d,c[0].length*d,Math.max(Math.abs(this.maxValue),
Math.abs(this.minValue)))).norm()}},{"../math/Vec3":30,"../utils/Utils":53,"./ConvexPolyhedron":38,"./Shape":43}],41:[function(c,e){function d(){g.call(this);this.type=g.types.PARTICLE}e.exports=d;var g=c("./Shape"),f=c("../math/Vec3");d.prototype=new g;d.prototype.constructor=d;d.prototype.calculateLocalInertia=function(c,d){d=d||new f;d.set(0,0,0);return d};d.prototype.volume=function(){return 0};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=0};d.prototype.calculateWorldAABB=
function(c,d,e,g){e.copy(c);g.copy(c)}},{"../math/Vec3":30,"./Shape":43}],42:[function(c,e){function d(){g.call(this);this.type=g.types.PLANE;this.worldNormal=new f;this.worldNormalNeedsUpdate=!0;this.boundingSphereRadius=Number.MAX_VALUE}e.exports=d;var g=c("./Shape"),f=c("../math/Vec3");d.prototype=new g;d.prototype.constructor=d;d.prototype.computeWorldNormal=function(c){var d=this.worldNormal;d.set(0,0,1);c.vmult(d,d);this.worldNormalNeedsUpdate=!1};d.prototype.calculateLocalInertia=function(c,
d){return d=d||new f};d.prototype.volume=function(){return Number.MAX_VALUE};var m=new f;d.prototype.calculateWorldAABB=function(c,d,e,g){m.set(0,0,1);d.vmult(m,m);d=Number.MAX_VALUE;e.set(-d,-d,-d);g.set(d,d,d);1===m.x&&(g.x=c.x);1===m.y&&(g.y=c.y);1===m.z&&(g.z=c.z);-1===m.x&&(e.x=c.x);-1===m.y&&(e.y=c.y);-1===m.z&&(e.z=c.z)};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=Number.MAX_VALUE}},{"../math/Vec3":30,"./Shape":43}],43:[function(c,e){function d(){this.id=d.idCounter++;
this.boundingSphereRadius=this.type=0;this.collisionResponse=!0;this.material=null}e.exports=d;d=c("./Shape");c("../math/Vec3");c("../math/Quaternion");c("../material/Material");d.prototype.constructor=d;d.prototype.updateBoundingSphereRadius=function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type;};d.prototype.volume=function(){throw"volume() not implemented for shape type "+this.type;};d.prototype.calculateLocalInertia=function(){throw"calculateLocalInertia() not implemented for shape type "+
this.type;};d.idCounter=0;d.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"./Shape":43}],44:[function(c,e){function d(c){g.call(this);this.radius=void 0!==c?Number(c):1;this.type=g.types.SPHERE;if(0>this.radius)throw Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}e.exports=d;var g=c("./Shape"),f=c("../math/Vec3");d.prototype=new g;
d.prototype.constructor=d;d.prototype.calculateLocalInertia=function(c,d){d=d||new f;var e=2*c*this.radius*this.radius/5;d.x=e;d.y=e;d.z=e;return d};d.prototype.volume=function(){return 4*Math.PI*this.radius/3};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.radius};d.prototype.calculateWorldAABB=function(c,d,e,g){d=this.radius;for(var f=["x","y","z"],q=0;q<f.length;q++){var s=f[q];e[s]=c[s]-d;g[s]=c[s]+d}}},{"../math/Vec3":30,"./Shape":43}],45:[function(c,e){function d(c,
d){g.call(this);this.type=g.types.TRIMESH;this.vertices=new Float32Array(c);this.indices=new Int16Array(d);this.normals=new Float32Array(d.length);this.aabb=new l;this.edges=null;this.scale=new f(1,1,1);this.tree=new j;this.updateEdges();this.updateNormals();this.updateAABB();this.updateBoundingSphereRadius();this.updateTree()}e.exports=d;var g=c("./Shape"),f=c("../math/Vec3");c("../math/Quaternion");var m=c("../math/Transform"),l=c("../collision/AABB"),j=c("../utils/Octree");d.prototype=new g;d.prototype.constructor=
d;var n=new f;d.prototype.updateTree=function(){var c=this.tree;c.reset();c.aabb.copy(this.aabb);var d=this.scale;c.aabb.lowerBound.x*=1/d.x;c.aabb.lowerBound.y*=1/d.y;c.aabb.lowerBound.z*=1/d.z;c.aabb.upperBound.x*=1/d.x;c.aabb.upperBound.y*=1/d.y;c.aabb.upperBound.z*=1/d.z;for(var d=new l,e=new f,j=new f,g=new f,n=[e,j,g],r=0;r<this.indices.length/3;r++){var q=3*r;this._getUnscaledVertex(this.indices[q],e);this._getUnscaledVertex(this.indices[q+1],j);this._getUnscaledVertex(this.indices[q+2],g);
d.setFromPoints(n);c.insert(d,r)}c.removeEmptyNodes()};var r=new l;d.prototype.getTrianglesInAABB=function(c,d){r.copy(c);var e=this.scale,j=e.x,g=e.y,e=e.z,f=r.lowerBound,n=r.upperBound;f.x/=j;f.y/=g;f.z/=e;n.x/=j;n.y/=g;n.z/=e;return this.tree.aabbQuery(r,d)};d.prototype.setScale=function(c){var d=c.x===c.y===c.z;this.scale.x===this.scale.y===this.scale.z&&d||this.updateNormals();this.scale.copy(c);this.updateAABB();this.updateBoundingSphereRadius()};d.prototype.updateNormals=function(){for(var c=
this.normals,e=0;e<this.indices.length/3;e++){var j=3*e,g=this.indices[j+1],f=this.indices[j+2];this.getVertex(this.indices[j],v);this.getVertex(g,x);this.getVertex(f,y);d.computeNormal(x,v,y,n);c[j]=n.x;c[j+1]=n.y;c[j+2]=n.z}};d.prototype.updateEdges=function(){for(var c={},d=function(){c[g<f?g+"_"+f:f+"_"+g]=!0},e=0;e<this.indices.length/3;e++){var j=3*e,g=this.indices[j],f=this.indices[j+1],j=this.indices[j+2];d(g,f);d(f,j);d(j,g)}d=Object.keys(c);this.edges=new Int16Array(2*d.length);for(e=0;e<
d.length;e++)j=d[e].split("_"),this.edges[2*e]=parseInt(j[0],10),this.edges[2*e+1]=parseInt(j[1],10)};d.prototype.getEdgeVertex=function(c,d,e){this.getVertex(this.edges[2*c+(d?1:0)],e)};var q=new f,s=new f;d.prototype.getEdgeVector=function(c,d){this.getEdgeVertex(c,0,q);this.getEdgeVertex(c,1,s);s.vsub(q,d)};var t=new f,u=new f;d.computeNormal=function(c,d,e,j){d.vsub(c,u);e.vsub(d,t);t.cross(u,j);j.isZero()||j.normalize()};var v=new f,x=new f,y=new f;d.prototype.getVertex=function(c,d){var e=this.scale;
this._getUnscaledVertex(c,d);d.x*=e.x;d.y*=e.y;d.z*=e.z;return d};d.prototype._getUnscaledVertex=function(c,d){var e=3*c,j=this.vertices;return d.set(j[e],j[e+1],j[e+2])};d.prototype.getWorldVertex=function(c,d,e,j){this.getVertex(c,j);m.pointToWorldFrame(d,e,j,j);return j};d.prototype.getTriangleVertices=function(c,d,e,j){c*=3;this.getVertex(this.indices[c],d);this.getVertex(this.indices[c+1],e);this.getVertex(this.indices[c+2],j)};d.prototype.getNormal=function(c,d){var e=3*c;return d.set(this.normals[e],
this.normals[e+1],this.normals[e+2])};var A=new l;d.prototype.calculateLocalInertia=function(c,d){this.computeLocalAABB(A);var e=A.upperBound.x-A.lowerBound.x,j=A.upperBound.y-A.lowerBound.y,g=A.upperBound.z-A.lowerBound.z;return d.set(1/12*c*(4*j*j+4*g*g),1/12*c*(4*e*e+4*g*g),1/12*c*(4*j*j+4*e*e))};var B=new f;d.prototype.computeLocalAABB=function(c){var d=c.lowerBound;c=c.upperBound;var e=this.vertices.length;this.getVertex(0,B);d.copy(B);c.copy(B);for(var j=0;j!==e;j++)this.getVertex(j,B),B.x<
d.x?d.x=B.x:B.x>c.x&&(c.x=B.x),B.y<d.y?d.y=B.y:B.y>c.y&&(c.y=B.y),B.z<d.z?d.z=B.z:B.z>c.z&&(c.z=B.z)};d.prototype.updateAABB=function(){this.computeLocalAABB(this.aabb)};d.prototype.updateBoundingSphereRadius=function(){for(var c=0,d=this.vertices,e=new f,j=0,d=d.length/3;j!==d;j++){this.getVertex(j,e);var g=e.norm2();g>c&&(c=g)}this.boundingSphereRadius=Math.sqrt(c)};new f;var C=new m,I=new l;d.prototype.calculateWorldAABB=function(c,d,e,j){C.position=c;C.quaternion=d;this.aabb.toWorldFrame(C,I);
e.copy(I.lowerBound);j.copy(I.upperBound)};d.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3};d.createTorus=function(c,e,j,g,f){c=c||1;e=e||0.5;j=j||8;g=g||6;f=f||2*Math.PI;for(var n=[],l=[],r=0;r<=j;r++)for(var q=0;q<=g;q++){var m=q/g*f,s=2*r/j*Math.PI,t=(c+e*Math.cos(s))*Math.cos(m),m=(c+e*Math.cos(s))*Math.sin(m),s=e*Math.sin(s);n.push(t,m,s)}for(r=1;r<=j;r++)for(q=1;q<=g;q++)c=(g+1)*(r-1)+q-1,e=(g+1)*(r-1)+q,f=(g+1)*r+q,l.push((g+1)*r+q-1,c,f),l.push(c,e,f);return new d(n,
l)}},{"../collision/AABB":3,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../utils/Octree":50,"./Shape":43}],46:[function(c,e){function d(){g.call(this);this.iterations=10;this.tolerance=1E-7}e.exports=d;c("../math/Vec3");c("../math/Quaternion");var g=c("./Solver");d.prototype=new g;var f=[],m=[],l=[];d.prototype.solve=function(c,d){var e=0,g=this.iterations,s=this.tolerance*this.tolerance,t=this.equations,u=t.length,v=d.bodies,x=v.length,y,A,B,C,I;if(0!==u)for(B=0;B!==x;B++)v[B].updateSolveMassProperties();
m.length=u;l.length=u;f.length=u;for(B=0;B!==u;B++){var z=t[B];f[B]=0;l[B]=z.computeB(c);m[B]=1/z.computeC()}if(0!==u){for(B=0;B!==x;B++)z=v[B],e=z.wlambda,z.vlambda.set(0,0,0),e&&e.set(0,0,0);for(e=0;e!==g;e++){for(var D=B=0;D!==u;D++)z=t[D],y=l[D],A=m[D],I=f[D],C=z.computeGWlambda(),y=A*(y-C-z.eps*I),I+y<z.minForce?y=z.minForce-I:I+y>z.maxForce&&(y=z.maxForce-I),f[D]+=y,B+=0<y?y:-y,z.addToWlambda(y);if(B*B<s)break}for(B=0;B!==x;B++)z=v[B],g=z.velocity,s=z.angularVelocity,g.vadd(z.vlambda,g),s&&
s.vadd(z.wlambda,s)}return e}},{"../math/Quaternion":28,"../math/Vec3":30,"./Solver":47}],47:[function(c,e){function d(){this.equations=[]}e.exports=d;d.prototype.solve=function(){return 0};d.prototype.addEquation=function(c){c.enabled&&this.equations.push(c)};d.prototype.removeEquation=function(c){var d=this.equations;c=d.indexOf(c);-1!==c&&d.splice(c,1)};d.prototype.removeAllEquations=function(){this.equations.length=0}},{}],48:[function(c,e){function d(c){l.call(this);this.iterations=10;this.tolerance=
1E-7;this.subsolver=c;this.nodes=[];for(this.nodePool=[];128>this.nodePool.length;)this.nodePool.push(this.createNode())}function g(c){for(var d=c.length,e=0;e!==d;e++){var j=c[e];if(!j.visited&&!(j.body.type&s))return j}return!1}function f(c,d,e){d.push(c.body);d=c.eqs.length;for(var j=0;j!==d;j++){var g=c.eqs[j];-1===e.indexOf(g)&&e.push(g)}}function m(c,d){return d.id-c.id}e.exports=d;c("../math/Vec3");c("../math/Quaternion");var l=c("./Solver"),j=c("../objects/Body");d.prototype=new l;var n=[],
r=[],q={bodies:[]},s=j.STATIC,t=[];d.prototype.createNode=function(){return{body:null,children:[],eqs:[],visited:!1}};d.prototype.solve=function(c,d){for(var e=this.nodePool,j=d.bodies,l=this.equations,s=l.length,C=j.length,I=this.subsolver;e.length<C;)e.push(this.createNode());n.length=C;for(var z=0;z<C;z++)n[z]=e[z];for(z=0;z!==C;z++)e=n[z],e.body=j[z],e.children.length=0,e.eqs.length=0,e.visited=!1;for(C=0;C!==s;C++){var e=l[C],z=j.indexOf(e.bi),D=j.indexOf(e.bj),z=n[z],D=n[D];z.children.push(D);
z.eqs.push(e);D.children.push(z);D.eqs.push(e)}j=0;l=r;I.tolerance=this.tolerance;for(I.iterations=this.iterations;z=g(n);){l.length=0;q.bodies.length=0;e=z;z=f;s=q.bodies;C=l;t.push(e);e.visited=!0;for(z(e,s,C);t.length;)for(e=t.pop();D=g(e.children);)D.visited=!0,z(D,s,C),t.push(D);s=l.length;l=l.sort(m);for(z=0;z!==s;z++)I.addEquation(l[z]);I.solve(c,q);I.removeAllEquations();j++}return j}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"./Solver":47}],49:[function(c,e){var d=
function(){};e.exports=d;d.prototype={constructor:d,addEventListener:function(c,d){void 0===this._listeners&&(this._listeners={});var e=this._listeners;void 0===e[c]&&(e[c]=[]);-1===e[c].indexOf(d)&&e[c].push(d);return this},hasEventListener:function(c,d){if(void 0===this._listeners)return!1;var e=this._listeners;return void 0!==e[c]&&-1!==e[c].indexOf(d)?!0:!1},removeEventListener:function(c,d){if(void 0===this._listeners)return this;var e=this._listeners;if(void 0===e[c])return this;var l=e[c].indexOf(d);
-1!==l&&e[c].splice(l,1);return this},dispatchEvent:function(c){if(void 0===this._listeners)return this;var d=this._listeners[c.type];if(void 0!==d){c.target=this;for(var e=0,l=d.length;e<l;e++)d[e].call(this,c)}return this}}},{}],50:[function(c,e){function d(c){c=c||{};this.root=c.root||null;this.aabb=c.aabb?c.aabb.clone():new f;this.data=[];this.children=[]}function g(c,e){e=e||{};e.root=null;e.aabb=c;d.call(this,e);this.maxDepth="undefined"!==typeof e.maxDepth?e.maxDepth:8}var f=c("../collision/AABB"),
m=c("../math/Vec3");e.exports=g;g.prototype=new d;d.prototype.reset=function(){this.children.length=this.data.length=0};d.prototype.insert=function(c,d,e){var j=this.data;e=e||0;if(!this.aabb.contains(c))return!1;var g=this.children;if(e<(this.maxDepth||this.root.maxDepth)){var f=!1;g.length||(this.subdivide(),f=!0);for(var l=0;8!==l;l++)if(g[l].insert(c,d,e+1))return!0;f&&(g.length=0)}j.push(d);return!0};var l=new m;d.prototype.subdivide=function(){var c=this.aabb,e=c.lowerBound,j=c.upperBound,c=
this.children;c.push(new d({aabb:new f({lowerBound:new m(0,0,0)})}),new d({aabb:new f({lowerBound:new m(1,0,0)})}),new d({aabb:new f({lowerBound:new m(1,1,0)})}),new d({aabb:new f({lowerBound:new m(1,1,1)})}),new d({aabb:new f({lowerBound:new m(0,1,1)})}),new d({aabb:new f({lowerBound:new m(0,0,1)})}),new d({aabb:new f({lowerBound:new m(1,0,1)})}),new d({aabb:new f({lowerBound:new m(0,1,0)})}));j.vsub(e,l);l.scale(0.5,l);for(var j=this.root||this,g=0;8!==g;g++){var t=c[g];t.root=j;var u=t.aabb.lowerBound;
u.x*=l.x;u.y*=l.y;u.z*=l.z;u.vadd(e,u);u.vadd(l,t.aabb.upperBound)}};d.prototype.aabbQuery=function(c,d){for(var e=[this];e.length;){var j=e.pop();j.aabb.overlaps(c)&&Array.prototype.push.apply(d,j.data);Array.prototype.push.apply(e,j.children)}return d};var j=new f;d.prototype.rayQuery=function(c,d,e){c.getAABB(j);j.toLocalFrame(d,j);this.aabbQuery(j,e);return e};d.prototype.removeEmptyNodes=function(){for(var c=[this];c.length;){for(var d=c.pop(),e=d.children.length-1;0<=e;e--)d.children[e].data.length||
d.children.splice(e,1);Array.prototype.push.apply(c,d.children)}}},{"../collision/AABB":3,"../math/Vec3":30}],51:[function(c,e){function d(){this.objects=[];this.type=Object}e.exports=d;d.prototype.release=function(){for(var c=arguments.length,d=0;d!==c;d++)this.objects.push(arguments[d])};d.prototype.get=function(){return 0===this.objects.length?this.constructObject():this.objects.pop()};d.prototype.constructObject=function(){throw Error("constructObject() not implemented in this Pool subclass yet!");
}},{}],52:[function(c,e){function d(){this.data={keys:[]}}e.exports=d;d.prototype.get=function(c,d){if(c>d){var e=d;d=c;c=e}return this.data[c+"-"+d]};d.prototype.set=function(c,d,e){if(c>d){var l=d;d=c;c=l}l=c+"-"+d;this.get(c,d)||this.data.keys.push(l);this.data[l]=e};d.prototype.reset=function(){for(var c=this.data,d=c.keys;0<d.length;){var e=d.pop();delete c[e]}}},{}],53:[function(c,e){function d(){}e.exports=d;d.defaults=function(c,d){c=c||{};for(var e in d)e in c||(c[e]=d[e]);return c}},{}],
54:[function(c,e){function d(){f.call(this);this.type=g}e.exports=d;var g=c("../math/Vec3"),f=c("./Pool");d.prototype=new f;d.prototype.constructObject=function(){return new g}},{"../math/Vec3":30,"./Pool":51}],55:[function(c,e){function d(c){this.contactPointPool=[];this.frictionEquationPool=[];this.result=[];this.frictionResult=[];this.v3pool=new r;this.world=c;this.currentContactMaterial=null;this.enableFrictionReduction=!1}e.exports=d;var g=c("../collision/AABB"),f=c("../shapes/Shape"),m=c("../collision/Ray"),
l=c("../math/Vec3"),j=c("../math/Transform");c("../shapes/ConvexPolyhedron");var n=c("../math/Quaternion");c("../solver/Solver");var r=c("../utils/Vec3Pool"),q=c("../equations/ContactEquation"),s=c("../equations/FrictionEquation");d.prototype.createContactEquation=function(c,d,e,j,g,f){var n;this.contactPointPool.length?(n=this.contactPointPool.pop(),n.bi=c,n.bj=d):n=new q(c,d);n.enabled=c.collisionResponse&&d.collisionResponse&&e.collisionResponse&&j.collisionResponse;var l=this.currentContactMaterial;
n.restitution=l.restitution;n.setSpookParams(l.contactEquationStiffness,l.contactEquationRelaxation,this.world.dt);c=e.material||c.material;d=j.material||d.material;c&&(d&&0<=c.restitution&&0<=d.restitution)&&(n.restitution=c.restitution*d.restitution);n.si=g||e;n.sj=f||j;return n};d.prototype.createFrictionEquationsFromContact=function(c,d){var e=c.bi,j=c.bj,g=this.world,f=this.currentContactMaterial,n=f.friction,l=c.si.material||e.material,r=c.sj.material||j.material;l&&(r&&0<=l.friction&&0<=r.friction)&&
(n=l.friction*r.friction);if(0<n){n*=g.gravity.length();l=e.invMass+j.invMass;0<l&&(l=1/l);var q=this.frictionEquationPool,r=q.length?q.pop():new s(e,j,n*l),q=q.length?q.pop():new s(e,j,n*l);r.bi=q.bi=e;r.bj=q.bj=j;r.minForce=q.minForce=-n*l;r.maxForce=q.maxForce=n*l;r.ri.copy(c.ri);r.rj.copy(c.rj);q.ri.copy(c.ri);q.rj.copy(c.rj);c.ni.tangents(r.t,q.t);r.setSpookParams(f.frictionEquationStiffness,f.frictionEquationRelaxation,g.dt);q.setSpookParams(f.frictionEquationStiffness,f.frictionEquationRelaxation,
g.dt);r.enabled=q.enabled=c.enabled;d.push(r,q);return!0}return!1};var t=new l,u=new l,v=new l;d.prototype.createFrictionFromAverage=function(c){var d=this.result[this.result.length-1];if(this.createFrictionEquationsFromContact(d,this.frictionResult)&&1!==c){var e=this.frictionResult[this.frictionResult.length-2],j=this.frictionResult[this.frictionResult.length-1];t.setZero();u.setZero();v.setZero();for(var g=d.bi,f=0;f!==c;f++)d=this.result[this.result.length-1-f],d.bodyA!==g?(t.vadd(d.ni,t),u.vadd(d.ri,
u),v.vadd(d.rj,v)):(t.vsub(d.ni,t),u.vadd(d.rj,u),v.vadd(d.ri,v));c=1/c;u.scale(c,e.ri);v.scale(c,e.rj);j.ri.copy(e.ri);j.rj.copy(e.rj);t.normalize();t.tangents(e.t,j.t)}};var x=new l,y=new l,A=new n,B=new n;d.prototype.getContacts=function(c,d,e,j,g,f,n){this.contactPointPool=g;this.frictionEquationPool=n;this.result=j;this.frictionResult=f;j=0;for(g=c.length;j!==g;j++){f=c[j];n=d[j];var l=null;f.material&&n.material&&(l=e.getContactMaterial(f.material,n.material)||null);for(var r=0;r<f.shapes.length;r++){f.quaternion.mult(f.shapeOrientations[r],
A);f.quaternion.vmult(f.shapeOffsets[r],x);x.vadd(f.position,x);for(var q=f.shapes[r],m=0;m<n.shapes.length;m++){n.quaternion.mult(n.shapeOrientations[m],B);n.quaternion.vmult(n.shapeOffsets[m],y);y.vadd(n.position,y);var s=n.shapes[m];if(!(x.distanceTo(y)>q.boundingSphereRadius+s.boundingSphereRadius)){var p=null;q.material&&s.material&&(p=e.getContactMaterial(q.material,s.material)||null);this.currentContactMaterial=p||l||e.defaultContactMaterial;(p=this[q.type|s.type])&&(q.type<s.type?p.call(this,
q,s,x,y,A,B,f,n,q,s):p.call(this,s,q,y,x,B,A,n,f,q,s))}}}}};d.prototype[f.types.BOX|f.types.BOX]=d.prototype.boxBox=function(c,d,e,j,g,f,n,l){c.convexPolyhedronRepresentation.material=c.material;d.convexPolyhedronRepresentation.material=d.material;c.convexPolyhedronRepresentation.collisionResponse=c.collisionResponse;d.convexPolyhedronRepresentation.collisionResponse=d.collisionResponse;this.convexConvex(c.convexPolyhedronRepresentation,d.convexPolyhedronRepresentation,e,j,g,f,n,l,c,d)};d.prototype[f.types.BOX|
f.types.CONVEXPOLYHEDRON]=d.prototype.boxConvex=function(c,d,e,j,g,f,n,l){c.convexPolyhedronRepresentation.material=c.material;c.convexPolyhedronRepresentation.collisionResponse=c.collisionResponse;this.convexConvex(c.convexPolyhedronRepresentation,d,e,j,g,f,n,l,c,d)};d.prototype[f.types.BOX|f.types.PARTICLE]=d.prototype.boxParticle=function(c,d,e,j,g,f,n,l){c.convexPolyhedronRepresentation.material=c.material;c.convexPolyhedronRepresentation.collisionResponse=c.collisionResponse;this.convexParticle(c.convexPolyhedronRepresentation,
d,e,j,g,f,n,l,c,d)};d.prototype[f.types.SPHERE]=d.prototype.sphereSphere=function(c,d,e,j,g,f,n,l){g=this.createContactEquation(n,l,c,d);j.vsub(e,g.ni);g.ni.normalize();g.ri.copy(g.ni);g.rj.copy(g.ni);g.ri.mult(c.radius,g.ri);g.rj.mult(-d.radius,g.rj);g.ri.vadd(e,g.ri);g.ri.vsub(n.position,g.ri);g.rj.vadd(j,g.rj);g.rj.vsub(l.position,g.rj);this.result.push(g);this.createFrictionEquationsFromContact(g,this.frictionResult)};var C=new l,I=new l,z=new l;d.prototype[f.types.PLANE|f.types.TRIMESH]=d.prototype.planeTrimesh=
function(c,d,e,g,f,n,r,q){var m=new l;C.set(0,0,1);f.vmult(C,C);for(f=0;f<d.vertices.length/3;f++){d.getVertex(f,m);var s=new l;s.copy(m);j.pointToWorldFrame(g,n,s,m);s=I;m.vsub(e,s);if(0>=C.dot(s)){var p=this.createContactEquation(r,q,c,d);p.ni.copy(C);var t=z;C.scale(s.dot(C),t);m.vsub(t,t);p.ri.copy(t);p.ri.vsub(r.position,p.ri);p.rj.copy(m);p.rj.vsub(q.position,p.rj);this.result.push(p);this.createFrictionEquationsFromContact(p,this.frictionResult)}}};var D=new l,F=new l;new l;var L=new l,R=new l,
O=new l,N=new l,V=new l,da=new l,G=new l,E=new l,ha=new l,S=new l,J=new l,K=new g,P=[];d.prototype[f.types.SPHERE|f.types.TRIMESH]=d.prototype.sphereTrimesh=function(c,d,e,g,f,n,l,r){j.pointToLocalFrame(g,n,e,G);f=c.radius;K.lowerBound.set(G.x-f,G.y-f,G.z-f);K.upperBound.set(G.x+f,G.y+f,G.z+f);d.getTrianglesInAABB(K,P);var q=c.radius*c.radius;for(f=0;f<P.length;f++)for(var s=0;3>s;s++)if(d.getVertex(d.indices[3*P[f]+s],L),L.vsub(G,F),F.norm2()<=q){R.copy(L);j.pointToWorldFrame(g,n,R,L);L.vsub(e,F);
var p=this.createContactEquation(l,r,c,d);p.ni.copy(F);p.ni.normalize();p.ri.copy(p.ni);p.ri.scale(c.radius,p.ri);p.ri.vadd(e,p.ri);p.ri.vsub(l.position,p.ri);p.rj.copy(L);p.rj.vsub(r.position,p.rj);this.result.push(p);this.createFrictionEquationsFromContact(p,this.frictionResult)}for(f=0;f<P.length;f++)for(s=0;3>s;s++)d.getVertex(d.indices[3*P[f]+s],O),d.getVertex(d.indices[3*P[f]+(s+1)%3],N),N.vsub(O,V),G.vsub(N,E),e=E.dot(V),G.vsub(O,E),p=E.dot(V),0<p&&0>e&&(G.vsub(O,E),da.copy(V),da.normalize(),
p=E.dot(da),da.scale(p,E),E.vadd(O,E),e=E.distanceTo(G),e<c.radius&&(p=this.createContactEquation(l,r,c,d),E.vsub(G,p.ni),p.ni.normalize(),p.ni.scale(c.radius,p.ri),j.pointToWorldFrame(g,n,E,E),E.vsub(r.position,p.rj),j.vectorToWorldFrame(n,p.ni,p.ni),j.vectorToWorldFrame(n,p.ri,p.ri),this.result.push(p),this.createFrictionEquationsFromContact(p,this.frictionResult)));f=0;for(s=P.length;f!==s;f++)d.getTriangleVertices(P[f],ha,S,J),d.getNormal(P[f],D),G.vsub(ha,E),e=E.dot(D),D.scale(e,E),G.vsub(E,
E),e=E.distanceTo(G),m.pointInTriangle(E,ha,S,J)&&e<c.radius&&(p=this.createContactEquation(l,r,c,d),E.vsub(G,p.ni),p.ni.normalize(),p.ni.scale(c.radius,p.ri),j.pointToWorldFrame(g,n,E,E),E.vsub(r.position,p.rj),j.vectorToWorldFrame(n,p.ni,p.ni),j.vectorToWorldFrame(n,p.ri,p.ri),this.result.push(p),this.createFrictionEquationsFromContact(p,this.frictionResult));P.length=0};var Y=new l,Z=new l;d.prototype[f.types.SPHERE|f.types.PLANE]=d.prototype.spherePlane=function(c,d,e,j,g,f,n,l){d=this.createContactEquation(n,
l,c,d);d.ni.set(0,0,1);f.vmult(d.ni,d.ni);d.ni.negate(d.ni);d.ni.normalize();d.ni.mult(c.radius,d.ri);e.vsub(j,Y);d.ni.mult(d.ni.dot(Y),Z);Y.vsub(Z,d.rj);-Y.dot(d.ni)<=c.radius&&(c=d.ri,f=d.rj,c.vadd(e,c),c.vsub(n.position,c),f.vadd(j,f),f.vsub(l.position,f),this.result.push(d),this.createFrictionEquationsFromContact(d,this.frictionResult))};var ka=new l,oa=new l,ea=new l,ma=new l,H=new l,ta=new l,ba=new l,M=[new l,new l,new l,new l,new l,new l],Wa=new l,na=new l,Ha=new l,Na=new l;d.prototype[f.types.SPHERE|
f.types.BOX]=d.prototype.sphereBox=function(c,d,e,j,g,f,n,l){g=this.v3pool;e.vsub(j,ma);d.getSideNormals(M,f);f=c.radius;for(var r=!1,q=null,m=0,p=0,s=0,t=null,u=0,v=M.length;u!==v&&!1===r;u++){var x=H;x.copy(M[u]);var y=x.norm();x.normalize();var A=ma.dot(x);if(A<y+f&&0<A){var z=ta,G=ba;z.copy(M[(u+1)%3]);G.copy(M[(u+2)%3]);var B=z.norm(),E=G.norm();z.normalize();G.normalize();var C=ma.dot(z),K=ma.dot(G);if(C<B&&(C>-B&&K<E&&K>-E)&&(A=Math.abs(A-y-f),null===t||A<t))t=A,p=C,s=K,q=y,na.copy(x),Ha.copy(z),
Na.copy(G),m++}}m&&(r=!0,m=this.createContactEquation(n,l,c,d),na.mult(-f,m.ri),m.ni.copy(na),m.ni.negate(m.ni),na.mult(q,na),Ha.mult(p,Ha),na.vadd(Ha,na),Na.mult(s,Na),na.vadd(Na,m.rj),m.ri.vadd(e,m.ri),m.ri.vsub(n.position,m.ri),m.rj.vadd(j,m.rj),m.rj.vsub(l.position,m.rj),this.result.push(m),this.createFrictionEquationsFromContact(m,this.frictionResult));A=g.get();for(q=0;2!==q&&!r;q++)for(p=0;2!==p&&!r;p++)for(s=0;2!==s&&!r;s++)A.set(0,0,0),q?A.vadd(M[0],A):A.vsub(M[0],A),p?A.vadd(M[1],A):A.vsub(M[1],
A),s?A.vadd(M[2],A):A.vsub(M[2],A),j.vadd(A,Wa),Wa.vsub(e,Wa),Wa.norm2()<f*f&&(r=!0,m=this.createContactEquation(n,l,c,d),m.ri.copy(Wa),m.ri.normalize(),m.ni.copy(m.ri),m.ri.mult(f,m.ri),m.rj.copy(A),m.ri.vadd(e,m.ri),m.ri.vsub(n.position,m.ri),m.rj.vadd(j,m.rj),m.rj.vsub(l.position,m.rj),this.result.push(m),this.createFrictionEquationsFromContact(m,this.frictionResult));g.release(A);t=g.get();u=g.get();m=g.get();v=g.get();A=g.get();x=M.length;for(q=0;q!==x&&!r;q++)for(p=0;p!==x&&!r;p++)if(q%3!==
p%3){M[p].cross(M[q],t);t.normalize();M[q].vadd(M[p],u);m.copy(e);m.vsub(u,m);m.vsub(j,m);y=m.dot(t);t.mult(y,v);for(s=0;s===q%3||s===p%3;)s++;A.copy(e);A.vsub(v,A);A.vsub(u,A);A.vsub(j,A);y=Math.abs(y);z=A.norm();y<M[s].norm()&&z<f&&(r=!0,s=this.createContactEquation(n,l,c,d),u.vadd(v,s.rj),s.rj.copy(s.rj),A.negate(s.ni),s.ni.normalize(),s.ri.copy(s.rj),s.ri.vadd(j,s.ri),s.ri.vsub(e,s.ri),s.ri.normalize(),s.ri.mult(f,s.ri),s.ri.vadd(e,s.ri),s.ri.vsub(n.position,s.ri),s.rj.vadd(j,s.rj),s.rj.vsub(l.position,
s.rj),this.result.push(s),this.createFrictionEquationsFromContact(s,this.frictionResult))}g.release(t,u,m,v,A)};var Ua=new l,bb=new l,ub=new l,cb=new l,vb=new l,Kb=new l,aa=new l,p=new l,Lb=new l,Mb=new l;d.prototype[f.types.SPHERE|f.types.CONVEXPOLYHEDRON]=d.prototype.sphereConvex=function(c,d,e,j,g,f,n,l){g=this.v3pool;e.vsub(j,Ua);for(var r=d.faceNormals,q=d.faces,m=d.vertices,s=c.radius,t=0;t!==m.length;t++){var u=vb;f.vmult(m[t],u);j.vadd(u,u);var v=cb;u.vsub(e,v);if(v.norm2()<s*s){c=this.createContactEquation(n,
l,c,d);c.ri.copy(v);c.ri.normalize();c.ni.copy(c.ri);c.ri.mult(s,c.ri);u.vsub(j,c.rj);c.ri.vadd(e,c.ri);c.ri.vsub(n.position,c.ri);c.rj.vadd(j,c.rj);c.rj.vsub(l.position,c.rj);this.result.push(c);this.createFrictionEquationsFromContact(c,this.frictionResult);return}}t=0;for(u=q.length;t!==u;t++){var v=q[t],x=Kb;f.vmult(r[t],x);var y=aa;f.vmult(m[v[0]],y);y.vadd(j,y);var A=p;x.mult(-s,A);e.vadd(A,A);var z=Lb;A.vsub(y,z);A=z.dot(x);z=Mb;e.vsub(y,z);if(0>A&&0<z.dot(x)){for(var y=[],z=0,G=v.length;z!==
G;z++){var B=g.get();f.vmult(m[v[z]],B);j.vadd(B,B);y.push(B)}a:{for(var z=y,G=x,B=e,E=null,C=z.length,K=0;K!==C;K++){var H=z[K],P=ka;z[(K+1)%C].vsub(H,P);var ha=oa;P.cross(G,ha);P=ea;B.vsub(H,P);H=ha.dot(P);if(null===E||0<H&&!0===E||0>=H&&!1===E)null===E&&(E=0<H);else{z=!1;break a}}z=!0}if(z){c=this.createContactEquation(n,l,c,d);x.mult(-s,c.ri);x.negate(c.ni);d=g.get();x.mult(-A,d);f=g.get();x.mult(-s,f);e.vsub(j,c.rj);c.rj.vadd(f,c.rj);c.rj.vadd(d,c.rj);c.rj.vadd(j,c.rj);c.rj.vsub(l.position,c.rj);
c.ri.vadd(e,c.ri);c.ri.vsub(n.position,c.ri);g.release(d);g.release(f);this.result.push(c);this.createFrictionEquationsFromContact(c,this.frictionResult);z=0;for(v=y.length;z!==v;z++)g.release(y[z]);break}else for(z=0;z!==v.length;z++){x=g.get();A=g.get();f.vmult(m[v[(z+1)%v.length]],x);f.vmult(m[v[(z+2)%v.length]],A);j.vadd(x,x);j.vadd(A,A);C=bb;A.vsub(x,C);E=ub;C.unit(E);G=g.get();B=g.get();e.vsub(x,B);K=B.dot(E);E.mult(K,G);G.vadd(x,G);E=g.get();G.vsub(e,E);if(0<K&&K*K<C.norm2()&&E.norm2()<s*s){c=
this.createContactEquation(n,l,c,d);G.vsub(j,c.rj);G.vsub(e,c.ni);c.ni.normalize();c.ni.mult(s,c.ri);c.rj.vadd(j,c.rj);c.rj.vsub(l.position,c.rj);c.ri.vadd(e,c.ri);c.ri.vsub(n.position,c.ri);this.result.push(c);this.createFrictionEquationsFromContact(c,this.frictionResult);z=0;for(v=y.length;z!==v;z++)g.release(y[z]);g.release(x);g.release(A);g.release(G);g.release(E);g.release(B);return}g.release(x);g.release(A);g.release(G);g.release(E);g.release(B)}z=0;for(v=y.length;z!==v;z++)g.release(y[z])}}};
new l;new l;d.prototype[f.types.PLANE|f.types.BOX]=d.prototype.planeBox=function(c,d,e,j,g,f,n,l){d.convexPolyhedronRepresentation.material=d.material;d.convexPolyhedronRepresentation.collisionResponse=d.collisionResponse;this.planeConvex(c,d.convexPolyhedronRepresentation,e,j,g,f,n,l)};var Ca=new l,Ia=new l,ua=new l,kb=new l;d.prototype[f.types.PLANE|f.types.CONVEXPOLYHEDRON]=d.prototype.planeConvex=function(c,d,e,j,g,f,n,l){Ia.set(0,0,1);g.vmult(Ia,Ia);for(var r=g=0;r!==d.vertices.length;r++)if(Ca.copy(d.vertices[r]),
f.vmult(Ca,Ca),j.vadd(Ca,Ca),Ca.vsub(e,ua),0>=Ia.dot(ua)){var q=this.createContactEquation(n,l,c,d),m=kb;Ia.mult(Ia.dot(ua),m);Ca.vsub(m,m);m.vsub(e,q.ri);q.ni.copy(Ia);Ca.vsub(j,q.rj);q.ri.vadd(e,q.ri);q.ri.vsub(n.position,q.ri);q.rj.vadd(j,q.rj);q.rj.vsub(l.position,q.rj);this.result.push(q);g++;this.enableFrictionReduction||this.createFrictionEquationsFromContact(q,this.frictionResult)}this.enableFrictionReduction&&g&&this.createFrictionFromAverage(g)};var X=new l,Qa=new l;d.prototype[f.types.CONVEXPOLYHEDRON]=
d.prototype.convexConvex=function(c,d,e,j,g,f,n,l,r,q,m,s){if(!(e.distanceTo(j)>c.boundingSphereRadius+d.boundingSphereRadius)&&c.findSeparatingAxis(d,e,g,j,f,X,m,s)){m=[];c.clipAgainstHull(e,g,d,j,f,X,-100,100,m);for(f=g=0;f!==m.length;f++){s=this.createContactEquation(n,l,c,d,r,q);var p=s.ri,t=s.rj;X.negate(s.ni);m[f].normal.negate(Qa);Qa.mult(m[f].depth,Qa);m[f].point.vadd(Qa,p);t.copy(m[f].point);p.vsub(e,p);t.vsub(j,t);p.vadd(e,p);p.vsub(n.position,p);t.vadd(j,t);t.vsub(l.position,t);this.result.push(s);
g++;this.enableFrictionReduction||this.createFrictionEquationsFromContact(s,this.frictionResult)}this.enableFrictionReduction&&g&&this.createFrictionFromAverage(g)}};var ja=new l,qa=new l,Ra=new l;d.prototype[f.types.PLANE|f.types.PARTICLE]=d.prototype.planeParticle=function(c,d,e,j,g,f,n,l){ja.set(0,0,1);n.quaternion.vmult(ja,ja);j.vsub(n.position,qa);0>=ja.dot(qa)&&(c=this.createContactEquation(l,n,d,c),c.ni.copy(ja),c.ni.negate(c.ni),c.ri.set(0,0,0),ja.mult(ja.dot(j),Ra),j.vsub(Ra,Ra),c.rj.copy(Ra),
this.result.push(c),this.createFrictionEquationsFromContact(c,this.frictionResult))};var Ja=new l;d.prototype[f.types.PARTICLE|f.types.SPHERE]=d.prototype.sphereParticle=function(c,d,e,j,g,f,n,l){Ja.set(0,0,1);j.vsub(e,Ja);Ja.norm2()<=c.radius*c.radius&&(d=this.createContactEquation(l,n,d,c),Ja.normalize(),d.rj.copy(Ja),d.rj.mult(c.radius,d.rj),d.ni.copy(Ja),d.ni.negate(d.ni),d.ri.set(0,0,0),this.result.push(d),this.createFrictionEquationsFromContact(d,this.frictionResult))};var yb=new n,Sa=new l;
new l;var db=new l,Ea=new l,Da=new l;d.prototype[f.types.PARTICLE|f.types.CONVEXPOLYHEDRON]=d.prototype.convexParticle=function(c,d,e,j,g,f,n,l){var r=-1;f=null;var q=0;Sa.copy(j);Sa.vsub(e,Sa);g.conjugate(yb);yb.vmult(Sa,Sa);if(c.pointIsInside(Sa)){c.worldVerticesNeedsUpdate&&c.computeWorldVertices(e,g);c.worldFaceNormalsNeedsUpdate&&c.computeWorldFaceNormals(g);g=0;for(var m=c.faces.length;g!==m;g++){var s=c.worldFaceNormals[g];j.vsub(c.worldVertices[c.faces[g][0]],Ea);var p=-s.dot(Ea);if(null===
f||Math.abs(p)<Math.abs(f))f=p,r=g,db.copy(s),q++}-1!==r?(c=this.createContactEquation(l,n,d,c),db.mult(f,Da),Da.vadd(j,Da),Da.vsub(e,Da),c.rj.copy(Da),db.negate(c.ni),c.ri.set(0,0,0),d=c.ri,f=c.rj,d.vadd(j,d),d.vsub(l.position,d),f.vadd(e,f),f.vsub(n.position,f),this.result.push(c),this.createFrictionEquationsFromContact(c,this.frictionResult)):console.warn("Point found inside convex, but did not find penetrating face!")}};d.prototype[f.types.BOX|f.types.HEIGHTFIELD]=d.prototype.boxHeightfield=function(c,
d,e,j,g,f,n,l){c.convexPolyhedronRepresentation.material=c.material;c.convexPolyhedronRepresentation.collisionResponse=c.collisionResponse;this.convexHeightfield(c.convexPolyhedronRepresentation,d,e,j,g,f,n,l)};var Fa=new l,ya=new l,Xa=[0];d.prototype[f.types.CONVEXPOLYHEDRON|f.types.HEIGHTFIELD]=d.prototype.convexHeightfield=function(c,d,e,g,f,n,l,r){var q=d.data,m=d.elementSize,s=c.boundingSphereRadius;j.pointToLocalFrame(g,n,e,Fa);var p=Math.floor((Fa.x-s)/m)-1,t=Math.ceil((Fa.x+s)/m)+1,u=Math.floor((Fa.y-
s)/m)-1,m=Math.ceil((Fa.y+s)/m)+1;if(!(0>t||0>m||p>q.length||u>q[0].length)){0>p&&(p=0);0>t&&(t=0);0>u&&(u=0);0>m&&(m=0);p>=q.length&&(p=q.length-1);t>=q.length&&(t=q.length-1);m>=q[0].length&&(m=q[0].length-1);u>=q[0].length&&(u=q[0].length-1);q=[];d.getRectMinMax(p,u,t,m,q);var v=q[0];if(!(Fa.z-s>q[1]||Fa.z+s<v))for(s=p;s<t;s++)for(p=u;p<m;p++)d.getConvexTrianglePillar(s,p,!1),j.pointToWorldFrame(g,n,d.pillarOffset,ya),e.distanceTo(ya)<d.pillarConvex.boundingSphereRadius+c.boundingSphereRadius&&
this.convexConvex(c,d.pillarConvex,e,ya,f,n,l,r,null,null,Xa,null),d.getConvexTrianglePillar(s,p,!0),j.pointToWorldFrame(g,n,d.pillarOffset,ya),e.distanceTo(ya)<d.pillarConvex.boundingSphereRadius+c.boundingSphereRadius&&this.convexConvex(c,d.pillarConvex,e,ya,f,n,l,r,null,null,Xa,null)}};var za=new l,Aa=new l;d.prototype[f.types.SPHERE|f.types.HEIGHTFIELD]=d.prototype.sphereHeightfield=function(c,d,e,g,f,n,l,r){var q=d.data,m=c.radius,s=d.elementSize;j.pointToLocalFrame(g,n,e,za);var p=Math.floor((za.x-
m)/s)-1,t=Math.ceil((za.x+m)/s)+1,u=Math.floor((za.y-m)/s)-1,s=Math.ceil((za.y+m)/s)+1;if(!(0>t||0>s||p>q.length||s>q[0].length)){0>p&&(p=0);0>t&&(t=0);0>u&&(u=0);0>s&&(s=0);p>=q.length&&(p=q.length-1);t>=q.length&&(t=q.length-1);s>=q[0].length&&(s=q[0].length-1);u>=q[0].length&&(u=q[0].length-1);q=[];d.getRectMinMax(p,u,t,s,q);var v=q[0];if(!(za.z-m>q[1]||za.z+m<v))for(m=this.result;p<t;p++)for(q=u;q<s;q++)if(v=m.length,d.getConvexTrianglePillar(p,q,!1),j.pointToWorldFrame(g,n,d.pillarOffset,Aa),
e.distanceTo(Aa)<d.pillarConvex.boundingSphereRadius+c.boundingSphereRadius&&this.sphereConvex(c,d.pillarConvex,e,Aa,f,n,l,r),d.getConvexTrianglePillar(p,q,!0),j.pointToWorldFrame(g,n,d.pillarOffset,Aa),e.distanceTo(Aa)<d.pillarConvex.boundingSphereRadius+c.boundingSphereRadius&&this.sphereConvex(c,d.pillarConvex,e,Aa,f,n,l,r),2<m.length-v)return}}},{"../collision/AABB":3,"../collision/Ray":9,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../math/Quaternion":28,"../math/Transform":29,
"../math/Vec3":30,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43,"../solver/Solver":47,"../utils/Vec3Pool":54}],56:[function(c,e){function d(){j.apply(this);this.dt=-1;this.allowSleep=!1;this.contacts=[];this.frictionEquations=[];this.quatNormalizeSkip=0;this.quatNormalizeFast=!1;this.stepnumber=this.time=0;this.default_dt=1/60;this.nextId=0;this.gravity=new g;this.broadphase=new y;this.bodies=[];this.solver=new m;this.constraints=[];this.narrowphase=new l(this);this.collisionMatrix=new n;this.collisionMatrixPrevious=
new n;this.materials=[];this.contactmaterials=[];this.contactMaterialTable=new t;this.defaultMaterial=new r("default");this.defaultContactMaterial=new q(this.defaultMaterial,this.defaultMaterial,{friction:0.3,restitution:0});this.doProfiling=!1;this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0};this.subsystems=[];this.addBodyEvent={type:"addBody",body:null};this.removeBodyEvent={type:"removeBody",body:null}}e.exports=d;c("../shapes/Shape");var g=c("../math/Vec3"),
f=c("../math/Quaternion"),m=c("../solver/GSSolver");c("../utils/Vec3Pool");c("../equations/ContactEquation");c("../equations/FrictionEquation");var l=c("./Narrowphase"),j=c("../utils/EventTarget"),n=c("../collision/ArrayCollisionMatrix"),r=c("../material/Material"),q=c("../material/ContactMaterial"),s=c("../objects/Body"),t=c("../utils/TupleDictionary"),u=c("../collision/RaycastResult"),v=c("../collision/AABB"),x=c("../collision/Ray"),y=c("../collision/NaiveBroadphase");d.prototype=new j;new v;var A=
new x;d.prototype.getContactMaterial=function(c,d){return this.contactMaterialTable.get(c.id,d.id)};d.prototype.numObjects=function(){return this.bodies.length};d.prototype.collisionMatrixTick=function(){var c=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix;this.collisionMatrix=c;this.collisionMatrix.reset()};d.prototype.add=d.prototype.addBody=function(c){-1===this.bodies.indexOf(c)&&(c.index=this.bodies.length,this.bodies.push(c),c.world=this,c.initPosition.copy(c.position),
c.initVelocity.copy(c.velocity),c.timeLastSleepy=this.time,c instanceof s&&(c.initAngularVelocity.copy(c.angularVelocity),c.initQuaternion.copy(c.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=c,this.dispatchEvent(this.addBodyEvent))};d.prototype.addConstraint=function(c){this.constraints.push(c)};d.prototype.removeConstraint=function(c){c=this.constraints.indexOf(c);-1!==c&&this.constraints.splice(c,1)};d.prototype.rayTest=function(c,d,e){e instanceof u?
this.raycastClosest(c,d,{skipBackfaces:!0},e):this.raycastAll(c,d,{skipBackfaces:!0},e)};d.prototype.raycastAll=function(c,d,e,j){e.mode=x.ALL;e.from=c;e.to=d;e.callback=j;return A.intersectWorld(this,e)};d.prototype.raycastAny=function(c,d,e,j){e.mode=x.ANY;e.from=c;e.to=d;e.result=j;return A.intersectWorld(this,e)};d.prototype.raycastClosest=function(c,d,e,j){e.mode=x.CLOSEST;e.from=c;e.to=d;e.result=j;return A.intersectWorld(this,e)};d.prototype.remove=function(c){c.world=null;var d=this.bodies.length-
1,e=this.bodies,j=e.indexOf(c);if(-1!==j){e.splice(j,1);for(j=0;j!==e.length;j++)e[j].index=j;this.collisionMatrix.setNumObjects(d);this.removeBodyEvent.body=c;this.dispatchEvent(this.removeBodyEvent)}};d.prototype.removeBody=d.prototype.remove;d.prototype.addMaterial=function(c){this.materials.push(c)};d.prototype.addContactMaterial=function(c){this.contactmaterials.push(c);this.contactMaterialTable.set(c.materials[0].id,c.materials[1].id,c)};"undefined"===typeof performance&&(performance={});if(!performance.now){var B=
Date.now();performance.timing&&performance.timing.navigationStart&&(B=performance.timing.navigationStart);performance.now=function(){return Date.now()-B}}var C=new g;d.prototype.step=function(c,d,e){e=e||10;d=d||0;if(0===d)this.internalStep(c),this.time+=c;else{var j=Math.floor((this.time+d)/c)-Math.floor(this.time/c),j=Math.min(j,e);e=performance.now();for(var g=0;g!==j&&!(this.internalStep(c),performance.now()-e>1E3*c);g++);this.time+=d;c=this.time%c/c;d=this.bodies;for(j=0;j!==d.length;j++)e=d[j],
e.type!==s.STATIC&&e.sleepState!==s.SLEEPING?(e.position.vsub(e.previousPosition,C),C.scale(c,C),e.position.vadd(C,e.interpolatedPosition)):(e.interpolatedPosition.copy(e.position),e.interpolatedQuaternion.copy(e.quaternion))}};var I={type:"postStep"},z={type:"preStep"},D={type:"collide",body:null,contact:null},F=[],L=[],R=[],O=[];new g;new g;new g;new g;new g;new g;new g;new g;new g;new f;var N=new f,V=new f,da=new g;d.prototype.internalStep=function(c){this.dt=c;var d=this.contacts,e=this.numObjects(),
j=this.bodies,g=this.solver,f=this.gravity,n=this.doProfiling,l=this.profile,r=s.DYNAMIC,q,m=this.constraints;f.norm();var t=f.x,u=f.y,v=f.z,f=0;n&&(q=performance.now());for(f=0;f!==e;f++){var x=j[f];if(x.type&r){var y=x.force,x=x.mass;y.x+=x*t;y.y+=x*u;y.z+=x*v}}f=0;for(x=this.subsystems.length;f!==x;f++)this.subsystems[f].update();n&&(q=performance.now());R.length=0;O.length=0;this.broadphase.collisionPairs(this,R,O);n&&(l.broadphase=performance.now()-q);x=m.length;for(f=0;f!==x;f++)if(t=m[f],!t.collideConnected)for(u=
R.length-1;0<=u;u-=1)if(t.bodyA===R[u]&&t.bodyB===O[u]||t.bodyB===R[u]&&t.bodyA===O[u])R.splice(u,1),O.splice(u,1);this.collisionMatrixTick();n&&(q=performance.now());x=d.length;for(f=0;f!==x;f++)F.push(d[f]);d.length=0;x=this.frictionEquations.length;for(f=0;f!==x;f++)L.push(this.frictionEquations[f]);this.frictionEquations.length=0;this.narrowphase.getContacts(R,O,this,d,F,this.frictionEquations,L);n&&(l.narrowphase=performance.now()-q);n&&(q=performance.now());for(f=0;f<this.frictionEquations.length;f++)g.addEquation(this.frictionEquations[f]);
f=d.length;for(u=0;u!==f;u++){t=d[u];x=t.bi;v=t.bj;x.material&&v.material&&this.getContactMaterial(x.material,v.material);x.material&&v.material&&(0<=x.material.restitution&&0<=v.material.restitution)&&(t.restitution=x.material.restitution*v.material.restitution);g.addEquation(t);if(x.allowSleep&&x.type===s.DYNAMIC&&x.sleepState===s.SLEEPING&&v.sleepState===s.AWAKE&&v.type!==s.STATIC){var y=v.velocity.norm2()+v.angularVelocity.norm2(),A=Math.pow(v.sleepSpeedLimit,2);y>=2*A&&(x._wakeUpAfterNarrowphase=
!0)}v.allowSleep&&(v.type===s.DYNAMIC&&v.sleepState===s.SLEEPING&&x.sleepState===s.AWAKE&&x.type!==s.STATIC)&&(y=x.velocity.norm2()+x.angularVelocity.norm2(),A=Math.pow(x.sleepSpeedLimit,2),y>=2*A&&(v._wakeUpAfterNarrowphase=!0));this.collisionMatrix.set(x,v,!0);this.collisionMatrixPrevious.get(x,v)||(D.body=v,D.contact=t,x.dispatchEvent(D),D.body=x,v.dispatchEvent(D))}n&&(l.makeContactConstraints=performance.now()-q,q=performance.now());for(f=0;f!==e;f++)x=j[f],x._wakeUpAfterNarrowphase&&(x.wakeUp(),
x._wakeUpAfterNarrowphase=!1);x=m.length;for(f=0;f!==x;f++){t=m[f];t.update();u=0;for(d=t.equations.length;u!==d;u++)g.addEquation(t.equations[u])}g.solve(c,this);n&&(l.solve=performance.now()-q);g.removeAllEquations();g=Math.pow;for(f=0;f!==e;f++)if(x=j[f],x.type&r&&(m=g(1-x.linearDamping,c),d=x.velocity,d.mult(m,d),m=x.angularVelocity))d=g(1-x.angularDamping,c),m.mult(d,m);this.dispatchEvent(z);for(f=0;f!==e;f++)x=j[f],x.preStep&&x.preStep.call(x);n&&(q=performance.now());r=s.DYNAMIC|s.KINEMATIC;
g=0===this.stepnumber%(this.quatNormalizeSkip+1);m=this.quatNormalizeFast;d=0.5*c;for(f=0;f!==e;f++)if(x=j[f],t=x.force,u=x.torque,x.type&r&&x.sleepState!==s.SLEEPING){var v=x.velocity,y=x.angularVelocity,A=x.position,B=x.quaternion,C=x.invMass,Ha=x.invInertiaWorld;v.x+=t.x*C*c;v.y+=t.y*C*c;v.z+=t.z*C*c;x.angularVelocity&&(Ha.vmult(u,da),da.mult(c,da),da.vadd(y,y));A.x+=v.x*c;A.y+=v.y*c;A.z+=v.z*c;x.angularVelocity&&(N.set(y.x,y.y,y.z,0),N.mult(B,V),B.x+=d*V.x,B.y+=d*V.y,B.z+=d*V.z,B.w+=d*V.w,g&&
(m?B.normalizeFast():B.normalize()));x.aabb&&(x.aabbNeedsUpdate=!0);x.updateInertiaWorld&&x.updateInertiaWorld()}this.clearForces();this.broadphase.dirty=!0;n&&(l.integrate=performance.now()-q);this.time+=c;this.stepnumber+=1;this.dispatchEvent(I);for(f=0;f!==e;f++)x=j[f],(c=x.postStep)&&c.call(x);if(this.allowSleep)for(f=0;f!==e;f++)j[f].sleepTick(this.time)};d.prototype.clearForces=function(){for(var c=this.bodies,d=c.length,e=0;e!==d;e++){var j=c[e];j.force.set(0,0,0);j.torque.set(0,0,0)}}},{"../collision/AABB":3,
"../collision/ArrayCollisionMatrix":4,"../collision/NaiveBroadphase":7,"../collision/Ray":9,"../collision/RaycastResult":10,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../material/ContactMaterial":24,"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Shape":43,"../solver/GSSolver":46,"../utils/EventTarget":49,"../utils/TupleDictionary":52,"../utils/Vec3Pool":54,"./Narrowphase":55}]},{},[2])(2)});function getInternetExplorerVersion(){var b=-1;"Microsoft Internet Explorer"==navigator.appName&&null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(b=parseFloat(RegExp.$1));return b}var ie=getInternetExplorerVersion();function getQueryVariable(b){for(var c=window.location.search.substring(1).split("&"),e=0;e<c.length;e++){var d=c[e].match(/([^=]+?)=(.+)/);if(d&&decodeURIComponent(d[1])==b)return decodeURIComponent(d[2])}};this.jukebox={};
jukebox.Player=function(b,c){this.id=++jukebox.__jukeboxId;this.origin=c||null;this.settings={};for(var e in this.defaults)this.settings[e]=this.defaults[e];if("[object Object]"===Object.prototype.toString.call(b))for(var d in b)this.settings[d]=b[d];"[object Function]"===Object.prototype.toString.call(jukebox.Manager)&&(jukebox.Manager=new jukebox.Manager);this.resource=this.isPlaying=null;this.resource="[object Object]"===Object.prototype.toString.call(jukebox.Manager)?jukebox.Manager.getPlayableResource(this.settings.resources):this.settings.resources[0]||
null;if(null===this.resource)throw"Your browser can't playback the given resources - or you have missed to include jukebox.Manager";this.__init();return this};jukebox.__jukeboxId=0;
jukebox.Player.prototype={defaults:{resources:[],autoplay:!1,spritemap:{},flashMediaElement:"./swf/FlashMediaElement.swf",timeout:1E3},__addToManager:function(){!0!==this.__wasAddedToManager&&(jukebox.Manager.add(this),this.__wasAddedToManager=!0)},__init:function(){var b=this,c=this.settings,e={},d;jukebox.Manager&&void 0!==jukebox.Manager.features&&(e=jukebox.Manager.features);if(!0===e.html5audio){this.context=new Audio;this.context.src=this.resource;if(null===this.origin){var g=function(c){b.__addToManager(c)};
this.context.addEventListener("canplaythrough",g,!0);window.setTimeout(function(){b.context.removeEventListener("canplaythrough",g,!0);g("timeout")},c.timeout)}this.context.autobuffer=!0;this.context.preload=!0;for(d in this.HTML5API)this[d]=this.HTML5API[d];1<e.channels?!0===c.autoplay?this.context.autoplay=!0:void 0!==c.spritemap[c.autoplay]&&this.play(c.autoplay):1===e.channels&&void 0!==c.spritemap[c.autoplay]&&(this.backgroundMusic=c.spritemap[c.autoplay],this.backgroundMusic.started=Date.now?
Date.now():+new Date,this.play(c.autoplay));1==e.channels&&!0!==c.canPlayBackground&&(window.addEventListener("pagehide",function(){null!==b.isPlaying&&(b.pause(),b.__wasAutoPaused=!0)}),window.addEventListener("pageshow",function(){b.__wasAutoPaused&&(b.resume(),delete b._wasAutoPaused)}))}else if(!0===e.flashaudio){for(d in this.FLASHAPI)this[d]=this.FLASHAPI[d];e=["id=jukebox-flashstream-"+this.id,"autoplay="+c.autoplay,"file="+window.encodeURIComponent(this.resource)];this.__initFlashContext(e);
!0===c.autoplay?this.play(0):c.spritemap[c.autoplay]&&this.play(c.autoplay)}else throw"Your Browser does not support Flash Audio or HTML5 Audio.";},__initFlashContext:function(b){var c,e=this.settings.flashMediaElement,d,g={flashvars:b.join("&"),quality:"high",bgcolor:"#000000",wmode:"transparent",allowscriptaccess:"always",allowfullscreen:"true"};if(navigator.userAgent.match(/MSIE/)){c=document.createElement("div");document.getElementsByTagName("body")[0].appendChild(c);var f=document.createElement("object");
f.id="jukebox-flashstream-"+this.id;f.setAttribute("type","application/x-shockwave-flash");f.setAttribute("classid","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000");f.setAttribute("width","0");f.setAttribute("height","0");g.movie=e+"?x="+(Date.now?Date.now():+new Date);g.flashvars=b.join("&amp;");for(d in g)b=document.createElement("param"),b.setAttribute("name",d),b.setAttribute("value",g[d]),f.appendChild(b);c.outerHTML=f.outerHTML;this.context=document.getElementById("jukebox-flashstream-"+this.id)}else{c=
document.createElement("embed");c.id="jukebox-flashstream-"+this.id;c.setAttribute("type","application/x-shockwave-flash");c.setAttribute("width","100");c.setAttribute("height","100");g.play=!1;g.loop=!1;g.src=e+"?x="+(Date.now?Date.now():+new Date);for(d in g)c.setAttribute(d,g[d]);document.getElementsByTagName("body")[0].appendChild(c);this.context=c}},backgroundHackForiOS:function(){if(void 0!==this.backgroundMusic){var b=Date.now?Date.now():+new Date;void 0===this.backgroundMusic.started?(this.backgroundMusic.started=
b,this.setCurrentTime(this.backgroundMusic.start)):(this.backgroundMusic.lastPointer=(b-this.backgroundMusic.started)/1E3%(this.backgroundMusic.end-this.backgroundMusic.start)+this.backgroundMusic.start,this.play(this.backgroundMusic.lastPointer))}},play:function(b,c){if(null!==this.isPlaying&&!0!==c)void 0!==jukebox.Manager&&jukebox.Manager.addToQueue(b,this.id);else{var e=this.settings.spritemap,d;if(void 0!==e[b])d=e[b].start;else if("number"===typeof b){d=b;for(var g in e)if(d>=e[g].start&&d<=
e[g].end){b=g;break}}void 0!==d&&"[object Object]"===Object.prototype.toString.call(e[b])&&(this.isPlaying=this.settings.spritemap[b],this.context.play&&this.context.play(),this.wasReady=this.setCurrentTime(d))}},stop:function(){this.__lastPosition=0;this.isPlaying=null;this.backgroundMusic?this.backgroundHackForiOS():this.context.pause();return!0},pause:function(){this.isPlaying=null;this.__lastPosition=this.getCurrentTime();this.context.pause();return this.__lastPosition},resume:function(b){b="number"===
typeof b?b:this.__lastPosition;if(null!==b)return this.play(b),this.__lastPosition=null,!0;this.context.play();return!1},HTML5API:{getVolume:function(){return this.context.volume||1},setVolume:function(b){this.context.volume=b;return 1E-4>Math.abs(this.context.volume-b)?!0:!1},getCurrentTime:function(){return this.context.currentTime||0},setCurrentTime:function(b){try{return this.context.currentTime=b,!0}catch(c){return!1}}},FLASHAPI:{getVolume:function(){return this.context&&"function"===typeof this.context.getVolume?
this.context.getVolume():1},setVolume:function(b){return this.context&&"function"===typeof this.context.setVolume?(this.context.setVolume(b),!0):!1},getCurrentTime:function(){return this.context&&"function"===typeof this.context.getCurrentTime?this.context.getCurrentTime():0},setCurrentTime:function(b){return this.context&&"function"===typeof this.context.setCurrentTime?this.context.setCurrentTime(b):!1}}};
if(void 0===this.jukebox)throw"jukebox.Manager requires jukebox.Player (Player.js) to run properly.";
jukebox.Manager=function(b){this.features={};this.codecs={};this.__players={};this.__playersLength=0;this.__clones={};this.__queue=[];this.settings={};for(var c in this.defaults)this.settings[c]=this.defaults[c];if("[object Object]"===Object.prototype.toString.call(b))for(var e in b)this.settings[e]=b[e];this.__detectFeatures();jukebox.Manager.__initialized=!1===this.settings.useGameLoop?window.setInterval(function(){jukebox.Manager.loop()},20):!0};
jukebox.Manager.prototype={defaults:{useFlash:!1,useGameLoop:!1},__detectFeatures:function(){var b=window.Audio&&new Audio;if(b&&b.canPlayType&&!1===this.settings.useFlash){for(var c=[{e:"3gp",m:["audio/3gpp","audio/amr"]},{e:"aac",m:["audio/aac","audio/aacp"]},{e:"amr",m:["audio/amr","audio/3gpp"]},{e:"caf",m:["audio/IMA-ADPCM","audio/x-adpcm",'audio/x-aiff; codecs="IMA-ADPCM, ADPCM"']},{e:"m4a",m:'audio/mp4{audio/mp4; codecs="mp4a.40.2,avc1.42E01E"{audio/mpeg4{audio/mpeg4-generic{audio/mp4a-latm{audio/MP4A-LATM{audio/x-m4a'.split("{")},
{e:"mp3",m:["audio/mp3","audio/mpeg",'audio/mpeg; codecs="mp3"',"audio/MPA","audio/mpa-robust"]},{e:"mpga",m:["audio/MPA","audio/mpa-robust","audio/mpeg","video/mpeg"]},{e:"mp4",m:["audio/mp4","video/mp4"]},{e:"ogg",m:["application/ogg","audio/ogg",'audio/ogg; codecs="theora, vorbis"',"video/ogg",'video/ogg; codecs="theora, vorbis"']},{e:"wav",m:["audio/wave","audio/wav",'audio/wav; codecs="1"',"audio/x-wav","audio/x-pn-wav"]},{e:"webm",m:["audio/webm",'audio/webm; codecs="vorbis"',"video/webm"]}],
e,d,g=0,f=c.length;g<f;g++)if(d=c[g].e,c[g].m.length&&"object"===typeof c[g].m)for(var m=0,l=c[g].m.length;m<l;m++)if(e=c[g].m[m],""!==b.canPlayType(e)){this.codecs[d]=e;break}else this.codecs[d]||(this.codecs[d]=!1);this.features.html5audio=!(!this.codecs.mp3&&!this.codecs.ogg&&!this.codecs.webm&&!this.codecs.wav);this.features.channels=8;b.volume=0.1337;this.features.volume=!!(1E-4>Math.abs(b.volume-0.1337));navigator.userAgent.match(/iPhone|iPod|iPad/i)&&(this.features.channels=1)}this.features.flashaudio=
!!navigator.mimeTypes["application/x-shockwave-flash"]||!!navigator.plugins["Shockwave Flash"]||!1;if(window.ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash.10"),this.features.flashaudio=!0}catch(j){}!0===this.settings.useFlash&&(this.features.flashaudio=!0);!0===this.features.flashaudio&&!this.features.html5audio&&(this.codecs.mp3="audio/mp3",this.codecs.mpga="audio/mpeg",this.codecs.mp4="audio/mp4",this.codecs.m4a="audio/mp4",this.codecs["3gp"]="audio/3gpp",this.codecs.amr="audio/amr",
this.features.volume=!0,this.features.channels=1)},__getPlayerById:function(b){return this.__players&&void 0!==this.__players[b]?this.__players[b]:null},__getClone:function(b,c){for(var e in this.__clones){var d=this.__clones[e];if(null===d.isPlaying&&d.origin===b)return d}if("[object Object]"===Object.prototype.toString.call(c)){e={};for(var g in c)e[g]=c[g];e.autoplay=!1;g=new jukebox.Player(e,b);g.isClone=!0;g.wasReady=!1;return this.__clones[g.id]=g}return null},loop:function(){if(0!==this.__playersLength)if(this.__queue.length&&
this.__playersLength<this.features.channels){var b=this.__queue[0],c=this.__getPlayerById(b.origin);if(null!==c){var e=this.__getClone(b.origin,c.settings);null!==e&&(!0===this.features.volume&&(c=this.__players[b.origin])&&e.setVolume(c.getVolume()),this.add(e),e.play(b.pointer,!0))}this.__queue.splice(0,1)}else for(e in this.__queue.length&&1===this.features.channels&&(b=this.__queue[0],c=this.__getPlayerById(b.origin),null!==c&&c.play(b.pointer,!0),this.__queue.splice(0,1)),this.__players)b=this.__players[e],
c=b.getCurrentTime()||0,b.isPlaying&&!1===b.wasReady?b.wasReady=b.setCurrentTime(b.isPlaying.start):b.isPlaying&&!0===b.wasReady?c>b.isPlaying.end&&(!0===b.isPlaying.loop?b.play(b.isPlaying.start,!0):b.stop()):b.isClone&&null===b.isPlaying?this.remove(b):void 0!==b.backgroundMusic&&null===b.isPlaying&&c>b.backgroundMusic.end&&b.backgroundHackForiOS()},getPlayableResource:function(b){"[object Array]"!==Object.prototype.toString.call(b)&&(b=[b]);for(var c=0,e=b.length;c<e;c++){var d=b[c],g=d.match(/\.([^\.]*)$/)[1];
if(g&&this.codecs[g])return d}return null},add:function(b){return b instanceof jukebox.Player&&void 0===this.__players[b.id]?(this.__playersLength++,this.__players[b.id]=b,!0):!1},remove:function(b){return b instanceof jukebox.Player&&void 0!==this.__players[b.id]?(this.__playersLength--,delete this.__players[b.id],!0):!1},addToQueue:function(b,c){return("string"===typeof b||"number"===typeof b)&&void 0!==this.__players[c]?(this.__queue.push({pointer:b,origin:c}),!0):!1}};(function(){var b=function(){this.init()};b.prototype={init:function(){var b=this||c;b._counter=1E3;b._html5AudioPool=[];b.html5PoolSize=10;b._codecs={};b._howls=[];b._muted=!1;b._volume=1;b._canPlayEvent="canplaythrough";b._navigator="undefined"!==typeof window&&window.navigator?window.navigator:null;b.masterGain=null;b.noAudio=!1;b.usingWebAudio=!0;b.autoSuspend=!1;b.ctx=null;b.autoUnlock=!0;b._setup();return b},volume:function(b){var d=this||c;b=parseFloat(b);d.ctx||l();if("undefined"!==typeof b&&
0<=b&&1>=b){d._volume=b;if(d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(b,c.ctx.currentTime);for(var e=0;e<d._howls.length;e++)if(!d._howls[e]._webAudio)for(var g=d._howls[e]._getSoundIds(),f=0;f<g.length;f++){var m=d._howls[e]._soundById(g[f]);m&&m._node&&(m._node.volume=m._volume*b)}return d}return d._volume},mute:function(b){var d=this||c;d.ctx||l();d._muted=b;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(b?0:d._volume,c.ctx.currentTime);for(var e=0;e<d._howls.length;e++)if(!d._howls[e]._webAudio)for(var g=
d._howls[e]._getSoundIds(),f=0;f<g.length;f++){var m=d._howls[e]._soundById(g[f]);m&&m._node&&(m._node.muted=b?!0:m._muted)}return d},stop:function(){for(var b=this||c,d=0;d<b._howls.length;d++)b._howls[d].stop();return b},unload:function(){for(var b=this||c,d=b._howls.length-1;0<=d;d--)b._howls[d].unload();b.usingWebAudio&&(b.ctx&&"undefined"!==typeof b.ctx.close)&&(b.ctx.close(),b.ctx=null,l());return b},codecs:function(b){return(this||c)._codecs[b.replace(/^x-/,"")]},_setup:function(){var b=this||
c;b.state=b.ctx?b.ctx.state||"suspended":"suspended";b._autoSuspend();if(!b.usingWebAudio)if("undefined"!==typeof Audio)try{var d=new Audio;"undefined"===typeof d.oncanplaythrough&&(b._canPlayEvent="canplay")}catch(e){b.noAudio=!0}else b.noAudio=!0;try{d=new Audio,d.muted&&(b.noAudio=!0)}catch(g){}b.noAudio||b._setupCodecs();return b},_setupCodecs:function(){var b=this||c,d=null;try{d="undefined"!==typeof Audio?new Audio:null}catch(e){return b}if(!d||"function"!==typeof d.canPlayType)return b;var g=
d.canPlayType("audio/mpeg;").replace(/^no$/,""),f=b._navigator&&b._navigator.userAgent.match(/OPR\/([0-6].)/g),f=f&&33>parseInt(f[0].split("/")[1],10);b._codecs={mp3:!(f||!g&&!d.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!g,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!d.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),
aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(d.canPlayType("audio/x-m4b;")||d.canPlayType("audio/m4b;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,
""),webm:!!d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")};return b},_unlockAudio:function(){var b=this||c;if(!b._audioUnlocked&&b.ctx){b._audioUnlocked=!1;b.autoUnlock=!1;!b._mobileUnloaded&&44100!==b.ctx.sampleRate&&(b._mobileUnloaded=!0,b.unload());b._scratchBuffer=b.ctx.createBuffer(1,1,22050);var d=function(){for(;b._html5AudioPool.length<
b.html5PoolSize;)try{var c=new Audio;c._unlocked=!0;b._releaseHtml5Audio(c)}catch(e){b.noAudio=!0;break}for(c=0;c<b._howls.length;c++)if(!b._howls[c]._webAudio)for(var g=b._howls[c]._getSoundIds(),f=0;f<g.length;f++){var l=b._howls[c]._soundById(g[f]);l&&(l._node&&!l._node._unlocked)&&(l._node._unlocked=!0,l._node.load())}b._autoResume();var m=b.ctx.createBufferSource();m.buffer=b._scratchBuffer;m.connect(b.ctx.destination);"undefined"===typeof m.start?m.noteOn(0):m.start(0);"function"===typeof b.ctx.resume&&
b.ctx.resume();m.onended=function(){m.disconnect(0);b._audioUnlocked=!0;document.removeEventListener("touchstart",d,!0);document.removeEventListener("touchend",d,!0);document.removeEventListener("click",d,!0);for(var c=0;c<b._howls.length;c++)b._howls[c]._emit("unlock")}};document.addEventListener("touchstart",d,!0);document.addEventListener("touchend",d,!0);document.addEventListener("click",d,!0);return b}},_obtainHtml5Audio:function(){var b=this||c;if(b._html5AudioPool.length)return b._html5AudioPool.pop();
(b=(new Audio).play())&&("undefined"!==typeof Promise&&(b instanceof Promise||"function"===typeof b.then))&&b.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")});return new Audio},_releaseHtml5Audio:function(b){var d=this||c;b._unlocked&&d._html5AudioPool.push(b);return d},_autoSuspend:function(){var b=this;if(b.autoSuspend&&b.ctx&&"undefined"!==typeof b.ctx.suspend&&c.usingWebAudio){for(var d=0;d<b._howls.length;d++)if(b._howls[d]._webAudio)for(var e=
0;e<b._howls[d]._sounds.length;e++)if(!b._howls[d]._sounds[e]._paused)return b;b._suspendTimer&&clearTimeout(b._suspendTimer);b._suspendTimer=setTimeout(function(){if(b.autoSuspend){b._suspendTimer=null;b.state="suspending";var c=function(){b.state="suspended";b._resumeAfterSuspend&&(delete b._resumeAfterSuspend,b._autoResume())};b.ctx.suspend().then(c,c)}},3E4);return b}},_autoResume:function(){var b=this;if(b.ctx&&"undefined"!==typeof b.ctx.resume&&c.usingWebAudio)return"running"===b.state&&"interrupted"!==
b.ctx.state&&b._suspendTimer?(clearTimeout(b._suspendTimer),b._suspendTimer=null):"suspended"===b.state||"running"===b.state&&"interrupted"===b.ctx.state?(b.ctx.resume().then(function(){b.state="running";for(var c=0;c<b._howls.length;c++)b._howls[c]._emit("resume")}),b._suspendTimer&&(clearTimeout(b._suspendTimer),b._suspendTimer=null)):"suspending"===b.state&&(b._resumeAfterSuspend=!0),b}};var c=new b,e=function(c){!c.src||0===c.src.length?console.error("An array of source files must be passed with any new Howl."):
this.init(c)};e.prototype={init:function(b){var d=this;c.ctx||l();d._autoplay=b.autoplay||!1;d._format="string"!==typeof b.format?b.format:[b.format];d._html5=b.html5||!1;d._muted=b.mute||!1;d._loop=b.loop||!1;d._pool=b.pool||5;d._preload="boolean"===typeof b.preload||"metadata"===b.preload?b.preload:!0;d._rate=b.rate||1;d._sprite=b.sprite||{};d._src="string"!==typeof b.src?b.src:[b.src];d._volume=void 0!==b.volume?b.volume:1;d._xhr={method:b.xhr&&b.xhr.method?b.xhr.method:"GET",headers:b.xhr&&b.xhr.headers?
b.xhr.headers:null,withCredentials:b.xhr&&b.xhr.withCredentials?b.xhr.withCredentials:!1};d._duration=0;d._state="unloaded";d._sounds=[];d._endTimers={};d._queue=[];d._playLock=!1;d._onend=b.onend?[{fn:b.onend}]:[];d._onfade=b.onfade?[{fn:b.onfade}]:[];d._onload=b.onload?[{fn:b.onload}]:[];d._onloaderror=b.onloaderror?[{fn:b.onloaderror}]:[];d._onplayerror=b.onplayerror?[{fn:b.onplayerror}]:[];d._onpause=b.onpause?[{fn:b.onpause}]:[];d._onplay=b.onplay?[{fn:b.onplay}]:[];d._onstop=b.onstop?[{fn:b.onstop}]:
[];d._onmute=b.onmute?[{fn:b.onmute}]:[];d._onvolume=b.onvolume?[{fn:b.onvolume}]:[];d._onrate=b.onrate?[{fn:b.onrate}]:[];d._onseek=b.onseek?[{fn:b.onseek}]:[];d._onunlock=b.onunlock?[{fn:b.onunlock}]:[];d._onresume=[];d._webAudio=c.usingWebAudio&&!d._html5;"undefined"!==typeof c.ctx&&(c.ctx&&c.autoUnlock)&&c._unlockAudio();c._howls.push(d);d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}});d._preload&&"none"!==d._preload&&d.load();return d},load:function(){var b=null;if(c.noAudio)this._emit("loaderror",
null,"No audio support.");else{"string"===typeof this._src&&(this._src=[this._src]);for(var e=0;e<this._src.length;e++){var l,q;if(this._format&&this._format[e])l=this._format[e];else{q=this._src[e];if("string"!==typeof q){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(l=/^data:audio\/([^;,]+);/i.exec(q))||(l=/\.([^.]+)$/.exec(q.split("?",1)[0]));l&&(l=l[1].toLowerCase())}l||console.warn('No file extension was found. Consider using the "format" property or specify an extension.');
if(l&&c.codecs(l)){b=this._src[e];break}}if(b){this._src=b;this._state="loading";"https:"===window.location.protocol&&"http:"===b.slice(0,5)&&(this._html5=!0,this._webAudio=!1);new d(this);if(this._webAudio){var s=this,t=s._src;if(g[t])s._duration=g[t].duration,m(s);else if(/^data:[^;]+;base64,/.test(t)){b=atob(t.split(",")[1]);e=new Uint8Array(b.length);for(l=0;l<b.length;++l)e[l]=b.charCodeAt(l);f(e.buffer,s)}else{var u=new XMLHttpRequest;u.open(s._xhr.method,t,!0);u.withCredentials=s._xhr.withCredentials;
u.responseType="arraybuffer";s._xhr.headers&&Object.keys(s._xhr.headers).forEach(function(c){u.setRequestHeader(c,s._xhr.headers[c])});u.onload=function(){var c=(u.status+"")[0];"0"!==c&&"2"!==c&&"3"!==c?s._emit("loaderror",null,"Failed loading audio file with status: "+u.status+"."):f(u.response,s)};u.onerror=function(){s._webAudio&&(s._html5=!0,s._webAudio=!1,s._sounds=[],delete g[t],s.load())};try{u.send()}catch(v){u.onerror()}}}return this}this._emit("loaderror",null,"No codec support for selected audio sources.")}},
play:function(b,d){var e=this,g=null;if("number"===typeof b)g=b,b=null;else{if("string"===typeof b&&"loaded"===e._state&&!e._sprite[b])return null;if("undefined"===typeof b&&(b="__default",!e._playLock)){for(var f=0,l=0;l<e._sounds.length;l++)e._sounds[l]._paused&&!e._sounds[l]._ended&&(f++,g=e._sounds[l]._id);1===f?b=null:g=null}}var m=g?e._soundById(g):e._inactiveSound();if(!m)return null;g&&!b&&(b=m._sprite||"__default");if("loaded"!==e._state){m._sprite=b;m._ended=!1;var v=m._id;e._queue.push({event:"play",
action:function(){e.play(v)}});return v}if(g&&!m._paused)return d||e._loadQueue("play"),m._id;e._webAudio&&c._autoResume();var x=Math.max(0,0<m._seek?m._seek:e._sprite[b][0]/1E3),y=Math.max(0,(e._sprite[b][0]+e._sprite[b][1])/1E3-x),A=1E3*y/Math.abs(m._rate),B=e._sprite[b][0]/1E3,C=(e._sprite[b][0]+e._sprite[b][1])/1E3;m._sprite=b;m._ended=!1;var I=function(){m._paused=!1;m._seek=x;m._start=B;m._stop=C;m._loop=!(!m._loop&&!e._sprite[b][2])};if(x>=C)e._ended(m);else{var z=m._node;if(e._webAudio)g=
function(){e._playLock=!1;I();e._refreshBuffer(m);z.gain.setValueAtTime(m._muted||e._muted?0:m._volume,c.ctx.currentTime);m._playStart=c.ctx.currentTime;"undefined"===typeof z.bufferSource.start?m._loop?z.bufferSource.noteGrainOn(0,x,86400):z.bufferSource.noteGrainOn(0,x,y):m._loop?z.bufferSource.start(0,x,86400):z.bufferSource.start(0,x,y);Infinity!==A&&(e._endTimers[m._id]=setTimeout(e._ended.bind(e,m),A));d||setTimeout(function(){e._emit("play",m._id);e._loadQueue()},0)},"running"===c.state&&"interrupted"!==
c.ctx.state?g():(e._playLock=!0,e.once("resume",g),e._clearTimer(m._id));else{var D=function(){z.currentTime=x;z.muted=m._muted||e._muted||c._muted||z.muted;z.volume=m._volume*c.volume();z.playbackRate=m._rate;try{var g=z.play();g&&"undefined"!==typeof Promise&&(g instanceof Promise||"function"===typeof g.then)?(e._playLock=!0,I(),g.then(function(){e._playLock=!1;z._unlocked=!0;d||(e._emit("play",m._id),e._loadQueue())}).catch(function(){e._playLock=!1;e._emit("playerror",m._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");
m._ended=!0;m._paused=!0})):d||(e._playLock=!1,I(),e._emit("play",m._id),e._loadQueue());z.playbackRate=m._rate;z.paused?e._emit("playerror",m._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."):"__default"!==b||m._loop?e._endTimers[m._id]=setTimeout(e._ended.bind(e,m),A):(e._endTimers[m._id]=function(){e._ended(m);z.removeEventListener("ended",e._endTimers[m._id],!1)},z.addEventListener("ended",e._endTimers[m._id],
!1))}catch(f){e._emit("playerror",m._id,f)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===z.src&&(z.src=e._src,z.load());g=window&&window.ejecta||!z.readyState&&c._navigator.isCocoonJS;if(3<=z.readyState||g)D();else{e._playLock=!0;var F=function(){D();z.removeEventListener(c._canPlayEvent,F,!1)};z.addEventListener(c._canPlayEvent,F,!1);e._clearTimer(m._id)}}return m._id}},pause:function(c,b){var d=this;if("loaded"!==d._state||d._playLock)return d._queue.push({event:"pause",
action:function(){d.pause(c)}}),d;for(var e=d._getSoundIds(c),g=0;g<e.length;g++){d._clearTimer(e[g]);var f=d._soundById(e[g]);if(f&&!f._paused&&(f._seek=d.seek(e[g]),f._rateSeek=0,f._paused=!0,d._stopFade(e[g]),f._node))if(d._webAudio){if(!f._node.bufferSource)continue;"undefined"===typeof f._node.bufferSource.stop?f._node.bufferSource.noteOff(0):f._node.bufferSource.stop(0);d._cleanBuffer(f._node)}else(!isNaN(f._node.duration)||Infinity===f._node.duration)&&f._node.pause();b||d._emit("pause",f?
f._id:null)}return d},stop:function(c,b){var d=this;if("loaded"!==d._state||d._playLock)return d._queue.push({event:"stop",action:function(){d.stop(c)}}),d;for(var e=d._getSoundIds(c),g=0;g<e.length;g++){d._clearTimer(e[g]);var f=d._soundById(e[g]);if(f){f._seek=f._start||0;f._rateSeek=0;f._paused=!0;f._ended=!0;d._stopFade(e[g]);if(f._node)if(d._webAudio)f._node.bufferSource&&("undefined"===typeof f._node.bufferSource.stop?f._node.bufferSource.noteOff(0):f._node.bufferSource.stop(0),d._cleanBuffer(f._node));
else if(!isNaN(f._node.duration)||Infinity===f._node.duration)f._node.currentTime=f._start||0,f._node.pause(),Infinity===f._node.duration&&d._clearSound(f._node);b||d._emit("stop",f._id)}}return d},mute:function(b,d){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"mute",action:function(){e.mute(b,d)}}),e;if("undefined"===typeof d)if("boolean"===typeof b)e._muted=b;else return e._muted;for(var g=e._getSoundIds(d),f=0;f<g.length;f++){var l=e._soundById(g[f]);l&&(l._muted=
b,l._interval&&e._stopFade(l._id),e._webAudio&&l._node?l._node.gain.setValueAtTime(b?0:l._volume,c.ctx.currentTime):l._node&&(l._node.muted=c._muted?!0:b),e._emit("mute",l._id))}return e},volume:function(){var b=this,d=arguments,e,g;if(0===d.length)return b._volume;1===d.length||2===d.length&&"undefined"===typeof d[1]?0<=b._getSoundIds().indexOf(d[0])?g=parseInt(d[0],10):e=parseFloat(d[0]):2<=d.length&&(e=parseFloat(d[0]),g=parseInt(d[1],10));var f;if("undefined"!==typeof e&&0<=e&&1>=e){if("loaded"!==
b._state||b._playLock)return b._queue.push({event:"volume",action:function(){b.volume.apply(b,d)}}),b;"undefined"===typeof g&&(b._volume=e);g=b._getSoundIds(g);for(var l=0;l<g.length;l++)if(f=b._soundById(g[l]))f._volume=e,d[2]||b._stopFade(g[l]),b._webAudio&&f._node&&!f._muted?f._node.gain.setValueAtTime(e,c.ctx.currentTime):f._node&&!f._muted&&(f._node.volume=e*c.volume()),b._emit("volume",f._id)}else return(f=g?b._soundById(g):b._sounds[0])?f._volume:0;return b},fade:function(b,d,e,g){var f=this;
if("loaded"!==f._state||f._playLock)return f._queue.push({event:"fade",action:function(){f.fade(b,d,e,g)}}),f;b=Math.min(Math.max(0,parseFloat(b)),1);d=Math.min(Math.max(0,parseFloat(d)),1);e=parseFloat(e);f.volume(b,g);for(var l=f._getSoundIds(g),m=0;m<l.length;m++){var v=f._soundById(l[m]);if(v){g||f._stopFade(l[m]);if(f._webAudio&&!v._muted){var x=c.ctx.currentTime,y=x+e/1E3;v._volume=b;v._node.gain.setValueAtTime(b,x);v._node.gain.linearRampToValueAtTime(d,y)}f._startFadeInterval(v,b,d,e,l[m],
"undefined"===typeof g)}}return f},_startFadeInterval:function(c,b,d,e,f,g){var l=this,m=b,x=d-b;f=Math.abs(x/0.01);f=Math.max(4,0<f?e/f:e);var y=Date.now();c._fadeTo=d;c._interval=setInterval(function(){var f=(Date.now()-y)/e;y=Date.now();m+=x*f;m=0>x?Math.max(d,m):Math.min(d,m);m=Math.round(100*m)/100;l._webAudio?c._volume=m:l.volume(m,c._id,!0);g&&(l._volume=m);if(d<b&&m<=d||d>b&&m>=d)clearInterval(c._interval),c._interval=null,c._fadeTo=null,l.volume(d,c._id),l._emit("fade",c._id)},f)},_stopFade:function(b){var d=
this._soundById(b);d&&d._interval&&(this._webAudio&&d._node.gain.cancelScheduledValues(c.ctx.currentTime),clearInterval(d._interval),d._interval=null,this.volume(d._fadeTo,b),d._fadeTo=null,this._emit("fade",b));return this},loop:function(){var c=arguments,b,d;if(0===c.length)return this._loop;if(1===c.length)if("boolean"===typeof c[0])this._loop=b=c[0];else return(c=this._soundById(parseInt(c[0],10)))?c._loop:!1;else 2===c.length&&(b=c[0],d=parseInt(c[1],10));d=this._getSoundIds(d);for(var e=0;e<
d.length;e++)if(c=this._soundById(d[e]))if(c._loop=b,this._webAudio&&(c._node&&c._node.bufferSource)&&(c._node.bufferSource.loop=b))c._node.bufferSource.loopStart=c._start||0,c._node.bufferSource.loopEnd=c._stop;return this},rate:function(){var b=this,d=arguments,e,f;0===d.length?f=b._sounds[0]._id:1===d.length?0<=b._getSoundIds().indexOf(d[0])?f=parseInt(d[0],10):e=parseFloat(d[0]):2===d.length&&(e=parseFloat(d[0]),f=parseInt(d[1],10));var g;if("number"===typeof e){if("loaded"!==b._state||b._playLock)return b._queue.push({event:"rate",
action:function(){b.rate.apply(b,d)}}),b;"undefined"===typeof f&&(b._rate=e);f=b._getSoundIds(f);for(var l=0;l<f.length;l++)if(g=b._soundById(f[l])){b.playing(f[l])&&(g._rateSeek=b.seek(f[l]),g._playStart=b._webAudio?c.ctx.currentTime:g._playStart);g._rate=e;b._webAudio&&g._node&&g._node.bufferSource?g._node.bufferSource.playbackRate.setValueAtTime(e,c.ctx.currentTime):g._node&&(g._node.playbackRate=e);var m=b.seek(f[l]),m=1E3*((b._sprite[g._sprite][0]+b._sprite[g._sprite][1])/1E3-m)/Math.abs(g._rate);
if(b._endTimers[f[l]]||!g._paused)b._clearTimer(f[l]),b._endTimers[f[l]]=setTimeout(b._ended.bind(b,g),m);b._emit("rate",g._id)}}else return(g=b._soundById(f))?g._rate:b._rate;return b},seek:function(){var b=this,d=arguments,e,f;0===d.length?f=b._sounds[0]._id:1===d.length?0<=b._getSoundIds().indexOf(d[0])?f=parseInt(d[0],10):b._sounds.length&&(f=b._sounds[0]._id,e=parseFloat(d[0])):2===d.length&&(e=parseFloat(d[0]),f=parseInt(d[1],10));if("undefined"===typeof f)return b;if("loaded"!==b._state||b._playLock)return b._queue.push({event:"seek",
action:function(){b.seek.apply(b,d)}}),b;var g=b._soundById(f);if(g)if("number"===typeof e&&0<=e){var l=b.playing(f);l&&b.pause(f,!0);g._seek=e;g._ended=!1;b._clearTimer(f);!b._webAudio&&(g._node&&!isNaN(g._node.duration))&&(g._node.currentTime=e);var m=function(){b._emit("seek",f);l&&b.play(f,!0)};if(l&&!b._webAudio){var v=function(){b._playLock?setTimeout(v,0):m()};setTimeout(v,0)}else m()}else return b._webAudio?(e=b.playing(f)?c.ctx.currentTime-g._playStart:0,g._seek+((g._rateSeek?g._rateSeek-
g._seek:0)+e*Math.abs(g._rate))):g._node.currentTime;return b},playing:function(c){if("number"===typeof c)return(c=this._soundById(c))?!c._paused:!1;for(c=0;c<this._sounds.length;c++)if(!this._sounds[c]._paused)return!0;return!1},duration:function(c){var b=this._duration;(c=this._soundById(c))&&(b=this._sprite[c._sprite][1]/1E3);return b},state:function(){return this._state},unload:function(){for(var b=this._sounds,d=0;d<b.length;d++)b[d]._paused||this.stop(b[d]._id),this._webAudio||(this._clearSound(b[d]._node),
b[d]._node.removeEventListener("error",b[d]._errorFn,!1),b[d]._node.removeEventListener(c._canPlayEvent,b[d]._loadFn,!1),c._releaseHtml5Audio(b[d]._node)),delete b[d]._node,this._clearTimer(b[d]._id);d=c._howls.indexOf(this);0<=d&&c._howls.splice(d,1);b=!0;for(d=0;d<c._howls.length;d++)if(c._howls[d]._src===this._src||0<=this._src.indexOf(c._howls[d]._src)){b=!1;break}g&&b&&delete g[this._src];c.noAudio=!1;this._state="unloaded";this._sounds=[];return null},on:function(c,b,d,e){c=this["_on"+c];"function"===
typeof b&&c.push(e?{id:d,fn:b,once:e}:{id:d,fn:b});return this},off:function(c,b,d){var e=this["_on"+c],f=0;"number"===typeof b&&(d=b,b=null);if(b||d)for(f=0;f<e.length;f++){if(c=d===e[f].id,b===e[f].fn&&c||!b&&c){e.splice(f,1);break}}else if(c)this["_on"+c]=[];else{b=Object.keys(this);for(f=0;f<b.length;f++)0===b[f].indexOf("_on")&&Array.isArray(this[b[f]])&&(this[b[f]]=[])}return this},once:function(c,b,d){this.on(c,b,d,1);return this},_emit:function(c,b,d){for(var e=this["_on"+c],f=e.length-1;0<=
f;f--)if(!e[f].id||e[f].id===b||"load"===c)setTimeout(function(c){c.call(this,b,d)}.bind(this,e[f].fn),0),e[f].once&&this.off(c,e[f].fn,e[f].id);this._loadQueue(c);return this},_loadQueue:function(c){if(0<this._queue.length){var b=this._queue[0];b.event===c&&(this._queue.shift(),this._loadQueue());c||b.action()}return this},_ended:function(b){var d=b._sprite;if(!this._webAudio&&b._node&&!b._node.paused&&!b._node.ended&&b._node.currentTime<b._stop)return setTimeout(this._ended.bind(this,b),100),this;
d=!(!b._loop&&!this._sprite[d][2]);this._emit("end",b._id);!this._webAudio&&d&&this.stop(b._id,!0).play(b._id);if(this._webAudio&&d){this._emit("play",b._id);b._seek=b._start||0;b._rateSeek=0;b._playStart=c.ctx.currentTime;var e=1E3*(b._stop-b._start)/Math.abs(b._rate);this._endTimers[b._id]=setTimeout(this._ended.bind(this,b),e)}this._webAudio&&!d&&(b._paused=!0,b._ended=!0,b._seek=b._start||0,b._rateSeek=0,this._clearTimer(b._id),this._cleanBuffer(b._node),c._autoSuspend());!this._webAudio&&!d&&
this.stop(b._id,!0);return this},_clearTimer:function(c){if(this._endTimers[c]){if("function"!==typeof this._endTimers[c])clearTimeout(this._endTimers[c]);else{var b=this._soundById(c);b&&b._node&&b._node.removeEventListener("ended",this._endTimers[c],!1)}delete this._endTimers[c]}return this},_soundById:function(c){for(var b=0;b<this._sounds.length;b++)if(c===this._sounds[b]._id)return this._sounds[b];return null},_inactiveSound:function(){this._drain();for(var c=0;c<this._sounds.length;c++)if(this._sounds[c]._ended)return this._sounds[c].reset();
return new d(this)},_drain:function(){var c=this._pool,b=0,d=0;if(!(this._sounds.length<c)){for(d=0;d<this._sounds.length;d++)this._sounds[d]._ended&&b++;for(d=this._sounds.length-1;0<=d&&!(b<=c);d--)this._sounds[d]._ended&&(this._webAudio&&this._sounds[d]._node&&this._sounds[d]._node.disconnect(0),this._sounds.splice(d,1),b--)}},_getSoundIds:function(c){if("undefined"===typeof c){c=[];for(var b=0;b<this._sounds.length;b++)c.push(this._sounds[b]._id);return c}return[c]},_refreshBuffer:function(b){b._node.bufferSource=
c.ctx.createBufferSource();b._node.bufferSource.buffer=g[this._src];b._panner?b._node.bufferSource.connect(b._panner):b._node.bufferSource.connect(b._node);if(b._node.bufferSource.loop=b._loop)b._node.bufferSource.loopStart=b._start||0,b._node.bufferSource.loopEnd=b._stop||0;b._node.bufferSource.playbackRate.setValueAtTime(b._rate,c.ctx.currentTime);return this},_cleanBuffer:function(b){var d=c._navigator&&0<=c._navigator.vendor.indexOf("Apple");if(c._scratchBuffer&&b.bufferSource&&(b.bufferSource.onended=
null,b.bufferSource.disconnect(0),d))try{b.bufferSource.buffer=c._scratchBuffer}catch(e){}b.bufferSource=null;return this},_clearSound:function(b){/MSIE |Trident\//.test(c._navigator&&c._navigator.userAgent)||(b.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var d=function(b){this._parent=b;this.init()};d.prototype={init:function(){var b=this._parent;this._muted=b._muted;this._loop=b._loop;this._volume=b._volume;this._rate=b._rate;this._seek=0;this._ended=
this._paused=!0;this._sprite="__default";this._id=++c._counter;b._sounds.push(this);this.create();return this},create:function(){var b=this._parent,d=c._muted||this._muted||this._parent._muted?0:this._volume;b._webAudio?(this._node="undefined"===typeof c.ctx.createGain?c.ctx.createGainNode():c.ctx.createGain(),this._node.gain.setValueAtTime(d,c.ctx.currentTime),this._node.paused=!0,this._node.connect(c.masterGain)):c.noAudio||(this._node=c._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),
this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(c._canPlayEvent,this._loadFn,!1),this._node.src=b._src,this._node.preload=!0===b._preload?"auto":b._preload,this._node.volume=d*c.volume(),this._node.load());return this},reset:function(){var b=this._parent;this._muted=b._muted;this._loop=b._loop;this._volume=b._volume;this._rate=b._rate;this._rateSeek=this._seek=0;this._ended=this._paused=!0;this._sprite="__default";this._id=
++c._counter;return this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0);this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var b=this._parent;b._duration=Math.ceil(10*this._node.duration)/10;0===Object.keys(b._sprite).length&&(b._sprite={__default:[0,1E3*b._duration]});"loaded"!==b._state&&(b._state="loaded",b._emit("load"),b._loadQueue());this._node.removeEventListener(c._canPlayEvent,this._loadFn,!1)}};
var g={},f=function(b,d){var e=function(){d._emit("loaderror",null,"Decoding audio data failed.")},f=function(b){b&&0<d._sounds.length?(g[d._src]=b,m(d,b)):e()};"undefined"!==typeof Promise&&1===c.ctx.decodeAudioData.length?c.ctx.decodeAudioData(b).then(f).catch(e):c.ctx.decodeAudioData(b,f,e)},m=function(b,c){c&&!b._duration&&(b._duration=c.duration);0===Object.keys(b._sprite).length&&(b._sprite={__default:[0,1E3*b._duration]});"loaded"!==b._state&&(b._state="loaded",b._emit("load"),b._loadQueue())},
l=function(){if(c.usingWebAudio){try{"undefined"!==typeof AudioContext?c.ctx=new AudioContext:"undefined"!==typeof webkitAudioContext?c.ctx=new webkitAudioContext:c.usingWebAudio=!1}catch(b){c.usingWebAudio=!1}c.ctx||(c.usingWebAudio=!1);var d=/iP(hone|od|ad)/.test(c._navigator&&c._navigator.platform),e=c._navigator&&c._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),e=e?parseInt(e[1],10):null;d&&(e&&9>e)&&(d=/safari/.test(c._navigator&&c._navigator.userAgent.toLowerCase()),c._navigator&&!d&&
(c.usingWebAudio=!1));c.usingWebAudio&&(c.masterGain="undefined"===typeof c.ctx.createGain?c.ctx.createGainNode():c.ctx.createGain(),c.masterGain.gain.setValueAtTime(c._muted?0:c._volume,c.ctx.currentTime),c.masterGain.connect(c.ctx.destination));c._setup()}};"function"===typeof define&&define.amd&&define([],function(){return{Howler:c,Howl:e}});"undefined"!==typeof exports&&(exports.Howler=c,exports.Howl=e);"undefined"!==typeof global?(global.HowlerGlobal=b,global.Howler=c,global.Howl=e,global.Sound=
d):"undefined"!==typeof window&&(window.HowlerGlobal=b,window.Howler=c,window.Howl=e,window.Sound=d)})();
(function(){HowlerGlobal.prototype._pos=[0,0,0];HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0];HowlerGlobal.prototype.stereo=function(b){if(!this.ctx||!this.ctx.listener)return this;for(var c=this._howls.length-1;0<=c;c--)this._howls[c].stereo(b);return this};HowlerGlobal.prototype.pos=function(b,c,d){if(!this.ctx||!this.ctx.listener)return this;c="number"!==typeof c?this._pos[1]:c;d="number"!==typeof d?this._pos[2]:d;if("number"===typeof b)this._pos=[b,c,d],"undefined"!==typeof this.ctx.listener.positionX?
(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,0.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,0.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,0.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]);else return this._pos;return this};HowlerGlobal.prototype.orientation=function(b,c,d,e,j,n){if(!this.ctx||!this.ctx.listener)return this;var r=this._orientation;c="number"!==
typeof c?r[1]:c;d="number"!==typeof d?r[2]:d;e="number"!==typeof e?r[3]:e;j="number"!==typeof j?r[4]:j;n="number"!==typeof n?r[5]:n;if("number"===typeof b)this._orientation=[b,c,d,e,j,n],"undefined"!==typeof this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(b,Howler.ctx.currentTime,0.1),this.ctx.listener.forwardY.setTargetAtTime(c,Howler.ctx.currentTime,0.1),this.ctx.listener.forwardZ.setTargetAtTime(d,Howler.ctx.currentTime,0.1),this.ctx.listener.upX.setTargetAtTime(e,Howler.ctx.currentTime,
0.1),this.ctx.listener.upY.setTargetAtTime(j,Howler.ctx.currentTime,0.1),this.ctx.listener.upZ.setTargetAtTime(n,Howler.ctx.currentTime,0.1)):this.ctx.listener.setOrientation(b,c,d,e,j,n);else return r;return this};var b=Howl.prototype.init;Howl.prototype.init=function(c){this._orientation=c.orientation||[1,0,0];this._stereo=c.stereo||null;this._pos=c.pos||null;this._pannerAttr={coneInnerAngle:"undefined"!==typeof c.coneInnerAngle?c.coneInnerAngle:360,coneOuterAngle:"undefined"!==typeof c.coneOuterAngle?
c.coneOuterAngle:360,coneOuterGain:"undefined"!==typeof c.coneOuterGain?c.coneOuterGain:0,distanceModel:"undefined"!==typeof c.distanceModel?c.distanceModel:"inverse",maxDistance:"undefined"!==typeof c.maxDistance?c.maxDistance:1E4,panningModel:"undefined"!==typeof c.panningModel?c.panningModel:"HRTF",refDistance:"undefined"!==typeof c.refDistance?c.refDistance:1,rolloffFactor:"undefined"!==typeof c.rolloffFactor?c.rolloffFactor:1};this._onstereo=c.onstereo?[{fn:c.onstereo}]:[];this._onpos=c.onpos?
[{fn:c.onpos}]:[];this._onorientation=c.onorientation?[{fn:c.onorientation}]:[];return b.call(this,c)};Howl.prototype.stereo=function(b,c){var e=this;if(!e._webAudio)return e;if("loaded"!==e._state)return e._queue.push({event:"stereo",action:function(){e.stereo(b,c)}}),e;var l="undefined"===typeof Howler.ctx.createStereoPanner?"spatial":"stereo";if("undefined"===typeof c)if("number"===typeof b)e._stereo=b,e._pos=[b,0,0];else return e._stereo;for(var j=e._getSoundIds(c),n=0;n<j.length;n++){var r=e._soundById(j[n]);
if(r)if("number"===typeof b)r._stereo=b,r._pos=[b,0,0],r._node&&(r._pannerAttr.panningModel="equalpower",(!r._panner||!r._panner.pan)&&d(r,l),"spatial"===l?"undefined"!==typeof r._panner.positionX?(r._panner.positionX.setValueAtTime(b,Howler.ctx.currentTime),r._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),r._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):r._panner.setPosition(b,0,0):r._panner.pan.setValueAtTime(b,Howler.ctx.currentTime)),e._emit("stereo",r._id);else return r._stereo}return e};
Howl.prototype.pos=function(b,c,e,l){var j=this;if(!j._webAudio)return j;if("loaded"!==j._state)return j._queue.push({event:"pos",action:function(){j.pos(b,c,e,l)}}),j;c="number"!==typeof c?0:c;e="number"!==typeof e?-0.5:e;if("undefined"===typeof l)if("number"===typeof b)j._pos=[b,c,e];else return j._pos;for(var n=j._getSoundIds(l),r=0;r<n.length;r++){var q=j._soundById(n[r]);if(q)if("number"===typeof b)q._pos=[b,c,e],q._node&&((!q._panner||q._panner.pan)&&d(q,"spatial"),"undefined"!==typeof q._panner.positionX?
(q._panner.positionX.setValueAtTime(b,Howler.ctx.currentTime),q._panner.positionY.setValueAtTime(c,Howler.ctx.currentTime),q._panner.positionZ.setValueAtTime(e,Howler.ctx.currentTime)):q._panner.setPosition(b,c,e)),j._emit("pos",q._id);else return q._pos}return j};Howl.prototype.orientation=function(b,c,e,l){var j=this;if(!j._webAudio)return j;if("loaded"!==j._state)return j._queue.push({event:"orientation",action:function(){j.orientation(b,c,e,l)}}),j;c="number"!==typeof c?j._orientation[1]:c;e=
"number"!==typeof e?j._orientation[2]:e;if("undefined"===typeof l)if("number"===typeof b)j._orientation=[b,c,e];else return j._orientation;for(var n=j._getSoundIds(l),r=0;r<n.length;r++){var q=j._soundById(n[r]);if(q)if("number"===typeof b)q._orientation=[b,c,e],q._node&&(q._panner||(q._pos||(q._pos=j._pos||[0,0,-0.5]),d(q,"spatial")),"undefined"!==typeof q._panner.orientationX?(q._panner.orientationX.setValueAtTime(b,Howler.ctx.currentTime),q._panner.orientationY.setValueAtTime(c,Howler.ctx.currentTime),
q._panner.orientationZ.setValueAtTime(e,Howler.ctx.currentTime)):q._panner.setOrientation(b,c,e)),j._emit("orientation",q._id);else return q._orientation}return j};Howl.prototype.pannerAttr=function(){var b=arguments,c,e;if(!this._webAudio)return this;if(0===b.length)return this._pannerAttr;if(1===b.length)if("object"===typeof b[0])c=b[0],"undefined"===typeof e&&(c.pannerAttr||(c.pannerAttr={coneInnerAngle:c.coneInnerAngle,coneOuterAngle:c.coneOuterAngle,coneOuterGain:c.coneOuterGain,distanceModel:c.distanceModel,
maxDistance:c.maxDistance,refDistance:c.refDistance,rolloffFactor:c.rolloffFactor,panningModel:c.panningModel}),this._pannerAttr={coneInnerAngle:"undefined"!==typeof c.pannerAttr.coneInnerAngle?c.pannerAttr.coneInnerAngle:this._coneInnerAngle,coneOuterAngle:"undefined"!==typeof c.pannerAttr.coneOuterAngle?c.pannerAttr.coneOuterAngle:this._coneOuterAngle,coneOuterGain:"undefined"!==typeof c.pannerAttr.coneOuterGain?c.pannerAttr.coneOuterGain:this._coneOuterGain,distanceModel:"undefined"!==typeof c.pannerAttr.distanceModel?
c.pannerAttr.distanceModel:this._distanceModel,maxDistance:"undefined"!==typeof c.pannerAttr.maxDistance?c.pannerAttr.maxDistance:this._maxDistance,refDistance:"undefined"!==typeof c.pannerAttr.refDistance?c.pannerAttr.refDistance:this._refDistance,rolloffFactor:"undefined"!==typeof c.pannerAttr.rolloffFactor?c.pannerAttr.rolloffFactor:this._rolloffFactor,panningModel:"undefined"!==typeof c.pannerAttr.panningModel?c.pannerAttr.panningModel:this._panningModel});else return(b=this._soundById(parseInt(b[0],
10)))?b._pannerAttr:this._pannerAttr;else 2===b.length&&(c=b[0],e=parseInt(b[1],10));e=this._getSoundIds(e);for(var l=0;l<e.length;l++)if(b=this._soundById(e[l])){var j=b._pannerAttr,j={coneInnerAngle:"undefined"!==typeof c.coneInnerAngle?c.coneInnerAngle:j.coneInnerAngle,coneOuterAngle:"undefined"!==typeof c.coneOuterAngle?c.coneOuterAngle:j.coneOuterAngle,coneOuterGain:"undefined"!==typeof c.coneOuterGain?c.coneOuterGain:j.coneOuterGain,distanceModel:"undefined"!==typeof c.distanceModel?c.distanceModel:
j.distanceModel,maxDistance:"undefined"!==typeof c.maxDistance?c.maxDistance:j.maxDistance,refDistance:"undefined"!==typeof c.refDistance?c.refDistance:j.refDistance,rolloffFactor:"undefined"!==typeof c.rolloffFactor?c.rolloffFactor:j.rolloffFactor,panningModel:"undefined"!==typeof c.panningModel?c.panningModel:j.panningModel},n=b._panner;n?(n.coneInnerAngle=j.coneInnerAngle,n.coneOuterAngle=j.coneOuterAngle,n.coneOuterGain=j.coneOuterGain,n.distanceModel=j.distanceModel,n.maxDistance=j.maxDistance,
n.refDistance=j.refDistance,n.rolloffFactor=j.rolloffFactor,n.panningModel=j.panningModel):(b._pos||(b._pos=this._pos||[0,0,-0.5]),d(b,"spatial"))}return this};var c=Sound.prototype.init;Sound.prototype.init=function(){var b=this._parent;this._orientation=b._orientation;this._stereo=b._stereo;this._pos=b._pos;this._pannerAttr=b._pannerAttr;c.call(this);this._stereo?b.stereo(this._stereo):this._pos&&b.pos(this._pos[0],this._pos[1],this._pos[2],this._id)};var e=Sound.prototype.reset;Sound.prototype.reset=
function(){var b=this._parent;this._orientation=b._orientation;this._stereo=b._stereo;this._pos=b._pos;this._pannerAttr=b._pannerAttr;this._stereo?b.stereo(this._stereo):this._pos?b.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,b._refreshBuffer(this));return e.call(this)};var d=function(b,c){"spatial"===(c||"spatial")?(b._panner=Howler.ctx.createPanner(),b._panner.coneInnerAngle=b._pannerAttr.coneInnerAngle,b._panner.coneOuterAngle=
b._pannerAttr.coneOuterAngle,b._panner.coneOuterGain=b._pannerAttr.coneOuterGain,b._panner.distanceModel=b._pannerAttr.distanceModel,b._panner.maxDistance=b._pannerAttr.maxDistance,b._panner.refDistance=b._pannerAttr.refDistance,b._panner.rolloffFactor=b._pannerAttr.rolloffFactor,b._panner.panningModel=b._pannerAttr.panningModel,"undefined"!==typeof b._panner.positionX?(b._panner.positionX.setValueAtTime(b._pos[0],Howler.ctx.currentTime),b._panner.positionY.setValueAtTime(b._pos[1],Howler.ctx.currentTime),
b._panner.positionZ.setValueAtTime(b._pos[2],Howler.ctx.currentTime)):b._panner.setPosition(b._pos[0],b._pos[1],b._pos[2]),"undefined"!==typeof b._panner.orientationX?(b._panner.orientationX.setValueAtTime(b._orientation[0],Howler.ctx.currentTime),b._panner.orientationY.setValueAtTime(b._orientation[1],Howler.ctx.currentTime),b._panner.orientationZ.setValueAtTime(b._orientation[2],Howler.ctx.currentTime)):b._panner.setOrientation(b._orientation[0],b._orientation[1],b._orientation[2])):(b._panner=
Howler.ctx.createStereoPanner(),b._panner.pan.setValueAtTime(b._stereo,Howler.ctx.currentTime));b._panner.connect(b._node);b._paused||b._parent.pause(b._id,!0).play(b._id,!0)}})();!function(b,c){"object"==typeof exports&&"undefined"!=typeof module?c():"function"==typeof define&&define.amd?define(c):c()}(0,function(){function b(b){var c=this.constructor;return this.then(function(d){return c.resolve(b()).then(function(){return d})},function(d){return c.resolve(b()).then(function(){return c.reject(d)})})}function c(){}function e(b){if(!(this instanceof e))throw new TypeError("Promises must be constructed via new");if("function"!=typeof b)throw new TypeError("not a function");
this._state=0;this._handled=!1;this._value=void 0;this._deferreds=[];l(b,this)}function d(b,c){for(;3===b._state;)b=b._value;0!==b._state?(b._handled=!0,e._immediateFn(function(){var d=1===b._state?c.onFulfilled:c.onRejected;if(null!==d){var e;try{e=d(b._value)}catch(j){return void f(c.promise,j)}g(c.promise,e)}else(1===b._state?g:f)(c.promise,b._value)})):b._deferreds.push(c)}function g(b,c){try{if(c===b)throw new TypeError("A promise cannot be resolved with itself.");if(c&&("object"==typeof c||
"function"==typeof c)){var d=c.then;if(c instanceof e)return b._state=3,b._value=c,void m(b);if("function"==typeof d)return void l(function(){d.apply(c,arguments)},b)}b._state=1;b._value=c;m(b)}catch(g){f(b,g)}}function f(b,c){b._state=2;b._value=c;m(b)}function m(b){2===b._state&&0===b._deferreds.length&&e._immediateFn(function(){b._handled||e._unhandledRejectionFn(b._value)});for(var c=0,f=b._deferreds.length;f>c;c++)d(b,b._deferreds[c]);b._deferreds=null}function l(b,c){var d=!1;try{b(function(b){d||
(d=!0,g(c,b))},function(b){d||(d=!0,f(c,b))})}catch(e){d||(d=!0,f(c,e))}}var j=setTimeout;e.prototype["catch"]=function(b){return this.then(null,b)};e.prototype.then=function(b,e){var f=new this.constructor(c);return d(this,new function(b,c,d){this.onFulfilled="function"==typeof b?b:null;this.onRejected="function"==typeof c?c:null;this.promise=d}(b,e,f)),f};e.prototype["finally"]=b;e.all=function(b){return new e(function(c,d){function e(b,j){try{if(j&&("object"==typeof j||"function"==typeof j)){var l=
j.then;if("function"==typeof l)return void l.call(j,function(c){e(b,c)},d)}f[b]=j;0==--g&&c(f)}catch(n){d(n)}}if(!b||"undefined"==typeof b.length)throw new TypeError("Promise.all accepts an array");var f=Array.prototype.slice.call(b);if(0===f.length)return c([]);for(var g=f.length,j=0;f.length>j;j++)e(j,f[j])})};e.resolve=function(b){return b&&"object"==typeof b&&b.constructor===e?b:new e(function(c){c(b)})};e.reject=function(b){return new e(function(c,d){d(b)})};e.race=function(b){return new e(function(c,
d){for(var e=0,f=b.length;f>e;e++)b[e].then(c,d)})};e._immediateFn="function"==typeof setImmediate&&function(b){setImmediate(b)}||function(b){j(b,0)};e._unhandledRejectionFn=function(b){void 0!==console&&console&&console.warn("Possible Unhandled Promise Rejection:",b)};var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("unable to locate global object");}();"Promise"in n?n.Promise.prototype["finally"]||
(n.Promise.prototype["finally"]=b):n.Promise=e});(function(){function b(b,c){document.addEventListener?b.addEventListener("scroll",c,!1):b.attachEvent("scroll",c)}function c(b){this.a=document.createElement("div");this.a.setAttribute("aria-hidden","true");this.a.appendChild(document.createTextNode(b));this.b=document.createElement("span");this.c=document.createElement("span");this.h=document.createElement("span");this.f=document.createElement("span");this.g=-1;this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";
this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;";this.b.appendChild(this.h);this.c.appendChild(this.f);this.a.appendChild(this.b);this.a.appendChild(this.c)}function e(b,c){b.a.style.cssText=
"max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+c+";"}function d(b){var c=b.a.offsetWidth,d=c+100;b.f.style.width=d+"px";b.c.scrollLeft=d;b.b.scrollLeft=b.b.scrollWidth+100;return b.g!==c?(b.g=c,!0):!1}function g(c,e){function f(){var b=g;d(b)&&b.a.parentNode&&e(b.g)}var g=c;b(c.b,f);b(c.c,f);d(c)}function f(b,c){var d=c||{};this.family=b;this.style=d.style||
"normal";this.weight=d.weight||"normal";this.stretch=d.stretch||"normal"}function m(){null===s&&(s=!!document.fonts);return s}function l(){if(null===q){var b=document.createElement("div");try{b.style.font="condensed 100px sans-serif"}catch(c){}q=""!==b.style.font}return q}function j(b,c){return[b.style,b.weight,l()?b.stretch:"","100px",c].join(" ")}var n=null,r=null,q=null,s=null;f.prototype.load=function(b,d){var f=this,l=b||"BESbswy",q=0,s=d||3E3,B=(new Date).getTime();return new Promise(function(b,
d){var t;if(t=m())null===r&&(m()&&/Apple/.test(window.navigator.vendor)?(t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),r=!!t&&603>parseInt(t[1],10)):r=!1),t=!r;if(t){t=new Promise(function(b,c){function d(){(new Date).getTime()-B>=s?c(Error(""+s+"ms timeout exceeded")):document.fonts.load(j(f,'"'+f.family+'"'),l).then(function(c){1<=c.length?b():setTimeout(d,25)},c)}d()});var u=new Promise(function(b,c){q=setTimeout(function(){c(Error(""+s+"ms timeout exceeded"))},
s)});Promise.race([u,t]).then(function(){clearTimeout(q);b(f)},d)}else{var F=function(){function m(){var c;if(c=-1!=D&&-1!=G||-1!=D&&-1!=E||-1!=G&&-1!=E)(c=D!=G&&D!=E&&G!=E)||(null===n&&(c=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),n=!!c&&(536>parseInt(c[1],10)||536===parseInt(c[1],10)&&11>=parseInt(c[2],10))),c=n&&(D==F&&G==F&&E==F||D==S&&G==S&&E==S||D==J&&G==J&&E==J)),c=!c;c&&(K.parentNode&&K.parentNode.removeChild(K),clearTimeout(q),b(f))}function r(){if((new Date).getTime()-
B>=s)K.parentNode&&K.parentNode.removeChild(K),d(Error(""+s+"ms timeout exceeded"));else{var b=document.hidden;if(!0===b||void 0===b)D=t.a.offsetWidth,G=u.a.offsetWidth,E=z.a.offsetWidth,m();q=setTimeout(r,50)}}var t=new c(l),u=new c(l),z=new c(l),D=-1,G=-1,E=-1,F=-1,S=-1,J=-1,K=document.createElement("div");K.dir="ltr";e(t,j(f,"sans-serif"));e(u,j(f,"serif"));e(z,j(f,"monospace"));K.appendChild(t.a);K.appendChild(u.a);K.appendChild(z.a);document.body.appendChild(K);F=t.a.offsetWidth;S=u.a.offsetWidth;
J=z.a.offsetWidth;r();g(t,function(b){D=b;m()});e(t,j(f,'"'+f.family+'",sans-serif'));g(u,function(b){G=b;m()});e(u,j(f,'"'+f.family+'",serif'));g(z,function(b){E=b;m()});e(z,j(f,'"'+f.family+'",monospace'))};document.body?F():document.addEventListener?document.addEventListener("DOMContentLoaded",function R(){document.removeEventListener("DOMContentLoaded",R);F()}):document.attachEvent("onreadystatechange",function O(){if("interactive"==document.readyState||"complete"==document.readyState)document.detachEvent("onreadystatechange",
O),F()})}})};"object"===typeof module?module.exports=f:(window.FontFaceObserver=f,window.FontFaceObserver.prototype.load=f.prototype.load)})();(function(b){Number.prototype.map=function(b,c,d,e){return d+(e-d)*((this-b)/(c-b))};Number.prototype.limit=function(b,c){return Math.min(c,Math.max(b,this))};Number.prototype.round=function(b){b=Math.pow(10,b||0);return Math.round(this*b)/b};Number.prototype.floor=function(){return Math.floor(this)};Number.prototype.ceil=function(){return Math.ceil(this)};Number.prototype.toInt=function(){return this|0};Number.prototype.toRad=function(){return this/180*Math.PI};Number.prototype.toDeg=function(){return 180*
this/Math.PI};Array.prototype.erase=function(b){for(var c=this.length;c--;)this[c]===b&&this.splice(c,1);return this};Array.prototype.random=function(){return this[Math.floor(Math.random()*this.length)]};Function.prototype.bind=Function.prototype.bind||function(b){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var c=Array.prototype.slice.call(arguments,1),d=this,e=function(){},f=function(){return d.apply(this instanceof e&&b?
this:b,c.concat(Array.prototype.slice.call(arguments)))};e.prototype=this.prototype;f.prototype=new e;return f};b.ig={game:null,debug:null,version:"1.23",global:b,modules:{},resources:[],ready:!1,baked:!1,nocache:"",ua:{},prefix:b.ImpactPrefix||"",lib:"lib/",_current:null,_loadQueue:[],_waitForOnload:0,$:function(b){return"#"==b.charAt(0)?document.getElementById(b.substr(1)):document.getElementsByTagName(b)},$new:function(b){return document.createElement(b)},copy:function(b){if(!b||"object"!=typeof b||
b instanceof HTMLElement||b instanceof ig.Class)return b;if(b instanceof Array)for(var c=[],d=0,e=b.length;d<e;d++)c[d]=ig.copy(b[d]);else for(d in c={},b)c[d]=ig.copy(b[d]);return c},merge:function(b,c){for(var d in c)if(!("_mesh"===d||"_camera"===d)){var e=c[d];if("object"!=typeof e||e instanceof HTMLElement||e instanceof ig.Class||null===e)b[d]=e;else{if(!b[d]||"object"!=typeof b[d])b[d]=e instanceof Array?[]:{};ig.merge(b[d],e)}}return b},ksort:function(b){if(!b||"object"!=typeof b)return[];var c=
[],d=[],e;for(e in b)c.push(e);c.sort();for(e=0;e<c.length;e++)d.push(b[c[e]]);return d},setVendorAttribute:function(b,c,d){var e=c.charAt(0).toUpperCase()+c.substr(1);b[c]="undefined"!==typeof b.imageSmoothingEnabled?b["ms"+e]=b["moz"+e]=b["o"+e]=d:b["ms"+e]=b["moz"+e]=b["webkit"+e]=b["o"+e]=d},getVendorAttribute:function(b,c){var d=c.charAt(0).toUpperCase()+c.substr(1);return"undefined"!==typeof b.imageSmoothingEnabled?b[c]||b["ms"+d]||b["moz"+d]||b["o"+d]:b[c]||b["ms"+d]||b["moz"+d]||b["webkit"+
d]||b["o"+d]},normalizeVendorAttribute:function(b,c){var d=ig.getVendorAttribute(b,c);!b[c]&&d&&(b[c]=d)},getImagePixels:function(b,c,d,e,f){var g=ig.$new("canvas");g.width=b.width;g.height=b.height;var m=g.getContext("2d");ig.System.SCALE.CRISP(g,m);var u=ig.getVendorAttribute(m,"backingStorePixelRatio")||1;ig.normalizeVendorAttribute(m,"getImageDataHD");var v=b.width/u,x=b.height/u;g.width=Math.ceil(v);g.height=Math.ceil(x);m.drawImage(b,0,0,v,x);return 1===u?m.getImageData(c,d,e,f):m.getImageDataHD(c,
d,e,f)},module:function(b){if(ig._current)throw"Module '"+ig._current.name+"' defines nothing";if(ig.modules[b]&&ig.modules[b].body)throw"Module '"+b+"' is already defined";ig._current={name:b,requires:[],loaded:!1,body:null};ig.modules[b]=ig._current;ig._loadQueue.push(ig._current);return ig},requires:function(){ig._current.requires=Array.prototype.slice.call(arguments);return ig},defines:function(b){ig._current.body=b;ig._current=null;ig._initDOMReady()},addResource:function(b){ig.resources.push(b)},
setNocache:function(b){ig.nocache=b?"?"+Date.now():""},log:function(){},assert:function(){},show:function(){},mark:function(){},_loadScript:function(b,c){ig.modules[b]={name:b,requires:[],loaded:!1,body:null};ig._waitForOnload++;var d=ig.prefix+ig.lib+b.replace(/\./g,"/")+".js"+ig.nocache,e=ig.$new("script");e.type="text/javascript";e.src=d;e.onload=function(){ig._waitForOnload--;ig._execModules()};e.onerror=function(){throw"Failed to load module "+b+" at "+d+" required from "+c;};ig.$("head")[0].appendChild(e)},
_execModules:function(){for(var b=!1,c=0;c<ig._loadQueue.length;c++){for(var d=ig._loadQueue[c],e=!0,f=0;f<d.requires.length;f++){var g=d.requires[f];ig.modules[g]?ig.modules[g].loaded||(e=!1):(e=!1,ig._loadScript(g,d.name))}e&&d.body&&(ig._loadQueue.splice(c,1),d.loaded=!0,d.body(),b=!0,c--)}if(b)ig._execModules();else if(!ig.baked&&0==ig._waitForOnload&&0!=ig._loadQueue.length){b=[];for(c=0;c<ig._loadQueue.length;c++){e=[];g=ig._loadQueue[c].requires;for(f=0;f<g.length;f++)d=ig.modules[g[f]],(!d||
!d.loaded)&&e.push(g[f]);b.push(ig._loadQueue[c].name+" (requires: "+e.join(", ")+")")}throw"Unresolved (or circular?) dependencies. Most likely there's a name/path mismatch for one of the listed modules or a previous syntax error prevents a module from loading:\n"+b.join("\n");}},_DOMReady:function(){if(!ig.modules["dom.ready"].loaded){if(!document.body)return setTimeout(ig._DOMReady,13);ig.modules["dom.ready"].loaded=!0;ig._waitForOnload--;ig._execModules()}return 0},_boot:function(){document.location.href.match(/\?nocache/)&&
ig.setNocache(!0);ig.ua.pixelRatio=b.devicePixelRatio||1;ig.ua.viewport={width:b.innerWidth,height:b.innerHeight};ig.ua.screen={width:b.screen.availWidth*ig.ua.pixelRatio,height:b.screen.availHeight*ig.ua.pixelRatio};ig.ua.iPhone=/iPhone/i.test(navigator.userAgent);ig.ua.iPhone4=ig.ua.iPhone&&2==ig.ua.pixelRatio;ig.ua.iPad=/iPad/i.test(navigator.userAgent);ig.ua.android=/android/i.test(navigator.userAgent);ig.ua.winPhone=/Windows Phone/i.test(navigator.userAgent);ig.ua.is_uiwebview=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);
ig.ua.is_safari_or_uiwebview=/(iPhone|iPod|iPad).*AppleWebKit/i.test(navigator.userAgent);ig.ua.iOS=ig.ua.iPhone||ig.ua.iPad;ig.ua.iOS6_tag=/OS 6_/i.test(navigator.userAgent);ig.ua.iOS6=(ig.ua.iPhone||ig.ua.iPad)&&ig.ua.iOS6_tag;ig.ua.iOSgt5=ig.ua.iOS&&5<parseInt(navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/)[1]);ig.ua.HTCONE=/HTC_One/i.test(navigator.userAgent);ig.ua.winPhone=/Windows Phone/i.test(navigator.userAgent);ig.ua.Kindle=/Silk/i.test(navigator.userAgent);ig.ua.touchDevice="ontouchstart"in
b||b.navigator.msMaxTouchPoints;ig.ua.mobile=ig.ua.iOS||ig.ua.android||ig.ua.iOS6||ig.ua.winPhone||ig.ua.Kindle||/mobile/i.test(navigator.userAgent)},_initDOMReady:function(){ig.modules["dom.ready"]?ig._execModules():(ig._boot(),ig.modules["dom.ready"]={requires:[],loaded:!1,body:null},ig._waitForOnload++,"complete"===document.readyState?ig._DOMReady():(document.addEventListener("DOMContentLoaded",ig._DOMReady,!1),b.addEventListener("load",ig._DOMReady,!1)))}};ig.normalizeVendorAttribute(b,"requestAnimationFrame");
if(b.requestAnimationFrame){var c=1,e={};b.ig.setAnimation=function(d){var f=c++;e[f]=!0;var g=function(){e[f]&&(b.requestAnimationFrame(g),d())};b.requestAnimationFrame(g);return f};b.ig.clearAnimation=function(b){delete e[b]}}else b.ig.setAnimation=function(c){return b.setInterval(c,1E3/60)},b.ig.clearAnimation=function(c){b.clearInterval(c)};var d=!1,g=/xyz/.test(function(){xyz})?/\bparent\b/:/.*/,f=0;b.ig.Class=function(){};var m=function(b){var c=this.prototype,d={},e;for(e in b)"function"==
typeof b[e]&&"function"==typeof c[e]&&g.test(b[e])?(d[e]=c[e],c[e]=function(b,c){return function(){var e=this.parent;this.parent=d[b];var f=c.apply(this,arguments);this.parent=e;return f}}(e,b[e])):c[e]=b[e]};b.ig.Class.extend=function(c){function e(){if(!d){if(this.staticInstantiate){var b=this.staticInstantiate.apply(this,arguments);if(b)return b}for(var c in this)"object"==typeof this[c]&&(this[c]=ig.copy(this[c]));this.init&&this.init.apply(this,arguments)}return this}var n=this.prototype;d=!0;
var r=new this;d=!1;for(var q in c)r[q]="function"==typeof c[q]&&"function"==typeof n[q]&&g.test(c[q])?function(b,c){return function(){var d=this.parent;this.parent=n[b];var e=c.apply(this,arguments);this.parent=d;return e}}(q,c[q]):c[q];e.prototype=r;e.prototype.constructor=e;e.extend=b.ig.Class.extend;e.inject=m;e.classId=r.classId=++f;return e};b.ImpactMixin&&ig.merge(ig,b.ImpactMixin)})(window);ig.baked=!0;
ig.module("impact.image").defines(function(){ig.Image=ig.Class.extend({data:null,width:0,height:0,loaded:!1,failed:!1,loadCallback:null,path:"",staticInstantiate:function(b){return ig.Image.cache[b]||null},init:function(b){this.path=b;this.load()},load:function(b){this.loaded?b&&b(this.path,!0):(!this.loaded&&ig.ready?(this.loadCallback=b||null,this.data=new Image,this.data.onload=this.onload.bind(this),this.data.onerror=this.onerror.bind(this),this.data.src=ig.prefix+this.path+ig.nocache):ig.addResource(this),
ig.Image.cache[this.path]=this)},reload:function(){this.loaded=!1;this.data=new Image;this.data.onload=this.onload.bind(this);this.data.src=this.path+"?"+Date.now()},onload:function(){this.width=this.data.width;this.height=this.data.height;this.loaded=!0;1!=ig.system.scale&&this.resize(ig.system.scale);this.loadCallback&&this.loadCallback(this.path,!0)},onerror:function(){this.failed=!0;this.loadCallback&&this.loadCallback(this.path,!1)},resize:function(b){var c=ig.getImagePixels(this.data,0,0,this.width,
this.height),e=this.width*b,d=this.height*b,g=ig.$new("canvas");g.width=e;g.height=d;for(var f=g.getContext("2d"),m=f.getImageData(0,0,e,d),l=0;l<d;l++)for(var j=0;j<e;j++){var n=4*(Math.floor(l/b)*this.width+Math.floor(j/b)),r=4*(l*e+j);m.data[r]=c.data[n];m.data[r+1]=c.data[n+1];m.data[r+2]=c.data[n+2];m.data[r+3]=c.data[n+3]}f.putImageData(m,0,0);this.data=g},draw:function(b,c,e,d,g,f){if(this.loaded){var m=ig.system.scale;g=(g?g:this.width)*m;f=(f?f:this.height)*m;ig.system.context.drawImage(this.data,
e?e*m:0,d?d*m:0,g,f,ig.system.getDrawPos(b),ig.system.getDrawPos(c),g,f);ig.Image.drawCount++}},drawTile:function(b,c,e,d,g,f,m){g=g?g:d;if(this.loaded&&!(d>this.width||g>this.height)){var l=ig.system.scale,j=Math.floor(d*l),n=Math.floor(g*l),r=f?-1:1,q=m?-1:1;if(f||m)ig.system.context.save(),ig.system.context.scale(r,q);ig.system.context.drawImage(this.data,Math.floor(e*d)%this.width*l,Math.floor(e*d/this.width)*g*l,j,n,ig.system.getDrawPos(b)*r-(f?j:0),ig.system.getDrawPos(c)*q-(m?n:0),j,n);(f||
m)&&ig.system.context.restore();ig.Image.drawCount++}}});ig.Image.drawCount=0;ig.Image.cache={};ig.Image.reloadCache=function(){for(var b in ig.Image.cache)ig.Image.cache[b].reload()}});ig.baked=!0;
ig.module("impact.font").requires("impact.image").defines(function(){ig.Font=ig.Image.extend({widthMap:[],indices:[],firstChar:32,alpha:1,letterSpacing:1,lineSpacing:0,onload:function(b){this._loadMetrics(this.data);this.parent(b)},widthForString:function(b){if(-1!==b.indexOf("\n")){b=b.split("\n");for(var c=0,e=0;e<b.length;e++)c=Math.max(c,this._widthForLine(b[e]));return c}return this._widthForLine(b)},_widthForLine:function(b){for(var c=0,e=0;e<b.length;e++)c+=this.widthMap[b.charCodeAt(e)-this.firstChar]+
this.letterSpacing;return c},heightForString:function(b){return b.split("\n").length*(this.height+this.lineSpacing)},draw:function(b,c,e,d){"string"!=typeof b&&(b=b.toString());if(-1!==b.indexOf("\n")){b=b.split("\n");for(var g=this.height+this.lineSpacing,f=0;f<b.length;f++)this.draw(b[f],c,e+f*g,d)}else{if(d==ig.Font.ALIGN.RIGHT||d==ig.Font.ALIGN.CENTER)f=this._widthForLine(b),c-=d==ig.Font.ALIGN.CENTER?f/2:f;1!==this.alpha&&(ig.system.context.globalAlpha=this.alpha);for(f=0;f<b.length;f++)d=b.charCodeAt(f),
c+=this._drawChar(d-this.firstChar,c,e);1!==this.alpha&&(ig.system.context.globalAlpha=1);ig.Image.drawCount+=b.length}},_drawChar:function(b,c,e){if(!this.loaded||0>b||b>=this.indices.length)return 0;var d=ig.system.scale,g=this.widthMap[b]*d,f=(this.height-2)*d;ig.system.context.drawImage(this.data,this.indices[b]*d,0,g,f,ig.system.getDrawPos(c),ig.system.getDrawPos(e),g,f);return this.widthMap[b]+this.letterSpacing},_loadMetrics:function(b){this.height=b.height-1;this.widthMap=[];this.indices=
[];for(var c=ig.getImagePixels(b,0,b.height-1,b.width,1),e=0,d=0,g=0;g<b.width;g++){var f=4*g+3;127<c.data[f]?d++:128>c.data[f]&&d&&(this.widthMap.push(d),this.indices.push(g-d),e++,d=0)}this.widthMap.push(d);this.indices.push(g-d)}});ig.Font.ALIGN={LEFT:0,RIGHT:1,CENTER:2}});ig.baked=!0;
ig.module("impact.sound").defines(function(){ig.SoundManager=ig.Class.extend({clips:{},volume:1,format:null,init:function(){if(!ig.Sound.enabled||!window.Audio)ig.Sound.enabled=!1;else{for(var b=new Audio,c=0;c<ig.Sound.use.length;c++){var e=ig.Sound.use[c];if(b.canPlayType(e.mime)){this.format=e;break}}this.format||(ig.Sound.enabled=!1)}},load:function(b,c,e){var d=ig.prefix+b.replace(/[^\.]+$/,this.format.ext)+ig.nocache;if(this.clips[b]){if(c&&this.clips[b].length<ig.Sound.channels)for(c=this.clips[b].length;c<
ig.Sound.channels;c++){var g=new Audio(d);g.load();this.clips[b].push(g)}return this.clips[b][0]}var f=new Audio(d);e&&(f.addEventListener("canplaythrough",function l(c){f.removeEventListener("canplaythrough",l,!1);e(b,!0,c)},!1),f.addEventListener("error",function(c){e(b,!1,c)},!1));f.preload="auto";f.load();this.clips[b]=[f];if(c)for(c=1;c<ig.Sound.channels;c++)g=new Audio(d),g.load(),this.clips[b].push(g);return f},get:function(b){b=this.clips[b];for(var c=0,e;e=b[c++];)if(e.paused||e.ended)return e.ended&&
(e.currentTime=0),e;b[0].pause();b[0].currentTime=0;return b[0]}});ig.Music=ig.Class.extend({tracks:[],namedTracks:{},currentTrack:null,currentIndex:0,random:!1,_volume:1,_loop:!1,_fadeInterval:0,_fadeTimer:null,_endedCallbackBound:null,init:function(){this._endedCallbackBound=this._endedCallback.bind(this);Object.defineProperty?(Object.defineProperty(this,"volume",{get:this.getVolume.bind(this),set:this.setVolume.bind(this)}),Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)})):
this.__defineGetter__&&(this.__defineGetter__("volume",this.getVolume.bind(this)),this.__defineSetter__("volume",this.setVolume.bind(this)),this.__defineGetter__("loop",this.getLooping.bind(this)),this.__defineSetter__("loop",this.setLooping.bind(this)))},add:function(b,c){if(ig.Sound.enabled){var e=ig.soundManager.load(b instanceof ig.Sound?b.path:b,!1);e.loop=this._loop;e.volume=this._volume;e.addEventListener("ended",this._endedCallbackBound,!1);this.tracks.push(e);c&&(this.namedTracks[c]=e);this.currentTrack||
(this.currentTrack=e)}},next:function(){this.tracks.length&&(this.stop(),this.currentIndex=this.random?Math.floor(Math.random()*this.tracks.length):(this.currentIndex+1)%this.tracks.length,this.currentTrack=this.tracks[this.currentIndex],this.play())},pause:function(){this.currentTrack&&this.currentTrack.pause()},stop:function(){this.currentTrack&&(this.currentTrack.pause(),this.currentTrack.currentTime=0)},play:function(b){if(b&&this.namedTracks[b])b=this.namedTracks[b],b!=this.currentTrack&&(this.stop(),
this.currentTrack=b);else if(!this.currentTrack)return;this.currentTrack.play()},getLooping:function(){return this._loop},setLooping:function(b){this._loop=b;for(var c in this.tracks)this.tracks[c].loop=b},getVolume:function(){return this._volume},setVolume:function(b){this._volume=b.limit(0,1);for(var c in this.tracks)this.tracks[c].volume=this._volume},fadeOut:function(b){this.currentTrack&&(clearInterval(this._fadeInterval),this.fadeTimer=new ig.Timer(b),this._fadeInterval=setInterval(this._fadeStep.bind(this),
50))},_fadeStep:function(){var b=this.fadeTimer.delta().map(-this.fadeTimer.target,0,1,0).limit(0,1)*this._volume;0.01>=b?(this.stop(),this.currentTrack.volume=this._volume,clearInterval(this._fadeInterval)):this.currentTrack.volume=b},_endedCallback:function(){this._loop?this.play():this.next()}});ig.Sound=ig.Class.extend({path:"",volume:1,currentClip:null,multiChannel:!0,init:function(b,c){this.path=b;this.multiChannel=!1!==c;this.load()},load:function(b){ig.Sound.enabled?ig.ready?ig.soundManager.load(this.path,
this.multiChannel,b):ig.addResource(this):b&&b(this.path,!0)},play:function(){ig.Sound.enabled&&(this.currentClip=ig.soundManager.get(this.path),this.currentClip.volume=ig.soundManager.volume*this.volume,this.currentClip.play())},stop:function(){this.currentClip&&(this.currentClip.pause(),this.currentClip.currentTime=0)}});ig.Sound.FORMAT={MP3:{ext:"mp3",mime:"audio/mpeg"},M4A:{ext:"m4a",mime:"audio/mp4; codecs=mp4a"},OGG:{ext:"ogg",mime:"audio/ogg; codecs=vorbis"},WEBM:{ext:"webm",mime:"audio/webm; codecs=vorbis"},
CAF:{ext:"caf",mime:"audio/x-caf"}};ig.Sound.use=[ig.Sound.FORMAT.OGG,ig.Sound.FORMAT.MP3];ig.Sound.channels=4;ig.Sound.enabled=!0});ig.baked=!0;
ig.module("impact.loader").requires("impact.image","impact.font","impact.sound").defines(function(){ig.Loader=ig.Class.extend({resources:[],gameClass:null,status:0,done:!1,_unloaded:[],_drawStatus:0,_intervalId:0,_loadCallbackBound:null,init:function(b,c){this.gameClass=b;this.resources=c;this._loadCallbackBound=this._loadCallback.bind(this);for(var e=0;e<this.resources.length;e++)this._unloaded.push(this.resources[e].path)},load:function(){ig.system.clear("#000");if(this.resources.length){for(var b=
0;b<this.resources.length;b++)this.loadResource(this.resources[b]);this._intervalId=setInterval(this.draw.bind(this),16)}else this.end()},loadResource:function(b){b.load(this._loadCallbackBound)},end:function(){this.done||(this.done=!0,clearInterval(this._intervalId))},draw:function(){},_loadCallback:function(b,c){if(c)this._unloaded.erase(b);else throw"Failed to load resource: "+b;this.status=1-this._unloaded.length/this.resources.length;0==this._unloaded.length&&setTimeout(this.end.bind(this),250)}})});
ig.baked=!0;
ig.module("impact.timer").defines(function(){ig.Timer=ig.Class.extend({target:0,base:0,last:0,pausedAt:0,init:function(b){this.last=this.base=ig.Timer.time;this.target=b||0},set:function(b){this.target=b||0;this.base=ig.Timer.time;this.pausedAt=0},reset:function(){this.base=ig.Timer.time;this.pausedAt=0},tick:function(){var b=ig.Timer.time-this.last;this.last=ig.Timer.time;return this.pausedAt?0:b},delta:function(){return(this.pausedAt||ig.Timer.time)-this.base-this.target},pause:function(){this.pausedAt||(this.pausedAt=
ig.Timer.time)},unpause:function(){this.pausedAt&&(this.base+=ig.Timer.time-this.pausedAt,this.pausedAt=0)}});ig.Timer._last=0;ig.Timer.time=Number.MIN_VALUE;ig.Timer.timeScale=1;ig.Timer.maxStep=0.05;ig.Timer.step=function(){var b=Date.now();ig.Timer.time+=Math.min((b-ig.Timer._last)/1E3,ig.Timer.maxStep)*ig.Timer.timeScale;ig.Timer._last=b}});ig.baked=!0;
ig.module("impact.system").requires("impact.timer","impact.image").defines(function(){ig.System=ig.Class.extend({fps:30,width:320,height:240,realWidth:320,realHeight:240,scale:1,tick:0,animationId:0,newGameClass:null,running:!1,delegate:null,clock:null,canvas:null,context:null,init:function(b,c,e,d,g){this.fps=c;this.clock=new ig.Timer;this.canvas=ig.$(b);this.resize(e,d,g);this.context=this.canvas.getContext("2d");this.getDrawPos=ig.System.drawMode;1!=this.scale&&(ig.System.scaleMode=ig.System.SCALE.CRISP);
ig.System.scaleMode(this.canvas,this.context)},resize:function(b,c,e){this.width=b;this.height=c;this.scale=e||this.scale;this.realWidth=this.width*this.scale;this.realHeight=this.height*this.scale;this.canvas.width=this.realWidth;this.canvas.height=this.realHeight},setGame:function(b){this.running?this.newGameClass=b:this.setGameNow(b)},setGameNow:function(b){ig.game=new b;ig.system.setDelegate(ig.game)},setDelegate:function(b){if("function"==typeof b.run)this.delegate=b,this.startRunLoop();else throw"System.setDelegate: No run() function in object";
},stopRunLoop:function(){ig.clearAnimation(this.animationId);this.running=!1},startRunLoop:function(){this.stopRunLoop();this.animationId=ig.setAnimation(this.run.bind(this));this.running=!0},clear:function(b){this.context.fillStyle=b;this.context.fillRect(0,0,this.realWidth,this.realHeight)},run:function(){ig.Timer.step();this.tick=this.clock.tick();this.delegate.run();ig.input.clearPressed();this.newGameClass&&(this.setGameNow(this.newGameClass),this.newGameClass=null)},getDrawPos:null});ig.System.DRAW=
{AUTHENTIC:function(b){return Math.round(b)*this.scale},SMOOTH:function(b){return Math.round(b*this.scale)},SUBPIXEL:function(b){return b*this.scale}};ig.System.drawMode=ig.System.DRAW.SMOOTH;ig.System.SCALE={CRISP:function(b,c){ig.setVendorAttribute(c,"imageSmoothingEnabled",!1);b.style.imageRendering="-moz-crisp-edges";b.style.imageRendering="-o-crisp-edges";b.style.imageRendering="-webkit-optimize-contrast";b.style.imageRendering="crisp-edges";b.style.msInterpolationMode="nearest-neighbor"},SMOOTH:function(b,
c){ig.setVendorAttribute(c,"imageSmoothingEnabled",!0);b.style.imageRendering="";b.style.msInterpolationMode=""}};ig.System.scaleMode=ig.System.SCALE.SMOOTH});ig.baked=!0;
ig.module("impact.input").defines(function(){ig.KEY={MOUSE1:-1,MOUSE2:-3,MWHEEL_UP:-4,MWHEEL_DOWN:-5,BACKSPACE:8,TAB:9,ENTER:13,PAUSE:19,CAPS:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,_0:48,_1:49,_2:50,_3:51,_4:52,_5:53,_6:54,_7:55,_8:56,_9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,
NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SHIFT:16,CTRL:17,ALT:18,PLUS:187,COMMA:188,MINUS:189,PERIOD:190};ig.Input=ig.Class.extend({bindings:{},actions:{},presses:{},locks:{},delayedKeyup:{},isUsingMouse:!1,isUsingKeyboard:!1,isUsingAccelerometer:!1,mouse:{x:0,y:0},accel:{x:0,y:0,z:0},initMouse:function(){if(!this.isUsingMouse){this.isUsingMouse=
!0;var b=this.mousewheel.bind(this);ig.system.canvas.addEventListener("wheel",b,!1);ig.system.canvas.addEventListener("mousewheel",b,!1);ig.system.canvas.addEventListener("DOMMouseScroll",b,!1);ig.system.canvas.addEventListener("contextmenu",this.contextmenu.bind(this),!1);ig.system.canvas.addEventListener("mousedown",this.keydown.bind(this),!1);ig.system.canvas.addEventListener("mouseup",this.keyup.bind(this),!1);ig.system.canvas.addEventListener("mousemove",this.mousemove.bind(this),!1);ig.ua.touchDevice&&
(ig.system.canvas.addEventListener("touchstart",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.mousemove.bind(this),!1),ig.system.canvas.addEventListener("MSPointerDown",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("MSPointerUp",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",this.mousemove.bind(this),!1),ig.system.canvas.style.msTouchAction="none")}},
initKeyboard:function(){this.isUsingKeyboard||(this.isUsingKeyboard=!0,window.addEventListener("keydown",this.keydown.bind(this),!1),window.addEventListener("keyup",this.keyup.bind(this),!1))},initAccelerometer:function(){this.isUsingAccelerometer||window.addEventListener("devicemotion",this.devicemotion.bind(this),!1)},mousewheel:function(b){var c=this.bindings[0<(b.wheelDelta?b.wheelDelta:-1*b.detail)?ig.KEY.MWHEEL_UP:ig.KEY.MWHEEL_DOWN];c&&(this.actions[c]=!0,this.presses[c]=!0,this.delayedKeyup[c]=
!0,b.stopPropagation(),b.preventDefault())},mousemove:function(b){var c=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth;ig.ua.mobile&&(c=ig.system.realWidth);var c=ig.system.scale*(c/ig.system.realWidth),e={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());b=b.touches?b.touches[0]:b;this.mouse.x=(b.clientX-e.left)/c;this.mouse.y=(b.clientY-e.top)/c},contextmenu:function(b){this.bindings[ig.KEY.MOUSE2]&&(b.stopPropagation(),b.preventDefault())},
keydown:function(b){var c=b.target.tagName;"INPUT"==c||"TEXTAREA"==c||(c="keydown"==b.type?b.keyCode:2==b.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1,("touchstart"==b.type||"mousedown"==b.type)&&this.mousemove(b),c=this.bindings[c],console.log(c),c&&(this.actions[c]=!0,this.locks[c]||(this.presses[c]=!0,this.locks[c]=!0),b.stopPropagation(),b.preventDefault()))},keyup:function(b){var c=b.target.tagName;if(!("INPUT"==c||"TEXTAREA"==c))if(c=this.bindings["keyup"==b.type?b.keyCode:2==b.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1])this.delayedKeyup[c]=
!0,b.stopPropagation(),b.preventDefault()},devicemotion:function(b){this.accel=b.accelerationIncludingGravity},bind:function(b,c){0>b?this.initMouse():0<b&&this.initKeyboard();this.bindings[b]=c},bindTouch:function(b,c){var e=ig.$(b),d=this;e.addEventListener("touchstart",function(b){d.touchStart(b,c)},!1);e.addEventListener("touchend",function(b){d.touchEnd(b,c)},!1);e.addEventListener("MSPointerDown",function(b){d.touchStart(b,c)},!1);e.addEventListener("MSPointerUp",function(b){d.touchEnd(b,c)},
!1)},unbind:function(b){this.delayedKeyup[this.bindings[b]]=!0;this.bindings[b]=null},unbindAll:function(){this.bindings={};this.actions={};this.presses={};this.locks={};this.delayedKeyup={}},state:function(b){return this.actions[b]},pressed:function(b){return this.presses[b]},released:function(b){return!!this.delayedKeyup[b]},clearPressed:function(){for(var b in this.delayedKeyup)this.actions[b]=!1,this.locks[b]=!1;this.delayedKeyup={};this.presses={}},touchStart:function(b,c){this.actions[c]=!0;
this.presses[c]=!0;b.stopPropagation();b.preventDefault();return!1},touchEnd:function(b,c){this.delayedKeyup[c]=!0;b.stopPropagation();b.preventDefault();return!1}})});ig.baked=!0;ig.module("impact.impact").requires("dom.ready","impact.loader","impact.system","impact.input","impact.sound").defines(function(){ig.main=function(b,c,e,d,g,f,m){ig.system=new ig.System(b,e,d,g,f||1);ig.input=new ig.Input;ig.soundManager=new ig.SoundManager;ig.music=new ig.Music;ig.ready=!0;(new (m||ig.Loader)(c,ig.resources)).load()}});
ig.baked=!0;
ig.module("impact.animation").requires("impact.timer","impact.image").defines(function(){ig.AnimationSheet=ig.Class.extend({width:8,height:8,image:null,init:function(b,c,e){this.width=c;this.height=e;this.image=new ig.Image(b)}});ig.Animation=ig.Class.extend({sheet:null,timer:null,sequence:[],flip:{x:!1,y:!1},pivot:{x:0,y:0},frame:0,tile:0,loopCount:0,alpha:1,angle:0,init:function(b,c,e,d){this.sheet=b;this.pivot={x:b.width/2,y:b.height/2};this.timer=new ig.Timer;this.frameTime=c;this.sequence=e;
this.stop=!!d;this.tile=this.sequence[0]},rewind:function(){this.timer.set();this.frame=this.loopCount=0;this.tile=this.sequence[0];return this},gotoFrame:function(b){this.timer.set(this.frameTime*-b-1E-4);this.update()},gotoRandomFrame:function(){this.gotoFrame(Math.floor(Math.random()*this.sequence.length))},update:function(){var b=Math.floor(this.timer.delta()/this.frameTime);this.loopCount=Math.floor(b/this.sequence.length);this.frame=this.stop&&0<this.loopCount?this.sequence.length-1:b%this.sequence.length;
this.tile=this.sequence[this.frame]},draw:function(b,c){var e=Math.max(this.sheet.width,this.sheet.height);b>ig.system.width||(c>ig.system.height||0>b+e||0>c+e)||(1!=this.alpha&&(ig.system.context.globalAlpha=this.alpha),0==this.angle?this.sheet.image.drawTile(b,c,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y):(ig.system.context.save(),ig.system.context.translate(ig.system.getDrawPos(b+this.pivot.x),ig.system.getDrawPos(c+this.pivot.y)),ig.system.context.rotate(this.angle),
this.sheet.image.drawTile(-this.pivot.x,-this.pivot.y,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y),ig.system.context.restore()),1!=this.alpha&&(ig.system.context.globalAlpha=1))}})});ig.baked=!0;
ig.module("impact.entity").requires("impact.animation","impact.impact").defines(function(){ig.Entity=ig.Class.extend({id:0,settings:{},size:{x:16,y:16},offset:{x:0,y:0},pos:{x:0,y:0},last:{x:0,y:0},vel:{x:0,y:0},accel:{x:0,y:0},friction:{x:0,y:0},maxVel:{x:100,y:100},zIndex:0,gravityFactor:1,standing:!1,bounciness:0,minBounceVelocity:40,anims:{},animSheet:null,currentAnim:null,health:10,type:0,checkAgainst:0,collides:0,_killed:!1,slopeStanding:{min:(44).toRad(),max:(136).toRad()},init:function(b,
c,e){this.id=++ig.Entity._lastId;this.pos.x=this.last.x=b;this.pos.y=this.last.y=c;ig.merge(this,e)},reset:function(b,c,e){var d=this.constructor.prototype;this.pos.x=b;this.pos.y=c;this.last.x=b;this.last.y=c;this.vel.x=d.vel.x;this.vel.y=d.vel.y;this.accel.x=d.accel.x;this.accel.y=d.accel.y;this.health=d.health;this._killed=d._killed;this.standing=d.standing;this.type=d.type;this.checkAgainst=d.checkAgainst;this.collides=d.collides;ig.merge(this,e)},addAnim:function(b,c,e,d){if(!this.animSheet)throw"No animSheet to add the animation "+
b+" to.";c=new ig.Animation(this.animSheet,c,e,d);this.anims[b]=c;this.currentAnim||(this.currentAnim=c);return c},update:function(){this.last.x=this.pos.x;this.last.y=this.pos.y;this.vel.y+=ig.game.gravity*ig.system.tick*this.gravityFactor;this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x);this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y,this.friction.y,this.maxVel.y);var b=ig.game.collisionMap.trace(this.pos.x,this.pos.y,this.vel.x*ig.system.tick,this.vel.y*
ig.system.tick,this.size.x,this.size.y);this.handleMovementTrace(b);this.currentAnim&&this.currentAnim.update()},getNewVelocity:function(b,c,e,d){return c?(b+c*ig.system.tick).limit(-d,d):e?(c=e*ig.system.tick,0<b-c?b-c:0>b+c?b+c:0):b.limit(-d,d)},handleMovementTrace:function(b){this.standing=!1;b.collision.y&&(0<this.bounciness&&Math.abs(this.vel.y)>this.minBounceVelocity?this.vel.y*=-this.bounciness:(0<this.vel.y&&(this.standing=!0),this.vel.y=0));b.collision.x&&(this.vel.x=0<this.bounciness&&Math.abs(this.vel.x)>
this.minBounceVelocity?this.vel.x*-this.bounciness:0);if(b.collision.slope){var c=b.collision.slope;if(0<this.bounciness){var e=this.vel.x*c.nx+this.vel.y*c.ny;this.vel.x=(this.vel.x-2*c.nx*e)*this.bounciness;this.vel.y=(this.vel.y-2*c.ny*e)*this.bounciness}else e=(this.vel.x*c.x+this.vel.y*c.y)/(c.x*c.x+c.y*c.y),this.vel.x=c.x*e,this.vel.y=c.y*e,c=Math.atan2(c.x,c.y),c>this.slopeStanding.min&&c<this.slopeStanding.max&&(this.standing=!0)}this.pos=b.pos},draw:function(){this.currentAnim&&this.currentAnim.draw(this.pos.x-
this.offset.x-ig.game._rscreen.x,this.pos.y-this.offset.y-ig.game._rscreen.y)},kill:function(){ig.game.removeEntity(this)},receiveDamage:function(b){this.health-=b;0>=this.health&&this.kill()},touches:function(b){return!(this.pos.x>=b.pos.x+b.size.x||this.pos.x+this.size.x<=b.pos.x||this.pos.y>=b.pos.y+b.size.y||this.pos.y+this.size.y<=b.pos.y)},distanceTo:function(b){var c=this.pos.x+this.size.x/2-(b.pos.x+b.size.x/2);b=this.pos.y+this.size.y/2-(b.pos.y+b.size.y/2);return Math.sqrt(c*c+b*b)},angleTo:function(b){return Math.atan2(b.pos.y+
b.size.y/2-(this.pos.y+this.size.y/2),b.pos.x+b.size.x/2-(this.pos.x+this.size.x/2))},check:function(){},collideWith:function(){},ready:function(){},erase:function(){}});ig.Entity._lastId=0;ig.Entity.COLLIDES={NEVER:0,LITE:1,PASSIVE:2,ACTIVE:4,FIXED:8};ig.Entity.TYPE={NONE:0,A:1,B:2,BOTH:3};ig.Entity.checkPair=function(b,c){b.checkAgainst&c.type&&b.check(c);c.checkAgainst&b.type&&c.check(b);b.collides&&(c.collides&&b.collides+c.collides>ig.Entity.COLLIDES.ACTIVE)&&ig.Entity.solveCollision(b,c)};ig.Entity.solveCollision=
function(b,c){var e=null;if(b.collides==ig.Entity.COLLIDES.LITE||c.collides==ig.Entity.COLLIDES.FIXED)e=b;else if(c.collides==ig.Entity.COLLIDES.LITE||b.collides==ig.Entity.COLLIDES.FIXED)e=c;b.last.x+b.size.x>c.last.x&&b.last.x<c.last.x+c.size.x?(b.last.y<c.last.y?ig.Entity.seperateOnYAxis(b,c,e):ig.Entity.seperateOnYAxis(c,b,e),b.collideWith(c,"y"),c.collideWith(b,"y")):b.last.y+b.size.y>c.last.y&&b.last.y<c.last.y+c.size.y&&(b.last.x<c.last.x?ig.Entity.seperateOnXAxis(b,c,e):ig.Entity.seperateOnXAxis(c,
b,e),b.collideWith(c,"x"),c.collideWith(b,"x"))};ig.Entity.seperateOnXAxis=function(b,c,e){var d=b.pos.x+b.size.x-c.pos.x;e?(e.vel.x=-e.vel.x*e.bounciness+(b===e?c:b).vel.x,c=ig.game.collisionMap.trace(e.pos.x,e.pos.y,e==b?-d:d,0,e.size.x,e.size.y),e.pos.x=c.pos.x):(e=(b.vel.x-c.vel.x)/2,b.vel.x=-e,c.vel.x=e,e=ig.game.collisionMap.trace(b.pos.x,b.pos.y,-d/2,0,b.size.x,b.size.y),b.pos.x=Math.floor(e.pos.x),b=ig.game.collisionMap.trace(c.pos.x,c.pos.y,d/2,0,c.size.x,c.size.y),c.pos.x=Math.ceil(b.pos.x))};
ig.Entity.seperateOnYAxis=function(b,c,e){var d=b.pos.y+b.size.y-c.pos.y;if(e){c=b===e?c:b;e.vel.y=-e.vel.y*e.bounciness+c.vel.y;var g=0;e==b&&Math.abs(e.vel.y-c.vel.y)<e.minBounceVelocity&&(e.standing=!0,g=c.vel.x*ig.system.tick);b=ig.game.collisionMap.trace(e.pos.x,e.pos.y,g,e==b?-d:d,e.size.x,e.size.y);e.pos.y=b.pos.y;e.pos.x=b.pos.x}else ig.game.gravity&&(c.standing||0<b.vel.y)?(e=ig.game.collisionMap.trace(b.pos.x,b.pos.y,0,-(b.pos.y+b.size.y-c.pos.y),b.size.x,b.size.y),b.pos.y=e.pos.y,0<b.bounciness&&
b.vel.y>b.minBounceVelocity?b.vel.y*=-b.bounciness:(b.standing=!0,b.vel.y=0)):(e=(b.vel.y-c.vel.y)/2,b.vel.y=-e,c.vel.y=e,g=c.vel.x*ig.system.tick,e=ig.game.collisionMap.trace(b.pos.x,b.pos.y,g,-d/2,b.size.x,b.size.y),b.pos.y=e.pos.y,b=ig.game.collisionMap.trace(c.pos.x,c.pos.y,0,d/2,c.size.x,c.size.y),c.pos.y=b.pos.y)}});ig.baked=!0;
ig.module("impact.map").defines(function(){ig.Map=ig.Class.extend({tilesize:8,width:1,height:1,data:[[]],name:null,init:function(b,c){this.tilesize=b;this.data=c;this.height=c.length;this.width=c[0].length;this.pxWidth=this.width*this.tilesize;this.pxHeight=this.height*this.tilesize},getTile:function(b,c){var e=Math.floor(b/this.tilesize),d=Math.floor(c/this.tilesize);return 0<=e&&e<this.width&&0<=d&&d<this.height?this.data[d][e]:0},setTile:function(b,c,e){b=Math.floor(b/this.tilesize);c=Math.floor(c/
this.tilesize);0<=b&&b<this.width&&(0<=c&&c<this.height)&&(this.data[c][b]=e)}})});ig.baked=!0;
ig.module("impact.collision-map").requires("impact.map").defines(function(){ig.CollisionMap=ig.Map.extend({lastSlope:1,tiledef:null,init:function(b,c,g){this.parent(b,c);this.tiledef=g||ig.CollisionMap.defaultTileDef;for(var f in this.tiledef)f|0>this.lastSlope&&(this.lastSlope=f|0)},trace:function(b,c,g,f,m,l){var j={collision:{x:!1,y:!1,slope:!1},pos:{x:b,y:c},tile:{x:0,y:0}},n=Math.ceil(Math.max(Math.abs(g),Math.abs(f))/this.tilesize);if(1<n)for(var r=g/n,q=f/n,s=0;s<n&&(r||q)&&!(this._traceStep(j,
b,c,r,q,m,l,g,f,s),b=j.pos.x,c=j.pos.y,j.collision.x&&(g=r=0),j.collision.y&&(f=q=0),j.collision.slope);s++);else this._traceStep(j,b,c,g,f,m,l,g,f,0);return j},_traceStep:function(b,c,g,f,m,l,j,n,r,q){b.pos.x+=f;b.pos.y+=m;var s=0;if(f){var t=0<f?l:0,u=0>f?this.tilesize:0,s=Math.max(Math.floor(g/this.tilesize),0),v=Math.min(Math.ceil((g+j)/this.tilesize),this.height);f=Math.floor((b.pos.x+t)/this.tilesize);var x=Math.floor((c+t)/this.tilesize);if(0<q||f==x||0>x||x>=this.width)x=-1;if(0<=f&&f<this.width)for(var y=
s;y<v&&!(-1!=x&&(s=this.data[y][x],1<s&&s<=this.lastSlope&&this._checkTileDef(b,s,c,g,n,r,l,j,x,y)));y++)if(s=this.data[y][f],1==s||s>this.lastSlope||1<s&&this._checkTileDef(b,s,c,g,n,r,l,j,f,y)){if(1<s&&s<=this.lastSlope&&b.collision.slope)break;b.collision.x=!0;b.tile.x=s;c=b.pos.x=f*this.tilesize-t+u;n=0;break}}if(m){t=0<m?j:0;m=0>m?this.tilesize:0;s=Math.max(Math.floor(b.pos.x/this.tilesize),0);u=Math.min(Math.ceil((b.pos.x+l)/this.tilesize),this.width);y=Math.floor((b.pos.y+t)/this.tilesize);
v=Math.floor((g+t)/this.tilesize);if(0<q||y==v||0>v||v>=this.height)v=-1;if(0<=y&&y<this.height)for(f=s;f<u&&!(-1!=v&&(s=this.data[v][f],1<s&&s<=this.lastSlope&&this._checkTileDef(b,s,c,g,n,r,l,j,f,v)));f++)if(s=this.data[y][f],1==s||s>this.lastSlope||1<s&&this._checkTileDef(b,s,c,g,n,r,l,j,f,y)){if(1<s&&s<=this.lastSlope&&b.collision.slope)break;b.collision.y=!0;b.tile.y=s;b.pos.y=y*this.tilesize-t+m;break}}},_checkTileDef:function(b,c,g,f,m,l,j,n,r,q){var s=this.tiledef[c];if(!s)return!1;c=(s[2]-
s[0])*this.tilesize;var t=(s[3]-s[1])*this.tilesize,u=s[4];j=g+m+(0>t?j:0)-(r+s[0])*this.tilesize;n=f+l+(0<c?n:0)-(q+s[1])*this.tilesize;if(0<c*n-t*j){if(0>m*-t+l*c)return u;r=Math.sqrt(c*c+t*t);q=t/r;r=-c/r;var v=j*q+n*r,s=q*v,v=r*v;if(s*s+v*v>=m*m+l*l)return u||0.5>c*(n-l)-t*(j-m);b.pos.x=g+m-s;b.pos.y=f+l-v;b.collision.slope={x:c,y:t,nx:q,ny:r};return!0}return!1}});var b=1/3,c=2/3;ig.CollisionMap.defaultTileDef={5:[0,1,1,c,!0],6:[0,c,1,b,!0],7:[0,b,1,0,!0],3:[0,1,1,0.5,!0],4:[0,0.5,1,0,!0],2:[0,
1,1,0,!0],10:[0.5,1,1,0,!0],21:[0,1,0.5,0,!0],32:[c,1,1,0,!0],43:[b,1,c,0,!0],54:[0,1,b,0,!0],27:[0,0,1,b,!0],28:[0,b,1,c,!0],29:[0,c,1,1,!0],25:[0,0,1,0.5,!0],26:[0,0.5,1,1,!0],24:[0,0,1,1,!0],11:[0,0,0.5,1,!0],22:[0.5,0,1,1,!0],33:[0,0,b,1,!0],44:[b,0,c,1,!0],55:[c,0,1,1,!0],16:[1,b,0,0,!0],17:[1,c,0,b,!0],18:[1,1,0,c,!0],14:[1,0.5,0,0,!0],15:[1,1,0,0.5,!0],13:[1,1,0,0,!0],8:[0.5,1,0,0,!0],19:[1,1,0.5,0,!0],30:[b,1,0,0,!0],41:[c,1,b,0,!0],52:[1,1,c,0,!0],38:[1,c,0,1,!0],39:[1,b,0,c,!0],40:[1,0,
0,b,!0],36:[1,0.5,0,1,!0],37:[1,0,0,0.5,!0],35:[1,0,0,1,!0],9:[1,0,0.5,1,!0],20:[0.5,0,0,1,!0],31:[1,0,c,1,!0],42:[c,0,b,1,!0],53:[b,0,0,1,!0],12:[0,0,1,0,!1],23:[1,1,0,1,!1],34:[1,0,1,1,!1],45:[0,1,0,0,!1]};ig.CollisionMap.staticNoCollision={trace:function(b,c,g,f){return{collision:{x:!1,y:!1,slope:!1},pos:{x:b+g,y:c+f},tile:{x:0,y:0}}}}});ig.baked=!0;
ig.module("impact.background-map").requires("impact.map","impact.image").defines(function(){ig.BackgroundMap=ig.Map.extend({tiles:null,scroll:{x:0,y:0},distance:1,repeat:!1,tilesetName:"",foreground:!1,enabled:!0,preRender:!1,preRenderedChunks:null,chunkSize:512,debugChunks:!1,anims:{},init:function(b,c,e){this.parent(b,c);this.setTileset(e)},setTileset:function(b){this.tilesetName=b instanceof ig.Image?b.path:b;this.tiles=new ig.Image(this.tilesetName);this.preRenderedChunks=null},setScreenPos:function(b,
c){this.scroll.x=b/this.distance;this.scroll.y=c/this.distance},preRenderMapToChunks:function(){var b=this.width*this.tilesize*ig.system.scale,c=this.height*this.tilesize*ig.system.scale;this.chunkSize=Math.min(Math.max(b,c),this.chunkSize);var e=Math.ceil(b/this.chunkSize),d=Math.ceil(c/this.chunkSize);this.preRenderedChunks=[];for(var g=0;g<d;g++){this.preRenderedChunks[g]=[];for(var f=0;f<e;f++)this.preRenderedChunks[g][f]=this.preRenderChunk(f,g,f==e-1?b-f*this.chunkSize:this.chunkSize,g==d-1?
c-g*this.chunkSize:this.chunkSize)}},preRenderChunk:function(b,c,e,d){var g=e/this.tilesize/ig.system.scale+1,f=d/this.tilesize/ig.system.scale+1,m=b*this.chunkSize/ig.system.scale%this.tilesize,l=c*this.chunkSize/ig.system.scale%this.tilesize;b=Math.floor(b*this.chunkSize/this.tilesize/ig.system.scale);c=Math.floor(c*this.chunkSize/this.tilesize/ig.system.scale);var j=ig.$new("canvas");j.width=e;j.height=d;j.retinaResolutionEnabled=!1;d=j.getContext("2d");ig.System.scaleMode(j,d);e=ig.system.context;
ig.system.context=d;for(d=0;d<g;d++)for(var n=0;n<f;n++)if(d+b<this.width&&n+c<this.height){var r=this.data[n+c][d+b];r&&this.tiles.drawTile(d*this.tilesize-m,n*this.tilesize-l,r-1,this.tilesize)}ig.system.context=e;return j},draw:function(){this.tiles.loaded&&this.enabled&&(this.preRender?this.drawPreRendered():this.drawTiled())},drawPreRendered:function(){this.preRenderedChunks||this.preRenderMapToChunks();var b=ig.system.getDrawPos(this.scroll.x),c=ig.system.getDrawPos(this.scroll.y);if(this.repeat)var e=
this.width*this.tilesize*ig.system.scale,b=(b%e+e)%e,e=this.height*this.tilesize*ig.system.scale,c=(c%e+e)%e;var e=Math.max(Math.floor(b/this.chunkSize),0),d=Math.max(Math.floor(c/this.chunkSize),0),g=Math.ceil((b+ig.system.realWidth)/this.chunkSize),f=Math.ceil((c+ig.system.realHeight)/this.chunkSize),m=this.preRenderedChunks[0].length,l=this.preRenderedChunks.length;this.repeat||(g=Math.min(g,m),f=Math.min(f,l));for(var j=0;d<f;d++){for(var n=0,r=e;r<g;r++){var q=this.preRenderedChunks[d%l][r%m],
s=-b+r*this.chunkSize-n,t=-c+d*this.chunkSize-j;ig.system.context.drawImage(q,s,t);ig.Image.drawCount++;this.debugChunks&&(ig.system.context.strokeStyle="#f0f",ig.system.context.strokeRect(s,t,this.chunkSize,this.chunkSize));this.repeat&&(q.width<this.chunkSize&&s+q.width<ig.system.realWidth)&&(n+=this.chunkSize-q.width,g++)}this.repeat&&(q.height<this.chunkSize&&t+q.height<ig.system.realHeight)&&(j+=this.chunkSize-q.height,f++)}},drawTiled:function(){for(var b=0,c=null,e=(this.scroll.x/this.tilesize).toInt(),
d=(this.scroll.y/this.tilesize).toInt(),g=this.scroll.x%this.tilesize,f=this.scroll.y%this.tilesize,m=-g-this.tilesize,g=ig.system.width+this.tilesize-g,l=ig.system.height+this.tilesize-f,j=-1,f=-f-this.tilesize;f<l;j++,f+=this.tilesize){var n=j+d;if(n>=this.height||0>n){if(!this.repeat)continue;n=(n%this.height+this.height)%this.height}for(var r=-1,q=m;q<g;r++,q+=this.tilesize){b=r+e;if(b>=this.width||0>b){if(!this.repeat)continue;b=(b%this.width+this.width)%this.width}if(b=this.data[n][b])(c=this.anims[b-
1])?c.draw(q,f):this.tiles.drawTile(q,f,b-1,this.tilesize)}}}})});ig.baked=!0;
ig.module("impact.game").requires("impact.impact","impact.entity","impact.collision-map","impact.background-map").defines(function(){ig.Game=ig.Class.extend({clearColor:"#000000",gravity:0,screen:{x:0,y:0},_rscreen:{x:0,y:0},entities:[],namedEntities:{},collisionMap:ig.CollisionMap.staticNoCollision,backgroundMaps:[],backgroundAnims:{},autoSort:!1,sortBy:null,cellSize:64,_deferredKill:[],_levelToLoad:null,_doSortEntities:!1,staticInstantiate:function(){this.sortBy=this.sortBy||ig.Game.SORT.Z_INDEX;
ig.game=this;return null},loadLevel:function(b){this.screen={x:0,y:0};this.entities=[];this.namedEntities={};for(var c=0;c<b.entities.length;c++){var e=b.entities[c];this.spawnEntity(e.type,e.x,e.y,e.settings)}this.sortEntities();this.collisionMap=ig.CollisionMap.staticNoCollision;this.backgroundMaps=[];for(c=0;c<b.layer.length;c++)if(e=b.layer[c],"collision"==e.name)this.collisionMap=new ig.CollisionMap(e.tilesize,e.data);else{var d=new ig.BackgroundMap(e.tilesize,e.data,e.tilesetName);d.anims=this.backgroundAnims[e.tilesetName]||
{};d.repeat=e.repeat;d.distance=e.distance;d.foreground=!!e.foreground;d.preRender=!!e.preRender;d.name=e.name;this.backgroundMaps.push(d)}for(c=0;c<this.entities.length;c++)this.entities[c].ready()},loadLevelDeferred:function(b){this._levelToLoad=b},getMapByName:function(b){if("collision"==b)return this.collisionMap;for(var c=0;c<this.backgroundMaps.length;c++)if(this.backgroundMaps[c].name==b)return this.backgroundMaps[c];return null},getEntityByName:function(b){return this.namedEntities[b]},getEntitiesByType:function(b){b=
"string"===typeof b?ig.global[b]:b;for(var c=[],e=0;e<this.entities.length;e++){var d=this.entities[e];d instanceof b&&!d._killed&&c.push(d)}return c},spawnEntity:function(b,c,e,d){var g="string"===typeof b?ig.global[b]:b;if(!g)throw"Can't spawn entity of type "+b;b=new g(c,e,d||{});this.entities.push(b);b.name&&(this.namedEntities[b.name]=b);return b},sortEntities:function(){this.entities.sort(this.sortBy)},sortEntitiesDeferred:function(){this._doSortEntities=!0},removeEntity:function(b){b.name&&
delete this.namedEntities[b.name];b._killed=!0;b.type=ig.Entity.TYPE.NONE;b.checkAgainst=ig.Entity.TYPE.NONE;b.collides=ig.Entity.COLLIDES.NEVER;this._deferredKill.push(b)},run:function(){this.update();this.draw()},update:function(){this._levelToLoad&&(this.loadLevel(this._levelToLoad),this._levelToLoad=null);this.updateEntities();this.checkEntities();for(var b=0;b<this._deferredKill.length;b++)this._deferredKill[b].erase(),this.entities.erase(this._deferredKill[b]);this._deferredKill=[];if(this._doSortEntities||
this.autoSort)this.sortEntities(),this._doSortEntities=!1;for(var c in this.backgroundAnims){var b=this.backgroundAnims[c],e;for(e in b)b[e].update()}},updateEntities:function(){for(var b=0;b<this.entities.length;b++){var c=this.entities[b];c._killed||c.update()}},draw:function(){this.clearColor&&ig.system.clear(this.clearColor);this._rscreen.x=ig.system.getDrawPos(this.screen.x)/ig.system.scale;this._rscreen.y=ig.system.getDrawPos(this.screen.y)/ig.system.scale;var b;for(b=0;b<this.backgroundMaps.length;b++){var c=
this.backgroundMaps[b];if(c.foreground)break;c.setScreenPos(this.screen.x,this.screen.y);c.draw()}this.drawEntities();for(b;b<this.backgroundMaps.length;b++)c=this.backgroundMaps[b],c.setScreenPos(this.screen.x,this.screen.y),c.draw()},drawEntities:function(){for(var b=0;b<this.entities.length;b++)this.entities[b].draw()},checkEntities:function(){for(var b={},c=0;c<this.entities.length;c++){var e=this.entities[c];if(!(e.type==ig.Entity.TYPE.NONE&&e.checkAgainst==ig.Entity.TYPE.NONE&&e.collides==ig.Entity.COLLIDES.NEVER))for(var d=
{},g=Math.floor(e.pos.y/this.cellSize),f=Math.floor((e.pos.x+e.size.x)/this.cellSize)+1,m=Math.floor((e.pos.y+e.size.y)/this.cellSize)+1,l=Math.floor(e.pos.x/this.cellSize);l<f;l++)for(var j=g;j<m;j++)if(b[l])if(b[l][j]){for(var n=b[l][j],r=0;r<n.length;r++)e.touches(n[r])&&!d[n[r].id]&&(d[n[r].id]=!0,ig.Entity.checkPair(e,n[r]));n.push(e)}else b[l][j]=[e];else b[l]={},b[l][j]=[e]}}});ig.Game.SORT={Z_INDEX:function(b,c){return b.zIndex-c.zIndex},POS_X:function(b,c){return b.pos.x+b.size.x-(c.pos.x+
c.size.x)},POS_Y:function(b,c){return b.pos.y+b.size.y-(c.pos.y+c.size.y)}}});ig.baked=!0;ig.module("plugins.patches.timer-patch").requires("impact.timer").defines(function(){ig.Timer.step=function(){var b=Date.now(),c=(b-ig.Timer._last)/1E3;0>c&&(c=0);ig.Timer.time+=Math.min(c,ig.Timer.maxStep)*ig.Timer.timeScale;ig.Timer._last=b}});ig.baked=!0;
ig.module("plugins.patches.user-agent-patch").defines(function(){ig.ua.touchDevice="ontouchstart"in window||window.navigator.msMaxTouchPoints||window.navigator.maxTouchPoints;ig.ua.is_mac="MacIntel"===navigator.platform;ig.ua.iOS=ig.ua.touchDevice&&ig.ua.is_mac||ig.ua.iOS;ig.ua.mobile=ig.ua.iOS||ig.ua.mobile});ig.baked=!0;
ig.module("plugins.patches.webkit-image-smoothing-patch").defines(function(){ig.System&&(ig.System.SCALE={CRISP:function(b,c){c.imageSmoothingEnabled=c.msImageSmoothingEnabled=c.mozImageSmoothingEnabled=c.oImageSmoothingEnabled=!1;b.style.imageRendering="-moz-crisp-edges";b.style.imageRendering="-o-crisp-edges";b.style.imageRendering="-webkit-optimize-contrast";b.style.imageRendering="crisp-edges";b.style.msInterpolationMode="nearest-neighbor"},SMOOTH:function(b,c){c.imageSmoothingEnabled=c.msImageSmoothingEnabled=
c.mozImageSmoothingEnabled=c.oImageSmoothingEnabled=!0;b.style.imageRendering="";b.style.msInterpolationMode=""}},ig.System.scaleMode=ig.System.SCALE.SMOOTH)});ig.baked=!0;
ig.module("plugins.patches.windowfocus-onMouseDown-patch").requires("impact.input").defines(function(){var b=!1;try{b=window.self!==window.top,!1===b&&(b=0<window.frames.length)}catch(c){b=!0}ig.Input.inject({keydown:function(c){var d=c.target.tagName;if(!("INPUT"==d||"TEXTAREA"==d))if(d="keydown"==c.type?c.keyCode:2==c.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1,b&&0>d&&window.focus(),("touchstart"==c.type||"mousedown"==c.type)&&this.mousemove(c),d=this.bindings[d])this.actions[d]=!0,this.locks[d]||(this.presses[d]=
!0,this.locks[d]=!0),c.stopPropagation(),c.preventDefault()}})});ig.baked=!0;
ig.module("plugins.patches.input-patch").requires("impact.input").defines(function(){ig.Input.inject({move:new BABYLON.Vector2(0,0),initMouse:function(){if(!this.isUsingMouse){this.isUsingMouse=!0;var b=this.mousewheel.bind(this);ig.system.canvas.addEventListener("mousewheel",b,!1);ig.system.canvas.addEventListener("DOMMouseScroll",b,!1);ig.system.canvas.addEventListener("contextmenu",this.contextmenu.bind(this),!1);ig.system.canvas.addEventListener("mousedown",this.keydown.bind(this),!1);ig.system.canvas.addEventListener("mouseup",
this.keyup.bind(this),!1);ig.system.canvas.addEventListener("mousemove",this.mousemove.bind(this),!1);ig.ua.touchDevice&&(ig.system.canvas.addEventListener("touchstart",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.mousemove.bind(this),!1),ig.system.canvas.addEventListener("MSPointerDown",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("MSPointerUp",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",
this.mousemove.bind(this),!1),ig.system.canvas.style.msTouchAction="none")}},mousemove:function(b){var c=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth;ig.ua.mobile&&(c=ig.system.realWidth);var c=ig.system.scale*(c/ig.system.realWidth),e={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());var d=b.touches?b.touches[0]:b;this.mouse.x=(d.clientX-e.left)/c;this.mouse.y=(d.clientY-e.top)/c;void 0!==typeof b.movementX?(this.move.x=b.movementX,
this.move.y=b.movementY):(this.move.x=0,this.move.y=0);try{ig.soundHandler.unlockWebAudio()}catch(g){}},keyup:function(b){var c=b.target.tagName;if(!("INPUT"==c||"TEXTAREA"==c)){if(c=this.bindings["keyup"==b.type?b.keyCode:2==b.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1])this.delayedKeyup[c]=!0,b.stopPropagation(),b.preventDefault();if(ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(e){}}}})});ig.baked=!0;
ig.module("plugins.data.vector").defines(function(){Vector2=ig.Class.extend({x:null,y:null,valType:"number",init:function(b,c){typeof b===this.valType&&typeof c===this.valType&&(this.x=b,this.y=c)},row:function(b){typeof b===this.valType&&(this.y=b);return this.y},col:function(b){typeof b===this.valType&&(this.x=b);return this.x},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},unitVector:function(){var b=this.magnitude();if(0<b)return new Vector2(this.x/b,this.y/b);throw"Divide by 0 error in unitVector function of vector:"+
this;},add:function(b){return new Vector2(this.x+b.x,this.y+b.y)},subtract:function(b){return new Vector2(this.x-b.x,this.y-b.y)},dotProduct:function(b){return this.x*b.x+this.y*b.y},multiplyByScalar:function(b){return new Vector2(b*this.x,b*this.y)}})});ig.baked=!0;
ig.module("plugins.data.color-rgb").defines(function(){ColorRGB=function(b,c,e,d){this.r=b||0;this.g=c||0;this.b=e||0;this.a=d||0};ColorRGB.prototype={setRandomColor:function(){this.r=Math.round(255*Math.random());this.g=Math.round(255*Math.random());this.b=Math.round(255*Math.random())},getStyle:function(){return"rgba("+this.r+","+this.g+","+this.b+","+this.a+")"},getHex:function(){for(var b=this.r.toString(16),c=this.g.toString(16),e=this.b.toString(16);2>b.length;)b="0"+b;for(;2>c.length;)c="0"+
c;for(;2>e.length;)e="0"+e;return"#"+b+c+e},getInvertedColor:function(){return new ColorRGB(255-this.r,255-this.g,255-this.b,255-this.a)},clone:function(){return new ColorRGB(this.r,this.g,this.b,this.a)}}});ig.baked=!0;
ig.module("plugins.font.font-info").requires("impact.impact").defines(function(){ig.FontInfo=ig.Class.extend({fonts:[{name:"mainfont",source:"media/fonts/mainfont"},{name:"contentfont",source:"media/fonts/contentfont"}],init:function(){this.registerCssFont()},getKeys:function(){for(var b={},c=0;c<this.fonts.length;c++){for(var e=this.fonts[c].name,d=e.split("-"),g="",f=0;f<d.length;f++)g+=d[f];b[g]=e}return b},registerCssFont:function(){if(0<this.fonts.length){var b=document.createElement("style");
b.type="text/css";for(var c="",e=0;e<this.fonts.length;e++)var d=this.fonts[e],c=c+("@font-face {font-family: '"+d.name+"';src: url('"+d.source+".eot');src: url('"+d.source+".eot?#iefix') format('embedded-opentype'),url('"+d.source+".woff2') format('woff2'),url('"+d.source+".woff') format('woff'),url('"+d.source+".ttf') format('truetype'),url('"+d.source+".svg#svgFontName') format('svg')}");b.appendChild(document.createTextNode(c));document.head.appendChild(b)}},isValid:function(){for(var b=0;b<this.fonts.length;b++)if(!this._isValidName(this.fonts[b].source))return!1;
return!0},_isValidName:function(b){return-1==b.search(/^[a-z0-9-\/]+$/)?!1:!0}})});ig.baked=!0;
ig.module("plugins.font.font-loader").requires("impact.impact","plugins.font.font-info","impact.loader").defines(function(){ig.FontLoader=ig.Class.extend({fontInfo:new ig.FontInfo,onload:!1,onerror:!1,init:function(b,c){this.onload=b;this.onerror=c},load:function(){this.fontInfo.isValid()?this._loadByLib():console.error("Only lowercased alphanumeric and dash are allowed for font file name!. Please check the font path")},_loadByLib:function(){for(var b=[],c=0;c<this.fontInfo.fonts.length;c++){var e=
new FontFaceObserver(this.fontInfo.fonts[c].name);b.push(e.load())}Promise.all(b).then(this.onload).catch(this.onerror)}});ig.Loader.inject({parentLoad:!1,load:function(){this.parentLoad=this.parent;this.fontLoader=(new ig.FontLoader(this.onFontLoad.bind(this),this.onFontError.bind(this))).load()},onFontLoad:function(){this.parentLoad()},onFontError:function(){console.error("Font is not loaded")}})});ig.baked=!0;
ig.module("plugins.handlers.dom-handler").defines(function(){ig.DomHandler=ig.Class.extend({version:"1.1.2",JQUERYAVAILABLE:!1,init:function(){this.JQUERYAVAILABLE=this._jqueryAvailable()},_jqueryAvailable:function(){return"undefined"!==typeof jQuery},addEvent:function(b,c,e,d){if(this.JQUERYAVAILABLE)b.on(c,e);else b.addEventListener(c,e,d)},create:function(b){return this.JQUERYAVAILABLE?$("<"+b+">"):ig.$new(b)},getElementByClass:function(b){return this.JQUERYAVAILABLE?$("."+b):document.getElementsByClassName(b)},
getElementById:function(b){return this.JQUERYAVAILABLE?0<$(b).length?$(b):null:ig.$(b)},appendChild:function(b,c){this.JQUERYAVAILABLE?b.append(c):b.appendChild(c)},appendToBody:function(b){this.JQUERYAVAILABLE?$("body").append(b):document.body.appendChild(b)},appendToHead:function(b){this.JQUERYAVAILABLE?$("head").append(b):document.head.appendChild(b)},removeChild:function(b,c){this.JQUERYAVAILABLE?b.remove(c):b.removeChild(c)},removeFromBody:function(b){this.JQUERYAVAILABLE?$(b).remove():document.body.removeChild(b)},
removeFromHead:function(b){this.JQUERYAVAILABLE?$(b).remove():document.head.removeChild(b)},text:function(b,c){this.JQUERYAVAILABLE?b.text(c):b.innerText=c},val:function(b,c){this.JQUERYAVAILABLE?b.val(c):b.value=c},getVal:function(b){return this.JQUERYAVAILABLE?b.val():b.value},getAttr:function(b,c){return this.JQUERYAVAILABLE?b.attr(c):b.getAttribute(c)},getText:function(b){return this.JQUERYAVAILABLE?b.text():b.innerText},html:function(b,c){this.JQUERYAVAILABLE?b.html(c):b.innerHTML=c},resize:function(b,
c,e){if(this.JQUERYAVAILABLE)b.width(c.toFixed(2)),b.height(e.toFixed(2));else{var d=b.style.visibility;c="width:"+c.toFixed(2)+"px; height:"+e.toFixed(2)+"px;";this.attr(b,"style",c);b.style.visibility=d}},resizeOffsetLeft:function(b,c,e,d){if(this.JQUERYAVAILABLE)b.width(c.toFixed(2)),b.height(e.toFixed(2)),b.css("left",d);else{var g=b.style.visibility;c="width:"+c.toFixed(2)+"px; height:"+e.toFixed(2)+"px; left: "+d.toFixed(2)+"px;";this.attr(b,"style",c);b.style.visibility=g}},resizeOffset:function(b,
c,e,d,g){if(this.JQUERYAVAILABLE)b.width(c.toFixed(2)),b.height(e.toFixed(2)),b.css("left",d),b.css("top",g);else{var f=b.style.visibility;c="width:"+c.toFixed(2)+"px; height:"+e.toFixed(2)+"px; left: "+d.toFixed(2)+"px; top: "+g.toFixed(2)+"px;";this.attr(b,"style",c);b.style.visibility=f}},css:function(b,c){if(this.JQUERYAVAILABLE)b.css(c);else{var e="",d;for(d in c)e+=d+":"+c[d]+";";this.attr(b,"style",e)}},getOffsets:function(b){return this.JQUERYAVAILABLE?(b=b.offset(),{left:b.left,top:b.top}):
{left:b.offsetLeft,top:b.offsetTop}},attr:function(b,c,e){if("undefined"===typeof e)return this.JQUERYAVAILABLE?b.attr(c):b.getAttribute(c);this.JQUERYAVAILABLE?b.attr(c,e):b.setAttribute(c,e)},show:function(b){b&&"undefined"!==typeof b&&(this.JQUERYAVAILABLE?(b.show(),b.css("visibility","visible")):b&&(b.style?b.style.visibility="visible":b[0]&&(b[0].style.visibility="visible")))},hide:function(b){b&&"undefined"!==typeof b&&(this.JQUERYAVAILABLE?(b.hide(),b.css("visibility","hidden")):b&&(b.style?
b.style.visibility="hidden":b[0]&&(b[0].style.visibility="hidden")))},getQueryVariable:function(b){for(var c=window.location.search.substring(1).split("&"),e=0;e<c.length;e++){var d=c[e].match(/([^=]+?)=(.+)/);if(d&&decodeURIComponent(d[1])==b)return decodeURIComponent(d[2])}},forcedDeviceDetection:function(){var b=this.getQueryVariable("device");if(b)switch(b){case "mobile":console.log("serving mobile version ...");ig.ua.mobile=!0;break;case "desktop":console.log("serving desktop version ...");ig.ua.mobile=
!1;break;default:console.log("serving universal version ...")}else console.log("serving universal version ...")},forcedDeviceRotation:function(){var b=this.getQueryVariable("force-rotate");if(b)switch(b){case "portrait":console.log("force rotate to portrait");window.orientation=0;break;case "landscape":console.log("force rotate to horizontal");window.orientation=90;break;default:alert("wrong command/type in param force-rotate. Defaulting value to portrait"),window.orientation=0}},setZIndex:function(b,
c){this.JQUERYAVAILABLE?b.css("zIndex",c):b&&(b.style?b.style.zIndex=c:b[0]&&(b[0].style.zIndex=c))}})});ig.baked=!0;
ig.module("plugins.handlers.size-handler").defines(function(){ig.SizeHandler=ig.Class.extend({portraitMode:!0,disableStretchToFitOnMobileFlag:!1,enableStretchToFitOnAntiPortraitModeFlag:!0,enableScalingLimitsOnMobileFlag:!1,minScalingOnMobile:0,maxScalingOnMobile:1,enableStretchToFitOnDesktopFlag:!1,enableScalingLimitsOnDesktopFlag:!1,minScalingOnDesktop:0,maxScalingOnDesktop:1,desktop:{actualSize:new BABYLON.Vector2(window.innerWidth,window.innerHeight),actualResolution:new BABYLON.Vector2(1080,
1920)},mobile:{actualSize:new BABYLON.Vector2(window.innerWidth,window.innerHeight),actualResolution:new BABYLON.Vector2(1080,1920)},windowSize:new BABYLON.Vector2(window.innerWidth,window.innerHeight),scaleRatioMultiplier:new BABYLON.Vector2(1,1),sizeRatio:new BABYLON.Vector2(1,1),scale:1,domHandler:null,dynamicClickableEntityDivs:{},coreDivsToResize:["#webglcanvas","#canvas","#play","#orientate"],adsToResize:{MobileAdInGamePreroll:{"box-width":_SETTINGS.Ad.Mobile.Preroll.Width+2,"box-height":_SETTINGS.Ad.Mobile.Preroll.Height+
20},MobileAdInGameEnd:{"box-width":_SETTINGS.Ad.Mobile.End.Width+2,"box-height":_SETTINGS.Ad.Mobile.End.Height+20},MobileAdInGamePreroll2:{"box-width":_SETTINGS.Ad.Mobile.Preroll.Width+2,"box-height":_SETTINGS.Ad.Mobile.Preroll.Height+20},MobileAdInGameEnd2:{"box-width":_SETTINGS.Ad.Mobile.End.Width+2,"box-height":_SETTINGS.Ad.Mobile.End.Height+20},MobileAdInGamePreroll3:{"box-width":_SETTINGS.Ad.Mobile.Preroll.Width+2,"box-height":_SETTINGS.Ad.Mobile.Preroll.Height+20},MobileAdInGameEnd3:{"box-width":_SETTINGS.Ad.Mobile.End.Width+
2,"box-height":_SETTINGS.Ad.Mobile.End.Height+20}},init:function(b){this.domHandler=b;if("undefined"===typeof b)throw"undefined Dom Handler for Size Handler";this.sizeCalcs();this.eventListenerSetup();this.samsungFix()},sizeCalcs:function(){this.windowSize=new Vector2(window.innerWidth,window.innerHeight);if(ig.ua.mobile){this.mobile.actualSize=new Vector2(window.innerWidth,window.innerHeight);var b=new Vector2(this.mobile.actualResolution.x,this.mobile.actualResolution.y);this.scaleRatioMultiplier=
new Vector2(this.mobile.actualSize.x/b.x,this.mobile.actualSize.y/b.y);if(this.disableStretchToFitOnMobileFlag){var c=Math.min(this.scaleRatioMultiplier.x,this.scaleRatioMultiplier.y);this.enableScalingLimitsOnMobileFlag&&(c=c.limit(this.minScalingOnMobile,this.maxScalingOnMobile));this.mobile.actualSize.x=b.x*c;this.mobile.actualSize.y=b.y*c;this.scaleRatioMultiplier.x=c;this.scaleRatioMultiplier.y=c}else this.sizeRatio.x=this.scaleRatioMultiplier.x,this.sizeRatio.y=this.scaleRatioMultiplier.y,this.scaleRatioMultiplier.x=
1,this.scaleRatioMultiplier.y=1}else this.desktop.actualSize=new Vector2(window.innerWidth,window.innerHeight),b=new Vector2(this.desktop.actualResolution.x,this.desktop.actualResolution.y),this.scaleRatioMultiplier=new Vector2(this.desktop.actualSize.x/b.x,this.desktop.actualSize.y/b.y),this.enableStretchToFitOnDesktopFlag?(this.sizeRatio.x=this.scaleRatioMultiplier.x,this.sizeRatio.y=this.scaleRatioMultiplier.y,this.scaleRatioMultiplier.x=1,this.scaleRatioMultiplier.y=1):(c=Math.min(this.scaleRatioMultiplier.x,
this.scaleRatioMultiplier.y),this.enableScalingLimitsOnDesktopFlag&&(c=c.limit(this.minScalingOnDesktop,this.maxScalingOnDesktop)),this.desktop.actualSize.x=b.x*c,this.desktop.actualSize.y=b.y*c,this.scaleRatioMultiplier.x=c,this.scaleRatioMultiplier.y=c)},resizeLayers:function(){for(var b=0;b<this.coreDivsToResize.length;b++){var c=ig.domHandler.getElementById(this.coreDivsToResize[b]);if(ig.ua.mobile)if(this.disableStretchToFitOnMobileFlag){var e=Math.floor(ig.sizeHandler.windowSize.x/2-ig.sizeHandler.mobile.actualSize.x/
2),d=Math.floor(ig.sizeHandler.windowSize.y/2-ig.sizeHandler.mobile.actualSize.y/2);0>e&&(e=0);0>d&&(d=0);ig.domHandler.resizeOffset(c,Math.floor(ig.sizeHandler.mobile.actualSize.x),Math.floor(ig.sizeHandler.mobile.actualSize.y),e,d);var g=!1;if(g=this.portraitMode?window.innerHeight<window.innerWidth:window.innerHeight>window.innerWidth)if(this.enableStretchToFitOnAntiPortraitModeFlag)ig.domHandler.resizeOffset(c,Math.floor(window.innerWidth),Math.floor(window.innerHeight),0,0);else{var g=new Vector2(window.innerWidth/
this.mobile.actualResolution.y,window.innerHeight/this.mobile.actualResolution.x),e=Math.min(g.x,g.y),g=this.mobile.actualResolution.y*e,f=this.mobile.actualResolution.x*e,e=Math.floor(ig.sizeHandler.windowSize.x/2-g/2),d=Math.floor(ig.sizeHandler.windowSize.y/2-f/2);0>e&&(e=0);0>d&&(d=0);ig.domHandler.resizeOffset(c,Math.floor(g),Math.floor(f),e,d)}}else ig.domHandler.resize(c,Math.floor(ig.sizeHandler.mobile.actualSize.x),Math.floor(ig.sizeHandler.mobile.actualSize.y));else this.enableStretchToFitOnDesktopFlag?
ig.domHandler.resize(c,Math.floor(ig.sizeHandler.desktop.actualSize.x),Math.floor(ig.sizeHandler.desktop.actualSize.y)):(e=Math.floor(ig.sizeHandler.windowSize.x/2-ig.sizeHandler.desktop.actualSize.x/2),d=Math.floor(ig.sizeHandler.windowSize.y/2-ig.sizeHandler.desktop.actualSize.y/2),0>e&&(e=0),0>d&&(d=0),ig.domHandler.resizeOffset(c,Math.floor(ig.sizeHandler.desktop.actualSize.x),Math.floor(ig.sizeHandler.desktop.actualSize.y),e,d))}for(var m in this.adsToResize)b=ig.domHandler.getElementById("#"+
m),c=ig.domHandler.getElementById("#"+m+"-Box"),g=(window.innerWidth-this.adsToResize[m]["box-width"])/2+"px",e=(window.innerHeight-this.adsToResize[m]["box-height"])/2+"px",b&&ig.domHandler.css(b,{width:window.innerWidth,height:window.innerHeight}),c&&ig.domHandler.css(c,{left:g,top:e});b=ig.domHandler.getElementById("#canvas");c=ig.domHandler.getOffsets(b);b=c.left;c=c.top;g=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);for(m in this.dynamicClickableEntityDivs){e=
ig.domHandler.getElementById("#"+m);if(ig.ua.mobile){var f=this.dynamicClickableEntityDivs[m].entity_pos_x,l=this.dynamicClickableEntityDivs[m].entity_pos_y,j=this.dynamicClickableEntityDivs[m].width,d=this.dynamicClickableEntityDivs[m].height;this.disableStretchToFitOnMobileFlag?(f=Math.floor(b+f*this.scaleRatioMultiplier.x)+"px",l=Math.floor(c+l*this.scaleRatioMultiplier.y)+"px",j=Math.floor(j*this.scaleRatioMultiplier.x)+"px",d=Math.floor(d*this.scaleRatioMultiplier.y)+"px"):(f=Math.floor(f*this.sizeRatio.x)+
"px",l=Math.floor(l*this.sizeRatio.y)+"px",j=Math.floor(j*this.sizeRatio.x)+"px",d=Math.floor(d*this.sizeRatio.y)+"px")}else f=this.dynamicClickableEntityDivs[m].entity_pos_x,l=this.dynamicClickableEntityDivs[m].entity_pos_y,j=this.dynamicClickableEntityDivs[m].width,d=this.dynamicClickableEntityDivs[m].height,this.enableStretchToFitOnDesktopFlag?(f=Math.floor(f*this.sizeRatio.x)+"px",l=Math.floor(l*this.sizeRatio.y)+"px",j=Math.floor(j*this.sizeRatio.x)+"px",d=Math.floor(d*this.sizeRatio.y)+"px"):
(f=Math.floor(b+f*this.scaleRatioMultiplier.x)+"px",l=Math.floor(c+l*this.scaleRatioMultiplier.y)+"px",j=Math.floor(j*this.scaleRatioMultiplier.x)+"px",d=Math.floor(d*this.scaleRatioMultiplier.y)+"px");ig.domHandler.css(e,{"float":"left",position:"absolute",left:f,top:l,width:j,height:d,"z-index":3});this.dynamicClickableEntityDivs[m]["font-size"]&&ig.domHandler.css(e,{"font-size":this.dynamicClickableEntityDivs[m]["font-size"]*g+"px"})}$("#ajaxbar").width(this.windowSize.x);$("#ajaxbar").height(this.windowSize.y)},
resize:function(){this.sizeCalcs();this.resizeLayers()},reorient:function(){console.log("changing orientation ...");if(ig.ua.mobile){var b=!1,b=this.portraitMode?window.innerHeight<window.innerWidth:window.innerHeight>window.innerWidth,c=this.domHandler.getElementById("#orientate"),e=this.domHandler.getElementById("#game");b?(this.domHandler.show(c),this.domHandler.hide(e),console.log("portrait"+window.innerWidth+","+window.innerHeight)):(this.domHandler.show(e),this.domHandler.hide(c),console.log("landscape"+
window.innerWidth+","+window.innerHeight))}ig.ua.mobile?(this.resize(),this.resizeAds()):this.resize()},resizeAds:function(){for(var b in this.adsToResize){var c=ig.domHandler.getElementById("#"+b),e=ig.domHandler.getElementById("#"+b+"-Box"),d=(window.innerWidth-this.adsToResize[b]["box-width"]>>1)+"px",g=(window.innerHeight-this.adsToResize[b]["box-height"]>>1)+"px";c&&ig.domHandler.css(c,{width:window.innerWidth,height:window.innerHeight});e&&ig.domHandler.css(e,{left:d,top:g})}},samsungFix:function(){ig.ua.android&&
(!(4.2>parseFloat(navigator.userAgent.slice(navigator.userAgent.indexOf("Android")+8,navigator.userAgent.indexOf("Android")+11)))&&!(0>navigator.userAgent.indexOf("GT"))&&!(0<navigator.userAgent.indexOf("Chrome"))&&!(0<navigator.userAgent.indexOf("Firefox")))&&(document.addEventListener("touchstart",function(b){b.preventDefault();return!1},!1),document.addEventListener("touchmove",function(b){b.preventDefault();return!1},!1),document.addEventListener("touchend",function(b){b.preventDefault();return!1},
!1))},orientationInterval:null,orientationTimeout:null,orientationHandler:function(){this.reorient();window.scrollTo(0,1)},orientationDelayHandler:function(){null==this.orientationInterval&&(this.orientationInterval=window.setInterval(this.orientationHandler.bind(this),100));null==this.orientationTimeout&&(this.orientationTimeout=window.setTimeout(function(){this.clearAllIntervals()}.bind(this),2E3))},clearAllIntervals:function(){window.clearInterval(this.orientationInterval);this.orientationInterval=
null;window.clearTimeout(this.orientationTimeout);this.orientationTimeout=null},eventListenerSetup:function(){ig.isXiaomiBrowser=/XiaoMi/i.test(navigator.userAgent)||/MiuiBrowser/i.test(navigator.userAgent)||/Mint/i.test(navigator.userAgent);ig.ua.iOS||ig.isXiaomiBrowser?(window.addEventListener("orientationchange",this.orientationDelayHandler.bind(this)),window.addEventListener("resize",this.orientationDelayHandler.bind(this))):(window.addEventListener("orientationchange",this.orientationHandler.bind(this)),
window.addEventListener("resize",this.orientationHandler.bind(this)));document.ontouchmove=function(){window.scrollTo(0,1)};this.chromePullDownRefreshFix()},chromePullDownRefreshFix:function(){var b=window.chrome||navigator.userAgent.match("CriOS"),c="ontouchstart"in document.documentElement;if(b&&c){var e=b=!1,d=0,g=!1;try{CSS.supports("overscroll-behavior-y","contain")&&(b=!0)}catch(f){}try{if(b)return document.body.style.overscrollBehaviorY="contain"}catch(m){}b=document.head||document.body;c=
document.createElement("style");c.type="text/css";c.styleSheet?c.styleSheet.cssText="\n      ::-webkit-scrollbar {\n        width: 500x;\n      }\n      ::-webkit-scrollbar-thumb {\n        border-radius: 500px;\n        background-color: rgba(0, 0, 0, 0.2);\n      }\n      body {\n        -webkit-overflow-scrolling: auto!important;\n      }\n    ":c.appendChild(document.createTextNode("\n      ::-webkit-scrollbar {\n        width: 500px;\n      }\n      ::-webkit-scrollbar-thumb {\n        border-radius: 500px;\n        background-color: rgba(0, 0, 0, 0.2);\n      }\n      body {\n        -webkit-overflow-scrolling: auto!important;\n      }\n    "));
b.appendChild(c);try{addEventListener("test",null,{get passive(){e=!0}})}catch(l){}document.addEventListener("touchstart",function(b){1===b.touches.length&&(d=b.touches[0].clientY,g=0===window.pageYOffset)},!!e&&{passive:!0});document.addEventListener("touchmove",function(b){var c;if(c=g){g=!1;c=b.touches[0].clientY;var e=c-d;c=(d=c,0<e)}if(c)return b.preventDefault()},!!e&&{passive:!1})}}})});ig.baked=!0;
ig.module("plugins.handlers.api-handler").defines(function(){ig.ApiHandler=ig.Class.extend({apiAvailable:{MJSPreroll:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS&&_SETTINGS.Ad.Mobile.Preroll.Enabled&&MobileAdInGamePreroll.Initialize()},MJSHeader:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS.Ad.Mobile.Header.Enabled&&MobileAdInGameHeader.Initialize()},MJSFooter:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS.Ad.Mobile.Footer.Enabled&&MobileAdInGameFooter.Initialize()},
MJSEnd:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS.Ad.Mobile.End.Enabled&&MobileAdInGameEnd.Initialize()}},run:function(b,c){if(this.apiAvailable[b])this.apiAvailable[b](c)}})});ig.baked=!0;
ig.module("plugins.audio.sound-player").defines(function(){SoundPlayer=ig.Class.extend({tagName:"SoundPlayer",stayMuteFlag:!1,debug:!1,init:function(){this.debug&&console.log(this.tagName)},play:function(b){this.debug&&console.log("play sound ",b)},stop:function(){this.debug&&console.log("stop sound ")},volume:function(){this.debug&&console.log("set volume")},mute:function(b){this.debug&&console.log("mute");"undefined"===typeof b?this.stayMuteFlag=!0:b&&(this.stayMuteFlag=!0)},unmute:function(b){this.debug&&
console.log("unmute");"undefined"===typeof b?this.stayMuteFlag=!1:b&&(this.stayMuteFlag=!1)}})});ig.baked=!0;
ig.module("plugins.audio.impact-music-player").requires("plugins.audio.sound-player").defines(function(){ImpactMusicPlayer=SoundPlayer.extend({tagName:"ImpactMusicPlayer",bgmPlaying:!1,soundList:{},init:function(b,c){this.parent(b,c);for(var e in b)this.soundList[e]=e,ig.music.add(b[e].path+".*",e);c&&c.loop&&(ig.music.loop=c.loop)},play:function(b){this.stayMuteFlag||(this.bgmPlaying=!0,"undefined"===typeof b?ig.music.play(b):ig.music.play())},stop:function(){this.bgmPlaying=!1;ig.music.pause()},
volume:function(b){console.log("impactmusic:",b);ig.music.volume=0>b?0:isNaN(b)?1:1<b?1:b},getVolume:function(){return ig.music.volume},mute:function(b){this.parent(b);this.bgmPlaying&&this.stop()},unmute:function(b){this.parent(b);this.play()}})});ig.baked=!0;
ig.module("plugins.audio.impact-sound-player").requires("plugins.audio.sound-player").defines(function(){ImpactSoundPlayer=SoundPlayer.extend({tagName:"ImpactSoundPlayer",soundList:{},init:function(b,c){this.parent(b,c);for(var e in b){var d=new ig.Sound(b[e].path+".*");this.soundList[e]=d}},play:function(b){this.stayMuteFlag||("object"===typeof b?(console.log(b+" exists"),b.play()):"string"===typeof b&&this.soundList[b].play())},stop:function(b){this.parent(b);b.stop()},volume:function(b){ig.soundManager.volume=
0>b?0:isNaN(b)?1:1<b?1:b},getVolume:function(){return ig.soundManager.volume},mute:function(b){this.parent(b);ig.Sound.enabled=!1},unmute:function(b){this.parent(b);ig.Sound.enabled=!0}})});ig.baked=!0;
ig.module("plugins.audio.howler-player").requires("plugins.audio.sound-player").defines(function(){HowlerPlayer=SoundPlayer.extend({tagName:"HowlerPlayer",soundList:{},init:function(b,c){this.parent(b,c);for(var e in b){var d=b[e].path,d=new Howl({src:[d+"."+ig.Sound.FORMAT.OGG.ext,d+"."+ig.Sound.FORMAT.MP3.ext]});this.soundList[e]=d}},play:function(b){if(Howler.ctx&&"running"!==Howler.ctx.state)return Howler.ctx.resume();this.stayMuteFlag||("object"===typeof b?b.play():"string"===typeof b&&this.soundList[b].play())},
stop:function(b){this.parent(b);"object"===typeof b?b.stop():"string"===typeof b&&this.soundList[b].stop()},volume:function(b){for(var c in this.soundList){if(0>b){this.soundList[c].volume(0);break}isNaN(b)?this.soundList[c].volume(1):1<b?this.soundList[c].volume(1):this.soundList[c].volume(b)}},getVolume:function(){for(var b in this.soundList)return this.soundList[b].volume()},mute:function(b){this.parent(b);Howler.mute(!0)},unmute:function(b){this.parent(b);Howler.mute(!1)}})});ig.baked=!0;
ig.module("plugins.audio.howler-music-player").requires("plugins.audio.sound-player").defines(function(){HowlerMusicPlayer=SoundPlayer.extend({tagName:"HowlerMusicPlayer",bgmPlaying:!1,soundList:{},init:function(b,c){this.parent(b,c);for(var e in b){var d=b[e].path,d=new Howl({src:[d+"."+ig.Sound.FORMAT.OGG.ext,d+"."+ig.Sound.FORMAT.MP3.ext],loop:!0,autoplay:!1,onend:function(){}.bind(this)});this.soundList[e]=d}},play:function(b){if(!this.stayMuteFlag&&!this.bgmPlaying)if("object"===typeof b)this.bgmPlaying=
!0,b.play();else if("string"===typeof b)this.bgmPlaying=!0,this.soundList[b].play();else for(var c in this.soundList){this.soundList[c].play();this.bgmPlaying=!0;break}},stop:function(b){this.parent(b);if(this.bgmPlaying){for(var c in this.soundList)this.soundList[c].stop();this.bgmPlaying=!1}},volume:function(b){for(var c in this.soundList){if(0>b){this.soundList[c].volume(0);break}isNaN(b)?this.soundList[c].volume(1):1<b?this.soundList[c].volume(1):this.soundList[c].volume(b)}},getVolume:function(){for(var b in this.soundList)return this.soundList[b].volume()},
mute:function(b){this.parent(b);Howler.mute(!0)},unmute:function(b){this.parent(b);Howler.mute(!1)}})});ig.baked=!0;
ig.module("plugins.audio.jukebox-player").requires("plugins.audio.sound-player").defines(function(){JukeboxPlayer=SoundPlayer.extend({tagName:"JukeboxPlayer",bgmPlaying:!1,soundList:{},jukeboxPlayer:null,pausePosition:0,premuteVolume:0,minVolume:0.001,init:function(b,c){this.parent(b,c);for(var e in b){this.soundList[e]=e;var d=b[e].path;this.jukeboxPlayer=new jukebox.Player({resources:[d+"."+ig.Sound.FORMAT.OGG.ext,d+"."+ig.Sound.FORMAT.MP3.ext],autoplay:!1,spritemap:{music:{start:b[e].startMp3,
end:b[e].endMp3,loop:!0}}})}},play:function(){this.stayMuteFlag||(this.bgmPlaying=!0,this.pausePosition?(console.log("resume"),this.jukeboxPlayer.resume(this.pausePosition)):(console.log("play"),this.jukeboxPlayer.play(this.jukeboxPlayer.settings.spritemap.music.start,!0)),this.premuteVolume=this.getVolume())},stop:function(){this.bgmPlaying=!1;this.pausePosition=this.jukeboxPlayer.pause()},volume:function(b){console.log("jukebox:",b);0>=b?this.jukeboxPlayer.setVolume(this.minVolume):isNaN(b)?this.jukeboxPlayer.setVolume(1):
1<b?this.jukeboxPlayer.setVolume(1):this.jukeboxPlayer.setVolume(b)},getVolume:function(){return this.jukeboxPlayer.getVolume()},mute:function(b){this.parent(b);this.bgmPlaying&&(console.log("jukebox",this.premuteVolume),this.stayMuteFlag||(this.premuteVolume=this.getVolume()),this.jukeboxPlayer.pause(),this.jukeboxPlayer.setVolume(this.minVolume))},unmute:function(b){this.parent(b);this.stayMuteFlag||(console.log("jukebox",this.premuteVolume),this.jukeboxPlayer.setVolume(this.premuteVolume),this.jukeboxPlayer.resume())}})});
ig.baked=!0;
ig.module("plugins.audio.webaudio-music-player").requires("plugins.audio.sound-player").defines(function(){WebaudioMusicPlayer=SoundPlayer.extend({tagName:"WebaudioMusicPlayer",bgmPlaying:!1,isSupported:!1,muteFlag:!1,pausedTime:0,webaudio:null,useHTML5Audio:!1,audio:null,inactiveAudio:null,codecs:null,reinitOnPlay:!1,inputList:null,_volume:1,soundList:{},init:function(b){this.webaudio={compatibility:{},gainNode:null,buffer:null,source_loop:{},source_once:{}};try{Howler&&Howler.ctx?this.webaudio.context=Howler.ctx:
ig&&ig.webaudio_ctx?this.webaudio.context=ig.webaudio_ctx:(this.AudioContext=window.AudioContext||window.webkitAudioContext,this.webaudio.context=new this.AudioContext,ig.webaudio_ctx=this.webaudio.context),this.isSupported=!0}catch(c){console.log("Web Audio API not supported in this browser."),this.webaudio=null,this.useHTML5Audio=!0}if(this.useHTML5Audio)if("undefined"!==typeof Audio)try{new Audio}catch(e){this.useHTML5Audio=!1}else this.useHTML5Audio=!1;this.useHTML5Audio&&(this.audio=new Audio,
this.isSupported=!0,this.initHTML5Audio(b));if(!this.isSupported)return null;this.webaudio&&(this.inputList=b,this.initWebAudio(b))},initWebAudio:function(b){ig.ua.iOS&&this.initIOSWebAudioUnlock();this.webaudio.gainNode=this.webaudio.context.createGain();this.webaudio.gainNode.connect(this.webaudio.context.destination);this.webaudio.gainNode.gain.value=this._volume;this.webaudio.buffer=null;var c="start",e="stop",d=this.webaudio.context.createBufferSource();"function"!==typeof d.start&&(c="noteOn");
this.webaudio.compatibility.start=c;"function"!==typeof d.stop&&(e="noteOff");this.webaudio.compatibility.stop=e;for(var g in b){this.soundList[g]=g;var e=b[g].path,c=e+"."+ig.Sound.FORMAT.MP3.ext,f=e+"."+ig.Sound.FORMAT.OGG.ext;ig.ua.mobile?ig.ua.iOS&&(f=c):(e=navigator.userAgent.toLowerCase(),-1!=e.indexOf("safari")&&-1>=e.indexOf("chrome")&&(f=c),e.indexOf("win64")&&(f=c));var m=new XMLHttpRequest;m.open("GET",f,!0);m.responseType="arraybuffer";m.onload=function(){this.webaudio.context.decodeAudioData(m.response,
function(b){this.webaudio.buffer=b;this.webaudio.source_loop={};this.bgmPlaying?this.play(null,!0):this.stop()}.bind(this),function(){console.log('Error decoding audio "'+f+'".')})}.bind(this);m.send();if(4==m.readyState&&"undefined"!==typeof Audio){this.useHTML5Audio=!0;try{new Audio}catch(l){this.useHTML5Audio=!1}this.useHTML5Audio&&(console.log("Using HTML5 Audio"),this.webaudio=null,this.audio=new Audio,this.isSupported=!0,this.initHTML5Audio(b))}break}},initIOSWebAudioUnlock:function(){if(this.webaudio){webaudio=
this.webaudio;var b=function(){var c=webaudio.context,e=c.createBuffer(1,1,22050),d=c.createBufferSource();d.buffer=e;d.connect(c.destination);"undefined"===typeof d.start?d.noteOn(0):d.start(0);setTimeout(function(){(d.playbackState===d.PLAYING_STATE||d.playbackState===d.FINISHED_STATE)&&window.removeEventListener("touchend",b,!1)}.bind(this),0)};window.addEventListener("touchend",b,!1)}},initHTML5Audio:function(b){if(this.useHTML5Audio&&this.audio){var c=this.audio;this.codecs={};this.codecs={mp3:!!c.canPlayType("audio/mpeg;").replace(/^no$/,
""),opus:!!c.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!c.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!c.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!c.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(c.canPlayType("audio/x-m4a;")||c.canPlayType("audio/m4a;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(c.canPlayType("audio/x-mp4;")||c.canPlayType("audio/mp4;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!c.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,
"")};this.is={ff:Boolean(null!=window.mozInnerScreenX&&/firefox/.test(navigator.userAgent.toLowerCase())),ie:Boolean(document.all&&!window.opera),opera:Boolean(window.opera),chrome:Boolean(window.chrome),safari:Boolean(!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase())&&window.getComputedStyle&&!window.globalStorage&&!window.opera)};this.playDelay=-60;this.stopDelay=30;this.is.chrome&&(this.playDelay=-25);this.is.chrome&&(this.stopDelay=25);this.is.ff&&(this.playDelay=-25);this.is.ff&&
(this.stopDelay=85);this.is.opera&&(this.playDelay=5);this.is.opera&&(this.stopDelay=0);for(var e in b){this.soundList[e]=e;var d=b[e].path,c=d+"."+ig.Sound.FORMAT.OGG.ext,d=d+"."+ig.Sound.FORMAT.MP3.ext,g=null;this.codecs[ig.Sound.FORMAT.OGG.ext.toLowerCase()]?g=c:this.codecs[ig.Sound.FORMAT.MP3.ext.toLowerCase()]&&(g=d);if(g){ig.ua.mobile?ig.ua.iOS&&(g=d):(b=navigator.userAgent.toLowerCase(),-1!=b.indexOf("safari")&&-1>=b.indexOf("chrome")&&(g=d));this.audio.addEventListener("error",function(){this.audio.error&&
4===this.audio.error.code&&(this.isSupported=!1)},!1);this.audio.src=g;this.audio._pos=0;this.audio.preload="auto";this.audio.volume=this._volume;this.inactiveAudio=new Audio;this.inactiveAudio.src=g;this.inactiveAudio._pos=0;this.inactiveAudio.preload="auto";this.inactiveAudio.volume=this._volume;this.inactiveAudio.load();var f=function(){this._duration=this.audio.duration;this._loaded||(this._loaded=!0);this.bgmPlaying?this.play(null,!0):this.stop();this.audio.removeEventListener("canplaythrough",
f,!1)}.bind(this);this.audio.addEventListener("canplaythrough",f,!1);this.audio.load();break}}}},play:function(b,c){if(this.isSupported)if(this.bgmPlaying=!0,this.webaudio){if(!c&&this.reinitOnPlay&&this.webaudio.source_loop.buffer==this.webaudio.buffer){if(this.webaudio.source_loop._playing&&(this.webaudio.source_loop[this.webaudio.compatibility.stop](0),this.webaudio.source_loop._playing=!1,this.pausedTime+=this.webaudio.context.currentTime-this.webaudio.source_loop._startTime,this.pausedTime%=
this.webaudio.source_loop.buffer.duration,this.webaudio.source_loop._startTime=0,"noteOn"===this.webaudio.compatibility.start))this.webaudio.source_once[this.webaudio.compatibility.stop](0);try{this.webaudio.context.close();this.webaudio.context=new this.AudioContext;this.webaudio.gainNode=this.webaudio.context.createGain();this.webaudio.gainNode.connect(this.webaudio.context.destination);this.webaudio.gainNode.gain.value=this._volume;var e="start",d="stop",g=this.webaudio.context.createBufferSource();
"function"!==typeof g.start&&(e="noteOn");this.webaudio.compatibility.start=e;"function"!==typeof g.stop&&(d="noteOff");this.webaudio.compatibility.stop=d;this.webaudio.source_loop={};this.play(null,!0)}catch(f){}}if(this.webaudio.buffer){if(!this.muteFlag&&(this.bgmPlaying=!0,!this.webaudio.source_loop._playing)){this.webaudio.source_loop=this.webaudio.context.createBufferSource();this.webaudio.source_loop.buffer=this.webaudio.buffer;this.webaudio.source_loop.loop=!0;this.webaudio.source_loop.connect(this.webaudio.gainNode);
if(null==b||isNaN(b))b=0,this.pausedTime&&(b=this.pausedTime);this.webaudio.source_loop._startTime=this.webaudio.context.currentTime;if("noteOn"===this.webaudio.compatibility.start)this.webaudio.source_once=this.webaudio.context.createBufferSource(),this.webaudio.source_once.buffer=this.webaudio.buffer,this.webaudio.source_once.connect(this.webaudio.gainNode),this.webaudio.source_once.noteGrainOn(0,b,this.webaudio.buffer.duration-b),this.webaudio.source_loop[this.webaudio.compatibility.start](this.webaudio.context.currentTime+
(this.webaudio.buffer.duration-b));else this.webaudio.source_loop[this.webaudio.compatibility.start](0,b);this.webaudio.source_loop._playing=!0}}else this.bgmPlaying=!0}else if(this.audio){var m=this.audio;if(!this.muteFlag)if(this.bgmPlaying=!0,isNaN(b)&&(b=0,this.pausedTime&&(b=this.pausedTime)),e=this._duration-b,this._onEndTimer&&(clearTimeout(this._onEndTimer),this._onEndTimer=null),this._onEndTimer=setTimeout(function(){this.audio.currentTime=0;this.audio.pause();this.pausedTime=0;if(this.inactiveAudio){var b=
this.audio;this.audio=this.inactiveAudio;this.inactiveAudio=b}this.play()}.bind(this),1E3*e+this.playDelay),4===m.readyState||!m.readyState&&navigator.isCocoonJS)m.readyState=4,m.currentTime=b,m.muted=this.muteFlag||m.muted,m.volume=this._volume,setTimeout(function(){m.play()},0);else{clearTimeout(this._onEndTimer);this._onEndTimer=null;var l=function(){typeof("function"==this.play)&&(this.play(),m.removeEventListener("canplaythrough",l,!1))}.bind(this);m.addEventListener("canplaythrough",l,!1)}}},
stop:function(){this.bgmPlaying=!1;if(this.isSupported)if(this.webaudio){if(this.webaudio.source_loop._playing&&(this.webaudio.source_loop[this.webaudio.compatibility.stop](0),this.webaudio.source_loop._playing=!1,this.pausedTime+=this.webaudio.context.currentTime-this.webaudio.source_loop._startTime,this.pausedTime%=this.webaudio.source_loop.buffer.duration,this.webaudio.source_loop._startTime=0,"noteOn"===this.webaudio.compatibility.start))this.webaudio.source_once[this.webaudio.compatibility.stop](0)}else if(this.audio){var b=
this.audio;4==b.readyState&&(this.pausedTime=b.currentTime,b.currentTime=0,b.pause(),clearTimeout(this._onEndTimer),this._onEndTimer=null)}},volume:function(b){if(isNaN(b)||null==b)return this.getVolume();this.isSupported&&(this._volume=b,0>this._volume?this._volume=0:1<this._volume&&(this._volume=1),this.webaudio?this.webaudio.gainNode&&(this.webaudio.gainNode.gain.value=this._volume):this.audio&&(this.audio.volume=this._volume,this.inactiveAudio&&(this.inactiveAudio.volume=this._volume)))},getVolume:function(){return!this.isSupported?
0:this._volume},mute:function(b){this.parent(b);!1==this.muteFlag&&(this.muteFlag=!0,this.bgmPlaying&&(this.stop(),this.bgmPlaying=!0))},unmute:function(b){this.parent(b);!this.stayMuteFlag&&!0==this.muteFlag&&(this.muteFlag=!1,this.bgmPlaying&&this.play())}})});ig.baked=!0;
ig.module("plugins.audio.sound-info").defines(function(){SoundInfo=ig.Class.extend({FORMATS:{OGG:".ogg",MP3:".mp3"},sfx:{staticSound:{path:"media/audio/play/static"},logosplash1:{path:"media/audio/opening/logosplash1"},logosplash2:{path:"media/audio/opening/logosplash2"},bgmMainMenu:{path:"media/audio/bgm-mainmenu"},crowdApplause:{path:"media/audio/crowd-applause"},crowdCheers:{path:"media/audio/crowd-cheers"},crowdMiss:{path:"media/audio/crowd-miss"},flight:{path:"media/audio/flight"},scoreHigh:{path:"media/audio/score-high"},
scoreLow:{path:"media/audio/score-low"},scoreMiss:{path:"media/audio/score-miss"},arrowLand1:{path:"media/audio/arrow-land-1"},arrowLand2:{path:"media/audio/arrow-land-2"},arrowLand3:{path:"media/audio/arrow-land-3"},arrowLand4:{path:"media/audio/arrow-land-4"},arrowLand5:{path:"media/audio/arrow-land-5"},bowDraw1:{path:"media/audio/bow-draw-1"},bowDraw2:{path:"media/audio/bow-draw-2"},bowDraw3:{path:"media/audio/bow-draw-3"},bowDraw4:{path:"media/audio/bow-draw-4"},bowDraw5:{path:"media/audio/bow-draw-5"},
bowRelease1:{path:"media/audio/bow-release-1"},bowRelease2:{path:"media/audio/bow-release-2"},bowRelease3:{path:"media/audio/bow-release-3"},bowRelease4:{path:"media/audio/bow-release-4"},bowRelease5:{path:"media/audio/bow-release-5"},click:{path:"media/audio/click"}},bgm:{background:{path:"media/audio/bgm"}}})});ig.baked=!0;
ig.module("plugins.audio.sound-handler").requires("plugins.audio.impact-music-player","plugins.audio.impact-sound-player","plugins.audio.howler-player","plugins.audio.howler-music-player","plugins.audio.jukebox-player","plugins.audio.webaudio-music-player","plugins.audio.sound-info").defines(function(){ig.SoundHandler=ig.Class.extend({bgmPlayer:null,sfxPlayer:null,focusBlurMute:!1,soundInfo:new SoundInfo,init:function(){console.log("Initiating sound handler");this.sfxPlayer=new HowlerPlayer(this.soundInfo.sfx);
ig.ua.mobile?(this.initPowerButtonFix(),this.bgmPlayer=new WebaudioMusicPlayer(this.soundInfo.bgm,{loop:!0}),this.bgmPlayer.isSupported||(this.bgmPlayer=new JukeboxPlayer(this.soundInfo.bgm,{loop:!0}))):(this.bgmPlayer=new WebaudioMusicPlayer(this.soundInfo.bgm,{loop:!0}),this.bgmPlayer.isSupported||(this.bgmPlayer=new ImpactMusicPlayer(this.soundInfo.bgm,{loop:!0})))},unlockWebAudio:function(){Howler&&(Howler.ctx&&"running"!==Howler.ctx.state&&Howler.ctx.resume(),Howler._audioUnlocked||"function"===
typeof Howler._unlockAudio&&Howler._unlockAudio());ig&&ig.webaudio_ctx&&ig.webaudio_ctx.state&&"running"!==ig.webaudio_ctx.state&&ig.webaudio_ctx.resume();this.bgmPlayer.webaudio&&this.bgmPlayer.webaudio.context&&this.bgmPlayer.webaudio.context.state&&"running"!==this.bgmPlayer.webaudio.context.state&&this.bgmPlayer.webaudio.context.resume()},checkBGM:function(){return this.bgmPlayer.stayMuteFlag},checkSFX:function(){return this.sfxPlayer.stayMuteFlag},muteSFX:function(b){this.sfxPlayer&&this.sfxPlayer.mute(b)},
muteBGM:function(b){this.bgmPlayer&&this.bgmPlayer.mute(b)},unmuteSFX:function(b){this.sfxPlayer&&this.sfxPlayer.unmute(b)},unmuteBGM:function(b){this.bgmPlayer&&this.bgmPlayer.unmute(b)},muteAll:function(b){this.muteSFX(b);this.muteBGM(b)},unmuteAll:function(b){this.unlockWebAudio();this.unmuteSFX(b);this.unmuteBGM(b)},forceMuteAll:function(){this.focusBlurMute||this.muteAll(!1);this.focusBlurMute=!0},forceUnMuteAll:function(){this.focusBlurMute&&(this.unmuteAll(!1),this.focusBlurMute=!1)},initWindowHandler:function(){"true"===
ig.domHandler.getQueryVariable("webview")?($(window).focus(function(){wgl.system&&wgl.system.startRender();ig.soundHandler&&ig.soundHandler.forceUnMuteAll()}),$(window).blur(function(){wgl.system&&wgl.system.stopRender();ig.soundHandler&&ig.soundHandler.forceMuteAll()})):(window.onfocus=function(){wgl.system&&wgl.system.startRender();ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},window.onblur=function(){wgl.system&&wgl.system.stopRender();ig.soundHandler&&ig.soundHandler.forceMuteAll()})},initPowerButtonFix:function(){var b=
this.getHiddenProp();b&&(b=b.replace(/[H|h]idden/,"")+"visibilitychange",document.addEventListener(b,this.visChange));window.addEventListener("pagehide",function(){ig.soundHandler&&ig.soundHandler.forceMuteAll()},!1);window.addEventListener("pageshow",function(){ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},!1)},getHiddenProp:function(){var b=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var c=0;c<b.length;c++)if(b[c]+"Hidden"in document)return b[c]+"Hidden";return null},
isHidden:function(){var b=this.getHiddenProp();return!b?!1:document[b]},visChange:function(){ig.soundHandler.isHidden()?ig.soundHandler&&ig.soundHandler.forceMuteAll():ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},saveVolume:function(){this.sfxPlayer&&ig.game.io.storageSet("soundVolume",this.sfxPlayer.getVolume());this.bgmPlayer&&ig.game.io.storageSet("musicVolume",this.bgmPlayer.getVolume())},forceLoopBGM:function(){var b;if(!this.focusBlurMute&&this.bgmPlayer.bgmPlaying&&this.bgmPlayer){var c=
this.bgmPlayer.jukeboxPlayer;if(c){null!=window.mozInnerScreenX&&/firefox/.test(navigator.userAgent.toLowerCase());b=Boolean(window.chrome);!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase());var e=0.1;ig.ua.mobile&&(e=0.115,ig.ua.android&&(e=0.45,b&&(e=0.3)));c.settings.spritemap.music&&(b=c.settings.spritemap.music.end-e,c.getCurrentTime()>=b&&(b=c.settings.spritemap.music.start,ig.ua.android?this.forcelooped||(c.play(b,!0),this.forcelooped=!0,setTimeout(function(){ig.soundHandler.forcelooped=
!1},e)):c.setCurrentTime(b)))}else"ImpactMusicPlayer"==this.bgmPlayer.tagName&&(null!=window.mozInnerScreenX&&/firefox/.test(navigator.userAgent.toLowerCase()),b=Boolean(window.chrome),!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase()),e=0.1,ig.ua.mobile&&(e=0.115,ig.ua.android&&(e=0.45,b&&(e=0.3))),c=0,"mp3"==ig.soundManager.format.ext&&(c=0.05),ig.music.currentTrack&&(b=ig.music.currentTrack.duration-e,ig.music.currentTrack.currentTime>=b&&(ig.ua.android?this.forcelooped||(ig.music.currentTrack.pause(),
ig.music.currentTrack.currentTime=c,ig.music.currentTrack.play(),this.forcelooped=!0,setTimeout(function(){ig.soundHandler.forcelooped=!1},e)):ig.music.currentTrack.currentTime=c)))}}})});ig.baked=!0;
ig.module("plugins.handlers.visibility-handler").requires("plugins.audio.sound-handler").defines(function(){ig.VisibilityHandler=ig.Class.extend({version:"1.0.2",config:{allowResumeWithoutFocus:{desktop:!0,mobile:{kaios:!1,"default":!0}},handlerDelay:{desktop:0,mobile:{kaios:0,"default":0}},autoFocusOnResume:{desktop:!0,mobile:{kaios:!1,"default":!0}},autoFocusAfterResume:{desktop:!0,mobile:{kaios:!1,"default":!0}}},browserPrefixes:["o","ms","moz","webkit"],browserPrefix:null,hiddenPropertyName:null,
visibilityEventName:null,visibilityStateName:null,isShowingOverlay:!1,isFocused:!1,isPaused:!1,init:function(){this.initVisibilityHandler();this.initFocusHandler();this.initPageTransitionHandler();ig.visibilityHandler=this},pauseHandler:function(){ig.game&&ig.game.pauseGame();wgl.system&&wgl.system.stopRender();ig.soundHandler&&ig.soundHandler.forceMuteAll()},resumeHandler:function(){ig.game&&ig.game.resumeGame();wgl.system&&wgl.system.startRender();ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},
initVisibilityHandler:function(){this.browserPrefix=this.getBrowserPrefix();this.hiddenPropertyName=this.getHiddenPropertyName(this.browserPrefix);this.visibilityEventName=this.getVisibilityEventName(this.browserPrefix);this.visibilityStateName=this.getVisibilityStateName(this.browserPrefix);this.visibilityEventName&&document.addEventListener(this.visibilityEventName,this.onChange.bind(this),!0)},initFocusHandler:function(){window.addEventListener("blur",this.onChange.bind(this),!0);document.addEventListener("blur",
this.onChange.bind(this),!0);document.addEventListener("focusout",this.onChange.bind(this),!0);window.addEventListener("focus",this.onChange.bind(this),!0);document.addEventListener("focus",this.onChange.bind(this),!0);document.addEventListener("focusin",this.onChange.bind(this),!0)},initPageTransitionHandler:function(){window.addEventListener("pagehide",this.onChange.bind(this),!0);window.addEventListener("pageshow",this.onChange.bind(this),!0)},getBrowserPrefix:function(){var b=null;this.browserPrefixes.forEach(function(c){if(this.getHiddenPropertyName(c)in
document)return b=c}.bind(this));return b},getHiddenPropertyName:function(b){return b?b+"Hidden":"hidden"},getVisibilityEventName:function(b){return(b?b:"")+"visibilitychange"},getVisibilityStateName:function(b){return b?b+"VisibilityState":"visibilityState"},hasView:function(){return!(document[this.hiddenPropertyName]||"visible"!==document[this.visibilityStateName])},hasFocus:function(){return document.hasFocus()||this.isFocused},onOverlayShow:function(){this.systemPaused();this.isShowingOverlay=
!0},onOverlayHide:function(){this.isShowingOverlay=!1;this.systemResumed()},systemPaused:function(){if(this.isPaused)return!1;this.pauseHandler();return this.isPaused=!0},systemResumed:function(){if(!this.isPaused||!this.hasView()||this.isShowingOverlay)return!1;if(!this.hasFocus())if(ig.ua.mobile)if(this.isKaiOS()){if(!this.config.allowResumeWithoutFocus.mobile.kaios)return!1}else{if(!this.config.allowResumeWithoutFocus.mobile.default)return!1}else if(!this.config.allowResumeWithoutFocus.desktop)return!1;
this.focusOnResume();this.resumeHandler();this.focusAfterResume();this.isPaused=!1;return!0},isKaiOS:function(){return/KAIOS/.test(navigator.userAgent)||!1},focusOnResume:function(){var b=!1;return b=ig.ua.mobile?this.isKaiOS()?this.config.autoFocusOnResume.mobile.kaios:this.config.autoFocusOnResume.mobile.default:this.config.autoFocusOnResume.desktop},focusAfterResume:function(){var b=!1;return b=ig.ua.mobile?this.isKaiOS()?this.config.autoFocusAfterResume.mobile.kaios:this.config.autoFocusAfterResume.mobile.default:
this.config.autoFocusAfterResume.desktop},focus:function(b){window.focus&&b&&window.focus()},handleDelayedEvent:function(b){if(!this.hasView()||"pause"===b.type||"pageHide"===b.type||"blur"===b.type||"focusout"===b.type){if("blur"===b.type||"focusout"===b.type)this.isFocused=!1;return this.systemPaused(b)}if("focus"===b.type||"focusin"===b.type)this.isFocused=!0;return this.systemResumed(b)},startDelayedEventHandler:function(b){ig.ua.mobile?this.isKaiOS()?0<this.config.handlerDelay.mobile.kaios?window.setTimeout(function(b){this.handleDelayedEvent(b)}.bind(this,
b),this.config.handlerDelay.mobile):this.handleDelayedEvent(b):0<this.config.handlerDelay.mobile.default?window.setTimeout(function(b){this.handleDelayedEvent(b)}.bind(this,b),this.config.handlerDelay.mobile):this.handleDelayedEvent(b):0<this.config.handlerDelay.desktop?window.setTimeout(function(b){this.handleDelayedEvent(b)}.bind(this,b),this.config.handlerDelay.desktop):this.handleDelayedEvent(b)},onChange:function(b){this.startDelayedEventHandler(b)}})});ig.baked=!0;
ig.module("plugins.io.storage").defines(function(){ig.Storage=ig.Class.extend({staticInstantiate:function(){return!ig.Storage.instance?null:ig.Storage.instance},init:function(){ig.Storage.instance=this},isCapable:function(){return"undefined"!==typeof window.localStorage},isSet:function(b){return null!==this.get(b)},initUnset:function(b,c){null===this.get(b)&&this.set(b,c)},get:function(b){if(!this.isCapable())return null;try{return JSON.parse(localStorage.getItem(b))}catch(c){return window.localStorage.getItem(b)}},
getInt:function(b){return~~this.get(b)},getFloat:function(b){return parseFloat(this.get(b))},getBool:function(b){return!!this.get(b)},key:function(b){return this.isCapable()?window.localStorage.key(b):null},set:function(b,c){if(!this.isCapable())return null;try{window.localStorage.setItem(b,JSON.stringify(c))}catch(e){console.log(e)}},setHighest:function(b,c){c>this.getFloat(b)&&this.set(b,c)},remove:function(b){if(!this.isCapable())return null;window.localStorage.removeItem(b)},clear:function(){if(!this.isCapable())return null;
window.localStorage.clear()}})});ig.baked=!0;
ig.module("plugins.io.mouse").requires("plugins.data.vector").defines(function(){Mouse=ig.Class.extend({bindings:{click:[ig.KEY.MOUSE1]},pos:new BABYLON.Vector2.Zero,init:function(){ig.input.initMouse();for(var b in this.bindings){this[b]=b;for(var c=0;c<this.bindings[b].length;c++)ig.input.bind(this.bindings[b][c],b)}},getWglPos:function(){var b=ig.sizeHandler.mobile.actualResolution.x,c=ig.sizeHandler.mobile.actualResolution.y,e=wgl.system.engine.getRenderWidth(),d=wgl.system.engine.getRenderHeight(),
b=e/b,c=d/c,d=ig.game.io.getClickPos();ig.ua.mobile?(b=d.x*ig.sizeHandler.sizeRatio.x,c=d.y*ig.sizeHandler.sizeRatio.y):(b*=d.x,c*=d.y);return new BABYLON.Vector2(b,c)},getLast:function(){return this.pos},getPos:function(){if(ig.ua.mobile)var b=ig.input.mouse.x/ig.sizeHandler.scaleRatioMultiplier.x,c=ig.input.mouse.y/ig.sizeHandler.scaleRatioMultiplier.y;else b=ig.input.mouse.x,c=ig.input.mouse.y;this.pos=new BABYLON.Vector2(b,c);return this.pos.clone()}})});ig.baked=!0;
ig.module("plugins.io.keyboard").defines(function(){Keyboard=ig.Class.extend({bindings:{up:[ig.KEY.W,ig.KEY.UP_ARROW],right:[ig.KEY.D,ig.KEY.RIGHT_ARROW],left:[ig.KEY.A,ig.KEY.LEFT_ARROW],down:[ig.KEY.S,ig.KEY.DOWN_ARROW,ig.KEY.SPACE]},init:function(){for(var b in this.bindings){this[b]=b;for(var c=0;c<this.bindings[b].length;c++)ig.input.bind(this.bindings[b][c],b)}}})});ig.baked=!0;
ig.module("plugins.io.gamepad-input").defines(function(){ig.PADKEY={BUTTON_0:0,PADBUTTON_1:1,BUTTON_2:2,BUTTON_3:3,BUTTON_LEFT_BUMPER:4,BUTTON_RIGHT_BUMPER:5,BUTTON_LEFT_TRIGGER:6,BUTTON_RIGHT_TRIGGER:7,BUTTON_LEFT_JOYSTICK:10,BUTTON_RIGHT_JOYSTICK:11,BUTTON_DPAD_UP:12,BUTTON_DPAD_DOWN:13,BUTTON_DPAD_LEFT:14,BUTTON_DPAD_RIGHT:15,BUTTON_MENU:16,AXIS_LEFT_JOYSTICK_X:0,AXIS_LEFT_JOYSTICK_Y:1,AXIS_RIGHT_JOYSTICK_X:2,AXIS_RIGHT_JOYSTICK_Y:3};ig.GamepadInput=ig.Class.extend({isInit:!1,isSupported:!1,list:[],
bindings:{},states:{},presses:{},releases:{},downLocks:{},upLocks:{},leftStick:{x:0,y:0},rightStick:{x:0,y:0},start:function(){if(!this.isInit){this.isInit=!0;var b=navigator.getGamepads||navigator.webkitGetGamepads;b&&(!navigator.getGamepads&&navigator.webkitGetGamepads&&(navigator.getGamepads=navigator.webkitGetGamepads),this.list=navigator.getGamepads());this.isSupported=b}},isAvailable:function(){return this.isInit&&this.isSupported},buttonPressed:function(b){return"object"==typeof b?b.pressed:
1==b},buttonDown:function(b){if(b=this.bindings[b])this.states[b]=!0,this.downLocks[b]||(this.presses[b]=!0,this.downLocks[b]=!0)},buttonUp:function(b){if((b=this.bindings[b])&&this.downLocks[b]&&!this.upLocks[b])this.states[b]=!1,this.releases[b]=!0,this.upLocks[b]=!0},clearPressed:function(){for(var b in this.releases)this.states[b]=!1,this.downLocks[b]=!1;this.releases={};this.presses={};this.upLocks={}},bind:function(b,c){this.bindings[b]=c},unbind:function(b){this.releases[this.bindings[b]]=
!0;this.bindings[b]=null},unbindAll:function(){this.bindings={};this.states={};this.presses={};this.releases={};this.downLocks={};this.upLocks={}},state:function(b){return this.states[b]},pressed:function(b){return this.presses[b]},released:function(b){return this.releases[b]},clamp:function(b,c,e){return b<c?c:b>e?e:b},pollGamepads:function(){if(this.isSupported){this.leftStick.x=0;this.leftStick.y=0;this.rightStick.x=0;this.rightStick.y=0;this.list=navigator.getGamepads();for(var b in this.bindings){for(var c=
!1,e=0;e<this.list.length;e++){var d=this.list[e];if(d&&d.buttons&&this.buttonPressed(d.buttons[b])){c=!0;break}}c?this.buttonDown(b):this.buttonUp(b)}for(e=0;e<this.list.length;e++)if((d=this.list[e])&&d.axes){b=d.axes[ig.GAMEPADINPUT.AXIS_LEFT_JOYSTICK_X];var c=d.axes[ig.GAMEPADINPUT.AXIS_LEFT_JOYSTICK_Y],g=d.axes[ig.GAMEPADINPUT.AXIS_RIGHT_JOYSTICK_X],d=d.axes[ig.GAMEPADINPUT.AXIS_RIGHT_JOYSTICK_Y];this.leftStick.x+=isNaN(b)?0:b;this.leftStick.y+=isNaN(c)?0:c;this.rightStick.x+=isNaN(g)?0:g;this.rightStick.y+=
isNaN(d)?0:d}0<this.list.length&&(this.leftStick.x=this.clamp(this.leftStick.x,-1,1),this.leftStick.y=this.clamp(this.leftStick.y,-1,1),this.rightStick.x=this.clamp(this.rightStick.x,-1,1),this.rightStick.y=this.clamp(this.rightStick.y,-1,1))}}})});ig.baked=!0;
ig.module("plugins.io.gamepad").requires("plugins.io.gamepad-input").defines(function(){Gamepad=ig.Class.extend({bindings:{padJump:[ig.PADKEY.BUTTON_0]},init:function(){ig.gamepadInput.start();for(var b in this.bindings)for(var c=0;c<this.bindings[b].length;c++)ig.gamepadInput.bind(this.bindings[b][c],b)},press:function(){},held:function(){},release:function(){}})});ig.baked=!0;
ig.module("plugins.io.multitouch").defines(function(){Multitouch=ig.Class.extend({init:function(){ig.multitouchInput.start()},getTouchesPos:function(){if(ig.ua.mobile){if(0<ig.multitouchInput.touches.length){for(var b=[],c=0;c<ig.multitouchInput.touches.length;c++){var e=ig.multitouchInput.touches[c];b.push({x:e.x,y:e.y})}return b}return null}}})});ig.baked=!0;
ig.module("plugins.io.multitouch-input").defines(function(){ig.MultitouchInput=ig.Class.extend({isStart:!1,touches:{},pressed:[],state:[],released:[],multitouchCapable:!1,lastEventUp:null,internalWidth:1,internalHeight:1,scaleX:1,scaleY:1,start:function(){this.isStart||(this.isStart=!0,navigator.maxTouchPoints&&1<navigator.maxTouchPoints&&(this.multitouchCapable=!0),ig.ua.touchDevice&&(window.navigator.msPointerEnabled&&(ig.system.canvas.addEventListener("MSPointerDown",this.touchdown.bind(this),
!1),ig.system.canvas.addEventListener("MSPointerUp",this.touchup.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",this.touchmove.bind(this),!1),ig.system.canvas.style.msContentZooming="none",ig.system.canvas.style.msTouchAction="none"),ig.system.canvas.addEventListener("touchstart",this.touchdown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.touchup.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.touchmove.bind(this),!1)))},touchdown:function(b){if(ig.ua.touchDevice)if(this.updateSizeProperties(),
window.navigator.msPointerEnabled)this.windowKeyDown(b);else if(b.touches){this.pollMultitouch(b.touches.length);this.updateSizeProperties();var c={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(c=ig.system.canvas.getBoundingClientRect());for(var e=[],d=0;d<b.touches.length;d++)e.push(b.touches[d]);this.spliceFromArray(e,this.pressed);this.spliceFromArray(e,this.state);this.spliceFromArray(e,this.released);for(d=0;d<e.length;d++)b=e[d],this.pressed.push({identifier:b.identifier,x:(b.clientX-
c.left)/this.scaleX,y:(b.clientY-c.top)/this.scaleY})}},touchmove:function(b){if(ig.ua.touchDevice){this.updateSizeProperties();if(window.navigator.msPointerEnabled)this.windowMove(b);else if(b.touches){this.pollMultitouch(b.touches.length);for(var c=0;c<b.touches.length;c++){var e=b.touches[c];this.upgrade(this.pressed,this.state,e);this.updateArray(this.state,e)}}try{ig.soundHandler.unlockWebAudio()}catch(d){}}},touchup:function(b){if(ig.ua.touchDevice){this.updateSizeProperties();if(window.navigator.msPointerEnabled)this.windowKeyUp(b);
else if(this.lastEventUp=b,b.touches)for(var c=0;c<b.changedTouches.length;c++){var e=b.changedTouches[c];this.upgrade(this.state,this.released,e);this.upgrade(this.pressed,this.released,e)}if(ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(d){}}},windowKeyDown:function(b){b=b.changedTouches?b.changedTouches:[b];this.pollMultitouch(b.length);this.updateSizeProperties();for(var c=[],e=0;e<b.length;e++)c.push(b[e]);var d={left:0,top:0};ig.system.canvas.getBoundingClientRect&&
(d=ig.system.canvas.getBoundingClientRect());this.spliceFromArray(c,this.pressed);this.spliceFromArray(c,this.state);this.spliceFromArray(c,this.released);for(e=0;e<c.length;e++){var g=b[e];this.pressed.push({identifier:"undefined"!=typeof g.identifier?g.identifier:"undefined"!=typeof g.pointerId?g.pointerId:1,x:(g.clientX-d.left)/this.scaleX,y:(g.clientY-d.top)/this.scaleY})}},windowKeyUp:function(b){this.lastEventUp=b;b=b.changedTouches?b.changedTouches:[b];for(var c=0;c<b.length;c++){var e=b[c],
e={identifier:"undefined"!=typeof e.identifier?e.identifier:"undefined"!=typeof e.pointerId?e.pointerId:1,clientX:e.clientX,clientY:e.clientY};this.upgrade(this.state,this.released,e);this.upgrade(this.pressed,this.released,e)}if(ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(d){}},windowMove:function(b){b=b.changedTouches?b.changedTouches:[b];this.pollMultitouch(b.length);for(var c=0;c<b.length;c++){var e=b[c],e={identifier:e.pointerId,clientX:e.clientX,
clientY:e.clientY};this.upgrade(this.pressed,this.state,e);this.updateArray(this.state,e)}try{ig.soundHandler.unlockWebAudio()}catch(d){}},clear:function(){for(var b=0;b<this.released.length;++b)this.released[b]&&(this.released.splice(b,1),b--)},pollMultitouch:function(b){!this.multitouchCapable&&1<b&&(this.multitouchCapable=!0)},spliceFromArray:function(b,c){for(var e=0;e<c.length;e++)for(var d=0;d<b.length;d++)b[d].identifier===c[e].identifier&&(b.splice(d,1),d--)},updateSizeProperties:function(){var b=
parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth,c=parseInt(ig.system.canvas.offsetHeight)||ig.system.realHeight;this.scaleX=ig.system.scale*(b/ig.system.realWidth);this.scaleY=ig.system.scale*(c/ig.system.realHeight)},upgrade:function(b,c,e){var d={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(d=ig.system.canvas.getBoundingClientRect());for(var g=(e.clientX-d.left)/this.scaleX,d=(e.clientY-d.top)/this.scaleY,f=0;f<b.length;f++)if(void 0!==typeof b[f].identifier&&void 0!==typeof e.identifier&&
e.identifier===b[f].identifier){b.splice(f,1);c.push({identifier:e.identifier,x:g,y:d});break}},updateArray:function(b,c){var e={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());for(var d=(c.clientX-e.left)/this.scaleX,e=(c.clientY-e.top)/this.scaleY,g=0;g<b.length;g++)if(void 0!==typeof b[g].identifier&&void 0!==typeof c.identifier&&c.identifier===b[g].identifier){b[g].x=d;b[g].y=e;break}}})});ig.baked=!0;
ig.module("plugins.io.fake-storage").requires("impact.game").defines(function(){ig.FakeStorage=ig.Class.extend({tempData:{},init:function(){ig.FakeStorage.instance=this},initUnset:function(b,c){null===this.get(b)&&this.set(b,c)},set:function(b,c){this.tempData[b]=JSON.stringify(c)},setHighest:function(b,c){c>this.getFloat(b)&&this.set(b,c)},get:function(b){return"undefined"==typeof this.tempData[b]?null:JSON.parse(this.tempData[b])},getInt:function(b){return~~this.get(b)},getFloat:function(b){return parseFloat(this.get(b))},
getBool:function(b){return!!this.get(b)},isSet:function(b){return null!==this.get(b)},remove:function(b){delete this.tempData[b]},clear:function(){this.tempData={}}})});ig.baked=!0;
ig.module("plugins.io.io-manager").requires("plugins.io.storage","plugins.io.mouse","plugins.io.keyboard","plugins.io.gamepad","plugins.io.multitouch","plugins.io.multitouch-input","plugins.io.gamepad-input","plugins.io.fake-storage").defines(function(){IoManager=ig.Class.extend({version:"1.0.0",storage:null,localStorageSupport:!1,mouse:null,keyboard:null,multitouch:null,gamepad:null,init:function(){ig.multitouchInput=new ig.MultitouchInput;ig.gamepadInput=new ig.GamepadInput;this.unbindAll();this.initStorage();
this.initMouse();this.initKeyboard()},unbindAll:function(){ig.input.unbindAll();ig.gamepadInput.unbindAll()},initStorage:function(){try{window.localStorage.setItem("test","test"),window.localStorage.removeItem("test"),this.storage=new ig.Storage}catch(b){console.log("using fake storage"),this.storage=new ig.FakeStorage}},initMouse:function(){this.mouse=new Mouse},initKeyboard:function(){this.keyboard=new Keyboard},initMultitouch:function(){this.multitouch=new Multitouch},initGamepad:function(){this.gamepad=
new Gamepad},press:function(b){return ig.input.pressed(b)||this.gamepad&&this.gamepad.press(b)?!0:!1},held:function(b){return ig.input.state(b)||this.gamepad&&this.gamepad.state(b)?!0:!1},release:function(b){return ig.input.released(b)||this.gamepad&&this.gamepad.released(b)?!0:!1},getClickPos:function(){return this.mouse.getPos()},getLastClickPos:function(){return this.mouse.getLast()},getTouchesPos:function(){return this.multitouch.getTouchesPos()},checkOverlap:function(b,c,e,d,g){return b.x>c+
d||b.x<c||b.y>e+g||b.y<e?!1:!0},clear:function(){ig.multitouchInput.clear()},_supportsLocalStorage:function(){try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),this.localStorageSupport="localStorage"in window&&null!==window.localStorage}catch(b){return this.localStorageSupport}},storageIsSet:function(b){return"function"===typeof this.storage.isSet?this.storage.isSet(b):null},storageGet:function(b){return"function"===typeof this.storage.get?this.storage.get(b):null},storageSet:function(b,
c){return"function"===typeof this.storage.set?this.storage.set(b,c):null},assert:function(b,c,e){if(c!==e)throw"actualValue:"+c+" not equal to testValue:"+e+" at "+b;}})});ig.baked=!0;
ig.module("plugins.io.storage-manager").requires("impact.game","plugins.io.io-manager").defines(function(){ig.Game.prototype.name="MJS-Game";ig.Game.prototype.version="1.0";ig.Game.prototype.sessionData={};ig.Game.prototype.initData=function(){return this.sessionData={sound:0.5,music:0.5,level:1,score:0}};ig.Game.prototype.setupStorageManager=function(){"undefined"===typeof this.name?console.error("Cannot found Game Name, Storage Manager Cancelled."):"undefined"===typeof this.version?console.error("Cannot found Game Version, Storage Manager Cancelled."):
(this.io||(this.io=new IoManager,console.log("IO Manager doesn't existed. Initialize...")),console.log("Plug in Storage Manager"),this.storage=this.io.storage,this.storageName=this.name+"-v"+this.version,this.loadAll())};ig.Game.prototype.loadAll=function(){var b=this.storage.get(this.storageName);if(null===b||"undefined"===typeof b)b=this.initData();for(var c in b)this.sessionData[c]=b[c];this.storage.set(this.storageName,b)};ig.Game.prototype.saveAll=function(){var b=this.storage.get(this.storageName),
c;for(c in b)b[c]=this.sessionData[c];this.storage.set(this.storageName,b)};ig.Game.prototype.load=function(b){return this.storage.get(this.storageName)[b]};ig.Game.prototype.save=function(b,c){var e=this.storage.get(this.storageName);e[b]=c;this.storage.set(this.storageName,e)}});ig.baked=!0;
ig.module("plugins.splash-loader").requires("impact.loader","impact.animation").defines(function(){ig.SplashLoader=ig.Loader.extend({desktopCoverDIVID:"play-desktop",titleImage:new ig.Image("media/graphics/game/title-small.png"),init:function(b,c){this.parent(b,c);var e=ig.domHandler.getElementById("#game"),d=ig.domHandler.getElementById("#webgl");ig.domHandler.setZIndex(e,1);ig.domHandler.setZIndex(d,0);ig.apiHandler.run("MJSPreroll")},end:function(){this.parent();this._drawStatus=1;this.draw();
ig.altBabylon.scene?this.startGame():ig.altBabylon.onSceneReady.addOnce(this.startGame.bind(this))},startGame:function(){this._drawStatus=1;this.draw();_SETTINGS.TapToStartAudioUnlock.Enabled?this.tapToStartDiv(function(){ig.system.setGame(MyGame)}):ig.system.setGame(MyGame)},tapToStartDiv:function(b){this.desktopCoverDIV=document.getElementById(this.desktopCoverDIVID);if(!this.desktopCoverDIV){this.desktopCoverDIV=document.createElement("div");this.desktopCoverDIV.id=this.desktopCoverDIVID;this.desktopCoverDIV.setAttribute("class",
"play");this.desktopCoverDIV.setAttribute("style","position: absolute; display: block; z-index: 999999; background-color: rgba(23, 32, 53, 0.7); visibility: visible; font-size: 10vmin; text-align: center; vertical-align: middle; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;");this.desktopCoverDIV.innerHTML="<div style='color:white;background-color: rgba(255, 255, 255, 0.3); border: 2px solid #fff; font-size:20px; border-radius: 5px; position: relative; float: left; top: 50%; left: 50%; transform: translate(-50%, -50%);'><div style='padding:20px 50px; font-family: montserrat;'>"+
_STRINGS.Splash.TapToStart+"</div></div>";(document.getElementById("play").parentNode||document.getElementById("ajaxbar")).appendChild(this.desktopCoverDIV);try{"undefined"!==typeof ig.sizeHandler?"undefined"!==typeof ig.sizeHandler.coreDivsToResize&&(ig.sizeHandler.coreDivsToResize.push("#"+this.desktopCoverDIVID),"function"===typeof ig.sizeHandler.reorient&&ig.sizeHandler.reorient()):"undefined"!==typeof coreDivsToResize&&(coreDivsToResize.push(this.desktopCoverDIVID),"function"===typeof sizeHandler&&
sizeHandler())}catch(c){console.log(c)}this.desktopCoverDIV.addEventListener("click",function(){ig.soundHandler.unlockWebAudio();this.setAttribute("style","visibility: hidden;");"function"===typeof b&&b()})}},draw:function(){var b=ig.system.context;b.save();b.fillStyle="#cff0d5";b.fillRect(0,0,ig.system.width,ig.system.height);var c=ig.responsive.toAnchor(0,0,"default");this.titleImage.draw(c.x+540-this.titleImage.width/2,c.y+700-this.titleImage.height/2);if(ig.babylonJSSupport){this._drawStatus+=
(this.status-this._drawStatus)/5;!ig.altBabylon.scene&&0.95<this._drawStatus&&(this._drawStatus=0.95);b.globalAlpha=0.5;b.lineWidth=2;b.fillStyle="#ffffff";b.strokeStyle="#ffffff";b.globalAlpha=1;ig.drawRoundRect(b,c.x+320,c.y+990,440,30,19,!0,!0);b.lineWidth=4;b.fillStyle="#65a888";b.strokeStyle="#ffffff";b.globalAlpha=1;ig.drawRoundRect(b,c.x+320,c.y+990,440,30,17,!1,!0);b.fillStyle="#65a888";b.strokeStyle="#65a888";var e=430*this._drawStatus;22>e&&(e=22);ig.drawRoundRect(b,c.x+320+5,c.y+990+5,
e,20,12,!0,!1);b.restore();this.drawVersion()}else b=ig.system.context,b.fillStyle="#ffffff",b.strokeStyle="#000000",b.lineWidth=8,b.lineJoin="round",b.textAlign="center",b.font="54px mainfont",b.strokeText("UNABLE TO RUN GAME",c.x+540,760),b.fillText("UNABLE TO RUN GAME",c.x+540,760),b.font="28px mainfont",b.strokeText("THIS BROWSER DOES NOT SUPPORT WEBGL",c.x+540,800),b.fillText("THIS BROWSER DOES NOT SUPPORT WEBGL",c.x+540,800)},drawVersion:function(){if("undefined"!==typeof _SETTINGS.Versioning&&
null!==_SETTINGS.Versioning&&_SETTINGS.Versioning.DrawVersion){var b=ig.system.context;fontSize=_SETTINGS.Versioning.FontSize;fontFamily=_SETTINGS.Versioning.FontFamily;fillStyle=_SETTINGS.Versioning.FillStyle;b.save();b.textBaseline="bottom";b.textAlign="left";b.font=fontSize+" "+fontFamily||"10px Arial";b.fillStyle=fillStyle||"#ffffff";b.fillText("v"+_SETTINGS.Versioning.Version+"+build."+_SETTINGS.Versioning.Build,10,ig.system.height-10);b.restore()}}})});ig.baked=!0;
ig.module("plugins.tween").requires("impact.entity").defines(function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(b){for(var c=0;c<this.length;++c)if(this[c]===b)return c;return-1});ig.Entity.prototype.tweens=[];ig.Entity.prototype._preTweenUpdate=ig.Entity.prototype.update;ig.Entity.prototype.update=function(){this._preTweenUpdate();if(0<this.tweens.length){for(var b=[],c=0;c<this.tweens.length;c++)this.tweens[c].update(),this.tweens[c].complete||b.push(this.tweens[c]);this.tweens=
b}};ig.Entity.prototype.tween=function(b,c,e){b=new ig.Tween(this,b,c,e);this.tweens.push(b);return b};ig.Entity.prototype.pauseTweens=function(){for(var b=0;b<this.tweens.length;b++)this.tweens[b].pause()};ig.Entity.prototype.resumeTweens=function(){for(var b=0;b<this.tweens.length;b++)this.tweens[b].resume()};ig.Entity.prototype.stopTweens=function(b){for(var c=0;c<this.tweens.length;c++)this.tweens[c].stop(b)};ig.Tween=function(b,c,e,d){var g={},f={},m={},l=0,j=!1,n=!1,r=!1;this.duration=e;this.paused=
this.complete=!1;this.easing=ig.Tween.Easing.Linear.EaseNone;this.onComplete=!1;this.loop=this.delay=0;this.loopCount=-1;ig.merge(this,d);this.loopNum=this.loopCount;this.chain=function(b){r=b};this.initEnd=function(b,c,d){if("object"!==typeof c[b])d[b]=c[b];else for(subprop in c[b])d[b]||(d[b]={}),this.initEnd(subprop,c[b],d[b])};this.initStart=function(b,c,d,e){if("object"!==typeof d[b])"undefined"!==typeof c[b]&&(e[b]=d[b]);else for(subprop in d[b])e[b]||(e[b]={}),"undefined"!==typeof c[b]&&this.initStart(subprop,
c[b],d[b],e[b])};this.start=function(){this.paused=this.complete=!1;this.loopNum=this.loopCount;l=0;-1==b.tweens.indexOf(this)&&b.tweens.push(this);n=!0;j=new ig.Timer;for(var d in c)this.initEnd(d,c,f);for(d in f)this.initStart(d,f,b,g),this.initDelta(d,m,b,f)};this.initDelta=function(b,c,d,e){if("object"!==typeof e[b])c[b]=e[b]-d[b];else for(subprop in e[b])c[b]||(c[b]={}),this.initDelta(subprop,c[b],d[b],e[b])};this.propUpdate=function(b,c,d,e,f){if("object"!==typeof d[b])c[b]="undefined"!=typeof d[b]?
d[b]+e[b]*f:c[b];else for(subprop in d[b])this.propUpdate(subprop,c[b],d[b],e[b],f)};this.propSet=function(b,c,d){if("object"!==typeof c[b])d[b]=c[b];else for(subprop in c[b])d[b]||(d[b]={}),this.propSet(subprop,c[b],d[b])};this.update=function(){if(!n)return!1;if(this.delay){if(j.delta()<this.delay)return;this.delay=0;j.reset()}if(this.paused||this.complete)return!1;var c=(j.delta()+l)/this.duration,c=1<c?1:c,d=this.easing(c);for(property in m)this.propUpdate(property,b,g,m,d);if(1<=c){if(0==this.loopNum||
!this.loop){this.complete=!0;if(this.onComplete)this.onComplete();r&&r.start();return!1}if(this.loop==ig.Tween.Loop.Revert){for(property in g)this.propSet(property,g,b);l=0;j.reset();-1!=this.loopNum&&this.loopNum--}else if(this.loop==ig.Tween.Loop.Reverse){c={};d={};ig.merge(c,f);ig.merge(d,g);ig.merge(g,c);ig.merge(f,d);for(property in f)this.initDelta(property,m,b,f);l=0;j.reset();-1!=this.loopNum&&this.loopNum--}}};this.pause=function(){this.paused=!0;j&&j.delta&&(l+=j.delta())};this.resume=function(){this.paused=
!1;j&&j.reset&&j.reset()};this.stop=function(b){b&&(this.loop=this.complete=this.paused=!1,l+=e,this.update());this.complete=!0}};ig.Tween.Loop={Revert:1,Reverse:2};ig.Tween.Easing={Linear:{},Quadratic:{},Cubic:{},Quartic:{},Quintic:{},Sinusoidal:{},Exponential:{},Circular:{},Elastic:{},Back:{},Bounce:{}};ig.Tween.Easing.Linear.EaseNone=function(b){return b};ig.Tween.Easing.Quadratic.EaseIn=function(b){return b*b};ig.Tween.Easing.Quadratic.EaseOut=function(b){return-b*(b-2)};ig.Tween.Easing.Quadratic.EaseInOut=
function(b){return 1>(b*=2)?0.5*b*b:-0.5*(--b*(b-2)-1)};ig.Tween.Easing.Cubic.EaseIn=function(b){return b*b*b};ig.Tween.Easing.Cubic.EaseOut=function(b){return--b*b*b+1};ig.Tween.Easing.Cubic.EaseInOut=function(b){return 1>(b*=2)?0.5*b*b*b:0.5*((b-=2)*b*b+2)};ig.Tween.Easing.Quartic.EaseIn=function(b){return b*b*b*b};ig.Tween.Easing.Quartic.EaseOut=function(b){return-(--b*b*b*b-1)};ig.Tween.Easing.Quartic.EaseInOut=function(b){return 1>(b*=2)?0.5*b*b*b*b:-0.5*((b-=2)*b*b*b-2)};ig.Tween.Easing.Quintic.EaseIn=
function(b){return b*b*b*b*b};ig.Tween.Easing.Quintic.EaseOut=function(b){return(b-=1)*b*b*b*b+1};ig.Tween.Easing.Quintic.EaseInOut=function(b){return 1>(b*=2)?0.5*b*b*b*b*b:0.5*((b-=2)*b*b*b*b+2)};ig.Tween.Easing.Sinusoidal.EaseIn=function(b){return-Math.cos(b*Math.PI/2)+1};ig.Tween.Easing.Sinusoidal.EaseOut=function(b){return Math.sin(b*Math.PI/2)};ig.Tween.Easing.Sinusoidal.EaseInOut=function(b){return-0.5*(Math.cos(Math.PI*b)-1)};ig.Tween.Easing.Exponential.EaseIn=function(b){return 0==b?0:Math.pow(2,
10*(b-1))};ig.Tween.Easing.Exponential.EaseOut=function(b){return 1==b?1:-Math.pow(2,-10*b)+1};ig.Tween.Easing.Exponential.EaseInOut=function(b){return 0==b?0:1==b?1:1>(b*=2)?0.5*Math.pow(2,10*(b-1)):0.5*(-Math.pow(2,-10*(b-1))+2)};ig.Tween.Easing.Circular.EaseIn=function(b){return-(Math.sqrt(1-b*b)-1)};ig.Tween.Easing.Circular.EaseOut=function(b){return Math.sqrt(1- --b*b)};ig.Tween.Easing.Circular.EaseInOut=function(b){return 1>(b/=0.5)?-0.5*(Math.sqrt(1-b*b)-1):0.5*(Math.sqrt(1-(b-=2)*b)+1)};ig.Tween.Easing.Elastic.EaseIn=
function(b){var c,e=0.1,d=0.4;if(0==b)return 0;if(1==b)return 1;d||(d=0.3);!e||1>e?(e=1,c=d/4):c=d/(2*Math.PI)*Math.asin(1/e);return-(e*Math.pow(2,10*(b-=1))*Math.sin((b-c)*2*Math.PI/d))};ig.Tween.Easing.Elastic.EaseOut=function(b){var c,e=0.1,d=0.4;if(0==b)return 0;if(1==b)return 1;d||(d=0.3);!e||1>e?(e=1,c=d/4):c=d/(2*Math.PI)*Math.asin(1/e);return e*Math.pow(2,-10*b)*Math.sin((b-c)*2*Math.PI/d)+1};ig.Tween.Easing.Elastic.EaseInOut=function(b){var c,e=0.1,d=0.4;if(0==b)return 0;if(1==b)return 1;
d||(d=0.3);!e||1>e?(e=1,c=d/4):c=d/(2*Math.PI)*Math.asin(1/e);return 1>(b*=2)?-0.5*e*Math.pow(2,10*(b-=1))*Math.sin((b-c)*2*Math.PI/d):0.5*e*Math.pow(2,-10*(b-=1))*Math.sin((b-c)*2*Math.PI/d)+1};ig.Tween.Easing.Back.EaseIn=function(b){return b*b*(2.70158*b-1.70158)};ig.Tween.Easing.Back.EaseOut=function(b){return(b-=1)*b*(2.70158*b+1.70158)+1};ig.Tween.Easing.Back.EaseInOut=function(b){return 1>(b*=2)?0.5*b*b*(3.5949095*b-2.5949095):0.5*((b-=2)*b*(3.5949095*b+2.5949095)+2)};ig.Tween.Easing.Bounce.EaseIn=
function(b){return 1-ig.Tween.Easing.Bounce.EaseOut(1-b)};ig.Tween.Easing.Bounce.EaseOut=function(b){return(b/=1)<1/2.75?7.5625*b*b:b<2/2.75?7.5625*(b-=1.5/2.75)*b+0.75:b<2.5/2.75?7.5625*(b-=2.25/2.75)*b+0.9375:7.5625*(b-=2.625/2.75)*b+0.984375};ig.Tween.Easing.Bounce.EaseInOut=function(b){return 0.5>b?0.5*ig.Tween.Easing.Bounce.EaseIn(2*b):0.5*ig.Tween.Easing.Bounce.EaseOut(2*b-1)+0.5};ig.Tween.Interpolation={Linear:function(b,c){var e=b.length-1,d=e*c,g=Math.floor(d),f=TWEEN.Interpolation.Utils.Linear;
return 0>c?f(b[0],b[1],d):1<c?f(b[e],b[e-1],e-d):f(b[g],b[g+1>e?e:g+1],d-g)}}});ig.baked=!0;
ig.module("plugins.patches.entity-patch").requires("impact.entity").defines(function(){ig.Entity.inject({handleMovementTrace:function(b){this.standing=!1;b.collision.y&&(0<this.bounciness&&Math.abs(this.vel.y)>this.minBounceVelocity?this.vel.y*=-this.bounciness:(0<this.vel.y&&(this.standing=!0),this.vel.y=0));b.collision.x&&(this.vel.x=0<this.bounciness&&Math.abs(this.vel.x)>this.minBounceVelocity?this.vel.x*-this.bounciness:0);if(b.collision.slope){var c=b.collision.slope;if(0<this.bounciness){var e=
this.vel.x*c.nx+this.vel.y*c.ny;this.vel.x=(this.vel.x-2*c.nx*e)*this.bounciness;this.vel.y=(this.vel.y-2*c.ny*e)*this.bounciness}else e=(this.vel.x*c.x+this.vel.y*c.y)/(c.x*c.x+c.y*c.y),this.vel.x=c.x*e,this.vel.y=c.y*e,c=Math.atan2(c.x,c.y),c>this.slopeStanding.min&&c<this.slopeStanding.max&&(this.standing=!0)}this.pos.x=b.pos.x;this.pos.y=b.pos.y}})});ig.baked=!0;
ig.module("plugins.tweens-handler").requires("impact.entity","plugins.tween","plugins.patches.entity-patch").defines(function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(b){for(var e=0;e<this.length;++e)if(this[e]===b)return e;return-1});ig.TweensHandler=ig.Class.extend({_tweens:[],_systemPausedTweens:[],init:function(){},getAll:function(){return this._tweens},removeAll:function(){this._tweens=[]},add:function(b){this._tweens.push(b)},remove:function(b){b=this._tweens.indexOf(b);
-1!==b&&this._tweens.splice(b,1)},onSystemPause:function(){if(0===this._tweens.length)return!1;for(var b=0,e=null;b<this._tweens.length;)e=this._tweens[b],e._isPlaying&&(this._systemPausedTweens.push(e),e.pause()),b++;return!0},onSystemResume:function(){if(0===this._systemPausedTweens.length)return!1;for(var b=0;b<this._systemPausedTweens.length;)this._systemPausedTweens[b].resume(),b++;this._systemPausedTweens=[];return!0},update:function(b,e){if(0===this._tweens.length)return!1;var d=0;for(b=void 0!==
b?b:ig.game.tweens.now();d<this._tweens.length;)this._tweens[d].update(b)||e?d++:this._tweens.splice(d,1);return!0},now:function(){return Date.now()}});ig.TweenDef=ig.Class.extend({_ent:null,_valuesStart:{},_valuesEnd:{},_valuesStartRepeat:{},_duration:1E3,_repeat:0,_yoyo:!1,_isPlaying:!1,_reversed:!1,_delayTime:0,_startTime:null,_pauseTime:null,_easingFunction:ig.Tween.Easing.Linear.EaseNone,_interpolationFunction:ig.Tween.Interpolation.Linear,_chainedTweens:[],_onStartCallback:null,_onStartCallbackFired:!1,
_onUpdateCallback:null,_onCompleteCallback:null,_onStopCallback:null,_onPauseCallback:null,_onResumeCallback:null,_currentElapsed:0,init:function(b){this._object=b},to:function(b,e){this._valuesEnd=b;void 0!==e&&(this._duration=e);return this},start:function(b){if(this._isPlaying)return this;ig.game.tweens.add(this);this._isPlaying=!0;this._onStartCallbackFired=!1;this._startTime=void 0!==b?b:ig.game.tweens.now();this._startTime+=this._delayTime;for(var e in this._valuesEnd){if(this._valuesEnd[e]instanceof
Array){if(0===this._valuesEnd[e].length)continue;this._valuesEnd[e]=[this._object[e]].concat(this._valuesEnd[e])}void 0!==this._object[e]&&(this._valuesStart[e]=this._object[e],!1===this._valuesStart[e]instanceof Array&&(this._valuesStart[e]*=1),this._valuesStartRepeat[e]=this._valuesStart[e]||0)}return this},stop:function(){if(!this._isPlaying)return this;ig.game.tweens.remove(this);this._isPlaying=!1;null!==this._onStopCallback&&this._onStopCallback.call(this._object,this._object);this.stopChainedTweens();
return this},pause:function(){if(!this._isPlaying)return this;ig.game.tweens.remove(this);this._isPlaying=!1;this._pauseTime=ig.game.tweens.now();null!==this._onPauseCallback&&this._onPauseCallback.call(this._object,this._object);return this},resume:function(){if(this._isPlaying||!this._pauseTime)return this;var b=ig.game.tweens.now()-this._pauseTime;this._startTime+=b;ig.game.tweens.add(this);this._isPlaying=!0;null!==this._onResumeCallback&&this._onResumeCallback.call(this._object,this._object);
this._pauseTime=null;return this},end:function(){this.update(this._startTime+this._duration);return this},stopChainedTweens:function(){for(var b=0,e=this._chainedTweens.length;b<e;b++)this._chainedTweens[b].stop()},delay:function(b){this._delayTime=b;return this},repeat:function(b){this._repeat=b;return this},repeatDelay:function(b){this._repeatDelayTime=b;return this},yoyo:function(b){this._yoyo=b;return this},easing:function(b){this._easingFunction=b;return this},interpolation:function(b){this._interpolationFunction=
b;return this},chain:function(){this._chainedTweens=arguments;return this},onStart:function(b){this._onStartCallback=b;return this},onUpdate:function(b){this._onUpdateCallback=b;return this},onComplete:function(b){this._onCompleteCallback=b;return this},onStop:function(b){this._onStopCallback=b;return this},onPause:function(b){this._onPauseCallback=b;return this},onResume:function(b){this._onResumeCallback=b;return this},update:function(b){var e,d,g;if(b<this._startTime)return!0;!1===this._onStartCallbackFired&&
(null!==this._onStartCallback&&this._onStartCallback.call(this._object,this._object),this._onStartCallbackFired=!0);d=(b-this._startTime)/this._duration;this._currentElapsed=d=1<d?1:d;g=this._easingFunction(d);for(e in this._valuesEnd)if(void 0!==this._valuesStart[e]){var f=this._valuesStart[e]||0,m=this._valuesEnd[e];m instanceof Array?this._object[e]=this._interpolationFunction(m,g):("string"===typeof m&&(m="+"===m.charAt(0)||"-"===m.charAt(0)?f+parseFloat(m):parseFloat(m)),"number"===typeof m&&
(this._object[e]=f+(m-f)*g))}null!==this._onUpdateCallback&&this._onUpdateCallback.call(this._object,this._object,g);if(1===d)if(0<this._repeat){isFinite(this._repeat)&&this._repeat--;for(e in this._valuesStartRepeat)"string"===typeof this._valuesEnd[e]&&(this._valuesStartRepeat[e]=_valuesStartRepeat[e]+parseFloat(_valuesEnd[e])),this._yoyo&&(d=this._valuesStartRepeat[e],this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=d),this._valuesStart[e]=this._valuesStartRepeat[e];this._yoyo&&
(this._reversed=!this._reversed);this._startTime=void 0!==this._repeatDelayTime?b+this._repeatDelayTime:b+this._delayTime}else{null!==this._onCompleteCallback&&this._onCompleteCallback.call(this._object,this._object);b=0;for(e=this._chainedTweens.length;b<e;b++)this._chainedTweens[b].start(this._startTime+this._duration);return!1}return!0}});var b=[1];ig.Tween.Interpolation={Linear:function(b,e){var d=b.length-1,g=d*e,f=Math.floor(g),m=ig.Tween.Interpolation.Utils.Linear;return 0>e?m(b[0],b[1],g):
1<e?m(b[d],b[d-1],d-g):m(b[f],b[f+1>d?d:f+1],g-f)},Bezier:function(b,e){for(var d=0,g=b.length-1,f=Math.pow,m=ig.Tween.Interpolation.Utils.Bernstein,l=0;l<=g;l++)d+=f(1-e,g-l)*f(e,l)*b[l]*m(g,l);return d},CatmullRom:function(b,e){var d=b.length-1,g=d*e,f=Math.floor(g),m=ig.Tween.Interpolation.Utils.CatmullRom;return b[0]===b[d]?(0>e&&(f=Math.floor(g=d*(1+e))),m(b[(f-1+d)%d],b[f],b[(f+1)%d],b[(f+2)%d],g-f)):0>e?b[0]-(m(b[0],b[0],b[1],b[1],-g)-b[0]):1<e?b[d]-(m(b[d],b[d],b[d-1],b[d-1],g-d)-b[d]):m(b[f?
f-1:0],b[f],b[d<f+1?d:f+1],b[d<f+2?d:f+2],g-f)},Utils:{Linear:function(b,e,d){return(e-b)*d+b},Bernstein:function(b,e){var d=ig.Tween.Interpolation.Utils.Factorial;return d(b)/d(e)/d(b-e)},Factorial:function(c){var e=1;if(b[c])return b[c];for(var d=c;1<d;d--)e*=d;return b[c]=e},CatmullRom:function(b,e,d,g,f){b=0.5*(d-b);g=0.5*(g-e);var m=f*f;return(2*e-2*d+b+g)*f*m+(-3*e+3*d-2*b-g)*m+b*f+e}}}});ig.baked=!0;
ig.module("plugins.url-parameters").defines(function(){ig.UrlParameters=ig.Class.extend({init:function(){switch(getQueryVariable("iphone")){case "true":ig.ua.iPhone=!0,console.log("iPhone mode")}var b=getQueryVariable("webview");if(b)switch(b){case "true":ig.ua.is_uiwebview=!0,console.log("webview mode")}if(b=getQueryVariable("debug"))switch(b){case "true":ig.game.showDebugMenu(),console.log("debug mode")}if(b=getQueryVariable("debugwgl"))switch(b){case "true":wgl.debug.debug=!0,console.log("wgl debug mode")}switch(getQueryVariable("view")){case "stats":ig.game.resetPlayerStats(),
ig.game.endGame()}getQueryVariable("ad")}})});ig.baked=!0;
ig.module("plugins.director").requires("impact.impact").defines(function(){ig.Director=ig.Class.extend({init:function(b,c){this.game=b;this.levels=[];this.currentLevel=0;this.append(c)},loadLevel:function(b){for(var c in ig.sizeHandler.dynamicClickableEntityDivs){var e=ig.domHandler.getElementById("#"+c);ig.domHandler.hide(e)}this.currentLevel=b;this.game.loadLevel(this.levels[b]);return!0},loadLevelWithoutEntities:function(b){this.currentLevel=b;this.game.loadLevelWithoutEntities(this.levels[b]);
return!0},append:function(b){newLevels=[];return"object"===typeof b?(b.constructor===[].constructor?newLevels=b:newLevels[0]=b,this.levels=this.levels.concat(newLevels),!0):!1},nextLevel:function(){return this.currentLevel+1<this.levels.length?this.loadLevel(this.currentLevel+1):!1},previousLevel:function(){return 0<=this.currentLevel-1?this.loadLevel(this.currentLevel-1):!1},jumpTo:function(b){var c=null;for(i=0;i<this.levels.length;i++)this.levels[i]==b&&(c=i);return 0<=c?this.loadLevel(c):!1},
firstLevel:function(){return this.loadLevel(0)},lastLevel:function(){return this.loadLevel(this.levels.length-1)},reloadLevel:function(){return this.loadLevel(this.currentLevel)}})});ig.baked=!0;
ig.module("plugins.impact-storage").requires("impact.game").defines(function(){ig.Storage=ig.Class.extend({staticInstantiate:function(){return!ig.Storage.instance?null:ig.Storage.instance},init:function(){ig.Storage.instance=this},isCapable:function(){return"undefined"!==typeof window.localStorage},isSet:function(b){return null!==this.get(b)},initUnset:function(b,c){null===this.get(b)&&this.set(b,c)},get:function(b){if(!this.isCapable())return null;try{return JSON.parse(localStorage.getItem(b))}catch(c){return window.localStorage.getItem(b)}},
getInt:function(b){return~~this.get(b)},getFloat:function(b){return parseFloat(this.get(b))},getBool:function(b){return!!this.get(b)},key:function(b){return this.isCapable()?window.localStorage.key(b):null},set:function(b,c){if(!this.isCapable())return null;try{window.localStorage.setItem(b,JSON.stringify(c))}catch(e){console.log(e)}},setHighest:function(b,c){c>this.getFloat(b)&&this.set(b,c)},remove:function(b){if(!this.isCapable())return null;window.localStorage.removeItem(b)},clear:function(){if(!this.isCapable())return null;
window.localStorage.clear()}})});ig.baked=!0;
ig.module("plugins.responsive.responsive-utils").requires("impact.system").defines(function(){ig.responsive={width:0,height:0,halfWidth:0,halfHeight:0,originalWidth:0,originalHeight:0,fillScale:1,scaleX:1,scaleY:1,toAnchor:function(b,c,e){switch(e){case "top-left":case "left-top":return this.toAnchorTopLeft(b,c);case "top-center":case "center-top":case "top":return this.toAnchorTopCenter(b,c);case "top-right":case "right-top":return this.toAnchorTopRight(b,c);case "left-middle":case "middle-left":case "left":return this.toAnchorLeftMiddle(b,
c);case "center-middle":case "middle-center":case "middle":case "center":return this.toAnchorCenterMiddle(b,c);case "right-middle":case "middle-right":case "right":return toAnchorRightMiddle(b,c);case "bottom-left":case "left-bottom":return this.toAnchorBottomLeft(b,c);case "bottom-center":case "center-bottom":case "bottom":return this.toAnchorBottomCenter(b,c);case "bottom-right":case "right-bottom":return this.toAnchorBottomRight(b,c);default:return this.toAnchorDefault(b,c)}},toAnchorDefault:function(b,
c){return{x:b+(this.width-this.originalWidth)/2,y:c+(this.height-this.originalHeight)/2}},toAnchorCenterMiddle:function(b,c){return{x:b+this.halfWidth,y:c+this.halfHeight}},toAnchorLeftMiddle:function(b,c){return{x:b,y:c+this.halfHeight}},toAnchorTopCenter:function(b,c){return{x:b+this.halfWidth,y:c}},toAnchorRightMiddle:function(b,c){return{x:b+this.width,y:c+this.halfHeight}},toAnchorBottomCenter:function(b,c){return{x:b+this.halfWidth,y:c+this.height}},toAnchorTopLeft:function(b,c){return{x:b,
y:c}},toAnchorBottomLeft:function(b,c){return{x:b,y:c+this.height}},toAnchorTopRight:function(b,c){return{x:b+this.width,y:c}},toAnchorBottomRight:function(b,c){return{x:b+this.width,y:c+this.height}},drawScaledImage:function(b,c,e,d,g,f,m){f||(f=0);m||(m=0);var l=ig.system.context;l.save();l.translate(c,e);(1!=d||1!=g)&&l.scale(d,g);b.draw(-b.width*f,-b.height*m);l.restore()}}});ig.baked=!0;
ig.module("plugins.responsive.responsive-plugin").requires("impact.system","impact.entity","plugins.handlers.size-handler","plugins.responsive.responsive-utils").defines(function(){ig.SizeHandler.inject({resize:function(){this.parent()},sizeCalcs:function(){this.originalResolution||(this.originalResolution=new BABYLON.Vector2(this.desktop.actualResolution.x,this.desktop.actualResolution.y),ig.responsive.originalWidth=this.desktop.actualResolution.x,ig.responsive.originalHeight=this.desktop.actualResolution.y);
var b=window.innerWidth,c=window.innerHeight,e=b/c,d=this.originalResolution.x/this.originalResolution.y,g=0,f=0;this.windowSize=new BABYLON.Vector2(b,c);e<d?(g=this.originalResolution.x,f=g/e,ig.responsive.scaleX=1,ig.responsive.scaleY=f/this.originalResolution.y):(f=this.originalResolution.y,g=f*e,ig.responsive.scaleX=g/this.originalResolution.x,ig.responsive.scaleY=1);this.scaleRatioMultiplier=new BABYLON.Vector2(b/g,c/f);this.desktop.actualResolution=new BABYLON.Vector2(g,f);this.mobile.actualResolution=
new BABYLON.Vector2(g,f);this.desktop.actualSize=new BABYLON.Vector2(b,c);this.mobile.actualSize=new BABYLON.Vector2(b,c);ig.responsive.width=g;ig.responsive.height=f;ig.responsive.halfWidth=g/2;ig.responsive.halfHeight=f/2;ig.responsive.fillScale=Math.max(ig.responsive.scaleX,ig.responsive.scaleY)},resizeLayers:function(){ig.system.resize(ig.sizeHandler.desktop.actualResolution.x,ig.sizeHandler.desktop.actualResolution.y);for(var b=0;b<this.coreDivsToResize.length;b++){var c=ig.domHandler.getElementById(this.coreDivsToResize[b]),
e=Math.floor(ig.sizeHandler.windowSize.x/2-ig.sizeHandler.desktop.actualSize.x/2),d=Math.floor(ig.sizeHandler.windowSize.y/2-ig.sizeHandler.desktop.actualSize.y/2);0>e&&(e=0);0>d&&(d=0);ig.domHandler.resizeOffset(c,Math.floor(ig.sizeHandler.desktop.actualSize.x),Math.floor(ig.sizeHandler.desktop.actualSize.y),e,d)}for(var g in this.adsToResize)b=ig.domHandler.getElementById("#"+g),c=ig.domHandler.getElementById("#"+g+"-Box"),e=(window.innerWidth-this.adsToResize[g]["box-width"])/2+"px",d=(window.innerHeight-
this.adsToResize[g]["box-height"])/2+"px",b&&ig.domHandler.css(b,{width:window.innerWidth,height:window.innerHeight}),c&&ig.domHandler.css(c,{left:e,top:d});b=ig.domHandler.getElementById("#canvas");c=ig.domHandler.getOffsets(b);b=c.left;c=c.top;e=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);for(g in this.dynamicClickableEntityDivs)d=ig.domHandler.getElementById("#"+g),ig.domHandler.css(d,{"float":"left",position:"absolute",left:Math.floor(b+this.dynamicClickableEntityDivs[g].entity_pos_x*
this.scaleRatioMultiplier.x)+"px",top:Math.floor(c+this.dynamicClickableEntityDivs[g].entity_pos_y*this.scaleRatioMultiplier.y)+"px",width:Math.floor(this.dynamicClickableEntityDivs[g].width*this.scaleRatioMultiplier.x)+"px",height:Math.floor(this.dynamicClickableEntityDivs[g].height*this.scaleRatioMultiplier.y)+"px","z-index":3}),this.dynamicClickableEntityDivs[g]["font-size"]&&ig.domHandler.css(d,{"font-size":this.dynamicClickableEntityDivs[g]["font-size"]*e+"px"});$("#ajaxbar").width(this.windowSize.x);
$("#ajaxbar").height(this.windowSize.y)},reorient:function(){ig.ua.mobile?(this.resize(),this.resizeAds()):this.resize();this.resizeBabylon();ig.game&&(ig.game.update(),ig.game.draw())},resizeBabylon:function(){var b=window.innerWidth,c=window.innerHeight,e=b/c,d=ig.responsive.originalWidth,g=ig.responsive.originalHeight,f=d/g,m=2560;ig.ua.mobile&&(m=1024);minSize=Math.min(d,g);e>f?(c>g&&(c=g),b=Math.floor(window.innerWidth/window.innerHeight*c),b>m&&(b=m),c=Math.floor(window.innerHeight/window.innerWidth*
b)):(b>d&&(b=d),c=Math.floor(window.innerHeight/window.innerWidth*b),c>m&&(c=m),b=Math.floor(window.innerWidth/window.innerHeight*c));d=e=1;window.innerWidth>m&&(e=window.innerWidth/m);window.innerHeight>m&&(d=window.innerHeight/m);m=null;window.wgl&&(wgl.system&&wgl.system.engine)&&(m=wgl.system.engine);ig.altBabylon&&(m=ig.altBabylon.engine);m.setSize(b,c);m.resize();m.setHardwareScalingLevel(Math.max(e,d));console.log("babylon renderSize : ",m.getRenderWidth(),m.getRenderHeight(),"hwScalingLevel : ",
m.getHardwareScalingLevel().toFixed(2))}});ig.Entity.inject({init:function(b,c,e){this.parent(b,c,e);this.anchorType="none";this.anchoredPositionX=b;this.anchoredPositionY=c},setAnchoredPosition:function(b,c,e){e||(e="default");this.anchorType=e;this.anchoredPositionX=b;this.anchoredPositionY=c},update:function(){this.parent();if(""!=this.anchorType&&"none"!=this.anchorType){var b=ig.responsive.toAnchor(this.anchoredPositionX,this.anchoredPositionY,this.anchorType);this.pos.x=b.x;this.pos.y=b.y}}})});
ig.baked=!0;
ig.module("plugins.blowfish").defines(function(){var b=function(c,e){this.key=c;if("ecb"===e||"cbc"===e)this.mode=e;this.sBox0=b.sBox0.slice();this.sBox1=b.sBox1.slice();this.sBox2=b.sBox2.slice();this.sBox3=b.sBox3.slice();this.pArray=b.pArray.slice();this.generateSubkeys(c)};b.prototype={sBox0:null,sBox1:null,sBox2:null,sBox3:null,pArray:null,key:null,mode:"ecb",iv:"abc12345",keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encrypt:function(b,e){if("ecb"===this.mode)return this.encryptECB(b);
if("cbc"===this.mode)return this.encryptCBC(b,e);throw Error("\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u044f.");},decrypt:function(b,e){if("ecb"===this.mode)return this.decryptECB(b);if("cbc"===this.mode)return this.decryptCBC(b,e);throw Error("\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u044f.");
},encryptECB:function(b){b=this.utf8Decode(b);for(var e=Math.ceil(b.length/8),d="",g=0;g<e;g++){var f=b.substr(8*g,8);if(8>f.length)for(var m=8-f.length;0<m--;)f+="\x00";m=this.split64by32(f);f=m[0];m=m[1];m=this.encipher(f,m);f=m[0];m=m[1];d+=this.num2block32(f)+this.num2block32(m)}return d},encryptCBC:function(b,e){b=this.utf8Decode(b);var d=Math.ceil(b.length/8),g,f;f=this.split64by32(e);g=f[0];f=f[1];for(var m="",l=0;l<d;l++){var j=b.substr(8*l,8);if(8>j.length)for(var n=8-j.length;0<n--;)j+=
"\x00";n=this.split64by32(j);j=n[0];n=n[1];j=this.xor(j,g);n=this.xor(n,f);n=this.encipher(j,n);j=n[0];n=n[1];m+=this.num2block32(j)+this.num2block32(n)}return m},decryptECB:function(b){for(var e=Math.ceil(b.length/8),d="",g=0;g<e;g++){var f=b.substr(8*g,8);if(8>f.length)throw Error("\u0417\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u043f\u043e\u0432\u0440\u0435\u0436\u0434\u0435\u043d\u0430: \u0434\u043b\u0438\u043d\u043d\u0430 \u0437\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u043a\u0440\u0430\u0442\u043d\u0430 8 \u0431\u0430\u044b\u0439\u0442\u0430\u043c.");
var m;m=this.split64by32(f);f=m[0];m=m[1];m=this.decipher(f,m);f=m[0];m=m[1];d+=this.num2block32(f)+this.num2block32(m)}return d=this.utf8Encode(d)},decryptCBC:function(b,e){var d=Math.ceil(b.length/8),g,f,m,l;f=this.split64by32(e);g=f[0];f=f[1];for(var j="",n=0;n<d;n++){m=b.substr(8*n,8);if(8>m.length)throw Error("\u0417\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u043f\u043e\u0432\u0440\u0435\u0436\u0434\u0435\u043d\u0430: \u0434\u043b\u0438\u043d\u043d\u0430 \u0437\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u043a\u0440\u0430\u0442\u043d\u0430 8 \u0431\u0430\u0439\u0442\u0430\u043c.");
var r,q;q=this.split64by32(m);r=q[0];q=q[1];m=r;l=q;q=this.decipher(r,q);r=q[0];q=q[1];r=this.xor(r,g);q=this.xor(q,f);g=m;f=l;j+=this.num2block32(r)+this.num2block32(q)}return j=this.utf8Encode(j)},F:function(b){var e=b<<16>>>24,d=b<<24>>>24;b=this.addMod32(this.sBox0[b>>>24],this.sBox1[b<<8>>>24]);b=this.xor(b,this.sBox2[e]);return b=this.addMod32(b,this.sBox3[d])},encipher:function(b,e){for(var d,g=0;16>g;g++)b=this.xor(b,this.pArray[g]),e=this.xor(this.F(b),e),d=b,b=e,e=d;d=b;b=e;e=this.xor(d,
this.pArray[16]);b=this.xor(b,this.pArray[17]);return[b,e]},decipher:function(b,e){var d;b=this.xor(b,this.pArray[17]);e=this.xor(e,this.pArray[16]);d=b;b=e;e=d;for(var g=15;0<=g;g--)d=b,b=e,e=d,e=this.xor(this.F(b),e),b=this.xor(b,this.pArray[g]);return[b,e]},generateSubkeys:function(b){var e=0,d=0,g,f;for(g=0;18>g;g++){for(f=4;0<f;f--)e=this.fixNegative(e<<8|b.charCodeAt(d)),d=(d+1)%b.length;this.pArray[g]=this.xor(this.pArray[g],e);e=0}b=[0,0];for(g=0;18>g;g+=2)b=this.encipher(b[0],b[1]),this.pArray[g]=
b[0],this.pArray[g+1]=b[1];for(g=0;256>g;g+=2)b=this.encipher(b[0],b[1]),this.sBox0[g]=b[0],this.sBox0[g+1]=b[1];for(g=0;256>g;g+=2)b=this.encipher(b[0],b[1]),this.sBox1[g]=b[0],this.sBox1[g+1]=b[1];for(g=0;256>g;g+=2)b=this.encipher(b[0],b[1]),this.sBox2[g]=b[0],this.sBox2[g+1]=b[1];for(g=0;256>g;g+=2)b=this.encipher(b[0],b[1]),this.sBox3[g]=b[0],this.sBox3[g+1]=b[1]},block32toNum:function(b){return this.fixNegative(b.charCodeAt(0)<<24|b.charCodeAt(1)<<16|b.charCodeAt(2)<<8|b.charCodeAt(3))},num2block32:function(b){return String.fromCharCode(b>>>
24)+String.fromCharCode(b<<8>>>24)+String.fromCharCode(b<<16>>>24)+String.fromCharCode(b<<24>>>24)},xor:function(b,e){return this.fixNegative(b^e)},addMod32:function(b,e){return this.fixNegative(b+e|0)},fixNegative:function(b){return b>>>0},split64by32:function(b){var e=b.substring(0,4);b=b.substring(4,8);return[this.block32toNum(e),this.block32toNum(b)]},utf8Decode:function(b){for(var e="",d=0;d<b.length;d++){var g=b.charCodeAt(d);128>g?e+=String.fromCharCode(g):(127<g&&2048>g?e+=String.fromCharCode(g>>
6|192):(e+=String.fromCharCode(g>>12|224),e+=String.fromCharCode(g>>6&63|128)),e+=String.fromCharCode(g&63|128))}return e},utf8Encode:function(b){for(var e="",d=0,g=0,f=0,m=0;d<b.length;)g=b.charCodeAt(d),128>g?(e+=String.fromCharCode(g),d++):191<g&&224>g?(f=b.charCodeAt(d+1),e+=String.fromCharCode((g&31)<<6|f&63),d+=2):(f=b.charCodeAt(d+1),m=b.charCodeAt(d+2),e+=String.fromCharCode((g&15)<<12|(f&63)<<6|m&63),d+=3);return e},base64Encode:function(b){for(var e="",d,g,f,m,l,j,n=0;n<b.length;)d=b.charCodeAt(n++),
g=b.charCodeAt(n++),f=b.charCodeAt(n++),m=d>>2,d=(d&3)<<4|g>>4,l=(g&15)<<2|f>>6,j=f&63,isNaN(g)?l=j=64:isNaN(f)&&(j=64),e=e+this.keyStr.charAt(m)+this.keyStr.charAt(d)+this.keyStr.charAt(l)+this.keyStr.charAt(j);return e},base64Decode:function(b){var e="",d,g,f,m,l,j=0;for(b=b.replace(/[^A-Za-z0-9\+\/\=]/g,"");j<b.length;)d=this.keyStr.indexOf(b.charAt(j++)),g=this.keyStr.indexOf(b.charAt(j++)),m=this.keyStr.indexOf(b.charAt(j++)),l=this.keyStr.indexOf(b.charAt(j++)),d=d<<2|g>>4,g=(g&15)<<4|m>>2,
f=(m&3)<<6|l,e+=String.fromCharCode(d),64!=m&&(e+=String.fromCharCode(g)),64!=l&&(e+=String.fromCharCode(f));return e},trimZeros:function(b){return b.replace(/\0+$/g,"")}};b.pArray=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731];b.sBox0=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,
1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,
1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,
3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,
3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,
3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,
705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946];b.sBox1=[1266315497,3048417604,3681880366,3289982499,290971E4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,
2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,
3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,
3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,
2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,
2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055];b.sBox2=[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,
3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,
4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,
2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,
1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,
1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,
1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504];b.sBox3=[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,
2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,
509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,
1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409E3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,
3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,
901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462];if("undefined"===typeof window.Blowfish||null===window.Blowfish)window.Blowfish=b});ig.baked=!0;
ig.module("plugins.validator").requires("plugins.handlers.dom-handler","impact.timer","plugins.blowfish").defines(function(){ig.Validator=ig.Class.extend({NAME:"VALIDATOR",VERSION:"1.3.0",parameters:{properties:{verbose:{type:"string","default":null},tournament_id:{type:"string","default":null},game_id:{type:"string","default":null},entry_id:{type:"string","default":null},user_id:{type:"string","default":null},user_name:{type:"string","default":null},env:{type:"string","default":null},host:{type:"string",
"default":null},pvp:{type:"boolean","default":null}}},settings:{sk:"",vsk:"",validator_id:"",project_id:"",showOfflineNotification:!0,callback:{gameFailed:function(){}},customUrlParameterName:{tournament_id:"tournament_id",game_id:"game_id",entry_id:"entry_id",user_id:"user_id",user_name:"user_name",env:"env",host:"host",pvp:"pvp"},strings:{loading:"Please wait...",start:"Please wait...",end:"Please wait...",retry:"Retrying ({CURRENT_ATTEMPT}/{MAX_ATTEMPT})",error:"Something went wrong.",offline:"You are offline, please reconnect to the internet."},
gameContainterId:"ajaxbar",startAPI:{url:"https://validator.marketjs-cloud.com:8443/api/start",method:"POST",timeout:5E3,attemptInterval:3333,maxAttempt:5},progressAPI:{url:"https://validator.marketjs-cloud.com:8443/api/progress",method:"POST",timeout:5E3,interval:1E4},endAPI:{url:"https://validator.marketjs-cloud.com:8443/api/end",method:"POST",timeout:5E3,attemptInterval:3333,maxAttempt:5}},gameState:{hasStarted:!1,hasStartApiCalled:!1,startApiAttemptCount:0,hasEnded:!1,hasEndApiCalled:!1,endApiAttemptCount:0},
progressIntervalJobId:null,progressData:{at:0,score:0,level:1,actions:[],timer:null},divElements:{loader:null,popupMessage:null,offlineNotification:null},init:function(b){this.mergeSettings(b);this.setAlias();this.getUrlParameters();this.initEventHandlers();this.initOverlays();this.ready();return this},ready:function(){this.log("Initialized")},mergeSettings:function(b){ig.merge(this.settings,b)},setAlias:function(){ig.validator=this;ig.global.validator=window.validator=this},setProjectId:function(b,
c){"undefined"!==typeof b&&null!==b&&(this.settings.project_id=b);"undefined"!==typeof c&&null!==c&&(this.settings.validator_id=c)},setValidatorId:function(b,c){"undefined"!==typeof b&&null!==b&&(this.settings.validator_id=b);"undefined"!==typeof c&&null!==c&&(this.settings.project_id=c)},getQueryVariable:function(b){for(var c=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),e=0;e<c.length;e++){var d=c[e].match(/([^=]+?)=(.+)/);if(d){var g=decodeURIComponent(d[1]),d=decodeURIComponent(d[2]);
if(b===g)return d}}},mapUrlParameters:function(){if("undefined"!==typeof this.settings.customUrlParameterName&&null!==this.settings.customUrlParameterName)for(var b in this.settings.customUrlParameterName){var c=this.settings.customUrlParameterName[b];b!==c&&this.parameters.properties.hasOwnProperty(b)&&(this.parameters.properties[c]=this.parameters.properties[b])}},rewriteParameters:function(){if("undefined"!==typeof this.settings.customUrlParameterName&&null!==this.settings.customUrlParameterName)for(var b in this.settings.customUrlParameterName){var c=
b,e=this.settings.customUrlParameterName[b];c!==e&&this.parameters.hasOwnProperty(e)&&(this.parameters[c]=this.parameters[e])}},getUrlParameters:function(){this.mapUrlParameters();for(var b in this.parameters.properties)if(this.parameters.properties.hasOwnProperty(b)){var c=this.parameters.properties[b].type,e=this.parameters.properties[b].default,d=this.getQueryVariable(b);"undefined"!==typeof e&&null!==e&&(this.parameters[b]=e);if("undefined"!==typeof d&&null!==d)switch(c){case "float":this.parameters[b]=
parseFloat(d);break;case "integer":this.parameters[b]=parseInt(d);break;case "boolean":this.parameters[b]="true"===d||"on"===d||"1"===d||"yes"===d;break;default:case "string":this.parameters[b]=d}this.settings.customUrlParameterName}this.rewriteParameters()},initEventHandlers:function(){window.addEventListener("online",this.updateOnlineStatus.bind(this));window.addEventListener("offline",this.updateOnlineStatus.bind(this))},initOverlays:function(){this.addOfflineOverlay()},addOfflineOverlay:function(){this.divElements.offlineNotification=
document.createElement("div");this.divElements.offlineNotification.id="validator-overlay-offline-notification";this.divElements.offlineNotification.style.position="fixed";this.divElements.offlineNotification.style.width="100vw";this.divElements.offlineNotification.style.height="15px";this.divElements.offlineNotification.style.textAlign="center";this.divElements.offlineNotification.style.color="white";this.divElements.offlineNotification.style.fontFamily="Roboto";this.divElements.offlineNotification.style.fontSize=
"10px";this.divElements.offlineNotification.style.zIndex=100005;this.divElements.offlineNotification.innerHTML=this.settings.strings.offline;this.divElements.offlineNotification.style.background="rgba(255, 0, 0, 0.5)";this.divElements.offlineNotification.style.display="none";document.body.appendChild(this.divElements.offlineNotification);$("#"+this.divElements.offlineNotification.id).animate({top:0},0)},updateOnlineStatus:function(){!0===navigator.onLine?(this.hideOfflineNotification(),!0===this.gameState.hasEnded&&
!0!==this.gameState.hasEndApiCalled&&this.postEndValidation(),!0===this.gameState.hasStarted&&!0!==this.gameState.hasStartApiCalled&&this.postStartValidation(function(){!0===this.gameState.hasEnded&&!0!==this.gameState.hasEndApiCalled&&this.postEndValidation()}.bind(this))):!0===this.settings.showOfflineNotification&&this.showOfflineNotification()},hideOfflineNotification:function(){this.divElements.offlineNotification.style.background="rgba(0, 0, 0, 0)";this.divElements.offlineNotification.innerHTML=
"";this.divElements.offlineNotification.style.display="none"},showOfflineNotification:function(){this.divElements.offlineNotification.innerHTML=this.settings.strings.offline;this.divElements.offlineNotification.style.background="rgba(255, 0, 0, 0.7)";this.divElements.offlineNotification.style.display="block"},createPopupDiv:function(b,c,e,d){var g=ig.domHandler.getElementById("#"+b);if(null!==g&&"undefined"!==typeof g)return g;if(null!==this.divElements[c]&&"undefined"!==typeof this.divElements[c])return this.divElements[c];
var g=ig.domHandler.getElementById("#"+this.settings.gameContainterId),f=ig.domHandler.create("div");ig.domHandler.attr(f,"id",b);ig.domHandler.attr(f,"class","validator-overlay-container");ig.domHandler.appendChild(g,f);ig.domHandler.html(f,e);this.divElements[c]=f;"function"===typeof d&&d(f);return f},injectCustomCss:function(b){if(null!==b&&"undefined"!==typeof b){var c=ig.domHandler.create("style");ig.domHandler.attr(c,"type","text/css");"string"===typeof b&&ig.domHandler.html(c,b);ig.domHandler.appendToHead(c)}},
createLoaderDiv:function(){var b=ig.domHandler.getElementById("#"+this.settings.gameContainterId);this.createPopupDiv("validator-loader-container","loader",'<div class="validator-loader-spinner"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>');ig.domHandler.attr(this.divElements.loader,"class","validator-loader-container");ig.domHandler.appendChild(b,this.divElements.loader);this.injectCustomCss('.validator-loader-container{user-select: none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);z-index:1009}.validator-loader-spinner{color:official;display:inline-block;position:relative;width:80px;height:80px;left:50%;top:50%;transform:translate(-50%,-50%);-webkit-transform:translate(-50%,-50%)}.validator-loader-spinner div{transform-origin:40px 40px;animation:validator-loader-spinner 1.2s linear infinite}.validator-loader-spinner div:after{content:" ";display:block;position:fixed;top:3px;left:37px;width:6px;height:18px;border-radius:20%;background:#fff}.validator-loader-spinner div:nth-child(1){transform:rotate(0deg);animation-delay:-1.1s}.validator-loader-spinner div:nth-child(2){transform:rotate(30deg);animation-delay:-1s}.validator-loader-spinner div:nth-child(3){transform:rotate(60deg);animation-delay:-.9s}.validator-loader-spinner div:nth-child(4){transform:rotate(90deg);animation-delay:-.8s}.validator-loader-spinner div:nth-child(5){transform:rotate(120deg);animation-delay:-.7s}.validator-loader-spinner div:nth-child(6){transform:rotate(150deg);animation-delay:-.6s}.validator-loader-spinner div:nth-child(7){transform:rotate(180deg);animation-delay:-.5s}.validator-loader-spinner div:nth-child(8){transform:rotate(210deg);animation-delay:-.4s}.validator-loader-spinner div:nth-child(9){transform:rotate(240deg);animation-delay:-.3s}.validator-loader-spinner div:nth-child(10){transform:rotate(270deg);animation-delay:-.2s}.validator-loader-spinner div:nth-child(11){transform:rotate(300deg);animation-delay:-.1s}.validator-loader-spinner div:nth-child(12){transform:rotate(330deg);animation-delay:0s}@keyframes validator-loader-spinner{0%{opacity:1}100%{opacity:0}}')},
createPopupMessageDiv:function(b){var c=ig.domHandler.getElementById("#"+this.settings.gameContainterId);this.createPopupDiv("validator-popup-message-container","popupMessage",'<div class="validator-popup-message-container"><div class="validator-popup-message-content-center">'+b+"</div></div>");ig.domHandler.attr(this.divElements.popupMessage,"class","validator-popup-message-container");ig.domHandler.appendChild(c,this.divElements.popupMessage);this.injectCustomCss(".validator-popup-message-container{user-select: none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);z-index:1010}.validator-popup-message-content-center{color:white;font-size:3vmin;font-weight:bold;text-align: center;float:left;margin:auto;padding:auto;position:fixed;top:70%;left:50%;-webkit-transform:translate(-50%,-50%);-moz-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);-o-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}")},
showLoader:function(){(null===this.divElements.loader||"undefined"===typeof this.divElements.loader)&&this.createLoaderDiv();ig.domHandler.show(this.divElements.loader);if(null!==ig.visibilityHandler&&"undefined"!==typeof ig.visibilityHandler&&"function"===typeof ig.visibilityHandler.onOverlayShow)ig.visibilityHandler.onOverlayShow("Validator Loader")},pauseGame:function(){null!==ig.game&&"undefined"!==typeof ig.game&&(null!==ig.game.pause&&"function"===typeof ig.game.pause&&ig.game.pause(!0),null!==
ig.game.pauseGame&&"function"===typeof ig.game.pauseGame&&ig.game.pauseGame(!0),null!==ig.game.paused&&"function"===typeof ig.game.paused&&ig.game.paused(!0))},resumeGame:function(){null!==ig.game&&"undefined"!==typeof ig.game&&(null!==ig.game.resume&&"function"===typeof ig.game.resume&&ig.game.resume(!0),null!==ig.game.resumeGame&&"function"===typeof ig.game.resumeGame&&ig.game.resumeGame(!0),null!==ig.game.resumed&&"function"===typeof ig.game.resumed&&ig.game.resumed(!0),null!==ig.game.unpause&&
"function"===typeof ig.game.unpause&&ig.game.unpause(!0),null!==ig.game.unpauseGame&&"function"===typeof ig.game.unpauseGame&&ig.game.unpauseGame(!0),null!==ig.game.unpaused&&"function"===typeof ig.game.unpaused&&ig.game.unpaused(!0))},hideLoader:function(){null!==this.divElements.loader&&"undefined"!==typeof this.divElements.loader&&ig.domHandler.hide(this.divElements.loader);if(null!==ig.visibilityHandler&&"undefined"!==typeof ig.visibilityHandler&&"function"===typeof ig.visibilityHandler.onOverlayHide)ig.visibilityHandler.onOverlayHide("Validator Loader")},
showPopupMessage:function(b){null===this.divElements.popupMessage||"undefined"===typeof this.divElements.popupMessage?this.createPopupMessageDiv(b):(ig.domHandler.html(this.divElements.popupMessage,'<div class="validator-popup-message-content-center">'+b+"</div>"),ig.domHandler.show(this.divElements.popupMessage));if(null!==ig.visibilityHandler&&"undefined"!==typeof ig.visibilityHandler&&"function"===typeof ig.visibilityHandler.onOverlayShow)ig.visibilityHandler.onOverlayShow("Validator Message")},
hidePopupMessage:function(){null!==this.divElements.popupMessage&&"undefined"!==typeof this.divElements.popupMessage&&ig.domHandler.hide(this.divElements.popupMessage);if(null!==ig.visibilityHandler&&"undefined"!==typeof ig.visibilityHandler&&"function"===typeof ig.visibilityHandler.onOverlayHide)ig.visibilityHandler.onOverlayHide("Validator Message")},trackGameScore:function(b){this.progressData.score=b||0},trackGameLevel:function(b){b=parseInt(b)||1;this.progressData.level=b},trackUserAction:function(b){b=
b||"";this.progressData.actions.push({timestamp:this.getInternalGameTimeInMs(),action:b})},trackGameRestarted:function(b,c){!0===this.gameState.hasEnded?this.trackGameStarted(b,c):!0===this.gameState.hasStarted?this.postEndValidation(function(){this.resetGameState();this.resetGameData();this.progressData.timer=new ig.Timer;this.postStartValidation(b,c);this.gameState.hasStarted=!0;this.log("Game restarted");null!==b&&"function"===typeof b&&b()}.bind(this),function(){this.log("Game failed to restart");
this.trackGameFailed();null!==c&&"function"===typeof c&&c()}.bind(this)):this.trackGameStarted(b,c)},trackGameStarted:function(b,c){!0===this.gameState.hasEnded&&this.resetGameState();!0!==this.gameState.hasStarted&&(this.resetGameState(),this.resetGameData(),this.postStartValidation(function(){this.log("Game started");this.gameState.hasStarted=!0;null===this.progressData.timer||"undefined"===typeof this.progressData.timer?this.progressData.timer=new ig.Timer:this.progressData.timer.unpause();null!==
b&&"function"===typeof b&&b()}.bind(this),function(){this.log("Game failed to start");this.trackGameFailed();null!==c&&"function"===typeof c&&c()}.bind(this)))},trackGamePaused:function(){null!==this.progressData.timer&&"undefined"!==typeof this.progressData.timer&&this.progressData.timer.pause();this.log("Game paused")},trackGameResumed:function(){null!==this.progressData.timer&&"undefined"!==typeof this.progressData.timer&&this.progressData.timer.unpause();this.log("Game resumed")},trackGameInterrupted:function(b,
c,e){!0===this.gameState.hasStarted&&!0!==this.gameState.hasEnded&&(null!==this.progressData.timer&&"undefined"!==typeof this.progressData.timer&&this.progressData.timer.pause(),null!==b&&0<=b&&(this.progressData.score=b),this.postEndValidation(function(){this.resetGameState();this.resetGameData();this.stopProgressInterval();this.log("Game interrupted");null!==c&&"function"===typeof c&&c()}.bind(this),function(){this.log("Game failed to interrupt");this.trackGameFailed();null!==e&&"function"===typeof e&&
e()}.bind(this)))},trackGameEnded:function(b,c,e){!0===this.gameState.hasStarted&&!0!==this.gameState.hasEnded&&(this.gameState.hasEnded=!0,null!==this.progressData.timer&&"undefined"!==typeof this.progressData.timer&&this.progressData.timer.pause(),null!==b&&0<=b&&(this.progressData.score=b),this.stopProgressInterval(),this.postEndValidation(function(){this.log("Game ended");null!==c&&"function"===typeof c&&c()}.bind(this),function(){this.log("Game failed to end");this.trackGameFailed();null!==e&&
"function"===typeof e&&e()}.bind(this)))},trackGameFailed:function(){this.log("Game failed");"undefined"!==typeof this.settings.callback&&null!==this.settings.callback&&"function"===typeof this.settings.callback.gameFailed&&this.settings.callback.gameFailed()},getInternalGameTime:function(){var b=0;null!==this.progressData.timer&&"undefined"!==typeof this.progressData.timer&&(b=this.progressData.timer.delta());return b},getInternalGameTimeInMs:function(){return 1E3*this.getInternalGameTime()},formatTimeInMmSs:function(b){var c=
Math.floor(b/60);b=Math.floor(b%60);return(10>c?"0"+c:c)+":"+(10>b?"0"+b:b)},getEndGameTime:function(){var b=this.parameters.time;null!==this.progressData.timer&&"undefined"!==typeof this.progressData.timer&&(b=Math.max(0,this.parameters.time-this.getInternalGameTime()));return b},getEndGameTimeString:function(){return this.formatTimeInMmSs(this.getEndGameTime())},getInputIntervalMin:function(){var b=Infinity;if(2<=this.progressData.actions.length)for(var c=this.progressData.actions.length-1;0<c;c--){var e=
(this.progressData.actions[c].timestamp-this.progressData.actions[c-1].timestamp)/1E3;if("undefined"===typeof b||null===b||Infinity===b||isNaN(b))b=e;b=Math.min(b,e)}return b},getInputIdleMax:function(){var b=0,b=0;if(1<=this.progressData.actions.length){if(2<=this.progressData.actions.length)for(var c=this.progressData.actions.length-1;0<c;c--){var e=(this.progressData.actions[c].timestamp-this.progressData.actions[c-1].timestamp)/1E3;if("undefined"===typeof b||null===b||isNaN(b)||0===b)b=e;b=Math.max(b,
e)}b=Math.max(b,this.progressData.actions[0].timestamp/1E3);b=Math.max(b,this.getInternalGameTime()-this.progressData.actions[this.progressData.actions.length-1].timestamp/1E3)}else b=this.getInternalGameTime();return b},resetGameState:function(){this.gameState.hasStarted=!1;this.gameState.hasEnded=!1;this.gameState.hasStartApiCalled=!1;this.gameState.hasEndApiCalled=!1;this.gameState.startApiAttemptCount=0;this.gameState.endApiAttemptCount=0},resetGameData:function(){this.progressData.actions=[];
this.progressData.timer=null;this.progressData.score=0;this.progressData.level=1},setValidatorKey:function(b){this.settings.vsk=b},getEnc:function(b){b=JSON.stringify(b);if(""!==this.settings.vsk&&null!==this.settings.vsk&&"undefined"!==typeof this.settings.vsk){try{b=window.btoa((new Blowfish(window.atob(this.settings.vsk))).encrypt(b))}catch(c){}b={project_id:this.settings.project_id,validator_id:this.settings.validator_id,payload:b};b=JSON.stringify(b)}if(null!==this.settings.sk&&"undefined"!==
typeof this.settings.sk&&""!==this.settings.sk)try{b=window.btoa((new Blowfish(window.atob(this.settings.sk))).encrypt(b))}catch(e){}return b},startProgressInterval:function(){if(null===this.progressIntervalJobId||"undefined"===typeof this.progressIntervalJobId)this.progressIntervalJobId=window.setInterval(function(){this.postProgressValidation()}.bind(this),this.settings.progressAPI.interval);return this.progressIntervalJobId},stopProgressInterval:function(){null!==this.progressIntervalJobId&&"undefined"!==
typeof this.progressIntervalJobId&&(window.clearInterval(this.progressIntervalJobId),this.progressIntervalJobId=null);return this.progressIntervalJobId},postStartValidation:function(b,c){var e=this.settings.strings.loading;this.pauseGame();this.showLoader();this.showPopupMessage(e);var d=this.getEnc(JSON.parse(JSON.stringify({project_id:this.settings.project_id,validator_id:this.settings.validator_id,tournament_id:this.parameters.tournament_id,game_id:this.parameters.game_id,entry_id:this.parameters.entry_id,
user_id:this.parameters.user_id,user_name:this.parameters.user_name,env:this.parameters.env,host:this.parameters.host,pvp:this.parameters.pvp}))),g=function(){this.gameState.startApiAttemptCount>=this.settings.startAPI.maxAttempt?(this.log("Game start validation failed"),null!==c&&"function"===typeof c&&c(),this.showPopupMessage(this.settings.strings.error),this.pauseGame()):window.setTimeout(function(){this.postStartValidation(b,c)}.bind(this),this.settings.startAPI.attemptInterval)}.bind(this);
this.gameState.startApiAttemptCount<this.settings.startAPI.maxAttempt?(this.gameState.startApiAttemptCount++,e=2<=this.gameState.startApiAttemptCount?this.settings.strings.retry:this.settings.strings.start,e=e.replace("{CURRENT_ATTEMPT}",this.gameState.startApiAttemptCount).replace("{MAX_ATTEMPT}",this.settings.startAPI.maxAttempt),this.showPopupMessage(e),this.callXHR(this.settings.startAPI.method,this.settings.startAPI.url,this.settings.startAPI.timeout,{"Content-Type":this.getContentType()},d,
function(c){null!==c.access_token&&"undefined"!==typeof c.access_token?(this.log("Game start successfully validated"),this.progressData.at=c.access_token,null!==b&&"function"===typeof b&&b(c),this.hideLoader(),this.hidePopupMessage(),this.gameState.hasStartApiCalled=!0,this.resumeGame(),this.startProgressInterval()):g()}.bind(this),function(){g()}.bind(this))):g()},postProgressValidation:function(b,c){if(!0===this.gameState.hasStartApiCalled&&!0!==this.gameState.hasEndApiCalled){var e=this.getEnc(JSON.parse(JSON.stringify({project_id:this.settings.project_id,
validator_id:this.settings.validator_id,tournament_id:this.parameters.tournament_id,game_id:this.parameters.game_id,entry_id:this.parameters.entry_id,user_id:this.parameters.user_id,user_name:this.parameters.user_name,env:this.parameters.env,host:this.parameters.host,pvp:this.parameters.pvp,game_time:this.getInternalGameTimeInMs(),user_score:this.progressData.score,user_action:JSON.stringify(this.progressData.actions),level:this.progressData.level})));this.callXHR(this.settings.progressAPI.method,
this.settings.progressAPI.url,this.settings.progressAPI.timeout,{"Content-Type":this.getContentType(),Authorization:"Bearer "+this.progressData.at},e,function(d){null!==d.ping_validated&&"undefined"!==typeof d.ping_validated&&!0===d.ping_validated?(this.log("Game progress successfully validated"),null!==b&&"function"===typeof b&&b(d)):(this.log("Game progress failed validation"),null!==c&&"function"===typeof c&&c())}.bind(this),function(){this.log("Game progress failed validation");null!==c&&"function"===
typeof c&&c()}.bind(this))}},postEndValidation:function(b,c){var e=this.settings.strings.loading;this.showLoader();this.showPopupMessage(e);this.pauseGame();var d=this.getEnc(JSON.parse(JSON.stringify({project_id:this.settings.project_id,validator_id:this.settings.validator_id,tournament_id:this.parameters.tournament_id,game_id:this.parameters.game_id,entry_id:this.parameters.entry_id,user_id:this.parameters.user_id,user_name:this.parameters.user_name,env:this.parameters.env,host:this.parameters.host,
pvp:this.parameters.pvp,game_time:this.getInternalGameTimeInMs(),user_score:this.progressData.score,user_action:JSON.stringify(this.progressData.actions),level:this.progressData.level}))),g=function(){this.gameState.endApiAttemptCount>=this.settings.endAPI.maxAttempt?(this.log("Game end validation failed"),null!==c&&"function"===typeof c&&c(),this.showPopupMessage(this.settings.strings.error),this.pauseGame()):window.setTimeout(function(){this.postEndValidation(b,c)}.bind(this),this.settings.endAPI.attemptInterval)}.bind(this);
this.gameState.endApiAttemptCount<this.settings.endAPI.maxAttempt?(this.gameState.endApiAttemptCount++,e=2<=this.gameState.endApiAttemptCount?this.settings.strings.retry:this.settings.strings.end,e=e.replace("{CURRENT_ATTEMPT}",this.gameState.endApiAttemptCount).replace("{MAX_ATTEMPT}",this.settings.endAPI.maxAttempt),this.showPopupMessage(e),this.callXHR(this.settings.endAPI.method,this.settings.endAPI.url,this.settings.endAPI.timeout,{"Content-Type":this.getContentType(),Authorization:"Bearer "+
this.progressData.at},d,function(c){null!==c.session_validated&&"undefined"!==typeof c.session_validated&&!0===c.session_validated?(this.log("Game end successfully validated"),null!==b&&"function"===typeof b&&b(c),this.hideLoader(),this.hidePopupMessage(),this.gameState.hasEndApiCalled=!0,this.resumeGame()):g()}.bind(this),function(){g()}.bind(this))):g()},getContentType:function(){var b="application/json";"undefined"!==typeof this.settings.sk&&(null!==this.settings.sk&&""!==this.settings.sk)&&(b=
"text/plain");return b},callXHR:function(b,c,e,d,g,f,m){var l=new XMLHttpRequest;l.open(b,c,!0);l.timeout=e||5E3;if(null!==d&&"undefined"!==typeof d)for(var j in d)l.setRequestHeader(j,d[j]);l.onreadystatechange=function(){if(4===l.readyState){var b="";try{b=JSON.parse(l.responseText),200===l.status?null!==f&&"function"===typeof f&&f(b):null!==m&&"function"===typeof m&&m()}catch(c){null!==m&&"function"===typeof m&&m()}}}.bind(this);null!==g&&"undefined"!==typeof g?l.send(g):l.send()},log:function(b){if(this.parameters.verbose)switch(this.parameters.verbose){case "false":case "off":case "0":case "":case null:case void 0:break;
default:case "true":case "on":case "1":window.console&&"function"===typeof window.console.log&&console.log("%c ["+this.NAME+" v"+this.VERSION+"] "+b+" ","color: #F35E36; background: #0B31A1;");break;case "trace":case "2":window.console&&"function"===typeof window.console.trace&&console.trace("%c ["+this.NAME+" v"+this.VERSION+"] "+b+" ","color: #F35E36; background: #0B31A1;")}}})});ig.baked=!0;
ig.module("plugins.linkit360-skill").requires("plugins.handlers.api-handler","plugins.validator").defines(function(){ig.Linkit360Skill=ig.ApiHandler.inject({NAME:"Linkit360 Skill API",VERSION:"1.0.0",parameters:{properties:{verbose:{type:"string","default":null}}},settings:{vsk:"",validator_id:"",project_id:""},googleAnalytics:{enabled:!0,hasInit:!1,gtag:{ids:["G-DJYL5K4HT7"]},attributes:{src:"https://www.googletagmanager.com/gtag/js",async:!0}},gameState:{hasStarted:!1,hasEnded:!1},progressIntervalJobId:null,
progressData:{at:0,score:0,level:1,actions:[],timer:null},init:function(b){this.mergeSettings(b);this.setAlias();this.getUrlParameters();this.initGA();this.whitelabel();this.reorientGame();this.ready();return this},ready:function(){this.log("Initialized");try{this.validator=new ig.Validator({sk:"JDJhJDEwJGZvajBTOGN5V2RpTmM5NjlQQi4veU8yMjYxT1J3RVM5YW5lck5mZi8vNkQzcmRLa3VBMWV1",vsk:"XiEjXWpBdEdQUHZhVVQ3LmdRck0rKzVlRzwvNUMnKEhTRWhZYyhqeyFUQldyeV9McX1xK3VSWXc=",validator_id:this.settings.validator_id,
project_id:this.settings.project_id,callback:{gameFailed:this.trackGameFailed.bind(this)}})}catch(b){}},mergeSettings:function(b){ig.merge(this.settings,b);if(this.validator)for(var c in b)this.validator.settings.hasOwnProperty(c)&&(this.validator.settings[c]=b[c])},setAlias:function(){ig.linkit360Skill=this;ig.global.linkit360Skill=window.linkit360Skill=this},setProjectId:function(b,c){"undefined"!==typeof b&&null!==b&&(this.settings.project_id=b);"undefined"!==typeof c&&null!==c&&(this.settings.validator_id=
c);try{this.validator.setProjectId(b,c)}catch(e){}},setValidatorId:function(b,c){"undefined"!==typeof b&&null!==b&&(this.settings.validator_id=b);"undefined"!==typeof c&&null!==c&&(this.settings.project_id=c);try{this.validator.setValidatorId(b,c)}catch(e){}},getQueryVariable:function(b){for(var c=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),e=0;e<c.length;e++){var d=c[e].match(/([^=]+?)=(.+)/);if(d){var g=decodeURIComponent(d[1]),d=decodeURIComponent(d[2]);if(b===g)return d}}},
mapUrlParameters:function(){if("undefined"!==typeof this.settings.customUrlParameterName&&null!==this.settings.customUrlParameterName)for(var b in this.settings.customUrlParameterName){var c=this.settings.customUrlParameterName[b];b!==c&&this.parameters.properties.hasOwnProperty(b)&&(this.parameters.properties[c]=this.parameters.properties[b])}},rewriteParameters:function(){if("undefined"!==typeof this.settings.customUrlParameterName&&null!==this.settings.customUrlParameterName)for(var b in this.settings.customUrlParameterName){var c=
b,e=this.settings.customUrlParameterName[b];c!==e&&this.parameters.hasOwnProperty(e)&&(this.parameters[c]=this.parameters[e])}},getUrlParameters:function(){this.mapUrlParameters();for(var b in this.parameters.properties)if(this.parameters.properties.hasOwnProperty(b)){var c=this.parameters.properties[b].type,e=this.parameters.properties[b].default,d=this.getQueryVariable(b);"undefined"!==typeof e&&null!==e&&(this.parameters[b]=e);if("undefined"!==typeof d&&null!==d)switch(c){case "float":this.parameters[b]=
parseFloat(d);break;case "integer":this.parameters[b]=parseInt(d);break;case "boolean":this.parameters[b]="true"===d||"on"===d||"1"===d||"yes"===d;break;default:case "string":this.parameters[b]=d}this.settings.customUrlParameterName}this.rewriteParameters()},injectElementTag:function(b,c,e,d,g,f,m){if(!b.getElementById(d)&&!(null===c||void 0===typeof c)){b=b.createElement(e);"string"===typeof d&&null!==d&&(b.id=d);if(null!==g&&"object"===typeof g)for(var l in g)g.hasOwnProperty(l)&&b.setAttribute(l,
g[l]);null!==f&&"string"===typeof f&&(b.innerHTML=f);b.onload=m;c.appendChild(b);return b}},initGA:function(){if(this.googleAnalytics&&this.googleAnalytics.enabled){if(this.googleAnalytics.hasInit)return!1;this.injectElementTag(window.document,window.document.head,"script","gtag",this.googleAnalytics.attributes,null,function(){function b(){dataLayer.push(arguments)}this.googleAnalytics.hasInit=!0;window.dataLayer=window.dataLayer||[];b("js",new Date);for(var c=0;c<this.googleAnalytics.gtag.ids.length;c++)b("config",
this.googleAnalytics.gtag.ids[c])}.bind(this))}},trackEvent:function(b,c){if(null===c||"undefined"===typeof c)c={};try{null!==window.top&&"undefined"!==typeof window.top&&null!==window.top.postMessage&&"function"===typeof window.top.postMessage&&window.top.postMessage(JSON.stringify({name:b,timestamp:new Date,data:c}),"*")}catch(e){}},trackGameScore:function(b){b=parseInt(b)||0;this.progressData.score=b;try{this.validator.trackGameScore(b)}catch(c){}},trackGameLevel:function(b){b=parseInt(b)||1;this.progressData.level=
b;this.trackEvent("GameLevelChanged");try{this.validator.trackGameLevel(b)}catch(c){}},trackUserAction:function(b){b=b||"";this.progressData.actions.push({timestamp:parseInt(this.getInternalGameTimeInMs()),action:b});try{this.validator.trackUserAction(b)}catch(c){}},trackGameRestarted:function(b,c){if(!0===this.gameState.hasEnded)this.trackGameStarted(b,c);else if(!0===this.gameState.hasStarted){this.trackEvent("GameEnd");this.resetGameState();this.resetGameData();this.progressData.timer=new ig.Timer;
this.gameState.hasStarted=!0;try{this.validator.trackGameRestarted(function(){this.log("Game restarted");this.trackEvent("GameStart");null!==b&&"function"===typeof b&&b()}.bind(this),function(){this.trackGameFailed();null!==c&&"function"===typeof c&&c()}.bind(this))}catch(e){}}else this.trackGameStarted(b,c)},trackGameStarted:function(b,c){!0===this.gameState.hasEnded&&this.resetGameState();if(!0!==this.gameState.hasStarted){this.resetGameState();this.resetGameData();try{this.validator.trackGameStarted(function(){this.log("Game started");
this.trackEvent("GameStart");this.gameState.hasStarted=!0;this.gameState.hasEnded=!1;null===this.progressData.timer||"undefined"===typeof this.progressData.timer?this.progressData.timer=new ig.Timer:this.progressData.timer.unpause();null!==b&&"function"===typeof b&&b()}.bind(this),function(){this.trackGameFailed();null!==c&&"function"===typeof c&&c()}.bind(this))}catch(e){}}},trackGamePaused:function(){null!==this.progressData.timer&&"undefined"!==typeof this.progressData.timer&&this.progressData.timer.pause();
this.log("Game paused");this.trackEvent("GamePaused");try{this.validator.trackGamePaused()}catch(b){}},trackGameResumed:function(){null!==this.progressData.timer&&"undefined"!==typeof this.progressData.timer&&this.progressData.timer.unpause();this.log("Game resumed");this.trackEvent("GameResumed");try{this.validator.trackGameResumed()}catch(b){}},trackGameInterrupted:function(b,c,e){!0===this.gameState.hasStarted&&!0!==this.gameState.hasEnded&&(null!==this.progressData.timer&&"undefined"!==typeof this.progressData.timer&&
this.progressData.timer.pause(),null!==b&&0<=b&&(this.progressData.score=parseInt(b)));this.resetGameState();this.resetGameData();try{this.validator.trackGameInterrupted(b,function(){this.log("Game interrupted");this.trackEvent("GameEnd");null!==c&&"function"===typeof c&&c()}.bind(this),function(){this.trackGameFailed();null!==e&&"function"===typeof e&&e()}.bind(this))}catch(d){}},trackGameEnded:function(b,c,e){if(!0===this.gameState.hasStarted&&!0!==this.gameState.hasEnded){this.gameState.hasEnded=
!0;null!==this.progressData.timer&&"undefined"!==typeof this.progressData.timer&&this.progressData.timer.pause();null!==b&&0<=b&&(this.progressData.score=parseInt(b));try{this.validator.trackGameEnded(b,function(){this.log("Game ended");this.trackEvent("GameEnd");null!==c&&"function"===typeof c&&c()}.bind(this),function(){this.trackGameFailed();null!==e&&"function"===typeof e&&e()}.bind(this))}catch(d){}}},trackGameFailed:function(){this.log("Game failed");this.trackEvent("GameFailed")},getInternalGameTime:function(){var b=
0;null!==this.progressData.timer&&"undefined"!==typeof this.progressData.timer&&(b=this.progressData.timer.delta());return b},getInternalGameTimeInMs:function(){return 1E3*this.getInternalGameTime()},formatTimeInMmSs:function(b){var c=Math.floor(b/60);b=Math.floor(b%60);return(10>c?"0"+c:c)+":"+(10>b?"0"+b:b)},getEndGameTime:function(){var b=this.parameters.time;null!==this.progressData.timer&&"undefined"!==typeof this.progressData.timer&&(b=Math.max(0,this.parameters.time-this.getInternalGameTime()));
return b},getEndGameTimeString:function(){return this.formatTimeInMmSs(this.getEndGameTime())},resetGameState:function(){this.gameState.hasStarted=!1;this.gameState.hasEnded=!1},resetGameData:function(){this.progressData.actions=[];this.progressData.timer=null;this.progressData.score=0;this.progressData.level=1},reorientGame:function(){"undefined"!==typeof ig&&"undefined"!==typeof ig.sizeHandler&&"function"===typeof ig.sizeHandler.reorient&&ig.sizeHandler.reorient();"function"===typeof orientationHandler&&
orientationHandler()},whitelabel:function(){_SETTINGS&&"undefined"!==typeof _SETTINGS&&(_SETTINGS.Branding&&"undefined"!==typeof _SETTINGS.Branding&&(_SETTINGS.Branding.Splash.Enabled=!1,_SETTINGS.Branding.Logo.Enabled=!1),_SETTINGS.DeveloperBranding&&"undefined"!==typeof _SETTINGS.DeveloperBranding&&(_SETTINGS.DeveloperBranding.Splash.Enabled=!1),_SETTINGS.MoreGames&&"undefined"!==typeof _SETTINGS.MoreGames&&(_SETTINGS.MoreGames.Enabled=!1,_SETTINGS.MoreGames.Link="https://linkit360.com/"),_SETTINGS.TapToStartAudioUnlock&&
"undefined"!==typeof _SETTINGS.TapToStartAudioUnlock&&(_SETTINGS.TapToStartAudioUnlock.Enabled=!1));MyGame&&"undefined"!==typeof MyGame&&(MyGame.prototype.dctf=function(){});ig&&"undefined"!==typeof ig.Fullscreen&&(ig.Fullscreen.enableFullscreenButton=!1)},log:function(b){if(this.parameters.verbose)switch(this.parameters.verbose){case "false":case "off":case "0":case "":case null:case void 0:break;default:case "true":case "on":case "1":window.console&&"function"===typeof window.console.log&&console.log("%c ["+
this.NAME+" v"+this.VERSION+"] "+b+" ","color: #FFFFFF; background: #1A1C20;");break;case "trace":case "2":window.console&&"function"===typeof window.console.trace&&console.trace("%c ["+this.NAME+" v"+this.VERSION+"] "+b+" ","color: #FFFFFF; background: #1A1C20;")}}})});this.START_BRANDING_SPLASH;ig.baked=!0;
ig.module("plugins.branding.splash").requires("impact.impact","impact.entity").defines(function(){ig.BrandingSplash=ig.Class.extend({init:function(){ig.game.spawnEntity(EntityBranding,0,0)}});EntityBranding=ig.Entity.extend({autoUpdateScale:!1,gravityFactor:0,size:{x:32,y:32},splash:new ig.Image("branding/splash1.png"),init:function(b,c,e){this.parent(b,c,e);320>=ig.system.width?(this.size.x=320,this.size.y=200):(this.size.x=480,this.size.y=240);this.pos.x=(ig.system.width-this.size.x)/2;this.pos.y=
-this.size.y-200;this.endPosY=(ig.system.height-this.size.y)/2;b=this.tween({pos:{y:this.endPosY}},0.5,{easing:ig.Tween.Easing.Bounce.EaseIn});c=this.tween({},2.5,{onComplete:function(){ig.game.director.loadLevel(ig.game.director.currentLevel)}});b.chain(c);b.start();this.currentAnim=this.anims.idle},createClickableLayer:function(){console.log("Build clickable layer");this.checkClickableLayer("branding-splash",_SETTINGS.Branding.Logo.Link,_SETTINGS.Branding.Logo.NewWindow)},doesClickableLayerExist:function(b){for(k in dynamicClickableEntityDivs)if(k==
b)return!0;return!1},checkClickableLayer:function(b,c,e){"undefined"==typeof wm&&(this.doesClickableLayerExist(b)?(ig.game.showOverlay([b]),$("#"+b).find("[href]").attr("href",c)):this.createClickableOutboundLayer(b,c,"media/graphics/misc/invisible.png",e))},createClickableOutboundLayer:function(b,c,e,d){var g=ig.$new("div");g.id=b;document.body.appendChild(g);g=$("#"+g.id);g.css("float","left");g.css("position","absolute");if(ig.ua.mobile){var f=window.innerHeight/mobileHeight,m=window.innerWidth/
mobileWidth;g.css("left",this.pos.x*m);g.css("top",this.pos.y*f);g.css("width",this.size.x*m);g.css("height",this.size.y*f)}else f=w/2-destW/2,m=h/2-destH/2,console.log(f,m),g.css("left",f+this.pos.x*multiplier),g.css("top",m+this.pos.y*multiplier),g.css("width",this.size.x*multiplier),g.css("height",this.size.y*multiplier);d?g.html("<a target='_blank' href='"+c+"'><img style='width:100%;height:100%' src='"+e+"'></a>"):g.html("<a href='"+c+"'><img style='width:100%;height:100%' src='"+e+"'></a>");
dynamicClickableEntityDivs[b]={};dynamicClickableEntityDivs[b].width=this.size.x*multiplier;dynamicClickableEntityDivs[b].height=this.size.y*multiplier;dynamicClickableEntityDivs[b].entity_pos_x=this.pos.x;dynamicClickableEntityDivs[b].entity_pos_y=this.pos.y},draw:function(){ig.system.context.fillStyle="#ffffff";ig.system.context.fillRect(0,0,ig.system.width,ig.system.height);ig.system.context.fillStyle="#000";ig.system.context.font="12px Arial";ig.system.context.textAlign="left";320>=ig.system.width?
ig.system.context.fillText("powered by MarketJS.com",ig.system.width-150,ig.system.height-15):ig.system.context.fillText("powered by MarketJS.com",ig.system.width-160,ig.system.height-15);this.parent();this.splash&&ig.system.context.drawImage(this.splash.data,0,0,this.splash.data.width,this.splash.data.height,this.pos.x,this.pos.y,this.size.x,this.size.y)}})});this.END_BRANDING_SPLASH;ig.baked=!0;
ig.module("plugins.datastructure.binary-heap").defines(function(){BinaryHeap=ig.Class.extend({content:[],getValue:null,minHeap:!0,tagName:"BinaryHeap",init:function(b,c){this.getValue=b;c&&(this.minHeap=!1)},push:function(b){this.content.push(b);this.sinkDown(this.content.length-1)},pop:function(){var b=this.content[0],c=this.content.pop();0<this.content.length&&(this.content[0]=c,this.bubbleUp(0));return b},remove:function(b){var c=this.content.indexOf(b),e=this.content.pop();c!==this.content.length-
1&&(this.content[c]=e,this.minHeap?this.getValue(e)<this.getValue(b)?this.sinkDown(c):this.bubbleUp(c):this.getValue(e)>this.getValue(b)?this.sinkDown(c):this.bubbleUp(c))},size:function(){return this.content.length},rescoreElement:function(b){this.sinkDown(this.content.indexOf(b))},sinkDown:function(b){for(var c=this.content[b];0<b;){var e=(b+1>>1)-1,d=this.content[e];if(this.minHeap)if(this.getValue(c)<this.getValue(d))this.content[e]=c,this.content[b]=d,b=e;else break;else if(this.getValue(c)>
this.getValue(d))this.content[e]=c,this.content[b]=d,b=e;else break}},bubbleUp:function(b){for(var c=this.content.length,e=this.content[b],d=this.getValue(e);;){var g=b+1<<1,f=g-1,m=null,l;f<c&&(l=this.getValue(this.content[f]),this.minHeap?l<d&&(m=f):l>d&&(m=f));if(g<c)if(f=this.getValue(this.content[g]),this.minHeap){if(f<(null===m?d:l))m=g}else if(f>(null===m?d:l))m=g;if(null!==m)this.content[b]=this.content[m],this.content[m]=e,b=m;else break}},empty:function(){for(;0<this.content.length;)this.content.pop()}})});
ig.baked=!0;
ig.module("game.entities.buttons.button").requires("impact.entity").defines(function(){EntityButton=ig.Entity.extend({collides:ig.Entity.COLLIDES.NEVER,type:ig.Entity.TYPE.A,size:new BABYLON.Vector2(48,48),fillColor:null,zIndex:95E3,pos:{x:0,y:0},name:"button",init:function(b,c,e){this.parent(b,c,e);!ig.global.wm&&(e&&!isNaN(e.zIndex))&&(this.zIndex=e.zIndex);b=Math.floor(256*Math.random());c=Math.floor(256*Math.random());e=Math.floor(256*Math.random());this.fillColor="rgba("+b+","+e+","+c+",1)"},
clicked:function(){throw"no implementation on clicked()";},clicking:function(){throw"no implementation on clicking()";},released:function(){throw"no implementation on released()";}})});ig.baked=!0;
ig.module("plugins.clickable-div-layer").defines(function(){ClickableDivLayer=ig.Class.extend({pos:new BABYLON.Vector2(0,0),size:new BABYLON.Vector2(0,0),identifier:null,invisImagePath:"media/graphics/misc/invisible.png",init:function(b){this.pos=new BABYLON.Vector2(b.pos.x,b.pos.y);this.size=new BABYLON.Vector2(b.size.x,b.size.y);var c="more-games",e="www.google.com",d=!1;b.div_layer_name&&(c=b.div_layer_name);b.link&&(e=b.link);b.newWindow&&(d=b.newWindow);this.createClickableLayer(c,e,d)},createClickableLayer:function(b,
c,e){this.identifier=b;var d=ig.domHandler.getElementById("#"+b);d?(ig.domHandler.show(d),ig.domHandler.attr(d,"href",c)):this.createClickableOutboundLayer(b,c,this.invisImagePath,e)},update:function(b,c,e,d){this.pos.x==b&&this.pos.y==c||(this.pos.x=b,this.pos.y=c,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier]={},ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].width=e,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].height=d,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].entity_pos_x=
this.pos.x,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].entity_pos_y=this.pos.y,ig.sizeHandler.resizeLayers())},createClickableOutboundLayer:function(b,c,e,d){var g=ig.domHandler.create("div");ig.domHandler.attr(g,"id",b);var f=ig.domHandler.create("a");ig.domHandler.addEvent(g,"mousedown",function(b){b.preventDefault()});d?(ig.domHandler.attr(f,"href",c),ig.domHandler.attr(f,"target","_blank")):ig.domHandler.attr(f,"href",c);c=ig.domHandler.create("img");ig.domHandler.css(c,{width:"100%",
height:"100%"});ig.domHandler.attr(c,"src",e);e=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);if(ig.ua.mobile){d=Math.floor(this.pos.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px";var m=Math.floor(this.pos.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px",l=Math.floor(this.size.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px";e=Math.floor(this.size.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px"}else d=ig.domHandler.getElementById("#canvas"),d=ig.domHandler.getOffsets(d),
m=d.top,d=Math.floor(d.left+this.pos.x*e)+"px",m=Math.floor(m+this.pos.y*e)+"px",l=Math.floor(this.size.x*e)+"px",e=Math.floor(this.size.y*e)+"px";ig.domHandler.css(g,{"float":"left",position:"absolute",left:d,top:m,width:l,height:e,"z-index":3});ig.domHandler.addEvent(g,"mousemove",ig.input.mousemove.bind(ig.input),!1);ig.domHandler.appendChild(f,c);ig.domHandler.appendChild(g,f);ig.domHandler.appendToBody(g);ig.sizeHandler.dynamicClickableEntityDivs[b]={};ig.sizeHandler.dynamicClickableEntityDivs[b].width=
this.size.x;ig.sizeHandler.dynamicClickableEntityDivs[b].height=this.size.y;ig.sizeHandler.dynamicClickableEntityDivs[b].entity_pos_x=this.pos.x;ig.sizeHandler.dynamicClickableEntityDivs[b].entity_pos_y=this.pos.y}})});ig.baked=!0;
ig.module("game.entities.buttons.button-branding-logo").requires("game.entities.buttons.button","plugins.clickable-div-layer").defines(function(){EntityButtonBrandingLogo=EntityButton.extend({type:ig.Entity.TYPE.A,gravityFactor:0,logo:new ig.AnimationSheet("branding/logo.png",_SETTINGS.Branding.Logo.Width,_SETTINGS.Branding.Logo.Height),zIndex:10001,size:{x:64,y:66},clickableLayer:null,link:null,newWindow:!1,div_layer_name:"branding-logo",name:"brandinglogo",init:function(b,c,e){this.parent(b,c,e);
if(!ig.global.wm){ig.responsive&&(this.anchorType="default");if("undefined"==typeof wm)if(_SETTINGS.Branding.Logo.Enabled)this.size.x=_SETTINGS.Branding.Logo.Width,this.size.y=_SETTINGS.Branding.Logo.Height,this.anims.idle=new ig.Animation(this.logo,0,[0],!0),this.currentAnim=this.anims.idle,e&&e.centralize&&(this.pos.x=(ig.system.width>>>1)-(this.size.x>>>1),console.log("centralize true ... centering branded logo ...")),_SETTINGS.Branding.Logo.LinkEnabled&&(this.link=_SETTINGS.Branding.Logo.Link,
this.newWindow=_SETTINGS.Branding.Logo.NewWindow,this.clickableLayer=new ClickableDivLayer(this));else{this.kill();return}this.div_layer_name=e.div_layer_name?e.div_layer_name:"branding-logo"}},show:function(){var b=ig.domHandler.getElementById("#"+this.div_layer_name);ig.domHandler.show(b)},hide:function(){var b=ig.domHandler.getElementById("#"+this.div_layer_name);ig.domHandler.hide(b)},clicked:function(){},clicking:function(){},released:function(){}})});ig.baked=!0;
ig.module("game.entities.branding-logo-placeholder").requires("impact.entity","game.entities.buttons.button-branding-logo").defines(function(){EntityBrandingLogoPlaceholder=ig.Entity.extend({gravityFactor:0,size:{x:32,y:32},_wmDrawBox:!0,_wmBoxColor:"rgba(0, 0, 255, 0.7)",init:function(b,c,e){this.parent(b,c,e);ig.responsive&&(this.anchorType="default");if(e)switch(console.log("settings found ... using that div layer name"),b=e.div_layer_name,console.log("settings.centralize:",e.centralize),e.centralize){case "true":console.log("centralize true");
centralize=!0;break;case "false":console.log("centralize false");centralize=!1;break;default:console.log("default ... centralize false"),centralize=!1}else b="branding-logo",centralize=!1;if("undefined"==typeof wm){if(_SETTINGS.Branding.Logo.Enabled)try{ig.game.spawnEntity(EntityButtonBrandingLogo,this.pos.x,this.pos.y,{div_layer_name:b,centralize:centralize})}catch(d){console.log(d)}this.kill()}}})});ig.baked=!0;
ig.module("game.entities.buttons.button-more-games").requires("game.entities.buttons.button","plugins.clickable-div-layer").defines(function(){EntityButtonMoreGames=EntityButton.extend({type:ig.Entity.TYPE.A,gravityFactor:0,logo:new ig.AnimationSheet("media/graphics/game/more-games-btn.png",64,66),size:{x:64,y:66},zIndex:750,clickableLayer:null,link:null,newWindow:!1,div_layer_name:"more-games",name:"moregames",init:function(b,c,e){this.parent(b,c,e);ig.global.wm||(ig.responsive&&(this.anchorType=
"default"),this.div_layer_name=e.div_layer_name?e.div_layer_name:"more-games",_SETTINGS.MoreGames.Enabled?(this.anims.idle=new ig.Animation(this.logo,0,[0],!0),this.currentAnim=this.anims.idle,_SETTINGS.MoreGames.Link&&(this.link=_SETTINGS.MoreGames.Link),_SETTINGS.MoreGames.NewWindow&&(this.newWindow=_SETTINGS.MoreGames.NewWindow),this.clickableLayer=new ClickableDivLayer(this)):this.kill())},update:function(){this.parent();this.clickableLayer.update(this.pos.x,this.pos.y,this.size.x,this.size.y)},
show:function(){var b=ig.domHandler.getElementById("#"+this.div_layer_name);ig.domHandler.show(b)},hide:function(){var b=ig.domHandler.getElementById("#"+this.div_layer_name);ig.domHandler.hide(b)},clicked:function(){},clicking:function(){},released:function(){}})});ig.baked=!0;
ig.module("game.entities.pointer").requires("impact.entity").defines(function(){EntityPointer=ig.Entity.extend({checkAgainst:ig.Entity.TYPE.BOTH,isFirstPressed:!1,isPressed:!1,isReleased:!1,isHovering:!1,hoveringItem:null,objectArray:[],clickedObjectList:[],ignorePause:!0,zIndex:5E3,name:"pointer",check:function(b){this.objectArray.push(b)},clickObject:function(b){this.isFirstPressed&&"function"==typeof b.clicked&&(b.clicked(),this.addToClickedObjectList(b));this.isPressed&&!this.isReleased&&"function"==
typeof b.clicking&&b.clicking();this.isReleased&&"function"==typeof b.released&&(b.released(),this.removeFromClickedObjectList(b))},refreshPos:function(){this.pos=ig.game.io.getClickPos()},update:function(){this.parent();this.refreshPos();var b=null,c=-1;for(a=this.objectArray.length-1;-1<a;a--)this.objectArray[a].zIndex>c&&(c=this.objectArray[a].zIndex,b=this.objectArray[a]);if(null!=b)null!=this.hoveringItem?this.hoveringItem!=b&&("function"==typeof this.hoveringItem.leave&&this.hoveringItem.leave(),
"function"==typeof b.over&&b.over()):"function"==typeof b.over&&b.over(),this.hoveringItem=this.lastEnt=b,this.clickObject(b),this.objectArray=[];else if(null!=this.hoveringItem&&"function"==typeof this.hoveringItem.leave&&(this.hoveringItem.leave(),this.hoveringItem=null),this.isReleased){for(b=0;b<this.clickedObjectList.length;b++)c=this.clickedObjectList[b],"function"==typeof c.releasedOutside&&c.releasedOutside();this.lastEnt&&(this.lastEnt.released&&this.lastEnt.released(),this.lastEnt=null);
this.clickedObjectList=[]}this.isFirstPressed=ig.input.pressed("click");this.isReleased=ig.input.released("click");this.isPressed=ig.input.state("click")},addToClickedObjectList:function(b){this.clickedObjectList.push(b)},removeFromClickedObjectList:function(b){for(var c=[],e=0;e<this.clickedObjectList.length;e++){var d=this.clickedObjectList[e];d!=b&&c.push(d)}this.clickedObjectList=c}})});ig.baked=!0;
ig.module("game.entities.pointer-selector").requires("game.entities.pointer").defines(function(){EntityPointerSelector=EntityPointer.extend({zIndex:1E3,_wmDrawBox:!0,_wmBoxColor:"rgba(0, 0, 255, 0.7)",size:{x:20,y:20},init:function(b,c,e){this.parent(b,c,e)}})});ig.baked=!0;
ig.module("game.entities.select").requires("impact.entity").defines(function(){EntitySelect=ig.Entity.extend({type:ig.Entity.TYPE.B,checkAgainst:ig.Entity.TYPE.A,collides:ig.Entity.COLLIDES.NEVER,canSelect:!1,canSelectTimerDuration:0.35,zIndex:99999,isHovering:!1,isSelected:!1,init:function(b,c,e){this.parent(b,c,e);this.canSelectTimer=new ig.Timer(this.canSelectTimerDuration)},doesClickableLayerExist:function(b){for(k in dynamicClickableEntityDivs)if(k==b)return!0;return!1},checkClickableLayer:function(b,
c,e){"undefined"==typeof wm&&(this.doesClickableLayerExist(b)?(ig.game.showOverlay([b]),$("#"+b).find("[href]").attr("href",c)):this.createClickableOutboundLayer(b,c,"media/graphics/misc/invisible.png",e))},createClickableOutboundLayer:function(b,c,e,d){var g=ig.$new("div");g.id=b;document.body.appendChild(g);$("#"+g.id).css("float","left");$("#"+g.id).css("width",this.size.x*multiplier);$("#"+g.id).css("height",this.size.y*multiplier);$("#"+g.id).css("position","absolute");var f=w/2-destW/2,m=h/
2-destH/2;w==mobileWidth?($("#"+g.id).css("left",this.pos.x),$("#"+g.id).css("top",this.pos.y)):($("#"+g.id).css("left",f+this.pos.x*multiplier),$("#"+g.id).css("top",m+this.pos.y*multiplier));d?$("#"+g.id).html("<a target='_blank' href='"+c+"'><img style='width:100%;height:100%' src='"+e+"'></a>"):$("#"+g.id).html("<a href='"+c+"'><img style='width:100%;height:100%' src='"+e+"'></a>");dynamicClickableEntityDivs[b]={};dynamicClickableEntityDivs[b].width=$("#"+g.id).width();dynamicClickableEntityDivs[b].height=
$("#"+g.id).height();dynamicClickableEntityDivs[b].entity_pos_x=this.pos.x;dynamicClickableEntityDivs[b].entity_pos_y=this.pos.y},hovered:function(){this.isHovering=!0;this.dehoverOthers()},dehoverOthers:function(){var b=ig.game.getEntitiesByType(EntitySelect);for(i=0;i<b.length;i++)b[i]!=this&&(b[i].isHovering=!1)},deselectOthers:function(){var b=ig.game.getEntitiesByType(EntitySelect);for(i=0;i<b.length;i++)b[i]!=this&&(b[i].isSelected=!1)},update:function(){this.parent();this.canSelectTimer&&0<
this.canSelectTimer.delta()&&(this.canSelect=!0,this.canSelectTimer=null)}})});ig.baked=!0;
ig.module("game.entities.opening-marketjs-logo").requires("impact.entity").defines(function(){EntityOpeningMarketJSLogo=ig.Entity.extend({objects:[],letterM:null,logoShield:null,text:null,localTweens:[],logoOriX:0,logoOriY:0,textOriX:0,textOriY:0,logoCanvas:null,init:function(b,c,d){this.parent(b,c,d);console.log("Opening v1.0.4");logoSize=148/960*Math.min(ig.system.width,ig.system.height);this.logoCacheSize=Math.round(2*logoSize);this.text=this.addObject("drawText",0,0,logoSize,logoSize);this.cover=
this.addObject("drawCover",0,0,logoSize,logoSize);this.logoShield=this.addObject("drawLogoShield",0,0,logoSize,logoSize);this.letterM=this.addObject("drawLetterM",0,0,logoSize,logoSize);this.logoOriX=0-2.2*logoSize;this.logoOriY=0;this.textOriX=0-1.378*logoSize;this.textOriY=0-0.5*logoSize;this.logoShield.x=0;this.logoShield.y=0;this.logoShield.scaleX=0;this.logoShield.scaleY=0;this.logoShield.alpha=0;this.letterM.x=this.logoShield.x;this.letterM.y=this.logoShield.y;this.letterM.scaleX=0;this.letterM.scaleY=
0;this.letterM.alpha=0;this.text.x=4.6*-logoSize;this.text.y=this.textOriY;this.cover.x=this.logoShield.x;this.cover.y=0;this.addLocalDelayedCall(0.6,function(){this.addLocalTweenTo(this.logoShield,{scaleX:2,scaleY:2},0.5,this.backOut);this.addLocalTweenTo(this.logoShield,{alpha:1},0.2,this.quadOut);ig.soundHandler.sfxPlayer.play("logosplash1");this.addLocalDelayedCall(0.4,function(){this.addLocalTweenTo(this.letterM,{scaleX:2,scaleY:2},0.5,this.backOut);this.addLocalTweenTo(this.letterM,{alpha:1},
0.2,this.quadOut);ig.soundHandler.sfxPlayer.play("logosplash1");this.addLocalDelayedCall(0.2,function(){ig.soundHandler.sfxPlayer.play("logosplash2")}.bind(this));this.addLocalDelayedCall(0.6,function(){this.addLocalTweenTo(this.logoShield,{scaleX:1,scaleY:1},0.4,this.quartOut);this.addLocalTweenTo(this.logoShield,{x:this.logoOriX,y:this.logoOriY},0.4,this.quadOut);this.addLocalTweenTo(this.letterM,{scaleX:1,scaleY:1},0.4,this.quartOut);this.addLocalTweenTo(this.letterM,{x:this.logoOriX,y:this.logoOriY},
0.4,this.quadOut);this.addLocalTweenTo(this.text,{x:this.textOriX},0.8,this.backOut);this.addLocalDelayedCall(2,function(){this.addLocalTweenTo(this.logoShield,{alpha:0},0.6,this.quadOut);this.addLocalTweenTo(this.text,{alpha:0},0.6,this.quadOut);this.addLocalDelayedCall(1.3,function(){this.playBgm();ig.game.director.nextLevel()}.bind(this))}.bind(this))}.bind(this))}.bind(this))}.bind(this))},addObject:function(b,c,d,e,f){b={x:c,y:d,width:e,height:f,scaleX:1,scaleY:1,alpha:1,drawFunctionName:b};
this.objects.push(b);return b},update:function(){this.parent();if(!ig.wm){this.unlockWebAudio();var b=ig.system.tick;b>1/60&&(b=1/60);this.updateLocalTween(b);this.cover.x=this.logoShield.x;_SETTINGS.DeveloperBranding.Splash.Enabled||(this.playBgm(),ig.game.director.nextLevel(),this.kill())}},playBgm:function(){ig.soundHandler.bgmPlayer.play(ig.soundHandler.bgmPlayer.soundList.background)},unlockWebAudio:function(){if(ig.input.released("click"))try{ig.soundHandler.unlockWebAudio()}catch(b){}},addLocalDelayedCall:function(b,
c){this.addLocalTweenTo(null,{},b,this.easeNone,0,c)},addLocalTweenTo:function(b,c,d,e,f,g){"undefined"==typeof f&&(f=0);"undefined"==typeof e&&(e=this.easeNone);"undefined"==typeof g&&(g=null);d={obj:b,endProperties:c,duration:d,easing:e,delay:f,elapsed:0,deltaProperties:{},startProperties:{},onComplete:g};for(var j in c)Object.hasOwnProperty.call(c,j)&&(d.startProperties[j]=b[j],d.deltaProperties[j]=c[j]-b[j]);this.localTweens.push(d)},updateLocalTween:function(b){for(var c=0;c<this.localTweens.length;c++){var d=
this.localTweens[c];if(0<d.delay)d.delay-=b;else{d.elapsed+=b;for(var e in d.deltaProperties)if(Object.hasOwnProperty.call(d.deltaProperties,e)){var f=d.deltaProperties[e],g=d.startProperties[e],j=d.easing,l=d.elapsed/d.duration;1<l&&(l=1);l=j(l);d.obj[e]=g+f*l}if(d.elapsed>=d.duration&&(this.localTweens.splice(c,1),c--,d.onComplete))d.onComplete()}}},quadOut:function(b){return-b*(b-2)},quartOut:function(b){return-(--b*b*b*b-1)},backOut:function(b){return(b-=1)*b*(2.70158*b+1.70158)+1},easeNone:function(b){return b},
draw:function(){this.parent();if(!ig.global.wm){var b=ig.system.context;b.fillStyle="#ffffff";b.fillRect(0,0,ig.system.width,ig.system.height);for(b=0;b<this.objects.length;b++){var c=this.objects[b];1<c.alpha&&(c.alpha=1);if(0!=c.scaleX&&0!=c.scaleY&&0<c.alpha)this[c.drawFunctionName](c)}}},drawLogoShield:function(b){if(!this.logoCanvas){this.logoCanvas=ig.$new("canvas");this.logoCanvas.width=this.logoCacheSize;this.logoCanvas.height=this.logoCacheSize;var c=this.logoCanvas.getContext("2d"),d=this.logoCacheSize,
e=this.logoCacheSize,f=0,g=0;c.clearRect(0,0,this.logoCanvas.width,this.logoCanvas.height);c.save();c.fillStyle="#e35026";c.beginPath();c.moveTo(f+0.06*d,g);c.lineTo(f+0.94*d,g);c.lineTo(f+0.86*d,g+0.89*e);c.lineTo(f+0.5*d,g+e);c.lineTo(f+0.14*d,g+0.89*e);c.closePath();c.fill();c.fillStyle="#ee652b";c.beginPath();c.moveTo(f+0.5*d,g+0.07*e);c.lineTo(f+0.86*d,g+0.07*e);c.lineTo(f+0.79*d,g+0.84*e);c.lineTo(f+0.5*d,g+0.92*e);c.closePath();c.fill();c.restore()}d=b.width*b.scaleX;e=b.height*b.scaleY;f=
ig.system.width/2+b.x-d/2;g=ig.system.height/2+b.y-e/2;c=ig.system.context;c.globalAlpha=b.alpha;c.drawImage(this.logoCanvas,0,0,this.logoCacheSize,this.logoCacheSize,f,g,d,e);c.globalAlpha=1},drawLetterM:function(b){if(!this.mCanvas){this.mCanvas=ig.$new("canvas");this.mCanvas.width=this.logoCacheSize;this.mCanvas.height=this.logoCacheSize;var c=this.mCanvas.getContext("2d"),d=this.logoCacheSize,e=this.logoCacheSize,f=0,g=0;c.save();c.fillStyle="#ffffff";c.beginPath();c.moveTo(f+0.25*d,g+0.2*e);
c.lineTo(f+0.4*d,g+0.2*e);c.lineTo(f+0.5*d,g+0.37*e);c.lineTo(f+0.6*d,g+0.2*e);c.lineTo(f+0.75*d,g+0.2*e);c.lineTo(f+0.75*d,g+0.7*e);c.lineTo(f+0.6*d,g+0.7*e);c.lineTo(f+0.6*d,g+0.45*e);c.lineTo(f+0.5*d,g+0.63*e);c.lineTo(f+0.4*d,g+0.45*e);c.lineTo(f+0.4*d,g+0.7*e);c.lineTo(f+0.25*d,g+0.7*e);c.closePath();c.fill();c.restore()}c=ig.system.context;d=b.width*b.scaleX;e=b.height*b.scaleY;f=ig.system.width/2+b.x-d/2;g=ig.system.height/2+b.y-e/2;c.globalAlpha=b.alpha;c.drawImage(this.mCanvas,0,0,this.logoCacheSize,
this.logoCacheSize,f,g,d,e);c.globalAlpha=1},drawText:function(b){if(ig.splashLogoFontLoaded){var c=ig.system.context,d=b.height*b.scaleY,e=ig.system.width/2+b.x,f=ig.system.height/2+b.y;c.save();c.globalAlpha=b.alpha;b=Math.round(115/152*d);var g=Math.round(62/152*d);c.textAlign="left";c.fillStyle="#316198";c.font=b+"px logofont";c.fillText("MarketJS",e-0.06*b,f+0.66*b);c.font=g+"px logofont";c.fillText("HTML5 gaming solutions",e-0.02*g,f+d-0.1*g);c.globalAlpha=1;c.restore()}},drawCover:function(b){var c=
ig.system.context,d=ig.system.width/2+b.x,e=ig.system.height/2+b.y;c.save();c.globalAlpha=b.alpha;c.fillStyle="#ffffff";c.fillRect(d-ig.system.width/2,e-this.logoCacheSize/2,ig.system.width/2,this.logoCacheSize);c.globalAlpha=1;c.restore()}});if("undefined"==typeof window.FontFaceObserver){var b=function(b,c){document.addEventListener?b.addEventListener("scroll",c,!1):b.attachEvent("scroll",c)},c=function(b){this.a=document.createElement("div");this.a.setAttribute("aria-hidden","true");this.a.appendChild(document.createTextNode(b));
this.b=document.createElement("span");this.c=document.createElement("span");this.h=document.createElement("span");this.f=document.createElement("span");this.g=-1;this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";
this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;";this.b.appendChild(this.h);this.c.appendChild(this.f);this.a.appendChild(this.b);this.a.appendChild(this.c)},e=function(b,c){b.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+c+";"},d=function(b){var c=b.a.offsetWidth,d=c+100;b.f.style.width=d+"px";
b.c.scrollLeft=d;b.b.scrollLeft=b.b.scrollWidth+100;return b.g!==c?(b.g=c,!0):!1},g=function(c,e){function f(){var b=g;d(b)&&b.a.parentNode&&e(b.g)}var g=c;b(c.b,f);b(c.c,f);d(c)},f=function(b,c){var d=c||{};this.family=b;this.style=d.style||"normal";this.weight=d.weight||"normal";this.stretch=d.stretch||"normal"},m=function(){null===s&&(s=!!document.fonts);return s},l=function(){if(null===q){var b=document.createElement("div");try{b.style.font="condensed 100px sans-serif"}catch(c){}q=""!==b.style.font}return q},
j=function(b,c){return[b.style,b.weight,l()?b.stretch:"","100px",c].join(" ")},n=null,r=null,q=null,s=null;f.prototype.load=function(b,d){var f=this,l=b||"BESbswy",q=0,s=d||3E3,B=(new Date).getTime();return new Promise(function(b,d){var t;if(t=m())null===r&&(m()&&/Apple/.test(window.navigator.vendor)?(t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),r=!!t&&603>parseInt(t[1],10)):r=!1),t=!r;if(t){t=new Promise(function(b,c){function d(){(new Date).getTime()-B>=
s?c(Error(""+s+"ms timeout exceeded")):document.fonts.load(j(f,'"'+f.family+'"'),l).then(function(c){1<=c.length?b():setTimeout(d,25)},c)}d()});var u=new Promise(function(b,c){q=setTimeout(function(){c(Error(""+s+"ms timeout exceeded"))},s)});Promise.race([u,t]).then(function(){clearTimeout(q);b(f)},d)}else{var F=function(){function m(){var c;if(c=-1!=D&&-1!=G||-1!=D&&-1!=E||-1!=G&&-1!=E)(c=D!=G&&D!=E&&G!=E)||(null===n&&(c=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),n=!!c&&
(536>parseInt(c[1],10)||536===parseInt(c[1],10)&&11>=parseInt(c[2],10))),c=n&&(D==F&&G==F&&E==F||D==S&&G==S&&E==S||D==J&&G==J&&E==J)),c=!c;c&&(K.parentNode&&K.parentNode.removeChild(K),clearTimeout(q),b(f))}function r(){if((new Date).getTime()-B>=s)K.parentNode&&K.parentNode.removeChild(K),d(Error(""+s+"ms timeout exceeded"));else{var b=document.hidden;if(!0===b||void 0===b)D=t.a.offsetWidth,G=u.a.offsetWidth,E=z.a.offsetWidth,m();q=setTimeout(r,50)}}var t=new c(l),u=new c(l),z=new c(l),D=-1,G=-1,
E=-1,F=-1,S=-1,J=-1,K=document.createElement("div");K.dir="ltr";e(t,j(f,"sans-serif"));e(u,j(f,"serif"));e(z,j(f,"monospace"));K.appendChild(t.a);K.appendChild(u.a);K.appendChild(z.a);document.body.appendChild(K);F=t.a.offsetWidth;S=u.a.offsetWidth;J=z.a.offsetWidth;r();g(t,function(b){D=b;m()});e(t,j(f,'"'+f.family+'",sans-serif'));g(u,function(b){G=b;m()});e(u,j(f,'"'+f.family+'",serif'));g(z,function(b){E=b;m()});e(z,j(f,'"'+f.family+'",monospace'))};document.body?F():document.addEventListener?
document.addEventListener("DOMContentLoaded",function R(){document.removeEventListener("DOMContentLoaded",R);F()}):document.attachEvent("onreadystatechange",function O(){if("interactive"==document.readyState||"complete"==document.readyState)document.detachEvent("onreadystatechange",O),F()})}})};"object"===typeof module?module.exports=f:(window.FontFaceObserver=f,window.FontFaceObserver.prototype.load=f.prototype.load);console.log("font loader not exist : create new instance of font loader")}f=document.createElement("style");
f.type="text/css";f.appendChild(document.createTextNode("@font-face {font-family: 'logofont';src: url('media/fonts/logofont.woff2') format('woff2'),url('media/fonts/logofont.woff') format('woff'),url('media/fonts/logofont.ttf') format('truetype')}"));document.head.appendChild(f);ig.splashLogoFontLoaded=!1;(new FontFaceObserver("logofont")).load().then(function(){ig.splashLogoFontLoaded=!0}).catch(function(){console.log("Splash font failed to load :","media/fonts/logofont")})});ig.baked=!0;
ig.module("game.levels.opening").requires("impact.image","game.entities.opening-marketjs-logo").defines(function(){LevelOpening={entities:[{type:"EntityOpeningMarketJSLogo",x:520,y:212}],layer:[]}});ig.baked=!0;
ig.module("game.toybox.objects.game-object").requires("impact.entity").defines(function(){EntityGameObject=ig.Entity.extend({gravityFactor:0,idleSheetInfo:null,singleFrameImage:null,visible:!0,alpha:1,zIndex:1E3,drawAsRect:!1,drawAsOutline:!1,outlineWidth:1,rectColor:"#FFFFFF",outlineColor:"#000000",entryDelay:0,entryDuration:0.25,entryType:null,exitDelay:0,exitDuration:0.25,exitType:null,killOnExit:!0,scaleX:1,scaleY:1,angle:0,anchorX:0,anchorY:0,forceDraw:!1,width:32,height:32,onInputDown:null,
onInputUp:null,onClicked:null,hasTouchInside:!1,inputEnabled:!1,isClicking:!1,boundLeft:0,boundRight:0,boundTop:0,boundBottom:0,isFinishEntering:!1,fixedOnCamera:!1,timedLife:-999,size:{x:32,y:32},init:function(b,c,e){this.onInputDown=new ig.Signal;this.onInputUp=new ig.Signal;this.onClicked=new ig.Signal;e.singleFrameImage?this.singleFrameImage=e.singleFrameImage:e.image&&(this.image=this.singleFrameImage=e.image);null!=this.singleFrameImage?(this.idleSheetInfo={sheetImage:this.singleFrameImage,
sheetX:1,sheetY:1},this.setSpriteSheet("idle"),this.setSize("idle"),this.addAnimation("idle","idleSheet",1,[0],!1,!0)):null!=this.idleSheetInfo&&(this.setSpriteSheet("idle"),this.setSize("idle"));this.parent(b,c,e);!1===e.visible&&(this.visible=!1);this.anchorType=e.anchorType?e.anchorType:"default";this.enter()},swapImage:function(b){this.idleSheetInfo.sheetImage=b;this.idleSheet.image=b},onFinishEntering:function(){},enter:function(){this.visible=!0;if(ig.responsive){var b=ig.responsive.toAnchor(this.anchoredPositionX,
this.anchoredPositionY,this.anchorType);this.pos.x=b.x;this.pos.y=b.y}null!=this.entryType?(this[this.entryType](),this.delayedCall(this.entryDelay+this.entryDuration,function(){this.onFinishEntering();this.isFinishEntering=!0}.bind(this))):(this.isFinishEntering=!0,this.onFinishEntering())},exit:function(){if(null!=this.exitType)this[this.exitType]();else this.alpha0();this.delayedCall(this.exitDuration+this.exitDelay,function(){this.checkKill()}.bind(this))},setSpriteSheet:function(b){this[b+"Sheet"]=
new ig.AnimationSheet(this[b+"SheetInfo"].sheetImage.path,this[b+"SheetInfo"].sheetImage.width/this[b+"SheetInfo"].sheetX,this[b+"SheetInfo"].sheetImage.height/this[b+"SheetInfo"].sheetY)},setSize:function(b){this.width=this[b+"SheetInfo"].sheetImage.width/this[b+"SheetInfo"].sheetX;this.height=this[b+"SheetInfo"].sheetImage.height/this[b+"SheetInfo"].sheetY},addAnimation:function(b,c,e,d,g,f){this[b]=new ig.Animation(this[c],e,d,!g);!0==f&&(this.currentAnim=this[b])},makeFramesArray:function(b,c,
e){for(var d=[],g=b;g<=c;g++)d.push(g);if(e)for(g=c;g>=b;g--)d.push(g);return d},draw:function(){if(this.visible&&(this.forceDraw||this.currentAnim||this.drawAsRect||this.drawAsOutline)){var b=ig.system.context;b.save();var c=0,e=0;this.fixedOnCamera?(c=ig.system.getDrawPos(this.pos.x.round()-this.offset.x),e=ig.system.getDrawPos(this.pos.y.round()-this.offset.y)):(c=ig.system.getDrawPos(this.pos.x.round()-this.offset.x-ig.game.screen.x),e=ig.system.getDrawPos(this.pos.y.round()-this.offset.y-ig.game.screen.y));
b.translate(c,e);(1!=this.scaleX||1!=this.scaleY)&&b.scale(this.scaleX,this.scaleY);c=-this.anchorX*this.width;e=-this.anchorY*this.height;0<this.shakeValue&&(this.shakeValue-=ig.system.tick*this.shakeReductionMultiplier,c+=ig.random.float(-this.shakeValue,this.shakeValue),e+=ig.random.float(-this.shakeValue,this.shakeValue));this.drawObject(c,e);b.restore()}},drawObject:function(b,c){var e=ig.system.context,d=ig.hexToRgb(this.rectColor);this.drawAsRect&&(e.fillStyle=1>this.alpha?"rgba("+d.r+","+
d.g+","+d.b+","+this.alpha+")":d.hex,e.fillRect(b,c,this.width,this.height));d=ig.hexToRgb(this.outlineColor);this.drawAsOutline?(e.lineWidth=this.outlineWidth,e.strokeStyle=1>this.alpha?"rgba("+d.r+","+d.g+","+d.b+","+this.alpha+")":d.hex,e.strokeRect(b,c,this.width,this.height)):null!=this.currentAnim&&(this.currentAnim.alpha=this.alpha,this.currentAnim.draw(b,c))},update:function(){ig.game.entities&&this.parent();if(this.inputEnabled&&this.isFinishEntering&&this.visible){var b=!1;this.hasTouchInside=
!1;for(var c=0;c<ig.multitouchInput.touches.length;c++){var b=!0,e=ig.multitouchInput.touches[c];this.processInput(e.x,e.y)}for(c=0;c<ig.ToyboxTouch.touches.length;c++)b=!0,e=ig.ToyboxTouch.touches[c],this.processInput(e.x,e.y);!b&&ig.input.state("click")&&(b=!0,c=ig.game.io.mouse.getPos(),this.processInput(c.x,c.y));b?this.hasTouchInside||(this.isClicking=!1):(this.isClicking&&(this.onInputUp.dispatch(this),this.onClicked.dispatch(this)),this.isClicking=!1)}-999!=this.timedLife&&this.isFinishEntering&&
(this.timedLife-=ig.system.tick,0>=this.timedLife&&(this.timedLife=-999,this.exit()))},processInput:function(b,c){this.isInsideBounds(b,c)&&(this.hasTouchInside=!0,this.isClicking||(this.isClicking=!0,this.onInputDown.dispatch(this)))},isInsideBounds:function(b,c){var e=this.scaleX*this.width,d=this.scaleY*this.height;this.boundLeft=this.pos.x-e*this.anchorX;this.boundTop=this.pos.y-d*this.anchorY;this.boundRight=this.boundLeft+e;this.boundBottom=this.boundTop+d;this.boundLeft>this.boundRight&&(e=
this.boundLeft,this.boundLeft=this.boundRight,this.boundRight=e);this.boundTop>this.boundBottom&&(e=this.boundTop,this.boundTop=this.boundBottom,this.boundBottom=e);return b<this.boundLeft||c<this.boundTop||b>this.boundRight||c>this.boundBottom?!1:!0},getBounds:function(){this._bounds||(this._bounds={});var b=this._bounds,c=this.scaleX*this.width,e=this.scaleY*this.height;b.left=this.pos.x-c*this.anchorX;b.top=this.pos.y-e*this.anchorY;b.right=b.left+c;b.bottom=b.top+e;b.width=Math.abs(c);b.height=
Math.abs(e);b.left>b.right&&(c=b.left,b.left=b.right,b.right=c);b.top>b.bottom&&(c=b.top,b.top=b.bottom,b.bottom=c);b.x=b.left;b.y=b.top;return b},isCollidingWith:function(b){var c=this.getBounds();b=b.getBounds();return c.right<b.left||c.left>b.right||c.bottom<b.top||c.top>b.bottom?!1:!0},shakeValue:0,shakeReductionMultiplier:0,shake:function(b,c){b||(b=5);c||(c=10);this.shakeValue=b;this.shakeReductionMultiplier=c},fadeBounceRightIn:function(){this.alpha=0;var b=this.pos.x;this.pos.x-=100;this.tween({alpha:1},
0.75*this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start();this.tween({pos:{x:b}},this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Back.EaseOut}).start()},fadeBounceRightOut:function(){this.tween({alpha:0},0.75*this.exitDuration,{delay:this.exitDelay+0.25*this.exitDuration,easing:ig.Tween.Easing.Quadratic.EaseOut}).start();this.tween({pos:{x:this.pos.x-100}},this.exitDuration,{delay:this.exitDelay,easing:ig.Tween.Easing.Back.EaseIn}).start()},
fadeBounceLeftIn:function(){this.alpha=0;var b=this.pos.x;this.pos.x+=100;this.tween({alpha:1},0.75*this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start();this.tween({pos:{x:b}},this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Back.EaseOut}).start()},fadeBounceLeftOut:function(){this.tween({alpha:0},0.75*this.exitDuration,{delay:this.exitDelay+0.25*this.exitDuration,easing:ig.Tween.Easing.Quadratic.EaseOut}).start();this.tween({pos:{x:this.pos.x+
100}},this.exitDuration,{delay:this.exitDelay,easing:ig.Tween.Easing.Back.EaseIn}).start()},fadeJumpIn:function(){this.alpha=0;var b=this.pos.y;this.pos.y+=100;this.tween({alpha:1},0.75*this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start();this.tween({pos:{y:b}},this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Back.EaseOut}).start()},fadeJumpOut:function(){this.tween({alpha:0},0.75*this.exitDuration,{delay:this.exitDelay+0.25*this.exitDuration,
easing:ig.Tween.Easing.Quadratic.EaseOut}).start();this.tween({pos:{y:this.pos.y+100}},this.exitDuration,{delay:this.exitDelay,easing:ig.Tween.Easing.Back.EaseIn}).start()},fadeIn:function(){var b=this.alpha;this.alpha=0;this.tween({alpha:b},this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start()},fadeInLinear:function(){var b=this.alpha;this.alpha=0;this.tween({alpha:b},this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Linear.EaseNone}).start()},
fadeOut:function(){this.tween({alpha:0},this.exitDuration,{delay:this.exitDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start()},fadeOutLinear:function(){this.tween({alpha:0},this.exitDuration,{delay:this.exitDelay,easing:ig.Tween.Easing.Linear.EaseNone}).start()},expandIn:function(){this.alpha=0;this.tween({alpha:1},this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start()},expandOut:function(){this.tween({alpha:0},this.exitDuration,{delay:this.exitDelay,easing:ig.Tween.Easing.Quadratic.EaseOut}).start()},
dropBoinkIn:function(){this.alpha=0;var b=this.pos.y,c=1.2*this.scaleX,e=0.8*this.scaleY,d=this.scaleX,g=this.scaleY;this.pos.y-=0<this.height?3*this.height:3*this.size.y;c=this.tween({scaleX:c,scaleY:e},0.2*this.entryDuration,{delay:this.entryDelay+0.6*this.entryDuration,easing:ig.Tween.Easing.Quadratic.EaseOut});d=this.tween({scaleX:d,scaleY:g},0.2*this.entryDuration,{easing:ig.Tween.Easing.Quadratic.EaseIn});c.chain(d);c.start();this.tween({alpha:1},0.6*this.entryDuration,{delay:this.entryDelay,
easing:ig.Tween.Easing.Quadratic.EaseIn}).start();this.tween({pos:{y:b}},0.6*this.entryDuration,{delay:this.entryDelay,easing:ig.Tween.Easing.Quartic.EaseIn}).start()},alpha0:function(){this.alpha=0},alpha1:function(){this.alpha=1},checkKill:function(){this.killOnExit&&this.kill()}})});ig.baked=!0;
ig.module("game.toybox.objects.ui.buttons.simple-button").requires("game.toybox.objects.game-object").defines(function(){EntitySimpleButton=EntityGameObject.extend({originalX:0,originalY:0,transitionInDelay:0,zIndex:7E3,text:"",font:"48px Arial",textColor:"#FFFFFF",align:"center",offsetX:0,offsetY:0,anchorX:0.5,anchorY:0.5,lineSpacing:1,valign:"center",enableShadow:!1,shadowColor:"#000000",shadowOffsetX:0,shadowOffsetY:4,shadowAlpha:0.4,outlineWeight:0,outlineColor:"#000000",outlineCap:"square",outlineJoin:"bevel",
normalScale:1,usePressedTween:!0,textRenderer:null,forceDraw:!0,init:function(b,c,e){this.parent(b,c,e);this.textRenderer=new ig.TextRenderer;if(e.textString)throw Error("old text field detected");},update:function(){this.parent();if(this.usePressedTween&&this.visible){var b=0.9*this.normalScale,c=0.9*this.normalScale,b=0.9*this.normalScale,b=this.hasTouchInside?0.9*this.normalScale:this.normalScale,c=0>this.scaleX?-1*b:b,b=0>this.scaleY?-1*b:b;this.scaleX+=(c-this.scaleX)/3;this.scaleY+=(b-this.scaleY)/
3}},drawObject:function(b,c){this.parent(b,c);this.visible&&(this.textRenderer.text=this.text,this.textRenderer.font=this.font,this.textRenderer.color=this.textColor,this.textRenderer.alpha=this.alpha,this.textRenderer.align=this.align,this.textRenderer.offsetX=this.offsetX,this.textRenderer.offsetY=this.offsetY,this.textRenderer.lineSpacing=this.lineSpacing,this.textRenderer.valign=this.valign,this.textRenderer.enableShadow=this.enableShadow,this.textRenderer.shadowAlpha=this.shadowAlpha,this.textRenderer.shadowColor=
this.shadowColor,this.textRenderer.shadowOffsetX=this.shadowOffsetX,this.textRenderer.shadowOffsetY=this.shadowOffsetY,this.textRenderer.outlineWeight=this.outlineWeight,this.textRenderer.outlineColor=this.outlineColor,this.textRenderer.outlineCap=this.outlineCap,this.textRenderer.outlineJoin=this.outlineJoin,this.textRenderer.draw(b+this.width/2,c+this.height/2))},onFinishEntering:function(){this.inputEnabled=!0}})});ig.baked=!0;
ig.module("game.toybox.objects.ui.fade-black").requires("game.toybox.objects.game-object").defines(function(){ig.hasFadeBlack=!1;EntityFadeBlack=EntityGameObject.extend({zIndex:99999,isIn:!1,nextLevelID:-1,rectColor:"#000000",init:function(b,c,e){this.parent(b,c,e);this.size.x=ig.system.width;this.size.y=ig.system.height;ig.game.sortEntitiesDeferred()},enter:function(){this.visible=!0;this.isIn?(this.alpha=0,this.tween({alpha:1},0.35,{easing:ig.Tween.Easing.Quadratic.EaseIn,onComplete:function(){0<=
this.nextLevelID&&ig.game.director.loadLevel(this.nextLevelID)}.bind(this)}).start()):(this.alpha=1,this.tween({alpha:0},0.35,{easing:ig.Tween.Easing.Quadratic.EaseOut,onComplete:function(){this.kill()}.bind(this)}).start())},drawObject:function(b,c){if(this.visible){var e=ig.system.context;e.save();var d=this.rectColor;e.fillStyle=1>this.alpha?"rgba("+d.r+","+d.g+","+d.b+","+this.alpha+")":d.hex;e.fillRect(this.pos.x,this.pos.y,this.size.x,this.size.y);e.restore()}this.parent(b,c)}});ig.dropCurtain=
function(b){void 0===b&&(b=-1);ig.hasFadeBlack=!0;ig.game.spawnEntity(EntityFadeBlack,0,0,{isIn:!0,nextLevelID:b})};ig.liftCurtain=function(){ig.hasFadeBlack=!1;ig.game.spawnEntity(EntityFadeBlack,0,0,{isIn:!1})}});ig.baked=!0;
ig.module("game.toybox.controllers.controller").requires("impact.entity","game.entities.pointer","game.toybox.objects.ui.fade-black").defines(function(){EntityController=ig.Entity.extend({gravityFactor:0,isAllowInput:!0,pointer:null,liftCurtainOnStart:!0,onInputDown:null,onInputUp:null,lastTouchY:0,lastTouchX:0,size:{x:960,y:540},init:function(b,c,e){this.parent(b,c,e);this.pointer=ig.game.getEntitiesByType(EntityPointer)[0];this.onInputDown=new ig.Signal;this.onInputUp=new ig.Signal;this.liftCurtainOnStart&&
ig.liftCurtain()},goToLevel:function(b){this.isAllowInput=!1;ig.dropCurtain(b)},showPopup:function(b,c){c||(c={});c.controller=this;this.isAllowInput=!1;ig.game.spawnEntity(b,0,0,c);ig.game.sortEntitiesDeferred()},onPopupFinished:function(){this.isAllowInput=!0},update:function(){this.parent();for(var b=!1,c=0;c<ig.multitouchInput.touches.length;c++){var b=!0,e=ig.multitouchInput.touches[c];this.processInput(e.x,e.y)}!b&&ig.input.state("click")&&(b=!0,c=ig.game.io.mouse.getPos(),this.processInput(c.x,
c.y));b||(this.isClicking&&this.onInputUp.dispatch(this),this.isClicking=!1)},processInput:function(b,c){this.currentTouchX=b;this.currentTouchY=c;this.isInsideBounds(b,c)&&!this.isClicking&&(this.isClicking=!0,this.lastTouchX=b,this.lastTouchY=c,this.onInputDown.dispatch(this))},isInsideBounds:function(b,c){var e=this.scaleX*this.width,d=this.scaleY*this.height;this.boundLeft=this.pos.x-e*this.anchorX;this.boundTop=this.pos.y-d*this.anchorY;this.boundRight=this.boundLeft+e;this.boundBottom=this.boundTop+
d;this.boundLeft>this.boundRight&&(e=this.boundLeft,this.boundLeft=this.boundRight,this.boundRight=e);this.boundTop>this.boundBottom&&(e=this.boundTop,this.boundTop=this.boundBottom,this.boundBottom=e);return b<this.boundLeft||c<this.boundTop||b>this.boundRight||c>this.boundBottom?!1:!0}})});ig.baked=!0;
ig.module("game.entities.controllers.main-menu-controller").requires("impact.entity","game.toybox.objects.ui.buttons.simple-button","game.toybox.controllers.controller").defines(function(){EntityMainMenuController=EntityController.extend({titleImage:new ig.Image("media/graphics/game/title.png"),playBtnImage:new ig.Image("media/graphics/game/play-btn.png"),settingsBtnImage:new ig.Image("media/graphics/game/settings-btn.png"),moreGamesBtnImage:new ig.Image("media/graphics/game/more-games-btn.png"),
bgAlpha:0,init:function(b,c,e){this.parent(b,c,e);this.title=ig.game.spawnEntity(EntityGameObject,540,600,{image:this.titleImage,entryType:"fadeIn",exitType:"fadeOut",anchorX:0.5,anchorY:0.5});ig.game.spawnEntity(EntitySimpleButton,540,1220,{image:this.playBtnImage,entryType:"fadeIn",exitType:"fadeOut"}).onClicked.add(this.onClickPlay,this);b=ig.game.spawnEntity(EntitySimpleButton,900,1220,{image:this.settingsBtnImage,entryType:"fadeIn",exitType:"fadeOut"});b.onClicked.add(this.onClickSettings,this);
_SETTINGS.MoreGames.Enabled?(b=ig.game.spawnEntity(EntitySimpleButton,180,1220,{image:this.moreGamesBtnImage,entryType:"fadeIn",exitType:"fadeOut"}),b.size.x=this.moreGamesBtnImage.width,b.size.y=this.moreGamesBtnImage.height,this.moreGamesButton=b,_SETTINGS.MoreGames.Link&&(b.link=_SETTINGS.MoreGames.Link),_SETTINGS.MoreGames.NewWindow&&(b.newWindow=_SETTINGS.MoreGames.NewWindow),this.clickableLayer=new ClickableDivLayer(b)):(b.anchoredPositionX=540,b.anchoredPositionY=1600);this.fullscreenbtn=ig.game.spawnEntity(ig.FullscreenButton,
-260,20,{enterImage:new ig.Image("media/graphics/game/button-maximize.png"),exitImage:new ig.Image("media/graphics/game/button-minimize.png")});this.fullscreenbtn.anchorType="right-top";ig.game.backFromSettings?(ig.game.backFromSettings=!1,this.bgAlpha=0):(ig.babylonSceneController.update(0),this.bgAlpha=1.5);ig.babylonSceneController.arrow.setMainMenu();ig.babylonSceneController.paused=!0},onClickSettings:function(){ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);ig.game.goToLevel("MainMenuSettings")},
onClickPlay:function(){ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);ig.soundHandler.sfxPlayer.stop(ig.soundHandler.sfxPlayer.soundList.bgmMainMenu);ig.game.goToLevel("Gameplay");try{ig.linkit360Skill.trackGameStarted()}catch(b){}},update:function(){this.title.scaleX=ig.system.width>ig.system.height?this.title.scaleY=1:this.title.scaleY=0.74;this.parent();if(this.clickableLayer){var b=this.moreGamesButton;this.clickableLayer.update(b.pos.x-b.width/2,b.pos.y-b.height/2,
b.width,b.height)}},draw:function(){this.parent();var b=ig.system.context;b.clearRect(0,0,ig.system.width,ig.system.height);0<this.bgAlpha&&(this.bgAlpha-=2*ig.system.tick,0.05>this.bgAlpha&&(this.bgAlpha=0),b.save(),b.globalAlpha=1<this.bgAlpha?1:this.bgAlpha,b.fillStyle="#cff0d5",b.fillRect(0,0,ig.system.width,ig.system.height),b.restore(),b.globalAlpha=1)}})});ig.baked=!0;
ig.module("game.levels.main-menu").requires("impact.image","game.entities.controllers.main-menu-controller").defines(function(){LevelMainMenu={entities:[{type:"EntityMainMenuController",x:0,y:0}],layer:[]}});ig.baked=!0;
ig.module("game.toybox.objects.ui.popups.popup").requires("game.toybox.objects.game-object").defines(function(){EntityPopup=EntityGameObject.extend({gravityFactor:0,zIndex:1E4,controller:null,members:[],entryType:"fadeIn",exitType:"fadeOut",exitDelay:0.5,isAllowInput:!1,memberZIndex:10001,init:function(b,c,e){this.parent(b,c,e)},spawnMember:function(b,c,e,d,g){g&&(d.zIndex=g);b=ig.game.spawnEntity(b,c,e,d);!g&&b.zIndex<this.zIndex&&(b.zIndex=this.memberZIndex++);this.members.push(b);this.fixedOnCamera&&
(b.fixedOnCamera=!0);return b},enter:function(){this.parent();this.delayedCall(this.entryDelay+this.entryDuration,function(){this.isAllowInput=!0}.bind(this))},exit:function(){this.parent();this.isAllowInput=!1;this.callControllerCallback();for(var b=0;b<this.members.length;b++)this.members[b].exit()},callControllerCallback:function(){if(this.controller&&this.controller.onPopupFinished){var b=this.exitDelay+this.exitDuration-0.1;if(0>=b)this.controller.onPopupFinished(this.name);else this.delayedCall(b,
function(){this.controller.onPopupFinished(this.name)}.bind(this))}}})});ig.baked=!0;
ig.module("game.toybox.objects.ui.texts.text-field").requires("game.toybox.objects.game-object").defines(function(){EntityTextField=EntityGameObject.extend({text:"",font:"48px Arial",color:"#FFFFFF",align:"start",offsetX:0,offsetY:0,lineSpacing:1,valign:"top",textRenderer:null,forceDraw:!0,enableShadow:!1,shadowColor:"#000000",shadowOffsetX:0,shadowOffsetY:4,shadowAlpha:0.4,outlineWeight:0,outlineColor:"#000000",outlineCap:"square",outlineJoin:"bevel",zIndex:7E3,init:function(b,c,e){this.parent(b,
c,e);this.textRenderer=new ig.TextRenderer},drawObject:function(b,c){this.parent(b,c);this.visible&&(this.applyProperties(),this.textRenderer.draw(b,c))},applyProperties:function(){this.textRenderer.text=this.text;this.textRenderer.font=this.font;this.textRenderer.color=this.color;this.textRenderer.alpha=this.alpha;this.textRenderer.align=this.align;this.textRenderer.offsetX=this.offsetX;this.textRenderer.offsetY=this.offsetY;this.textRenderer.lineSpacing=this.lineSpacing;this.textRenderer.valign=
this.valign;this.textRenderer.enableShadow=this.enableShadow;this.textRenderer.shadowAlpha=this.shadowAlpha;this.textRenderer.shadowColor=this.shadowColor;this.textRenderer.shadowOffsetX=this.shadowOffsetX;this.textRenderer.shadowOffsetY=this.shadowOffsetY;this.textRenderer.outlineWeight=this.outlineWeight;this.textRenderer.outlineColor=this.outlineColor;this.textRenderer.outlineCap=this.outlineCap;this.textRenderer.outlineJoin=this.outlineJoin},getTextWidth:function(){this.applyProperties();return this.textRenderer.measureTextWidth()}})});
ig.baked=!0;
ig.module("game.entities.popups.settings-popup").requires("game.toybox.objects.ui.popups.popup","game.toybox.objects.ui.buttons.simple-button","game.toybox.objects.ui.texts.text-field").defines(function(){EntitySettingsPopup=EntityPopup.extend({bgImg:new ig.Image("media/graphics/game/popup-bg.png"),homeBtnImg:new ig.Image("media/graphics/game/home-btn.png"),toggleOffImg:new ig.Image("media/graphics/game/button-off.png"),toggleOnImg:new ig.Image("media/graphics/game/button-on.png"),homeButton:null,bgmButton:null,
sfxButton:null,title:null,exitDelay:0,exitDuration:0.25,init:function(b,c,e){this.parent(b,c,e);c=this.spawnMember(EntityGameObject,540,960,{image:this.bgImg,anchorX:0.5,anchorY:0.5,entryType:"fadeIn",exitType:"fadeOut",zIndex:0});b=c.anchoredPositionX;c=c.anchoredPositionY;this.title=this.spawnMember(EntityTextField,b+16,c-330,{zIndex:7E3,anchorX:0.5,anchorY:0.5,text:_STRINGS.Game.Settings,font:"114px mainfont",align:"center",color:"#000000",entryType:"fadeIn",exitType:"fadeOut"});this.homeButton=
this.spawnMember(EntitySimpleButton,b,c+300,{image:this.homeBtnImg,entryType:"fadeIn",exitType:"fadeOut"});this.homeButton.onClicked.addOnce(this.onClickHome,this);this.bgmButton=this.spawnMember(EntitySimpleButton,b,c-160,{image:this.toggleOnImg,text:"",font:"82px mainfont",align:"center",color:"#ffffff",offsetY:-16,entryType:"fadeIn",exitType:"fadeOut"});this.bgmButton.onClicked.add(this.onValueToggleBgm,this);this.sfxButton=this.spawnMember(EntitySimpleButton,b,c+70,{image:this.toggleOnImg,text:"",
font:"82px mainfont",align:"center",color:"#ffffff",offsetY:-16,entryType:"fadeIn",exitType:"fadeOut"});this.sfxButton.onClicked.add(this.onValueToggleSfx,this);ig.game.sortEntitiesDeferred();this.refreshToggleButton()},refreshToggleButton:function(){0<ig.game.sessionData.music?(this.bgmButton.swapImage(this.toggleOnImg),this.bgmButton.text=_STRINGS.Game.BgmOn,this.bgmButton.textColor="#000000"):(this.bgmButton.swapImage(this.toggleOffImg),this.bgmButton.text=_STRINGS.Game.BgmOff,this.bgmButton.textColor=
"#ffffff");0<ig.game.sessionData.sound?(this.sfxButton.swapImage(this.toggleOnImg),this.sfxButton.text=_STRINGS.Game.SfxOn,this.sfxButton.textColor="#000000"):(this.sfxButton.swapImage(this.toggleOffImg),this.sfxButton.text=_STRINGS.Game.SfxOff,this.sfxButton.textColor="#ffffff")},onValueToggleSfx:function(){ig.game.sessionData.sound=0<ig.game.sessionData.sound?0:ig.game.sfxDefaultVolume;ig.game.saveAll();ig.soundHandler.sfxPlayer.volume(ig.game.sessionData.sound);ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);
this.refreshToggleButton()},onValueToggleBgm:function(){ig.game.sessionData.music=0<ig.game.sessionData.music?0:ig.game.bgmDefaultVolume;ig.game.saveAll();ig.soundHandler.bgmPlayer.volume(ig.game.sessionData.music);ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);this.refreshToggleButton()},onClickHome:function(){this.isAllowInput&&(this.isAllowInput=!1,this.exit(),ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click))}})});ig.baked=!0;
ig.module("game.entities.controllers.main-menu-settings-controller").requires("impact.entity","game.toybox.controllers.controller","game.toybox.objects.game-object","game.toybox.objects.ui.buttons.simple-button","game.entities.popups.settings-popup").defines(function(){EntityMainMenuSettingsController=EntityController.extend({init:function(b,c,e){this.parent(b,c,e);this.delayedCall(0.1,function(){this.showPopup(EntitySettingsPopup)}.bind(this))},onPopupFinished:function(b){this.parent(b);this.isAllowInput&&
(this.isAllowInput=!1,setTimeout(function(){ig.game.backFromSettings=!0;ig.game.goToLevel("MainMenu")}.bind(this),100))},update:function(){this.parent()},draw:function(){this.parent();ig.system.context.clearRect(0,0,ig.system.width,ig.system.height)}})});ig.baked=!0;ig.module("game.levels.main-menu-settings").requires("impact.image","game.entities.controllers.main-menu-settings-controller").defines(function(){LevelMainMenuSettings={entities:[{type:"EntityMainMenuSettingsController",x:0,y:0}],layer:[]}});
ig.baked=!0;
ig.module("game.entities.controllers.game-over-controller").requires("impact.entity","game.toybox.objects.ui.buttons.simple-button","game.toybox.controllers.controller").defines(function(){EntityGameOverController=EntityController.extend({playBtnImage:new ig.Image("media/graphics/game/small-play-btn.png"),homeBtnImage:new ig.Image("media/graphics/game/home-btn.png"),bgImg:new ig.Image("media/graphics/game/popup-bg.png"),init:function(b,c,e){this.parent(b,c,e);ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.gameover);ig.game.spawnEntity(EntityGameObject,
540,960,{anchorX:0.5,anchorY:0.5,image:this.bgImg,entryType:"fadeIn",exitType:"fadeOut"});ig.game.spawnEntity(EntityTextField,540,610,{font:"102px mainfont",text:_STRINGS.Game.GameOver,color:"#000000",align:"center",entryType:"fadeIn",exitType:"fadeOut"});b=ig.lastScore;b>ig.game.sessionData.score&&(ig.game.sessionData.score=b,ig.game.saveAll());ig.game.spawnEntity(EntityTextField,540,750,{font:"64px contentfont",text:_STRINGS.Game.Score,align:"center",entryType:"fadeIn",exitType:"fadeOut",color:"#000000"});
ig.game.spawnEntity(EntityTextField,540,870,{font:"132px mainfont",text:""+b,align:"center",entryType:"fadeIn",exitType:"fadeOut",color:"#000000"});ig.game.spawnEntity(EntityTextField,540,970,{font:"52px contentfont",text:_STRINGS.Game.Best,align:"center",entryType:"fadeIn",exitType:"fadeOut",color:"#000000"});ig.game.spawnEntity(EntityTextField,540,1080,{font:"96px mainfont",text:""+ig.game.sessionData.score,align:"center",entryType:"fadeIn",exitType:"fadeOut",color:"#000000"});c=ig.game.spawnEntity(EntitySimpleButton,
680,1270,{image:this.playBtnImage,entryType:"fadeIn",exitType:"fadeOut"});c.onClicked.add(this.onClickPlay,this);ig.game.spawnEntity(EntitySimpleButton,400,c.anchoredPositionY,{image:this.homeBtnImage,entryType:"fadeIn",exitType:"fadeOut"}).onClicked.add(this.onClickHome,this);this.isAllowInput=!0;try{ig.linkit360Skill.trackGameEnded(b)}catch(d){}},onClickPlay:function(){ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);ig.game.goToLevel("Gameplay");try{ig.linkit360Skill.trackGameRestarted(optionalCallbackFunction)}catch(b){}},
onClickHome:function(){ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);ig.game.goToLevel("MainMenu")},update:function(){this.parent();ig.input.state("jump")&&this.isAllowInput&&(this.isAllowInput=!1,this.onClickPlay())},draw:function(){this.parent();ig.system.context.clearRect(0,0,ig.system.width,ig.system.height)}})});ig.baked=!0;
ig.module("game.levels.game-over").requires("impact.image","game.entities.controllers.game-over-controller").defines(function(){LevelGameOver={entities:[{type:"EntityGameOverController",x:0,y:0}],layer:[]}});ig.baked=!0;
ig.module("game.entities.popups.pause-popup").requires("game.entities.popups.settings-popup").defines(function(){EntityPausePopup=EntitySettingsPopup.extend({resumeBtnImg:new ig.Image("media/graphics/game/small-play-btn.png"),replayBtnImg:new ig.Image("media/graphics/game/replay-btn.png"),showCover:!1,init:function(b,c,e){this.parent(b,c,e);this.resumeButton=this.spawnMember(EntitySimpleButton,540,this.homeButton.anchoredPositionY,{usePressedTween:!0,image:this.resumeBtnImg,anchorX:0.5,anchorY:0.5,
entryType:"fadeIn",exitType:"fadeOut",entryDuration:0.25,exitDuration:0.25});this.resumeButton.onClicked.addOnce(this.onClickResume,this);this.replayButton=this.spawnMember(EntitySimpleButton,780,this.homeButton.anchoredPositionY,{usePressedTween:!0,image:this.replayBtnImg,anchorX:0.5,anchorY:0.5,entryType:"fadeIn",exitType:"fadeOut",entryDuration:0.25,exitDuration:0.25});this.replayButton.onClicked.addOnce(this.onClickReplay,this);this.homeButton.anchoredPositionX=300;this.title.text=_STRINGS.Game.Paused;
ig.game.sortEntitiesDeferred()},update:function(){this.parent()},draw:function(){this.parent();if(this.showCover){var b=ig.system.context;b.save();b.fillStyle="#f8c85c";b.fillRect(0,0,ig.system.width,ig.system.height);b.restore()}},onClickHome:function(){if(this.isAllowInput){this.showCover=!0;ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);this.isAllowInput=!1;ig.babylonSceneController.paused=!0;this.delayedCall(0.1,function(){ig.game.goToLevel("MainMenu")}.bind(this));
for(var b=0;b<this.members.length;b++)this.members[b].exit();try{ig.linkit360Skill.trackGameInterrupted(ig.lastScore)}catch(c){}console.log(ig.lastScore)}},onClickResume:function(){if(this.isAllowInput){this.isAllowInput=!1;this.exit();ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);try{ig.linkit360Skill.trackGameResumed()}catch(b){}}},onClickReplay:function(){if(this.isAllowInput){this.showCover=!0;ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);
this.isAllowInput=!1;ig.babylonSceneController.paused=!0;this.delayedCall(0.1,function(){ig.game.goToLevel("Gameplay")}.bind(this));for(var b=0;b<this.members.length;b++)this.members[b].exit();try{ig.linkit360Skill.trackGameRestarted()}catch(c){}}}})});ig.baked=!0;
ig.module("game.entities.objects.score-fx").requires("impact.entity","game.toybox.objects.ui.texts.text-field").defines(function(){EntityScoreFx=EntityTextField.extend({rectOffsetScaleX:-1,rectScale:0.05,rectAlpha:1,"double":!1,init:function(b,c,e){e.text="+"+e.score;10==e.score&&(e.text=_STRINGS.Game.Bullseye+"\n+"+e.score,this.double=!0);0==e.score&&(e.text=_STRINGS.Game.Miss);e.anchorType="bottom";e.color="#000000";e.font="70px mainfont";e.align="center";e.entryType="fadeJumpIn";e.entryDelay=0.4;
e.exitType="fadeOut";e.timedLife=1;this.parent(0,-200,e);this.tween({rectOffsetScaleX:0},0.15).start();this.tween({rectScale:1},0.2,{easing:ig.Tween.Easing.Quadratic.EaseIn,delay:0.3}).start();this.delayedCall(0.4,function(){0==this.score?ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.scoreMiss):8<this.score?ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.scoreHigh):ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.scoreLow)}.bind(this))},drawObject:function(b,
c){var e=ig.system.context,d=ig.system.width,g=100*this.rectScale,f=-15,m=this.rectOffsetScaleX*ig.system.width;this.double&&(g*=2,f=15);0>this.timedLife&&(this.rectAlpha=this.alpha);e.globalAlpha=this.rectAlpha;e.fillStyle="#000000";e.fillRect(-d/2+m,-g/2-5+f,d,g+10);e.fillStyle="#fc594d";e.fillRect(-d/2+m,-g/2+f,d,g);e.fillStyle="#ffbc42";e.fillRect(-d/2+m,-g/2+f,d,g-10);this.globalAlpha=1;this.parent(b,c)},kill:function(){this.parent();this.callback()}})});ig.baked=!0;
ig.module("game.entities.objects.wind-fx").requires("game.toybox.objects.game-object").defines(function(){ig.windFxFactor=50;EntityWindFx=EntityGameObject.extend({windDirectionImage:new ig.Image("media/graphics/game/wind-direction.png"),traversedDistance:0,init:function(b,c,e){e.anchorType="bottom-left";e.image=this.windDirectionImage;e.scaleY=0.4;e.scaleX=e.scaleY*(0<ig.babylonSceneController.arrow.wind.x?1:-1);this.parent(b,c,e)},update:function(){this.parent();var b=ig.babylonSceneController.arrow.wind.x*
ig.windFxFactor*ig.system.tick;this.anchoredPositionX+=b;this.traversedDistance+=Math.abs(b);this.traversedDistance>this.killDistance?this.kill():ig.babylonSceneController.arrow.isFlying&&this.kill()}})});ig.baked=!0;
ig.module("game.entities.controllers.gameplay-controller").requires("impact.entity","game.entities.popups.pause-popup","game.toybox.objects.ui.buttons.simple-button","game.toybox.controllers.controller","game.entities.objects.score-fx","game.entities.objects.wind-fx").defines(function(){EntityGameplayController=EntityController.extend({pauseImage:new ig.Image("media/graphics/game/pause-btn.png"),targetImage:new ig.Image("media/graphics/game/target.png"),arrowImage:new ig.Image("media/graphics/game/arrow-icon.png"),
arrowBgImage:new ig.Image("media/graphics/game/arrow-bg.png"),windIconImage:new ig.Image("media/graphics/game/wind-icon.png"),windBgImage:new ig.Image("media/graphics/game/wind-bg.png"),popupBgImg:new ig.Image("media/graphics/game/popup-bg.png"),yesBtnImage:new ig.Image("media/graphics/game/yes-btn.png"),noBtnImage:new ig.Image("media/graphics/game/no-btn.png"),simpleBtnImage:new ig.Image("media/graphics/game/button-on.png"),allowShooting:!0,isAiming:!1,aimCenterX:0,aimCenterY:0,aimControlX:0,aimControlY:0,
aimMinimumSpeed:100,crosshairX:0,crosshairY:0,crosshairAreaRadius:3E3,crosshairStartAimRadius:500,crosshairSpeedMultiplier:5,cameraPositionRatio:0.02,showAimController:!1,score:0,arrowLeft:3,aimTime:5,aimTimeMax:8,aimTimeTextDistance:150,windFxSpawnDelay:0,hasRevived:!1,init:function(b,c,e){this.parent(b,c,e);ig.babylonSceneController.arrow.reset();this.score=0;this.scoreTf=ig.game.spawnEntity(EntityTextField,0,180,{font:"172px mainfont",text:"0",align:"center",color:"#000000",entryType:"fadeIn",
exitType:"fadeOut",anchorType:"top",entryDelay:0.5});this.tutorialTf=ig.game.spawnEntity(EntityTextField,0,-200,{font:"56px contentfont",text:_STRINGS.Game.Tutorial,lineSpacing:1.5,align:"center",color:"#ffbc42",outlineColor:"#000000",outlineWeight:6,entryType:"fadeIn",exitType:"fadeOut",anchorType:"bottom",entryDelay:0.5});this.aimTimeTf=ig.game.spawnEntity(EntityTextField,0,this.aimTimeTextDistance,{font:"56px contentfont",text:"",align:"center",color:"#000000",outlineColor:"#ffffff",outlineWeight:3,
entryType:"fadeIn",exitType:"fadeOut",anchorType:"center",entryDelay:0.5});this.arrowBg=ig.game.spawnEntity(EntityGameObject,20,20,{image:this.arrowBgImage,anchorType:"top-left",anchorX:0,anchorY:0,entryType:"fadeIn",exitType:"fadeOut"});this.arrows=[];for(b=0;b<this.arrowLeft;b++)c=ig.game.spawnEntity(EntityGameObject,40+64*b,72,{image:this.arrowImage,anchorType:"top-left",anchorX:0,anchorY:0,scaleX:0.8,scaleY:0.85,entryType:"fadeIn",exitType:"fadeOut"}),this.arrows.push(c);this.windBg=ig.game.spawnEntity(EntityGameObject,
260,-110,{image:this.windBgImage,anchorType:"bottom-left",anchorX:0.5,anchorY:1,alpha:0});this.windIcon=ig.game.spawnEntity(EntityGameObject,280,-220,{image:this.windIconImage,anchorType:"bottom-left",anchorX:0.5,anchorY:1,alpha:0});this.pauseButton=ig.game.spawnEntity(EntitySimpleButton,-160,160,{anchorType:"top-right",image:this.pauseImage,entryType:"fadeIn",exitType:"fadeOut",anchorX:0.5,anchorY:0.5,entryDelay:0.5});this.pauseButton.onClicked.add(this.onClickPause,this);ig.babylonSceneController.paused=
!1;ig.babylonSceneController.arrow.resetDifficulty();this.allowShooting=!0;this.isAiming=!1;ig.babylonSceneController.arrow.onLanded.add(this.onArrowLanded,this);ig.babylonSceneController.setTargetMovement(0,10,10);ig.game.sortEntitiesDeferred()},onArrowLanded:function(){ig.meshManager.crosshairPoint.position.x=0;ig.meshManager.crosshairPoint.position.y=ig.meshManager.targetHeight;ig.game.spawnEntity(EntityScoreFx,0,0,{score:ig.babylonSceneController.arrow.lastScore,callback:function(){this.score+=
ig.babylonSceneController.arrow.lastScore;try{ig.linkit360Skill.trackGameScore(this.score)}catch(b){}}.bind(this)});0==ig.babylonSceneController.arrow.lastScore&&this.arrowLeft--;this.delayedCall(0.25,function(){if(0<this.arrowLeft){ig.babylonSceneController.arrow.resetNextFrame=!0;ig.babylonSceneController.arrow.onTarget?(ig.babylonSceneController.arrow.increaseDifficulty(),console.log("increaseDifficulty")):console.log("keepDifficulty");this.allowShooting=!0;this.isAiming=!1;console.log("playAgain");
try{ig.linkit360Skill.trackUserAction("shoot")}catch(b){}}else this.delayedCall(2,function(){this.hasRevived?this.goToGameOver():this.askForRevive()}.bind(this))}.bind(this))},askForRevive:function(){this.rvUISet=[];var b=ig.game.spawnEntity(EntityGameObject,540,960,{anchorX:0.5,anchorY:0.5,image:this.popupBgImg,entryType:"fadeIn",exitType:"fadeOut"}),c=ig.game.spawnEntity(EntityTextField,540,610,{font:"96px mainfont",text:_STRINGS.Game.Continue,color:"#000000",align:"center",entryType:"fadeIn",exitType:"fadeOut"}),
e=ig.game.spawnEntity(EntityTextField,540,930,{font:"72px mainfont",lineSpacing:1.5,text:_STRINGS.Game.Revive,color:"#000000",align:"center",entryType:"fadeIn",exitType:"fadeOut"}),d=ig.game.spawnEntity(EntitySimpleButton,355,1250,{image:this.yesBtnImage,font:"72px mainfont",text:_STRINGS.Game.Yes,textColor:"#000000",offsetX:24,offsetY:-15,entryType:"fadeIn",exitType:"fadeOut"});d.onClicked.add(this.onClickRevive,this);var g=ig.game.spawnEntity(EntitySimpleButton,725,d.anchoredPositionY,{image:this.noBtnImage,
font:"72px mainfont",text:_STRINGS.Game.No,textColor:"#000000",offsetY:-15,entryType:"fadeIn",exitType:"fadeOut"});g.onClicked.add(this.onClickNoRevive,this);this.rvUISet.push(b,c,e,d,g)},clearRvUISet:function(){for(var b=0;b<this.rvUISet.length;b++)this.rvUISet[b].exit()},onClickRevive:function(){this.clearRvUISet();this.showRewardedVideo()},onClickNoRevive:function(){this.clearRvUISet();this.goToGameOver()},showRewardedVideo:function(){this.rewardedVideoResult(!0)},rewardedVideoResult:function(b){b?
this.showRVNotification(_STRINGS.Game.Reward,_STRINGS.Game.RewardSuccess,_STRINGS.Game.Sweet,function(){this.clearRvUISet();this.doRevive()}.bind(this)):this.showRVNotification(_STRINGS.Game.Reward,_STRINGS.Game.RewardFail,_STRINGS.Game.Okay,function(){this.clearRvUISet();this.goToGameOver()}.bind(this))},showRVNotification:function(b,c,e,d){var g=ig.game.spawnEntity(EntityGameObject,270,480,{anchorX:0.5,anchorY:0.5,image:this.popupBgImg,entryType:"fadeIn",exitType:"fadeOut"});b=ig.game.spawnEntity(EntityTextField,
270,324,{font:"36px mainfont",text:b,color:"#000000",align:"center",entryType:"fadeIn",exitType:"fadeOut"});c=ig.game.spawnEntity(EntityTextField,270,450,{font:"32px mainfont",text:c,color:"#000000",align:"center",entryType:"fadeIn",exitType:"fadeOut"});e=ig.game.spawnEntity(EntitySimpleButton,270,625,{image:this.simpleBtnImage,font:"36px mainfont",text:e,textColor:"#000000",offsetY:-7,entryType:"fadeIn",exitType:"fadeOut"});e.onClicked.add(function(){this.clearRvUISet();d&&d()}.bind(this),this);
this.rvUISet.push(g,b,c,e)},doRevive:function(){this.hasRevived=!0;this.arrowLeft=3;this.allowShooting=ig.babylonSceneController.arrow.resetNextFrame=!0;this.isAiming=!1;console.log("Revive")},goToGameOver:function(){ig.lastScore=this.score;ig.game.goToLevel("GameOver");ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.crowdApplause)},onClickPause:function(){if(this.isAllowInput){this.showPopup(EntityPausePopup);ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.click);
this.isAllowInput=!1;ig.babylonSceneController.paused=!0;this.pauseButton.usePressedTween=!1;console.log("pause");try{ig.linkit360Skill.trackGamePaused()}catch(b){}}},onPopupFinished:function(b){this.parent(b);this.isAllowInput=!1;this.delayedCall(0.25,function(){this.isAllowInput=!0;ig.babylonSceneController.paused=!1;this.pauseButton.usePressedTween=!0;console.log("resume")}.bind(this))},update:function(){this.parent();this.updateInput();this.scoreTf.text=Math.round(this.score).toFixed();this.scoreTf.visible=
0<this.score;var b=ig.babylonSceneController.arrow.wind.x;if(0!=b&&(ig.babylonSceneController.arrow.isRelaxing||ig.babylonSceneController.arrow.isAiming))if(this.windIcon.alpha+=(1-this.windIcon.alpha)/10,this.windIcon.scaleX=this.windIcon.scaleY*(0>b?-1:1),0<this.windFxSpawnDelay)this.windFxSpawnDelay-=ig.system.tick;else{var c=b*ig.windFxFactor;this.windFxSpawnDelay=Math.abs(20/c);ig.game.spawnEntity(EntityWindFx,this.windIcon.anchoredPositionX+(0>b?60:-60),this.windIcon.anchoredPositionY+10,{killDistance:120});
var b=ig.random.float(0,0<b?-ig.meshManager.stripeWidth/2:ig.meshManager.stripeWidth/2),e=ig.random.float(0.5*ig.meshManager.targetHeight,3*ig.meshManager.targetHeight),d=ig.random.float(0.2*ig.meshManager.targetDistance,ig.meshManager.targetDistance);ig.meshManager.spawnWindEffect(b,e,d,c)}else this.windIcon.alpha-=this.windIcon.alpha/10;this.windBg.alpha=this.windIcon.alpha;for(c=0;c<this.arrows.length;c++)this.arrows[c].visible=c<this.arrowLeft?!0:!1},updateInput:function(){if(!ig.babylonSceneController.paused){for(var b=
!1,c=0,e=0,d=0;d<ig.ToyboxTouch.touches.length;d++)e=ig.ToyboxTouch.touches[d],b=!0,c=e.x,e=e.y;!b&&ig.input.state("click")&&(b=!0,c=ig.game.io.mouse.getPos().x,e=ig.game.io.mouse.getPos().y);0>this.aimTime&&(b=!1);this.pauseButton.visible&&(b?this.pauseButton.isInsideBounds(c,e)&&(b=!1,this.isTouchingPauseButton=!0):this.isTouchingPauseButton=!1,this.isTouchingPauseButton&&(b=!1));this.allowShooting&&ig.babylonSceneController.arrow.isRelaxing?(b?(this.tutorialTf&&(this.tutorialTf.exit(),this.tutorialTf=
null),ig.cameraControl.targetFov=ig.cameraControl.fovAim,this.isAiming||(this.aimCenterX=c+ig.random.int(-25,25),this.aimCenterY=e+ig.random.int(-25,25),this.crosshairX=2*ig.random.int(-this.crosshairStartAimRadius,this.crosshairStartAimRadius),this.crosshairY=2*ig.random.int(-this.crosshairStartAimRadius,this.crosshairStartAimRadius),this.aimTime=this.aimTimeMax,ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList["bowDraw"+ig.random.int(1,5)])),this.isAiming=!0,this.aimControlX=c,
this.aimControlY=e,b=ig.system.tick,c=(this.aimControlX-this.aimCenterX)*b*this.crosshairSpeedMultiplier,d=(this.aimCenterY-this.aimControlY)*b*this.crosshairSpeedMultiplier,e=this.aimMinimumSpeed*b,c*c+d*d<e*e&&(d=ig.utils.normalize2(c,d,e),c=d.x,d=d.y),this.crosshairX+=c,this.crosshairY+=d,this.crosshairX<-this.crosshairAreaRadius&&(this.crosshairX=-this.crosshairAreaRadius),this.crosshairX>this.crosshairAreaRadius&&(this.crosshairX=this.crosshairAreaRadius),this.crosshairY<-this.crosshairAreaRadius&&
(this.crosshairY=-this.crosshairAreaRadius),this.crosshairY>this.crosshairAreaRadius&&(this.crosshairY=this.crosshairAreaRadius),-700>this.crosshairY&&(this.crosshairY=-700),ig.meshManager.crosshairPoint.position.x=0+this.crosshairX*this.cameraPositionRatio,ig.meshManager.crosshairPoint.position.y=ig.meshManager.targetHeight+this.crosshairY*this.cameraPositionRatio,this.aimTime-=b):(ig.cameraControl.targetFov=ig.cameraControl.fovRelaxing,this.isAiming&&(this.allowShooting=this.isAiming=!1,ig.babylonSceneController.arrow.launchNextFrame=
!0,ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList["bowRelease"+ig.random.int(1,5)]),this.aimTime=this.aimTimeMax)),this.pauseButton.visible=!this.isAiming):this.pauseButton.visible=!1;ig.babylonSceneController.arrow.isAiming=this.isAiming}},draw:function(){this.parent();var b=ig.system.context;b.clearRect(0,0,ig.system.width,ig.system.height);b.save();if(this.isAiming){b.save();var c=60,e=60,d=this.aimTime/this.aimTimeMax;0.5>d&&(b.globalAlpha=Math.cos(7*this.aimTime));b.translate(ig.system.width/
2,ig.system.height/2);b.fillStyle="#ffffff";b.beginPath();b.arc(0,0,7,0,2*Math.PI);b.fill();b.fillStyle="#000000";b.beginPath();b.arc(0,0,4,0,2*Math.PI);b.fill();c=30+(c-30)*d;e=30+(e-30)*d;b.lineCap="round";b.strokeStyle="#ffffff";b.lineWidth=10;b.beginPath();b.moveTo(-c,0);b.lineTo(-30,0);b.stroke();b.beginPath();b.moveTo(c,0);b.lineTo(30,0);b.stroke();b.beginPath();b.moveTo(0,-e);b.lineTo(0,-30);b.stroke();b.beginPath();b.moveTo(0,e);b.lineTo(0,30);b.stroke();b.strokeStyle="#000000";b.lineWidth=
4;b.beginPath();b.moveTo(-c,0);b.lineTo(-30,0);b.stroke();b.beginPath();b.moveTo(c,0);b.lineTo(30,0);b.stroke();b.beginPath();b.moveTo(0,-e);b.lineTo(0,-30);b.stroke();b.beginPath();b.moveTo(0,e);b.lineTo(0,30);b.stroke();b.globalAlpha=1;0.01<d&&(e=0.5*Math.PI*d,c=0.5*Math.PI-e/2,e=c+e,b.beginPath(),b.arc(0,0,this.aimTimeTextDistance+40,c,e),b.strokeStyle="#ffffff",b.lineWidth=20,b.stroke(),b.lineWidth=8,b.strokeStyle="#000000",b.stroke());b.restore();this.showAimController&&(b.fillStyle="#000000",
b.strokeStyle="#000000",b.lineWidth=2,b.beginPath(),b.arc(this.aimCenterX,this.aimCenterY,10,0,2*Math.PI),b.fill(),b.beginPath(),b.arc(this.aimCenterX,this.aimCenterY,50,0,2*Math.PI),b.stroke(),b.beginPath(),b.arc(this.aimControlX,this.aimControlY,5,0,2*Math.PI),b.fill(),b.beginPath(),b.moveTo(this.aimCenterX,this.aimCenterY),b.lineTo(this.aimControlX,this.aimControlY),b.stroke());this.aimTimeTf.alpha+=(1-this.aimTimeTf.alpha)/5;this.aimTimeTf.text=this.aimTime.toFixed(1)+"s"}else this.aimTimeTf.alpha-=
this.aimTimeTf.alpha/5,this.aimTimeTf.text="";b.restore()}})});ig.baked=!0;ig.module("game.levels.gameplay").requires("impact.image","game.entities.controllers.gameplay-controller").defines(function(){LevelGameplay={entities:[{type:"EntityGameplayController",x:0,y:0}],layer:[]}});ig.baked=!0;
ig.module("game.entities.controllers.tutorial-controller").requires("impact.entity","game.toybox.objects.ui.buttons.simple-button","game.toybox.controllers.controller").defines(function(){EntityTutorialController=EntityController.extend({init:function(b,c,e){this.parent(b,c,e);for(b=0;4>b;b++)c=ig.game.spawnEntity(EntityTextField,270,250+60*b,{font:"38px mainfont",text:"",align:"center",entryType:"fadeIn",exitType:"fadeOut",enableShadow:!0,shadowColor:"#f36d61"}),c.text=ig.ua.mobile?_STRINGS.Game.TutorialMobile[b]:
_STRINGS.Game.TutorialDesktop[b],3==b&&(c.anchoredPositionY=650);this.isAllowInput=!0;ig.gameScene3D.paused=!0;ig.gameScene3D.player.mesh.isVisible=!1},update:function(){this.parent();ig.ua.mobile?this.isClicking&&this.isAllowInput&&(this.isAllowInput=!1,this.onClickPlay()):ig.input.state("jump")&&this.isAllowInput&&(this.isAllowInput=!1,this.onClickPlay())},onClickPlay:function(){ig.game.goToLevel("Gameplay")},timer:1,draw:function(){this.parent();var b=ig.system.context;b.clearRect(0,0,ig.system.width,
ig.system.height);ig.ua.mobile&&(this.timer-=ig.system.tick/2,0>this.timer&&(this.timer=1),b.save(),b.fillStyle="rgba(255,255,255,0.2)",0.5>this.timer?b.fillRect(0,0,ig.system.width/2,ig.system.height):b.fillRect(ig.system.width/2,0,ig.system.width/2,ig.system.height),b.restore())}})});ig.baked=!0;ig.module("game.levels.tutorial").requires("impact.image","game.entities.controllers.tutorial-controller").defines(function(){LevelTutorial={entities:[{type:"EntityTutorialController",x:0,y:0}],layer:[]}});
ig.baked=!0;
ig.module("game.scene3d.utils.camera-control").defines(function(){ig.cameraControl={camera:null,targetMesh:null,zero:null,light:null,tempVec1:null,tempVec2:null,tempVec3:null,targetRelativePosition:null,isFrozen:!1,targetFov:1.6,fovAim:0.5,fovRelaxing:0.8,init:function(){var b=ig.altBabylon.scene;b.clearColor.set(207/255,240/255,213/255,1);this.light=b.getLightByName("Light");this.light.intensity=0.3;this.light.diffuse=new BABYLON.Color3(0.5,0.5,0.5);this.light.position.set(0,100,ig.meshManager.targetDistance/2);
this.camera=b.getCameraByName("Camera");this.zero=new BABYLON.Vector3(0,0,0);this.targetRelativePosition=new BABYLON.Vector3(0,0,-10);this.camera.minZ=0;this.camera.maxZ=2E3;this.camera.fov=0.8;this.zero=new BABYLON.Vector3(0,0,0);this.tempVec1=new BABYLON.Vector3(0,0,0);this.tempVec2=new BABYLON.Vector3(0,0,0);this.tempVec3=new BABYLON.Vector3(0,0,0);this.pointCameraToVec3(new BABYLON.Vector3(0,20,0),0,!0)},turnSpeed:0,turnAcc:10,update:function(){this.targetMesh&&this.pointCameraToTarget();this.camera.fov!=
this.targetFov&&(this.camera.fov+=(this.targetFov-this.camera.fov)/10,0.001>Math.abs(this.camera.fov-this.targetFov)&&(this.camera.fov=this.targetFov))},followMesh:function(b){this.targetMesh=b},unfollowMesh:function(){this.targetMesh=null},reset:function(){this.camera.position.set(0,20,20);this.camera.setTarget(new BABYLON.Vector3(0,0,50))},pointCameraToTarget:function(b){this.pointCameraToVec3(this.targetMesh.position.clone(),0,b)},pointCameraToVec3:function(b,c,e){c=this.tempVec1;c.copyFrom(this.camera.target);
e?(c.x=b.x,c.y=b.y,c.z=b.z):(b.z>ig.meshManager.targetDistance+20&&(b.z=ig.meshManager.targetDistance+20),c.x+=(b.x-c.x)/10,c.y+=(b.y-c.y)/10,c.z+=(b.z-c.z)/10);this.camera.position.set(c.x+this.targetRelativePosition.x,c.y+this.targetRelativePosition.y,c.z+this.targetRelativePosition.z);this.camera.setTarget(c)}}});ig.baked=!0;
ig.module("game.scene3d.utils.mesh-manager").defines(function(){ig.meshManager={ground:null,target:null,bow:null,arrowTip:null,arrowBody:null,crosshairPoint:null,treeLineDistance:450,targetDistance:350,targetHeight:20,targetRadius:8,stripeWidth:300,windIndicator:null,windSources:[],winds:[],windImages:[new ig.Image("media/graphics/game/wind1.png"),new ig.Image("media/graphics/game/wind2.png"),new ig.Image("media/graphics/game/wind3.png"),new ig.Image("media/graphics/game/wind4.png")],init:function(){this.initGround();
this.initTarget();this.initArrow();this.initBow();this.initWindEffect();setTimeout(function(){ig.altBabylon.scene.getMaterialByName("default material")&&(ig.altBabylon.scene.getMaterialByName("default material").disableLighting=!0)}.bind(this),200)},initGround:function(){var b=ig.altBabylon.scene;this.groundMaterial=new BABYLON.StandardMaterial("groundMaterial",b);this.groundMaterial.emissiveColor=BABYLON.Color3.FromHexString("#6dc89d");this.groundMaterial.ambientColor=BABYLON.Color3.FromHexString("#6dc89d");
this.groundMaterial.diffuseColor=BABYLON.Color3.FromHexString("#6dc89d");this.groundMaterial.disableLighting=!0;this.ground=BABYLON.MeshBuilder.CreateGround("ground",{width:5E3,height:5E3},b);this.ground.position.set(0,0,0);this.ground.material=this.groundMaterial;this.stripes=[];this.stripeMaterial=new BABYLON.StandardMaterial("stripeMaterial",b);this.stripeMaterial.emissiveColor=BABYLON.Color3.FromHexString("#baf577");this.stripeMaterial.ambientColor=BABYLON.Color3.FromHexString("#baf577");this.stripeMaterial.diffuseColor=
BABYLON.Color3.FromHexString("#baf577");this.stripeMaterial.disableLighting=!0;for(var c=this.stripeWidth,e=0;e<this.treeLineDistance+300;e+=80){var d=BABYLON.MeshBuilder.CreateBox("stripe",{width:c,height:1,depth:40},b);d.position.set(0,0,e);d.material=this.stripeMaterial;d.convertToFlatShadedMesh();this.stripes.push(d)}this.trees=[];d=b.getMeshByName("tree");e=b.getMaterialByName("Green 2");e.emissiveColor.r*=1.1;e.emissiveColor.g*=1.1;e.emissiveColor.b*=1.1;e=b.getMaterialByName("Brown");e.emissiveColor.r*=
3;e.emissiveColor.g*=3;e.emissiveColor.b*=3;d.position.set(0,35,-this.treeLineDistance);b=!0;for(e=-c;e<c;e+=15){var g=d.createInstance("treeInstance");g.position.x=e;g.position.z=this.treeLineDistance;b?b=!1:(g.position.z+=50,b=!0);g.scaling.y=ig.random.float(1,1.3);g.rotation.y=ig.random.float(0,2*Math.PI);this.trees.push(g)}for(e=0;e<this.treeLineDistance;e+=20){g=d.createInstance("treeInstance");g.position.x=-c/2;g.position.z=e;b?b=!1:(g.position.x+=50,b=!0);var f=d.createInstance("treeInstance");
f.position.x=c/2;f.position.z=e;b&&(f.position.x-=50);g.scaling.y=ig.random.float(1,1.3);f.scaling.y=ig.random.float(1,1.3);g.rotation.y=ig.random.float(0,2*Math.PI);f.rotation.y=ig.random.float(0,2*Math.PI)}},initTarget:function(){var b=ig.altBabylon.scene;this.targetDynamicTexture=new BABYLON.DynamicTexture("targetTexture",1024,b,!0);this.targetTextureHasDrawn=!1;this.targetMaterial=new BABYLON.StandardMaterial("targetMaterial",b);this.targetMaterial.emissiveTexture=this.targetDynamicTexture;this.targetMaterial.diffuseTexture=
this.targetDynamicTexture;this.targetMaterial.opacityTexture=this.targetDynamicTexture;var c=[new BABYLON.Vector4(0,0,1,1),new BABYLON.Vector4(0,0,0.01,0.01),new BABYLON.Vector4(0,0,1,1)],e=[BABYLON.Color4.FromHexString("#a60000ff"),BABYLON.Color4.FromHexString("#a60000ff"),BABYLON.Color4.FromHexString("#ffffffff")];this.target=BABYLON.MeshBuilder.CreateCylinder("target",{diameter:2*this.targetRadius,height:5,tessellation:64,faceUV:c,faceColors:e},b);this.target.position.set(0,this.targetHeight,this.targetDistance);
this.target.rotation.set(-Math.PI/2,0,0);this.target.material=this.targetMaterial},initArrow:function(){var b=ig.altBabylon.scene;this.arrowTip=BABYLON.MeshBuilder.CreateSphere("arrowTip",{diameter:1},b);this.arrowTip.position.set(0,20,0);this.arrowTip.visibility=0;this.arrowBody=b.getMeshByName("Arrow");this.arrowBody.position.set(0,20,0);this.arrowTip.addChild(this.arrowBody);this.aftershotCamPos=BABYLON.MeshBuilder.CreateSphere("arrowTip",{diameter:0.1},b);this.aftershotCamPos.position.copyFrom(this.target.position);
this.aftershotCamPos.position.x-=5;this.aftershotCamPos.position.y+=5;this.aftershotCamPos.position.z-=15;this.aftershotCamPos.isVisible=!1;this.crosshairPoint=BABYLON.MeshBuilder.CreateSphere("crosshairPoint",{diameter:0.1},b);this.crosshairPoint.position.copyFrom(this.target.position);this.crosshairPoint.isVisible=!1},initBow:function(){this.bow=ig.altBabylon.scene.getMeshByName("Bow");this.bow.position.set(0,0,0)},initWindIndicator:function(){var b=ig.altBabylon.scene;this.screenCorner=BABYLON.MeshBuilder.CreateBox("screenCorner",
{width:0.5,height:0.5,depth:0.5},b);this.screenCorner.setPivotMatrix(BABYLON.Matrix.Translation(0.5,0.15,1),!1);var c=BABYLON.MeshBuilder.CreateGround("windPlane",{width:2,height:2},b);c.material=new BABYLON.StandardMaterial("WindIndicatorMat",b);c.material.emissiveColor=new BABYLON.Color3(1,1,1);c.material.disableLighting=!0;this.windIndicatorTexture=new BABYLON.DynamicTexture("windPlaneTexture",512,b,!0);c.material.diffuseTexture=this.windIndicatorTexture;c.material.opacityTexture=this.windIndicatorTexture;
this.windIndicatorTextureHasDrawn=c.material.backFaceCulling=!1;this.cornerOffset=new BABYLON.TransformNode("screenCornerOffset");this.windIndicator=new BABYLON.TransformNode("windIndicator");this.windIndicator.parent=this.screenCorner;c.parent=this.screenCorner;this.windIndicator.scaling.set(0.01,0.01,0.01)},initWindEffect:function(){var b=ig.altBabylon.scene;this.windTextureHasDrawn=!1;for(var c=0;c<this.windImages.length;c++){var e=BABYLON.Mesh.CreatePlane("windPlane"+c,12,b,!1);e.material=new BABYLON.StandardMaterial("windPlaneMat"+
c,b);e.material.emissiveColor=new BABYLON.Color3(1,1,1);e.material.disableLighting=!0;var d=new BABYLON.DynamicTexture("windTexture"+c,256,b,!0);e.material.diffuseTexture=d;e.material.opacityTexture=d;e.material.backFaceCulling=!1;e.position.y=1E4;this.windSources.push(e)}},spawnWindEffect:function(b,c,e,d){var g=ig.random.fromArray(this.windSources).clone();g.position.set(b,c,e);g.windSpeed=d;g.visibility=0;0>d&&(g.scaling.x=-1);this.winds.push(g)},clearWindEffect:function(){for(;0<this.winds.length;)this.winds.pop().dispose()},
update:function(b){for(var c=0;c<this.winds.length;c++){var e=this.winds[c];0.6>e.visibility&&(e.visibility+=b,0.6<e.visibility&&(e.visibility=0.6));e.position.x+=e.windSpeed*b;Math.abs(e.position.x)>this.stripeWidth+50&&(e.dispose(),this.winds.splice(c,1),c--)}this.targetTextureHasDrawn||(b=new ig.Image("media/graphics/game/target.png"),b.loaded&&(e=this.targetDynamicTexture.getContext(),b.drawCtx?b.drawCtx(e,0,0):e.drawImage(b.data,0,0),this.targetDynamicTexture.update(),this.targetTextureHasDrawn=
!0,console.log("targetDrawn")));if(!this.windTextureHasDrawn){for(var d=0,c=0;c<this.windSources.length;c++)if(b=this.windImages[c],b.loaded){var g=this.windSources[c].material.diffuseTexture,e=g.getContext();e.clearRect(0,0,256,256);b.drawCtx?b.drawCtx(e,0,0):e.drawImage(b.data,0,0);g.update();d++}d==this.windImages.length&&(this.windTextureHasDrawn=!0)}},setPosition:function(b,c,e,d,g,f,m){d/=m;m=e/m;b=b?-1+2*d:1-2*m-2*d;e=new BABYLON.Vector3(-1,-1,-0.9999);m=new BABYLON.Vector3(-1+2*m,-1,-0.9999);
d=BABYLON.Vector3.TransformCoordinates(e,f);m=BABYLON.Vector3.TransformCoordinates(m,f).subtract(d).length();c.scaling=new BABYLON.Vector3(m,m,m);e.x=b;c.rotation.copyFrom(g.rotation);c.position=BABYLON.Vector3.TransformCoordinates(e,f)},normalize2:function(b,c,e){var d=Math.sqrt(b*b+c*c);return{x:e*b/d,y:e*c/d}},getCenterVec3:function(b,c){var e=new BABYLON.Vector3(0,0,0);e.x=(b.x+c.x)/2;e.y=(b.y+c.y)/2;e.z=(b.z+c.z)/2;return e},normalizeYToCenter:function(b,c,e,d){var g=b.x-c,f=b.z-e,m=Math.sqrt(g*
g+f*f);b.x=d*g/m+c;b.z=d*f/m+e},rotateOnYAxis:function(b,c,e,d){var g=Math.sin(d);d=Math.cos(d);b.x=(b.x-c)*d-(b.z-e)*g+c;b.z=(b.x-c)*g+(b.z-e)*d+e}}});ig.baked=!0;
ig.module("game.scene3d.objects.mesh-object").defines(function(){ig.MeshObject=ig.Class.extend({mesh:null,timedLife:-1,init:function(b,c,e,d,g,f){g?(this.mesh=d.clone("clonedMesh"),this.mesh.sourceName=d.name):this.mesh=f?d.createInstance("meshInstance"):d;this.mesh.position.set(b,c,e)},update:function(b){0<this.timedLife&&(this.timedLife-=b,0>=this.timedLife&&this.destroy())},destroy:function(){this.mesh.dispose()}})});ig.baked=!0;
ig.module("game.scene3d.objects.arrow").requires("game.scene3d.objects.mesh-object").defines(function(){ig.Arrow=ig.MeshObject.extend({isFlying:!1,gravity:null,speed:null,wind:null,lookTarget:null,aftershotTarget:null,arrowPower:200,arrowBody:null,isAiming:!1,isRelaxing:!1,onLanded:null,launchNextFrame:!1,resetNextFrame:!1,onTarget:!1,difficulty:0,init:function(){this.parent(0,0,0,ig.meshManager.arrowTip,!1,!1);this.speed=new BABYLON.Vector3(0,0,0);this.wind=new BABYLON.Vector3(1,0,0);this.lookTarget=
new BABYLON.Vector3(0,0,0);this.aftershotTarget=new BABYLON.Vector3(0,0,0);this.gravity=new BABYLON.Vector3(0,-10,0);this.arrowBody=ig.meshManager.arrowBody;this.reset();this.onLanded=new ig.Signal},resetDifficulty:function(){this.difficulty=0;this.wind.set(0,0,0)},increaseDifficulty:function(){this.difficulty++;var b=2*this.difficulty;20<b&&(b=20);b=0.25*ig.random.int(-b,b);this.wind.x=b;console.log("windSpeed",b.toFixed(2))},isHitTarget:function(){var b=ig.meshManager.target,c=this.mesh;if(this.mesh.intersectsMesh(ig.meshManager.target,
!1)){var e=c.position.x-b.position.x,b=c.position.y-b.position.y;return e*e+b*b<=ig.meshManager.targetRadius*ig.meshManager.targetRadius}return!1},isHitPost:function(){for(var b=0;b<ig.babylonSceneController.postLines.length;b++)if(this.mesh.intersectsMesh(ig.babylonSceneController.postLines[b],!0))return!0;return!1},isHitTrees:function(){for(var b=0;b<ig.meshManager.trees.length;b++){var c=ig.meshManager.trees[b];if(this.mesh.intersectsMesh(c)&&this.mesh.position.z>c.position.z-8){var e=this.isInside(c.position.x,
c.position.y+40,c.position.x+15,c.position.y-25,c.position.x-15,c.position.y-25,this.mesh.position.x,this.mesh.position.y);console.log(e);if(e||5>Math.abs(this.mesh.position.x-c.position.x))return!0}}return!1},area:function(b,c,e,d,g,f){return Math.abs((b*(d-f)+e*(f-c)+g*(c-d))/2)},isInside:function(b,c,e,d,g,f,m,l){var j=this.area(b,c,e,d,g,f),n=this.area(m,l,e,d,g,f);g=this.area(b,c,m,l,g,f);b=this.area(b,c,e,d,m,l);return j==n+g+b},calculateScore:function(){var b=ig.meshManager.target,c=this.mesh,
e=c.position.x-b.position.x,b=c.position.y-b.position.y,e=Math.sqrt(e*e+b*b),e=Math.floor(10*(1-e/ig.meshManager.targetRadius))+1;if(0>e||!this.onTarget)e=0;this.lastScore=e;0==e?ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.crowdMiss):8<e?ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.crowdCheers):ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.crowdApplause)},update:function(b){this.parent(b);if(this.isFlying){var c=this.mesh,e=c.position.z>
ig.meshManager.targetDistance?2:1;this.speed.x+=(this.gravity.x+this.wind.x)*b;this.speed.y+=(this.gravity.y+this.wind.y)*b*e;this.speed.z+=(this.gravity.z+this.wind.z)*b;c.position.x+=this.speed.x*b;c.position.y+=this.speed.y*b;c.position.z+=this.speed.z*b;this.lookTarget.set(this.speed.x+c.position.x,this.speed.y+c.position.y,this.speed.z+c.position.z);c.lookAt(this.lookTarget);b=this.isHitTarget();var c=0>this.mesh.position.y,e=this.isHitPost(),d=this.isHitTrees();if(b||c||e||d)b&&(!c&&!d)&&(this.onTarget=
!0),ig.soundHandler.sfxPlayer.stop(ig.soundHandler.sfxPlayer.soundList.flight),(b||e)&&ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList["arrowLand"+ig.random.int(1,5)]),ig.babylonSceneController.targetAllowMove=!1,this.calculateScore(),this.isFlying=!1,setTimeout(function(){ig.cameraControl.unfollowMesh();this.aftershotTarget.copyFrom(this.mesh.position);this.toAftershotCam=!0;ig.meshManager.clearWindEffect();console.log("arrowLanded")}.bind(this),1E3)}else if(this.isAiming||this.isRelaxing)this.mesh.position.x+=
(ig.cameraControl.camera.position.x+1-this.mesh.position.x)/2,this.mesh.position.y+=(ig.cameraControl.camera.position.y-2-this.mesh.position.y)/2,this.mesh.position.z+=(ig.cameraControl.camera.position.z+10-this.mesh.position.z)/2;this.toAftershotCam&&(b=ig.cameraControl.camera,c=this.aftershotTarget.x-5,e=this.aftershotTarget.y+5,d=this.aftershotTarget.z-30,d>ig.meshManager.targetDistance+20?(this.toAftershotCam=!1,this.onLanded.dispatch()):(b.position.x+=(c-b.position.x)/20,b.position.y+=(e-b.position.y)/
20,b.position.z+=(d-b.position.z)/20,b.target.x=this.aftershotTarget.x,b.target.y=this.aftershotTarget.y,b.target.z=this.aftershotTarget.z,b.setTarget(b.target),0.1>Math.abs(b.position.z-d)&&(this.toAftershotCam=!1,this.onLanded.dispatch())));this.launchNextFrame&&(this.launch(),this.launchNextFrame=!1);this.resetNextFrame&&(ig.cameraControl.unfollowMesh(),b=ig.cameraControl.camera,b.position.x+=(0-b.position.x)/10,b.position.y+=(ig.meshManager.targetHeight-b.position.y)/2,c=(-10-b.position.z)/2,
-5>c&&(c=-5),b.position.z+=c,0.1>Math.abs(b.position.x)&&(b.position.x=0),c=ig.meshManager.targetHeight,e=ig.meshManager.targetDistance,b.target.x+=(0-b.target.x)/2,b.target.y+=(c-b.target.y)/2,b.target.z+=(e-b.target.y)/2,this.aftershotTarget.z>e&&-9.9<b.position.z&&(b.target.z=this.aftershotTarget.z),b.setTarget(b.target),-9.98>=b.position.z&&0.02>Math.abs(ig.meshManager.targetHeight-b.position.y)&&(this.resetNextFrame=!1,this.reset()));ig.meshManager.bow.position.x=this.mesh.position.x+0.1;ig.meshManager.bow.position.y=
this.mesh.position.y;ig.meshManager.bow.position.z=0<this.mesh.position.z?-this.mesh.position.z-2:this.mesh.position.z-2;-2<ig.meshManager.bow.position.z&&(ig.meshManager.bow.position.z=-2)},reset:function(){this.onTarget&&ig.babylonSceneController.nextTargetMovement();this.isFlying=this.toAftershotCam=this.resetNextFrame=this.launchNextFrame=!1;this.isRelaxing=!0;this.isAiming=!1;this.mesh.position.set(1,ig.meshManager.targetHeight-2,-50);this.mesh.rotation.set(0,0,0);ig.cameraControl.targetRelativePosition.set(0,
0,-ig.meshManager.targetDistance-10);ig.cameraControl.followMesh(ig.meshManager.crosshairPoint);ig.cameraControl.pointCameraToTarget(!0);this.mesh.isVisible=!0;ig.meshManager.target.isVisible=!0;ig.babylonSceneController.targetAllowMove=!0;this.onTarget=!1;console.log("reset");ig.babylonSceneController.isMainMenu=!1;ig.meshManager.bow.isVisible=!0},setMainMenu:function(){this.reset();ig.babylonSceneController.isMainMenu=!0;this.mesh.isVisible=!1;ig.meshManager.target.isVisible=!1;ig.meshManager.bow.isVisible=
!1;ig.babylonSceneController.postLines||(ig.babylonSceneController.postLines=[]);for(;0<ig.babylonSceneController.postLines.length;)ig.babylonSceneController.postLines.pop().dispose()},launch:function(){this.onTarget=!1;this.isFlying=!0;this.isRelaxing=!1;this.mesh.position.x=ig.cameraControl.camera.position.x;this.mesh.position.y=ig.cameraControl.camera.position.y;this.speed.set(0,-this.gravity.y*((ig.meshManager.targetDistance-this.mesh.position.z)/this.arrowPower/2),this.arrowPower);ig.cameraControl.targetRelativePosition.set(-1,
1,-10);ig.cameraControl.followMesh(this.mesh);ig.cameraControl.pointCameraToTarget(!0);ig.soundHandler.sfxPlayer.play(ig.soundHandler.sfxPlayer.soundList.flight)}})});ig.baked=!0;
ig.module("game.scene3d.babylon-scene-controller").requires("game.scene3d.utils.camera-control","game.scene3d.utils.mesh-manager","game.scene3d.objects.arrow").defines(function(){ig.babylonSceneController={hasInitialized:!1,paused:!1,player:null,dtAccumulator:0,arrow:null,shadowGenerator:null,targetAllowMove:!0,targetMovementId:0,targetMovementWaypoints:null,targetMovementTime:0,targetMovementSize:0,targetMovementDuration:0,postLines:[],init:function(){console.log("WebGL Version",ig.altBabylon.engine.webGLVersion);
this.initTargetMovementWaypoints();ig.meshManager.init();ig.cameraControl.init();ig.showStats=!1;this.arrow=new ig.Arrow;ig.altBabylon.onUpdate.add(this.update.bind(this));this.paused=this.hasInitialized=!0;this.reset();this.setTargetMovement(0,10,10)},nextTargetMovement:function(){var b=this.targetMovementId+1,c=this.targetMovementSize+2,e=this.targetMovementDuration;b>=this.targetMovementWaypoints.length&&(b=0);22<c&&(c=16,e--,4>e&&(e=4));console.log(c,e);this.setTargetMovement(b,c,e)},reset:function(){this.arrow.reset()},
initDebug:function(){ig.debug&&(ig.sceneInstrumentation=new BABYLON.SceneInstrumentation(ig.altBabylon.scene),ig.sceneInstrumentation.captureActiveMeshesEvaluationTime=!0,ig.sceneInstrumentation.captureRenderTargetsRenderTime=!0,ig.sceneInstrumentation.captureDrawCalls=!0,ig.sceneInstrumentation.captureFrameTime=!0,ig.sceneInstrumentation.captureRenderTime=!0,ig.sceneInstrumentation.captureCameraRenderTime=!0)},update:function(b){!this.paused&&(this.hasInitialized&&!this.isMainMenu)&&(ig.cameraControl.update(b),
ig.meshManager.update(b),this.arrow.update(b),this.updateTarget(b))},updateTarget:function(){var b=ig.meshManager.target;if(0==this.targetMovementId)b.position.x=0,b.position.y=ig.meshManager.targetHeight;else if(this.targetAllowMove){var c=this.targetMovementTime/this.targetMovementDuration;1<=c?(this.targetMovementTime=0,c=1):this.targetMovementTime+=ig.system.tick;var e=this.targetMovementWaypoints[this.targetMovementId],d=1/e.length,g=Math.floor(c/d),d=(c-g*d)/d,f=e[g],m=g<e.length-1?e[g+1]:e[0];
1==c&&(f=e[g-1],m=e[0],d=1);c=(1-d)*f.y*this.targetMovementSize+d*m.y*this.targetMovementSize+ig.meshManager.targetHeight;b.position.x=(1-d)*f.x*this.targetMovementSize+d*m.x*this.targetMovementSize+0;b.position.y=c}},setTargetMovement:function(b,c,e){this.targetMovementDuration=e;this.targetMovementSize=c;this.targetMovementId=b;this.targetMovementTime=0;this.buildPostLines(b,c)},buildPostLines:function(b,c){this.postLines||(this.postLines=[]);for(;0<this.postLines.length;)this.postLines.pop().dispose();
for(var e=this.targetMovementWaypoints[b],d=ig.meshManager.targetHeight,g=0;g<e.length;g++){var f=e[g],m=f.x*c+0,l=f.y*c+d,f=g<e.length-1?e[g+1]:e[0],j=f.x*c+0,n=f.y*c+d,f=j-m,r=n-l,q=Math.sqrt(f*f+r*r),j=(j+m)/2,n=(n+l)/2,q=BABYLON.MeshBuilder.CreateBox("post",{width:q,height:3,depth:3},ig.altBabylon.scene);q.position.x=j;q.position.y=n;q.position.z=ig.meshManager.targetDistance+3;q.rotation.z=Math.atan2(r,f);f=BABYLON.MeshBuilder.CreateSphere("point",{diameter:3,segments:8},ig.altBabylon.scene);
f.position.x=m;f.position.y=l;f.position.z=q.position.z;this.postLines.push(q);this.postLines.push(f)}e=this.findCenterPostHeight(b,c);d=BABYLON.MeshBuilder.CreateBox("post",{width:3,height:e,depth:3},ig.altBabylon.scene);d.position.x=0;d.position.y=e/2;d.position.z=ig.meshManager.targetDistance+3;this.postLines.push(d);console.log("centerpostHeight:",e)},findCenterPostHeight:function(b,c){if(0==b)return ig.meshManager.targetHeight;for(var e=this.targetMovementWaypoints[b],d=ig.meshManager.targetHeight,
g=9999999999,f=0;f<e.length;f++)for(var m=e[f],l=m.x*c+0,j=m.y*c+d,m=f<e.length-1?e[f+1]:e[0],n=m.x*c+0,m=m.y*c+d,r=0;1>r;r+=0.01){var q=(1-r)*j+r*m;0.5>Math.abs((1-r)*l+r*n)&&q<g&&(g=q)}return g},initTargetMovementWaypoints:function(){this.targetMovementWaypoints=[[{x:0,y:0}],[{x:0,y:0},{x:1,y:0},{x:0,y:0},{x:-1,y:0}],[{x:0,y:0},{x:-1,y:1},{x:1,y:1}],[{x:0,y:0},{x:-1,y:0},{x:-1,y:1},{x:0,y:1},{x:1,y:1},{x:1,y:0}],[{x:0,y:0},{x:1,y:1},{x:0,y:2},{x:-1,y:1}],[{x:-2,y:0},{x:-1,y:1},{x:0,y:0},{x:1,y:1},
{x:2,y:0},{x:1,y:1},{x:0,y:0},{x:-1,y:1}],[{x:0,y:0},{x:1,y:0},{x:-1,y:2},{x:1,y:2},{x:-1,y:0}],[{x:-1,y:0},{x:1,y:1},{x:1,y:0},{x:-1,y:1}],[{x:0,y:0},{x:0.5,y:0.5},{x:-0.5,y:1.5},{x:0,y:2}],[{x:0,y:0},{x:0.5,y:0.5},{x:-0.5,y:1.5},{x:0,y:2},{x:0.5,y:1.5},{x:-0.5,y:0.5}],[{x:0,y:0.224},{x:0.309,y:0},{x:0.202,y:0.378},{x:0.5,y:0.618},{x:0.125,y:0.628},{x:0,y:1},{x:-0.125,y:0.628},{x:-0.5,y:0.618},{x:-0.202,y:0.378},{x:-0.309,y:0}]];this.basePostHeight=[]}}});ig.baked=!0;
ig.module("game.toybox.utils.tween-patch").requires("plugins.tween").defines(function(){ig.Entity.prototype.delayedCall=function(b,c,e){void 0===e&&(e=!0);b=new ig.Tween(this,{},b,{onComplete:c});this.tweens.push(b);e&&b.start();return b}});ig.baked=!0;
ig.module("game.toybox.objects.ui.texts.text-renderer").requires("impact.impact").defines(function(){ig.TextRenderer=ig.Class.extend({text:"",font:"48px Arial",color:"#000000",alpha:1,align:"start",offsetX:0,offsetY:0,lineSpacing:1,valign:"default",enableShadow:!1,shadowColor:"#000000",shadowOffsetX:0,shadowOffsetY:4,shadowAlpha:1,outlineWeight:0,outlineColor:"#000000",outlineCap:"square",outlineJoin:"bevel",_previousText:"",_multiline:!1,_lines:[],_lineHeightInPixel:0,init:function(){},draw:function(b,
c){void 0===b&&(b=0);void 0===c&&(c=0);this.enableShadow&&this.drawText(b+this.shadowOffsetX,c+this.shadowOffsetY,this.shadowAlpha*this.alpha,this.shadowColor,this.shadowColor);this.drawText(b,c,this.alpha,this.color,this.outlineColor)},drawText:function(b,c,e,d,g){if(0<this.text.length){this._previousTextString!=this.text&&(this._previousTextString=this.text,this._lines=this.text.split(/\r?\n/),this._multiline=1<this._lines.length?!0:!1,this._lineHeightInPixel=parseInt(this.font.split("px")[0].split(" ").pop())*
this.lineSpacing,isNaN(this._lineHeightInPixel)&&console.error("'"+this.font+"' is a wrong font string format, error when rendering "+this.text));var f=ig.system.context;f.save();f.font=this.font;f.textAlign=this.align;f.lineWidth=2*this.outlineWeight;f.lineCap=this.outlineCap;f.lineJoin=this.outlineJoin;f.miterLimit=2*this.outlineWeight;1>e?(d=ig.hexToRgb(d),f.fillStyle="rgba("+d.r+","+d.g+","+d.b+","+e+")",d=ig.hexToRgb(g),f.strokeStyle="rgba("+d.r+","+d.g+","+d.b+","+e+")"):(f.fillStyle=d,f.strokeStyle=
g);b+=this.offsetX;e=c+this.offsetY;if(this._multiline){c=e;"center"==this.valign&&(c=e-(this._lines.length-1)*this._lineHeightInPixel/2);for(e=0;e<this._lines.length;e++)g=this._lines[e],0<this.outlineWeight&&f.strokeText(g,b,c+e*this._lineHeightInPixel),f.fillText(g,b,c+e*this._lineHeightInPixel)}else"center"==this.valign&&(e+=this._lineHeightInPixel/2),0<this.outlineWeight&&f.strokeText(this.text,b,e),f.fillText(this.text,b,e);f.restore()}},measureTextWidth:function(){var b=ig.system.context;b.save();
b.font=this.font;b.textAlign="left";var c=b.measureText(this.text);b.restore();return c.width}})});ig.baked=!0;
ig.module("game.toybox.utils.random").defines(function(){ig.random={chance:function(b){return Math.random()<b},bool:function(){return 0.5>Math.random()},"int":function(b,c){return b+Math.floor((c-b+1)*Math.random())},"float":function(b,c){return b+(c-b)*Math.random()},string:function(b,c){void 0===c&&(c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789");for(var e="",d=0;d<b;d++)e+=c.charAt(Random.int(0,c.length-1));return e},fromArray:function(b){return null!=b&&0<b.length?b[this.int(0,
b.length-1)]:null},shuffle:function(b){if(null!=b)for(var c=0;c<b.length;c++){var e=this.int(0,b.length-1),d=b[c];b[c]=b[e];b[e]=d}return b}}});ig.baked=!0;
ig.module("game.toybox.utils.signal").requires("impact.impact").defines(function(){ig.Signal=ig.Class.extend({signalListeners:null,id:0,init:function(){this.id=++ig.Signal._lastId;this.signalListeners=[]},addOnce:function(b,c){this.signalListeners.push({signalListener:b,signalContext:c,isOnce:!0})},add:function(b,c){this.signalListeners.push({signalListener:b,signalContext:c,isOnce:!1})},dispatch:function(){for(var b=0;b<this.signalListeners.length;){var c=this.signalListeners[b];c.signalListener.apply(c.signalContext,
arguments);c.isOnce?this.signalListeners.splice(b,1):b++}}});ig.Signal._lastId=0});ig.baked=!0;
ig.module("game.toybox.utils.toybox-touch").requires("impact.impact").defines(function(){ig.ToyboxTouch={hasInitialized:!1,touches:[],mouseX:0,mouseY:0,init:function(){ig.ua.touchDevice&&(window.navigator.msPointerEnabled&&(ig.system.canvas.addEventListener("MSPointerDown",this.touchDown.bind(this),!1),ig.system.canvas.addEventListener("MSPointerUp",this.touchUp.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",this.touchMove.bind(this),!1),ig.system.canvas.style.msContentZooming="none",
ig.system.canvas.style.msTouchAction="none"),ig.system.canvas.addEventListener("touchstart",this.touchDown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.touchUp.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.touchMove.bind(this),!1));ig.system.canvas.addEventListener("mousemove",this.mouseMove.bind(this),!1);this.hasInitialized=!0},mouseMove:function(b){var c=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth,e=parseInt(ig.system.canvas.offsetHeight)||
ig.system.realHeight;this.scaleX=ig.system.scale*(c/ig.system.realWidth);this.scaleY=ig.system.scale*(e/ig.system.realHeight);c={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(c=ig.system.canvas.getBoundingClientRect());this.mouseX=(b.clientX-c.left)/this.scaleX;this.mouseY=(b.clientY-c.top)/this.scaleY},touchDown:function(b){this.processTouch(b.touches)},touchUp:function(b){this.processTouch(b.touches)},touchMove:function(b){this.processTouch(b.touches)},processTouch:function(b){var c=parseInt(ig.system.canvas.offsetWidth)||
ig.system.realWidth,e=parseInt(ig.system.canvas.offsetHeight)||ig.system.realHeight;this.scaleX=ig.system.scale*(c/ig.system.realWidth);this.scaleY=ig.system.scale*(e/ig.system.realHeight);c={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(c=ig.system.canvas.getBoundingClientRect());this.touches=[];for(e=0;e<b.length;e++){var d=b[e];this.touches.push({x:(d.clientX-c.left)/this.scaleX,y:(d.clientY-c.top)/this.scaleY})}}}});ig.baked=!0;
ig.module("game.toybox.babylon.alt-babylon").defines(function(){ig.altBabylon={onSceneLoaded:null,onUpdate:null,scene:null,engine:null,canvas:null,canvasId:null,loadScene:function(b,c,e){this.scene&&this.scene.dispose();this.scene=null;this.onSceneLoaded=new ig.Signal;this.onUpdate=new ig.Signal;BABYLON.Engine.isSupported()&&(this.engine||(e?this.canvasId=e:this.canvasId||(this.canvasId="webgl"),this.canvas=ig.$(e),this.engine=new BABYLON.Engine(this.canvas,!0),this.runEngineLoop()),BABYLON.SceneLoader.ShowLoadingScreen=
!1,BABYLON.SceneLoader.Load(b,c,this.engine,this.onLoadSuccess.bind(this),null,this.onLoadError.bind(this)));return this},stopEngineLoop:function(){this.engine.stopRenderLoop()},runEngineLoop:function(){this.engine.runRenderLoop(ig.altBabylon.loop.bind(ig.altBabylon))},loop:function(){if(this.scene){if(this.onUpdate){var b=this.engine.getDeltaTime()/1E3;this.onUpdate.dispatch(b)}this.scene.render()}},onLoadSuccess:function(b){this.scene=b;this.onSceneLoaded.dispatch()},onLoadError:function(b,c,e){console.log("ERROR LOADING SCENE");
console.log(b);console.log(c);console.log(e)}}});ig.baked=!0;
ig.module("game.toybox.utils.uv-frame-animator").requires("impact.impact").defines(function(){ig.UVFrameAnimator=ig.Class.extend({texture:null,gridX:7,gridY:4,frameOffsetX:0,frameOffsetY:0.14,currentFrame:0,currentAnim:null,animations:[],init:function(b,c,e,d,g){this.texture=b;this.gridX=e;this.gridY=c;this.frameOffsetX=d;this.frameOffsetY=g;this.texture.uScale=1/this.gridX;this.texture.vScale=1/this.gridY;this.setFrame(0)},setFrame:function(b){if(0<=b){var c=this.gridX*this.gridY-1;b>c?(console.warn("Sprite frame index out of bound : ",
b),b=c):0>b&&(console.warn("Sprite frame index out of bound : ",b),b=0);this.currentFrame!=b&&(this.currentFrame=b,b=c-b,c=Math.floor(b/this.gridX),this.texture.uOffset=(this.gridX-b%this.gridX-1)*this.texture.uScale+this.texture.uScale*this.frameOffsetX,this.texture.vOffset=c*this.texture.vScale+this.texture.vScale*this.frameOffsetY)}else console.warn("Invalid frame index : ",b)},addAnimation:function(b,c,e,d){this.animations.push({name:b,frames:c,fps:e,loop:d,frameTime:0,frameIndex:0,frameTimeMax:1/
e,isFinished:!1})},playAnimation:function(b,c){if(!this.currentAnim||c||this.currentAnim.name!=b){for(var e=0;e<this.animations.length;e++)if(this.animations[e].name==b){this.playAnimationIndex(e);return}console.warn("Play animation failed, animation name not found  : ",b)}},playAnimationIndex:function(b){b>=this.animations.length||0>b?console.warn("Play animation failed, animation index out of found  : ",b):(this.currentAnim=this.animations[b],this.currentAnim.frameIndex=0,this.currentAnim.frameTime=
0,this.currentAnim.isFinished=!1)},update:function(b){this.currentAnim&&!this.currentAnim.isFinished&&(this.currentAnim.frameTime+=b,this.currentAnim.frameTime>=this.currentAnim.frameTimeMax&&(this.currentAnim.frameTime-=this.currentAnim.frameTimeMax,this.currentAnim.frameIndex++,this.currentAnim.frameIndex>=this.currentAnim.frames.length&&(this.currentAnim.loop?this.currentAnim.frameIndex=0:this.currentAnim.isFinished=!0)),this.currentAnim.isFinished||this.setFrame(this.currentAnim.frames[this.currentAnim.frameIndex]))}})});
ig.baked=!0;
ig.module("game.toybox.content").requires("impact.entity","game.toybox.utils.tween-patch","game.toybox.controllers.controller","game.toybox.objects.game-object","game.toybox.objects.ui.texts.text-field","game.toybox.objects.ui.texts.text-renderer","game.toybox.objects.ui.buttons.simple-button","game.toybox.utils.random","game.toybox.utils.signal","game.toybox.utils.toybox-touch","game.toybox.babylon.alt-babylon","game.toybox.utils.uv-frame-animator").defines(function(){setTimeout(function(){console.log("toybox 0.4.5");ig.ToyboxTouch.init()},
1E3);ig.drawRoundRect=function(b,c,e,d,g,f,m,l){"undefined"==typeof l&&(l=!0);"undefined"===typeof f&&(f=5);b.beginPath();b.moveTo(c+f,e);b.lineTo(c+d-f,e);b.quadraticCurveTo(c+d,e,c+d,e+f);b.lineTo(c+d,e+g-f);b.quadraticCurveTo(c+d,e+g,c+d-f,e+g);b.lineTo(c+f,e+g);b.quadraticCurveTo(c,e+g,c,e+g-f);b.lineTo(c,e+f);b.quadraticCurveTo(c,e,c+f,e);b.closePath();l&&b.stroke();m&&b.fill()};ig.hexToRgb=function(b){ig.hexToRgbTable||(ig.hexToRgbTable={});if(ig.hexToRgbTable[b])return ig.hexToRgbTable[b];
var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);if(c)return ig.hexToRgbTable[b]={r:parseInt(c[1],16),g:parseInt(c[2],16),b:parseInt(c[3],16),hex:b},ig.hexToRgbTable[b];console.log("cannot convert to rgb from hex :",b);return null};ig.utils={};ig.utils.normalize2=function(b,c,e){var d=Math.sqrt(b*b+c*c);return{x:e*b/d,y:e*c/d}};ig.utils.lerp=function(b,c,e){return(1-e)*b+e*c};ig.utils.lerpDt=function(b,c,e){return this.lerp(b,c,e*ig.system.tick)};ig.utils.lerpPerfectDt=function(b,c,e,d,g){g||
(g=0.01);if(Math.abs(b-c)<g)return c;e=1-Math.pow(e,d);return this.lerp(b,c,e)};ig.utils.setFaceDirection=function(b,c){b.rotationQuaternion||(b.rotationQuaternion=BABYLON.Quaternion.Identity());c.normalize();var e=BABYLON.Matrix.Identity(),d=BABYLON.Vector3.Up(),d=BABYLON.Vector3.Cross(c,d),g=BABYLON.Vector3.Cross(d,c);e.m[0]=d.x;e.m[1]=d.y;e.m[2]=d.z;e.m[4]=c.x;e.m[5]=c.y;e.m[6]=c.z;e.m[8]=g.x;e.m[9]=g.y;e.m[10]=g.z;BABYLON.Quaternion.FromRotationMatrixToRef(e,b.rotationQuaternion)};ig.utils.showAxis3d=
function(b){var c=wgl.game.currentScene,e=function(b,e,f){var m=new BABYLON.DynamicTexture("DynamicTexture",50,c,!0);m.hasAlpha=!0;m.drawText(b,5,40,"bold 36px Arial",e,"transparent",!0);b=new BABYLON.Mesh.CreatePlane("TextPlane",f,c,!0);b.material=new BABYLON.StandardMaterial("TextPlaneMaterial",c);b.material.backFaceCulling=!1;b.material.specularColor=new BABYLON.Color3(0,0,0);b.material.diffuseTexture=m;return b};BABYLON.Mesh.CreateLines("axisX",[new BABYLON.Vector3.Zero,new BABYLON.Vector3(b,
0,0),new BABYLON.Vector3(0.95*b,0.05*b,0),new BABYLON.Vector3(b,0,0),new BABYLON.Vector3(0.95*b,-0.05*b,0)],c).color=new BABYLON.Color3(1,0,0);e("X","red",b/10).position=new BABYLON.Vector3(0.9*b,-0.05*b,0);BABYLON.Mesh.CreateLines("axisY",[new BABYLON.Vector3.Zero,new BABYLON.Vector3(0,b,0),new BABYLON.Vector3(-0.05*b,0.95*b,0),new BABYLON.Vector3(0,b,0),new BABYLON.Vector3(0.05*b,0.95*b,0)],c).color=new BABYLON.Color3(0,1,0);e("Y","green",b/10).position=new BABYLON.Vector3(0,0.9*b,-0.05*b);BABYLON.Mesh.CreateLines("axisZ",
[new BABYLON.Vector3.Zero,new BABYLON.Vector3(0,0,b),new BABYLON.Vector3(0,-0.05*b,0.95*b),new BABYLON.Vector3(0,0,b),new BABYLON.Vector3(0,0.05*b,0.95*b)],c).color=new BABYLON.Color3(0,0,1);e("Z","blue",b/10).position=new BABYLON.Vector3(0,0.05*b,0.9*b)}});ig.baked=!0;
ig.module("plugins.fullscreen").requires("impact.entity","plugins.handlers.size-handler","plugins.director").defines(function(){ig.Fullscreen={enableFullscreenButton:!0,_isEnabled:"notChecked",isEnabled:function(){"notChecked"==this._isEnabled&&(this._isEnabled=document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled?!0:!1);return this._isEnabled},isFullscreen:function(){return ig.Fullscreen.isEnabled()&&(document.fullscreenElement||
document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)?!0:!1},toggleFullscreen:function(){ig.Fullscreen.isFullscreen()?ig.Fullscreen.exitFullscreen():ig.Fullscreen.requestFullscreen();ig.sizeHandler.orientationDelayHandler();if(ig&&ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(b){}},requestFullscreen:function(){var b=document.documentElement;b.requestFullscreen?b.requestFullscreen():b.webkitRequestFullscreen?
b.webkitRequestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.msRequestFullscreen?b.msRequestFullscreen():console.log("no request fullscreen method available")},exitFullscreen:function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():console.log("no exit fullscreen method available")},divs:{}};ig.Director.inject({loadLevel:function(b){var c=
ig.Fullscreen.divs,e;for(e in c)c=ig.domHandler.getElementById("#"+e),ig.domHandler.hide(c);return this.parent(b)}});ig.SizeHandler.inject({resize:function(){this.parent();var b=ig.Fullscreen.divs,c;for(c in b){var e=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y),d=ig.domHandler.getElementById("#"+c),g=b[c].entity_pos_x,f=b[c].entity_pos_y,m=b[c].width,l=b[c].height,j=ig.domHandler.getElementById("#canvas"),j=ig.domHandler.getOffsets(j);ig.domHandler.css(d,{"float":"left",
position:"absolute",left:Math.floor(j.left+g*e)+"px",top:Math.floor(j.top+f*e)+"px",width:Math.floor(m*e)+"px",height:Math.floor(l*e)+"px","z-index":3})}}});ig.FullscreenButton=ig.Entity.extend({enterImage:null,exitImage:null,isReady:!1,zIndex:999999,identifier:null,prevPos:{x:0,y:0},invisImagePath:"media/graphics/misc/invisible.png",init:function(b,c,e){this.parent(b,c,e);ig.Fullscreen.isEnabled()&&ig.Fullscreen.enableFullscreenButton?this.enterImage.loaded?this.initSize():this.enterImage.loadCallback=
function(){this.initSize()}.bind(this):this.kill()},kill:function(){this.parent()},destroy:function(){this.parent();console.log("destroy")},initSize:function(){this.size.x=this.enterImage.width;this.size.y=this.enterImage.height;this.createClickableLayer();this.isReady=!0},createClickableLayer:function(){this.identifier="fullscreen-button-layer";var b=ig.domHandler.getElementById("#"+this.identifier);b?(ig.domHandler.show(b),ig.domHandler.attr(b,"onclick","ig.Fullscreen.toggleFullscreen()")):this.createClickableOutboundLayer()},
update:function(b,c){this.parent();b=this.pos.x;c=this.pos.y;this.isReady&&!(this.prevPos.x==b&&this.prevPos.y==c)&&(this.prevPos.x=b,this.prevPos.y=c,ig.Fullscreen.divs[this.identifier]={},ig.Fullscreen.divs[this.identifier].width=this.size.x,ig.Fullscreen.divs[this.identifier].height=this.size.y,ig.Fullscreen.divs[this.identifier].entity_pos_x=this.pos.x,ig.Fullscreen.divs[this.identifier].entity_pos_y=this.pos.y,ig.sizeHandler.resize())},draw:function(){this.isReady&&(ig.Fullscreen.isFullscreen()?
this.exitImage.draw(this.pos.x,this.pos.y):this.enterImage.draw(this.pos.x,this.pos.y))},createClickableOutboundLayer:function(){var b=this.identifier,c=this.invisImagePath,e=ig.domHandler.create("div");ig.domHandler.attr(e,"id",b);ig.domHandler.attr(e,"onclick","ig.Fullscreen.toggleFullscreen()");var d=ig.domHandler.create("a"),g=ig.domHandler.create("img");ig.domHandler.css(g,{width:"100%",height:"100%"});ig.domHandler.attr(g,"src",c);c=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);
if(ig.ua.mobile){var f=ig.domHandler.getElementById("#canvas"),f=ig.domHandler.getOffsets(f),m=f.left,l=f.top;console.log(f.left);ig.sizeHandler.disableStretchToFitOnMobileFlag?(f=Math.floor(m+this.pos.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px",l=Math.floor(l+this.pos.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px",m=Math.floor(this.size.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px",c=Math.floor(this.size.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px"):(f=Math.floor(this.pos.x*ig.sizeHandler.sizeRatio.x)+
"px",l=Math.floor(this.pos.y*ig.sizeHandler.sizeRatio.y)+"px",m=Math.floor(this.size.x*ig.sizeHandler.sizeRatio.x)+"px",c=Math.floor(this.size.y*ig.sizeHandler.sizeRatio.y)+"px")}else f=ig.domHandler.getElementById("#canvas"),f=ig.domHandler.getOffsets(f),m=f.left,l=f.top,ig.sizeHandler.enableStretchToFitOnDesktopFlag?(f=Math.floor(m+this.pos.x*ig.sizeHandler.sizeRatio.x)+"px",l=Math.floor(l+this.pos.y*ig.sizeHandler.sizeRatio.y)+"px",m=Math.floor(this.size.x*ig.sizeHandler.sizeRatio.x)+"px",c=Math.floor(this.size.y*
ig.sizeHandler.sizeRatio.y)+"px"):(f=Math.floor(m+this.pos.x*c)+"px",l=Math.floor(l+this.pos.y*c)+"px",m=Math.floor(this.size.x*c)+"px",c=Math.floor(this.size.y*c)+"px");ig.domHandler.css(e,{"float":"left",position:"absolute",left:f,top:l,width:m,height:c,"z-index":3});ig.domHandler.addEvent(e,"mousemove",ig.input.mousemove.bind(ig.input),!1);ig.domHandler.appendChild(d,g);ig.domHandler.appendChild(e,d);ig.domHandler.appendToBody(e);ig.Fullscreen.divs[b]={};ig.Fullscreen.divs[b].width=this.size.x;
ig.Fullscreen.divs[b].height=this.size.y;ig.Fullscreen.divs[b].entity_pos_x=this.pos.x;ig.Fullscreen.divs[b].entity_pos_y=this.pos.y}})});ig.baked=!0;
ig.module("game.main").requires("impact.game","plugins.patches.timer-patch","plugins.patches.user-agent-patch","plugins.patches.webkit-image-smoothing-patch","plugins.patches.windowfocus-onMouseDown-patch","plugins.patches.input-patch","plugins.data.vector","plugins.data.color-rgb","plugins.font.font-loader","plugins.handlers.dom-handler","plugins.handlers.size-handler","plugins.handlers.api-handler","plugins.handlers.visibility-handler","plugins.audio.sound-handler","plugins.io.io-manager","plugins.io.storage-manager",
"plugins.splash-loader","plugins.tween","plugins.tweens-handler","plugins.url-parameters","plugins.director","plugins.impact-storage","plugins.responsive.responsive-plugin","plugins.linkit360-skill","plugins.branding.splash","plugins.datastructure.binary-heap","game.entities.branding-logo-placeholder","game.entities.buttons.button-more-games","game.entities.pointer","game.entities.pointer-selector","game.entities.select","game.levels.opening","game.levels.main-menu","game.levels.main-menu-settings",
"game.levels.game-over","game.levels.gameplay","game.levels.tutorial","game.scene3d.babylon-scene-controller","game.toybox.content","plugins.fullscreen").defines(function(){this.START_OBFUSCATION;this.FRAMEBREAKER;MyGame=ig.Game.extend({name:"MJS-Cool-Archer-HD",version:"1.0.0",frameworkVersion:"1.4.5",io:null,paused:!1,lastDraw:[],scorelist:null,score:0,sfxDefaultVolume:0.7,bgmDefaultVolume:1,init:function(){this.tweens=new ig.TweensHandler;this.io=new IoManager;this.setupUrlParams=new ig.UrlParameters;
this.removeLoadingWheel();this.setupStorageManager();try{ig.linkit360Skill.mergeSettings({validator_id:"cool-archer-hd-linkit360-skill",project_id:"marketjs-linkit360-skill"})}catch(b){}this.finalize()},initData:function(){return this.sessionData={sound:ig.game.sfxDefaultVolume,music:ig.game.bgmDefaultVolume,hasShownTutorial:!1,score:0}},finalize:function(){this.start();ig.sizeHandler.reorient()},removeLoadingWheel:function(){try{$("#ajaxbar").css("background","none")}catch(b){console.log(b)}},showDebugMenu:function(){console.log("showing debug menu ...");
ig.Entity._debugShowBoxes=!0;$(".ig_debug").show()},start:function(){this.resetPlayerStats();this.director=new ig.Director(this,[LevelOpening,LevelMainMenu,LevelGameplay,LevelMainMenuSettings,LevelGameOver,LevelTutorial]);if(_SETTINGS.Branding.Splash.Enabled)try{this.branding=new ig.BrandingSplash}catch(b){console.log(b),console.log("Loading original levels ..."),this.startGame()}else this.startGame();this.spawnEntity(EntityPointerSelector,50,50);ig.input.bind(ig.KEY.UP_ARROW,"jump");ig.input.bind(ig.KEY.LEFT_ARROW,
"left");ig.input.bind(ig.KEY.RIGHT_ARROW,"right");ig.input.bind(ig.KEY.W,"jump");ig.input.bind(ig.KEY.A,"left");ig.input.bind(ig.KEY.D,"right");ig.input.bind(ig.KEY.SPACE,"jump");ig.soundHandler.bgmPlayer.volume(ig.game.sessionData.music);ig.soundHandler.sfxPlayer.volume(ig.game.sessionData.sound)},startGame:function(){this.director.loadLevel(this.director.currentLevel)},goToLevel:function(b){this.director.loadLevel(this.getLevelID(b))},getLevelID:function(b){for(var c=0;c<this.director.levels.length;c++){var e=
this.director.levels[c];if(e.entities&&e.entities[0].type=="Entity"+b+"Controller")return c}console.error("Cannot find level named : "+b);return 0},fpsCount:function(){this.fpsTimer||(this.fpsTimer=new ig.Timer(1));this.fpsTimer&&0>this.fpsTimer.delta()?null!=this.fpsCounter?this.fpsCounter++:this.fpsCounter=0:(ig.game.fps=this.fpsCounter,this.fpsCounter=0,this.fpsTimer.reset())},endGame:function(){console.log("End game");ig.soundHandler.bgmPlayer.stop();ig.apiHandler.run("MJSEnd")},resetPlayerStats:function(){ig.log("resetting player stats ...");
this.playerStats={id:this.playerStats?this.playerStats.id:null}},splashClick:function(){var b=ig.domHandler.getElementById("#play");ig.domHandler.hide(b);ig.apiHandler.run("MJSFooter");ig.apiHandler.run("MJSHeader");ig.game.start()},pauseGame:function(){ig.system.stopRunLoop.call(ig.system);ig.game.tweens.onSystemPause();ig.babylonSceneController.paused=!0;console.log("Game Paused")},resumeGame:function(){ig.system.startRunLoop.call(ig.system);ig.game.tweens.onSystemResume();ig.babylonSceneController.paused=
!1;console.log("Game Resumed")},showOverlay:function(b){for(i=0;i<b.length;i++)$("#"+b[i])&&$("#"+b[i]).show(),document.getElementById(b[i])&&(document.getElementById(b[i]).style.visibility="visible")},hideOverlay:function(b){for(i=0;i<b.length;i++)$("#"+b[i])&&$("#"+b[i]).hide(),document.getElementById(b[i])&&(document.getElementById(b[i]).style.visibility="hidden")},currentBGMVolume:1,addition:0.1,update:function(){this.paused?(this.updateWhilePaused(),this.checkEntities()):(this.parent(),ig.ua.mobile&&
ig.soundHandler&&ig.soundHandler.forceLoopBGM());this.io.clear()},updateWhilePaused:function(){for(var b=0;b<this.entities.length;b++)this.entities[b].ignorePause&&this.entities[b].update()},draw:function(){this.parent();ig.debug&&this.drawFPS();for(var b=0;b<this.lastDraw.length;b++)this.lastDraw[b]()},dctf:function(){this.COPYRIGHT},drawFPS:function(){var b=Math.round(1E3/ig.debug.debugTickAvg);this.fillStrokeText("[ WEBGL "+ig.altBabylon.engine.webGLVersion+" ][ FPS C "+b+" ][ FPS B "+ig.altBabylon.engine.performanceMonitor.averageFPS.toFixed()+
" ]",5,953)},fillStrokeText:function(b,c,e){var d=ig.system.context,g=d.measureText(b).width+4;d.save();d.fillStyle="#333333";d.fillRect(c-3,e-11,g+4,16);d.fillStyle="#ffffff";d.fillText(b,c,e);d.restore()},clearCanvas:function(b,c,e){var d=b.canvas;b.clearRect(0,0,c,e);d.style.display="none";d.offsetHeight;d.style.display="inherit"},drawDebug:function(){if(!ig.global.wm&&(this.debugEnable(),this.viewDebug&&(ig.system.context.fillStyle="#000000",ig.system.context.globalAlpha=0.35,ig.system.context.fillRect(0,
0,ig.system.width/4,ig.system.height),ig.system.context.globalAlpha=1,this.debug&&0<this.debug.length)))for(i=0;i<this.debug.length;i++)ig.system.context.font="10px Arial",ig.system.context.fillStyle="#ffffff",ig.system.context.fillText(this.debugLine-this.debug.length+i+": "+this.debug[i],10,50+10*i)},debugCL:function(b){this.debug?(50>this.debug.length||this.debug.splice(0,1),this.debug.push(b),this.debugLine++):(this.debug=[],this.debugLine=1,this.debug.push(b));console.log(b)},debugEnable:function(){ig.input.pressed("click")&&
(this.debugEnableTimer=new ig.Timer(2));this.debugEnableTimer&&0>this.debugEnableTimer.delta()?ig.input.released("click")&&(this.debugEnableTimer=null):this.debugEnableTimer&&0<this.debugEnableTimer.delta()&&(this.debugEnableTimer=null,this.viewDebug=this.viewDebug?!1:!0)}});ig.babylonJSSupport=!0;ig.domHandler=null;ig.domHandler=new ig.DomHandler;ig.domHandler.forcedDeviceDetection();ig.domHandler.forcedDeviceRotation();ig.apiHandler=new ig.ApiHandler;ig.sizeHandler=new ig.SizeHandler(ig.domHandler);
ig.visibilityHandler=new ig.VisibilityHandler;ig.soundHandler=null;ig.soundHandler=new ig.SoundHandler;ig.fontInfo=null;ig.fontInfo=new ig.FontInfo;ig.altBabylon.loadScene("media/scenes/","game-scene.babylon","#webglcanvas").onSceneLoaded.addOnce(ig.babylonSceneController.init.bind(ig.babylonSceneController));ig.main("#canvas",MyGame,60,ig.sizeHandler.desktop.actualResolution.x,ig.sizeHandler.desktop.actualResolution.y,ig.sizeHandler.scale,ig.SplashLoader);ig.sizeHandler.reorient();this.DOMAINLOCK_BREAKOUT_ATTEMPT;
this.END_OBFUSCATION});
