!function(c,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=c.document?b(c,!0):function(c){if(!c.document)throw Error("jQuery requires a window with a document");return b(c)}:b(c)}("undefined"!=typeof window?window:this,function(c,b){function e(c,b){b=b||G;var f=b.createElement("script");f.text=c;b.head.appendChild(f).parentNode.removeChild(f)}function d(c){var b=!!c&&"length"in c&&c.length,f=q.type(c);return"function"!==f&&!q.isWindow(c)&&("array"===f||0===b||"number"==
typeof b&&0<b&&b-1 in c)}function j(c,b){return c.nodeName&&c.nodeName.toLowerCase()===b.toLowerCase()}function g(c,b,f){return q.isFunction(b)?q.grep(c,function(c,Z){return!!b.call(c,Z,c)!==f}):b.nodeType?q.grep(c,function(c){return c===b!==f}):"string"!=typeof b?q.grep(c,function(c){return-1<Va.call(b,c)!==f}):Gc.test(b)?q.filter(b,c,f):(b=q.filter(b,c),q.grep(c,function(c){return-1<Va.call(b,c)!==f&&1===c.nodeType}))}function p(c,b){for(;(c=c[b])&&1!==c.nodeType;);return c}function m(c){return c}
function f(c){throw c;}function n(c,b,f,d){var e;try{c&&q.isFunction(e=c.promise)?e.call(c).done(b).fail(f):c&&q.isFunction(e=c.then)?e.call(c,b,f):b.apply(void 0,[c].slice(d))}catch(l){f.apply(void 0,[l])}}function l(){G.removeEventListener("DOMContentLoaded",l);c.removeEventListener("load",l);q.ready()}function r(){this.expando=q.expando+r.uid++}function s(c,b,f){var d;if(void 0===f&&1===c.nodeType)if(d="data-"+b.replace(Hc,"-$&").toLowerCase(),f=c.getAttribute(d),"string"==typeof f){try{f="true"===
f||"false"!==f&&("null"===f?null:f===+f+""?+f:Ic.test(f)?JSON.parse(f):f)}catch(e){}ra.set(c,b,f)}else f=void 0;return f}function t(c,b,f,d){var e,l=1,g=20,n=d?function(){return d.cur()}:function(){return q.css(c,b,"")},j=n(),m=f&&f[3]||(q.cssNumber[b]?"":"px"),r=(q.cssNumber[b]||"px"!==m&&+j)&&kb.exec(q.css(c,b));if(r&&r[3]!==m){m=m||r[3];f=f||[];r=+j||1;do l=l||".5",r/=l,q.style(c,b,r+m);while(l!==(l=n()/j)&&1!==l&&--g)}return f&&(r=+r||+j||0,e=f[1]?r+(f[1]+1)*f[2]:+f[2],d&&(d.unit=m,d.start=r,
d.end=e)),e}function u(c,b){for(var f,d,e=[],l=0,g=c.length;l<g;l++)if(d=c[l],d.style)if(f=d.style.display,b){if("none"===f&&(e[l]=R.get(d,"display")||null,e[l]||(d.style.display="")),""===d.style.display&&sb(d)){f=e;var n=l,j,m=void 0;j=d.ownerDocument;var r=d.nodeName;j=(d=Wb[r])?d:(m=j.body.appendChild(j.createElement(r)),d=q.css(m,"display"),m.parentNode.removeChild(m),"none"===d&&(d="block"),Wb[r]=d,d);f[n]=j}}else"none"!==f&&(e[l]="none",R.set(d,"display",f));for(l=0;l<g;l++)null!=e[l]&&(c[l].style.display=
e[l]);return c}function v(c,b){var f;return f="undefined"!=typeof c.getElementsByTagName?c.getElementsByTagName(b||"*"):"undefined"!=typeof c.querySelectorAll?c.querySelectorAll(b||"*"):[],void 0===b||b&&j(c,b)?q.merge([c],f):f}function z(c,b){for(var f=0,d=c.length;f<d;f++)R.set(c[f],"globalEval",!b||R.get(b[f],"globalEval"))}function x(c,b,f,d,e){for(var l,g,n,j,m=b.createDocumentFragment(),r=[],s=0,p=c.length;s<p;s++)if(l=c[s],l||0===l)if("object"===q.type(l))q.merge(r,l.nodeType?[l]:l);else if(Jc.test(l)){g=
g||m.appendChild(b.createElement("div"));n=(Xb.exec(l)||["",""])[1].toLowerCase();n=ta[n]||ta._default;g.innerHTML=n[1]+q.htmlPrefilter(l)+n[2];for(n=n[0];n--;)g=g.lastChild;q.merge(r,g.childNodes);g=m.firstChild;g.textContent=""}else r.push(b.createTextNode(l));m.textContent="";for(s=0;l=r[s++];)if(d&&-1<q.inArray(l,d))e&&e.push(l);else if(j=q.contains(l.ownerDocument,l),g=v(m.appendChild(l),"script"),j&&z(g),f)for(n=0;l=g[n++];)Yb.test(l.type||"")&&f.push(l);return m}function B(){return!0}function A(){return!1}
function D(){try{return G.activeElement}catch(c){}}function H(c,b,f,d,e,l){var g,n;if("object"==typeof b){"string"!=typeof f&&(d=d||f,f=void 0);for(n in b)H(c,n,f,d,b[n],l);return c}if(null==d&&null==e?(e=f,d=f=void 0):null==e&&("string"==typeof f?(e=d,d=void 0):(e=d,d=f,f=void 0)),!1===e)e=A;else if(!e)return c;return 1===l&&(g=e,e=function(c){return q().off(c),g.apply(this,arguments)},e.guid=g.guid||(g.guid=q.guid++)),c.each(function(){q.event.add(this,b,e,d,f)})}function y(c,b){return j(c,"table")&&
j(11!==b.nodeType?b:b.firstChild,"tr")?q(">tbody",c)[0]||c:c}function C(c){return c.type=(null!==c.getAttribute("type"))+"/"+c.type,c}function I(c){var b=Kc.exec(c.type);return b?c.type=b[1]:c.removeAttribute("type"),c}function M(c,b){var f,d,e,l,g,n;if(1===b.nodeType){if(R.hasData(c)&&(f=R.access(c),d=R.set(b,f),n=f.events))for(e in delete d.handle,d.events={},n){f=0;for(d=n[e].length;f<d;f++)q.event.add(b,e,n[e][f])}ra.hasData(c)&&(l=ra.access(c),g=q.extend({},l),ra.set(b,g))}}function P(c,b,f,
d){b=Ia.apply([],b);var l,g,n,j,m=0,r=c.length,s=r-1,p=b[0],E=q.isFunction(p);if(E||1<r&&"string"==typeof p&&!ca.checkClone&&Lc.test(p))return c.each(function(e){var l=c.eq(e);E&&(b[0]=p.call(this,e,l.html()));P(l,b,f,d)});if(r&&(l=x(b,c[0].ownerDocument,!1,c,d),g=l.firstChild,1===l.childNodes.length&&(l=g),g||d)){g=q.map(v(l,"script"),C);for(n=g.length;m<r;m++)j=l,m!==s&&(j=q.clone(j,!0,!0),n&&q.merge(g,v(j,"script"))),f.call(c[m],j,m);if(n){l=g[g.length-1].ownerDocument;q.map(g,I);for(m=0;m<n;m++)j=
g[m],Yb.test(j.type||"")&&!R.access(j,"globalEval")&&q.contains(l,j)&&(j.src?q._evalUrl&&q._evalUrl(j.src):e(j.textContent.replace(Nc,""),l))}}return c}function N(c,b,f){for(var d=b?q.filter(b,c):c,e=0;null!=(b=d[e]);e++)f||1!==b.nodeType||q.cleanData(v(b)),b.parentNode&&(f&&q.contains(b.ownerDocument,b)&&z(v(b,"script")),b.parentNode.removeChild(b));return c}function K(c,b,f){var d,e,l,g,n=c.style;return f=f||tb(c),f&&(g=f.getPropertyValue(b)||f[b],""!==g||q.contains(c.ownerDocument,c)||(g=q.style(c,
b)),!ca.pixelMarginRight()&&Jb.test(g)&&Zb.test(b)&&(d=n.width,e=n.minWidth,l=n.maxWidth,n.minWidth=n.maxWidth=n.width=g,g=f.width,n.width=d,n.minWidth=e,n.maxWidth=l)),void 0!==g?g+"":g}function W(c,b){return{get:function(){return c()?void delete this.get:(this.get=b).apply(this,arguments)}}}function ea(c){var b=q.cssProps[c];if(!b){var b=q.cssProps,f;a:if(f=c,!(f in $b)){for(var d=f[0].toUpperCase()+f.slice(1),e=ac.length;e--;)if(f=ac[e]+d,f in $b)break a;f=void 0}b=b[c]=f||c}return b}function F(c,
b,f){return(c=kb.exec(b))?Math.max(0,c[2]-(f||0))+(c[3]||"px"):b}function J(c,b,f,d,e){var l=0;for(b=f===(d?"border":"content")?4:"width"===b?1:0;4>b;b+=2)"margin"===f&&(l+=q.css(c,f+Wa[b],!0,e)),d?("content"===f&&(l-=q.css(c,"padding"+Wa[b],!0,e)),"margin"!==f&&(l-=q.css(c,"border"+Wa[b]+"Width",!0,e))):(l+=q.css(c,"padding"+Wa[b],!0,e),"padding"!==f&&(l+=q.css(c,"border"+Wa[b]+"Width",!0,e)));return l}function ia(c,b,f){var d,e=tb(c),l=K(c,b,e),g="border-box"===q.css(c,"boxSizing",!1,e);return Jb.test(l)?
l:(d=g&&(ca.boxSizingReliable()||l===c.style[b]),"auto"===l&&(l=c["offset"+b[0].toUpperCase()+b.slice(1)]),l=parseFloat(l)||0,l+J(c,b,f||(g?"border":"content"),d,e)+"px")}function T(c,b,f,d,e){return new T.prototype.init(c,b,f,d,e)}function L(){ub&&(!1===G.hidden&&c.requestAnimationFrame?c.requestAnimationFrame(L):c.setTimeout(L,q.fx.interval),q.fx.tick())}function U(){return c.setTimeout(function(){bb=void 0}),bb=q.now()}function S(c,b){var f,d=0,e={height:c};for(b=b?1:0;4>d;d+=2-b)f=Wa[d],e["margin"+
f]=e["padding"+f]=c;return b&&(e.opacity=e.width=c),e}function aa(c,b,f){for(var d,e=(ba.tweeners[b]||[]).concat(ba.tweeners["*"]),l=0,g=e.length;l<g;l++)if(d=e[l].call(f,b,c))return d}function ba(c,b,f){var d,e,l=0,g=ba.prefilters.length,n=q.Deferred().always(function(){delete j.elem}),j=function(){if(e)return!1;for(var b=bb||U(),b=Math.max(0,m.startTime+m.duration-b),f=1-(b/m.duration||0),d=0,l=m.tweens.length;d<l;d++)m.tweens[d].run(f);return n.notifyWith(c,[m,f,b]),1>f&&l?b:(l||n.notifyWith(c,
[m,1,0]),n.resolveWith(c,[m]),!1)},m=n.promise({elem:c,props:q.extend({},b),opts:q.extend(!0,{specialEasing:{},easing:q.easing._default},f),originalProperties:b,originalOptions:f,startTime:bb||U(),duration:f.duration,tweens:[],createTween:function(b,f){var d=q.Tween(c,m.opts,b,f,m.opts.specialEasing[b]||m.opts.easing);return m.tweens.push(d),d},stop:function(b){var f=0,d=b?m.tweens.length:0;if(e)return this;for(e=!0;f<d;f++)m.tweens[f].run(1);return b?(n.notifyWith(c,[m,1,0]),n.resolveWith(c,[m,b])):
n.rejectWith(c,[m,b]),this}});b=m.props;f=m.opts.specialEasing;var r,s,p,E;for(d in b)if(r=q.camelCase(d),s=f[r],p=b[d],Array.isArray(p)&&(s=p[1],p=b[d]=p[0]),d!==r&&(b[r]=p,delete b[d]),E=q.cssHooks[r],E&&"expand"in E)for(d in p=E.expand(p),delete b[r],p)d in b||(b[d]=p[d],f[d]=s);else f[r]=s;for(;l<g;l++)if(d=ba.prefilters[l].call(m,c,b,m.opts))return q.isFunction(d.stop)&&(q._queueHooks(m.elem,m.opts.queue).stop=q.proxy(d.stop,d)),d;return q.map(b,aa,m),q.isFunction(m.opts.start)&&m.opts.start.call(c,
m),m.progress(m.opts.progress).done(m.opts.done,m.opts.complete).fail(m.opts.fail).always(m.opts.always),q.fx.timer(q.extend(j,{elem:c,anim:m,queue:m.opts.queue})),m}function la(c){return(c.match(ua)||[]).join(" ")}function qa(c){return c.getAttribute&&c.getAttribute("class")||""}function fa(c,b,f,d){var e;if(Array.isArray(b))q.each(b,function(b,e){f||Oc.test(c)?d(c,e):fa(c+"["+("object"==typeof e&&null!=e?b:"")+"]",e,f,d)});else if(f||"object"!==q.type(b))d(c,b);else for(e in b)fa(c+"["+e+"]",b[e],
f,d)}function oa(c){return function(b,f){"string"!=typeof b&&(f=b,b="*");var d,e=0,l=b.toLowerCase().match(ua)||[];if(q.isFunction(f))for(;d=l[e++];)"+"===d[0]?(d=d.slice(1)||"*",(c[d]=c[d]||[]).unshift(f)):(c[d]=c[d]||[]).push(f)}}function E(c,b,f,d){function e(n){var j;return l[n]=!0,q.each(c[n]||[],function(c,Z){var n=Z(b,f,d);return"string"!=typeof n||g||l[n]?g?!(j=n):void 0:(b.dataTypes.unshift(n),e(n),!1)}),j}var l={},g=c===Kb;return e(b.dataTypes[0])||!l["*"]&&e("*")}function V(c,b){var f,
d,e=q.ajaxSettings.flatOptions||{};for(f in b)void 0!==b[f]&&((e[f]?c:d||(d={}))[f]=b[f]);return d&&q.extend(!0,c,d),c}var ha=[],G=c.document,Xa=Object.getPrototypeOf,pa=ha.slice,Ia=ha.concat,Oa=ha.push,Va=ha.indexOf,cb={},vb=cb.toString,db=cb.hasOwnProperty,wb=db.toString,Lb=wb.call(Object),ca={},q=function(c,b){return new q.fn.init(c,b)},Mb=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Nb=/^-ms-/,Da=/-([a-z])/g,Ja=function(c,b){return b.toUpperCase()};q.fn=q.prototype={jquery:"3.2.1",constructor:q,length:0,
toArray:function(){return pa.call(this)},get:function(c){return null==c?pa.call(this):0>c?this[c+this.length]:this[c]},pushStack:function(c){c=q.merge(this.constructor(),c);return c.prevObject=this,c},each:function(c){return q.each(this,c)},map:function(c){return this.pushStack(q.map(this,function(b,f){return c.call(b,f,b)}))},slice:function(){return this.pushStack(pa.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(c){var b=this.length;c=
+c+(0>c?b:0);return this.pushStack(0<=c&&c<b?[this[c]]:[])},end:function(){return this.prevObject||this.constructor()},push:Oa,sort:ha.sort,splice:ha.splice};q.extend=q.fn.extend=function(){var c,b,f,d,e,l,g=arguments[0]||{},n=1,j=arguments.length,m=!1;"boolean"==typeof g&&(m=g,g=arguments[n]||{},n++);"object"==typeof g||q.isFunction(g)||(g={});for(n===j&&(g=this,n--);n<j;n++)if(null!=(c=arguments[n]))for(b in c)f=g[b],d=c[b],g!==d&&(m&&d&&(q.isPlainObject(d)||(e=Array.isArray(d)))?(e?(e=!1,l=f&&
Array.isArray(f)?f:[]):l=f&&q.isPlainObject(f)?f:{},g[b]=q.extend(m,l,d)):void 0!==d&&(g[b]=d));return g};q.extend({expando:"jQuery"+("3.2.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(c){throw Error(c);},noop:function(){},isFunction:function(c){return"function"===q.type(c)},isWindow:function(c){return null!=c&&c===c.window},isNumeric:function(c){var b=q.type(c);return("number"===b||"string"===b)&&!isNaN(c-parseFloat(c))},isPlainObject:function(c){var b,f;return!(!c||"[object Object]"!==
vb.call(c))&&(!(b=Xa(c))||(f=db.call(b,"constructor")&&b.constructor,"function"==typeof f&&wb.call(f)===Lb))},isEmptyObject:function(c){for(var b in c)return!1;return!0},type:function(c){return null==c?c+"":"object"==typeof c||"function"==typeof c?cb[vb.call(c)]||"object":typeof c},globalEval:function(c){e(c)},camelCase:function(c){return c.replace(Nb,"ms-").replace(Da,Ja)},each:function(c,b){var f,e=0;if(d(c))for(f=c.length;e<f&&!1!==b.call(c[e],e,c[e]);e++);else for(e in c)if(!1===b.call(c[e],e,
c[e]))break;return c},trim:function(c){return null==c?"":(c+"").replace(Mb,"")},makeArray:function(c,b){var f=b||[];return null!=c&&(d(Object(c))?q.merge(f,"string"==typeof c?[c]:c):Oa.call(f,c)),f},inArray:function(c,b,f){return null==b?-1:Va.call(b,c,f)},merge:function(c,b){for(var f=+b.length,d=0,e=c.length;d<f;d++)c[e++]=b[d];return c.length=e,c},grep:function(c,b,f){for(var d=[],e=0,l=c.length,g=!f;e<l;e++)f=!b(c[e],e),f!==g&&d.push(c[e]);return d},map:function(c,b,f){var e,l,g=0,n=[];if(d(c))for(e=
c.length;g<e;g++)l=b(c[g],g,f),null!=l&&n.push(l);else for(g in c)l=b(c[g],g,f),null!=l&&n.push(l);return Ia.apply([],n)},guid:1,proxy:function(c,b){var f,d,e;if("string"==typeof b&&(f=c[b],b=c,c=f),q.isFunction(c))return d=pa.call(arguments,2),e=function(){return c.apply(b||this,d.concat(pa.call(arguments)))},e.guid=c.guid=c.guid||q.guid++,e},now:Date.now,support:ca});"function"==typeof Symbol&&(q.fn[Symbol.iterator]=ha[Symbol.iterator]);q.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),
function(c,b){cb["[object "+b+"]"]=b.toLowerCase()});var va,lb=c,Y=function(c,b,f,d){var e,l,g,n,j,m=b&&b.ownerDocument,r=b?b.nodeType:9;if(f=f||[],"string"!=typeof c||!c||1!==r&&9!==r&&11!==r)return f;if(!d&&((b?b.ownerDocument||b:wa)!==X&&Pa(b),b=b||X,xa)){if(11!==r&&(n=Pc.exec(c)))if(e=n[1])if(9===r){if(!(l=b.getElementById(e)))return f;if(l.id===e)return f.push(l),f}else{if(m&&(l=m.getElementById(e))&&mb(b,l)&&l.id===e)return f.push(l),f}else{if(n[2])return Qa.apply(f,b.getElementsByTagName(c)),
f;if((e=n[3])&&ga.getElementsByClassName&&b.getElementsByClassName)return Qa.apply(f,b.getElementsByClassName(e)),f}if(ga.qsa&&!xb[c+" "]&&(!ma||!ma.test(c))){if(1!==r)m=b,j=c;else if("object"!==b.nodeName.toLowerCase()){(g=b.getAttribute("id"))?g=g.replace(bc,cc):b.setAttribute("id",g=da);l=nb(c);for(e=l.length;e--;)l[e]="#"+g+" "+za(l[e]);j=l.join(",");m=Ob.test(c)&&Ea(b.parentNode)||b}if(j)try{return Qa.apply(f,m.querySelectorAll(j)),f}catch(s){}finally{g===da&&b.removeAttribute("id")}}}return dc(c.replace(yb,
"$1"),b,f,d)},Ra=function(){function c(f,d){return b.push(f+" ")>Q.cacheLength&&delete c[b.shift()],c[f+" "]=d}var b=[];return c},ja=function(c){return c[da]=!0,c},sa=function(c){var b=X.createElement("fieldset");try{return!!c(b)}catch(f){return!1}finally{b.parentNode&&b.parentNode.removeChild(b)}},Sa=function(c,b){for(var f=c.split("|"),d=f.length;d--;)Q.attrHandle[f[d]]=b},Ka=function(c,b){var f=b&&c,d=f&&1===c.nodeType&&1===b.nodeType&&c.sourceIndex-b.sourceIndex;if(d)return d;if(f)for(;f=f.nextSibling;)if(f===
b)return-1;return c?1:-1},zb=function(c){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===c}},Ta=function(c){return function(b){var f=b.nodeName.toLowerCase();return("input"===f||"button"===f)&&b.type===c}},eb=function(c){return function(b){return"form"in b?b.parentNode&&!1===b.disabled?"label"in b?"label"in b.parentNode?b.parentNode.disabled===c:b.disabled===c:b.isDisabled===c||b.isDisabled!==!c&&Qc(b)===c:b.disabled===c:"label"in b&&b.disabled===c}},Fa=function(c){return ja(function(b){return b=
+b,ja(function(f,d){for(var e,l=c([],f.length,b),g=l.length;g--;)f[e=l[g]]&&(f[e]=!(d[e]=f[e]))})})},Ea=function(c){return c&&"undefined"!=typeof c.getElementsByTagName&&c},Ga=function(){},za=function(c){for(var b=0,f=c.length,d="";b<f;b++)d+=c[b].value;return d},Ya=function(c,b,f){var d=b.dir,e=b.next,l=e||d,g=f&&"parentNode"===l,n=Rc++;return b.first?function(b,f,e){for(;b=b[d];)if(1===b.nodeType||g)return c(b,f,e);return!1}:function(b,f,j){var m,r,O,s=[Ha,n];if(j)for(;b=b[d];){if((1===b.nodeType||
g)&&c(b,f,j))return!0}else for(;b=b[d];)if(1===b.nodeType||g)if(O=b[da]||(b[da]={}),r=O[b.uniqueID]||(O[b.uniqueID]={}),e&&e===b.nodeName.toLowerCase())b=b[d]||b;else{if((m=r[l])&&m[0]===Ha&&m[1]===n)return s[2]=m[2];if(r[l]=s,s[2]=c(b,f,j))return!0}return!1}},Aa=function(c){return 1<c.length?function(b,f,d){for(var e=c.length;e--;)if(!c[e](b,f,d))return!1;return!0}:c[0]},Ba=function(c,b,f,d,e){for(var l,g=[],n=0,j=c.length,m=null!=b;n<j;n++)(l=c[n])&&(f&&!f(l,d,e)||(g.push(l),m&&b.push(n)));return g},
na=function(c,b,f,d,e,l){return d&&!d[da]&&(d=na(d)),e&&!e[da]&&(e=na(e,l)),ja(function(l,g,n,j){var m,r,s=[],p=[],q=g.length,E;if(!(E=l)){E=b||"*";for(var t=n.nodeType?[n]:n,u=[],v=0,V=t.length;v<V;v++)Y(E,t[v],u);E=u}E=!c||!l&&b?E:Ba(E,s,c,n,j);t=f?e||(l?c:q||d)?[]:g:E;if(f&&f(E,t,n,j),d){m=Ba(t,p);d(m,[],n,j);for(n=m.length;n--;)(r=m[n])&&(t[p[n]]=!(E[p[n]]=r))}if(l){if(e||c){if(e){m=[];for(n=t.length;n--;)(r=t[n])&&m.push(E[n]=r);e(null,t=[],m,j)}for(n=t.length;n--;)(r=t[n])&&-1<(m=e?Za(l,r):
s[n])&&(l[m]=!(g[m]=r))}}else t=Ba(t===g?t.splice(q,t.length):t),e?e(null,g,t,j):Qa.apply(g,t)})},Pb=function(c){var b,f,d,e=c.length,l=Q.relative[c[0].type];f=l||Q.relative[" "];for(var g=l?1:0,n=Ya(function(c){return c===b},f,!0),j=Ya(function(c){return-1<Za(b,c)},f,!0),m=[function(c,f,d){c=!l&&(d||f!==fb)||((b=f).nodeType?n(c,f,d):j(c,f,d));return b=null,c}];g<e;g++)if(f=Q.relative[c[g].type])m=[Ya(Aa(m),f)];else{if(f=Q.filter[c[g].type].apply(null,c[g].matches),f[da]){for(d=++g;d<e&&!Q.relative[c[d].type];d++);
return na(1<g&&Aa(m),1<g&&za(c.slice(0,g-1).concat({value:" "===c[g-2].type?"*":""})).replace(yb,"$1"),f,g<d&&Pb(c.slice(g,d)),d<e&&Pb(c=c.slice(d)),d<e&&za(c))}m.push(f)}return Aa(m)},gb,ga,Q,Ab,ec,nb,Qb,dc,fb,Ua,hb,Pa,X,ya,xa,ma,$a,Bb,mb,da="sizzle"+1*new Date,wa=lb.document,Ha=0,Rc=0,fc=Ra(),gc=Ra(),xb=Ra(),Rb=function(c,b){return c===b&&(hb=!0),0},Sc={}.hasOwnProperty,ab=[],Tc=ab.pop,Uc=ab.push,Qa=ab.push,hc=ab.slice,Za=function(c,b){for(var f=0,d=c.length;f<d;f++)if(c[f]===b)return f;return-1},
Vc=/[\x20\t\r\n\f]+/g,yb=/^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g,Wc=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,Xc=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,Yc=/=[\x20\t\r\n\f]*([^\]'"]*?)[\x20\t\r\n\f]*\]/g,Zc=RegExp(":((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),
$c=/^(?:\\.|[\w-]|[^\x00-\xa0])+$/,Cb={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:/^((?:\\.|[\w-]|[^\x00-\xa0])+|[*])/,ATTR:RegExp("^\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\]"),PSEUDO:RegExp("^:((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),
CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)",
"i")},ad=/^(?:input|select|textarea|button)$/i,bd=/^h\d$/i,ob=/^[^{]+\{\s*\[native \w/,Pc=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Ob=/[+~]/,La=/\\([\da-f]{1,6}[\x20\t\r\n\f]?|([\x20\t\r\n\f])|.)/ig,Ma=function(c,b,f){c="0x"+b-65536;return c!==c||f?b:0>c?String.fromCharCode(c+65536):String.fromCharCode(c>>10|55296,1023&c|56320)},bc=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,cc=function(c,b){return b?"\x00"===c?"\ufffd":c.slice(0,-1)+"\\"+c.charCodeAt(c.length-1).toString(16)+" ":"\\"+c},ic=function(){Pa()},
Qc=Ya(function(c){return!0===c.disabled&&("form"in c||"label"in c)},{dir:"parentNode",next:"legend"});try{Qa.apply(ab=hc.call(wa.childNodes),wa.childNodes),ab[wa.childNodes.length].nodeType}catch(Ed){Qa={apply:ab.length?function(c,b){Uc.apply(c,hc.call(b))}:function(c,b){for(var f=c.length,d=0;c[f++]=b[d++];);c.length=f-1}}}ga=Y.support={};ec=Y.isXML=function(c){c=c&&(c.ownerDocument||c).documentElement;return!!c&&"HTML"!==c.nodeName};Pa=Y.setDocument=function(c){var b,f;c=c?c.ownerDocument||c:wa;
return c!==X&&9===c.nodeType&&c.documentElement?(X=c,ya=X.documentElement,xa=!ec(X),wa!==X&&(f=X.defaultView)&&f.top!==f&&(f.addEventListener?f.addEventListener("unload",ic,!1):f.attachEvent&&f.attachEvent("onunload",ic)),ga.attributes=sa(function(c){return c.className="i",!c.getAttribute("className")}),ga.getElementsByTagName=sa(function(c){return c.appendChild(X.createComment("")),!c.getElementsByTagName("*").length}),ga.getElementsByClassName=ob.test(X.getElementsByClassName),ga.getById=sa(function(c){return ya.appendChild(c).id=
da,!X.getElementsByName||!X.getElementsByName(da).length}),ga.getById?(Q.filter.ID=function(c){var b=c.replace(La,Ma);return function(c){return c.getAttribute("id")===b}},Q.find.ID=function(c,b){if("undefined"!=typeof b.getElementById&&xa){var f=b.getElementById(c);return f?[f]:[]}}):(Q.filter.ID=function(c){var b=c.replace(La,Ma);return function(c){return(c="undefined"!=typeof c.getAttributeNode&&c.getAttributeNode("id"))&&c.value===b}},Q.find.ID=function(c,b){if("undefined"!=typeof b.getElementById&&
xa){var f,d,e,l=b.getElementById(c);if(l){if(f=l.getAttributeNode("id"),f&&f.value===c)return[l];e=b.getElementsByName(c);for(d=0;l=e[d++];)if(f=l.getAttributeNode("id"),f&&f.value===c)return[l]}return[]}}),Q.find.TAG=ga.getElementsByTagName?function(c,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(c):ga.qsa?b.querySelectorAll(c):void 0}:function(c,b){var f,d=[],e=0,l=b.getElementsByTagName(c);if("*"===c){for(;f=l[e++];)1===f.nodeType&&d.push(f);return d}return l},Q.find.CLASS=
ga.getElementsByClassName&&function(c,b){if("undefined"!=typeof b.getElementsByClassName&&xa)return b.getElementsByClassName(c)},$a=[],ma=[],(ga.qsa=ob.test(X.querySelectorAll))&&(sa(function(c){ya.appendChild(c).innerHTML="<a id='"+da+"'></a><select id='"+da+"-\r\\' msallowcapture=''><option selected=''></option></select>";c.querySelectorAll("[msallowcapture^='']").length&&ma.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");c.querySelectorAll("[selected]").length||ma.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");
c.querySelectorAll("[id~="+da+"-]").length||ma.push("~=");c.querySelectorAll(":checked").length||ma.push(":checked");c.querySelectorAll("a#"+da+"+*").length||ma.push(".#.+[+~]")}),sa(function(c){c.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var b=X.createElement("input");b.setAttribute("type","hidden");c.appendChild(b).setAttribute("name","D");c.querySelectorAll("[name=d]").length&&ma.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?=");2!==c.querySelectorAll(":enabled").length&&
ma.push(":enabled",":disabled");ya.appendChild(c).disabled=!0;2!==c.querySelectorAll(":disabled").length&&ma.push(":enabled",":disabled");c.querySelectorAll("*,:x");ma.push(",.*:")})),(ga.matchesSelector=ob.test(Bb=ya.matches||ya.webkitMatchesSelector||ya.mozMatchesSelector||ya.oMatchesSelector||ya.msMatchesSelector))&&sa(function(c){ga.disconnectedMatch=Bb.call(c,"*");Bb.call(c,"[s!='']:x");$a.push("!=",":((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)")}),
ma=ma.length&&RegExp(ma.join("|")),$a=$a.length&&RegExp($a.join("|")),b=ob.test(ya.compareDocumentPosition),mb=b||ob.test(ya.contains)?function(c,b){var f=9===c.nodeType?c.documentElement:c,d=b&&b.parentNode;return c===d||!(!d||1!==d.nodeType||!(f.contains?f.contains(d):c.compareDocumentPosition&&16&c.compareDocumentPosition(d)))}:function(c,b){if(b)for(;b=b.parentNode;)if(b===c)return!0;return!1},Rb=b?function(c,b){if(c===b)return hb=!0,0;var f=!c.compareDocumentPosition-!b.compareDocumentPosition;
return f?f:(f=(c.ownerDocument||c)===(b.ownerDocument||b)?c.compareDocumentPosition(b):1,1&f||!ga.sortDetached&&b.compareDocumentPosition(c)===f?c===X||c.ownerDocument===wa&&mb(wa,c)?-1:b===X||b.ownerDocument===wa&&mb(wa,b)?1:Ua?Za(Ua,c)-Za(Ua,b):0:4&f?-1:1)}:function(c,b){if(c===b)return hb=!0,0;var f,d=0;f=c.parentNode;var e=b.parentNode,l=[c],Z=[b];if(!f||!e)return c===X?-1:b===X?1:f?-1:e?1:Ua?Za(Ua,c)-Za(Ua,b):0;if(f===e)return Ka(c,b);for(f=c;f=f.parentNode;)l.unshift(f);for(f=b;f=f.parentNode;)Z.unshift(f);
for(;l[d]===Z[d];)d++;return d?Ka(l[d],Z[d]):l[d]===wa?-1:Z[d]===wa?1:0},X):X};Y.matches=function(c,b){return Y(c,null,null,b)};Y.matchesSelector=function(c,b){if((c.ownerDocument||c)!==X&&Pa(c),b=b.replace(Yc,"='$1']"),ga.matchesSelector&&xa&&!xb[b+" "]&&(!$a||!$a.test(b))&&(!ma||!ma.test(b)))try{var f=Bb.call(c,b);if(f||ga.disconnectedMatch||c.document&&11!==c.document.nodeType)return f}catch(d){}return 0<Y(b,X,null,[c]).length};Y.contains=function(c,b){return(c.ownerDocument||c)!==X&&Pa(c),mb(c,
b)};Y.attr=function(c,b){(c.ownerDocument||c)!==X&&Pa(c);var f=Q.attrHandle[b.toLowerCase()],f=f&&Sc.call(Q.attrHandle,b.toLowerCase())?f(c,b,!xa):void 0;return void 0!==f?f:ga.attributes||!xa?c.getAttribute(b):(f=c.getAttributeNode(b))&&f.specified?f.value:null};Y.escape=function(c){return(c+"").replace(bc,cc)};Y.error=function(c){throw Error("Syntax error, unrecognized expression: "+c);};Y.uniqueSort=function(c){var b,f=[],d=0,e=0;if(hb=!ga.detectDuplicates,Ua=!ga.sortStable&&c.slice(0),c.sort(Rb),
hb){for(;b=c[e++];)b===c[e]&&(d=f.push(e));for(;d--;)c.splice(f[d],1)}return Ua=null,c};Ab=Y.getText=function(c){var b,f="",d=0;if(b=c.nodeType)if(1===b||9===b||11===b){if("string"==typeof c.textContent)return c.textContent;for(c=c.firstChild;c;c=c.nextSibling)f+=Ab(c)}else{if(3===b||4===b)return c.nodeValue}else for(;b=c[d++];)f+=Ab(b);return f};Q=Y.selectors={cacheLength:50,createPseudo:ja,match:Cb,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",
first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(c){return c[1]=c[1].replace(La,Ma),c[3]=(c[3]||c[4]||c[5]||"").replace(La,Ma),"~="===c[2]&&(c[3]=" "+c[3]+" "),c.slice(0,4)},CHILD:function(c){return c[1]=c[1].toLowerCase(),"nth"===c[1].slice(0,3)?(c[3]||Y.error(c[0]),c[4]=+(c[4]?c[5]+(c[6]||1):2*("even"===c[3]||"odd"===c[3])),c[5]=+(c[7]+c[8]||"odd"===c[3])):c[3]&&Y.error(c[0]),c},PSEUDO:function(c){var b,f=!c[6]&&c[2];return Cb.CHILD.test(c[0])?null:(c[3]?c[2]=c[4]||c[5]||"":f&&Zc.test(f)&&
(b=nb(f,!0))&&(b=f.indexOf(")",f.length-b)-f.length)&&(c[0]=c[0].slice(0,b),c[2]=f.slice(0,b)),c.slice(0,3))}},filter:{TAG:function(c){var b=c.replace(La,Ma).toLowerCase();return"*"===c?function(){return!0}:function(c){return c.nodeName&&c.nodeName.toLowerCase()===b}},CLASS:function(c){var b=fc[c+" "];return b||(b=RegExp("(^|[\\x20\\t\\r\\n\\f])"+c+"([\\x20\\t\\r\\n\\f]|$)"))&&fc(c,function(c){return b.test("string"==typeof c.className&&c.className||"undefined"!=typeof c.getAttribute&&c.getAttribute("class")||
"")})},ATTR:function(c,b,f){return function(d){d=Y.attr(d,c);return null==d?"!="===b:!b||(d+="","="===b?d===f:"!="===b?d!==f:"^="===b?f&&0===d.indexOf(f):"*="===b?f&&-1<d.indexOf(f):"$="===b?f&&d.slice(-f.length)===f:"~="===b?-1<(" "+d.replace(Vc," ")+" ").indexOf(f):"|="===b&&(d===f||d.slice(0,f.length+1)===f+"-"))}},CHILD:function(c,b,f,d,e){var l="nth"!==c.slice(0,3),g="last"!==c.slice(-4),n="of-type"===b;return 1===d&&0===e?function(c){return!!c.parentNode}:function(b,f,j){var m,r,s,O,p,q;f=l!==
g?"nextSibling":"previousSibling";var E=b.parentNode,t=n&&b.nodeName.toLowerCase();j=!j&&!n;var ka=!1;if(E){if(l){for(;f;){for(O=b;O=O[f];)if(n?O.nodeName.toLowerCase()===t:1===O.nodeType)return!1;q=f="only"===c&&!q&&"nextSibling"}return!0}if(q=[g?E.firstChild:E.lastChild],g&&j){O=E;s=O[da]||(O[da]={});r=s[O.uniqueID]||(s[O.uniqueID]={});m=r[c]||[];ka=(p=m[0]===Ha&&m[1])&&m[2];for(O=p&&E.childNodes[p];O=++p&&O&&O[f]||(ka=p=0)||q.pop();)if(1===O.nodeType&&++ka&&O===b){r[c]=[Ha,p,ka];break}}else if(j&&
(O=b,s=O[da]||(O[da]={}),r=s[O.uniqueID]||(s[O.uniqueID]={}),m=r[c]||[],p=m[0]===Ha&&m[1],ka=p),!1===ka)for(;(O=++p&&O&&O[f]||(ka=p=0)||q.pop())&&(!(n?O.nodeName.toLowerCase()===t:1===O.nodeType)||!++ka||!(j&&(s=O[da]||(O[da]={}),r=s[O.uniqueID]||(s[O.uniqueID]={}),r[c]=[Ha,ka]),O===b)););return ka-=e,ka===d||0===ka%d&&0<=ka/d}}},PSEUDO:function(c,b){var f,d=Q.pseudos[c]||Q.setFilters[c.toLowerCase()]||Y.error("unsupported pseudo: "+c);return d[da]?d(b):1<d.length?(f=[c,c,"",b],Q.setFilters.hasOwnProperty(c.toLowerCase())?
ja(function(c,f){for(var e,l=d(c,b),g=l.length;g--;)e=Za(c,l[g]),c[e]=!(f[e]=l[g])}):function(c){return d(c,0,f)}):d}},pseudos:{not:ja(function(c){var b=[],f=[],d=Qb(c.replace(yb,"$1"));return d[da]?ja(function(c,b,f,e){var l;f=d(c,null,e,[]);for(e=c.length;e--;)(l=f[e])&&(c[e]=!(b[e]=l))}):function(c,e,l){return b[0]=c,d(b,null,l,f),b[0]=null,!f.pop()}}),has:ja(function(c){return function(b){return 0<Y(c,b).length}}),contains:ja(function(c){return c=c.replace(La,Ma),function(b){return-1<(b.textContent||
b.innerText||Ab(b)).indexOf(c)}}),lang:ja(function(c){return $c.test(c||"")||Y.error("unsupported lang: "+c),c=c.replace(La,Ma).toLowerCase(),function(b){var f;do if(f=xa?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return f=f.toLowerCase(),f===c||0===f.indexOf(c+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(c){var b=lb.location&&lb.location.hash;return b&&b.slice(1)===c.id},root:function(c){return c===ya},focus:function(c){return c===X.activeElement&&(!X.hasFocus||
X.hasFocus())&&!(!c.type&&!c.href&&!~c.tabIndex)},enabled:eb(!1),disabled:eb(!0),checked:function(c){var b=c.nodeName.toLowerCase();return"input"===b&&!!c.checked||"option"===b&&!!c.selected},selected:function(c){return c.parentNode&&c.parentNode.selectedIndex,!0===c.selected},empty:function(c){for(c=c.firstChild;c;c=c.nextSibling)if(6>c.nodeType)return!1;return!0},parent:function(c){return!Q.pseudos.empty(c)},header:function(c){return bd.test(c.nodeName)},input:function(c){return ad.test(c.nodeName)},
button:function(c){var b=c.nodeName.toLowerCase();return"input"===b&&"button"===c.type||"button"===b},text:function(c){var b;return"input"===c.nodeName.toLowerCase()&&"text"===c.type&&(null==(b=c.getAttribute("type"))||"text"===b.toLowerCase())},first:Fa(function(){return[0]}),last:Fa(function(c,b){return[b-1]}),eq:Fa(function(c,b,f){return[0>f?f+b:f]}),even:Fa(function(c,b){for(var f=0;f<b;f+=2)c.push(f);return c}),odd:Fa(function(c,b){for(var f=1;f<b;f+=2)c.push(f);return c}),lt:Fa(function(c,b,
f){for(b=0>f?f+b:f;0<=--b;)c.push(b);return c}),gt:Fa(function(c,b,f){for(f=0>f?f+b:f;++f<b;)c.push(f);return c})}};Q.pseudos.nth=Q.pseudos.eq;for(gb in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Q.pseudos[gb]=zb(gb);for(gb in{submit:!0,reset:!0})Q.pseudos[gb]=Ta(gb);Ga.prototype=Q.filters=Q.pseudos;Q.setFilters=new Ga;nb=Y.tokenize=function(c,b){var f,d,e,l,g,n,j;if(g=gc[c+" "])return b?0:g.slice(0);g=c;n=[];for(j=Q.preFilter;g;){f&&!(d=Wc.exec(g))||(d&&(g=g.slice(d[0].length)||g),n.push(e=
[]));f=!1;(d=Xc.exec(g))&&(f=d.shift(),e.push({value:f,type:d[0].replace(yb," ")}),g=g.slice(f.length));for(l in Q.filter)!(d=Cb[l].exec(g))||j[l]&&!(d=j[l](d))||(f=d.shift(),e.push({value:f,type:l,matches:d}),g=g.slice(f.length));if(!f)break}return b?g.length:g?Y.error(c):gc(c,n).slice(0)};va=(Qb=Y.compile=function(c,b){var f,d=[],e=[],l=xb[c+" "];if(!l){b||(b=nb(c));for(f=b.length;f--;)l=Pb(b[f]),l[da]?d.push(l):e.push(l);f=xb;var g=0<d.length,n=0<e.length,l=function(c,b,f,l,j){var Z,m,r,s=0,O=
"0",p=c&&[],q=[],E=fb,t=c||n&&Q.find.TAG("*",j),ka=Ha+=null==E?1:Math.random()||0.1,u=t.length;for(j&&(fb=b===X||b||j);O!==u&&null!=(Z=t[O]);O++){if(n&&Z){m=0;for(b||Z.ownerDocument===X||(Pa(Z),f=!xa);r=e[m++];)if(r(Z,b||X,f)){l.push(Z);break}j&&(Ha=ka)}g&&((Z=!r&&Z)&&s--,c&&p.push(Z))}if(s+=O,g&&O!==s){for(m=0;r=d[m++];)r(p,q,b,f);if(c){if(0<s)for(;O--;)p[O]||q[O]||(q[O]=Tc.call(l));q=Ba(q)}Qa.apply(l,q);j&&!c&&0<q.length&&1<s+d.length&&Y.uniqueSort(l)}return j&&(Ha=ka,fb=E),p},l=g?ja(l):l,l=f(c,
l);l.selector=c}return l},dc=Y.select=function(c,b,f,d){var e,l,g,n,j,m="function"==typeof c&&c,r=!d&&nb(c=m.selector||c);if(f=f||[],1===r.length){if(l=r[0]=r[0].slice(0),2<l.length&&"ID"===(g=l[0]).type&&9===b.nodeType&&xa&&Q.relative[l[1].type]){if(b=(Q.find.ID(g.matches[0].replace(La,Ma),b)||[])[0],!b)return f;m&&(b=b.parentNode);c=c.slice(l.shift().value.length)}for(e=Cb.needsContext.test(c)?0:l.length;e--&&!(g=l[e],Q.relative[n=g.type]);)if((j=Q.find[n])&&(d=j(g.matches[0].replace(La,Ma),Ob.test(l[0].type)&&
Ea(b.parentNode)||b))){if(l.splice(e,1),c=d.length&&za(l),!c)return Qa.apply(f,d),f;break}}return(m||Qb(c,r))(d,b,!xa,f,!b||Ob.test(c)&&Ea(b.parentNode)||b),f},ga.sortStable=da.split("").sort(Rb).join("")===da,ga.detectDuplicates=!!hb,Pa(),ga.sortDetached=sa(function(c){return 1&c.compareDocumentPosition(X.createElement("fieldset"))}),sa(function(c){return c.innerHTML="<a href='#'></a>","#"===c.firstChild.getAttribute("href")})||Sa("type|href|height|width",function(c,b,f){if(!f)return c.getAttribute(b,
"type"===b.toLowerCase()?1:2)}),ga.attributes&&sa(function(c){return c.innerHTML="<input/>",c.firstChild.setAttribute("value",""),""===c.firstChild.getAttribute("value")})||Sa("value",function(c,b,f){if(!f&&"input"===c.nodeName.toLowerCase())return c.defaultValue}),sa(function(c){return null==c.getAttribute("disabled")})||Sa("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(c,b,f){var d;if(!f)return!0===c[b]?b.toLowerCase():
(d=c.getAttributeNode(b))&&d.specified?d.value:null}),Y);q.find=va;q.expr=va.selectors;q.expr[":"]=q.expr.pseudos;q.uniqueSort=q.unique=va.uniqueSort;q.text=va.getText;q.isXMLDoc=va.isXML;q.contains=va.contains;q.escapeSelector=va.escape;var ib=function(c,b,f){for(var d=[],e=void 0!==f;(c=c[b])&&9!==c.nodeType;)if(1===c.nodeType){if(e&&q(c).is(f))break;d.push(c)}return d},jc=function(c,b){for(var f=[];c;c=c.nextSibling)1===c.nodeType&&c!==b&&f.push(c);return f},kc=q.expr.match.needsContext,lc=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,
Gc=/^.[^:#\[\.,]*$/;q.filter=function(c,b,f){var d=b[0];return f&&(c=":not("+c+")"),1===b.length&&1===d.nodeType?q.find.matchesSelector(d,c)?[d]:[]:q.find.matches(c,q.grep(b,function(c){return 1===c.nodeType}))};q.fn.extend({find:function(c){var b,f,d=this.length,e=this;if("string"!=typeof c)return this.pushStack(q(c).filter(function(){for(b=0;b<d;b++)if(q.contains(e[b],this))return!0}));f=this.pushStack([]);for(b=0;b<d;b++)q.find(c,e[b],f);return 1<d?q.uniqueSort(f):f},filter:function(c){return this.pushStack(g(this,
c||[],!1))},not:function(c){return this.pushStack(g(this,c||[],!0))},is:function(c){return!!g(this,"string"==typeof c&&kc.test(c)?q(c):c||[],!1).length}});var mc,cd=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(q.fn.init=function(c,b,f){var d,e;if(!c)return this;if(f=f||mc,"string"==typeof c){if(d="<"===c[0]&&">"===c[c.length-1]&&3<=c.length?[null,c,null]:cd.exec(c),!d||!d[1]&&b)return!b||b.jquery?(b||f).find(c):this.constructor(b).find(c);if(d[1]){if(b=b instanceof q?b[0]:b,q.merge(this,q.parseHTML(d[1],
b&&b.nodeType?b.ownerDocument||b:G,!0)),lc.test(d[1])&&q.isPlainObject(b))for(d in b)q.isFunction(this[d])?this[d](b[d]):this.attr(d,b[d]);return this}return e=G.getElementById(d[2]),e&&(this[0]=e,this.length=1),this}return c.nodeType?(this[0]=c,this.length=1,this):q.isFunction(c)?void 0!==f.ready?f.ready(c):c(q):q.makeArray(c,this)}).prototype=q.fn;mc=q(G);var dd=/^(?:parents|prev(?:Until|All))/,ed={children:!0,contents:!0,next:!0,prev:!0};q.fn.extend({has:function(c){var b=q(c,this),f=b.length;
return this.filter(function(){for(var c=0;c<f;c++)if(q.contains(this,b[c]))return!0})},closest:function(c,b){var f,d=0,e=this.length,l=[],g="string"!=typeof c&&q(c);if(!kc.test(c))for(;d<e;d++)for(f=this[d];f&&f!==b;f=f.parentNode)if(11>f.nodeType&&(g?-1<g.index(f):1===f.nodeType&&q.find.matchesSelector(f,c))){l.push(f);break}return this.pushStack(1<l.length?q.uniqueSort(l):l)},index:function(c){return c?"string"==typeof c?Va.call(q(c),this[0]):Va.call(this,c.jquery?c[0]:c):this[0]&&this[0].parentNode?
this.first().prevAll().length:-1},add:function(c,b){return this.pushStack(q.uniqueSort(q.merge(this.get(),q(c,b))))},addBack:function(c){return this.add(null==c?this.prevObject:this.prevObject.filter(c))}});q.each({parent:function(c){return(c=c.parentNode)&&11!==c.nodeType?c:null},parents:function(c){return ib(c,"parentNode")},parentsUntil:function(c,b,f){return ib(c,"parentNode",f)},next:function(c){return p(c,"nextSibling")},prev:function(c){return p(c,"previousSibling")},nextAll:function(c){return ib(c,
"nextSibling")},prevAll:function(c){return ib(c,"previousSibling")},nextUntil:function(c,b,f){return ib(c,"nextSibling",f)},prevUntil:function(c,b,f){return ib(c,"previousSibling",f)},siblings:function(c){return jc((c.parentNode||{}).firstChild,c)},children:function(c){return jc(c.firstChild)},contents:function(c){return j(c,"iframe")?c.contentDocument:(j(c,"template")&&(c=c.content||c),q.merge([],c.childNodes))}},function(c,b){q.fn[c]=function(f,d){var e=q.map(this,b,f);return"Until"!==c.slice(-5)&&
(d=f),d&&"string"==typeof d&&(e=q.filter(d,e)),1<this.length&&(ed[c]||q.uniqueSort(e),dd.test(c)&&e.reverse()),this.pushStack(e)}});var ua=/[^\x20\t\r\n\f]+/g;q.Callbacks=function(c){var b;if("string"==typeof c){var f={};b=(q.each(c.match(ua)||[],function(c,b){f[b]=!0}),f)}else b=q.extend({},c);c=b;var d,e,l,g,n=[],j=[],m=-1,r=function(){g=g||c.once;for(l=d=!0;j.length;m=-1)for(e=j.shift();++m<n.length;)!1===n[m].apply(e[0],e[1])&&c.stopOnFalse&&(m=n.length,e=!1);c.memory||(e=!1);d=!1;g&&(n=e?[]:
"")},s={add:function(){return n&&(e&&!d&&(m=n.length-1,j.push(e)),function Mc(b){q.each(b,function(b,f){q.isFunction(f)?c.unique&&s.has(f)||n.push(f):f&&f.length&&"string"!==q.type(f)&&Mc(f)})}(arguments),e&&!d&&r()),this},remove:function(){return q.each(arguments,function(c,b){for(var f;-1<(f=q.inArray(b,n,f));)n.splice(f,1),f<=m&&m--}),this},has:function(c){return c?-1<q.inArray(c,n):0<n.length},empty:function(){return n&&(n=[]),this},disable:function(){return g=j=[],n=e="",this},disabled:function(){return!n},
lock:function(){return g=j=[],e||d||(n=e=""),this},locked:function(){return!!g},fireWith:function(c,b){return g||(b=b||[],b=[c,b.slice?b.slice():b],j.push(b),d||r()),this},fire:function(){return s.fireWith(this,arguments),this},fired:function(){return!!l}};return s};q.extend({Deferred:function(b){var d=[["notify","progress",q.Callbacks("memory"),q.Callbacks("memory"),2],["resolve","done",q.Callbacks("once memory"),q.Callbacks("once memory"),0,"resolved"],["reject","fail",q.Callbacks("once memory"),
q.Callbacks("once memory"),1,"rejected"]],e="pending",l={state:function(){return e},always:function(){return g.done(arguments).fail(arguments),this},"catch":function(c){return l.then(null,c)},pipe:function(){var c=arguments;return q.Deferred(function(b){q.each(d,function(f,d){var e=q.isFunction(c[d[4]])&&c[d[4]];g[d[1]](function(){var c=e&&e.apply(this,arguments);c&&q.isFunction(c.promise)?c.promise().progress(b.notify).done(b.resolve).fail(b.reject):b[d[0]+"With"](this,e?[c]:arguments)})});c=null}).promise()},
then:function(b,e,l){function g(b,d,e,l){return function(){var j=this,r=arguments,Z=function(){var c,Z;if(!(b<n)){if(c=e.apply(j,r),c===d.promise())throw new TypeError("Thenable self-resolution");Z=c&&("object"==typeof c||"function"==typeof c)&&c.then;q.isFunction(Z)?l?Z.call(c,g(n,d,m,l),g(n,d,f,l)):(n++,Z.call(c,g(n,d,m,l),g(n,d,f,l),g(n,d,m,d.notifyWith))):(e!==m&&(j=void 0,r=[c]),(l||d.resolveWith)(j,r))}},s=l?Z:function(){try{Z()}catch(c){q.Deferred.exceptionHook&&q.Deferred.exceptionHook(c,
s.stackTrace),b+1>=n&&(e!==f&&(j=void 0,r=[c]),d.rejectWith(j,r))}};b?s():(q.Deferred.getStackHook&&(s.stackTrace=q.Deferred.getStackHook()),c.setTimeout(s))}}var n=0;return q.Deferred(function(c){d[0][3].add(g(0,c,q.isFunction(l)?l:m,c.notifyWith));d[1][3].add(g(0,c,q.isFunction(b)?b:m));d[2][3].add(g(0,c,q.isFunction(e)?e:f))}).promise()},promise:function(c){return null!=c?q.extend(c,l):l}},g={};return q.each(d,function(c,b){var f=b[2],n=b[5];l[b[1]]=f.add;n&&f.add(function(){e=n},d[3-c][2].disable,
d[0][2].lock);f.add(b[3].fire);g[b[0]]=function(){return g[b[0]+"With"](this===g?void 0:this,arguments),this};g[b[0]+"With"]=f.fireWith}),l.promise(g),b&&b.call(g,g),g},when:function(c){var b=arguments.length,f=b,d=Array(f),e=pa.call(arguments),l=q.Deferred(),g=function(c){return function(f){d[c]=this;e[c]=1<arguments.length?pa.call(arguments):f;--b||l.resolveWith(d,e)}};if(1>=b&&(n(c,l.done(g(f)).resolve,l.reject,!b),"pending"===l.state()||q.isFunction(e[f]&&e[f].then)))return l.then();for(;f--;)n(e[f],
g(f),l.reject);return l.promise()}});var fd=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;q.Deferred.exceptionHook=function(b,f){c.console&&c.console.warn&&b&&fd.test(b.name)&&c.console.warn("jQuery.Deferred exception: "+b.message,b.stack,f)};q.readyException=function(b){c.setTimeout(function(){throw b;})};var Sb=q.Deferred();q.fn.ready=function(c){return Sb.then(c)["catch"](function(c){q.readyException(c)}),this};q.extend({isReady:!1,readyWait:1,ready:function(c){(!0===c?--q.readyWait:
q.isReady)||(q.isReady=!0,!0!==c&&0<--q.readyWait||Sb.resolveWith(G,[q]))}});q.ready.then=Sb.then;"complete"===G.readyState||"loading"!==G.readyState&&!G.documentElement.doScroll?c.setTimeout(q.ready):(G.addEventListener("DOMContentLoaded",l),c.addEventListener("load",l));var Na=function(c,b,f,d,e,l,g){var n=0,j=c.length,m=null==f;if("object"===q.type(f))for(n in e=!0,f)Na(c,b,n,f[n],!0,l,g);else if(void 0!==d&&(e=!0,q.isFunction(d)||(g=!0),m&&(g?(b.call(c,d),b=null):(m=b,b=function(c,b,f){return m.call(q(c),
f)})),b))for(;n<j;n++)b(c[n],f,g?d:d.call(c[n],n,b(c[n],f)));return e?c:m?b.call(c):j?b(c[0],f):l},Db=function(c){return 1===c.nodeType||9===c.nodeType||!+c.nodeType};r.uid=1;r.prototype={cache:function(c){var b=c[this.expando];return b||(b={},Db(c)&&(c.nodeType?c[this.expando]=b:Object.defineProperty(c,this.expando,{value:b,configurable:!0}))),b},set:function(c,b,f){var d;c=this.cache(c);if("string"==typeof b)c[q.camelCase(b)]=f;else for(d in b)c[q.camelCase(d)]=b[d];return c},get:function(c,b){return void 0===
b?this.cache(c):c[this.expando]&&c[this.expando][q.camelCase(b)]},access:function(c,b,f){return void 0===b||b&&"string"==typeof b&&void 0===f?this.get(c,b):(this.set(c,b,f),void 0!==f?f:b)},remove:function(c,b){var f,d=c[this.expando];if(void 0!==d){if(void 0!==b){Array.isArray(b)?b=b.map(q.camelCase):(b=q.camelCase(b),b=b in d?[b]:b.match(ua)||[]);for(f=b.length;f--;)delete d[b[f]]}(void 0===b||q.isEmptyObject(d))&&(c.nodeType?c[this.expando]=void 0:delete c[this.expando])}},hasData:function(c){c=
c[this.expando];return void 0!==c&&!q.isEmptyObject(c)}};var R=new r,ra=new r,Ic=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Hc=/[A-Z]/g;q.extend({hasData:function(c){return ra.hasData(c)||R.hasData(c)},data:function(c,b,f){return ra.access(c,b,f)},removeData:function(c,b){ra.remove(c,b)},_data:function(c,b,f){return R.access(c,b,f)},_removeData:function(c,b){R.remove(c,b)}});q.fn.extend({data:function(c,b){var f,d,e,l=this[0],g=l&&l.attributes;if(void 0===c){if(this.length&&(e=ra.get(l),1===l.nodeType&&!R.get(l,
"hasDataAttrs"))){for(f=g.length;f--;)g[f]&&(d=g[f].name,0===d.indexOf("data-")&&(d=q.camelCase(d.slice(5)),s(l,d,e[d])));R.set(l,"hasDataAttrs",!0)}return e}return"object"==typeof c?this.each(function(){ra.set(this,c)}):Na(this,function(b){var f;if(l&&void 0===b){if((f=ra.get(l,c),void 0!==f)||(f=s(l,c),void 0!==f))return f}else this.each(function(){ra.set(this,c,b)})},null,b,1<arguments.length,null,!0)},removeData:function(c){return this.each(function(){ra.remove(this,c)})}});q.extend({queue:function(c,
b,f){var d;if(c)return b=(b||"fx")+"queue",d=R.get(c,b),f&&(!d||Array.isArray(f)?d=R.access(c,b,q.makeArray(f)):d.push(f)),d||[]},dequeue:function(c,b){b=b||"fx";var f=q.queue(c,b),d=f.length,e=f.shift(),l=q._queueHooks(c,b),g=function(){q.dequeue(c,b)};"inprogress"===e&&(e=f.shift(),d--);e&&("fx"===b&&f.unshift("inprogress"),delete l.stop,e.call(c,g,l));!d&&l&&l.empty.fire()},_queueHooks:function(c,b){var f=b+"queueHooks";return R.get(c,f)||R.access(c,f,{empty:q.Callbacks("once memory").add(function(){R.remove(c,
[b+"queue",f])})})}});q.fn.extend({queue:function(c,b){var f=2;return"string"!=typeof c&&(b=c,c="fx",f--),arguments.length<f?q.queue(this[0],c):void 0===b?this:this.each(function(){var f=q.queue(this,c,b);q._queueHooks(this,c);"fx"===c&&"inprogress"!==f[0]&&q.dequeue(this,c)})},dequeue:function(c){return this.each(function(){q.dequeue(this,c)})},clearQueue:function(c){return this.queue(c||"fx",[])},promise:function(c,b){var f,d=1,e=q.Deferred(),l=this,g=this.length,n=function(){--d||e.resolveWith(l,
[l])};"string"!=typeof c&&(b=c,c=void 0);for(c=c||"fx";g--;)(f=R.get(l[g],c+"queueHooks"))&&f.empty&&(d++,f.empty.add(n));return n(),e.promise(b)}});var nc=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,kb=RegExp("^(?:([+-])=|)("+nc+")([a-z%]*)$","i"),Wa=["Top","Right","Bottom","Left"],sb=function(c,b){return c=b||c,"none"===c.style.display||""===c.style.display&&q.contains(c.ownerDocument,c)&&"none"===q.css(c,"display")},oc=function(c,b,f,d){var e,l={};for(e in b)l[e]=c.style[e],c.style[e]=b[e];f=
f.apply(c,d||[]);for(e in b)c.style[e]=l[e];return f},Wb={};q.fn.extend({show:function(){return u(this,!0)},hide:function(){return u(this)},toggle:function(c){return"boolean"==typeof c?c?this.show():this.hide():this.each(function(){sb(this)?q(this).show():q(this).hide()})}});var pc=/^(?:checkbox|radio)$/i,Xb=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Yb=/^$|\/(?:java|ecma)script/i,ta={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],
tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ta.optgroup=ta.option;ta.tbody=ta.tfoot=ta.colgroup=ta.caption=ta.thead;ta.th=ta.td;var Jc=/<|&#?\w+;/,Eb=G.createDocumentFragment().appendChild(G.createElement("div")),Fb=G.createElement("input");Fb.setAttribute("type","radio");Fb.setAttribute("checked","checked");Fb.setAttribute("name","t");Eb.appendChild(Fb);ca.checkClone=Eb.cloneNode(!0).cloneNode(!0).lastChild.checked;Eb.innerHTML=
"<textarea>x</textarea>";ca.noCloneChecked=!!Eb.cloneNode(!0).lastChild.defaultValue;!0;var Gb=G.documentElement,gd=/^key/,hd=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,qc=/^([^.]*)(?:\.(.+)|)/;q.event={global:{},add:function(c,b,f,d,e){var l,g,n,j,m,r,s,p,E,t;if(m=R.get(c)){f.handler&&(l=f,f=l.handler,e=l.selector);e&&q.find.matchesSelector(Gb,e);f.guid||(f.guid=q.guid++);(j=m.events)||(j=m.events={});(g=m.handle)||(g=m.handle=function(b){return"undefined"!=typeof q&&q.event.triggered!==b.type?
q.event.dispatch.apply(c,arguments):void 0});b=(b||"").match(ua)||[""];for(m=b.length;m--;)n=qc.exec(b[m])||[],E=t=n[1],n=(n[2]||"").split(".").sort(),E&&(s=q.event.special[E]||{},E=(e?s.delegateType:s.bindType)||E,s=q.event.special[E]||{},r=q.extend({type:E,origType:t,data:d,handler:f,guid:f.guid,selector:e,needsContext:e&&q.expr.match.needsContext.test(e),namespace:n.join(".")},l),(p=j[E])||(p=j[E]=[],p.delegateCount=0,s.setup&&!1!==s.setup.call(c,d,n,g)||c.addEventListener&&c.addEventListener(E,
g)),s.add&&(s.add.call(c,r),r.handler.guid||(r.handler.guid=f.guid)),e?p.splice(p.delegateCount++,0,r):p.push(r),q.event.global[E]=!0)}},remove:function(c,b,f,d,e){var l,g,n,j,m,r,s,p,E,t,u,v=R.hasData(c)&&R.get(c);if(v&&(j=v.events)){b=(b||"").match(ua)||[""];for(m=b.length;m--;)if(n=qc.exec(b[m])||[],E=u=n[1],t=(n[2]||"").split(".").sort(),E){s=q.event.special[E]||{};E=(d?s.delegateType:s.bindType)||E;p=j[E]||[];n=n[2]&&RegExp("(^|\\.)"+t.join("\\.(?:.*\\.|)")+"(\\.|$)");for(g=l=p.length;l--;)r=
p[l],!e&&u!==r.origType||f&&f.guid!==r.guid||n&&!n.test(r.namespace)||d&&d!==r.selector&&("**"!==d||!r.selector)||(p.splice(l,1),r.selector&&p.delegateCount--,s.remove&&s.remove.call(c,r));g&&!p.length&&(s.teardown&&!1!==s.teardown.call(c,t,v.handle)||q.removeEvent(c,E,v.handle),delete j[E])}else for(E in j)q.event.remove(c,E+b[m],f,d,!0);q.isEmptyObject(j)&&R.remove(c,"handle events")}},dispatch:function(c){var b=q.event.fix(c),f,d,e,l,g,n,j=Array(arguments.length);d=(R.get(this,"events")||{})[b.type]||
[];var m=q.event.special[b.type]||{};j[0]=b;for(f=1;f<arguments.length;f++)j[f]=arguments[f];if(b.delegateTarget=this,!m.preDispatch||!1!==m.preDispatch.call(this,b)){n=q.event.handlers.call(this,b,d);for(f=0;(l=n[f++])&&!b.isPropagationStopped();){b.currentTarget=l.elem;for(d=0;(g=l.handlers[d++])&&!b.isImmediatePropagationStopped();)b.rnamespace&&!b.rnamespace.test(g.namespace)||(b.handleObj=g,b.data=g.data,e=((q.event.special[g.origType]||{}).handle||g.handler).apply(l.elem,j),void 0!==e&&!1===
(b.result=e)&&(b.preventDefault(),b.stopPropagation()))}return m.postDispatch&&m.postDispatch.call(this,b),b.result}},handlers:function(c,b){var f,d,e,l,g,n=[],j=b.delegateCount,m=c.target;if(j&&m.nodeType&&!("click"===c.type&&1<=c.button))for(;m!==this;m=m.parentNode||this)if(1===m.nodeType&&("click"!==c.type||!0!==m.disabled)){l=[];g={};for(f=0;f<j;f++)d=b[f],e=d.selector+" ",void 0===g[e]&&(g[e]=d.needsContext?-1<q(e,this).index(m):q.find(e,this,null,[m]).length),g[e]&&l.push(d);l.length&&n.push({elem:m,
handlers:l})}return m=this,j<b.length&&n.push({elem:m,handlers:b.slice(j)}),n},addProp:function(c,b){Object.defineProperty(q.Event.prototype,c,{enumerable:!0,configurable:!0,get:q.isFunction(b)?function(){if(this.originalEvent)return b(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[c]},set:function(b){Object.defineProperty(this,c,{enumerable:!0,configurable:!0,writable:!0,value:b})}})},fix:function(c){return c[q.expando]?c:new q.Event(c)},special:{load:{noBubble:!0},
focus:{trigger:function(){if(this!==D()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===D()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&j(this,"input"))return this.click(),!1},_default:function(c){return j(c.target,"a")}},beforeunload:{postDispatch:function(c){void 0!==c.result&&c.originalEvent&&(c.originalEvent.returnValue=c.result)}}}};q.removeEvent=function(c,b,f){c.removeEventListener&&
c.removeEventListener(b,f)};q.Event=function(c,b){return this instanceof q.Event?(c&&c.type?(this.originalEvent=c,this.type=c.type,this.isDefaultPrevented=c.defaultPrevented||void 0===c.defaultPrevented&&!1===c.returnValue?B:A,this.target=c.target&&3===c.target.nodeType?c.target.parentNode:c.target,this.currentTarget=c.currentTarget,this.relatedTarget=c.relatedTarget):this.type=c,b&&q.extend(this,b),this.timeStamp=c&&c.timeStamp||q.now(),void(this[q.expando]=!0)):new q.Event(c,b)};q.Event.prototype=
{constructor:q.Event,isDefaultPrevented:A,isPropagationStopped:A,isImmediatePropagationStopped:A,isSimulated:!1,preventDefault:function(){var c=this.originalEvent;this.isDefaultPrevented=B;c&&!this.isSimulated&&c.preventDefault()},stopPropagation:function(){var c=this.originalEvent;this.isPropagationStopped=B;c&&!this.isSimulated&&c.stopPropagation()},stopImmediatePropagation:function(){var c=this.originalEvent;this.isImmediatePropagationStopped=B;c&&!this.isSimulated&&c.stopImmediatePropagation();
this.stopPropagation()}};q.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(c){var b=c.button;return null==c.which&&gd.test(c.type)?null!=c.charCode?c.charCode:c.keyCode:!c.which&&void 0!==b&&hd.test(c.type)?
1&b?1:2&b?3:4&b?2:0:c.which}},q.event.addProp);q.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(c,b){q.event.special[c]={delegateType:b,bindType:b,handle:function(c){var f,d=c.relatedTarget,e=c.handleObj;return d&&(d===this||q.contains(this,d))||(c.type=e.origType,f=e.handler.apply(this,arguments),c.type=b),f}}});q.fn.extend({on:function(c,b,f,d){return H(this,c,b,f,d)},one:function(c,b,f,d){return H(this,c,b,f,d,1)},off:function(c,
b,f){var d,e;if(c&&c.preventDefault&&c.handleObj)return d=c.handleObj,q(c.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof c){for(e in c)this.off(e,b,c[e]);return this}return!1!==b&&"function"!=typeof b||(f=b,b=void 0),!1===f&&(f=A),this.each(function(){q.event.remove(this,c,f,b)})}});var id=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,jd=/<script|<style|<link/i,Lc=/checked\s*(?:[^=]|=\s*.checked.)/i,
Kc=/^true\/(.*)/,Nc=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;q.extend({htmlPrefilter:function(c){return c.replace(id,"<$1></$2>")},clone:function(c,b,f){var d,e,l,g,n=c.cloneNode(!0),j=q.contains(c.ownerDocument,c);if(!ca.noCloneChecked&&!(1!==c.nodeType&&11!==c.nodeType||q.isXMLDoc(c))){g=v(n);l=v(c);d=0;for(e=l.length;d<e;d++){var m=l[d],r=g[d],s=r.nodeName.toLowerCase();"input"===s&&pc.test(m.type)?r.checked=m.checked:"input"!==s&&"textarea"!==s||(r.defaultValue=m.defaultValue)}}if(b)if(f){l=
l||v(c);g=g||v(n);d=0;for(e=l.length;d<e;d++)M(l[d],g[d])}else M(c,n);return g=v(n,"script"),0<g.length&&z(g,!j&&v(c,"script")),n},cleanData:function(c){for(var b,f,d,e=q.event.special,l=0;void 0!==(f=c[l]);l++)if(Db(f)){if(b=f[R.expando]){if(b.events)for(d in b.events)e[d]?q.event.remove(f,d):q.removeEvent(f,d,b.handle);f[R.expando]=void 0}f[ra.expando]&&(f[ra.expando]=void 0)}}});q.fn.extend({detach:function(c){return N(this,c,!0)},remove:function(c){return N(this,c)},text:function(c){return Na(this,
function(c){return void 0===c?q.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=c)})},null,c,arguments.length)},append:function(){return P(this,arguments,function(c){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&y(this,c).appendChild(c)})},prepend:function(){return P(this,arguments,function(c){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=y(this,c);b.insertBefore(c,b.firstChild)}})},before:function(){return P(this,
arguments,function(c){this.parentNode&&this.parentNode.insertBefore(c,this)})},after:function(){return P(this,arguments,function(c){this.parentNode&&this.parentNode.insertBefore(c,this.nextSibling)})},empty:function(){for(var c,b=0;null!=(c=this[b]);b++)1===c.nodeType&&(q.cleanData(v(c,!1)),c.textContent="");return this},clone:function(c,b){return c=null!=c&&c,b=null==b?c:b,this.map(function(){return q.clone(this,c,b)})},html:function(c){return Na(this,function(c){var b=this[0]||{},f=0,d=this.length;
if(void 0===c&&1===b.nodeType)return b.innerHTML;if("string"==typeof c&&!jd.test(c)&&!ta[(Xb.exec(c)||["",""])[1].toLowerCase()]){c=q.htmlPrefilter(c);try{for(;f<d;f++)b=this[f]||{},1===b.nodeType&&(q.cleanData(v(b,!1)),b.innerHTML=c);b=0}catch(e){}}b&&this.empty().append(c)},null,c,arguments.length)},replaceWith:function(){var c=[];return P(this,arguments,function(b){var f=this.parentNode;0>q.inArray(this,c)&&(q.cleanData(v(this)),f&&f.replaceChild(b,this))},c)}});q.each({appendTo:"append",prependTo:"prepend",
insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(c,b){q.fn[c]=function(c){for(var f=[],d=q(c),e=d.length-1,l=0;l<=e;l++)c=l===e?this:this.clone(!0),q(d[l])[b](c),Oa.apply(f,c.get());return this.pushStack(f)}});var Zb=/^margin/,Jb=RegExp("^("+nc+")(?!px)[a-z%]+$","i"),tb=function(b){var f=b.ownerDocument.defaultView;return f&&f.opener||(f=c),f.getComputedStyle(b)},Ib=function(){if(Ca){Ca.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%";
Ca.innerHTML="";Gb.appendChild(Hb);var b=c.getComputedStyle(Ca);rc="1%"!==b.top;sc="2px"===b.marginLeft;tc="4px"===b.width;Ca.style.marginRight="50%";uc="4px"===b.marginRight;Gb.removeChild(Hb);Ca=null}},rc,tc,uc,sc,Hb=G.createElement("div"),Ca=G.createElement("div");Ca.style&&(Ca.style.backgroundClip="content-box",Ca.cloneNode(!0).style.backgroundClip="",ca.clearCloneStyle="content-box"===Ca.style.backgroundClip,Hb.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",
Hb.appendChild(Ca),q.extend(ca,{pixelPosition:function(){return Ib(),rc},boxSizingReliable:function(){return Ib(),tc},pixelMarginRight:function(){return Ib(),uc},reliableMarginLeft:function(){return Ib(),sc}}));!0;var kd=/^(none|table(?!-c[ea]).+)/,vc=/^--/,ld={position:"absolute",visibility:"hidden",display:"block"},wc={letterSpacing:"0",fontWeight:"400"},ac=["Webkit","Moz","ms"],$b=G.createElement("div").style;q.extend({cssHooks:{opacity:{get:function(c,b){if(b){var f=K(c,"opacity");return""===
f?"1":f}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(c,b,f,d){if(c&&3!==c.nodeType&&8!==c.nodeType&&c.style){var e,l,g,n=q.camelCase(b),j=vc.test(b),m=c.style;return j||(b=ea(n)),g=q.cssHooks[b]||q.cssHooks[n],void 0===f?g&&"get"in g&&void 0!==(e=g.get(c,!1,d))?e:m[b]:(l=typeof f,"string"===l&&(e=kb.exec(f))&&e[1]&&
(f=t(c,b,e),l="number"),null!=f&&f===f&&("number"===l&&(f+=e&&e[3]||(q.cssNumber[n]?"":"px")),ca.clearCloneStyle||""!==f||0!==b.indexOf("background")||(m[b]="inherit"),g&&"set"in g&&void 0===(f=g.set(c,f,d))||(j?m.setProperty(b,f):m[b]=f)),void 0)}},css:function(c,b,f,d){var e,l,g,n=q.camelCase(b);return vc.test(b)||(b=ea(n)),g=q.cssHooks[b]||q.cssHooks[n],g&&"get"in g&&(e=g.get(c,!0,f)),void 0===e&&(e=K(c,b,d)),"normal"===e&&b in wc&&(e=wc[b]),""===f||f?(l=parseFloat(e),!0===f||isFinite(l)?l||0:
e):e}});q.each(["height","width"],function(c,b){q.cssHooks[b]={get:function(c,f,d){if(f)return!kd.test(q.css(c,"display"))||c.getClientRects().length&&c.getBoundingClientRect().width?ia(c,b,d):oc(c,ld,function(){return ia(c,b,d)})},set:function(c,f,d){var e,l=d&&tb(c);d=d&&J(c,b,d,"border-box"===q.css(c,"boxSizing",!1,l),l);return d&&(e=kb.exec(f))&&"px"!==(e[3]||"px")&&(c.style[b]=f,f=q.css(c,b)),F(c,f,d)}}});q.cssHooks.marginLeft=W(ca.reliableMarginLeft,function(c,b){if(b)return(parseFloat(K(c,
"marginLeft"))||c.getBoundingClientRect().left-oc(c,{marginLeft:0},function(){return c.getBoundingClientRect().left}))+"px"});q.each({margin:"",padding:"",border:"Width"},function(c,b){q.cssHooks[c+b]={expand:function(f){var d=0,e={};for(f="string"==typeof f?f.split(" "):[f];4>d;d++)e[c+Wa[d]+b]=f[d]||f[d-2]||f[0];return e}};Zb.test(c)||(q.cssHooks[c+b].set=F)});q.fn.extend({css:function(c,b){return Na(this,function(c,b,f){var d,e={},l=0;if(Array.isArray(b)){f=tb(c);for(d=b.length;l<d;l++)e[b[l]]=
q.css(c,b[l],!1,f);return e}return void 0!==f?q.style(c,b,f):q.css(c,b)},c,b,1<arguments.length)}});q.Tween=T;T.prototype={constructor:T,init:function(c,b,f,d,e,l){this.elem=c;this.prop=f;this.easing=e||q.easing._default;this.options=b;this.start=this.now=this.cur();this.end=d;this.unit=l||(q.cssNumber[f]?"":"px")},cur:function(){var c=T.propHooks[this.prop];return c&&c.get?c.get(this):T.propHooks._default.get(this)},run:function(c){var b,f=T.propHooks[this.prop];return this.options.duration?this.pos=
b=q.easing[this.easing](c,this.options.duration*c,0,1,this.options.duration):this.pos=b=c,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),f&&f.set?f.set(this):T.propHooks._default.set(this),this}};T.prototype.init.prototype=T.prototype;T.propHooks={_default:{get:function(c){var b;return 1!==c.elem.nodeType||null!=c.elem[c.prop]&&null==c.elem.style[c.prop]?c.elem[c.prop]:(b=q.css(c.elem,c.prop,""),b&&"auto"!==b?b:0)},set:function(c){q.fx.step[c.prop]?
q.fx.step[c.prop](c):1!==c.elem.nodeType||null==c.elem.style[q.cssProps[c.prop]]&&!q.cssHooks[c.prop]?c.elem[c.prop]=c.now:q.style(c.elem,c.prop,c.now+c.unit)}}};T.propHooks.scrollTop=T.propHooks.scrollLeft={set:function(c){c.elem.nodeType&&c.elem.parentNode&&(c.elem[c.prop]=c.now)}};q.easing={linear:function(c){return c},swing:function(c){return 0.5-Math.cos(c*Math.PI)/2},_default:"swing"};q.fx=T.prototype.init;q.fx.step={};var bb,ub,md=/^(?:toggle|show|hide)$/,nd=/queueHooks$/;q.Animation=q.extend(ba,
{tweeners:{"*":[function(c,b){var f=this.createTween(c,b);return t(f.elem,c,kb.exec(b),f),f}]},tweener:function(c,b){q.isFunction(c)?(b=c,c=["*"]):c=c.match(ua);for(var f,d=0,e=c.length;d<e;d++)f=c[d],ba.tweeners[f]=ba.tweeners[f]||[],ba.tweeners[f].unshift(b)},prefilters:[function(c,b,f){var d,e,l,g,n,j,m,r,s="width"in b||"height"in b,p=this,E={},t=c.style,v=c.nodeType&&sb(c),V=R.get(c,"fxshow");f.queue||(g=q._queueHooks(c,"fx"),null==g.unqueued&&(g.unqueued=0,n=g.empty.fire,g.empty.fire=function(){g.unqueued||
n()}),g.unqueued++,p.always(function(){p.always(function(){g.unqueued--;q.queue(c,"fx").length||g.empty.fire()})}));for(d in b)if(e=b[d],md.test(e)){if(delete b[d],l=l||"toggle"===e,e===(v?"hide":"show")){if("show"!==e||!V||void 0===V[d])continue;v=!0}E[d]=V&&V[d]||q.style(c,d)}if(j=!q.isEmptyObject(b),j||!q.isEmptyObject(E))for(d in s&&1===c.nodeType&&(f.overflow=[t.overflow,t.overflowX,t.overflowY],m=V&&V.display,null==m&&(m=R.get(c,"display")),r=q.css(c,"display"),"none"===r&&(m?r=m:(u([c],!0),
m=c.style.display||m,r=q.css(c,"display"),u([c]))),("inline"===r||"inline-block"===r&&null!=m)&&"none"===q.css(c,"float")&&(j||(p.done(function(){t.display=m}),null==m&&(r=t.display,m="none"===r?"":r)),t.display="inline-block")),f.overflow&&(t.overflow="hidden",p.always(function(){t.overflow=f.overflow[0];t.overflowX=f.overflow[1];t.overflowY=f.overflow[2]})),j=!1,E)j||(V?"hidden"in V&&(v=V.hidden):V=R.access(c,"fxshow",{display:m}),l&&(V.hidden=!v),v&&u([c],!0),p.done(function(){v||u([c]);R.remove(c,
"fxshow");for(d in E)q.style(c,d,E[d])})),j=aa(v?V[d]:0,d,p),d in V||(V[d]=j.start,v&&(j.end=j.start,j.start=0))}],prefilter:function(c,b){b?ba.prefilters.unshift(c):ba.prefilters.push(c)}});q.speed=function(c,b,f){var d=c&&"object"==typeof c?q.extend({},c):{complete:f||!f&&b||q.isFunction(c)&&c,duration:c,easing:f&&b||b&&!q.isFunction(b)&&b};return q.fx.off?d.duration=0:"number"!=typeof d.duration&&(d.duration in q.fx.speeds?d.duration=q.fx.speeds[d.duration]:d.duration=q.fx.speeds._default),null!=
d.queue&&!0!==d.queue||(d.queue="fx"),d.old=d.complete,d.complete=function(){q.isFunction(d.old)&&d.old.call(this);d.queue&&q.dequeue(this,d.queue)},d};q.fn.extend({fadeTo:function(c,b,f,d){return this.filter(sb).css("opacity",0).show().end().animate({opacity:b},c,f,d)},animate:function(c,b,f,d){var e=q.isEmptyObject(c),l=q.speed(b,f,d);b=function(){var b=ba(this,q.extend({},c),l);(e||R.get(this,"finish"))&&b.stop(!0)};return b.finish=b,e||!1===l.queue?this.each(b):this.queue(l.queue,b)},stop:function(c,
b,f){var d=function(c){var b=c.stop;delete c.stop;b(f)};return"string"!=typeof c&&(f=b,b=c,c=void 0),b&&!1!==c&&this.queue(c||"fx",[]),this.each(function(){var b=!0,e=null!=c&&c+"queueHooks",l=q.timers,g=R.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&nd.test(e)&&d(g[e]);for(e=l.length;e--;)l[e].elem!==this||null!=c&&l[e].queue!==c||(l[e].anim.stop(f),b=!1,l.splice(e,1));!b&&f||q.dequeue(this,c)})},finish:function(c){return!1!==c&&(c=c||"fx"),this.each(function(){var b,
f=R.get(this),d=f[c+"queue"];b=f[c+"queueHooks"];var e=q.timers,l=d?d.length:0;f.finish=!0;q.queue(this,c,[]);b&&b.stop&&b.stop.call(this,!0);for(b=e.length;b--;)e[b].elem===this&&e[b].queue===c&&(e[b].anim.stop(!0),e.splice(b,1));for(b=0;b<l;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete f.finish})}});q.each(["toggle","show","hide"],function(c,b){var f=q.fn[b];q.fn[b]=function(c,d,e){return null==c||"boolean"==typeof c?f.apply(this,arguments):this.animate(S(b,!0),c,d,e)}});q.each({slideDown:S("show"),
slideUp:S("hide"),slideToggle:S("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(c,b){q.fn[c]=function(c,f,d){return this.animate(b,c,f,d)}});q.timers=[];q.fx.tick=function(){var c,b=0,f=q.timers;for(bb=q.now();b<f.length;b++)c=f[b],c()||f[b]!==c||f.splice(b--,1);f.length||q.fx.stop();bb=void 0};q.fx.timer=function(c){q.timers.push(c);q.fx.start()};q.fx.interval=13;q.fx.start=function(){ub||(ub=!0,L())};q.fx.stop=function(){ub=null};q.fx.speeds={slow:600,
fast:200,_default:400};q.fn.delay=function(b,f){return b=q.fx?q.fx.speeds[b]||b:b,f=f||"fx",this.queue(f,function(f,d){var e=c.setTimeout(f,b);d.stop=function(){c.clearTimeout(e)}})};var jb=G.createElement("input"),od=G.createElement("select").appendChild(G.createElement("option"));jb.type="checkbox";ca.checkOn=""!==jb.value;ca.optSelected=od.selected;jb=G.createElement("input");jb.value="t";jb.type="radio";ca.radioValue="t"===jb.value;var xc,pb=q.expr.attrHandle;q.fn.extend({attr:function(c,b){return Na(this,
q.attr,c,b,1<arguments.length)},removeAttr:function(c){return this.each(function(){q.removeAttr(this,c)})}});q.extend({attr:function(c,b,f){var d,e,l=c.nodeType;if(3!==l&&8!==l&&2!==l)return"undefined"==typeof c.getAttribute?q.prop(c,b,f):(1===l&&q.isXMLDoc(c)||(e=q.attrHooks[b.toLowerCase()]||(q.expr.match.bool.test(b)?xc:void 0)),void 0!==f?null===f?void q.removeAttr(c,b):e&&"set"in e&&void 0!==(d=e.set(c,f,b))?d:(c.setAttribute(b,f+""),f):e&&"get"in e&&null!==(d=e.get(c,b))?d:(d=q.find.attr(c,
b),null==d?void 0:d))},attrHooks:{type:{set:function(c,b){if(!ca.radioValue&&"radio"===b&&j(c,"input")){var f=c.value;return c.setAttribute("type",b),f&&(c.value=f),b}}}},removeAttr:function(c,b){var f,d=0,e=b&&b.match(ua);if(e&&1===c.nodeType)for(;f=e[d++];)c.removeAttribute(f)}});xc={set:function(c,b,f){return!1===b?q.removeAttr(c,f):c.setAttribute(f,f),f}};q.each(q.expr.match.bool.source.match(/\w+/g),function(c,b){var f=pb[b]||q.find.attr;pb[b]=function(c,b,d){var e,l,g=b.toLowerCase();return d||
(l=pb[g],pb[g]=e,e=null!=f(c,b,d)?g:null,pb[g]=l),e}});var pd=/^(?:input|select|textarea|button)$/i,qd=/^(?:a|area)$/i;q.fn.extend({prop:function(c,b){return Na(this,q.prop,c,b,1<arguments.length)},removeProp:function(c){return this.each(function(){delete this[q.propFix[c]||c]})}});q.extend({prop:function(c,b,f){var d,e,l=c.nodeType;if(3!==l&&8!==l&&2!==l)return 1===l&&q.isXMLDoc(c)||(b=q.propFix[b]||b,e=q.propHooks[b]),void 0!==f?e&&"set"in e&&void 0!==(d=e.set(c,f,b))?d:c[b]=f:e&&"get"in e&&null!==
(d=e.get(c,b))?d:c[b]},propHooks:{tabIndex:{get:function(c){var b=q.find.attr(c,"tabindex");return b?parseInt(b,10):pd.test(c.nodeName)||qd.test(c.nodeName)&&c.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}});ca.optSelected||(q.propHooks.selected={get:function(c){c=c.parentNode;return c&&c.parentNode&&c.parentNode.selectedIndex,null},set:function(c){c=c.parentNode;c&&(c.selectedIndex,c.parentNode&&c.parentNode.selectedIndex)}});q.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),
function(){q.propFix[this.toLowerCase()]=this});q.fn.extend({addClass:function(c){var b,f,d,e,l,g,n=0;if(q.isFunction(c))return this.each(function(b){q(this).addClass(c.call(this,b,qa(this)))});if("string"==typeof c&&c)for(b=c.match(ua)||[];f=this[n++];)if(e=qa(f),d=1===f.nodeType&&" "+la(e)+" "){for(g=0;l=b[g++];)0>d.indexOf(" "+l+" ")&&(d+=l+" ");d=la(d);e!==d&&f.setAttribute("class",d)}return this},removeClass:function(c){var b,f,d,e,l,g,n=0;if(q.isFunction(c))return this.each(function(b){q(this).removeClass(c.call(this,
b,qa(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof c&&c)for(b=c.match(ua)||[];f=this[n++];)if(e=qa(f),d=1===f.nodeType&&" "+la(e)+" "){for(g=0;l=b[g++];)for(;-1<d.indexOf(" "+l+" ");)d=d.replace(" "+l+" "," ");d=la(d);e!==d&&f.setAttribute("class",d)}return this},toggleClass:function(c,b){var f=typeof c;return"boolean"==typeof b&&"string"===f?b?this.addClass(c):this.removeClass(c):q.isFunction(c)?this.each(function(f){q(this).toggleClass(c.call(this,f,qa(this),b),
b)}):this.each(function(){var b,d,e,l;if("string"===f){d=0;e=q(this);for(l=c.match(ua)||[];b=l[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b)}else void 0!==c&&"boolean"!==f||(b=qa(this),b&&R.set(this,"__className__",b),this.setAttribute&&this.setAttribute("class",b||!1===c?"":R.get(this,"__className__")||""))})},hasClass:function(c){var b,f=0;for(c=" "+c+" ";b=this[f++];)if(1===b.nodeType&&-1<(" "+la(qa(b))+" ").indexOf(c))return!0;return!1}});var rd=/\r/g;q.fn.extend({val:function(c){var b,f,
d,e=this[0];if(arguments.length)return d=q.isFunction(c),this.each(function(f){var e;1===this.nodeType&&(e=d?c.call(this,f,q(this).val()):c,null==e?e="":"number"==typeof e?e+="":Array.isArray(e)&&(e=q.map(e,function(c){return null==c?"":c+""})),b=q.valHooks[this.type]||q.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=q.valHooks[e.type]||q.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(f=b.get(e,"value"))?f:(f=e.value,
"string"==typeof f?f.replace(rd,""):null==f?"":f)}});q.extend({valHooks:{option:{get:function(c){var b=q.find.attr(c,"value");return null!=b?b:la(q.text(c))}},select:{get:function(c){var b,f,d=c.options,e=c.selectedIndex,l="select-one"===c.type,g=l?null:[],n=l?e+1:d.length;for(f=0>e?n:l?e:0;f<n;f++)if(b=d[f],(b.selected||f===e)&&!b.disabled&&(!b.parentNode.disabled||!j(b.parentNode,"optgroup"))){if(c=q(b).val(),l)return c;g.push(c)}return g},set:function(c,b){for(var f,d,e=c.options,l=q.makeArray(b),
g=e.length;g--;)d=e[g],(d.selected=-1<q.inArray(q.valHooks.option.get(d),l))&&(f=!0);return f||(c.selectedIndex=-1),l}}}});q.each(["radio","checkbox"],function(){q.valHooks[this]={set:function(c,b){if(Array.isArray(b))return c.checked=-1<q.inArray(q(c).val(),b)}};ca.checkOn||(q.valHooks[this].get=function(c){return null===c.getAttribute("value")?"on":c.value})});var yc=/^(?:focusinfocus|focusoutblur)$/;q.extend(q.event,{trigger:function(b,f,d,e){var l,g,n,j,m,r,s,p=[d||G],E=db.call(b,"type")?b.type:
b;l=db.call(b,"namespace")?b.namespace.split("."):[];if(g=n=d=d||G,3!==d.nodeType&&8!==d.nodeType&&!yc.test(E+q.event.triggered)&&(-1<E.indexOf(".")&&(l=E.split("."),E=l.shift(),l.sort()),m=0>E.indexOf(":")&&"on"+E,b=b[q.expando]?b:new q.Event(E,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=l.join("."),b.rnamespace=b.namespace?RegExp("(^|\\.)"+l.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),f=null==f?[b]:q.makeArray(f,[b]),s=q.event.special[E]||{},e||!s.trigger||
!1!==s.trigger.apply(d,f))){if(!e&&!s.noBubble&&!q.isWindow(d)){j=s.delegateType||E;for(yc.test(j+E)||(g=g.parentNode);g;g=g.parentNode)p.push(g),n=g;n===(d.ownerDocument||G)&&p.push(n.defaultView||n.parentWindow||c)}for(l=0;(g=p[l++])&&!b.isPropagationStopped();)b.type=1<l?j:s.bindType||E,(r=(R.get(g,"events")||{})[b.type]&&R.get(g,"handle"))&&r.apply(g,f),(r=m&&g[m])&&r.apply&&Db(g)&&(b.result=r.apply(g,f),!1===b.result&&b.preventDefault());return b.type=E,e||b.isDefaultPrevented()||s._default&&
!1!==s._default.apply(p.pop(),f)||!Db(d)||m&&q.isFunction(d[E])&&!q.isWindow(d)&&(n=d[m],n&&(d[m]=null),q.event.triggered=E,d[E](),q.event.triggered=void 0,n&&(d[m]=n)),b.result}},simulate:function(c,b,f){c=q.extend(new q.Event,f,{type:c,isSimulated:!0});q.event.trigger(c,null,b)}});q.fn.extend({trigger:function(c,b){return this.each(function(){q.event.trigger(c,b,this)})},triggerHandler:function(c,b){var f=this[0];if(f)return q.event.trigger(c,b,f,!0)}});q.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),
function(c,b){q.fn[b]=function(c,f){return 0<arguments.length?this.on(b,null,c,f):this.trigger(b)}});q.fn.extend({hover:function(c,b){return this.mouseenter(c).mouseleave(b||c)}});ca.focusin="onfocusin"in c;ca.focusin||q.each({focus:"focusin",blur:"focusout"},function(c,b){var f=function(c){q.event.simulate(b,c.target,q.event.fix(c))};q.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=R.access(d,b);e||d.addEventListener(c,f,!0);R.access(d,b,(e||0)+1)},teardown:function(){var d=
this.ownerDocument||this,e=R.access(d,b)-1;e?R.access(d,b,e):(d.removeEventListener(c,f,!0),R.remove(d,b))}}});var qb=c.location,zc=q.now(),Tb=/\?/;q.parseXML=function(b){var f;if(!b||"string"!=typeof b)return null;try{f=(new c.DOMParser).parseFromString(b,"text/xml")}catch(d){f=void 0}return f&&!f.getElementsByTagName("parsererror").length||q.error("Invalid XML: "+b),f};var Oc=/\[\]$/,Ac=/\r?\n/g,sd=/^(?:submit|button|image|reset|file)$/i,td=/^(?:input|select|textarea|keygen)/i;q.param=function(c,
b){var f,d=[],e=function(c,b){var f=q.isFunction(b)?b():b;d[d.length]=encodeURIComponent(c)+"="+encodeURIComponent(null==f?"":f)};if(Array.isArray(c)||c.jquery&&!q.isPlainObject(c))q.each(c,function(){e(this.name,this.value)});else for(f in c)fa(f,c[f],b,e);return d.join("&")};q.fn.extend({serialize:function(){return q.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var c=q.prop(this,"elements");return c?q.makeArray(c):this}).filter(function(){var c=this.type;return this.name&&
!q(this).is(":disabled")&&td.test(this.nodeName)&&!sd.test(c)&&(this.checked||!pc.test(c))}).map(function(c,b){var f=q(this).val();return null==f?null:Array.isArray(f)?q.map(f,function(c){return{name:b.name,value:c.replace(Ac,"\r\n")}}):{name:b.name,value:f.replace(Ac,"\r\n")}}).get()}});var ud=/%20/g,vd=/#.*$/,wd=/([?&])_=[^&]*/,xd=/^(.*?):[ \t]*([^\r\n]*)$/gm,yd=/^(?:GET|HEAD)$/,zd=/^\/\//,Bc={},Kb={},Cc="*/".concat("*"),Ub=G.createElement("a");Ub.href=qb.href;q.extend({active:0,lastModified:{},
etag:{},ajaxSettings:{url:qb.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(qb.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Cc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,
"text html":!0,"text json":JSON.parse,"text xml":q.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(c,b){return b?V(V(c,q.ajaxSettings),b):V(q.ajaxSettings,c)},ajaxPrefilter:oa(Bc),ajaxTransport:oa(Kb),ajax:function(b,f){function d(b,f,n,m){var p,E,t,ha,na=f;if(!r){r=!0;j&&c.clearTimeout(j);e=void 0;g=m||"";y.readyState=0<b?4:0;m=200<=b&&300>b||304===b;if(n){t=u;for(var x=y,L,K,M,G,Z=t.contents,Q=t.dataTypes;"*"===Q[0];)Q.shift(),void 0===L&&(L=t.mimeType||x.getResponseHeader("Content-Type"));
if(L)for(K in Z)if(Z[K]&&Z[K].test(L)){Q.unshift(K);break}if(Q[0]in n)M=Q[0];else{for(K in n){if(!Q[0]||t.converters[K+" "+Q[0]]){M=K;break}G||(G=K)}M=M||G}n=M?(M!==Q[0]&&Q.unshift(M),n[M]):void 0;t=n}var J;a:{n=u;L=t;K=y;M=m;var F,aa,B;t={};x=n.dataTypes.slice();if(x[1])for(F in n.converters)t[F.toLowerCase()]=n.converters[F];for(G=x.shift();G;)if(n.responseFields[G]&&(K[n.responseFields[G]]=L),!B&&M&&n.dataFilter&&(L=n.dataFilter(L,n.dataType)),B=G,G=x.shift())if("*"===G)G=B;else if("*"!==B&&B!==
G){if(F=t[B+" "+G]||t["* "+G],!F)for(J in t)if(aa=J.split(" "),aa[1]===G&&(F=t[B+" "+aa[0]]||t["* "+aa[0]])){!0===F?F=t[J]:!0!==t[J]&&(G=aa[0],x.unshift(aa[1]));break}if(!0!==F)if(F&&n["throws"])L=F(L);else try{L=F(L)}catch(fb){J={state:"parsererror",error:F?fb:"No conversion from "+B+" to "+G};break a}}J={state:"success",data:L}}t=J;m?(u.ifModified&&(ha=y.getResponseHeader("Last-Modified"),ha&&(q.lastModified[l]=ha),ha=y.getResponseHeader("etag"),ha&&(q.etag[l]=ha)),204===b||"HEAD"===u.type?na="nocontent":
304===b?na="notmodified":(na=t.state,p=t.data,E=t.error,m=!E)):(E=na,!b&&na||(na="error",0>b&&(b=0)));y.status=b;y.statusText=(f||na)+"";m?z.resolveWith(v,[p,na,y]):z.rejectWith(v,[y,na,E]);y.statusCode(S);S=void 0;s&&V.trigger(m?"ajaxSuccess":"ajaxError",[y,u,m?p:E]);U.fireWith(v,[y,na]);s&&(V.trigger("ajaxComplete",[y,u]),--q.active||q.event.trigger("ajaxStop"))}}"object"==typeof b&&(f=b,b=void 0);f=f||{};var e,l,g,n,j,m,r,s,p,t,u=q.ajaxSetup({},f),v=u.context||u,V=u.context&&(v.nodeType||v.jquery)?
q(v):q.event,z=q.Deferred(),U=q.Callbacks("once memory"),S=u.statusCode||{},ha={},na={},x="canceled",y={readyState:0,getResponseHeader:function(c){var b;if(r){if(!n)for(n={};b=xd.exec(g);)n[b[1].toLowerCase()]=b[2];b=n[c.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return r?g:null},setRequestHeader:function(c,b){return null==r&&(c=na[c.toLowerCase()]=na[c.toLowerCase()]||c,ha[c]=b),this},overrideMimeType:function(c){return null==r&&(u.mimeType=c),this},statusCode:function(c){var b;
if(c)if(r)y.always(c[y.status]);else for(b in c)S[b]=[S[b],c[b]];return this},abort:function(c){c=c||x;return e&&e.abort(c),d(0,c),this}};if(z.promise(y),u.url=((b||u.url||qb.href)+"").replace(zd,qb.protocol+"//"),u.type=f.method||f.type||u.method||u.type,u.dataTypes=(u.dataType||"*").toLowerCase().match(ua)||[""],null==u.crossDomain){m=G.createElement("a");try{m.href=u.url,m.href=m.href,u.crossDomain=Ub.protocol+"//"+Ub.host!=m.protocol+"//"+m.host}catch(L){u.crossDomain=!0}}if(u.data&&u.processData&&
"string"!=typeof u.data&&(u.data=q.param(u.data,u.traditional)),E(Bc,u,f,y),r)return y;(s=q.event&&u.global)&&0===q.active++&&q.event.trigger("ajaxStart");u.type=u.type.toUpperCase();u.hasContent=!yd.test(u.type);l=u.url.replace(vd,"");u.hasContent?u.data&&u.processData&&0===(u.contentType||"").indexOf("application/x-www-form-urlencoded")&&(u.data=u.data.replace(ud,"+")):(t=u.url.slice(l.length),u.data&&(l+=(Tb.test(l)?"&":"?")+u.data,delete u.data),!1===u.cache&&(l=l.replace(wd,"$1"),t=(Tb.test(l)?
"&":"?")+"_="+zc++ +t),u.url=l+t);u.ifModified&&(q.lastModified[l]&&y.setRequestHeader("If-Modified-Since",q.lastModified[l]),q.etag[l]&&y.setRequestHeader("If-None-Match",q.etag[l]));(u.data&&u.hasContent&&!1!==u.contentType||f.contentType)&&y.setRequestHeader("Content-Type",u.contentType);y.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+Cc+"; q=0.01":""):u.accepts["*"]);for(p in u.headers)y.setRequestHeader(p,u.headers[p]);
if(u.beforeSend&&(!1===u.beforeSend.call(v,y,u)||r))return y.abort();if(x="abort",U.add(u.complete),y.done(u.success),y.fail(u.error),e=E(Kb,u,f,y)){if(y.readyState=1,s&&V.trigger("ajaxSend",[y,u]),r)return y;u.async&&0<u.timeout&&(j=c.setTimeout(function(){y.abort("timeout")},u.timeout));try{r=!1,e.send(ha,d)}catch(K){if(r)throw K;d(-1,K)}}else d(-1,"No Transport");return y},getJSON:function(c,b,f){return q.get(c,b,f,"json")},getScript:function(c,b){return q.get(c,void 0,b,"script")}});q.each(["get",
"post"],function(c,b){q[b]=function(c,f,d,e){return q.isFunction(f)&&(e=e||d,d=f,f=void 0),q.ajax(q.extend({url:c,type:b,dataType:e,data:f,success:d},q.isPlainObject(c)&&c))}});q._evalUrl=function(c){return q.ajax({url:c,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})};q.fn.extend({wrapAll:function(c){var b;return this[0]&&(q.isFunction(c)&&(c=c.call(this[0])),b=q(c,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var c=
this;c.firstElementChild;)c=c.firstElementChild;return c}).append(this)),this},wrapInner:function(c){return q.isFunction(c)?this.each(function(b){q(this).wrapInner(c.call(this,b))}):this.each(function(){var b=q(this),f=b.contents();f.length?f.wrapAll(c):b.append(c)})},wrap:function(c){var b=q.isFunction(c);return this.each(function(f){q(this).wrapAll(b?c.call(this,f):c)})},unwrap:function(c){return this.parent(c).not("body").each(function(){q(this).replaceWith(this.childNodes)}),this}});q.expr.pseudos.hidden=
function(c){return!q.expr.pseudos.visible(c)};q.expr.pseudos.visible=function(c){return!(!c.offsetWidth&&!c.offsetHeight&&!c.getClientRects().length)};q.ajaxSettings.xhr=function(){try{return new c.XMLHttpRequest}catch(b){}};var Ad={"0":200,1223:204},rb=q.ajaxSettings.xhr();ca.cors=!!rb&&"withCredentials"in rb;ca.ajax=rb=!!rb;q.ajaxTransport(function(b){var f,d;if(ca.cors||rb&&!b.crossDomain)return{send:function(e,l){var g,n=b.xhr();if(n.open(b.type,b.url,b.async,b.username,b.password),b.xhrFields)for(g in b.xhrFields)n[g]=
b.xhrFields[g];b.mimeType&&n.overrideMimeType&&n.overrideMimeType(b.mimeType);b.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(g in e)n.setRequestHeader(g,e[g]);f=function(c){return function(){f&&(f=d=n.onload=n.onerror=n.onabort=n.onreadystatechange=null,"abort"===c?n.abort():"error"===c?"number"!=typeof n.status?l(0,"error"):l(n.status,n.statusText):l(Ad[n.status]||n.status,n.statusText,"text"!==(n.responseType||"text")||"string"!=typeof n.responseText?{binary:n.response}:
{text:n.responseText},n.getAllResponseHeaders()))}};n.onload=f();d=n.onerror=f("error");void 0!==n.onabort?n.onabort=d:n.onreadystatechange=function(){4===n.readyState&&c.setTimeout(function(){f&&d()})};f=f("abort");try{n.send(b.hasContent&&b.data||null)}catch(j){if(f)throw j;}},abort:function(){f&&f()}}});q.ajaxPrefilter(function(c){c.crossDomain&&(c.contents.script=!1)});q.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},
converters:{"text script":function(c){return q.globalEval(c),c}}});q.ajaxPrefilter("script",function(c){void 0===c.cache&&(c.cache=!1);c.crossDomain&&(c.type="GET")});q.ajaxTransport("script",function(c){if(c.crossDomain){var b,f;return{send:function(d,e){b=q("<script>").prop({charset:c.scriptCharset,src:c.url}).on("load error",f=function(c){b.remove();f=null;c&&e("error"===c.type?404:200,c.type)});G.head.appendChild(b[0])},abort:function(){f&&f()}}}});var Dc=[],Vb=/(=)\?(?=&|$)|\?\?/;q.ajaxSetup({jsonp:"callback",
jsonpCallback:function(){var c=Dc.pop()||q.expando+"_"+zc++;return this[c]=!0,c}});q.ajaxPrefilter("json jsonp",function(b,f,d){var e,l,g,n=!1!==b.jsonp&&(Vb.test(b.url)?"url":"string"==typeof b.data&&0===(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Vb.test(b.data)&&"data");if(n||"jsonp"===b.dataTypes[0])return e=b.jsonpCallback=q.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,n?b[n]=b[n].replace(Vb,"$1"+e):!1!==b.jsonp&&(b.url+=(Tb.test(b.url)?"&":"?")+b.jsonp+
"="+e),b.converters["script json"]=function(){return g||q.error(e+" was not called"),g[0]},b.dataTypes[0]="json",l=c[e],c[e]=function(){g=arguments},d.always(function(){void 0===l?q(c).removeProp(e):c[e]=l;b[e]&&(b.jsonpCallback=f.jsonpCallback,Dc.push(e));g&&q.isFunction(l)&&l(g[0]);g=l=void 0}),"script"});var Bd=ca,Ec,Fc=G.implementation.createHTMLDocument("").body;Ec=(Fc.innerHTML="<form></form><form></form>",2===Fc.childNodes.length);Bd.createHTMLDocument=Ec;q.parseHTML=function(c,b,f){if("string"!=
typeof c)return[];"boolean"==typeof b&&(f=b,b=!1);var d,e,l;return b||(ca.createHTMLDocument?(b=G.implementation.createHTMLDocument(""),d=b.createElement("base"),d.href=G.location.href,b.head.appendChild(d)):b=G),e=lc.exec(c),l=!f&&[],e?[b.createElement(e[1])]:(e=x([c],b,l),l&&l.length&&q(l).remove(),q.merge([],e.childNodes))};q.fn.load=function(c,b,f){var d,e,l,g=this,n=c.indexOf(" ");return-1<n&&(d=la(c.slice(n)),c=c.slice(0,n)),q.isFunction(b)?(f=b,b=void 0):b&&"object"==typeof b&&(e="POST"),0<
g.length&&q.ajax({url:c,type:e||"GET",dataType:"html",data:b}).done(function(c){l=arguments;g.html(d?q("<div>").append(q.parseHTML(c)).find(d):c)}).always(f&&function(c,b){g.each(function(){f.apply(this,l||[c.responseText,b,c])})}),this};q.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(c,b){q.fn[b]=function(c){return this.on(b,c)}});q.expr.pseudos.animated=function(c){return q.grep(q.timers,function(b){return c===b.elem}).length};q.offset={setOffset:function(c,
b,f){var d,e,l,g,n,j,m=q.css(c,"position"),r=q(c),s={};"static"===m&&(c.style.position="relative");n=r.offset();l=q.css(c,"top");j=q.css(c,"left");("absolute"===m||"fixed"===m)&&-1<(l+j).indexOf("auto")?(d=r.position(),g=d.top,e=d.left):(g=parseFloat(l)||0,e=parseFloat(j)||0);q.isFunction(b)&&(b=b.call(c,f,q.extend({},n)));null!=b.top&&(s.top=b.top-n.top+g);null!=b.left&&(s.left=b.left-n.left+e);"using"in b?b.using.call(c,s):r.css(s)}};q.fn.extend({offset:function(c){if(arguments.length)return void 0===
c?this:this.each(function(b){q.offset.setOffset(this,c,b)});var b,f,d,e,l=this[0];if(l)return l.getClientRects().length?(d=l.getBoundingClientRect(),b=l.ownerDocument,f=b.documentElement,e=b.defaultView,{top:d.top+e.pageYOffset-f.clientTop,left:d.left+e.pageXOffset-f.clientLeft}):{top:0,left:0}},position:function(){if(this[0]){var c,b,f=this[0],d={top:0,left:0};return"fixed"===q.css(f,"position")?b=f.getBoundingClientRect():(c=this.offsetParent(),b=this.offset(),j(c[0],"html")||(d=c.offset()),d={top:d.top+
q.css(c[0],"borderTopWidth",!0),left:d.left+q.css(c[0],"borderLeftWidth",!0)}),{top:b.top-d.top-q.css(f,"marginTop",!0),left:b.left-d.left-q.css(f,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var c=this.offsetParent;c&&"static"===q.css(c,"position");)c=c.offsetParent;return c||Gb})}});q.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(c,b){var f="pageYOffset"===b;q.fn[c]=function(d){return Na(this,function(c,d,e){var l;return q.isWindow(c)?l=c:9===c.nodeType&&
(l=c.defaultView),void 0===e?l?l[b]:c[d]:void(l?l.scrollTo(f?l.pageXOffset:e,f?e:l.pageYOffset):c[d]=e)},c,d,arguments.length)}});q.each(["top","left"],function(c,b){q.cssHooks[b]=W(ca.pixelPosition,function(c,f){if(f)return f=K(c,b),Jb.test(f)?q(c).position()[b]+"px":f})});q.each({Height:"height",Width:"width"},function(c,b){q.each({padding:"inner"+c,content:b,"":"outer"+c},function(f,d){q.fn[d]=function(e,l){var g=arguments.length&&(f||"boolean"!=typeof e),n=f||(!0===e||!0===l?"margin":"border");
return Na(this,function(b,f,e){var l;return q.isWindow(b)?0===d.indexOf("outer")?b["inner"+c]:b.document.documentElement["client"+c]:9===b.nodeType?(l=b.documentElement,Math.max(b.body["scroll"+c],l["scroll"+c],b.body["offset"+c],l["offset"+c],l["client"+c])):void 0===e?q.css(b,f,n):q.style(b,f,e,n)},b,g?e:void 0,g)}})});q.fn.extend({bind:function(c,b,f){return this.on(c,null,b,f)},unbind:function(c,b){return this.off(c,null,b)},delegate:function(c,b,f,d){return this.on(b,c,f,d)},undelegate:function(c,
b,f){return 1===arguments.length?this.off(c,"**"):this.off(b,c||"**",f)}});q.holdReady=function(c){c?q.readyWait++:q.ready(!0)};q.isArray=Array.isArray;q.parseJSON=JSON.parse;q.nodeName=j;"function"==typeof define&&define.amd&&define("jquery",[],function(){return q});var Cd=c.jQuery,Dd=c.$;return q.noConflict=function(b){return c.$===q&&(c.$=Dd),b&&c.jQuery===q&&(c.jQuery=Cd),q},b||(c.jQuery=c.$=q),q});!function(c,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):c.PointerEventsPolyfill=b()}(this,function(){function c(c,b){b=b||Object.create(null);var d=document.createEvent("Event");d.initEvent(c,b.bubbles||!1,b.cancelable||!1);for(var e,l=2;l<f.length;l++)e=f[l],d[e]=b[e]||n[l];d.buttons=b.buttons||0;e=0;return e=b.pressure&&d.buttons?b.pressure:d.buttons?0.5:0,d.x=d.clientX,d.y=d.clientY,d.pointerId=b.pointerId||0,d.width=
b.width||0,d.height=b.height||0,d.pressure=e,d.tiltX=b.tiltX||0,d.tiltY=b.tiltY||0,d.twist=b.twist||0,d.tangentialPressure=b.tangentialPressure||0,d.pointerType=b.pointerType||"",d.hwTimestamp=b.hwTimestamp||0,d.isPrimary=b.isPrimary||!1,d}function b(){this.array=[];this.size=0}function e(c,b,f,d){this.addCallback=c.bind(d);this.removeCallback=b.bind(d);this.changedCallback=f.bind(d);H&&(this.observer=new H(this.mutationWatcher.bind(this)))}function d(c){return"body /shadow-deep/ "+j(c)}function j(c){return'[touch-action="'+
c+'"]'}function g(c){return"{ -ms-touch-action: "+c+"; touch-action: "+c+"; }"}function p(c){if(!v.pointermap.has(c))throw c=Error("InvalidPointerId"),c.name="InvalidPointerId",c;}function m(c){for(var b=c.parentNode;b&&b!==c.ownerDocument;)b=b.parentNode;if(!b)throw c=Error("InvalidStateError"),c.name="InvalidStateError",c;}var f="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget pageX pageY".split(" "),n=[!1,!1,null,null,0,0,0,0,
!1,!1,!1,!1,0,null,0,0],l=window.Map&&window.Map.prototype.forEach?Map:b;b.prototype={set:function(c,b){return void 0===b?this["delete"](c):(this.has(c)||this.size++,void(this.array[c]=b))},has:function(c){return void 0!==this.array[c]},"delete":function(c){this.has(c)&&(delete this.array[c],this.size--)},get:function(c){return this.array[c]},clear:function(){this.size=this.array.length=0},forEach:function(c,b){return this.array.forEach(function(f,d){c.call(b,f,d,this)},this)}};var r="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget buttons pointerId width height pressure tiltX tiltY pointerType hwTimestamp isPrimary type target currentTarget which pageX pageY timeStamp".split(" "),
s=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],t={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},u="undefined"!=typeof SVGElementInstance,v={pointermap:new l,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(c,b){var f=b.events;f&&(f.forEach(function(c){b[c]&&(this.eventMap[c]=b[c].bind(b))},this),this.eventSources[c]=b,this.eventSourceList.push(b))},register:function(c){for(var b,
f=this.eventSourceList.length,d=0;d<f&&(b=this.eventSourceList[d]);d++)b.register.call(b,c)},unregister:function(c){for(var b,f=this.eventSourceList.length,d=0;d<f&&(b=this.eventSourceList[d]);d++)b.unregister.call(b,c)},contains:function(c,b){try{return c.contains(b)}catch(f){return!1}},down:function(c){c.bubbles=!0;this.fireEvent("pointerdown",c)},move:function(c){c.bubbles=!0;this.fireEvent("pointermove",c)},up:function(c){c.bubbles=!0;this.fireEvent("pointerup",c)},enter:function(c){c.bubbles=
!1;this.fireEvent("pointerenter",c)},leave:function(c){c.bubbles=!1;this.fireEvent("pointerleave",c)},over:function(c){c.bubbles=!0;this.fireEvent("pointerover",c)},out:function(c){c.bubbles=!0;this.fireEvent("pointerout",c)},cancel:function(c){c.bubbles=!0;this.fireEvent("pointercancel",c)},leaveOut:function(c){this.out(c);this.propagate(c,this.leave,!1)},enterOver:function(c){this.over(c);this.propagate(c,this.enter,!0)},eventHandler:function(c){if(!c._handledByPE){var b=c.type;(b=this.eventMap&&
this.eventMap[b])&&b(c);c._handledByPE=!0}},listen:function(c,b){b.forEach(function(b){this.addEvent(c,b)},this)},unlisten:function(c,b){b.forEach(function(b){this.removeEvent(c,b)},this)},addEvent:function(c,b){c.addEventListener(b,this.boundHandler)},removeEvent:function(c,b){c.removeEventListener(b,this.boundHandler)},makeEvent:function(b,f){this.captureInfo[f.pointerId]&&(f.relatedTarget=null);var d=new c(b,f);return f.preventDefault&&(d.preventDefault=f.preventDefault),d._target=d._target||f.target,
d},fireEvent:function(c,b){var f=this.makeEvent(c,b);return this.dispatchEvent(f)},cloneEvent:function(c){for(var b,f=Object.create(null),d=0;d<r.length;d++)b=r[d],f[b]=c[b]||s[d],!u||"target"!==b&&"relatedTarget"!==b||f[b]instanceof SVGElementInstance&&(f[b]=f[b].correspondingUseElement);return c.preventDefault&&(f.preventDefault=function(){c.preventDefault()}),f},getTarget:function(c){var b=this.captureInfo[c.pointerId];return b?c._target!==b&&c.type in t?void 0:b:c._target},propagate:function(c,
b,f){for(var d=c.target,e=[];d!==document&&!d.contains(c.relatedTarget);)if(e.push(d),d=d.parentNode,!d)return;f&&e.reverse();e.forEach(function(f){c.target=f;b.call(this,c)},this)},setCapture:function(b,f,d){this.captureInfo[b]&&this.releaseCapture(b,d);this.captureInfo[b]=f;this.implicitRelease=this.releaseCapture.bind(this,b,d);document.addEventListener("pointerup",this.implicitRelease);document.addEventListener("pointercancel",this.implicitRelease);var e=new c("gotpointercapture");e.pointerId=
b;e._target=f;d||this.asyncDispatchEvent(e)},releaseCapture:function(b,f){var d=this.captureInfo[b];if(d){this.captureInfo[b]=void 0;document.removeEventListener("pointerup",this.implicitRelease);document.removeEventListener("pointercancel",this.implicitRelease);var e=new c("lostpointercapture");e.pointerId=b;e._target=d;f||this.asyncDispatchEvent(e)}},dispatchEvent:function(c){var b=this.getTarget(c);if(b)return b.dispatchEvent(c)},asyncDispatchEvent:function(c){requestAnimationFrame(this.dispatchEvent.bind(this,
c))}};v.boundHandler=v.eventHandler.bind(v);var z={shadow:function(c){if(c)return c.shadowRoot||c.webkitShadowRoot},canTarget:function(c){return c&&Boolean(c.elementFromPoint)},targetingShadow:function(c){c=this.shadow(c);if(this.canTarget(c))return c},olderShadow:function(c){var b=c.olderShadowRoot;b||(c=c.querySelector("shadow"))&&(b=c.olderShadowRoot);return b},allShadows:function(c){var b=[];for(c=this.shadow(c);c;)b.push(c),c=this.olderShadow(c);return b},searchRoot:function(c,b,f){if(c){var d,
e=c.elementFromPoint(b,f);for(d=this.targetingShadow(e);d;){if(c=d.elementFromPoint(b,f))return d=this.targetingShadow(c),this.searchRoot(d,b,f)||c;d=this.olderShadow(d)}return e}},owner:function(c){for(;c.parentNode;)c=c.parentNode;return c.nodeType!==Node.DOCUMENT_NODE&&c.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(c=document),c},findTarget:function(c){var b=c.clientX,f=c.clientY;c=this.owner(c.target);return c.elementFromPoint(b,f)||(c=document),this.searchRoot(c,b,f)}},x=Array.prototype.forEach.call.bind(Array.prototype.forEach),
B=Array.prototype.map.call.bind(Array.prototype.map),A=Array.prototype.slice.call.bind(Array.prototype.slice),D=Array.prototype.filter.call.bind(Array.prototype.filter),H=window.MutationObserver||window.WebKitMutationObserver,y={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};e.prototype={watchSubtree:function(c){this.observer&&z.canTarget(c)&&this.observer.observe(c,y)},enableOnSubtree:function(c){this.watchSubtree(c);c===document&&"complete"!==document.readyState?
this.installOnLoad():this.installNewSubtree(c)},installNewSubtree:function(c){x(this.findElements(c),this.addElement,this)},findElements:function(c){return c.querySelectorAll?c.querySelectorAll("[touch-action]"):[]},removeElement:function(c){this.removeCallback(c)},addElement:function(c){this.addCallback(c)},elementChanged:function(c,b){this.changedCallback(c,b)},concatLists:function(c,b){return c.concat(A(b))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===
document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(c){return c.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(c){var b=B(c,this.findElements,this);return b.push(D(c,this.isElement)),b.reduce(this.concatLists,[])},mutationWatcher:function(c){c.forEach(this.mutationHandler,this)},mutationHandler:function(c){"childList"===c.type?(this.flattenMutationTree(c.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(c.removedNodes).forEach(this.removeElement,
this)):"attributes"===c.type&&this.elementChanged(c.target,c.oldValue)}};var C=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],I="",M=window.PointerEvent||window.MSPointerEvent,P=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,N=v.pointermap,K=[1,4,2,8,16],W=!1;try{W=1===(new MouseEvent("test",{buttons:1})).buttons}catch(ea){}var F,J={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(c){v.listen(c,
this.events)},unregister:function(c){v.unlisten(c,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(c){var b,f=this.lastTouches,d=c.clientX;c=c.clientY;for(var e=0,l=f.length;e<l&&(b=f[e]);e++){var g=Math.abs(d-b.x),n=Math.abs(c-b.y);if(25>=g&&25>=n)return!0}},prepareEvent:function(c){var b=v.cloneEvent(c),f=b.preventDefault;return b.preventDefault=function(){c.preventDefault();f()},b.pointerId=this.POINTER_ID,b.isPrimary=!0,b.pointerType=this.POINTER_TYPE,b},prepareButtonsForMove:function(c,
b){var f=N.get(this.POINTER_ID);0!==b.which&&f?c.buttons=f.buttons:c.buttons=0;b.buttons=c.buttons},mousedown:function(c){if(!this.isEventSimulatedFromTouch(c)){var b=N.get(this.POINTER_ID),f=this.prepareEvent(c);W||(f.buttons=K[f.button],b&&(f.buttons|=b.buttons),c.buttons=f.buttons);N.set(this.POINTER_ID,c);b&&0!==b.buttons?v.move(f):v.down(f)}},mousemove:function(c){if(!this.isEventSimulatedFromTouch(c)){var b=this.prepareEvent(c);W||this.prepareButtonsForMove(b,c);b.button=-1;N.set(this.POINTER_ID,
c);v.move(b)}},mouseup:function(c){if(!this.isEventSimulatedFromTouch(c)){var b=N.get(this.POINTER_ID),f=this.prepareEvent(c);if(!W){var d=K[f.button];f.buttons=b?b.buttons&~d:0;c.buttons=f.buttons}N.set(this.POINTER_ID,c);f.buttons&=~K[f.button];0===f.buttons?v.up(f):v.move(f)}},mouseover:function(c){if(!this.isEventSimulatedFromTouch(c)){var b=this.prepareEvent(c);W||this.prepareButtonsForMove(b,c);b.button=-1;N.set(this.POINTER_ID,c);v.enterOver(b)}},mouseout:function(c){if(!this.isEventSimulatedFromTouch(c)){var b=
this.prepareEvent(c);W||this.prepareButtonsForMove(b,c);b.button=-1;v.leaveOut(b)}},cancel:function(c){c=this.prepareEvent(c);v.cancel(c);this.deactivateMouse()},deactivateMouse:function(){N["delete"](this.POINTER_ID)}},ia=v.captureInfo,T=z.findTarget.bind(z),L=z.allShadows.bind(z),U=v.pointermap,S={events:["touchstart","touchmove","touchend","touchcancel"],register:function(c){F.enableOnSubtree(c)},unregister:function(){},elementAdded:function(c){var b=c.getAttribute("touch-action"),f=this.touchActionToScrollType(b);
f&&(c._scrollType=f,v.listen(c,this.events),L(c).forEach(function(c){c._scrollType=f;v.listen(c,this.events)},this))},elementRemoved:function(c){c._scrollType=void 0;v.unlisten(c,this.events);L(c).forEach(function(c){c._scrollType=void 0;v.unlisten(c,this.events)},this)},elementChanged:function(c,b){var f=c.getAttribute("touch-action"),d=this.touchActionToScrollType(f),f=this.touchActionToScrollType(b);d&&f?(c._scrollType=d,L(c).forEach(function(c){c._scrollType=d},this)):f?this.elementRemoved(c):
d&&this.elementAdded(c)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(c){var b=this.scrollTypes;return"none"===c?"none":c===b.XSCROLLER?"X":c===b.YSCROLLER?"Y":b.SCROLLER.exec(c)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(c){return this.firstTouch===c.identifier},setPrimaryTouch:function(c){(0===U.size||1===U.size&&U.has(1))&&(this.firstTouch=c.identifier,this.firstXY=
{X:c.clientX,Y:c.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(c){c.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var c=function(){this.clickCount=0;this.resetId=null}.bind(this);this.resetId=setTimeout(c,200)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(c){return 0},touchToPointer:function(c){var b=this.currentTouchEvent,
f=v.cloneEvent(c),d=f.pointerId=c.identifier+2;f.target=ia[d]||T(f);f.bubbles=!0;f.cancelable=!0;f.detail=this.clickCount;f.button=0;f.buttons=this.typeToButtons(b.type);f.width=2*(c.radiusX||c.webkitRadiusX||0);f.height=2*(c.radiusY||c.webkitRadiusY||0);f.pressure=c.force||c.webkitForce||0.5;f.isPrimary=this.isPrimaryTouch(c);f.pointerType=this.POINTER_TYPE;f.altKey=b.altKey;f.ctrlKey=b.ctrlKey;f.metaKey=b.metaKey;f.shiftKey=b.shiftKey;var e=this;return f.preventDefault=function(){e.scrolling=!1;
e.firstXY=null;b.preventDefault()},f},processTouches:function(c,b){var f=c.changedTouches;this.currentTouchEvent=c;for(var d,e=0;e<f.length;e++)d=f[e],b.call(this,this.touchToPointer(d))},shouldScroll:function(c){if(this.firstXY){var b;b=c.currentTarget._scrollType;if("none"===b)b=!1;else if("XY"===b)b=!0;else{c=c.changedTouches[0];var f="Y"===b?"X":"Y";b=Math.abs(c["client"+b]-this.firstXY[b]);c=Math.abs(c["client"+f]-this.firstXY[f]);b=b>=c}return this.firstXY=null,b}},findTouch:function(c,b){for(var f,
d=0,e=c.length;d<e&&(f=c[d]);d++)if(f.identifier===b)return!0},vacuumTouches:function(c){var b=c.touches;if(U.size>=b.length){var f=[];U.forEach(function(c,d){1!==d&&!this.findTouch(b,d-2)&&f.push(c.out)},this);f.forEach(this.cancelOut,this)}},touchstart:function(c){this.vacuumTouches(c);this.setPrimaryTouch(c.changedTouches[0]);this.dedupSynthMouse(c);this.scrolling||(this.clickCount++,this.processTouches(c,this.overDown))},overDown:function(c){U.set(c.pointerId,{target:c.target,out:c,outTarget:c.target});
v.enterOver(c);v.down(c)},touchmove:function(c){this.scrolling||(this.shouldScroll(c)?(this.scrolling=!0,this.touchcancel(c)):(c.preventDefault(),this.processTouches(c,this.moveOverOut)))},moveOverOut:function(c){var b=U.get(c.pointerId);if(b){var f=b.out,d=b.outTarget;v.move(c);f&&d!==c.target&&(f.relatedTarget=c.target,c.relatedTarget=d,f.target=d,c.target?(v.leaveOut(f),v.enterOver(c)):(c.target=d,c.relatedTarget=null,this.cancelOut(c)));b.out=c;b.outTarget=c.target}},touchend:function(c){this.dedupSynthMouse(c);
this.processTouches(c,this.upOut)},upOut:function(c){this.scrolling||(v.up(c),v.leaveOut(c));this.cleanUpPointer(c)},touchcancel:function(c){this.processTouches(c,this.cancelOut)},cancelOut:function(c){v.cancel(c);v.leaveOut(c);this.cleanUpPointer(c)},cleanUpPointer:function(c){U["delete"](c.pointerId);this.removePrimaryPointer(c)},dedupSynthMouse:function(c){var b=J.lastTouches;c=c.changedTouches[0];this.isPrimaryTouch(c)&&(c={x:c.clientX,y:c.clientY},b.push(c),b=function(c,b){var f=c.indexOf(b);
-1<f&&c.splice(f,1)}.bind(null,b,c),setTimeout(b,2500))}};F=new e(S.elementAdded,S.elementRemoved,S.elementChanged,S);var aa,ba,la,qa=v.pointermap,fa=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,oa={events:"MSPointerDown MSPointerMove MSPointerUp MSPointerOut MSPointerOver MSPointerCancel MSGotPointerCapture MSLostPointerCapture".split(" "),register:function(c){v.listen(c,this.events)},unregister:function(c){v.unlisten(c,this.events)},POINTER_TYPES:["","unavailable",
"touch","pen","mouse"],prepareEvent:function(c){var b=c;return fa&&(b=v.cloneEvent(c),b.pointerType=this.POINTER_TYPES[c.pointerType]),b},cleanup:function(c){qa["delete"](c)},MSPointerDown:function(c){qa.set(c.pointerId,c);c=this.prepareEvent(c);v.down(c)},MSPointerMove:function(c){c=this.prepareEvent(c);v.move(c)},MSPointerUp:function(c){var b=this.prepareEvent(c);v.up(b);this.cleanup(c.pointerId)},MSPointerOut:function(c){c=this.prepareEvent(c);v.leaveOut(c)},MSPointerOver:function(c){c=this.prepareEvent(c);
v.enterOver(c)},MSPointerCancel:function(c){var b=this.prepareEvent(c);v.cancel(b);this.cleanup(c.pointerId)},MSLostPointerCapture:function(c){c=v.makeEvent("lostpointercapture",c);v.dispatchEvent(c)},MSGotPointerCapture:function(c){c=v.makeEvent("gotpointercapture",c);v.dispatchEvent(c)}};window.navigator.msPointerEnabled?(aa=function(c){p(c);m(this);0!==v.pointermap.get(c).buttons&&(v.setCapture(c,this,!0),this.msSetPointerCapture(c))},ba=function(c){p(c);v.releaseCapture(c,!0);this.msReleasePointerCapture(c)}):
(aa=function(c){p(c);m(this);0!==v.pointermap.get(c).buttons&&v.setCapture(c,this)},ba=function(c){p(c);v.releaseCapture(c)});la=function(c){return!!v.captureInfo[c]};M&&(C.forEach(function(c){String(c)===c?(I+=j(c)+g(c)+"\n",P&&(I+=d(c)+g(c)+"\n")):(I+=c.selectors.map(j)+g(c.rule)+"\n",P&&(I+=c.selectors.map(d)+g(c.rule)+"\n"))}),C=document.createElement("style"),C.textContent=I,document.head.appendChild(C));window.PointerEvent||((window.PointerEvent=c,window.navigator.msPointerEnabled)?(Object.defineProperty(window.navigator,
"maxTouchPoints",{value:window.navigator.msMaxTouchPoints,enumerable:!0}),v.registerSource("ms",oa)):(Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),v.registerSource("mouse",J),void 0!==window.ontouchstart&&v.registerSource("touch",S)),v.register(document));window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:aa},releasePointerCapture:{value:ba},hasPointerCapture:{value:la}});return{dispatcher:v,
Installer:e,PointerEvent:c,PointerMap:l,targetFinding:z}});window.wgl={modules:{}};!function(c){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=c();else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self);b.CANNON=c()}}(function(){return function b(e,d,j){function g(f,n){if(!d[f]){if(!e[f]){var l="function"==typeof require&&require;if(!n&&l)return l(f,!0);if(p)return p(f,!0);throw Error("Cannot find module '"+f+"'");}l=d[f]={exports:{}};e[f][0].call(l.exports,function(b){var d=e[f][1][b];return g(d?
d:b)},l,l.exports,b,e,d,j)}return d[f].exports}for(var p="function"==typeof require&&require,m=0;m<j.length;m++)g(j[m]);return g}({1:[function(b,e){e.exports={name:"cannon",version:"0.6.2",description:"A lightweight 3D physics engine written in JavaScript.",homepage:"https://github.com/schteppe/cannon.js",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["cannon.js","cannon","physics","engine","3d"],main:"./build/cannon.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/cannon.js.git"},
bugs:{url:"https://github.com/schteppe/cannon.js/issues"},licenses:[{type:"MIT"}],devDependencies:{jshint:"latest","uglify-js":"latest",nodeunit:"^0.9.0",grunt:"~0.4.0","grunt-contrib-jshint":"~0.1.1","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-concat":"~0.1.3","grunt-contrib-uglify":"^0.5.1","grunt-browserify":"^2.1.4","grunt-contrib-yuidoc":"^0.5.2",browserify:"*"},dependencies:{}}},{}],2:[function(b,e){e.exports={version:b("../package.json").version,AABB:b("./collision/AABB"),ArrayCollisionMatrix:b("./collision/ArrayCollisionMatrix"),
Body:b("./objects/Body"),Box:b("./shapes/Box"),Broadphase:b("./collision/Broadphase"),Constraint:b("./constraints/Constraint"),ContactEquation:b("./equations/ContactEquation"),Narrowphase:b("./world/Narrowphase"),ConeTwistConstraint:b("./constraints/ConeTwistConstraint"),ContactMaterial:b("./material/ContactMaterial"),ConvexPolyhedron:b("./shapes/ConvexPolyhedron"),Cylinder:b("./shapes/Cylinder"),DistanceConstraint:b("./constraints/DistanceConstraint"),Equation:b("./equations/Equation"),EventTarget:b("./utils/EventTarget"),
FrictionEquation:b("./equations/FrictionEquation"),GSSolver:b("./solver/GSSolver"),GridBroadphase:b("./collision/GridBroadphase"),Heightfield:b("./shapes/Heightfield"),HingeConstraint:b("./constraints/HingeConstraint"),LockConstraint:b("./constraints/LockConstraint"),Mat3:b("./math/Mat3"),Material:b("./material/Material"),NaiveBroadphase:b("./collision/NaiveBroadphase"),ObjectCollisionMatrix:b("./collision/ObjectCollisionMatrix"),Pool:b("./utils/Pool"),Particle:b("./shapes/Particle"),Plane:b("./shapes/Plane"),
PointToPointConstraint:b("./constraints/PointToPointConstraint"),Quaternion:b("./math/Quaternion"),Ray:b("./collision/Ray"),RaycastVehicle:b("./objects/RaycastVehicle"),RaycastResult:b("./collision/RaycastResult"),RigidVehicle:b("./objects/RigidVehicle"),RotationalEquation:b("./equations/RotationalEquation"),RotationalMotorEquation:b("./equations/RotationalMotorEquation"),SAPBroadphase:b("./collision/SAPBroadphase"),SPHSystem:b("./objects/SPHSystem"),Shape:b("./shapes/Shape"),Solver:b("./solver/Solver"),
Sphere:b("./shapes/Sphere"),SplitSolver:b("./solver/SplitSolver"),Spring:b("./objects/Spring"),Trimesh:b("./shapes/Trimesh"),Vec3:b("./math/Vec3"),Vec3Pool:b("./utils/Vec3Pool"),World:b("./world/World")}},{"../package.json":1,"./collision/AABB":3,"./collision/ArrayCollisionMatrix":4,"./collision/Broadphase":5,"./collision/GridBroadphase":6,"./collision/NaiveBroadphase":7,"./collision/ObjectCollisionMatrix":8,"./collision/Ray":9,"./collision/RaycastResult":10,"./collision/SAPBroadphase":11,"./constraints/ConeTwistConstraint":12,
"./constraints/Constraint":13,"./constraints/DistanceConstraint":14,"./constraints/HingeConstraint":15,"./constraints/LockConstraint":16,"./constraints/PointToPointConstraint":17,"./equations/ContactEquation":19,"./equations/Equation":20,"./equations/FrictionEquation":21,"./equations/RotationalEquation":22,"./equations/RotationalMotorEquation":23,"./material/ContactMaterial":24,"./material/Material":25,"./math/Mat3":27,"./math/Quaternion":28,"./math/Vec3":30,"./objects/Body":31,"./objects/RaycastVehicle":32,
"./objects/RigidVehicle":33,"./objects/SPHSystem":34,"./objects/Spring":35,"./shapes/Box":37,"./shapes/ConvexPolyhedron":38,"./shapes/Cylinder":39,"./shapes/Heightfield":40,"./shapes/Particle":41,"./shapes/Plane":42,"./shapes/Shape":43,"./shapes/Sphere":44,"./shapes/Trimesh":45,"./solver/GSSolver":46,"./solver/Solver":47,"./solver/SplitSolver":48,"./utils/EventTarget":49,"./utils/Pool":51,"./utils/Vec3Pool":54,"./world/Narrowphase":55,"./world/World":56}],3:[function(b,e){function d(b){b=b||{};this.lowerBound=
new j;b.lowerBound&&this.lowerBound.copy(b.lowerBound);this.upperBound=new j;b.upperBound&&this.upperBound.copy(b.upperBound)}var j=b("../math/Vec3");b("../utils/Utils");e.exports=d;var g=new j;d.prototype.setFromPoints=function(b,f,d,e){var j=this.lowerBound,s=this.upperBound;j.copy(b[0]);d&&d.vmult(j,j);s.copy(j);for(var p=1;p<b.length;p++){var u=b[p];d&&(d.vmult(u,g),u=g);u.x>s.x&&(s.x=u.x);u.x<j.x&&(j.x=u.x);u.y>s.y&&(s.y=u.y);u.y<j.y&&(j.y=u.y);u.z>s.z&&(s.z=u.z);u.z<j.z&&(j.z=u.z)}f&&(f.vadd(j,
j),f.vadd(s,s));e&&(j.x-=e,j.y-=e,j.z-=e,s.x+=e,s.y+=e,s.z+=e);return this};d.prototype.copy=function(b){this.lowerBound.copy(b.lowerBound);this.upperBound.copy(b.upperBound);return this};d.prototype.clone=function(){return(new d).copy(this)};d.prototype.extend=function(b){var f=b.lowerBound.x;this.lowerBound.x>f&&(this.lowerBound.x=f);f=b.upperBound.x;this.upperBound.x<f&&(this.upperBound.x=f);f=b.lowerBound.y;this.lowerBound.y>f&&(this.lowerBound.y=f);f=b.upperBound.y;this.upperBound.y<f&&(this.upperBound.y=
f);f=b.lowerBound.z;this.lowerBound.z>f&&(this.lowerBound.z=f);f=b.upperBound.z;this.upperBound.z<f&&(this.upperBound.z=f)};d.prototype.overlaps=function(b){var f=this.lowerBound,d=this.upperBound,e=b.lowerBound;b=b.upperBound;return(e.x<=d.x&&d.x<=b.x||f.x<=b.x&&b.x<=d.x)&&(e.y<=d.y&&d.y<=b.y||f.y<=b.y&&b.y<=d.y)&&(e.z<=d.z&&d.z<=b.z||f.z<=b.z&&b.z<=d.z)};d.prototype.contains=function(b){var f=this.lowerBound,d=this.upperBound,e=b.lowerBound;b=b.upperBound;return f.x<=e.x&&d.x>=b.x&&f.y<=e.y&&d.y>=
b.y&&f.z<=e.z&&d.z>=b.z};d.prototype.getCorners=function(b,f,d,e,g,j,p,u){var v=this.lowerBound,z=this.upperBound;b.copy(v);f.set(z.x,v.y,v.z);d.set(z.x,z.y,v.z);e.set(v.x,z.y,z.z);g.set(z.x,v.y,v.z);j.set(v.x,z.y,v.z);p.set(v.x,v.y,z.z);u.copy(z)};var p=[new j,new j,new j,new j,new j,new j,new j,new j];d.prototype.toLocalFrame=function(b,f){this.getCorners(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7]);for(var d=0;8!==d;d++){var e=p[d];b.pointToLocal(e,e)}return f.setFromPoints(p)};d.prototype.toWorldFrame=
function(b,f){this.getCorners(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7]);for(var d=0;8!==d;d++){var e=p[d];b.pointToWorld(e,e)}return f.setFromPoints(p)}},{"../math/Vec3":30,"../utils/Utils":53}],4:[function(b,e){function d(){this.matrix=[]}e.exports=d;d.prototype.get=function(b,d){b=b.index;d=d.index;if(d>b){var e=d;d=b;b=e}return this.matrix[(b*(b+1)>>1)+d-1]};d.prototype.set=function(b,d,e){b=b.index;d=d.index;if(d>b){var m=d;d=b;b=m}this.matrix[(b*(b+1)>>1)+d-1]=e?1:0};d.prototype.reset=function(){for(var b=
0,d=this.matrix.length;b!==d;b++)this.matrix[b]=0};d.prototype.setNumObjects=function(b){this.matrix.length=b*(b-1)>>1}},{}],5:[function(b,e){function d(){this.world=null;this.useBoundingBoxes=!1;this.dirty=!0}var j=b("../objects/Body"),g=b("../math/Vec3"),p=b("../math/Quaternion");b("../shapes/Shape");b("../shapes/Plane");e.exports=d;d.prototype.collisionPairs=function(){throw Error("collisionPairs not implemented for this BroadPhase class!");};var m=j.STATIC|j.KINEMATIC;d.prototype.needBroadphaseCollision=
function(b,f){return 0===(b.collisionFilterGroup&f.collisionFilterMask)||0===(f.collisionFilterGroup&b.collisionFilterMask)||(0!==(b.type&m)||b.sleepState===j.SLEEPING)&&(0!==(f.type&m)||f.sleepState===j.SLEEPING)?!1:!0};d.prototype.intersectionTest=function(b,f,d,e){this.useBoundingBoxes?this.doBoundingBoxBroadphase(b,f,d,e):this.doBoundingSphereBroadphase(b,f,d,e)};var f=new g;new g;new p;new g;d.prototype.doBoundingSphereBroadphase=function(b,d,e,l){d.position.vsub(b.position,f);var g=Math.pow(b.boundingRadius+
d.boundingRadius,2);f.norm2()<g&&(e.push(b),l.push(d))};d.prototype.doBoundingBoxBroadphase=function(b,f,d,e){b.aabbNeedsUpdate&&b.computeAABB();f.aabbNeedsUpdate&&f.computeAABB();b.aabb.overlaps(f.aabb)&&(d.push(b),e.push(f))};var n={keys:[]},l=[],r=[];d.prototype.makePairsUnique=function(b,f){for(var d=b.length,e=0;e!==d;e++)l[e]=b[e],r[e]=f[e];b.length=0;for(e=f.length=0;e!==d;e++){var g=l[e].id,j=r[e].id,g=g<j?g+","+j:j+","+g;n[g]=e;n.keys.push(g)}for(e=0;e!==n.keys.length;e++)g=n.keys.pop(),
d=n[g],b.push(l[d]),f.push(r[d]),delete n[g]};d.prototype.setWorld=function(){};var s=new g;d.boundingSphereCheck=function(b,f){b.position.vsub(f.position,s);return Math.pow(b.shape.boundingSphereRadius+f.shape.boundingSphereRadius,2)>s.norm2()};d.prototype.aabbQuery=function(){console.warn(".aabbQuery is not implemented in this Broadphase subclass.");return[]}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Plane":42,"../shapes/Shape":43}],6:[function(b,e){function d(b,
d,e,m,s){j.apply(this);this.nx=e||10;this.ny=m||10;this.nz=s||10;this.aabbMin=b||new g(100,100,100);this.aabbMax=d||new g(-100,-100,-100);b=this.nx*this.ny*this.nz;if(0>=b)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[];this.binLengths=[];this.bins.length=b;this.binLengths.length=b;for(d=0;d<b;d++)this.bins[d]=[],this.binLengths[d]=0}e.exports=d;var j=b("./Broadphase"),g=b("../math/Vec3"),p=b("../shapes/Shape");d.prototype=new j;d.prototype.constructor=d;var m=new g;new g;d.prototype.collisionPairs=
function(b,d,e){function g(b,f,d,e,l,n,j){b=(b-I)*N|0;f=(f-M)*K|0;d=(d-P)*W|0;e=U((e-I)*N);l=U((l-M)*K);n=U((n-P)*W);0>b?b=0:b>=v&&(b=v-1);0>f?f=0:f>=z&&(f=z-1);0>d?d=0:d>=x&&(d=x-1);0>e?e=0:e>=v&&(e=v-1);0>l?l=0:l>=z&&(l=z-1);0>n?n=0:n>=x&&(n=x-1);b*=B;f*=A;d*=D;e*=B;l*=A;for(n*=D;b<=e;b+=B)for(var m=f;m<=l;m+=A)for(var r=d;r<=n;r+=D){var s=b+m+r;T[s][L[s]++]=j}}var j=b.numObjects();b=b.bodies;for(var t=this.aabbMax,u=this.aabbMin,v=this.nx,z=this.ny,x=this.nz,B=z*x,A=x,D=1,H=t.x,y=t.y,C=t.z,I=u.x,
M=u.y,P=u.z,N=v/(H-I),K=z/(y-M),W=x/(C-P),H=(H-I)/v,ea=(y-M)/z,C=(C-P)/x,F=0.5*Math.sqrt(H*H+ea*ea+C*C),y=p.types,J=y.SPHERE,ia=y.PLANE,T=this.bins,L=this.binLengths,y=this.bins.length,u=0;u!==y;u++)L[u]=0;for(var U=Math.ceil,u=Math.min,t=Math.max,u=0;u!==j;u++){var t=b[u],S=t.shape;switch(S.type){case J:var aa=t.position.x,ba=t.position.y,la=t.position.z,S=S.radius;g(aa-S,ba-S,la-S,aa+S,ba+S,la+S,t);break;case ia:S.worldNormalNeedsUpdate&&S.computeWorldNormal(t.quaternion);var la=S.worldNormal,S=
M+0.5*ea-t.position.y,qa=P+0.5*C-t.position.z,fa=m;fa.set(I+0.5*H-t.position.x,S,qa);for(var oa=aa=0;aa!==v;aa++,oa+=B,fa.y=S,fa.x+=H)for(var E=ba=0;ba!==z;ba++,E+=A,fa.z=qa,fa.y+=ea)for(var V=0,ha=0;V!==x;V++,ha+=D,fa.z+=C)if(fa.dot(la)<F){var G=oa+E+ha;T[G][L[G]++]=t}break;default:t.aabbNeedsUpdate&&t.computeAABB(),g(t.aabb.lowerBound.x,t.aabb.lowerBound.y,t.aabb.lowerBound.z,t.aabb.upperBound.x,t.aabb.upperBound.y,t.aabb.upperBound.z,t)}}for(u=0;u!==y;u++)if(j=L[u],1<j){b=T[u];for(aa=0;aa!==j;aa++){t=
b[aa];for(ba=0;ba!==aa;ba++)H=b[ba],this.needBroadphaseCollision(t,H)&&this.intersectionTest(t,H,d,e)}}this.makePairsUnique(d,e)}},{"../math/Vec3":30,"../shapes/Shape":43,"./Broadphase":5}],7:[function(b,e){function d(){j.apply(this)}e.exports=d;var j=b("./Broadphase"),g=b("./AABB");d.prototype=new j;d.prototype.constructor=d;d.prototype.collisionPairs=function(b,d,f){b=b.bodies;var e=b.length,l,g,j,t;for(l=0;l!==e;l++)for(g=0;g!==l;g++)j=b[l],t=b[g],this.needBroadphaseCollision(j,t)&&this.intersectionTest(j,
t,d,f)};new g;d.prototype.aabbQuery=function(b,d,f){f=f||[];for(var e=0;e<b.bodies.length;e++){var l=b.bodies[e];l.aabbNeedsUpdate&&l.computeAABB();l.aabb.overlaps(d)&&f.push(l)}return f}},{"./AABB":3,"./Broadphase":5}],8:[function(b,e){function d(){this.matrix={}}e.exports=d;d.prototype.get=function(b,d){b=b.id;d=d.id;if(d>b){var e=d;d=b;b=e}return b+"-"+d in this.matrix};d.prototype.set=function(b,d,e){b=b.id;d=d.id;if(d>b){var m=d;d=b;b=m}e?this.matrix[b+"-"+d]=!0:delete this.matrix[b+"-"+d]};
d.prototype.reset=function(){this.matrix={}};d.prototype.setNumObjects=function(){}},{}],9:[function(b,e){function d(b,e){this.from=b?b.clone():new g;this.to=e?e.clone():new g;this._direction=new g;this.precision=1E-4;this.checkCollisionResponse=!0;this.skipBackfaces=!1;this.collisionFilterGroup=this.collisionFilterMask=-1;this.mode=d.ANY;this.result=new f;this.hasHit=!1;this.callback=function(){}}function j(b,f,d,e){e.vsub(f,T);d.vsub(f,t);b.vsub(f,u);b=T.dot(T);f=T.dot(t);d=T.dot(u);e=t.dot(t);
var l=t.dot(u),g,n;return 0<=(g=e*d-f*l)&&0<=(n=b*l-f*d)&&g+n<b*e-f*f}e.exports=d;var g=b("../math/Vec3"),p=b("../math/Quaternion"),m=b("../math/Transform");b("../shapes/ConvexPolyhedron");b("../shapes/Box");var f=b("../collision/RaycastResult"),n=b("../shapes/Shape"),l=b("../collision/AABB");d.prototype.constructor=d;d.CLOSEST=1;d.ANY=2;d.ALL=4;var r=new l,s=[];d.prototype.intersectWorld=function(b,e){this.mode=e.mode||d.ANY;this.result=e.result||new f;this.skipBackfaces=!!e.skipBackfaces;this.collisionFilterMask=
"undefined"!==typeof e.collisionFilterMask?e.collisionFilterMask:-1;this.collisionFilterGroup="undefined"!==typeof e.collisionFilterGroup?e.collisionFilterGroup:-1;e.from&&this.from.copy(e.from);e.to&&this.to.copy(e.to);this.callback=e.callback||function(){};this.hasHit=!1;this.result.reset();this._updateDirection();this.getAABB(r);s.length=0;b.broadphase.aabbQuery(b,r,s);this.intersectBodies(s);return this.hasHit};var t=new g,u=new g;d.pointInTriangle=j;var v=new g,z=new p;d.prototype.intersectBody=
function(b,f){f&&(this.result=f,this._updateDirection());var d=this.checkCollisionResponse;if(!d||b.collisionResponse)if(!(0===(this.collisionFilterGroup&b.collisionFilterMask)||0===(b.collisionFilterGroup&this.collisionFilterMask)))for(var e=0,l=b.shapes.length;e<l;e++){var g=b.shapes[e];if(!d||g.collisionResponse)if(b.quaternion.mult(b.shapeOrientations[e],z),b.quaternion.vmult(b.shapeOffsets[e],v),v.vadd(b.position,v),this.intersectShape(g,z,v,b),this.result._shouldStop)break}};d.prototype.intersectBodies=
function(b,f){f&&(this.result=f,this._updateDirection());for(var d=0,e=b.length;!this.result._shouldStop&&d<e;d++)this.intersectBody(b[d])};d.prototype._updateDirection=function(){this.to.vsub(this.from,this._direction);this._direction.normalize()};d.prototype.intersectShape=function(b,f,d,e){var l=this.from,g=this._direction;d.vsub(l,T);var n=T.dot(g);g.mult(n,L);L.vadd(l,L);d.distanceTo(L)>b.boundingSphereRadius||(l=this[b.type])&&l.call(this,b,f,d,e)};new g;new g;var x=new g,B=new g,A=new g,D=
new g;new g;new f;d.prototype.intersectBox=function(b,f,d,e){return this.intersectConvex(b.convexPolyhedronRepresentation,f,d,e)};d.prototype[n.types.BOX]=d.prototype.intersectBox;d.prototype.intersectPlane=function(b,f,d,e){var l=this.from,n=this.to,j=this._direction,m=new g(0,0,1);f.vmult(m,m);var r=new g;l.vsub(d,r);f=r.dot(m);n.vsub(d,r);r=r.dot(m);if(!(0<f*r)&&!(l.distanceTo(n)<f)&&(r=m.dot(j),!(Math.abs(r)<this.precision))){var s=new g,n=new g;f=new g;l.vsub(d,s);d=-m.dot(s)/r;j.scale(d,n);
l.vadd(n,f);this.reportIntersection(m,f,b,e,-1)}};d.prototype[n.types.PLANE]=d.prototype.intersectPlane;d.prototype.getAABB=function(b){var f=this.to,d=this.from;b.lowerBound.x=Math.min(f.x,d.x);b.lowerBound.y=Math.min(f.y,d.y);b.lowerBound.z=Math.min(f.z,d.z);b.upperBound.x=Math.max(f.x,d.x);b.upperBound.y=Math.max(f.y,d.y);b.upperBound.z=Math.max(f.z,d.z)};var H={faceList:[0]};d.prototype.intersectHeightfield=function(b,f,e,l){var n=new g,j=new d(this.from,this.to);m.pointToLocalFrame(e,f,j.from,
j.from);m.pointToLocalFrame(e,f,j.to,j.to);var r=[],s=null,p=null,t=null,u=null,v=b.getIndexOfPosition(j.from.x,j.from.y,r,!1);v&&(s=r[0],p=r[1],t=r[0],u=r[1]);if(v=b.getIndexOfPosition(j.to.x,j.to.y,r,!1)){if(null===s||r[0]<s)s=r[0];if(null===t||r[0]>t)t=r[0];if(null===p||r[1]<p)p=r[1];if(null===u||r[1]>u)u=r[1]}if(null!==s){b.getRectMinMax(s,p,t,u,[]);for(j=s;j<=t;j++)for(r=p;r<=u;r++){if(this.result._shouldStop)return;b.getConvexTrianglePillar(j,r,!1);m.pointToWorldFrame(e,f,b.pillarOffset,n);
this.intersectConvex(b.pillarConvex,f,n,l,H);if(this.result._shouldStop)return;b.getConvexTrianglePillar(j,r,!0);m.pointToWorldFrame(e,f,b.pillarOffset,n);this.intersectConvex(b.pillarConvex,f,n,l,H)}}};d.prototype[n.types.HEIGHTFIELD]=d.prototype.intersectHeightfield;var y=new g,C=new g;d.prototype.intersectSphere=function(b,f,d,e){f=this.from;var l=this.to,g=b.radius,n=Math.pow(l.x-f.x,2)+Math.pow(l.y-f.y,2)+Math.pow(l.z-f.z,2),j=2*((l.x-f.x)*(f.x-d.x)+(l.y-f.y)*(f.y-d.y)+(l.z-f.z)*(f.z-d.z)),g=
Math.pow(f.x-d.x,2)+Math.pow(f.y-d.y,2)+Math.pow(f.z-d.z,2)-Math.pow(g,2),m=Math.pow(j,2)-4*n*g;0>m||(0===m?(f.lerp(l,m,y),y.vsub(d,C),C.normalize(),this.reportIntersection(C,y,b,e,-1)):(g=(-j-Math.sqrt(m))/(2*n),n=(-j+Math.sqrt(m))/(2*n),0<=g&&1>=g&&(f.lerp(l,g,y),y.vsub(d,C),C.normalize(),this.reportIntersection(C,y,b,e,-1)),!this.result._shouldStop&&(0<=n&&1>=n)&&(f.lerp(l,n,y),y.vsub(d,C),C.normalize(),this.reportIntersection(C,y,b,e,-1))))};d.prototype[n.types.SPHERE]=d.prototype.intersectSphere;
var I=new g;new g;new g;var M=new g;d.prototype.intersectConvex=function(b,f,d,e,l){l=l&&l.faceList||null;for(var g=b.faces,n=b.vertices,m=b.faceNormals,r=this._direction,s=this.from,p=s.distanceTo(this.to),t=l?l.length:g.length,u=this.result,v=0;!u._shouldStop&&v<t;v++){var z=l?l[v]:v,y=g[z],L=m[z],K=f,F=d;M.copy(n[y[0]]);K.vmult(M,M);M.vadd(F,M);M.vsub(s,M);K.vmult(L,I);L=r.dot(I);if(!(Math.abs(L)<this.precision)&&(L=I.dot(M)/L,!(0>L))){r.mult(L,x);x.vadd(s,x);B.copy(n[y[0]]);K.vmult(B,B);F.vadd(B,
B);for(L=1;!u._shouldStop&&L<y.length-1;L++){A.copy(n[y[L]]);D.copy(n[y[L+1]]);K.vmult(A,A);K.vmult(D,D);F.vadd(A,A);F.vadd(D,D);var J=x.distanceTo(s);!j(x,B,A,D)&&!j(x,A,B,D)||J>p||this.reportIntersection(I,x,b,e,z)}}}};d.prototype[n.types.CONVEXPOLYHEDRON]=d.prototype.intersectConvex;var P=new g,N=new g,K=new g,W=new g,ea=new g,F=new g;new l;var J=[],ia=new m;d.prototype.intersectTrimesh=function(b,f,d,e){var l=b.indices,g=this.from,n=this.to,r=this._direction;ia.position.copy(d);ia.quaternion.copy(f);
m.vectorToLocalFrame(d,f,r,N);m.pointToLocalFrame(d,f,g,K);m.pointToLocalFrame(d,f,n,W);g=K.distanceSquared(W);b.tree.rayQuery(this,ia,J);n=0;for(r=J.length;!this.result._shouldStop&&n!==r;n++){var s=J[n];b.getNormal(s,P);b.getVertex(l[3*s],B);B.vsub(K,M);var p=N.dot(P),p=P.dot(M)/p;0>p||(N.scale(p,x),x.vadd(K,x),b.getVertex(l[3*s+1],A),b.getVertex(l[3*s+2],D),p=x.distanceSquared(K),!j(x,A,B,D)&&!j(x,B,A,D)||p>g||(m.vectorToWorldFrame(f,P,ea),m.pointToWorldFrame(d,f,x,F),this.reportIntersection(ea,
F,b,e,s)))}J.length=0};d.prototype[n.types.TRIMESH]=d.prototype.intersectTrimesh;d.prototype.reportIntersection=function(b,f,e,l,g){var n=this.from,j=this.to,m=n.distanceTo(f),r=this.result;if(!(this.skipBackfaces&&0<b.dot(this._direction)))switch(r.hitFaceIndex="undefined"!==typeof g?g:-1,this.mode){case d.ALL:this.hasHit=!0;r.set(n,j,b,f,e,l,m);r.hasHit=!0;this.callback(r);break;case d.CLOSEST:if(m<r.distance||!r.hasHit)this.hasHit=!0,r.hasHit=!0,r.set(n,j,b,f,e,l,m);break;case d.ANY:this.hasHit=
!0,r.hasHit=!0,r.set(n,j,b,f,e,l,m),r._shouldStop=!0}};var T=new g,L=new g},{"../collision/AABB":3,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/Box":37,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43}],10:[function(b,e){function d(){this.rayFromWorld=new j;this.rayToWorld=new j;this.hitNormalWorld=new j;this.hitPointWorld=new j;this.hasHit=!1;this.body=this.shape=null;this.distance=this.hitFaceIndex=-1;this._shouldStop=!1}var j=b("../math/Vec3");
e.exports=d;d.prototype.reset=function(){this.rayFromWorld.setZero();this.rayToWorld.setZero();this.hitNormalWorld.setZero();this.hitPointWorld.setZero();this.hasHit=!1;this.body=this.shape=null;this.distance=this.hitFaceIndex=-1;this._shouldStop=!1};d.prototype.abort=function(){this._shouldStop=!0};d.prototype.set=function(b,d,e,f,n,l,j){this.rayFromWorld.copy(b);this.rayToWorld.copy(d);this.hitNormalWorld.copy(e);this.hitPointWorld.copy(f);this.shape=n;this.body=l;this.distance=j}},{"../math/Vec3":30}],
11:[function(b,e){function d(b){j.apply(this);this.axisList=[];this.world=null;this.axisIndex=0;var d=this.axisList;this._addBodyHandler=function(b){d.push(b.body)};this._removeBodyHandler=function(b){b=d.indexOf(b.body);-1!==b&&d.splice(b,1)};b&&this.setWorld(b)}b("../shapes/Shape");var j=b("../collision/Broadphase");e.exports=d;d.prototype=new j;d.prototype.setWorld=function(b){for(var d=this.axisList.length=0;d<b.bodies.length;d++)this.axisList.push(b.bodies[d]);b.removeEventListener("addBody",
this._addBodyHandler);b.removeEventListener("removeBody",this._removeBodyHandler);b.addEventListener("addBody",this._addBodyHandler);b.addEventListener("removeBody",this._removeBodyHandler);this.world=b;this.dirty=!0};d.insertionSortX=function(b){for(var d=1,e=b.length;d<e;d++){for(var f=b[d],n=d-1;0<=n&&!(b[n].aabb.lowerBound.x<=f.aabb.lowerBound.x);n--)b[n+1]=b[n];b[n+1]=f}return b};d.insertionSortY=function(b){for(var d=1,e=b.length;d<e;d++){for(var f=b[d],n=d-1;0<=n&&!(b[n].aabb.lowerBound.y<=
f.aabb.lowerBound.y);n--)b[n+1]=b[n];b[n+1]=f}return b};d.insertionSortZ=function(b){for(var d=1,e=b.length;d<e;d++){for(var f=b[d],n=d-1;0<=n&&!(b[n].aabb.lowerBound.z<=f.aabb.lowerBound.z);n--)b[n+1]=b[n];b[n+1]=f}return b};d.prototype.collisionPairs=function(b,e,j){b=this.axisList;var f=b.length,n=this.axisIndex,l,r;this.dirty&&(this.sortList(),this.dirty=!1);for(l=0;l!==f;l++){var s=b[l];for(r=l+1;r<f;r++){var t=b[r];if(this.needBroadphaseCollision(s,t)){if(!d.checkBounds(s,t,n))break;this.intersectionTest(s,
t,e,j)}}}};d.prototype.sortList=function(){for(var b=this.axisList,e=this.axisIndex,j=b.length,f=0;f!==j;f++){var n=b[f];n.aabbNeedsUpdate&&n.computeAABB()}0===e?d.insertionSortX(b):1===e?d.insertionSortY(b):2===e&&d.insertionSortZ(b)};d.checkBounds=function(b,d,e){var f,n;0===e?(f=b.position.x,n=d.position.x):1===e?(f=b.position.y,n=d.position.y):2===e&&(f=b.position.z,n=d.position.z);return n-d.boundingRadius<f+b.boundingRadius};d.prototype.autoDetectAxis=function(){for(var b=0,d=0,e=0,f=0,n=0,
l=0,j=this.axisList,s=j.length,t=1/s,u=0;u!==s;u++)var v=j[u],z=v.position.x,b=b+z,d=d+z*z,z=v.position.y,e=e+z,f=f+z*z,v=v.position.z,n=n+v,l=l+v*v;b=d-b*b*t;e=f-e*e*t;n=l-n*n*t;this.axisIndex=b>e?b>n?0:2:e>n?1:2};d.prototype.aabbQuery=function(b,d,e){e=e||[];this.dirty&&(this.sortList(),this.dirty=!1);b=this.axisList;for(var f=0;f<b.length;f++){var n=b[f];n.aabbNeedsUpdate&&n.computeAABB();n.aabb.overlaps(d)&&e.push(n)}return e}},{"../collision/Broadphase":5,"../shapes/Shape":43}],12:[function(b,
e){function d(b,d,e){e=e||{};var r="undefined"!==typeof e.maxForce?e.maxForce:1E6,s=e.pivotA?e.pivotA.clone():new m,t=e.pivotB?e.pivotB.clone():new m;this.axisA=e.axisA?e.axisA.clone():new m;this.axisB=e.axisB?e.axisB.clone():new m;j.call(this,b,s,d,t,r);this.collideConnected=!!e.collideConnected;this.angle="undefined"!==typeof e.angle?e.angle:0;s=this.coneEquation=new g(b,d,e);b=this.twistEquation=new p(b,d,e);this.twistAngle="undefined"!==typeof e.twistAngle?e.twistAngle:0;s.maxForce=0;s.minForce=
-r;b.maxForce=0;b.minForce=-r;this.equations.push(s,b)}e.exports=d;b("./Constraint");var j=b("./PointToPointConstraint"),g=b("../equations/ConeEquation"),p=b("../equations/RotationalEquation");b("../equations/ContactEquation");var m=b("../math/Vec3");d.prototype=new j;d.constructor=d;new m;new m;d.prototype.update=function(){var b=this.bodyA,d=this.bodyB,e=this.coneEquation,g=this.twistEquation;j.prototype.update.call(this);b.vectorToWorldFrame(this.axisA,e.axisA);d.vectorToWorldFrame(this.axisB,
e.axisB);this.axisA.tangents(g.axisA,g.axisA);b.vectorToWorldFrame(g.axisA,g.axisA);this.axisB.tangents(g.axisB,g.axisB);d.vectorToWorldFrame(g.axisB,g.axisB);e.angle=this.angle;g.maxAngle=this.twistAngle}},{"../equations/ConeEquation":18,"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],13:[function(b,e){function d(b,e,m){m=j.defaults(m,{collideConnected:!0,wakeUpBodies:!0});this.equations=[];this.bodyA=b;this.bodyB=
e;this.id=d.idCounter++;this.collideConnected=m.collideConnected;m.wakeUpBodies&&(b&&b.wakeUp(),e&&e.wakeUp())}e.exports=d;var j=b("../utils/Utils");d.prototype.update=function(){throw Error("method update() not implmemented in this Constraint subclass!");};d.prototype.enable=function(){for(var b=this.equations,d=0;d<b.length;d++)b[d].enabled=!0};d.prototype.disable=function(){for(var b=this.equations,d=0;d<b.length;d++)b[d].enabled=!1};d.idCounter=0},{"../utils/Utils":53}],14:[function(b,e){function d(b,
d,f,e){j.call(this,b,d);"undefined"===typeof f&&(f=b.position.distanceTo(d.position));"undefined"===typeof e&&(e=1E6);this.distance=f;b=this.distanceEquation=new g(b,d);this.equations.push(b);b.minForce=-e;b.maxForce=e}e.exports=d;var j=b("./Constraint"),g=b("../equations/ContactEquation");d.prototype=new j;d.prototype.update=function(){var b=this.distanceEquation,d=0.5*this.distance,f=b.ni;this.bodyB.position.vsub(this.bodyA.position,f);f.normalize();f.mult(d,b.ri);f.mult(-d,b.rj)}},{"../equations/ContactEquation":19,
"./Constraint":13}],15:[function(b,e){function d(b,f,d){d=d||{};var e="undefined"!==typeof d.maxForce?d.maxForce:1E6,n=d.pivotA?d.pivotA.clone():new m,v=d.pivotB?d.pivotB.clone():new m;j.call(this,b,n,f,v,e);(this.axisA=d.axisA?d.axisA.clone():new m(1,0,0)).normalize();(this.axisB=d.axisB?d.axisB.clone():new m(1,0,0)).normalize();n=this.rotationalEquation1=new g(b,f,d);d=this.rotationalEquation2=new g(b,f,d);b=this.motorEquation=new p(b,f,e);b.enabled=!1;this.equations.push(n,d,b)}e.exports=d;b("./Constraint");
var j=b("./PointToPointConstraint"),g=b("../equations/RotationalEquation"),p=b("../equations/RotationalMotorEquation");b("../equations/ContactEquation");var m=b("../math/Vec3");d.prototype=new j;d.constructor=d;d.prototype.enableMotor=function(){this.motorEquation.enabled=!0};d.prototype.disableMotor=function(){this.motorEquation.enabled=!1};d.prototype.setMotorSpeed=function(b){this.motorEquation.targetVelocity=b};d.prototype.setMotorMaxForce=function(b){this.motorEquation.maxForce=b;this.motorEquation.minForce=
-b};var f=new m,n=new m;d.prototype.update=function(){var b=this.bodyA,d=this.bodyB,e=this.motorEquation,g=this.rotationalEquation1,m=this.rotationalEquation2,p=this.axisA,z=this.axisB;j.prototype.update.call(this);b.quaternion.vmult(p,f);d.quaternion.vmult(z,n);f.tangents(g.axisA,m.axisA);g.axisB.copy(n);m.axisB.copy(n);this.motorEquation.enabled&&(b.quaternion.vmult(this.axisA,e.axisA),d.quaternion.vmult(this.axisB,e.axisB))}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,
"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],16:[function(b,e){function d(b,f,d){d=d||{};var e="undefined"!==typeof d.maxForce?d.maxForce:1E6,r=new p,s=new p,t=new p;b.position.vadd(f.position,t);t.scale(0.5,t);f.pointToLocalFrame(t,s);b.pointToLocalFrame(t,r);j.call(this,b,r,f,s,e);e=this.rotationalEquation1=new g(b,f,d);r=this.rotationalEquation2=new g(b,f,d);b=this.rotationalEquation3=new g(b,f,d);this.equations.push(e,r,b)}e.exports=
d;b("./Constraint");var j=b("./PointToPointConstraint"),g=b("../equations/RotationalEquation");b("../equations/RotationalMotorEquation");b("../equations/ContactEquation");var p=b("../math/Vec3");d.prototype=new j;d.constructor=d;new p;new p;d.prototype.update=function(){var b=this.bodyA,f=this.bodyB,d=this.rotationalEquation1,e=this.rotationalEquation2,g=this.rotationalEquation3;j.prototype.update.call(this);b.vectorToWorldFrame(p.UNIT_X,d.axisA);f.vectorToWorldFrame(p.UNIT_Y,d.axisB);b.vectorToWorldFrame(p.UNIT_Y,
e.axisA);f.vectorToWorldFrame(p.UNIT_Z,e.axisB);b.vectorToWorldFrame(p.UNIT_Z,g.axisA);f.vectorToWorldFrame(p.UNIT_X,g.axisB)}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],17:[function(b,e){function d(b,f,d,e,r){j.call(this,b,d);r="undefined"!==typeof r?r:1E6;this.pivotA=f?f.clone():new p;this.pivotB=e?e.clone():new p;f=this.equationX=new g(b,d);e=this.equationY=
new g(b,d);b=this.equationZ=new g(b,d);this.equations.push(f,e,b);f.minForce=e.minForce=b.minForce=-r;f.maxForce=e.maxForce=b.maxForce=r;f.ni.set(1,0,0);e.ni.set(0,1,0);b.ni.set(0,0,1)}e.exports=d;var j=b("./Constraint"),g=b("../equations/ContactEquation"),p=b("../math/Vec3");d.prototype=new j;d.prototype.update=function(){var b=this.bodyB,f=this.equationX,d=this.equationY,e=this.equationZ;this.bodyA.quaternion.vmult(this.pivotA,f.ri);b.quaternion.vmult(this.pivotB,f.rj);d.ri.copy(f.ri);d.rj.copy(f.rj);
e.ri.copy(f.ri);e.rj.copy(f.rj)}},{"../equations/ContactEquation":19,"../math/Vec3":30,"./Constraint":13}],18:[function(b,e){function d(b,d,e){e=e||{};var m="undefined"!==typeof e.maxForce?e.maxForce:1E6;g.call(this,b,d,-m,m);this.axisA=e.axisA?e.axisA.clone():new j(1,0,0);this.axisB=e.axisB?e.axisB.clone():new j(0,1,0);this.angle="undefined"!==typeof e.angle?e.angle:0}e.exports=d;var j=b("../math/Vec3");b("../math/Mat3");var g=b("./Equation");d.prototype=new g;d.prototype.constructor=d;var p=new j,
m=new j;d.prototype.computeB=function(b){var d=this.a,e=this.b,g=this.axisA,j=this.axisB,t=this.jacobianElementA,u=this.jacobianElementB;g.cross(j,p);j.cross(g,m);t.rotational.copy(m);u.rotational.copy(p);g=Math.cos(this.angle)-g.dot(j);j=this.computeGW();t=this.computeGiMf();return-g*d-j*e-b*t}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],19:[function(b,e){function d(b,f,d){j.call(this,b,f,0,"undefined"!==typeof d?d:1E6);this.restitution=0;this.ri=new g;this.rj=new g;this.ni=new g}e.exports=
d;var j=b("./Equation"),g=b("../math/Vec3");b("../math/Mat3");d.prototype=new j;d.prototype.constructor=d;var p=new g,m=new g,f=new g;d.prototype.computeB=function(b){var d=this.a,e=this.b,l=this.bi,g=this.bj,n=this.ri,j=this.rj,r=l.velocity,s=l.angularVelocity,t=g.velocity,I=g.angularVelocity,M=this.jacobianElementA,P=this.jacobianElementB,N=this.ni;n.cross(N,p);j.cross(N,m);N.negate(M.spatial);p.negate(M.rotational);P.spatial.copy(N);P.rotational.copy(m);f.copy(g.position);f.vadd(j,f);f.vsub(l.position,
f);f.vsub(n,f);l=N.dot(f);g=this.restitution+1;r=g*t.dot(N)-g*r.dot(N)+I.dot(m)-s.dot(p);s=this.computeGiMf();return-l*d-r*e-b*s};var n=new g,l=new g,r=new g,s=new g,t=new g;d.prototype.getImpactVelocityAlongNormal=function(){this.bi.position.vadd(this.ri,r);this.bj.position.vadd(this.rj,s);this.bi.getVelocityAtWorldPoint(r,n);this.bj.getVelocityAtWorldPoint(s,l);n.vsub(l,t);return this.ni.dot(t)}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],20:[function(b,e){function d(b,f,e,l){this.id=
d.id++;this.minForce="undefined"===typeof e?-1E6:e;this.maxForce="undefined"===typeof l?1E6:l;this.bi=b;this.bj=f;this.eps=this.b=this.a=0;this.jacobianElementA=new j;this.jacobianElementB=new j;this.enabled=!0;this.setSpookParams(1E7,4,1/60)}e.exports=d;var j=b("../math/JacobianElement"),g=b("../math/Vec3");d.prototype.constructor=d;d.id=0;d.prototype.setSpookParams=function(b,f,d){this.a=4/(d*(1+4*f));this.b=4*f/(1+4*f);this.eps=4/(d*d*b*(1+4*f))};d.prototype.computeB=function(b,f,d){var e=this.computeGW(),
l=this.computeGq(),g=this.computeGiMf();return-l*b-e*f-g*d};d.prototype.computeGq=function(){var b=this.jacobianElementB,f=this.bj.position;return this.jacobianElementA.spatial.dot(this.bi.position)+b.spatial.dot(f)};var p=new g;d.prototype.computeGW=function(){var b=this.jacobianElementB,f=this.bi,d=this.bj,e=d.velocity,d=d.angularVelocity||p;return this.jacobianElementA.multiplyVectors(f.velocity,f.angularVelocity||p)+b.multiplyVectors(e,d)};d.prototype.computeGWlambda=function(){var b=this.jacobianElementB,
f=this.bi,d=this.bj,e=d.vlambda,d=d.wlambda||p;return this.jacobianElementA.multiplyVectors(f.vlambda,f.wlambda||p)+b.multiplyVectors(e,d)};var m=new g,f=new g,n=new g,l=new g;d.prototype.computeGiMf=function(){var b=this.jacobianElementA,d=this.jacobianElementB,e=this.bi,g=this.bj,j=e.force,r=e.torque,s=g.force,p=g.torque,H=e.invMassSolve,y=g.invMassSolve;e.invInertiaWorldSolve?e.invInertiaWorldSolve.vmult(r,n):n.set(0,0,0);g.invInertiaWorldSolve?g.invInertiaWorldSolve.vmult(p,l):l.set(0,0,0);j.mult(H,
m);s.mult(y,f);return b.multiplyVectors(m,n)+d.multiplyVectors(f,l)};var r=new g;d.prototype.computeGiMGt=function(){var b=this.jacobianElementA,f=this.jacobianElementB,d=this.bi,e=this.bj,l=d.invInertiaWorldSolve,g=e.invInertiaWorldSolve,d=d.invMassSolve+e.invMassSolve;l&&(l.vmult(b.rotational,r),d+=r.dot(b.rotational));g&&(g.vmult(f.rotational,r),d+=r.dot(f.rotational));return d};var s=new g;new g;new g;new g;new g;new g;d.prototype.addToWlambda=function(b){var f=this.jacobianElementA,d=this.jacobianElementB,
e=this.bi,l=this.bj;f.spatial.mult(e.invMassSolve*b,s);e.vlambda.vadd(s,e.vlambda);d.spatial.mult(l.invMassSolve*b,s);l.vlambda.vadd(s,l.vlambda);e.invInertiaWorldSolve&&(e.invInertiaWorldSolve.vmult(f.rotational,s),s.mult(b,s),e.wlambda.vadd(s,e.wlambda));l.invInertiaWorldSolve&&(l.invInertiaWorldSolve.vmult(d.rotational,s),s.mult(b,s),l.wlambda.vadd(s,l.wlambda))};d.prototype.computeC=function(){return this.computeGiMGt()+this.eps}},{"../math/JacobianElement":26,"../math/Vec3":30}],21:[function(b,
e){function d(b,d,e){j.call(this,b,d,-e,e);this.ri=new g;this.rj=new g;this.t=new g}e.exports=d;var j=b("./Equation"),g=b("../math/Vec3");b("../math/Mat3");d.prototype=new j;d.prototype.constructor=d;var p=new g,m=new g;d.prototype.computeB=function(b){var d=this.b,e=this.rj,g=this.t;this.ri.cross(g,p);e.cross(g,m);var e=this.jacobianElementA,j=this.jacobianElementB;g.negate(e.spatial);p.negate(e.rotational);j.spatial.copy(g);j.rotational.copy(m);g=this.computeGW();e=this.computeGiMf();return-g*d-
b*e}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],22:[function(b,e){function d(b,d,e){e=e||{};var m="undefined"!==typeof e.maxForce?e.maxForce:1E6;g.call(this,b,d,-m,m);this.axisA=e.axisA?e.axisA.clone():new j(1,0,0);this.axisB=e.axisB?e.axisB.clone():new j(0,1,0);this.maxAngle=Math.PI/2}e.exports=d;var j=b("../math/Vec3");b("../math/Mat3");var g=b("./Equation");d.prototype=new g;d.prototype.constructor=d;var p=new j,m=new j;d.prototype.computeB=function(b){var d=this.a,e=this.b,g=this.axisA,
j=this.axisB,t=this.jacobianElementA,u=this.jacobianElementB;g.cross(j,p);j.cross(g,m);t.rotational.copy(m);u.rotational.copy(p);g=Math.cos(this.maxAngle)-g.dot(j);j=this.computeGW();t=this.computeGiMf();return-g*d-j*e-b*t}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],23:[function(b,e){function d(b,d,f){f="undefined"!==typeof f?f:1E6;g.call(this,b,d,-f,f);this.axisA=new j;this.axisB=new j;this.targetVelocity=0}e.exports=d;var j=b("../math/Vec3");b("../math/Mat3");var g=b("./Equation");
d.prototype=new g;d.prototype.constructor=d;d.prototype.computeB=function(b){var d=this.b,f=this.axisB,e=this.jacobianElementB;this.jacobianElementA.rotational.copy(this.axisA);f.negate(e.rotational);f=this.computeGW()-this.targetVelocity;e=this.computeGiMf();return-f*d-b*e}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],24:[function(b,e){function d(b,e,m){m=j.defaults(m,{friction:0.3,restitution:0.3,contactEquationStiffness:1E7,contactEquationRelaxation:3,frictionEquationStiffness:1E7,frictionEquationRelaxation:3});
this.id=d.idCounter++;this.materials=[b,e];this.friction=m.friction;this.restitution=m.restitution;this.contactEquationStiffness=m.contactEquationStiffness;this.contactEquationRelaxation=m.contactEquationRelaxation;this.frictionEquationStiffness=m.frictionEquationStiffness;this.frictionEquationRelaxation=m.frictionEquationRelaxation}var j=b("../utils/Utils");e.exports=d;d.idCounter=0},{"../utils/Utils":53}],25:[function(b,e){function d(b){var e="";b=b||{};"string"===typeof b?(e=b,b={}):"object"===
typeof b&&(e="");this.name=e;this.id=d.idCounter++;this.friction="undefined"!==typeof b.friction?b.friction:-1;this.restitution="undefined"!==typeof b.restitution?b.restitution:-1}e.exports=d;d.idCounter=0},{}],26:[function(b,e){function d(){this.spatial=new j;this.rotational=new j}e.exports=d;var j=b("./Vec3");d.prototype.multiplyElement=function(b){return b.spatial.dot(this.spatial)+b.rotational.dot(this.rotational)};d.prototype.multiplyVectors=function(b,d){return b.dot(this.spatial)+d.dot(this.rotational)}},
{"./Vec3":30}],27:[function(b,e){function d(b){this.elements=b?b:[0,0,0,0,0,0,0,0,0]}e.exports=d;var j=b("./Vec3");d.prototype.identity=function(){var b=this.elements;b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=1;b[5]=0;b[6]=0;b[7]=0;b[8]=1};d.prototype.setZero=function(){var b=this.elements;b[0]=0;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=0;b[6]=0;b[7]=0;b[8]=0};d.prototype.setTrace=function(b){var d=this.elements;d[0]=b.x;d[4]=b.y;d[8]=b.z};d.prototype.getTrace=function(b){b=b||new j;var d=this.elements;b.x=d[0];b.y=
d[4];b.z=d[8]};d.prototype.vmult=function(b,d){d=d||new j;var e=this.elements,f=b.x,n=b.y,l=b.z;d.x=e[0]*f+e[1]*n+e[2]*l;d.y=e[3]*f+e[4]*n+e[5]*l;d.z=e[6]*f+e[7]*n+e[8]*l;return d};d.prototype.smult=function(b){for(var d=0;d<this.elements.length;d++)this.elements[d]*=b};d.prototype.mmult=function(b,e){for(var j=e||new d,f=0;3>f;f++)for(var n=0;3>n;n++){for(var l=0,r=0;3>r;r++)l+=b.elements[f+3*r]*this.elements[r+3*n];j.elements[f+3*n]=l}return j};d.prototype.scale=function(b,e){e=e||new d;for(var j=
this.elements,f=e.elements,n=0;3!==n;n++)f[3*n+0]=b.x*j[3*n+0],f[3*n+1]=b.y*j[3*n+1],f[3*n+2]=b.z*j[3*n+2];return e};d.prototype.solve=function(b,d){d=d||new j;for(var e=[],f=0;12>f;f++)e.push(0);for(var n,f=0;3>f;f++)for(n=0;3>n;n++)e[f+4*n]=this.elements[f+3*n];e[3]=b.x;e[7]=b.y;e[11]=b.z;var l=3,r=l,s,t;do{f=r-l;if(0===e[f+4*f])for(n=f+1;n<r;n++)if(0!==e[f+4*n]){s=4;do t=4-s,e[t+4*f]+=e[t+4*n];while(--s);break}if(0!==e[f+4*f])for(n=f+1;n<r;n++){var u=e[f+4*n]/e[f+4*f];s=4;do t=4-s,e[t+4*n]=t<=
f?0:e[t+4*n]-e[t+4*f]*u;while(--s)}}while(--l);d.z=e[11]/e[10];d.y=(e[7]-e[6]*d.z)/e[5];d.x=(e[3]-e[2]*d.z-e[1]*d.y)/e[0];if(isNaN(d.x)||isNaN(d.y)||isNaN(d.z)||Infinity===d.x||Infinity===d.y||Infinity===d.z)throw"Could not solve equation! Got x=["+d.toString()+"], b=["+b.toString()+"], A=["+this.toString()+"]";return d};d.prototype.e=function(b,d,e){if(void 0===e)return this.elements[d+3*b];this.elements[d+3*b]=e};d.prototype.copy=function(b){for(var d=0;d<b.elements.length;d++)this.elements[d]=
b.elements[d];return this};d.prototype.toString=function(){for(var b="",d=0;9>d;d++)b+=this.elements[d]+",";return b};d.prototype.reverse=function(b){b=b||new d;for(var e=[],j=0;18>j;j++)e.push(0);for(var f,j=0;3>j;j++)for(f=0;3>f;f++)e[j+6*f]=this.elements[j+3*f];e[3]=1;e[9]=0;e[15]=0;e[4]=0;e[10]=1;e[16]=0;e[5]=0;e[11]=0;e[17]=1;var n=3,l=n,r,s;do{j=l-n;if(0===e[j+6*j])for(f=j+1;f<l;f++)if(0!==e[j+6*f]){r=6;do s=6-r,e[s+6*j]+=e[s+6*f];while(--r);break}if(0!==e[j+6*j])for(f=j+1;f<l;f++){var t=e[j+
6*f]/e[j+6*j];r=6;do s=6-r,e[s+6*f]=s<=j?0:e[s+6*f]-e[s+6*j]*t;while(--r)}}while(--n);j=2;do{f=j-1;do{t=e[j+6*f]/e[j+6*j];r=6;do s=6-r,e[s+6*f]-=e[s+6*j]*t;while(--r)}while(f--)}while(--j);j=2;do{t=1/e[j+6*j];r=6;do s=6-r,e[s+6*j]*=t;while(--r)}while(j--);j=2;do{f=2;do{s=e[3+f+6*j];if(isNaN(s)||Infinity===s)throw"Could not reverse! A=["+this.toString()+"]";b.e(j,f,s)}while(f--)}while(j--);return b};d.prototype.setRotationFromQuaternion=function(b){var d=b.x,e=b.y,f=b.z,n=b.w,l=d+d,j=e+e,s=f+f;b=d*
l;var t=d*j,d=d*s,u=e*j,e=e*s,f=f*s,l=n*l,j=n*j,n=n*s,s=this.elements;s[0]=1-(u+f);s[1]=t-n;s[2]=d+j;s[3]=t+n;s[4]=1-(b+f);s[5]=e-l;s[6]=d-j;s[7]=e+l;s[8]=1-(b+u);return this};d.prototype.transpose=function(b){b=b||new d;for(var e=b.elements,j=this.elements,f=0;3!==f;f++)for(var n=0;3!==n;n++)e[3*f+n]=j[3*n+f];return b}},{"./Vec3":30}],28:[function(b,e){function d(b,f,d,e){this.x=void 0!==b?b:0;this.y=void 0!==f?f:0;this.z=void 0!==d?d:0;this.w=void 0!==e?e:1}e.exports=d;var j=b("./Vec3");d.prototype.set=
function(b,f,d,e){this.x=b;this.y=f;this.z=d;this.w=e};d.prototype.toString=function(){return this.x+","+this.y+","+this.z+","+this.w};d.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]};d.prototype.setFromAxisAngle=function(b,f){var d=Math.sin(0.5*f);this.x=b.x*d;this.y=b.y*d;this.z=b.z*d;this.w=Math.cos(0.5*f)};d.prototype.toAxisAngle=function(b){b=b||new j;this.normalize();var f=2*Math.acos(this.w),d=Math.sqrt(1-this.w*this.w);0.001>d?(b.x=this.x,b.y=this.y,b.z=this.z):(b.x=this.x/
d,b.y=this.y/d,b.z=this.z/d);return[b,f]};var g=new j,p=new j;d.prototype.setFromVectors=function(b,f){if(b.isAntiparallelTo(f))b.tangents(g,p),this.setFromAxisAngle(g,Math.PI);else{var d=b.cross(f);this.x=d.x;this.y=d.y;this.z=d.z;this.w=Math.sqrt(Math.pow(b.norm(),2)*Math.pow(f.norm(),2))+b.dot(f);this.normalize()}};var m=new j,f=new j,n=new j;d.prototype.mult=function(b,e){e=e||new d;var g=this.w;m.set(this.x,this.y,this.z);f.set(b.x,b.y,b.z);e.w=g*b.w-m.dot(f);m.cross(f,n);e.x=g*f.x+b.w*m.x+n.x;
e.y=g*f.y+b.w*m.y+n.y;e.z=g*f.z+b.w*m.z+n.z;return e};d.prototype.inverse=function(b){var f=this.x,e=this.y,n=this.z,g=this.w;b=b||new d;this.conjugate(b);f=1/(f*f+e*e+n*n+g*g);b.x*=f;b.y*=f;b.z*=f;b.w*=f;return b};d.prototype.conjugate=function(b){b=b||new d;b.x=-this.x;b.y=-this.y;b.z=-this.z;b.w=this.w;return b};d.prototype.normalize=function(){var b=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);0===b?this.w=this.z=this.y=this.x=0:(b=1/b,this.x*=b,this.y*=b,this.z*=b,this.w*=
b)};d.prototype.normalizeFast=function(){var b=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;0===b?this.w=this.z=this.y=this.x=0:(this.x*=b,this.y*=b,this.z*=b,this.w*=b)};d.prototype.vmult=function(b,f){f=f||new j;var d=b.x,e=b.y,n=b.z,g=this.x,m=this.y,p=this.z,B=this.w,A=B*d+m*n-p*e,D=B*e+p*d-g*n,H=B*n+g*e-m*d,d=-g*d-m*e-p*n;f.x=A*B+d*-g+D*-p-H*-m;f.y=D*B+d*-m+H*-g-A*-p;f.z=H*B+d*-p+A*-m-D*-g;return f};d.prototype.copy=function(b){this.x=b.x;this.y=b.y;this.z=b.z;this.w=b.w;return this};
d.prototype.toEuler=function(b,f){f=f||"YZX";var d,e,n,g=this.x,j=this.y,m=this.z,p=this.w;switch(f){case "YZX":var A=g*j+m*p;0.499<A&&(d=2*Math.atan2(g,p),e=Math.PI/2,n=0);-0.499>A&&(d=-2*Math.atan2(g,p),e=-Math.PI/2,n=0);if(isNaN(d)){n=g*g;var D=m*m;d=Math.atan2(2*j*p-2*g*m,1-2*j*j-2*D);e=Math.asin(2*A);n=Math.atan2(2*g*p-2*j*m,1-2*n-2*D)}break;default:throw Error("Euler order "+f+" not supported yet.");}b.y=d;b.z=e;b.x=n};d.prototype.setFromEuler=function(b,f,d,e){e=e||"XYZ";var n=Math.cos(b/2),
g=Math.cos(f/2),j=Math.cos(d/2);b=Math.sin(b/2);f=Math.sin(f/2);d=Math.sin(d/2);"XYZ"===e?(this.x=b*g*j+n*f*d,this.y=n*f*j-b*g*d,this.z=n*g*d+b*f*j,this.w=n*g*j-b*f*d):"YXZ"===e?(this.x=b*g*j+n*f*d,this.y=n*f*j-b*g*d,this.z=n*g*d-b*f*j,this.w=n*g*j+b*f*d):"ZXY"===e?(this.x=b*g*j-n*f*d,this.y=n*f*j+b*g*d,this.z=n*g*d+b*f*j,this.w=n*g*j-b*f*d):"ZYX"===e?(this.x=b*g*j-n*f*d,this.y=n*f*j+b*g*d,this.z=n*g*d-b*f*j,this.w=n*g*j+b*f*d):"YZX"===e?(this.x=b*g*j+n*f*d,this.y=n*f*j+b*g*d,this.z=n*g*d-b*f*j,this.w=
n*g*j-b*f*d):"XZY"===e&&(this.x=b*g*j-n*f*d,this.y=n*f*j-b*g*d,this.z=n*g*d+b*f*j,this.w=n*g*j+b*f*d);return this};d.prototype.clone=function(){return new d(this.x,this.y,this.z,this.w)}},{"./Vec3":30}],29:[function(b,e){function d(b){b=b||{};this.position=new j;b.position&&this.position.copy(b.position);this.quaternion=new g;b.quaternion&&this.quaternion.copy(b.quaternion)}var j=b("./Vec3"),g=b("./Quaternion");e.exports=d;var p=new g;d.pointToLocalFrame=function(b,f,d,e){e=e||new j;d.vsub(b,e);f.conjugate(p);
p.vmult(e,e);return e};d.prototype.pointToLocal=function(b,f){return d.pointToLocalFrame(this.position,this.quaternion,b,f)};d.pointToWorldFrame=function(b,f,d,e){e=e||new j;f.vmult(d,e);e.vadd(b,e);return e};d.prototype.pointToWorld=function(b,f){return d.pointToWorldFrame(this.position,this.quaternion,b,f)};d.prototype.vectorToWorldFrame=function(b,f){f=f||new j;this.quaternion.vmult(b,f);return f};d.vectorToWorldFrame=function(b,f,d){b.vmult(f,d);return d};d.vectorToLocalFrame=function(b,f,d,e){e=
e||new j;f.w*=-1;f.vmult(d,e);f.w*=-1;return e}},{"./Quaternion":28,"./Vec3":30}],30:[function(b,e){function d(b,d,e){this.x=b||0;this.y=d||0;this.z=e||0}e.exports=d;var j=b("./Mat3");d.ZERO=new d(0,0,0);d.UNIT_X=new d(1,0,0);d.UNIT_Y=new d(0,1,0);d.UNIT_Z=new d(0,0,1);d.prototype.cross=function(b,e){var l=b.x,g=b.y,j=b.z,m=this.x,p=this.y,v=this.z;e=e||new d;e.x=p*j-v*g;e.y=v*l-m*j;e.z=m*g-p*l;return e};d.prototype.set=function(b,d,e){this.x=b;this.y=d;this.z=e;return this};d.prototype.setZero=function(){this.x=
this.y=this.z=0};d.prototype.vadd=function(b,e){if(e)e.x=b.x+this.x,e.y=b.y+this.y,e.z=b.z+this.z;else return new d(this.x+b.x,this.y+b.y,this.z+b.z)};d.prototype.vsub=function(b,e){if(e)e.x=this.x-b.x,e.y=this.y-b.y,e.z=this.z-b.z;else return new d(this.x-b.x,this.y-b.y,this.z-b.z)};d.prototype.crossmat=function(){return new j([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])};d.prototype.normalize=function(){var b=this.x,d=this.y,e=this.z,b=Math.sqrt(b*b+d*d+e*e);0<b?(d=1/b,this.x*=d,this.y*=
d,this.z*=d):this.z=this.y=this.x=0;return b};d.prototype.unit=function(b){b=b||new d;var e=this.x,l=this.y,g=this.z,j=Math.sqrt(e*e+l*l+g*g);0<j?(j=1/j,b.x=e*j,b.y=l*j,b.z=g*j):(b.x=1,b.y=0,b.z=0);return b};d.prototype.norm=function(){var b=this.x,d=this.y,e=this.z;return Math.sqrt(b*b+d*d+e*e)};d.prototype.length=d.prototype.norm;d.prototype.norm2=function(){return this.dot(this)};d.prototype.lengthSquared=d.prototype.norm2;d.prototype.distanceTo=function(b){var d=this.x,e=this.y,g=this.z,j=b.x,
m=b.y;b=b.z;return Math.sqrt((j-d)*(j-d)+(m-e)*(m-e)+(b-g)*(b-g))};d.prototype.distanceSquared=function(b){var d=this.x,e=this.y,g=this.z,j=b.x,m=b.y;b=b.z;return(j-d)*(j-d)+(m-e)*(m-e)+(b-g)*(b-g)};d.prototype.mult=function(b,e){e=e||new d;var g=this.y,j=this.z;e.x=b*this.x;e.y=b*g;e.z=b*j;return e};d.prototype.scale=d.prototype.mult;d.prototype.dot=function(b){return this.x*b.x+this.y*b.y+this.z*b.z};d.prototype.isZero=function(){return 0===this.x&&0===this.y&&0===this.z};d.prototype.negate=function(b){b=
b||new d;b.x=-this.x;b.y=-this.y;b.z=-this.z;return b};var g=new d,p=new d;d.prototype.tangents=function(b,d){var e=this.norm();0<e?(e=1/e,g.set(this.x*e,this.y*e,this.z*e),0.9>Math.abs(g.x)?p.set(1,0,0):p.set(0,1,0),g.cross(p,b),g.cross(b,d)):(b.set(1,0,0),d.set(0,1,0))};d.prototype.toString=function(){return this.x+","+this.y+","+this.z};d.prototype.toArray=function(){return[this.x,this.y,this.z]};d.prototype.copy=function(b){this.x=b.x;this.y=b.y;this.z=b.z;return this};d.prototype.lerp=function(b,
d,e){var g=this.x,j=this.y,m=this.z;e.x=g+(b.x-g)*d;e.y=j+(b.y-j)*d;e.z=m+(b.z-m)*d};d.prototype.almostEquals=function(b,d){void 0===d&&(d=1E-6);return Math.abs(this.x-b.x)>d||Math.abs(this.y-b.y)>d||Math.abs(this.z-b.z)>d?!1:!0};d.prototype.almostZero=function(b){void 0===b&&(b=1E-6);return Math.abs(this.x)>b||Math.abs(this.y)>b||Math.abs(this.z)>b?!1:!0};var m=new d;d.prototype.isAntiparallelTo=function(b,d){this.negate(m);return m.almostEquals(b,d)};d.prototype.clone=function(){return new d(this.x,
this.y,this.z)}},{"./Mat3":27}],31:[function(b,e){function d(b){b=b||{};j.apply(this);this.id=d.idCounter++;this.postStep=this.preStep=this.world=null;this.vlambda=new g;this.collisionFilterGroup="number"===typeof b.collisionFilterGroup?b.collisionFilterGroup:1;this.collisionFilterMask="number"===typeof b.collisionFilterMask?b.collisionFilterMask:1;this.collisionResponse=!0;this.position=new g;b.position&&this.position.copy(b.position);this.previousPosition=new g;this.initPosition=new g;this.velocity=
new g;b.velocity&&this.velocity.copy(b.velocity);this.initVelocity=new g;this.force=new g;var e="number"===typeof b.mass?b.mass:0;this.mass=e;this.invMass=0<e?1/e:0;this.material=b.material||null;this.linearDamping="number"===typeof b.linearDamping?b.linearDamping:0.01;this.type=0>=e?d.STATIC:d.DYNAMIC;typeof b.type===typeof d.STATIC&&(this.type=b.type);this.allowSleep="undefined"!==typeof b.allowSleep?b.allowSleep:!0;this.sleepState=0;this.sleepSpeedLimit="undefined"!==typeof b.sleepSpeedLimit?b.sleepSpeedLimit:
0.1;this.sleepTimeLimit="undefined"!==typeof b.sleepTimeLimit?b.sleepTimeLimit:1;this.timeLastSleepy=0;this._wakeUpAfterNarrowphase=!1;this.torque=new g;this.quaternion=new m;b.quaternion&&this.quaternion.copy(b.quaternion);this.initQuaternion=new m;this.angularVelocity=new g;b.angularVelocity&&this.angularVelocity.copy(b.angularVelocity);this.initAngularVelocity=new g;this.interpolatedPosition=new g;this.interpolatedQuaternion=new m;this.shapes=[];this.shapeOffsets=[];this.shapeOrientations=[];this.inertia=
new g;this.invInertia=new g;this.invInertiaWorld=new p;this.invMassSolve=0;this.invInertiaSolve=new g;this.invInertiaWorldSolve=new p;this.fixedRotation="undefined"!==typeof b.fixedRotation?b.fixedRotation:!1;this.angularDamping="undefined"!==typeof b.angularDamping?b.angularDamping:0.01;this.aabb=new f;this.aabbNeedsUpdate=!0;this.wlambda=new g;b.shape&&this.addShape(b.shape);this.updateMassProperties()}e.exports=d;var j=b("../utils/EventTarget");b("../shapes/Shape");var g=b("../math/Vec3"),p=b("../math/Mat3"),
m=b("../math/Quaternion");b("../material/Material");var f=b("../collision/AABB"),n=b("../shapes/Box");d.prototype=new j;d.prototype.constructor=d;d.DYNAMIC=1;d.STATIC=2;d.KINEMATIC=4;d.AWAKE=0;d.SLEEPY=1;d.SLEEPING=2;d.idCounter=0;d.prototype.wakeUp=function(){var b=this.sleepState;this.sleepState=0;b===d.SLEEPING&&this.dispatchEvent({type:"wakeup"})};d.prototype.sleep=function(){this.sleepState=d.SLEEPING;this.velocity.set(0,0,0);this.angularVelocity.set(0,0,0)};d.sleepyEvent={type:"sleepy"};d.sleepEvent=
{type:"sleep"};d.prototype.sleepTick=function(b){if(this.allowSleep){var f=this.sleepState,e=this.velocity.norm2()+this.angularVelocity.norm2(),g=Math.pow(this.sleepSpeedLimit,2);f===d.AWAKE&&e<g?(this.sleepState=d.SLEEPY,this.timeLastSleepy=b,this.dispatchEvent(d.sleepyEvent)):f===d.SLEEPY&&e>g?this.wakeUp():f===d.SLEEPY&&b-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(d.sleepEvent))}};d.prototype.updateSolveMassProperties=function(){this.sleepState===d.SLEEPING||this.type===
d.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))};d.prototype.pointToLocalFrame=function(b,d){d=d||new g;b.vsub(this.position,d);this.quaternion.conjugate().vmult(d,d);return d};d.prototype.vectorToLocalFrame=function(b,d){d=d||new g;this.quaternion.conjugate().vmult(b,d);return d};d.prototype.pointToWorldFrame=function(b,
d){d=d||new g;this.quaternion.vmult(b,d);d.vadd(this.position,d);return d};d.prototype.vectorToWorldFrame=function(b,d){d=d||new g;this.quaternion.vmult(b,d);return d};var l=new g,r=new m;d.prototype.addShape=function(b,d,f){var e=new g,l=new m;d&&e.copy(d);f&&l.copy(f);this.shapes.push(b);this.shapeOffsets.push(e);this.shapeOrientations.push(l);this.updateMassProperties();this.updateBoundingRadius();this.aabbNeedsUpdate=!0;return this};d.prototype.updateBoundingRadius=function(){for(var b=this.shapes,
d=this.shapeOffsets,f=b.length,e=0,g=0;g!==f;g++){var l=b[g];l.updateBoundingSphereRadius();var n=d[g].norm(),l=l.boundingSphereRadius;n+l>e&&(e=n+l)}this.boundingRadius=e};var s=new f;d.prototype.computeAABB=function(){for(var b=this.shapes,d=this.shapeOffsets,f=this.shapeOrientations,e=b.length,g=this.quaternion,n=this.aabb,j=0;j!==e;j++){var m=b[j];f[j].mult(g,r);r.vmult(d[j],l);l.vadd(this.position,l);m.calculateWorldAABB(l,r,s.lowerBound,s.upperBound);0===j?n.copy(s):n.extend(s)}this.aabbNeedsUpdate=
!1};var t=new p,u=new p;new p;d.prototype.updateInertiaWorld=function(b){var d=this.invInertia;d.x===d.y&&d.y===d.z&&!b||(t.setRotationFromQuaternion(this.quaternion),t.transpose(u),t.scale(d,t),t.mmult(u,this.invInertiaWorld))};var v=new g,z=new g;d.prototype.applyForce=function(b,f){this.type===d.DYNAMIC&&(f.vsub(this.position,v),v.cross(b,z),this.force.vadd(b,this.force),this.torque.vadd(z,this.torque))};var x=new g,B=new g;d.prototype.applyLocalForce=function(b,f){this.type===d.DYNAMIC&&(this.vectorToWorldFrame(b,
x),this.pointToWorldFrame(f,B),this.applyForce(x,B))};var A=new g,D=new g,H=new g;d.prototype.applyImpulse=function(b,f){this.type===d.DYNAMIC&&(f.vsub(this.position,A),D.copy(b),D.mult(this.invMass,D),this.velocity.vadd(D,this.velocity),A.cross(b,H),this.invInertiaWorld.vmult(H,H),this.angularVelocity.vadd(H,this.angularVelocity))};var y=new g,C=new g;d.prototype.applyLocalImpulse=function(b,f){this.type===d.DYNAMIC&&(this.vectorToWorldFrame(b,y),this.pointToWorldFrame(f,C),this.applyImpulse(y,C))};
var I=new g;d.prototype.updateMassProperties=function(){this.invMass=0<this.mass?1/this.mass:0;var b=this.inertia,d=this.fixedRotation;this.computeAABB();I.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2);n.calculateInertia(I,this.mass,b);this.invInertia.set(0<b.x&&!d?1/b.x:0,0<b.y&&!d?1/b.y:0,0<b.z&&!d?1/b.z:0);this.updateInertiaWorld(!0)};d.prototype.getVelocityAtWorldPoint=function(b,d){var f=
new g;b.vsub(this.position,f);this.angularVelocity.cross(f,d);this.velocity.vadd(d,d);return d}},{"../collision/AABB":3,"../material/Material":25,"../math/Mat3":27,"../math/Quaternion":28,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Shape":43,"../utils/EventTarget":49}],32:[function(b,e){function d(b){this.chassisBody=b.chassisBody;this.wheelInfos=[];this.sliding=!1;this.world=null;this.indexRightAxis="undefined"!==typeof b.indexRightAxis?b.indexRightAxis:1;this.indexForwardAxis="undefined"!==
typeof b.indexForwardAxis?b.indexForwardAxis:0;this.indexUpAxis="undefined"!==typeof b.indexUpAxis?b.indexUpAxis:2}function j(b,d,f){var e=H,g=y,l=C,n=I;d.vsub(b.position,e);e.cross(f,g);b.invInertiaWorld.vmult(g,n);n.cross(e,l);return b.invMass+f.dot(l)}b("./Body");var g=b("../math/Vec3"),p=b("../math/Quaternion");b("../collision/RaycastResult");var m=b("../collision/Ray"),f=b("../objects/WheelInfo");e.exports=d;new g;new g;new g;var n=new g,l=new g,r=new g;new m;d.prototype.addWheel=function(b){b=
b||{};b=new f(b);var d=this.wheelInfos.length;this.wheelInfos.push(b);return d};d.prototype.setSteeringValue=function(b,d){this.wheelInfos[d].steering=b};new g;d.prototype.applyEngineForce=function(b,d){this.wheelInfos[d].engineForce=b};d.prototype.setBrake=function(b,d){this.wheelInfos[d].brake=b};d.prototype.addToWorld=function(b){b.add(this.chassisBody);var d=this;this.preStepCallback=function(){d.updateVehicle(b.dt)};b.addEventListener("preStep",this.preStepCallback);this.world=b};d.prototype.getVehicleAxisWorld=
function(b,d){d.set(0===b?1:0,1===b?1:0,2===b?1:0);this.chassisBody.vectorToWorldFrame(d,d)};d.prototype.updateVehicle=function(b){for(var d=this.wheelInfos,f=d.length,e=this.chassisBody,l=0;l<f;l++)this.updateWheelTransform(l);this.currentVehicleSpeedKmHour=3.6*e.velocity.norm();l=new g;this.getVehicleAxisWorld(this.indexForwardAxis,l);0>l.dot(e.velocity)&&(this.currentVehicleSpeedKmHour*=-1);for(l=0;l<f;l++)this.castRay(d[l]);this.updateSuspension(b);for(var n=new g,j=new g,l=0;l<f;l++){var m=d[l],
r=m.suspensionForce;r>m.maxSuspensionForce&&(r=m.maxSuspensionForce);m.raycastResult.hitNormalWorld.scale(r*b,n);m.raycastResult.hitPointWorld.vsub(e.position,j);e.applyImpulse(n,m.raycastResult.hitPointWorld)}this.updateFriction(b);n=new g;j=new g;r=new g;for(l=0;l<f;l++){m=d[l];e.getVelocityAtWorldPoint(m.chassisConnectionPointWorld,r);var s=1;switch(this.indexUpAxis){case 1:s=-1}if(m.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,j);var p=j.dot(m.raycastResult.hitNormalWorld);m.raycastResult.hitNormalWorld.scale(p,
n);j.vsub(n,j);p=j.dot(r);m.deltaRotation=s*p*b/m.radius}if((m.sliding||!m.isInContact)&&0!==m.engineForce&&m.useCustomSlidingRotationalSpeed)m.deltaRotation=(0<m.engineForce?1:-1)*m.customSlidingRotationalSpeed*b;Math.abs(m.brake)>Math.abs(m.engineForce)&&(m.deltaRotation=0);m.rotation+=m.deltaRotation;m.deltaRotation*=0.99}};d.prototype.updateSuspension=function(){for(var b=this.chassisBody.mass,d=this.wheelInfos,f=d.length,e=0;e<f;e++){var g=d[e];if(g.isInContact){var l;l=g.suspensionStiffness*
(g.suspensionRestLength-g.suspensionLength)*g.clippedInvContactDotSuspension;var n=g.suspensionRelativeVelocity;l-=(0>n?g.dampingCompression:g.dampingRelaxation)*n;g.suspensionForce=l*b;0>g.suspensionForce&&(g.suspensionForce=0)}else g.suspensionForce=0}};d.prototype.removeFromWorld=function(b){b.remove(this.chassisBody);b.removeEventListener("preStep",this.preStepCallback);this.world=null};var s=new g,t=new g;d.prototype.castRay=function(b){this.updateWheelTransformWorld(b);var d=this.chassisBody,
f=-1;b.directionWorld.scale(b.suspensionRestLength+b.radius,s);var e=b.chassisConnectionPointWorld;e.vadd(s,t);var l=b.raycastResult;l.reset();var n=d.collisionResponse;d.collisionResponse=!1;this.world.rayTest(e,t,l);d.collisionResponse=n;e=l.body;b.raycastResult.groundObject=0;e?(f=l.distance,b.raycastResult.hitNormalWorld=l.hitNormalWorld,b.isInContact=!0,b.suspensionLength=l.distance-b.radius,l=b.suspensionRestLength-b.maxSuspensionTravel,e=b.suspensionRestLength+b.maxSuspensionTravel,b.suspensionLength<
l&&(b.suspensionLength=l),b.suspensionLength>e&&(b.suspensionLength=e,b.raycastResult.reset()),l=b.raycastResult.hitNormalWorld.dot(b.directionWorld),e=new g,d.getVelocityAtWorldPoint(b.raycastResult.hitPointWorld,e),d=b.raycastResult.hitNormalWorld.dot(e),-0.1<=l?(b.suspensionRelativeVelocity=0,b.clippedInvContactDotSuspension=10):(l=-1/l,b.suspensionRelativeVelocity=d*l,b.clippedInvContactDotSuspension=l)):(b.suspensionLength=b.suspensionRestLength+0*b.maxSuspensionTravel,b.suspensionRelativeVelocity=
0,b.directionWorld.scale(-1,b.raycastResult.hitNormalWorld),b.clippedInvContactDotSuspension=1);return f};d.prototype.updateWheelTransformWorld=function(b){b.isInContact=!1;var d=this.chassisBody;d.pointToWorldFrame(b.chassisConnectionPointLocal,b.chassisConnectionPointWorld);d.vectorToWorldFrame(b.directionLocal,b.directionWorld);d.vectorToWorldFrame(b.axleLocal,b.axleWorld)};d.prototype.updateWheelTransform=function(b){b=this.wheelInfos[b];this.updateWheelTransformWorld(b);b.directionLocal.scale(-1,
n);l.copy(b.axleLocal);n.cross(l,r);r.normalize();l.normalize();var d=b.steering,f=new p;f.setFromAxisAngle(n,d);d=new p;d.setFromAxisAngle(l,b.rotation);var e=b.worldTransform.quaternion;this.chassisBody.quaternion.mult(f,e);e.mult(d,e);e.normalize();f=b.worldTransform.position;f.copy(b.directionWorld);f.scale(b.suspensionLength,f);f.vadd(b.chassisConnectionPointWorld,f)};var u=[new g(1,0,0),new g(0,1,0),new g(0,0,1)];d.prototype.getWheelTransformWorld=function(b){return this.wheelInfos[b].worldTransform};
var v=new g,z=[],x=[];d.prototype.updateFriction=function(b){for(var d=this.wheelInfos,f=d.length,e=this.chassisBody,l=0,n=0;n<f;n++){var m=d[n],r=m.raycastResult.body;r&&l++;m.sideImpulse=0;m.forwardImpulse=0;x[n]||(x[n]=new g);z[n]||(z[n]=new g)}for(n=0;n<f;n++)if(m=d[n],r=m.raycastResult.body){var s=z[n];this.getWheelTransformWorld(n).vectorToWorldFrame(u[this.indexRightAxis],s);var l=m.raycastResult.hitNormalWorld,p=s.dot(l);l.scale(p,v);s.vsub(v,s);s.normalize();l.cross(s,x[n]);x[n].normalize();
l=m;var p=e,t=m.raycastResult.hitPointWorld,y=m.raycastResult.hitPointWorld,C=void 0;if(1.1<s.norm2())r=0;else{var C=M,I=P,fa=N;p.getVelocityAtWorldPoint(t,C);r.getVelocityAtWorldPoint(y,I);C.vsub(I,fa);r=C=-0.2*s.dot(fa)*(1/(p.invMass+r.invMass))}l.sideImpulse=r;m.sideImpulse*=1}this.sliding=!1;for(n=0;n<f;n++){m=d[n];r=m.raycastResult.body;p=0;m.slipInfo=1;if(r){var l=m.brake?m.brake:0,C=e,t=r,y=m.raycastResult.hitPointWorld,s=x[n],p=l,I=0,I=y,fa=B,oa=A,E=D;C.getVelocityAtWorldPoint(I,fa);t.getVelocityAtWorldPoint(I,
oa);fa.vsub(oa,E);I=s.dot(E);C=j(C,y,s);t=j(t,y,s);I=-I*(1/(C+t));p<I&&(I=p);I<-p&&(I=-p);p=I;p+=m.engineForce*b;l/=p;m.slipInfo*=l}m.forwardImpulse=0;m.skidInfo=1;r&&(m.skidInfo=1,r=m.suspensionForce*b*m.frictionSlip,l=r*r,m.forwardImpulse=p,p=0.5*m.forwardImpulse,t=1*m.sideImpulse,p=p*p+t*t,m.sliding=!1,p>l&&(this.sliding=!0,m.sliding=!0,l=r/Math.sqrt(p),m.skidInfo*=l))}if(this.sliding)for(n=0;n<f;n++)m=d[n],0!==m.sideImpulse&&1>m.skidInfo&&(m.forwardImpulse*=m.skidInfo,m.sideImpulse*=m.skidInfo);
for(n=0;n<f;n++)m=d[n],b=new g,b.copy(m.raycastResult.hitPointWorld),0!==m.forwardImpulse&&(r=new g,x[n].scale(m.forwardImpulse,r),e.applyImpulse(r,b)),0!==m.sideImpulse&&(r=m.raycastResult.body,l=new g,l.copy(m.raycastResult.hitPointWorld),p=new g,z[n].scale(m.sideImpulse,p),e.pointToLocalFrame(b,b),b["xyz"[this.indexUpAxis]]*=m.rollInfluence,e.pointToWorldFrame(b,b),e.applyImpulse(p,b),p.scale(-1,p),r.applyImpulse(p,l))};var B=new g,A=new g,D=new g,H=new g,y=new g,C=new g,I=new g,M=new g,P=new g,
N=new g},{"../collision/Ray":9,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Vec3":30,"../objects/WheelInfo":36,"./Body":31}],33:[function(b,e){function d(b){this.wheelBodies=[];this.coordinateSystem="undefined"===typeof b.coordinateSystem?new m(1,2,3):b.coordinateSystem.clone();this.chassisBody=b.chassisBody;this.chassisBody||(b=new p(new m(5,2,0.5)),this.chassisBody=new j(1,b));this.constraints=[];this.wheelAxes=[];this.wheelForces=[]}var j=b("./Body"),g=b("../shapes/Sphere"),
p=b("../shapes/Box"),m=b("../math/Vec3"),f=b("../constraints/HingeConstraint");e.exports=d;d.prototype.addWheel=function(b){b=b||{};var d=b.body;d||(d=new j(1,new g(1.2)));this.wheelBodies.push(d);this.wheelForces.push(0);new m;var e="undefined"!==typeof b.position?b.position.clone():new m,l=new m;this.chassisBody.pointToWorldFrame(e,l);d.position.set(l.x,l.y,l.z);b="undefined"!==typeof b.axis?b.axis.clone():new m(0,1,0);this.wheelAxes.push(b);d=new f(this.chassisBody,d,{pivotA:e,axisA:b,pivotB:m.ZERO,
axisB:b,collideConnected:!1});this.constraints.push(d);return this.wheelBodies.length-1};d.prototype.setSteeringValue=function(b,d){var f=this.wheelAxes[d],e=Math.cos(b),l=Math.sin(b),g=f.x,f=f.y;this.constraints[d].axisA.set(e*g-l*f,l*g+e*f,0)};d.prototype.setMotorSpeed=function(b,d){var f=this.constraints[d];f.enableMotor();f.motorTargetVelocity=b};d.prototype.disableMotor=function(b){this.constraints[b].disableMotor()};var n=new m;d.prototype.setWheelForce=function(b,d){this.wheelForces[d]=b};
d.prototype.applyWheelForce=function(b,d){var f=this.wheelBodies[d],e=f.torque;this.wheelAxes[d].scale(b,n);f.vectorToWorldFrame(n,n);e.vadd(n,e)};d.prototype.addToWorld=function(b){for(var d=this.constraints,f=this.wheelBodies.concat([this.chassisBody]),e=0;e<f.length;e++)b.add(f[e]);for(e=0;e<d.length;e++)b.addConstraint(d[e]);b.addEventListener("preStep",this._update.bind(this))};d.prototype._update=function(){for(var b=this.wheelForces,d=0;d<b.length;d++)this.applyWheelForce(b[d],d)};d.prototype.removeFromWorld=
function(b){for(var d=this.constraints,f=this.wheelBodies.concat([this.chassisBody]),e=0;e<f.length;e++)b.remove(f[e]);for(e=0;e<d.length;e++)b.removeConstraint(d[e])};var l=new m;d.prototype.getWheelSpeed=function(b){var d=this.wheelBodies[b].angularVelocity;this.chassisBody.vectorToWorldFrame(this.wheelAxes[b],l);return d.dot(l)}},{"../constraints/HingeConstraint":15,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Sphere":44,"./Body":31}],34:[function(b,e){function d(){this.particles=[];this.speedOfSound=
this.smoothingRadius=this.density=1;this.viscosity=0.01;this.eps=1E-6;this.pressures=[];this.densities=[];this.neighbors=[]}e.exports=d;b("../shapes/Shape");var j=b("../math/Vec3");b("../math/Quaternion");b("../shapes/Particle");b("../objects/Body");b("../material/Material");d.prototype.add=function(b){this.particles.push(b);this.neighbors.length<this.particles.length&&this.neighbors.push([])};d.prototype.remove=function(b){b=this.particles.indexOf(b);-1!==b&&(this.particles.splice(b,1),this.neighbors.length>
this.particles.length&&this.neighbors.pop())};var g=new j;d.prototype.getNeighbors=function(b,d){for(var f=this.particles.length,e=b.id,l=this.smoothingRadius*this.smoothingRadius,n=0;n!==f;n++){var j=this.particles[n];j.position.vsub(b.position,g);e!==j.id&&g.norm2()<l&&d.push(j)}};var p=new j,m=new j,f=new j,n=new j,l=new j,r=new j;d.prototype.update=function(){for(var b=this.particles.length,d=this.speedOfSound,e=this.eps,g=0;g!==b;g++){var j=this.particles[g],x=this.neighbors[g];x.length=0;this.getNeighbors(j,
x);x.push(this.particles[g]);for(var B=x.length,A=0,D=0;D!==B;D++){j.position.vsub(x[D].position,p);var H=p.norm(),H=this.w(H),A=A+x[D].mass*H}this.densities[g]=A;this.pressures[g]=d*d*(this.densities[g]-this.density)}for(g=0;g!==b;g++){d=this.particles[g];m.set(0,0,0);f.set(0,0,0);x=this.neighbors[g];B=x.length;for(D=0;D!==B;D++)A=x[D],d.position.vsub(A.position,l),H=l.norm(),j=-A.mass*(this.pressures[g]/(this.densities[g]*this.densities[g]+e)+this.pressures[D]/(this.densities[D]*this.densities[D]+
e)),this.gradw(l,n),n.mult(j,n),m.vadd(n,m),A.velocity.vsub(d.velocity,r),r.mult(1/(1E-4+this.densities[g]*this.densities[D])*this.viscosity*A.mass,r),j=this.nablaw(H),r.mult(j,r),f.vadd(r,f);f.mult(d.mass,f);m.mult(d.mass,m);d.force.vadd(f,d.force);d.force.vadd(m,d.force)}};d.prototype.w=function(b){var d=this.smoothingRadius;return 315/(64*Math.PI*Math.pow(d,9))*Math.pow(d*d-b*b,3)};d.prototype.gradw=function(b,d){var f=b.norm(),e=this.smoothingRadius;b.mult(945/(32*Math.PI*Math.pow(e,9))*Math.pow(e*
e-f*f,2),d)};d.prototype.nablaw=function(b){var d=this.smoothingRadius;return 945/(32*Math.PI*Math.pow(d,9))*(d*d-b*b)*(7*b*b-3*d*d)}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Particle":41,"../shapes/Shape":43}],35:[function(b,e){function d(b,d,f){f=f||{};this.restLength="number"===typeof f.restLength?f.restLength:1;this.stiffness=f.stiffness||100;this.damping=f.damping||1;this.bodyA=b;this.bodyB=d;this.localAnchorA=new j;this.localAnchorB=
new j;f.localAnchorA&&this.localAnchorA.copy(f.localAnchorA);f.localAnchorB&&this.localAnchorB.copy(f.localAnchorB);f.worldAnchorA&&this.setWorldAnchorA(f.worldAnchorA);f.worldAnchorB&&this.setWorldAnchorB(f.worldAnchorB)}var j=b("../math/Vec3");e.exports=d;d.prototype.setWorldAnchorA=function(b){this.bodyA.pointToLocalFrame(b,this.localAnchorA)};d.prototype.setWorldAnchorB=function(b){this.bodyB.pointToLocalFrame(b,this.localAnchorB)};d.prototype.getWorldAnchorA=function(b){this.bodyA.pointToWorldFrame(this.localAnchorA,
b)};d.prototype.getWorldAnchorB=function(b){this.bodyB.pointToWorldFrame(this.localAnchorB,b)};var g=new j,p=new j,m=new j,f=new j,n=new j,l=new j,r=new j,s=new j,t=new j,u=new j,v=new j;d.prototype.applyForce=function(){var b=this.stiffness,d=this.damping,e=this.restLength,j=this.bodyA,D=this.bodyB;this.getWorldAnchorA(n);this.getWorldAnchorB(l);n.vsub(j.position,r);l.vsub(D.position,s);l.vsub(n,g);var H=g.norm();p.copy(g);p.normalize();D.velocity.vsub(j.velocity,m);D.angularVelocity.cross(s,v);
m.vadd(v,m);j.angularVelocity.cross(r,v);m.vsub(v,m);p.mult(-b*(H-e)-d*m.dot(p),f);j.force.vsub(f,j.force);D.force.vadd(f,D.force);r.cross(f,t);s.cross(f,u);j.torque.vsub(t,j.torque);D.torque.vadd(u,D.torque)}},{"../math/Vec3":30}],36:[function(b,e){function d(b){b=m.defaults(b,{chassisConnectionPointLocal:new j,chassisConnectionPointWorld:new j,directionLocal:new j,directionWorld:new j,axleLocal:new j,axleWorld:new j,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,
dampingRelaxation:10,frictionSlip:1E4,steering:0,rotation:0,deltaRotation:0,rollInfluence:0.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-0.1});this.maxSuspensionTravel=b.maxSuspensionTravel;this.customSlidingRotationalSpeed=b.customSlidingRotationalSpeed;this.useCustomSlidingRotationalSpeed=b.useCustomSlidingRotationalSpeed;
this.sliding=!1;this.chassisConnectionPointLocal=b.chassisConnectionPointLocal.clone();this.chassisConnectionPointWorld=b.chassisConnectionPointWorld.clone();this.directionLocal=b.directionLocal.clone();this.directionWorld=b.directionWorld.clone();this.axleLocal=b.axleLocal.clone();this.axleWorld=b.axleWorld.clone();this.suspensionRestLength=b.suspensionRestLength;this.suspensionMaxLength=b.suspensionMaxLength;this.radius=b.radius;this.suspensionStiffness=b.suspensionStiffness;this.dampingCompression=
b.dampingCompression;this.dampingRelaxation=b.dampingRelaxation;this.frictionSlip=b.frictionSlip;this.deltaRotation=this.rotation=this.steering=0;this.rollInfluence=b.rollInfluence;this.maxSuspensionForce=b.maxSuspensionForce;this.brake=this.engineForce=0;this.isFrontWheel=b.isFrontWheel;this.clippedInvContactDotSuspension=1;this.forwardImpulse=this.sideImpulse=this.suspensionLength=this.skidInfo=this.suspensionForce=this.suspensionRelativeVelocity=0;this.raycastResult=new p;this.worldTransform=new g;
this.isInContact=!1}var j=b("../math/Vec3"),g=b("../math/Transform"),p=b("../collision/RaycastResult"),m=b("../utils/Utils");e.exports=d;var f=new j,n=new j,f=new j;d.prototype.updateWheel=function(b){var d=this.raycastResult;if(this.isInContact){var e=d.hitNormalWorld.dot(d.directionWorld);d.hitPointWorld.vsub(b.position,n);b.getVelocityAtWorldPoint(n,f);b=d.hitNormalWorld.dot(f);-0.1<=e?(this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=10):(e=-1/e,this.suspensionRelativeVelocity=
b*e,this.clippedInvContactDotSuspension=e)}else d.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,d.directionWorld.scale(-1,d.hitNormalWorld),this.clippedInvContactDotSuspension=1}},{"../collision/RaycastResult":10,"../math/Transform":29,"../math/Vec3":30,"../utils/Utils":53}],37:[function(b,e){function d(b){j.call(this);this.type=j.types.BOX;this.halfExtents=b;this.convexPolyhedronRepresentation=null;this.updateConvexPolyhedronRepresentation();this.updateBoundingSphereRadius()}
e.exports=d;var j=b("./Shape"),g=b("../math/Vec3"),p=b("./ConvexPolyhedron");d.prototype=new j;d.prototype.constructor=d;d.prototype.updateConvexPolyhedronRepresentation=function(){var b=this.halfExtents.x,d=this.halfExtents.y,f=this.halfExtents.z,b=[new g(-b,-d,-f),new g(b,-d,-f),new g(b,d,-f),new g(-b,d,-f),new g(-b,-d,f),new g(b,-d,f),new g(b,d,f),new g(-b,d,f)];new g(0,0,1);new g(0,1,0);new g(1,0,0);this.convexPolyhedronRepresentation=b=new p(b,[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,
3],[1,2,6,5]]);b.material=this.material};d.prototype.calculateLocalInertia=function(b,f){f=f||new g;d.calculateInertia(this.halfExtents,b,f);return f};d.calculateInertia=function(b,d,f){f.x=1/12*d*(4*b.y*b.y+4*b.z*b.z);f.y=1/12*d*(4*b.x*b.x+4*b.z*b.z);f.z=1/12*d*(4*b.y*b.y+4*b.x*b.x)};d.prototype.getSideNormals=function(b,d){var f=this.halfExtents;b[0].set(f.x,0,0);b[1].set(0,f.y,0);b[2].set(0,0,f.z);b[3].set(-f.x,0,0);b[4].set(0,-f.y,0);b[5].set(0,0,-f.z);if(void 0!==d)for(f=0;f!==b.length;f++)d.vmult(b[f],
b[f]);return b};d.prototype.volume=function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.halfExtents.norm()};var m=new g;new g;d.prototype.forEachWorldCorner=function(b,d,f){for(var e=this.halfExtents,e=[[e.x,e.y,e.z],[-e.x,e.y,e.z],[-e.x,-e.y,e.z],[-e.x,-e.y,-e.z],[e.x,-e.y,-e.z],[e.x,e.y,-e.z],[-e.x,e.y,-e.z],[e.x,-e.y,e.z]],g=0;g<e.length;g++)m.set(e[g][0],e[g][1],e[g][2]),d.vmult(m,m),b.vadd(m,
m),f(m.x,m.y,m.z)};var f=[new g,new g,new g,new g,new g,new g,new g,new g];d.prototype.calculateWorldAABB=function(b,d,e,g){var j=this.halfExtents;f[0].set(j.x,j.y,j.z);f[1].set(-j.x,j.y,j.z);f[2].set(-j.x,-j.y,j.z);f[3].set(-j.x,-j.y,-j.z);f[4].set(j.x,-j.y,-j.z);f[5].set(j.x,j.y,-j.z);f[6].set(-j.x,j.y,-j.z);f[7].set(j.x,-j.y,j.z);var m=f[0];d.vmult(m,m);b.vadd(m,m);g.copy(m);e.copy(m);for(j=1;8>j;j++){m=f[j];d.vmult(m,m);b.vadd(m,m);var p=m.x,z=m.y,m=m.z;p>g.x&&(g.x=p);z>g.y&&(g.y=z);m>g.z&&(g.z=
m);p<e.x&&(e.x=p);z<e.y&&(e.y=z);m<e.z&&(e.z=m)}}},{"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],38:[function(b,e){function d(b,d,f){j.call(this);this.type=j.types.CONVEXPOLYHEDRON;this.vertices=b||[];this.worldVertices=[];this.worldVerticesNeedsUpdate=!0;this.faces=d||[];this.faceNormals=[];this.computeNormals();this.worldFaceNormalsNeedsUpdate=!0;this.worldFaceNormals=[];this.uniqueEdges=[];this.uniqueAxes=f?f.slice():null;this.computeEdges();this.updateBoundingSphereRadius()}e.exports=
d;var j=b("./Shape"),g=b("../math/Vec3");b("../math/Quaternion");var p=b("../math/Transform");d.prototype=new j;d.prototype.constructor=d;var m=new g;d.prototype.computeEdges=function(){for(var b=this.faces,d=this.vertices,f=this.uniqueEdges,e=f.length=0;e!==b.length;e++)for(var g=b[e],l=g.length,j=0;j!==l;j++){d[g[j]].vsub(d[g[(j+1)%l]],m);m.normalize();for(var n=!1,r=0;r!==f.length;r++)if(f[r].almostEquals(m)||f[r].almostEquals(m)){n=!0;break}n||f.push(m.clone())}};d.prototype.computeNormals=function(){this.faceNormals.length=
this.faces.length;for(var b=0;b<this.faces.length;b++){for(var d=0;d<this.faces[b].length;d++)if(!this.vertices[this.faces[b][d]])throw Error("Vertex "+this.faces[b][d]+" not found!");d=this.faceNormals[b]||new g;this.getFaceNormal(b,d);d.negate(d);this.faceNormals[b]=d;if(0>d.dot(this.vertices[this.faces[b][0]])){console.error(".faceNormals["+b+"] = Vec3("+d.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");
for(d=0;d<this.faces[b].length;d++)console.warn(".vertices["+this.faces[b][d]+"] = Vec3("+this.vertices[this.faces[b][d]].toString()+")")}}};var f=new g,n=new g;d.computeNormal=function(b,d,e,g){d.vsub(b,n);e.vsub(d,f);f.cross(n,g);g.isZero()||g.normalize()};d.prototype.getFaceNormal=function(b,f){var e=this.faces[b];return d.computeNormal(this.vertices[e[0]],this.vertices[e[1]],this.vertices[e[2]],f)};var l=new g;d.prototype.clipAgainstHull=function(b,d,f,e,j,n,m,r,s){for(var p=-1,t=-Number.MAX_VALUE,
u=0;u<f.faces.length;u++){l.copy(f.faceNormals[u]);j.vmult(l,l);var v=l.dot(n);v>t&&(t=v,p=u)}for(var t=[],u=f.faces[p],v=u.length,y=0;y<v;y++){var z=f.vertices[u[y]],x=new g;x.copy(z);j.vmult(x,x);e.vadd(x,x);t.push(x)}0<=p&&this.clipFaceAgainstHull(n,b,d,t,m,r,s)};var r=new g,s=new g,t=new g,u=new g,v=new g,z=new g;d.prototype.findSeparatingAxis=function(b,d,f,e,g,l,j,n){var m=Number.MAX_VALUE,p=0;if(this.uniqueAxes)for(x=0;x!==this.uniqueAxes.length;x++){f.vmult(this.uniqueAxes[x],r);C=this.testSepAxis(r,
b,d,f,e,g);if(!1===C)return!1;C<m&&(m=C,l.copy(r))}else for(var y=j?j.length:this.faces.length,x=0;x<y;x++){C=j?j[x]:x;r.copy(this.faceNormals[C]);f.vmult(r,r);var C=this.testSepAxis(r,b,d,f,e,g);if(!1===C)return!1;C<m&&(m=C,l.copy(r))}if(b.uniqueAxes)for(x=0;x!==b.uniqueAxes.length;x++){g.vmult(b.uniqueAxes[x],s);p++;C=this.testSepAxis(s,b,d,f,e,g);if(!1===C)return!1;C<m&&(m=C,l.copy(s))}else{j=n?n.length:b.faces.length;for(x=0;x<j;x++){C=n?n[x]:x;s.copy(b.faceNormals[C]);g.vmult(s,s);p++;C=this.testSepAxis(s,
b,d,f,e,g);if(!1===C)return!1;C<m&&(m=C,l.copy(s))}}for(n=0;n!==this.uniqueEdges.length;n++){f.vmult(this.uniqueEdges[n],u);for(p=0;p!==b.uniqueEdges.length;p++)if(g.vmult(b.uniqueEdges[p],v),u.cross(v,z),!z.almostZero()){z.normalize();x=this.testSepAxis(z,b,d,f,e,g);if(!1===x)return!1;x<m&&(m=x,l.copy(z))}}e.vsub(d,t);0<t.dot(l)&&l.negate(l);return!0};var x=[],B=[];d.prototype.testSepAxis=function(b,f,e,g,l,j){d.project(this,b,e,g,x);d.project(f,b,l,j,B);e=x[0];b=x[1];f=B[0];g=B[1];if(e<g||f<b)return!1;
e-=g;b=f-b;return e<b?e:b};var A=new g,D=new g;d.prototype.calculateLocalInertia=function(b,d){this.computeLocalAABB(A,D);var f=D.x-A.x,e=D.y-A.y,g=D.z-A.z;d.x=1/12*b*(4*e*e+4*g*g);d.y=1/12*b*(4*f*f+4*g*g);d.z=1/12*b*(4*e*e+4*f*f)};d.prototype.getPlaneConstantOfFace=function(b){return-this.faceNormals[b].dot(this.vertices[this.faces[b][0]])};var H=new g,y=new g,C=new g,I=new g,M=new g,P=new g,N=new g,K=new g;d.prototype.clipFaceAgainstHull=function(b,d,f,e,g,l,j){for(var n=[],m=-1,r=Number.MAX_VALUE,
s=0;s<this.faces.length;s++){H.copy(this.faceNormals[s]);f.vmult(H,H);var p=H.dot(b);p<r&&(r=p,m=s)}if(!(0>m)){b=this.faces[m];b.connectedFaces=[];for(r=0;r<this.faces.length;r++)for(s=0;s<this.faces[r].length;s++)-1!==b.indexOf(this.faces[r][s])&&(r!==m&&-1===b.connectedFaces.indexOf(r))&&b.connectedFaces.push(r);r=b.length;for(s=0;s<r;s++){p=this.vertices[b[s]];p.vsub(this.vertices[b[(s+1)%r]],y);C.copy(y);f.vmult(C,C);d.vadd(C,C);I.copy(this.faceNormals[m]);f.vmult(I,I);d.vadd(I,I);C.cross(I,M);
M.negate(M);P.copy(p);f.vmult(P,P);d.vadd(P,P);P.dot(M);p=b.connectedFaces[s];N.copy(this.faceNormals[p]);p=this.getPlaneConstantOfFace(p);K.copy(N);f.vmult(K,K);p-=K.dot(d);for(this.clipFaceAgainstPlane(e,n,K,p);e.length;)e.shift();for(;n.length;)e.push(n.shift())}N.copy(this.faceNormals[m]);p=this.getPlaneConstantOfFace(m);K.copy(N);f.vmult(K,K);p-=K.dot(d);for(r=0;r<e.length;r++)d=K.dot(e[r])+p,d<=g&&(console.log("clamped: depth="+d+" to minDist="+(g+"")),d=g),d<=l&&(f=e[r],0>=d&&j.push({point:f,
normal:K,depth:d}))}};d.prototype.clipFaceAgainstPlane=function(b,d,f,e){var l,j,n=b.length;if(2>n)return d;var m=b[b.length-1],r=b[0];l=f.dot(m)+e;for(var s=0;s<n;s++){r=b[s];j=f.dot(r)+e;if(0>l){if(0>j){var p=new g;p.copy(r)}else p=new g,m.lerp(r,l/(l-j),p);d.push(p)}else 0>j&&(p=new g,m.lerp(r,l/(l-j),p),d.push(p),d.push(r));m=r;l=j}return d};d.prototype.computeWorldVertices=function(b,d){for(var f=this.vertices.length;this.worldVertices.length<f;)this.worldVertices.push(new g);for(var e=this.vertices,
l=this.worldVertices,j=0;j!==f;j++)d.vmult(e[j],l[j]),b.vadd(l[j],l[j]);this.worldVerticesNeedsUpdate=!1};new g;d.prototype.computeLocalAABB=function(b,d){var f=this.vertices.length,e=this.vertices;b.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);d.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var g=0;g<f;g++){var l=e[g];l.x<b.x?b.x=l.x:l.x>d.x&&(d.x=l.x);l.y<b.y?b.y=l.y:l.y>d.y&&(d.y=l.y);l.z<b.z?b.z=l.z:l.z>d.z&&(d.z=l.z)}};d.prototype.computeWorldFaceNormals=function(b){for(var d=
this.faceNormals.length;this.worldFaceNormals.length<d;)this.worldFaceNormals.push(new g);for(var f=this.faceNormals,e=this.worldFaceNormals,l=0;l!==d;l++)b.vmult(f[l],e[l]);this.worldFaceNormalsNeedsUpdate=!1};d.prototype.updateBoundingSphereRadius=function(){for(var b=0,d=this.vertices,f=0,e=d.length;f!==e;f++){var g=d[f].norm2();g>b&&(b=g)}this.boundingSphereRadius=Math.sqrt(b)};var W=new g;d.prototype.calculateWorldAABB=function(b,d,f,e){for(var g=this.vertices.length,l=this.vertices,j,n,m,r,
s,p,t=0;t<g;t++){W.copy(l[t]);d.vmult(W,W);b.vadd(W,W);var u=W;if(u.x<j||void 0===j)j=u.x;else if(u.x>r||void 0===r)r=u.x;if(u.y<n||void 0===n)n=u.y;else if(u.y>s||void 0===s)s=u.y;if(u.z<m||void 0===m)m=u.z;else if(u.z>p||void 0===p)p=u.z}f.set(j,n,m);e.set(r,s,p)};d.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3};d.prototype.getAveragePointLocal=function(b){b=b||new g;for(var d=this.vertices.length,f=this.vertices,e=0;e<d;e++)b.vadd(f[e],b);b.mult(1/d,b);return b};d.prototype.transformAllPoints=
function(b,d){var f=this.vertices.length,e=this.vertices;if(d){for(var g=0;g<f;g++){var l=e[g];d.vmult(l,l)}for(g=0;g<this.faceNormals.length;g++)l=this.faceNormals[g],d.vmult(l,l)}if(b)for(g=0;g<f;g++)l=e[g],l.vadd(b,l)};var ea=new g,F=new g,J=new g;d.prototype.pointIsInside=function(b){var d=this.vertices.length,f=this.vertices,e=this.faces,g=this.faceNormals,l=this.faces.length;this.getAveragePointLocal(ea);for(var j=0;j<l;j++){var d=g[j],n=f[e[j][0]],m=F;b.vsub(n,m);var m=d.dot(m),r=J;ea.vsub(n,
r);d=d.dot(r);if(0>m&&0<d||0<m&&0>d)return!1}return-1};new g;var ia=new g,T=new g;d.project=function(b,d,f,e,g){var l=b.vertices.length,j=0,n=0;b=b.vertices;T.setZero();p.vectorToLocalFrame(f,e,d,ia);p.pointToLocalFrame(f,e,T,T);d=T.dot(ia);n=j=b[0].dot(ia);for(f=1;f<l;f++)e=b[f].dot(ia),e>j&&(j=e),e<n&&(n=e);n-=d;j-=d;n>j&&(l=n,n=j,j=l);g[0]=j;g[1]=n}},{"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"./Shape":43}],39:[function(b,e){function d(b,d,e,l){var r=[],s=[],t=[],u=[],v=
[],z=Math.cos,x=Math.sin;r.push(new g(d*z(0),d*x(0),0.5*-e));u.push(0);r.push(new g(b*z(0),b*x(0),0.5*e));v.push(1);for(var B=0;B<l;B++){var A=2*Math.PI/l*(B+1),D=2*Math.PI/l*(B+0.5);B<l-1?(r.push(new g(d*z(A),d*x(A),0.5*-e)),u.push(2*B+2),r.push(new g(b*z(A),b*x(A),0.5*e)),v.push(2*B+3),t.push([2*B+2,2*B+3,2*B+1,2*B])):t.push([0,1,2*B+1,2*B]);(1===l%2||B<l/2)&&s.push(new g(z(D),x(D),0))}t.push(v);s.push(new g(0,0,1));b=[];for(B=0;B<u.length;B++)b.push(u[u.length-B-1]);t.push(b);this.type=j.types.CONVEXPOLYHEDRON;
p.call(this,r,t,s)}e.exports=d;var j=b("./Shape"),g=b("../math/Vec3");b("../math/Quaternion");var p=b("./ConvexPolyhedron");d.prototype=new p},{"../math/Quaternion":28,"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],40:[function(b,e){function d(b,d){d=m.defaults(d,{maxValue:null,minValue:null,elementSize:1});this.data=b;this.maxValue=d.maxValue;this.minValue=d.minValue;this.elementSize=d.elementSize;null===d.minValue&&this.updateMinValue();null===d.maxValue&&this.updateMaxValue();this.cacheEnabled=
!0;j.call(this);this.pillarConvex=new g;this.pillarOffset=new p;this.type=j.types.HEIGHTFIELD;this.updateBoundingSphereRadius();this._cachedPillars={}}var j=b("./Shape"),g=b("./ConvexPolyhedron"),p=b("../math/Vec3"),m=b("../utils/Utils");e.exports=d;d.prototype=new j;d.prototype.update=function(){this._cachedPillars={}};d.prototype.updateMinValue=function(){for(var b=this.data,d=b[0][0],e=0;e!==b.length;e++)for(var g=0;g!==b[e].length;g++){var j=b[e][g];j<d&&(d=j)}this.minValue=d};d.prototype.updateMaxValue=
function(){for(var b=this.data,d=b[0][0],e=0;e!==b.length;e++)for(var g=0;g!==b[e].length;g++){var j=b[e][g];j>d&&(d=j)}this.maxValue=d};d.prototype.setHeightValueAtIndex=function(b,d,e){this.data[b][d]=e;this.clearCachedConvexTrianglePillar(b,d,!1);0<b&&(this.clearCachedConvexTrianglePillar(b-1,d,!0),this.clearCachedConvexTrianglePillar(b-1,d,!1));0<d&&(this.clearCachedConvexTrianglePillar(b,d-1,!0),this.clearCachedConvexTrianglePillar(b,d-1,!1));0<d&&0<b&&this.clearCachedConvexTrianglePillar(b-
1,d-1,!0)};d.prototype.getRectMinMax=function(b,d,e,g,j){j=j||[];for(var m=this.data,p=this.minValue;b<=e;b++)for(var v=d;v<=g;v++){var z=m[b][v];z>p&&(p=z)}j[0]=this.minValue;j[1]=p};d.prototype.getIndexOfPosition=function(b,d,e,g){var j=this.elementSize,m=this.data;b=Math.floor(b/j);d=Math.floor(d/j);e[0]=b;e[1]=d;g&&(0>b&&(b=0),0>d&&(d=0),b>=m.length-1&&(b=m.length-1),d>=m[0].length-1&&(d=m[0].length-1));return 0>b||0>d||b>=m.length-1||d>=m[0].length-1?!1:!0};d.prototype.getHeightAt=function(b,
d,e){var g=[];this.getIndexOfPosition(b,d,g,e);b=[];this.getRectMinMax(g[0],g[1]+1,g[0],g[1]+1,b);return(b[0]+b[1])/2};d.prototype.getCacheConvexTrianglePillarKey=function(b,d,e){return b+"_"+d+"_"+(e?1:0)};d.prototype.getCachedConvexTrianglePillar=function(b,d,e){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(b,d,e)]};d.prototype.setCachedConvexTrianglePillar=function(b,d,e,g,j){this._cachedPillars[this.getCacheConvexTrianglePillarKey(b,d,e)]={convex:g,offset:j}};d.prototype.clearCachedConvexTrianglePillar=
function(b,d,e){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(b,d,e)]};d.prototype.getConvexTrianglePillar=function(b,d,e){var j=this.pillarConvex,m=this.pillarOffset;if(this.cacheEnabled){var t=this.getCachedConvexTrianglePillar(b,d,e);if(t){this.pillarConvex=t.convex;this.pillarOffset=t.offset;return}j=new g;m=new p;this.pillarConvex=j;this.pillarOffset=m}var t=this.data,u=this.elementSize,v=j.faces;j.vertices.length=6;for(var z=0;6>z;z++)j.vertices[z]||(j.vertices[z]=new p);v.length=
5;for(z=0;5>z;z++)v[z]||(v[z]=[]);var z=j.vertices,x=(Math.min(t[b][d],t[b+1][d],t[b][d+1],t[b+1][d+1])-this.minValue)/2+this.minValue;e?(m.set((b+0.75)*u,(d+0.75)*u,x),z[0].set(0.25*u,0.25*u,t[b+1][d+1]-x),z[1].set(-0.75*u,0.25*u,t[b][d+1]-x),z[2].set(0.25*u,-0.75*u,t[b+1][d]-x),z[3].set(0.25*u,0.25*u,-x-1),z[4].set(-0.75*u,0.25*u,-x-1),z[5].set(0.25*u,-0.75*u,-x-1),v[0][0]=0,v[0][1]=1,v[0][2]=2,v[1][0]=5,v[1][1]=4,v[1][2]=3,v[2][0]=2,v[2][1]=5,v[2][2]=3,v[2][3]=0,v[3][0]=3,v[3][1]=4,v[3][2]=1,v[3][3]=
0,v[4][0]=1,v[4][1]=4,v[4][2]=5,v[4][3]=2):(m.set((b+0.25)*u,(d+0.25)*u,x),z[0].set(-0.25*u,-0.25*u,t[b][d]-x),z[1].set(0.75*u,-0.25*u,t[b+1][d]-x),z[2].set(-0.25*u,0.75*u,t[b][d+1]-x),z[3].set(-0.25*u,-0.25*u,-x-1),z[4].set(0.75*u,-0.25*u,-x-1),z[5].set(-0.25*u,0.75*u,-x-1),v[0][0]=0,v[0][1]=1,v[0][2]=2,v[1][0]=5,v[1][1]=4,v[1][2]=3,v[2][0]=0,v[2][1]=2,v[2][2]=5,v[2][3]=3,v[3][0]=1,v[3][1]=0,v[3][2]=3,v[3][3]=4,v[4][0]=4,v[4][1]=5,v[4][2]=2,v[4][3]=1);j.computeNormals();j.computeEdges();j.updateBoundingSphereRadius();
this.setCachedConvexTrianglePillar(b,d,e,j,m)};d.prototype.calculateLocalInertia=function(b,d){d=d||new p;d.set(0,0,0);return d};d.prototype.volume=function(){return Number.MAX_VALUE};d.prototype.calculateWorldAABB=function(b,d,e,g){e.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);g.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)};d.prototype.updateBoundingSphereRadius=function(){var b=this.data,d=this.elementSize;this.boundingSphereRadius=(new p(b.length*d,b[0].length*d,Math.max(Math.abs(this.maxValue),
Math.abs(this.minValue)))).norm()}},{"../math/Vec3":30,"../utils/Utils":53,"./ConvexPolyhedron":38,"./Shape":43}],41:[function(b,e){function d(){j.call(this);this.type=j.types.PARTICLE}e.exports=d;var j=b("./Shape"),g=b("../math/Vec3");d.prototype=new j;d.prototype.constructor=d;d.prototype.calculateLocalInertia=function(b,d){d=d||new g;d.set(0,0,0);return d};d.prototype.volume=function(){return 0};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=0};d.prototype.calculateWorldAABB=
function(b,d,f,e){f.copy(b);e.copy(b)}},{"../math/Vec3":30,"./Shape":43}],42:[function(b,e){function d(){j.call(this);this.type=j.types.PLANE;this.worldNormal=new g;this.worldNormalNeedsUpdate=!0;this.boundingSphereRadius=Number.MAX_VALUE}e.exports=d;var j=b("./Shape"),g=b("../math/Vec3");d.prototype=new j;d.prototype.constructor=d;d.prototype.computeWorldNormal=function(b){var d=this.worldNormal;d.set(0,0,1);b.vmult(d,d);this.worldNormalNeedsUpdate=!1};d.prototype.calculateLocalInertia=function(b,
d){return d=d||new g};d.prototype.volume=function(){return Number.MAX_VALUE};var p=new g;d.prototype.calculateWorldAABB=function(b,d,e,g){p.set(0,0,1);d.vmult(p,p);d=Number.MAX_VALUE;e.set(-d,-d,-d);g.set(d,d,d);1===p.x&&(g.x=b.x);1===p.y&&(g.y=b.y);1===p.z&&(g.z=b.z);-1===p.x&&(e.x=b.x);-1===p.y&&(e.y=b.y);-1===p.z&&(e.z=b.z)};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=Number.MAX_VALUE}},{"../math/Vec3":30,"./Shape":43}],43:[function(b,e){function d(){this.id=d.idCounter++;
this.boundingSphereRadius=this.type=0;this.collisionResponse=!0;this.material=null}e.exports=d;d=b("./Shape");b("../math/Vec3");b("../math/Quaternion");b("../material/Material");d.prototype.constructor=d;d.prototype.updateBoundingSphereRadius=function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type;};d.prototype.volume=function(){throw"volume() not implemented for shape type "+this.type;};d.prototype.calculateLocalInertia=function(){throw"calculateLocalInertia() not implemented for shape type "+
this.type;};d.idCounter=0;d.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"./Shape":43}],44:[function(b,e){function d(b){j.call(this);this.radius=void 0!==b?Number(b):1;this.type=j.types.SPHERE;if(0>this.radius)throw Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}e.exports=d;var j=b("./Shape"),g=b("../math/Vec3");d.prototype=new j;
d.prototype.constructor=d;d.prototype.calculateLocalInertia=function(b,d){d=d||new g;var f=2*b*this.radius*this.radius/5;d.x=f;d.y=f;d.z=f;return d};d.prototype.volume=function(){return 4*Math.PI*this.radius/3};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.radius};d.prototype.calculateWorldAABB=function(b,d,f,e){d=this.radius;for(var g=["x","y","z"],j=0;j<g.length;j++){var s=g[j];f[s]=b[s]-d;e[s]=b[s]+d}}},{"../math/Vec3":30,"./Shape":43}],45:[function(b,e){function d(b,
d){j.call(this);this.type=j.types.TRIMESH;this.vertices=new Float32Array(b);this.indices=new Int16Array(d);this.normals=new Float32Array(d.length);this.aabb=new m;this.edges=null;this.scale=new g(1,1,1);this.tree=new f;this.updateEdges();this.updateNormals();this.updateAABB();this.updateBoundingSphereRadius();this.updateTree()}e.exports=d;var j=b("./Shape"),g=b("../math/Vec3");b("../math/Quaternion");var p=b("../math/Transform"),m=b("../collision/AABB"),f=b("../utils/Octree");d.prototype=new j;d.prototype.constructor=
d;var n=new g;d.prototype.updateTree=function(){var b=this.tree;b.reset();b.aabb.copy(this.aabb);var d=this.scale;b.aabb.lowerBound.x*=1/d.x;b.aabb.lowerBound.y*=1/d.y;b.aabb.lowerBound.z*=1/d.z;b.aabb.upperBound.x*=1/d.x;b.aabb.upperBound.y*=1/d.y;b.aabb.upperBound.z*=1/d.z;for(var d=new m,f=new g,e=new g,j=new g,l=[f,e,j],n=0;n<this.indices.length/3;n++){var r=3*n;this._getUnscaledVertex(this.indices[r],f);this._getUnscaledVertex(this.indices[r+1],e);this._getUnscaledVertex(this.indices[r+2],j);
d.setFromPoints(l);b.insert(d,n)}b.removeEmptyNodes()};var l=new m;d.prototype.getTrianglesInAABB=function(b,d){l.copy(b);var f=this.scale,e=f.x,g=f.y,f=f.z,j=l.lowerBound,n=l.upperBound;j.x/=e;j.y/=g;j.z/=f;n.x/=e;n.y/=g;n.z/=f;return this.tree.aabbQuery(l,d)};d.prototype.setScale=function(b){var d=b.x===b.y===b.z;this.scale.x===this.scale.y===this.scale.z&&d||this.updateNormals();this.scale.copy(b);this.updateAABB();this.updateBoundingSphereRadius()};d.prototype.updateNormals=function(){for(var b=
this.normals,f=0;f<this.indices.length/3;f++){var e=3*f,g=this.indices[e+1],j=this.indices[e+2];this.getVertex(this.indices[e],v);this.getVertex(g,z);this.getVertex(j,x);d.computeNormal(z,v,x,n);b[e]=n.x;b[e+1]=n.y;b[e+2]=n.z}};d.prototype.updateEdges=function(){for(var b={},d=function(){b[g<j?g+"_"+j:j+"_"+g]=!0},f=0;f<this.indices.length/3;f++){var e=3*f,g=this.indices[e],j=this.indices[e+1],e=this.indices[e+2];d(g,j);d(j,e);d(e,g)}d=Object.keys(b);this.edges=new Int16Array(2*d.length);for(f=0;f<
d.length;f++)e=d[f].split("_"),this.edges[2*f]=parseInt(e[0],10),this.edges[2*f+1]=parseInt(e[1],10)};d.prototype.getEdgeVertex=function(b,d,f){this.getVertex(this.edges[2*b+(d?1:0)],f)};var r=new g,s=new g;d.prototype.getEdgeVector=function(b,d){this.getEdgeVertex(b,0,r);this.getEdgeVertex(b,1,s);s.vsub(r,d)};var t=new g,u=new g;d.computeNormal=function(b,d,f,e){d.vsub(b,u);f.vsub(d,t);t.cross(u,e);e.isZero()||e.normalize()};var v=new g,z=new g,x=new g;d.prototype.getVertex=function(b,d){var f=this.scale;
this._getUnscaledVertex(b,d);d.x*=f.x;d.y*=f.y;d.z*=f.z;return d};d.prototype._getUnscaledVertex=function(b,d){var f=3*b,e=this.vertices;return d.set(e[f],e[f+1],e[f+2])};d.prototype.getWorldVertex=function(b,d,f,e){this.getVertex(b,e);p.pointToWorldFrame(d,f,e,e);return e};d.prototype.getTriangleVertices=function(b,d,f,e){b*=3;this.getVertex(this.indices[b],d);this.getVertex(this.indices[b+1],f);this.getVertex(this.indices[b+2],e)};d.prototype.getNormal=function(b,d){var f=3*b;return d.set(this.normals[f],
this.normals[f+1],this.normals[f+2])};var B=new m;d.prototype.calculateLocalInertia=function(b,d){this.computeLocalAABB(B);var f=B.upperBound.x-B.lowerBound.x,e=B.upperBound.y-B.lowerBound.y,g=B.upperBound.z-B.lowerBound.z;return d.set(1/12*b*(4*e*e+4*g*g),1/12*b*(4*f*f+4*g*g),1/12*b*(4*e*e+4*f*f))};var A=new g;d.prototype.computeLocalAABB=function(b){var d=b.lowerBound;b=b.upperBound;var f=this.vertices.length;this.getVertex(0,A);d.copy(A);b.copy(A);for(var e=0;e!==f;e++)this.getVertex(e,A),A.x<
d.x?d.x=A.x:A.x>b.x&&(b.x=A.x),A.y<d.y?d.y=A.y:A.y>b.y&&(b.y=A.y),A.z<d.z?d.z=A.z:A.z>b.z&&(b.z=A.z)};d.prototype.updateAABB=function(){this.computeLocalAABB(this.aabb)};d.prototype.updateBoundingSphereRadius=function(){for(var b=0,d=this.vertices,f=new g,e=0,d=d.length/3;e!==d;e++){this.getVertex(e,f);var j=f.norm2();j>b&&(b=j)}this.boundingSphereRadius=Math.sqrt(b)};new g;var D=new p,H=new m;d.prototype.calculateWorldAABB=function(b,d,f,e){D.position=b;D.quaternion=d;this.aabb.toWorldFrame(D,H);
f.copy(H.lowerBound);e.copy(H.upperBound)};d.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3};d.createTorus=function(b,f,e,g,j){b=b||1;f=f||0.5;e=e||8;g=g||6;j=j||2*Math.PI;for(var l=[],n=[],m=0;m<=e;m++)for(var r=0;r<=g;r++){var s=r/g*j,p=2*m/e*Math.PI,t=(b+f*Math.cos(p))*Math.cos(s),s=(b+f*Math.cos(p))*Math.sin(s),p=f*Math.sin(p);l.push(t,s,p)}for(m=1;m<=e;m++)for(r=1;r<=g;r++)b=(g+1)*(m-1)+r-1,f=(g+1)*(m-1)+r,j=(g+1)*m+r,n.push((g+1)*m+r-1,b,j),n.push(b,f,j);return new d(l,
n)}},{"../collision/AABB":3,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../utils/Octree":50,"./Shape":43}],46:[function(b,e){function d(){j.call(this);this.iterations=10;this.tolerance=1E-7}e.exports=d;b("../math/Vec3");b("../math/Quaternion");var j=b("./Solver");d.prototype=new j;var g=[],p=[],m=[];d.prototype.solve=function(b,d){var e=0,j=this.iterations,s=this.tolerance*this.tolerance,t=this.equations,u=t.length,v=d.bodies,z=v.length,x,B,A,D,H;if(0!==u)for(A=0;A!==z;A++)v[A].updateSolveMassProperties();
p.length=u;m.length=u;g.length=u;for(A=0;A!==u;A++){var y=t[A];g[A]=0;m[A]=y.computeB(b);p[A]=1/y.computeC()}if(0!==u){for(A=0;A!==z;A++)y=v[A],e=y.wlambda,y.vlambda.set(0,0,0),e&&e.set(0,0,0);for(e=0;e!==j;e++){for(var C=A=0;C!==u;C++)y=t[C],x=m[C],B=p[C],H=g[C],D=y.computeGWlambda(),x=B*(x-D-y.eps*H),H+x<y.minForce?x=y.minForce-H:H+x>y.maxForce&&(x=y.maxForce-H),g[C]+=x,A+=0<x?x:-x,y.addToWlambda(x);if(A*A<s)break}for(A=0;A!==z;A++)y=v[A],j=y.velocity,s=y.angularVelocity,j.vadd(y.vlambda,j),s&&
s.vadd(y.wlambda,s)}return e}},{"../math/Quaternion":28,"../math/Vec3":30,"./Solver":47}],47:[function(b,e){function d(){this.equations=[]}e.exports=d;d.prototype.solve=function(){return 0};d.prototype.addEquation=function(b){b.enabled&&this.equations.push(b)};d.prototype.removeEquation=function(b){var d=this.equations;b=d.indexOf(b);-1!==b&&d.splice(b,1)};d.prototype.removeAllEquations=function(){this.equations.length=0}},{}],48:[function(b,e){function d(b){m.call(this);this.iterations=10;this.tolerance=
1E-7;this.subsolver=b;this.nodes=[];for(this.nodePool=[];128>this.nodePool.length;)this.nodePool.push(this.createNode())}function j(b){for(var d=b.length,f=0;f!==d;f++){var e=b[f];if(!e.visited&&!(e.body.type&s))return e}return!1}function g(b,d,f){d.push(b.body);d=b.eqs.length;for(var e=0;e!==d;e++){var g=b.eqs[e];-1===f.indexOf(g)&&f.push(g)}}function p(b,d){return d.id-b.id}e.exports=d;b("../math/Vec3");b("../math/Quaternion");var m=b("./Solver"),f=b("../objects/Body");d.prototype=new m;var n=[],
l=[],r={bodies:[]},s=f.STATIC,t=[];d.prototype.createNode=function(){return{body:null,children:[],eqs:[],visited:!1}};d.prototype.solve=function(b,d){for(var f=this.nodePool,e=d.bodies,m=this.equations,s=m.length,D=e.length,H=this.subsolver;f.length<D;)f.push(this.createNode());n.length=D;for(var y=0;y<D;y++)n[y]=f[y];for(y=0;y!==D;y++)f=n[y],f.body=e[y],f.children.length=0,f.eqs.length=0,f.visited=!1;for(D=0;D!==s;D++){var f=m[D],y=e.indexOf(f.bi),C=e.indexOf(f.bj),y=n[y],C=n[C];y.children.push(C);
y.eqs.push(f);C.children.push(y);C.eqs.push(f)}e=0;m=l;H.tolerance=this.tolerance;for(H.iterations=this.iterations;y=j(n);){m.length=0;r.bodies.length=0;f=y;y=g;s=r.bodies;D=m;t.push(f);f.visited=!0;for(y(f,s,D);t.length;)for(f=t.pop();C=j(f.children);)C.visited=!0,y(C,s,D),t.push(C);s=m.length;m=m.sort(p);for(y=0;y!==s;y++)H.addEquation(m[y]);H.solve(b,r);H.removeAllEquations();e++}return e}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"./Solver":47}],49:[function(b,e){var d=
function(){};e.exports=d;d.prototype={constructor:d,addEventListener:function(b,d){void 0===this._listeners&&(this._listeners={});var e=this._listeners;void 0===e[b]&&(e[b]=[]);-1===e[b].indexOf(d)&&e[b].push(d);return this},hasEventListener:function(b,d){if(void 0===this._listeners)return!1;var e=this._listeners;return void 0!==e[b]&&-1!==e[b].indexOf(d)?!0:!1},removeEventListener:function(b,d){if(void 0===this._listeners)return this;var e=this._listeners;if(void 0===e[b])return this;var m=e[b].indexOf(d);
-1!==m&&e[b].splice(m,1);return this},dispatchEvent:function(b){if(void 0===this._listeners)return this;var d=this._listeners[b.type];if(void 0!==d){b.target=this;for(var e=0,m=d.length;e<m;e++)d[e].call(this,b)}return this}}},{}],50:[function(b,e){function d(b){b=b||{};this.root=b.root||null;this.aabb=b.aabb?b.aabb.clone():new g;this.data=[];this.children=[]}function j(b,f){f=f||{};f.root=null;f.aabb=b;d.call(this,f);this.maxDepth="undefined"!==typeof f.maxDepth?f.maxDepth:8}var g=b("../collision/AABB"),
p=b("../math/Vec3");e.exports=j;j.prototype=new d;d.prototype.reset=function(){this.children.length=this.data.length=0};d.prototype.insert=function(b,d,f){var e=this.data;f=f||0;if(!this.aabb.contains(b))return!1;var g=this.children;if(f<(this.maxDepth||this.root.maxDepth)){var j=!1;g.length||(this.subdivide(),j=!0);for(var m=0;8!==m;m++)if(g[m].insert(b,d,f+1))return!0;j&&(g.length=0)}e.push(d);return!0};var m=new p;d.prototype.subdivide=function(){var b=this.aabb,f=b.lowerBound,e=b.upperBound,b=
this.children;b.push(new d({aabb:new g({lowerBound:new p(0,0,0)})}),new d({aabb:new g({lowerBound:new p(1,0,0)})}),new d({aabb:new g({lowerBound:new p(1,1,0)})}),new d({aabb:new g({lowerBound:new p(1,1,1)})}),new d({aabb:new g({lowerBound:new p(0,1,1)})}),new d({aabb:new g({lowerBound:new p(0,0,1)})}),new d({aabb:new g({lowerBound:new p(1,0,1)})}),new d({aabb:new g({lowerBound:new p(0,1,0)})}));e.vsub(f,m);m.scale(0.5,m);for(var e=this.root||this,j=0;8!==j;j++){var t=b[j];t.root=e;var u=t.aabb.lowerBound;
u.x*=m.x;u.y*=m.y;u.z*=m.z;u.vadd(f,u);u.vadd(m,t.aabb.upperBound)}};d.prototype.aabbQuery=function(b,d){for(var f=[this];f.length;){var e=f.pop();e.aabb.overlaps(b)&&Array.prototype.push.apply(d,e.data);Array.prototype.push.apply(f,e.children)}return d};var f=new g;d.prototype.rayQuery=function(b,d,e){b.getAABB(f);f.toLocalFrame(d,f);this.aabbQuery(f,e);return e};d.prototype.removeEmptyNodes=function(){for(var b=[this];b.length;){for(var d=b.pop(),f=d.children.length-1;0<=f;f--)d.children[f].data.length||
d.children.splice(f,1);Array.prototype.push.apply(b,d.children)}}},{"../collision/AABB":3,"../math/Vec3":30}],51:[function(b,e){function d(){this.objects=[];this.type=Object}e.exports=d;d.prototype.release=function(){for(var b=arguments.length,d=0;d!==b;d++)this.objects.push(arguments[d])};d.prototype.get=function(){return 0===this.objects.length?this.constructObject():this.objects.pop()};d.prototype.constructObject=function(){throw Error("constructObject() not implemented in this Pool subclass yet!");
}},{}],52:[function(b,e){function d(){this.data={keys:[]}}e.exports=d;d.prototype.get=function(b,d){if(b>d){var e=d;d=b;b=e}return this.data[b+"-"+d]};d.prototype.set=function(b,d,e){if(b>d){var m=d;d=b;b=m}m=b+"-"+d;this.get(b,d)||this.data.keys.push(m);this.data[m]=e};d.prototype.reset=function(){for(var b=this.data,d=b.keys;0<d.length;){var e=d.pop();delete b[e]}}},{}],53:[function(b,e){function d(){}e.exports=d;d.defaults=function(b,d){b=b||{};for(var e in d)e in b||(b[e]=d[e]);return b}},{}],
54:[function(b,e){function d(){g.call(this);this.type=j}e.exports=d;var j=b("../math/Vec3"),g=b("./Pool");d.prototype=new g;d.prototype.constructObject=function(){return new j}},{"../math/Vec3":30,"./Pool":51}],55:[function(b,e){function d(b){this.contactPointPool=[];this.frictionEquationPool=[];this.result=[];this.frictionResult=[];this.v3pool=new l;this.world=b;this.currentContactMaterial=null;this.enableFrictionReduction=!1}e.exports=d;var j=b("../collision/AABB"),g=b("../shapes/Shape"),p=b("../collision/Ray"),
m=b("../math/Vec3"),f=b("../math/Transform");b("../shapes/ConvexPolyhedron");var n=b("../math/Quaternion");b("../solver/Solver");var l=b("../utils/Vec3Pool"),r=b("../equations/ContactEquation"),s=b("../equations/FrictionEquation");d.prototype.createContactEquation=function(b,d,f,e,g,j){var l;this.contactPointPool.length?(l=this.contactPointPool.pop(),l.bi=b,l.bj=d):l=new r(b,d);l.enabled=b.collisionResponse&&d.collisionResponse&&f.collisionResponse&&e.collisionResponse;var n=this.currentContactMaterial;
l.restitution=n.restitution;l.setSpookParams(n.contactEquationStiffness,n.contactEquationRelaxation,this.world.dt);b=f.material||b.material;d=e.material||d.material;b&&(d&&0<=b.restitution&&0<=d.restitution)&&(l.restitution=b.restitution*d.restitution);l.si=g||f;l.sj=j||e;return l};d.prototype.createFrictionEquationsFromContact=function(b,d){var f=b.bi,e=b.bj,g=this.world,j=this.currentContactMaterial,l=j.friction,n=b.si.material||f.material,m=b.sj.material||e.material;n&&(m&&0<=n.friction&&0<=m.friction)&&
(l=n.friction*m.friction);if(0<l){l*=g.gravity.length();n=f.invMass+e.invMass;0<n&&(n=1/n);var r=this.frictionEquationPool,m=r.length?r.pop():new s(f,e,l*n),r=r.length?r.pop():new s(f,e,l*n);m.bi=r.bi=f;m.bj=r.bj=e;m.minForce=r.minForce=-l*n;m.maxForce=r.maxForce=l*n;m.ri.copy(b.ri);m.rj.copy(b.rj);r.ri.copy(b.ri);r.rj.copy(b.rj);b.ni.tangents(m.t,r.t);m.setSpookParams(j.frictionEquationStiffness,j.frictionEquationRelaxation,g.dt);r.setSpookParams(j.frictionEquationStiffness,j.frictionEquationRelaxation,
g.dt);m.enabled=r.enabled=b.enabled;d.push(m,r);return!0}return!1};var t=new m,u=new m,v=new m;d.prototype.createFrictionFromAverage=function(b){var d=this.result[this.result.length-1];if(this.createFrictionEquationsFromContact(d,this.frictionResult)&&1!==b){var f=this.frictionResult[this.frictionResult.length-2],e=this.frictionResult[this.frictionResult.length-1];t.setZero();u.setZero();v.setZero();for(var g=d.bi,j=0;j!==b;j++)d=this.result[this.result.length-1-j],d.bodyA!==g?(t.vadd(d.ni,t),u.vadd(d.ri,
u),v.vadd(d.rj,v)):(t.vsub(d.ni,t),u.vadd(d.rj,u),v.vadd(d.ri,v));b=1/b;u.scale(b,f.ri);v.scale(b,f.rj);e.ri.copy(f.ri);e.rj.copy(f.rj);t.normalize();t.tangents(f.t,e.t)}};var z=new m,x=new m,B=new n,A=new n;d.prototype.getContacts=function(b,d,f,e,g,j,l){this.contactPointPool=g;this.frictionEquationPool=l;this.result=e;this.frictionResult=j;e=0;for(g=b.length;e!==g;e++){j=b[e];l=d[e];var n=null;j.material&&l.material&&(n=f.getContactMaterial(j.material,l.material)||null);for(var m=0;m<j.shapes.length;m++){j.quaternion.mult(j.shapeOrientations[m],
B);j.quaternion.vmult(j.shapeOffsets[m],z);z.vadd(j.position,z);for(var r=j.shapes[m],s=0;s<l.shapes.length;s++){l.quaternion.mult(l.shapeOrientations[s],A);l.quaternion.vmult(l.shapeOffsets[s],x);x.vadd(l.position,x);var q=l.shapes[s];if(!(z.distanceTo(x)>r.boundingSphereRadius+q.boundingSphereRadius)){var p=null;r.material&&q.material&&(p=f.getContactMaterial(r.material,q.material)||null);this.currentContactMaterial=p||n||f.defaultContactMaterial;(p=this[r.type|q.type])&&(r.type<q.type?p.call(this,
r,q,z,x,B,A,j,l,r,q):p.call(this,q,r,x,z,A,B,l,j,r,q))}}}}};d.prototype[g.types.BOX|g.types.BOX]=d.prototype.boxBox=function(b,d,f,e,g,j,l,n){b.convexPolyhedronRepresentation.material=b.material;d.convexPolyhedronRepresentation.material=d.material;b.convexPolyhedronRepresentation.collisionResponse=b.collisionResponse;d.convexPolyhedronRepresentation.collisionResponse=d.collisionResponse;this.convexConvex(b.convexPolyhedronRepresentation,d.convexPolyhedronRepresentation,f,e,g,j,l,n,b,d)};d.prototype[g.types.BOX|
g.types.CONVEXPOLYHEDRON]=d.prototype.boxConvex=function(b,d,f,e,g,j,l,n){b.convexPolyhedronRepresentation.material=b.material;b.convexPolyhedronRepresentation.collisionResponse=b.collisionResponse;this.convexConvex(b.convexPolyhedronRepresentation,d,f,e,g,j,l,n,b,d)};d.prototype[g.types.BOX|g.types.PARTICLE]=d.prototype.boxParticle=function(b,d,f,e,g,j,l,n){b.convexPolyhedronRepresentation.material=b.material;b.convexPolyhedronRepresentation.collisionResponse=b.collisionResponse;this.convexParticle(b.convexPolyhedronRepresentation,
d,f,e,g,j,l,n,b,d)};d.prototype[g.types.SPHERE]=d.prototype.sphereSphere=function(b,d,f,e,g,j,l,n){g=this.createContactEquation(l,n,b,d);e.vsub(f,g.ni);g.ni.normalize();g.ri.copy(g.ni);g.rj.copy(g.ni);g.ri.mult(b.radius,g.ri);g.rj.mult(-d.radius,g.rj);g.ri.vadd(f,g.ri);g.ri.vsub(l.position,g.ri);g.rj.vadd(e,g.rj);g.rj.vsub(n.position,g.rj);this.result.push(g);this.createFrictionEquationsFromContact(g,this.frictionResult)};var D=new m,H=new m,y=new m;d.prototype[g.types.PLANE|g.types.TRIMESH]=d.prototype.planeTrimesh=
function(b,d,e,g,j,l,n,r){var s=new m;D.set(0,0,1);j.vmult(D,D);for(j=0;j<d.vertices.length/3;j++){d.getVertex(j,s);var q=new m;q.copy(s);f.pointToWorldFrame(g,l,q,s);q=H;s.vsub(e,q);if(0>=D.dot(q)){var p=this.createContactEquation(n,r,b,d);p.ni.copy(D);var t=y;D.scale(q.dot(D),t);s.vsub(t,t);p.ri.copy(t);p.ri.vsub(n.position,p.ri);p.rj.copy(s);p.rj.vsub(r.position,p.rj);this.result.push(p);this.createFrictionEquationsFromContact(p,this.frictionResult)}}};var C=new m,I=new m;new m;var M=new m,P=new m,
N=new m,K=new m,W=new m,ea=new m,F=new m,J=new m,ia=new m,T=new m,L=new m,U=new j,S=[];d.prototype[g.types.SPHERE|g.types.TRIMESH]=d.prototype.sphereTrimesh=function(b,d,e,g,j,l,n,m){f.pointToLocalFrame(g,l,e,F);j=b.radius;U.lowerBound.set(F.x-j,F.y-j,F.z-j);U.upperBound.set(F.x+j,F.y+j,F.z+j);d.getTrianglesInAABB(U,S);var r=b.radius*b.radius;for(j=0;j<S.length;j++)for(var s=0;3>s;s++)if(d.getVertex(d.indices[3*S[j]+s],M),M.vsub(F,I),I.norm2()<=r){P.copy(M);f.pointToWorldFrame(g,l,P,M);M.vsub(e,I);
var q=this.createContactEquation(n,m,b,d);q.ni.copy(I);q.ni.normalize();q.ri.copy(q.ni);q.ri.scale(b.radius,q.ri);q.ri.vadd(e,q.ri);q.ri.vsub(n.position,q.ri);q.rj.copy(M);q.rj.vsub(m.position,q.rj);this.result.push(q);this.createFrictionEquationsFromContact(q,this.frictionResult)}for(j=0;j<S.length;j++)for(s=0;3>s;s++)d.getVertex(d.indices[3*S[j]+s],N),d.getVertex(d.indices[3*S[j]+(s+1)%3],K),K.vsub(N,W),F.vsub(K,J),e=J.dot(W),F.vsub(N,J),q=J.dot(W),0<q&&0>e&&(F.vsub(N,J),ea.copy(W),ea.normalize(),
q=J.dot(ea),ea.scale(q,J),J.vadd(N,J),e=J.distanceTo(F),e<b.radius&&(q=this.createContactEquation(n,m,b,d),J.vsub(F,q.ni),q.ni.normalize(),q.ni.scale(b.radius,q.ri),f.pointToWorldFrame(g,l,J,J),J.vsub(m.position,q.rj),f.vectorToWorldFrame(l,q.ni,q.ni),f.vectorToWorldFrame(l,q.ri,q.ri),this.result.push(q),this.createFrictionEquationsFromContact(q,this.frictionResult)));j=0;for(s=S.length;j!==s;j++)d.getTriangleVertices(S[j],ia,T,L),d.getNormal(S[j],C),F.vsub(ia,J),e=J.dot(C),C.scale(e,J),F.vsub(J,
J),e=J.distanceTo(F),p.pointInTriangle(J,ia,T,L)&&e<b.radius&&(q=this.createContactEquation(n,m,b,d),J.vsub(F,q.ni),q.ni.normalize(),q.ni.scale(b.radius,q.ri),f.pointToWorldFrame(g,l,J,J),J.vsub(m.position,q.rj),f.vectorToWorldFrame(l,q.ni,q.ni),f.vectorToWorldFrame(l,q.ri,q.ri),this.result.push(q),this.createFrictionEquationsFromContact(q,this.frictionResult));S.length=0};var aa=new m,ba=new m;d.prototype[g.types.SPHERE|g.types.PLANE]=d.prototype.spherePlane=function(b,d,f,e,g,j,l,n){d=this.createContactEquation(l,
n,b,d);d.ni.set(0,0,1);j.vmult(d.ni,d.ni);d.ni.negate(d.ni);d.ni.normalize();d.ni.mult(b.radius,d.ri);f.vsub(e,aa);d.ni.mult(d.ni.dot(aa),ba);aa.vsub(ba,d.rj);-aa.dot(d.ni)<=b.radius&&(b=d.ri,j=d.rj,b.vadd(f,b),b.vsub(l.position,b),j.vadd(e,j),j.vsub(n.position,j),this.result.push(d),this.createFrictionEquationsFromContact(d,this.frictionResult))};var la=new m,qa=new m,fa=new m,oa=new m,E=new m,V=new m,ha=new m,G=[new m,new m,new m,new m,new m,new m],Xa=new m,pa=new m,Ia=new m,Oa=new m;d.prototype[g.types.SPHERE|
g.types.BOX]=d.prototype.sphereBox=function(b,d,f,e,g,j,l,n){g=this.v3pool;f.vsub(e,oa);d.getSideNormals(G,j);j=b.radius;for(var m=!1,r=null,q=0,s=0,p=0,t=null,u=0,v=G.length;u!==v&&!1===m;u++){var x=E;x.copy(G[u]);var z=x.norm();x.normalize();var y=oa.dot(x);if(y<z+j&&0<y){var F=V,A=ha;F.copy(G[(u+1)%3]);A.copy(G[(u+2)%3]);var B=F.norm(),D=A.norm();F.normalize();A.normalize();var J=oa.dot(F),C=oa.dot(A);if(J<B&&(J>-B&&C<D&&C>-D)&&(y=Math.abs(y-z-j),null===t||y<t))t=y,s=J,p=C,r=z,pa.copy(x),Ia.copy(F),
Oa.copy(A),q++}}q&&(m=!0,q=this.createContactEquation(l,n,b,d),pa.mult(-j,q.ri),q.ni.copy(pa),q.ni.negate(q.ni),pa.mult(r,pa),Ia.mult(s,Ia),pa.vadd(Ia,pa),Oa.mult(p,Oa),pa.vadd(Oa,q.rj),q.ri.vadd(f,q.ri),q.ri.vsub(l.position,q.ri),q.rj.vadd(e,q.rj),q.rj.vsub(n.position,q.rj),this.result.push(q),this.createFrictionEquationsFromContact(q,this.frictionResult));y=g.get();for(r=0;2!==r&&!m;r++)for(s=0;2!==s&&!m;s++)for(p=0;2!==p&&!m;p++)y.set(0,0,0),r?y.vadd(G[0],y):y.vsub(G[0],y),s?y.vadd(G[1],y):y.vsub(G[1],
y),p?y.vadd(G[2],y):y.vsub(G[2],y),e.vadd(y,Xa),Xa.vsub(f,Xa),Xa.norm2()<j*j&&(m=!0,q=this.createContactEquation(l,n,b,d),q.ri.copy(Xa),q.ri.normalize(),q.ni.copy(q.ri),q.ri.mult(j,q.ri),q.rj.copy(y),q.ri.vadd(f,q.ri),q.ri.vsub(l.position,q.ri),q.rj.vadd(e,q.rj),q.rj.vsub(n.position,q.rj),this.result.push(q),this.createFrictionEquationsFromContact(q,this.frictionResult));g.release(y);t=g.get();u=g.get();q=g.get();v=g.get();y=g.get();x=G.length;for(r=0;r!==x&&!m;r++)for(s=0;s!==x&&!m;s++)if(r%3!==
s%3){G[s].cross(G[r],t);t.normalize();G[r].vadd(G[s],u);q.copy(f);q.vsub(u,q);q.vsub(e,q);z=q.dot(t);t.mult(z,v);for(p=0;p===r%3||p===s%3;)p++;y.copy(f);y.vsub(v,y);y.vsub(u,y);y.vsub(e,y);z=Math.abs(z);F=y.norm();z<G[p].norm()&&F<j&&(m=!0,p=this.createContactEquation(l,n,b,d),u.vadd(v,p.rj),p.rj.copy(p.rj),y.negate(p.ni),p.ni.normalize(),p.ri.copy(p.rj),p.ri.vadd(e,p.ri),p.ri.vsub(f,p.ri),p.ri.normalize(),p.ri.mult(j,p.ri),p.ri.vadd(f,p.ri),p.ri.vsub(l.position,p.ri),p.rj.vadd(e,p.rj),p.rj.vsub(n.position,
p.rj),this.result.push(p),this.createFrictionEquationsFromContact(p,this.frictionResult))}g.release(t,u,q,v,y)};var Va=new m,cb=new m,vb=new m,db=new m,wb=new m,Lb=new m,ca=new m,q=new m,Mb=new m,Nb=new m;d.prototype[g.types.SPHERE|g.types.CONVEXPOLYHEDRON]=d.prototype.sphereConvex=function(b,d,f,e,g,j,l,n){g=this.v3pool;f.vsub(e,Va);for(var m=d.faceNormals,r=d.faces,s=d.vertices,p=b.radius,t=0;t!==s.length;t++){var u=wb;j.vmult(s[t],u);e.vadd(u,u);var v=db;u.vsub(f,v);if(v.norm2()<p*p){b=this.createContactEquation(l,
n,b,d);b.ri.copy(v);b.ri.normalize();b.ni.copy(b.ri);b.ri.mult(p,b.ri);u.vsub(e,b.rj);b.ri.vadd(f,b.ri);b.ri.vsub(l.position,b.ri);b.rj.vadd(e,b.rj);b.rj.vsub(n.position,b.rj);this.result.push(b);this.createFrictionEquationsFromContact(b,this.frictionResult);return}}t=0;for(u=r.length;t!==u;t++){var v=r[t],y=Lb;j.vmult(m[t],y);var x=ca;j.vmult(s[v[0]],x);x.vadd(e,x);var z=q;y.mult(-p,z);f.vadd(z,z);var F=Mb;z.vsub(x,F);z=F.dot(y);F=Nb;f.vsub(x,F);if(0>z&&0<F.dot(y)){for(var x=[],F=0,E=v.length;F!==
E;F++){var A=g.get();j.vmult(s[v[F]],A);e.vadd(A,A);x.push(A)}a:{for(var F=x,E=y,A=f,B=null,J=F.length,D=0;D!==J;D++){var C=F[D],V=la;F[(D+1)%J].vsub(C,V);var U=qa;V.cross(E,U);V=fa;A.vsub(C,V);C=U.dot(V);if(null===B||0<C&&!0===B||0>=C&&!1===B)null===B&&(B=0<C);else{F=!1;break a}}F=!0}if(F){b=this.createContactEquation(l,n,b,d);y.mult(-p,b.ri);y.negate(b.ni);d=g.get();y.mult(-z,d);j=g.get();y.mult(-p,j);f.vsub(e,b.rj);b.rj.vadd(j,b.rj);b.rj.vadd(d,b.rj);b.rj.vadd(e,b.rj);b.rj.vsub(n.position,b.rj);
b.ri.vadd(f,b.ri);b.ri.vsub(l.position,b.ri);g.release(d);g.release(j);this.result.push(b);this.createFrictionEquationsFromContact(b,this.frictionResult);F=0;for(v=x.length;F!==v;F++)g.release(x[F]);break}else for(F=0;F!==v.length;F++){y=g.get();z=g.get();j.vmult(s[v[(F+1)%v.length]],y);j.vmult(s[v[(F+2)%v.length]],z);e.vadd(y,y);e.vadd(z,z);J=cb;z.vsub(y,J);B=vb;J.unit(B);E=g.get();A=g.get();f.vsub(y,A);D=A.dot(B);B.mult(D,E);E.vadd(y,E);B=g.get();E.vsub(f,B);if(0<D&&D*D<J.norm2()&&B.norm2()<p*p){b=
this.createContactEquation(l,n,b,d);E.vsub(e,b.rj);E.vsub(f,b.ni);b.ni.normalize();b.ni.mult(p,b.ri);b.rj.vadd(e,b.rj);b.rj.vsub(n.position,b.rj);b.ri.vadd(f,b.ri);b.ri.vsub(l.position,b.ri);this.result.push(b);this.createFrictionEquationsFromContact(b,this.frictionResult);F=0;for(v=x.length;F!==v;F++)g.release(x[F]);g.release(y);g.release(z);g.release(E);g.release(B);g.release(A);return}g.release(y);g.release(z);g.release(E);g.release(B);g.release(A)}F=0;for(v=x.length;F!==v;F++)g.release(x[F])}}};
new m;new m;d.prototype[g.types.PLANE|g.types.BOX]=d.prototype.planeBox=function(b,d,f,e,g,j,l,n){d.convexPolyhedronRepresentation.material=d.material;d.convexPolyhedronRepresentation.collisionResponse=d.collisionResponse;this.planeConvex(b,d.convexPolyhedronRepresentation,f,e,g,j,l,n)};var Da=new m,Ja=new m,va=new m,lb=new m;d.prototype[g.types.PLANE|g.types.CONVEXPOLYHEDRON]=d.prototype.planeConvex=function(b,d,f,e,g,j,l,n){Ja.set(0,0,1);g.vmult(Ja,Ja);for(var m=g=0;m!==d.vertices.length;m++)if(Da.copy(d.vertices[m]),
j.vmult(Da,Da),e.vadd(Da,Da),Da.vsub(f,va),0>=Ja.dot(va)){var r=this.createContactEquation(l,n,b,d),q=lb;Ja.mult(Ja.dot(va),q);Da.vsub(q,q);q.vsub(f,r.ri);r.ni.copy(Ja);Da.vsub(e,r.rj);r.ri.vadd(f,r.ri);r.ri.vsub(l.position,r.ri);r.rj.vadd(e,r.rj);r.rj.vsub(n.position,r.rj);this.result.push(r);g++;this.enableFrictionReduction||this.createFrictionEquationsFromContact(r,this.frictionResult)}this.enableFrictionReduction&&g&&this.createFrictionFromAverage(g)};var Y=new m,Ra=new m;d.prototype[g.types.CONVEXPOLYHEDRON]=
d.prototype.convexConvex=function(b,d,f,e,g,j,l,n,m,r,q,s){if(!(f.distanceTo(e)>b.boundingSphereRadius+d.boundingSphereRadius)&&b.findSeparatingAxis(d,f,g,e,j,Y,q,s)){q=[];b.clipAgainstHull(f,g,d,e,j,Y,-100,100,q);for(j=g=0;j!==q.length;j++){s=this.createContactEquation(l,n,b,d,m,r);var p=s.ri,t=s.rj;Y.negate(s.ni);q[j].normal.negate(Ra);Ra.mult(q[j].depth,Ra);q[j].point.vadd(Ra,p);t.copy(q[j].point);p.vsub(f,p);t.vsub(e,t);p.vadd(f,p);p.vsub(l.position,p);t.vadd(e,t);t.vsub(n.position,t);this.result.push(s);
g++;this.enableFrictionReduction||this.createFrictionEquationsFromContact(s,this.frictionResult)}this.enableFrictionReduction&&g&&this.createFrictionFromAverage(g)}};var ja=new m,sa=new m,Sa=new m;d.prototype[g.types.PLANE|g.types.PARTICLE]=d.prototype.planeParticle=function(b,d,f,e,g,j,l,n){ja.set(0,0,1);l.quaternion.vmult(ja,ja);e.vsub(l.position,sa);0>=ja.dot(sa)&&(b=this.createContactEquation(n,l,d,b),b.ni.copy(ja),b.ni.negate(b.ni),b.ri.set(0,0,0),ja.mult(ja.dot(e),Sa),e.vsub(Sa,Sa),b.rj.copy(Sa),
this.result.push(b),this.createFrictionEquationsFromContact(b,this.frictionResult))};var Ka=new m;d.prototype[g.types.PARTICLE|g.types.SPHERE]=d.prototype.sphereParticle=function(b,d,f,e,g,j,l,n){Ka.set(0,0,1);e.vsub(f,Ka);Ka.norm2()<=b.radius*b.radius&&(d=this.createContactEquation(n,l,d,b),Ka.normalize(),d.rj.copy(Ka),d.rj.mult(b.radius,d.rj),d.ni.copy(Ka),d.ni.negate(d.ni),d.ri.set(0,0,0),this.result.push(d),this.createFrictionEquationsFromContact(d,this.frictionResult))};var zb=new n,Ta=new m;
new m;var eb=new m,Fa=new m,Ea=new m;d.prototype[g.types.PARTICLE|g.types.CONVEXPOLYHEDRON]=d.prototype.convexParticle=function(b,d,f,e,g,j,l,n){var m=-1;j=null;var r=0;Ta.copy(e);Ta.vsub(f,Ta);g.conjugate(zb);zb.vmult(Ta,Ta);if(b.pointIsInside(Ta)){b.worldVerticesNeedsUpdate&&b.computeWorldVertices(f,g);b.worldFaceNormalsNeedsUpdate&&b.computeWorldFaceNormals(g);g=0;for(var q=b.faces.length;g!==q;g++){var s=b.worldFaceNormals[g];e.vsub(b.worldVertices[b.faces[g][0]],Fa);var p=-s.dot(Fa);if(null===
j||Math.abs(p)<Math.abs(j))j=p,m=g,eb.copy(s),r++}-1!==m?(b=this.createContactEquation(n,l,d,b),eb.mult(j,Ea),Ea.vadd(e,Ea),Ea.vsub(f,Ea),b.rj.copy(Ea),eb.negate(b.ni),b.ri.set(0,0,0),d=b.ri,j=b.rj,d.vadd(e,d),d.vsub(n.position,d),j.vadd(f,j),j.vsub(l.position,j),this.result.push(b),this.createFrictionEquationsFromContact(b,this.frictionResult)):console.warn("Point found inside convex, but did not find penetrating face!")}};d.prototype[g.types.BOX|g.types.HEIGHTFIELD]=d.prototype.boxHeightfield=function(b,
d,f,e,g,j,l,n){b.convexPolyhedronRepresentation.material=b.material;b.convexPolyhedronRepresentation.collisionResponse=b.collisionResponse;this.convexHeightfield(b.convexPolyhedronRepresentation,d,f,e,g,j,l,n)};var Ga=new m,za=new m,Ya=[0];d.prototype[g.types.CONVEXPOLYHEDRON|g.types.HEIGHTFIELD]=d.prototype.convexHeightfield=function(b,d,e,g,j,l,n,m){var r=d.data,q=d.elementSize,s=b.boundingSphereRadius;f.pointToLocalFrame(g,l,e,Ga);var p=Math.floor((Ga.x-s)/q)-1,t=Math.ceil((Ga.x+s)/q)+1,u=Math.floor((Ga.y-
s)/q)-1,q=Math.ceil((Ga.y+s)/q)+1;if(!(0>t||0>q||p>r.length||u>r[0].length)){0>p&&(p=0);0>t&&(t=0);0>u&&(u=0);0>q&&(q=0);p>=r.length&&(p=r.length-1);t>=r.length&&(t=r.length-1);q>=r[0].length&&(q=r[0].length-1);u>=r[0].length&&(u=r[0].length-1);r=[];d.getRectMinMax(p,u,t,q,r);var v=r[0];if(!(Ga.z-s>r[1]||Ga.z+s<v))for(s=p;s<t;s++)for(p=u;p<q;p++)d.getConvexTrianglePillar(s,p,!1),f.pointToWorldFrame(g,l,d.pillarOffset,za),e.distanceTo(za)<d.pillarConvex.boundingSphereRadius+b.boundingSphereRadius&&
this.convexConvex(b,d.pillarConvex,e,za,j,l,n,m,null,null,Ya,null),d.getConvexTrianglePillar(s,p,!0),f.pointToWorldFrame(g,l,d.pillarOffset,za),e.distanceTo(za)<d.pillarConvex.boundingSphereRadius+b.boundingSphereRadius&&this.convexConvex(b,d.pillarConvex,e,za,j,l,n,m,null,null,Ya,null)}};var Aa=new m,Ba=new m;d.prototype[g.types.SPHERE|g.types.HEIGHTFIELD]=d.prototype.sphereHeightfield=function(b,d,e,g,j,l,n,m){var r=d.data,q=b.radius,s=d.elementSize;f.pointToLocalFrame(g,l,e,Aa);var p=Math.floor((Aa.x-
q)/s)-1,t=Math.ceil((Aa.x+q)/s)+1,u=Math.floor((Aa.y-q)/s)-1,s=Math.ceil((Aa.y+q)/s)+1;if(!(0>t||0>s||p>r.length||s>r[0].length)){0>p&&(p=0);0>t&&(t=0);0>u&&(u=0);0>s&&(s=0);p>=r.length&&(p=r.length-1);t>=r.length&&(t=r.length-1);s>=r[0].length&&(s=r[0].length-1);u>=r[0].length&&(u=r[0].length-1);r=[];d.getRectMinMax(p,u,t,s,r);var v=r[0];if(!(Aa.z-q>r[1]||Aa.z+q<v))for(q=this.result;p<t;p++)for(r=u;r<s;r++)if(v=q.length,d.getConvexTrianglePillar(p,r,!1),f.pointToWorldFrame(g,l,d.pillarOffset,Ba),
e.distanceTo(Ba)<d.pillarConvex.boundingSphereRadius+b.boundingSphereRadius&&this.sphereConvex(b,d.pillarConvex,e,Ba,j,l,n,m),d.getConvexTrianglePillar(p,r,!0),f.pointToWorldFrame(g,l,d.pillarOffset,Ba),e.distanceTo(Ba)<d.pillarConvex.boundingSphereRadius+b.boundingSphereRadius&&this.sphereConvex(b,d.pillarConvex,e,Ba,j,l,n,m),2<q.length-v)return}}},{"../collision/AABB":3,"../collision/Ray":9,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../math/Quaternion":28,"../math/Transform":29,
"../math/Vec3":30,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43,"../solver/Solver":47,"../utils/Vec3Pool":54}],56:[function(b,e){function d(){f.apply(this);this.dt=-1;this.allowSleep=!1;this.contacts=[];this.frictionEquations=[];this.quatNormalizeSkip=0;this.quatNormalizeFast=!1;this.stepnumber=this.time=0;this.default_dt=1/60;this.nextId=0;this.gravity=new j;this.broadphase=new x;this.bodies=[];this.solver=new p;this.constraints=[];this.narrowphase=new m(this);this.collisionMatrix=new n;this.collisionMatrixPrevious=
new n;this.materials=[];this.contactmaterials=[];this.contactMaterialTable=new t;this.defaultMaterial=new l("default");this.defaultContactMaterial=new r(this.defaultMaterial,this.defaultMaterial,{friction:0.3,restitution:0});this.doProfiling=!1;this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0};this.subsystems=[];this.addBodyEvent={type:"addBody",body:null};this.removeBodyEvent={type:"removeBody",body:null}}e.exports=d;b("../shapes/Shape");var j=b("../math/Vec3"),
g=b("../math/Quaternion"),p=b("../solver/GSSolver");b("../utils/Vec3Pool");b("../equations/ContactEquation");b("../equations/FrictionEquation");var m=b("./Narrowphase"),f=b("../utils/EventTarget"),n=b("../collision/ArrayCollisionMatrix"),l=b("../material/Material"),r=b("../material/ContactMaterial"),s=b("../objects/Body"),t=b("../utils/TupleDictionary"),u=b("../collision/RaycastResult"),v=b("../collision/AABB"),z=b("../collision/Ray"),x=b("../collision/NaiveBroadphase");d.prototype=new f;new v;var B=
new z;d.prototype.getContactMaterial=function(b,d){return this.contactMaterialTable.get(b.id,d.id)};d.prototype.numObjects=function(){return this.bodies.length};d.prototype.collisionMatrixTick=function(){var b=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix;this.collisionMatrix=b;this.collisionMatrix.reset()};d.prototype.add=d.prototype.addBody=function(b){-1===this.bodies.indexOf(b)&&(b.index=this.bodies.length,this.bodies.push(b),b.world=this,b.initPosition.copy(b.position),
b.initVelocity.copy(b.velocity),b.timeLastSleepy=this.time,b instanceof s&&(b.initAngularVelocity.copy(b.angularVelocity),b.initQuaternion.copy(b.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=b,this.dispatchEvent(this.addBodyEvent))};d.prototype.addConstraint=function(b){this.constraints.push(b)};d.prototype.removeConstraint=function(b){b=this.constraints.indexOf(b);-1!==b&&this.constraints.splice(b,1)};d.prototype.rayTest=function(b,d,f){f instanceof u?
this.raycastClosest(b,d,{skipBackfaces:!0},f):this.raycastAll(b,d,{skipBackfaces:!0},f)};d.prototype.raycastAll=function(b,d,f,e){f.mode=z.ALL;f.from=b;f.to=d;f.callback=e;return B.intersectWorld(this,f)};d.prototype.raycastAny=function(b,d,f,e){f.mode=z.ANY;f.from=b;f.to=d;f.result=e;return B.intersectWorld(this,f)};d.prototype.raycastClosest=function(b,d,f,e){f.mode=z.CLOSEST;f.from=b;f.to=d;f.result=e;return B.intersectWorld(this,f)};d.prototype.remove=function(b){b.world=null;var d=this.bodies.length-
1,f=this.bodies,e=f.indexOf(b);if(-1!==e){f.splice(e,1);for(e=0;e!==f.length;e++)f[e].index=e;this.collisionMatrix.setNumObjects(d);this.removeBodyEvent.body=b;this.dispatchEvent(this.removeBodyEvent)}};d.prototype.removeBody=d.prototype.remove;d.prototype.addMaterial=function(b){this.materials.push(b)};d.prototype.addContactMaterial=function(b){this.contactmaterials.push(b);this.contactMaterialTable.set(b.materials[0].id,b.materials[1].id,b)};"undefined"===typeof performance&&(performance={});if(!performance.now){var A=
Date.now();performance.timing&&performance.timing.navigationStart&&(A=performance.timing.navigationStart);performance.now=function(){return Date.now()-A}}var D=new j;d.prototype.step=function(b,d,f){f=f||10;d=d||0;if(0===d)this.internalStep(b),this.time+=b;else{var e=Math.floor((this.time+d)/b)-Math.floor(this.time/b),e=Math.min(e,f);f=performance.now();for(var g=0;g!==e&&!(this.internalStep(b),performance.now()-f>1E3*b);g++);this.time+=d;b=this.time%b/b;d=this.bodies;for(e=0;e!==d.length;e++)f=d[e],
f.type!==s.STATIC&&f.sleepState!==s.SLEEPING?(f.position.vsub(f.previousPosition,D),D.scale(b,D),f.position.vadd(D,f.interpolatedPosition)):(f.interpolatedPosition.copy(f.position),f.interpolatedQuaternion.copy(f.quaternion))}};var H={type:"postStep"},y={type:"preStep"},C={type:"collide",body:null,contact:null},I=[],M=[],P=[],N=[];new j;new j;new j;new j;new j;new j;new j;new j;new j;new g;var K=new g,W=new g,ea=new j;d.prototype.internalStep=function(b){this.dt=b;var d=this.contacts,f=this.numObjects(),
e=this.bodies,g=this.solver,j=this.gravity,l=this.doProfiling,n=this.profile,m=s.DYNAMIC,r,p=this.constraints;j.norm();var t=j.x,u=j.y,v=j.z,j=0;l&&(r=performance.now());for(j=0;j!==f;j++){var x=e[j];if(x.type&m){var z=x.force,x=x.mass;z.x+=x*t;z.y+=x*u;z.z+=x*v}}j=0;for(x=this.subsystems.length;j!==x;j++)this.subsystems[j].update();l&&(r=performance.now());P.length=0;N.length=0;this.broadphase.collisionPairs(this,P,N);l&&(n.broadphase=performance.now()-r);x=p.length;for(j=0;j!==x;j++)if(t=p[j],!t.collideConnected)for(u=
P.length-1;0<=u;u-=1)if(t.bodyA===P[u]&&t.bodyB===N[u]||t.bodyB===P[u]&&t.bodyA===N[u])P.splice(u,1),N.splice(u,1);this.collisionMatrixTick();l&&(r=performance.now());x=d.length;for(j=0;j!==x;j++)I.push(d[j]);d.length=0;x=this.frictionEquations.length;for(j=0;j!==x;j++)M.push(this.frictionEquations[j]);this.frictionEquations.length=0;this.narrowphase.getContacts(P,N,this,d,I,this.frictionEquations,M);l&&(n.narrowphase=performance.now()-r);l&&(r=performance.now());for(j=0;j<this.frictionEquations.length;j++)g.addEquation(this.frictionEquations[j]);
j=d.length;for(u=0;u!==j;u++){t=d[u];x=t.bi;v=t.bj;x.material&&v.material&&this.getContactMaterial(x.material,v.material);x.material&&v.material&&(0<=x.material.restitution&&0<=v.material.restitution)&&(t.restitution=x.material.restitution*v.material.restitution);g.addEquation(t);if(x.allowSleep&&x.type===s.DYNAMIC&&x.sleepState===s.SLEEPING&&v.sleepState===s.AWAKE&&v.type!==s.STATIC){var z=v.velocity.norm2()+v.angularVelocity.norm2(),A=Math.pow(v.sleepSpeedLimit,2);z>=2*A&&(x._wakeUpAfterNarrowphase=
!0)}v.allowSleep&&(v.type===s.DYNAMIC&&v.sleepState===s.SLEEPING&&x.sleepState===s.AWAKE&&x.type!==s.STATIC)&&(z=x.velocity.norm2()+x.angularVelocity.norm2(),A=Math.pow(x.sleepSpeedLimit,2),z>=2*A&&(v._wakeUpAfterNarrowphase=!0));this.collisionMatrix.set(x,v,!0);this.collisionMatrixPrevious.get(x,v)||(C.body=v,C.contact=t,x.dispatchEvent(C),C.body=x,v.dispatchEvent(C))}l&&(n.makeContactConstraints=performance.now()-r,r=performance.now());for(j=0;j!==f;j++)x=e[j],x._wakeUpAfterNarrowphase&&(x.wakeUp(),
x._wakeUpAfterNarrowphase=!1);x=p.length;for(j=0;j!==x;j++){t=p[j];t.update();u=0;for(d=t.equations.length;u!==d;u++)g.addEquation(t.equations[u])}g.solve(b,this);l&&(n.solve=performance.now()-r);g.removeAllEquations();g=Math.pow;for(j=0;j!==f;j++)if(x=e[j],x.type&m&&(p=g(1-x.linearDamping,b),d=x.velocity,d.mult(p,d),p=x.angularVelocity))d=g(1-x.angularDamping,b),p.mult(d,p);this.dispatchEvent(y);for(j=0;j!==f;j++)x=e[j],x.preStep&&x.preStep.call(x);l&&(r=performance.now());m=s.DYNAMIC|s.KINEMATIC;
g=0===this.stepnumber%(this.quatNormalizeSkip+1);p=this.quatNormalizeFast;d=0.5*b;for(j=0;j!==f;j++)if(x=e[j],t=x.force,u=x.torque,x.type&m&&x.sleepState!==s.SLEEPING){var v=x.velocity,z=x.angularVelocity,A=x.position,B=x.quaternion,D=x.invMass,Ia=x.invInertiaWorld;v.x+=t.x*D*b;v.y+=t.y*D*b;v.z+=t.z*D*b;x.angularVelocity&&(Ia.vmult(u,ea),ea.mult(b,ea),ea.vadd(z,z));A.x+=v.x*b;A.y+=v.y*b;A.z+=v.z*b;x.angularVelocity&&(K.set(z.x,z.y,z.z,0),K.mult(B,W),B.x+=d*W.x,B.y+=d*W.y,B.z+=d*W.z,B.w+=d*W.w,g&&
(p?B.normalizeFast():B.normalize()));x.aabb&&(x.aabbNeedsUpdate=!0);x.updateInertiaWorld&&x.updateInertiaWorld()}this.clearForces();this.broadphase.dirty=!0;l&&(n.integrate=performance.now()-r);this.time+=b;this.stepnumber+=1;this.dispatchEvent(H);for(j=0;j!==f;j++)x=e[j],(b=x.postStep)&&b.call(x);if(this.allowSleep)for(j=0;j!==f;j++)e[j].sleepTick(this.time)};d.prototype.clearForces=function(){for(var b=this.bodies,d=b.length,f=0;f!==d;f++){var e=b[f];e.force.set(0,0,0);e.torque.set(0,0,0)}}},{"../collision/AABB":3,
"../collision/ArrayCollisionMatrix":4,"../collision/NaiveBroadphase":7,"../collision/Ray":9,"../collision/RaycastResult":10,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../material/ContactMaterial":24,"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Shape":43,"../solver/GSSolver":46,"../utils/EventTarget":49,"../utils/TupleDictionary":52,"../utils/Vec3Pool":54,"./Narrowphase":55}]},{},[2])(2)});function getInternetExplorerVersion(){var c=-1;"Microsoft Internet Explorer"==navigator.appName&&null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(c=parseFloat(RegExp.$1));return c}var ie=getInternetExplorerVersion();function getQueryVariable(c){for(var b=window.location.search.substring(1).split("&"),e=0;e<b.length;e++){var d=b[e].match(/([^=]+?)=(.+)/);if(d&&decodeURIComponent(d[1])==c)return decodeURIComponent(d[2])}};this.jukebox={};
jukebox.Player=function(c,b){this.id=++jukebox.__jukeboxId;this.origin=b||null;this.settings={};for(var e in this.defaults)this.settings[e]=this.defaults[e];if("[object Object]"===Object.prototype.toString.call(c))for(var d in c)this.settings[d]=c[d];"[object Function]"===Object.prototype.toString.call(jukebox.Manager)&&(jukebox.Manager=new jukebox.Manager);this.resource=this.isPlaying=null;this.resource="[object Object]"===Object.prototype.toString.call(jukebox.Manager)?jukebox.Manager.getPlayableResource(this.settings.resources):this.settings.resources[0]||
null;if(null===this.resource)throw"Your browser can't playback the given resources - or you have missed to include jukebox.Manager";this.__init();return this};jukebox.__jukeboxId=0;
jukebox.Player.prototype={defaults:{resources:[],autoplay:!1,spritemap:{},flashMediaElement:"./swf/FlashMediaElement.swf",timeout:1E3},__addToManager:function(){!0!==this.__wasAddedToManager&&(jukebox.Manager.add(this),this.__wasAddedToManager=!0)},__init:function(){var c=this,b=this.settings,e={},d;jukebox.Manager&&void 0!==jukebox.Manager.features&&(e=jukebox.Manager.features);if(!0===e.html5audio){this.context=new Audio;this.context.src=this.resource;if(null===this.origin){var j=function(b){c.__addToManager(b)};
this.context.addEventListener("canplaythrough",j,!0);window.setTimeout(function(){c.context.removeEventListener("canplaythrough",j,!0);j("timeout")},b.timeout)}this.context.autobuffer=!0;this.context.preload=!0;for(d in this.HTML5API)this[d]=this.HTML5API[d];1<e.channels?!0===b.autoplay?this.context.autoplay=!0:void 0!==b.spritemap[b.autoplay]&&this.play(b.autoplay):1===e.channels&&void 0!==b.spritemap[b.autoplay]&&(this.backgroundMusic=b.spritemap[b.autoplay],this.backgroundMusic.started=Date.now?
Date.now():+new Date,this.play(b.autoplay));1==e.channels&&!0!==b.canPlayBackground&&(window.addEventListener("pagehide",function(){null!==c.isPlaying&&(c.pause(),c.__wasAutoPaused=!0)}),window.addEventListener("pageshow",function(){c.__wasAutoPaused&&(c.resume(),delete c._wasAutoPaused)}))}else if(!0===e.flashaudio){for(d in this.FLASHAPI)this[d]=this.FLASHAPI[d];e=["id=jukebox-flashstream-"+this.id,"autoplay="+b.autoplay,"file="+window.encodeURIComponent(this.resource)];this.__initFlashContext(e);
!0===b.autoplay?this.play(0):b.spritemap[b.autoplay]&&this.play(b.autoplay)}else throw"Your Browser does not support Flash Audio or HTML5 Audio.";},__initFlashContext:function(c){var b,e=this.settings.flashMediaElement,d,j={flashvars:c.join("&"),quality:"high",bgcolor:"#000000",wmode:"transparent",allowscriptaccess:"always",allowfullscreen:"true"};if(navigator.userAgent.match(/MSIE/)){b=document.createElement("div");document.getElementsByTagName("body")[0].appendChild(b);var g=document.createElement("object");
g.id="jukebox-flashstream-"+this.id;g.setAttribute("type","application/x-shockwave-flash");g.setAttribute("classid","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000");g.setAttribute("width","0");g.setAttribute("height","0");j.movie=e+"?x="+(Date.now?Date.now():+new Date);j.flashvars=c.join("&amp;");for(d in j)c=document.createElement("param"),c.setAttribute("name",d),c.setAttribute("value",j[d]),g.appendChild(c);b.outerHTML=g.outerHTML;this.context=document.getElementById("jukebox-flashstream-"+this.id)}else{b=
document.createElement("embed");b.id="jukebox-flashstream-"+this.id;b.setAttribute("type","application/x-shockwave-flash");b.setAttribute("width","100");b.setAttribute("height","100");j.play=!1;j.loop=!1;j.src=e+"?x="+(Date.now?Date.now():+new Date);for(d in j)b.setAttribute(d,j[d]);document.getElementsByTagName("body")[0].appendChild(b);this.context=b}},backgroundHackForiOS:function(){if(void 0!==this.backgroundMusic){var c=Date.now?Date.now():+new Date;void 0===this.backgroundMusic.started?(this.backgroundMusic.started=
c,this.setCurrentTime(this.backgroundMusic.start)):(this.backgroundMusic.lastPointer=(c-this.backgroundMusic.started)/1E3%(this.backgroundMusic.end-this.backgroundMusic.start)+this.backgroundMusic.start,this.play(this.backgroundMusic.lastPointer))}},play:function(c,b){if(null!==this.isPlaying&&!0!==b)void 0!==jukebox.Manager&&jukebox.Manager.addToQueue(c,this.id);else{var e=this.settings.spritemap,d;if(void 0!==e[c])d=e[c].start;else if("number"===typeof c){d=c;for(var j in e)if(d>=e[j].start&&d<=
e[j].end){c=j;break}}void 0!==d&&"[object Object]"===Object.prototype.toString.call(e[c])&&(this.isPlaying=this.settings.spritemap[c],this.context.play&&this.context.play(),this.wasReady=this.setCurrentTime(d))}},stop:function(){this.__lastPosition=0;this.isPlaying=null;this.backgroundMusic?this.backgroundHackForiOS():this.context.pause();return!0},pause:function(){this.isPlaying=null;this.__lastPosition=this.getCurrentTime();this.context.pause();return this.__lastPosition},resume:function(c){c="number"===
typeof c?c:this.__lastPosition;if(null!==c)return this.play(c),this.__lastPosition=null,!0;this.context.play();return!1},HTML5API:{getVolume:function(){return this.context.volume||1},setVolume:function(c){this.context.volume=c;return 1E-4>Math.abs(this.context.volume-c)?!0:!1},getCurrentTime:function(){return this.context.currentTime||0},setCurrentTime:function(c){try{return this.context.currentTime=c,!0}catch(b){return!1}}},FLASHAPI:{getVolume:function(){return this.context&&"function"===typeof this.context.getVolume?
this.context.getVolume():1},setVolume:function(c){return this.context&&"function"===typeof this.context.setVolume?(this.context.setVolume(c),!0):!1},getCurrentTime:function(){return this.context&&"function"===typeof this.context.getCurrentTime?this.context.getCurrentTime():0},setCurrentTime:function(c){return this.context&&"function"===typeof this.context.setCurrentTime?this.context.setCurrentTime(c):!1}}};
if(void 0===this.jukebox)throw"jukebox.Manager requires jukebox.Player (Player.js) to run properly.";
jukebox.Manager=function(c){this.features={};this.codecs={};this.__players={};this.__playersLength=0;this.__clones={};this.__queue=[];this.settings={};for(var b in this.defaults)this.settings[b]=this.defaults[b];if("[object Object]"===Object.prototype.toString.call(c))for(var e in c)this.settings[e]=c[e];this.__detectFeatures();jukebox.Manager.__initialized=!1===this.settings.useGameLoop?window.setInterval(function(){jukebox.Manager.loop()},20):!0};
jukebox.Manager.prototype={defaults:{useFlash:!1,useGameLoop:!1},__detectFeatures:function(){var c=window.Audio&&new Audio;if(c&&c.canPlayType&&!1===this.settings.useFlash){for(var b=[{e:"3gp",m:["audio/3gpp","audio/amr"]},{e:"aac",m:["audio/aac","audio/aacp"]},{e:"amr",m:["audio/amr","audio/3gpp"]},{e:"caf",m:["audio/IMA-ADPCM","audio/x-adpcm",'audio/x-aiff; codecs="IMA-ADPCM, ADPCM"']},{e:"m4a",m:'audio/mp4{audio/mp4; codecs="mp4a.40.2,avc1.42E01E"{audio/mpeg4{audio/mpeg4-generic{audio/mp4a-latm{audio/MP4A-LATM{audio/x-m4a'.split("{")},
{e:"mp3",m:["audio/mp3","audio/mpeg",'audio/mpeg; codecs="mp3"',"audio/MPA","audio/mpa-robust"]},{e:"mpga",m:["audio/MPA","audio/mpa-robust","audio/mpeg","video/mpeg"]},{e:"mp4",m:["audio/mp4","video/mp4"]},{e:"ogg",m:["application/ogg","audio/ogg",'audio/ogg; codecs="theora, vorbis"',"video/ogg",'video/ogg; codecs="theora, vorbis"']},{e:"wav",m:["audio/wave","audio/wav",'audio/wav; codecs="1"',"audio/x-wav","audio/x-pn-wav"]},{e:"webm",m:["audio/webm",'audio/webm; codecs="vorbis"',"video/webm"]}],
e,d,j=0,g=b.length;j<g;j++)if(d=b[j].e,b[j].m.length&&"object"===typeof b[j].m)for(var p=0,m=b[j].m.length;p<m;p++)if(e=b[j].m[p],""!==c.canPlayType(e)){this.codecs[d]=e;break}else this.codecs[d]||(this.codecs[d]=!1);this.features.html5audio=!(!this.codecs.mp3&&!this.codecs.ogg&&!this.codecs.webm&&!this.codecs.wav);this.features.channels=8;c.volume=0.1337;this.features.volume=!!(1E-4>Math.abs(c.volume-0.1337));navigator.userAgent.match(/iPhone|iPod|iPad/i)&&(this.features.channels=1)}this.features.flashaudio=
!!navigator.mimeTypes["application/x-shockwave-flash"]||!!navigator.plugins["Shockwave Flash"]||!1;if(window.ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash.10"),this.features.flashaudio=!0}catch(f){}!0===this.settings.useFlash&&(this.features.flashaudio=!0);!0===this.features.flashaudio&&!this.features.html5audio&&(this.codecs.mp3="audio/mp3",this.codecs.mpga="audio/mpeg",this.codecs.mp4="audio/mp4",this.codecs.m4a="audio/mp4",this.codecs["3gp"]="audio/3gpp",this.codecs.amr="audio/amr",
this.features.volume=!0,this.features.channels=1)},__getPlayerById:function(c){return this.__players&&void 0!==this.__players[c]?this.__players[c]:null},__getClone:function(c,b){for(var e in this.__clones){var d=this.__clones[e];if(null===d.isPlaying&&d.origin===c)return d}if("[object Object]"===Object.prototype.toString.call(b)){e={};for(var j in b)e[j]=b[j];e.autoplay=!1;j=new jukebox.Player(e,c);j.isClone=!0;j.wasReady=!1;return this.__clones[j.id]=j}return null},loop:function(){if(0!==this.__playersLength)if(this.__queue.length&&
this.__playersLength<this.features.channels){var c=this.__queue[0],b=this.__getPlayerById(c.origin);if(null!==b){var e=this.__getClone(c.origin,b.settings);null!==e&&(!0===this.features.volume&&(b=this.__players[c.origin])&&e.setVolume(b.getVolume()),this.add(e),e.play(c.pointer,!0))}this.__queue.splice(0,1)}else for(e in this.__queue.length&&1===this.features.channels&&(c=this.__queue[0],b=this.__getPlayerById(c.origin),null!==b&&b.play(c.pointer,!0),this.__queue.splice(0,1)),this.__players)c=this.__players[e],
b=c.getCurrentTime()||0,c.isPlaying&&!1===c.wasReady?c.wasReady=c.setCurrentTime(c.isPlaying.start):c.isPlaying&&!0===c.wasReady?b>c.isPlaying.end&&(!0===c.isPlaying.loop?c.play(c.isPlaying.start,!0):c.stop()):c.isClone&&null===c.isPlaying?this.remove(c):void 0!==c.backgroundMusic&&null===c.isPlaying&&b>c.backgroundMusic.end&&c.backgroundHackForiOS()},getPlayableResource:function(c){"[object Array]"!==Object.prototype.toString.call(c)&&(c=[c]);for(var b=0,e=c.length;b<e;b++){var d=c[b],j=d.match(/\.([^\.]*)$/)[1];
if(j&&this.codecs[j])return d}return null},add:function(c){return c instanceof jukebox.Player&&void 0===this.__players[c.id]?(this.__playersLength++,this.__players[c.id]=c,!0):!1},remove:function(c){return c instanceof jukebox.Player&&void 0!==this.__players[c.id]?(this.__playersLength--,delete this.__players[c.id],!0):!1},addToQueue:function(c,b){return("string"===typeof c||"number"===typeof c)&&void 0!==this.__players[b]?(this.__queue.push({pointer:c,origin:b}),!0):!1}};(function(){var c=function(){this.init()};c.prototype={init:function(){var c=this||b;c._counter=1E3;c._html5AudioPool=[];c.html5PoolSize=10;c._codecs={};c._howls=[];c._muted=!1;c._volume=1;c._canPlayEvent="canplaythrough";c._navigator="undefined"!==typeof window&&window.navigator?window.navigator:null;c.masterGain=null;c.noAudio=!1;c.usingWebAudio=!0;c.autoSuspend=!1;c.ctx=null;c.autoUnlock=!0;c._setup();return c},volume:function(c){var d=this||b;c=parseFloat(c);d.ctx||m();if("undefined"!==typeof c&&
0<=c&&1>=c){d._volume=c;if(d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(c,b.ctx.currentTime);for(var e=0;e<d._howls.length;e++)if(!d._howls[e]._webAudio)for(var g=d._howls[e]._getSoundIds(),j=0;j<g.length;j++){var p=d._howls[e]._soundById(g[j]);p&&p._node&&(p._node.volume=p._volume*c)}return d}return d._volume},mute:function(c){var d=this||b;d.ctx||m();d._muted=c;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(c?0:d._volume,b.ctx.currentTime);for(var e=0;e<d._howls.length;e++)if(!d._howls[e]._webAudio)for(var g=
d._howls[e]._getSoundIds(),j=0;j<g.length;j++){var p=d._howls[e]._soundById(g[j]);p&&p._node&&(p._node.muted=c?!0:p._muted)}return d},stop:function(){for(var c=this||b,d=0;d<c._howls.length;d++)c._howls[d].stop();return c},unload:function(){for(var c=this||b,d=c._howls.length-1;0<=d;d--)c._howls[d].unload();c.usingWebAudio&&(c.ctx&&"undefined"!==typeof c.ctx.close)&&(c.ctx.close(),c.ctx=null,m());return c},codecs:function(c){return(this||b)._codecs[c.replace(/^x-/,"")]},_setup:function(){var c=this||
b;c.state=c.ctx?c.ctx.state||"suspended":"suspended";c._autoSuspend();if(!c.usingWebAudio)if("undefined"!==typeof Audio)try{var d=new Audio;"undefined"===typeof d.oncanplaythrough&&(c._canPlayEvent="canplay")}catch(e){c.noAudio=!0}else c.noAudio=!0;try{d=new Audio,d.muted&&(c.noAudio=!0)}catch(g){}c.noAudio||c._setupCodecs();return c},_setupCodecs:function(){var c=this||b,d=null;try{d="undefined"!==typeof Audio?new Audio:null}catch(e){return c}if(!d||"function"!==typeof d.canPlayType)return c;var g=
d.canPlayType("audio/mpeg;").replace(/^no$/,""),j=c._navigator&&c._navigator.userAgent.match(/OPR\/([0-6].)/g),j=j&&33>parseInt(j[0].split("/")[1],10);c._codecs={mp3:!(j||!g&&!d.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!g,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!d.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),
aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(d.canPlayType("audio/x-m4b;")||d.canPlayType("audio/m4b;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,
""),webm:!!d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")};return c},_unlockAudio:function(){var c=this||b;if(!c._audioUnlocked&&c.ctx){c._audioUnlocked=!1;c.autoUnlock=!1;!c._mobileUnloaded&&44100!==c.ctx.sampleRate&&(c._mobileUnloaded=!0,c.unload());c._scratchBuffer=c.ctx.createBuffer(1,1,22050);var d=function(){for(;c._html5AudioPool.length<
c.html5PoolSize;)try{var b=new Audio;b._unlocked=!0;c._releaseHtml5Audio(b)}catch(e){c.noAudio=!0;break}for(b=0;b<c._howls.length;b++)if(!c._howls[b]._webAudio)for(var g=c._howls[b]._getSoundIds(),j=0;j<g.length;j++){var m=c._howls[b]._soundById(g[j]);m&&(m._node&&!m._node._unlocked)&&(m._node._unlocked=!0,m._node.load())}c._autoResume();var p=c.ctx.createBufferSource();p.buffer=c._scratchBuffer;p.connect(c.ctx.destination);"undefined"===typeof p.start?p.noteOn(0):p.start(0);"function"===typeof c.ctx.resume&&
c.ctx.resume();p.onended=function(){p.disconnect(0);c._audioUnlocked=!0;document.removeEventListener("touchstart",d,!0);document.removeEventListener("touchend",d,!0);document.removeEventListener("click",d,!0);for(var b=0;b<c._howls.length;b++)c._howls[b]._emit("unlock")}};document.addEventListener("touchstart",d,!0);document.addEventListener("touchend",d,!0);document.addEventListener("click",d,!0);return c}},_obtainHtml5Audio:function(){var c=this||b;if(c._html5AudioPool.length)return c._html5AudioPool.pop();
(c=(new Audio).play())&&("undefined"!==typeof Promise&&(c instanceof Promise||"function"===typeof c.then))&&c.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")});return new Audio},_releaseHtml5Audio:function(c){var d=this||b;c._unlocked&&d._html5AudioPool.push(c);return d},_autoSuspend:function(){var c=this;if(c.autoSuspend&&c.ctx&&"undefined"!==typeof c.ctx.suspend&&b.usingWebAudio){for(var d=0;d<c._howls.length;d++)if(c._howls[d]._webAudio)for(var e=
0;e<c._howls[d]._sounds.length;e++)if(!c._howls[d]._sounds[e]._paused)return c;c._suspendTimer&&clearTimeout(c._suspendTimer);c._suspendTimer=setTimeout(function(){if(c.autoSuspend){c._suspendTimer=null;c.state="suspending";var b=function(){c.state="suspended";c._resumeAfterSuspend&&(delete c._resumeAfterSuspend,c._autoResume())};c.ctx.suspend().then(b,b)}},3E4);return c}},_autoResume:function(){var c=this;if(c.ctx&&"undefined"!==typeof c.ctx.resume&&b.usingWebAudio)return"running"===c.state&&"interrupted"!==
c.ctx.state&&c._suspendTimer?(clearTimeout(c._suspendTimer),c._suspendTimer=null):"suspended"===c.state||"running"===c.state&&"interrupted"===c.ctx.state?(c.ctx.resume().then(function(){c.state="running";for(var b=0;b<c._howls.length;b++)c._howls[b]._emit("resume")}),c._suspendTimer&&(clearTimeout(c._suspendTimer),c._suspendTimer=null)):"suspending"===c.state&&(c._resumeAfterSuspend=!0),c}};var b=new c,e=function(b){!b.src||0===b.src.length?console.error("An array of source files must be passed with any new Howl."):
this.init(b)};e.prototype={init:function(c){var d=this;b.ctx||m();d._autoplay=c.autoplay||!1;d._format="string"!==typeof c.format?c.format:[c.format];d._html5=c.html5||!1;d._muted=c.mute||!1;d._loop=c.loop||!1;d._pool=c.pool||5;d._preload="boolean"===typeof c.preload||"metadata"===c.preload?c.preload:!0;d._rate=c.rate||1;d._sprite=c.sprite||{};d._src="string"!==typeof c.src?c.src:[c.src];d._volume=void 0!==c.volume?c.volume:1;d._xhr={method:c.xhr&&c.xhr.method?c.xhr.method:"GET",headers:c.xhr&&c.xhr.headers?
c.xhr.headers:null,withCredentials:c.xhr&&c.xhr.withCredentials?c.xhr.withCredentials:!1};d._duration=0;d._state="unloaded";d._sounds=[];d._endTimers={};d._queue=[];d._playLock=!1;d._onend=c.onend?[{fn:c.onend}]:[];d._onfade=c.onfade?[{fn:c.onfade}]:[];d._onload=c.onload?[{fn:c.onload}]:[];d._onloaderror=c.onloaderror?[{fn:c.onloaderror}]:[];d._onplayerror=c.onplayerror?[{fn:c.onplayerror}]:[];d._onpause=c.onpause?[{fn:c.onpause}]:[];d._onplay=c.onplay?[{fn:c.onplay}]:[];d._onstop=c.onstop?[{fn:c.onstop}]:
[];d._onmute=c.onmute?[{fn:c.onmute}]:[];d._onvolume=c.onvolume?[{fn:c.onvolume}]:[];d._onrate=c.onrate?[{fn:c.onrate}]:[];d._onseek=c.onseek?[{fn:c.onseek}]:[];d._onunlock=c.onunlock?[{fn:c.onunlock}]:[];d._onresume=[];d._webAudio=b.usingWebAudio&&!d._html5;"undefined"!==typeof b.ctx&&(b.ctx&&b.autoUnlock)&&b._unlockAudio();b._howls.push(d);d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}});d._preload&&"none"!==d._preload&&d.load();return d},load:function(){var c=null;if(b.noAudio)this._emit("loaderror",
null,"No audio support.");else{"string"===typeof this._src&&(this._src=[this._src]);for(var e=0;e<this._src.length;e++){var l,m;if(this._format&&this._format[e])l=this._format[e];else{m=this._src[e];if("string"!==typeof m){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(l=/^data:audio\/([^;,]+);/i.exec(m))||(l=/\.([^.]+)$/.exec(m.split("?",1)[0]));l&&(l=l[1].toLowerCase())}l||console.warn('No file extension was found. Consider using the "format" property or specify an extension.');
if(l&&b.codecs(l)){c=this._src[e];break}}if(c){this._src=c;this._state="loading";"https:"===window.location.protocol&&"http:"===c.slice(0,5)&&(this._html5=!0,this._webAudio=!1);new d(this);if(this._webAudio){var s=this,t=s._src;if(j[t])s._duration=j[t].duration,p(s);else if(/^data:[^;]+;base64,/.test(t)){c=atob(t.split(",")[1]);e=new Uint8Array(c.length);for(l=0;l<c.length;++l)e[l]=c.charCodeAt(l);g(e.buffer,s)}else{var u=new XMLHttpRequest;u.open(s._xhr.method,t,!0);u.withCredentials=s._xhr.withCredentials;
u.responseType="arraybuffer";s._xhr.headers&&Object.keys(s._xhr.headers).forEach(function(b){u.setRequestHeader(b,s._xhr.headers[b])});u.onload=function(){var b=(u.status+"")[0];"0"!==b&&"2"!==b&&"3"!==b?s._emit("loaderror",null,"Failed loading audio file with status: "+u.status+"."):g(u.response,s)};u.onerror=function(){s._webAudio&&(s._html5=!0,s._webAudio=!1,s._sounds=[],delete j[t],s.load())};try{u.send()}catch(v){u.onerror()}}}return this}this._emit("loaderror",null,"No codec support for selected audio sources.")}},
play:function(c,d){var e=this,g=null;if("number"===typeof c)g=c,c=null;else{if("string"===typeof c&&"loaded"===e._state&&!e._sprite[c])return null;if("undefined"===typeof c&&(c="__default",!e._playLock)){for(var j=0,m=0;m<e._sounds.length;m++)e._sounds[m]._paused&&!e._sounds[m]._ended&&(j++,g=e._sounds[m]._id);1===j?c=null:g=null}}var p=g?e._soundById(g):e._inactiveSound();if(!p)return null;g&&!c&&(c=p._sprite||"__default");if("loaded"!==e._state){p._sprite=c;p._ended=!1;var v=p._id;e._queue.push({event:"play",
action:function(){e.play(v)}});return v}if(g&&!p._paused)return d||e._loadQueue("play"),p._id;e._webAudio&&b._autoResume();var z=Math.max(0,0<p._seek?p._seek:e._sprite[c][0]/1E3),x=Math.max(0,(e._sprite[c][0]+e._sprite[c][1])/1E3-z),B=1E3*x/Math.abs(p._rate),A=e._sprite[c][0]/1E3,D=(e._sprite[c][0]+e._sprite[c][1])/1E3;p._sprite=c;p._ended=!1;var H=function(){p._paused=!1;p._seek=z;p._start=A;p._stop=D;p._loop=!(!p._loop&&!e._sprite[c][2])};if(z>=D)e._ended(p);else{var y=p._node;if(e._webAudio)g=
function(){e._playLock=!1;H();e._refreshBuffer(p);y.gain.setValueAtTime(p._muted||e._muted?0:p._volume,b.ctx.currentTime);p._playStart=b.ctx.currentTime;"undefined"===typeof y.bufferSource.start?p._loop?y.bufferSource.noteGrainOn(0,z,86400):y.bufferSource.noteGrainOn(0,z,x):p._loop?y.bufferSource.start(0,z,86400):y.bufferSource.start(0,z,x);Infinity!==B&&(e._endTimers[p._id]=setTimeout(e._ended.bind(e,p),B));d||setTimeout(function(){e._emit("play",p._id);e._loadQueue()},0)},"running"===b.state&&"interrupted"!==
b.ctx.state?g():(e._playLock=!0,e.once("resume",g),e._clearTimer(p._id));else{var C=function(){y.currentTime=z;y.muted=p._muted||e._muted||b._muted||y.muted;y.volume=p._volume*b.volume();y.playbackRate=p._rate;try{var g=y.play();g&&"undefined"!==typeof Promise&&(g instanceof Promise||"function"===typeof g.then)?(e._playLock=!0,H(),g.then(function(){e._playLock=!1;y._unlocked=!0;d||(e._emit("play",p._id),e._loadQueue())}).catch(function(){e._playLock=!1;e._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");
p._ended=!0;p._paused=!0})):d||(e._playLock=!1,H(),e._emit("play",p._id),e._loadQueue());y.playbackRate=p._rate;y.paused?e._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."):"__default"!==c||p._loop?e._endTimers[p._id]=setTimeout(e._ended.bind(e,p),B):(e._endTimers[p._id]=function(){e._ended(p);y.removeEventListener("ended",e._endTimers[p._id],!1)},y.addEventListener("ended",e._endTimers[p._id],
!1))}catch(j){e._emit("playerror",p._id,j)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===y.src&&(y.src=e._src,y.load());g=window&&window.ejecta||!y.readyState&&b._navigator.isCocoonJS;if(3<=y.readyState||g)C();else{e._playLock=!0;var I=function(){C();y.removeEventListener(b._canPlayEvent,I,!1)};y.addEventListener(b._canPlayEvent,I,!1);e._clearTimer(p._id)}}return p._id}},pause:function(b,c){var d=this;if("loaded"!==d._state||d._playLock)return d._queue.push({event:"pause",
action:function(){d.pause(b)}}),d;for(var e=d._getSoundIds(b),g=0;g<e.length;g++){d._clearTimer(e[g]);var j=d._soundById(e[g]);if(j&&!j._paused&&(j._seek=d.seek(e[g]),j._rateSeek=0,j._paused=!0,d._stopFade(e[g]),j._node))if(d._webAudio){if(!j._node.bufferSource)continue;"undefined"===typeof j._node.bufferSource.stop?j._node.bufferSource.noteOff(0):j._node.bufferSource.stop(0);d._cleanBuffer(j._node)}else(!isNaN(j._node.duration)||Infinity===j._node.duration)&&j._node.pause();c||d._emit("pause",j?
j._id:null)}return d},stop:function(b,c){var d=this;if("loaded"!==d._state||d._playLock)return d._queue.push({event:"stop",action:function(){d.stop(b)}}),d;for(var e=d._getSoundIds(b),g=0;g<e.length;g++){d._clearTimer(e[g]);var j=d._soundById(e[g]);if(j){j._seek=j._start||0;j._rateSeek=0;j._paused=!0;j._ended=!0;d._stopFade(e[g]);if(j._node)if(d._webAudio)j._node.bufferSource&&("undefined"===typeof j._node.bufferSource.stop?j._node.bufferSource.noteOff(0):j._node.bufferSource.stop(0),d._cleanBuffer(j._node));
else if(!isNaN(j._node.duration)||Infinity===j._node.duration)j._node.currentTime=j._start||0,j._node.pause(),Infinity===j._node.duration&&d._clearSound(j._node);c||d._emit("stop",j._id)}}return d},mute:function(c,d){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"mute",action:function(){e.mute(c,d)}}),e;if("undefined"===typeof d)if("boolean"===typeof c)e._muted=c;else return e._muted;for(var g=e._getSoundIds(d),j=0;j<g.length;j++){var m=e._soundById(g[j]);m&&(m._muted=
c,m._interval&&e._stopFade(m._id),e._webAudio&&m._node?m._node.gain.setValueAtTime(c?0:m._volume,b.ctx.currentTime):m._node&&(m._node.muted=b._muted?!0:c),e._emit("mute",m._id))}return e},volume:function(){var c=this,d=arguments,e,g;if(0===d.length)return c._volume;1===d.length||2===d.length&&"undefined"===typeof d[1]?0<=c._getSoundIds().indexOf(d[0])?g=parseInt(d[0],10):e=parseFloat(d[0]):2<=d.length&&(e=parseFloat(d[0]),g=parseInt(d[1],10));var j;if("undefined"!==typeof e&&0<=e&&1>=e){if("loaded"!==
c._state||c._playLock)return c._queue.push({event:"volume",action:function(){c.volume.apply(c,d)}}),c;"undefined"===typeof g&&(c._volume=e);g=c._getSoundIds(g);for(var m=0;m<g.length;m++)if(j=c._soundById(g[m]))j._volume=e,d[2]||c._stopFade(g[m]),c._webAudio&&j._node&&!j._muted?j._node.gain.setValueAtTime(e,b.ctx.currentTime):j._node&&!j._muted&&(j._node.volume=e*b.volume()),c._emit("volume",j._id)}else return(j=g?c._soundById(g):c._sounds[0])?j._volume:0;return c},fade:function(c,d,e,g){var j=this;
if("loaded"!==j._state||j._playLock)return j._queue.push({event:"fade",action:function(){j.fade(c,d,e,g)}}),j;c=Math.min(Math.max(0,parseFloat(c)),1);d=Math.min(Math.max(0,parseFloat(d)),1);e=parseFloat(e);j.volume(c,g);for(var m=j._getSoundIds(g),p=0;p<m.length;p++){var v=j._soundById(m[p]);if(v){g||j._stopFade(m[p]);if(j._webAudio&&!v._muted){var z=b.ctx.currentTime,x=z+e/1E3;v._volume=c;v._node.gain.setValueAtTime(c,z);v._node.gain.linearRampToValueAtTime(d,x)}j._startFadeInterval(v,c,d,e,m[p],
"undefined"===typeof g)}}return j},_startFadeInterval:function(b,c,d,e,g,j){var m=this,p=c,z=d-c;g=Math.abs(z/0.01);g=Math.max(4,0<g?e/g:e);var x=Date.now();b._fadeTo=d;b._interval=setInterval(function(){var g=(Date.now()-x)/e;x=Date.now();p+=z*g;p=0>z?Math.max(d,p):Math.min(d,p);p=Math.round(100*p)/100;m._webAudio?b._volume=p:m.volume(p,b._id,!0);j&&(m._volume=p);if(d<c&&p<=d||d>c&&p>=d)clearInterval(b._interval),b._interval=null,b._fadeTo=null,m.volume(d,b._id),m._emit("fade",b._id)},g)},_stopFade:function(c){var d=
this._soundById(c);d&&d._interval&&(this._webAudio&&d._node.gain.cancelScheduledValues(b.ctx.currentTime),clearInterval(d._interval),d._interval=null,this.volume(d._fadeTo,c),d._fadeTo=null,this._emit("fade",c));return this},loop:function(){var b=arguments,c,d;if(0===b.length)return this._loop;if(1===b.length)if("boolean"===typeof b[0])this._loop=c=b[0];else return(b=this._soundById(parseInt(b[0],10)))?b._loop:!1;else 2===b.length&&(c=b[0],d=parseInt(b[1],10));d=this._getSoundIds(d);for(var e=0;e<
d.length;e++)if(b=this._soundById(d[e]))if(b._loop=c,this._webAudio&&(b._node&&b._node.bufferSource)&&(b._node.bufferSource.loop=c))b._node.bufferSource.loopStart=b._start||0,b._node.bufferSource.loopEnd=b._stop;return this},rate:function(){var c=this,d=arguments,e,g;0===d.length?g=c._sounds[0]._id:1===d.length?0<=c._getSoundIds().indexOf(d[0])?g=parseInt(d[0],10):e=parseFloat(d[0]):2===d.length&&(e=parseFloat(d[0]),g=parseInt(d[1],10));var j;if("number"===typeof e){if("loaded"!==c._state||c._playLock)return c._queue.push({event:"rate",
action:function(){c.rate.apply(c,d)}}),c;"undefined"===typeof g&&(c._rate=e);g=c._getSoundIds(g);for(var m=0;m<g.length;m++)if(j=c._soundById(g[m])){c.playing(g[m])&&(j._rateSeek=c.seek(g[m]),j._playStart=c._webAudio?b.ctx.currentTime:j._playStart);j._rate=e;c._webAudio&&j._node&&j._node.bufferSource?j._node.bufferSource.playbackRate.setValueAtTime(e,b.ctx.currentTime):j._node&&(j._node.playbackRate=e);var p=c.seek(g[m]),p=1E3*((c._sprite[j._sprite][0]+c._sprite[j._sprite][1])/1E3-p)/Math.abs(j._rate);
if(c._endTimers[g[m]]||!j._paused)c._clearTimer(g[m]),c._endTimers[g[m]]=setTimeout(c._ended.bind(c,j),p);c._emit("rate",j._id)}}else return(j=c._soundById(g))?j._rate:c._rate;return c},seek:function(){var c=this,d=arguments,e,g;0===d.length?g=c._sounds[0]._id:1===d.length?0<=c._getSoundIds().indexOf(d[0])?g=parseInt(d[0],10):c._sounds.length&&(g=c._sounds[0]._id,e=parseFloat(d[0])):2===d.length&&(e=parseFloat(d[0]),g=parseInt(d[1],10));if("undefined"===typeof g)return c;if("loaded"!==c._state||c._playLock)return c._queue.push({event:"seek",
action:function(){c.seek.apply(c,d)}}),c;var j=c._soundById(g);if(j)if("number"===typeof e&&0<=e){var m=c.playing(g);m&&c.pause(g,!0);j._seek=e;j._ended=!1;c._clearTimer(g);!c._webAudio&&(j._node&&!isNaN(j._node.duration))&&(j._node.currentTime=e);var p=function(){c._emit("seek",g);m&&c.play(g,!0)};if(m&&!c._webAudio){var v=function(){c._playLock?setTimeout(v,0):p()};setTimeout(v,0)}else p()}else return c._webAudio?(e=c.playing(g)?b.ctx.currentTime-j._playStart:0,j._seek+((j._rateSeek?j._rateSeek-
j._seek:0)+e*Math.abs(j._rate))):j._node.currentTime;return c},playing:function(b){if("number"===typeof b)return(b=this._soundById(b))?!b._paused:!1;for(b=0;b<this._sounds.length;b++)if(!this._sounds[b]._paused)return!0;return!1},duration:function(b){var c=this._duration;(b=this._soundById(b))&&(c=this._sprite[b._sprite][1]/1E3);return c},state:function(){return this._state},unload:function(){for(var c=this._sounds,d=0;d<c.length;d++)c[d]._paused||this.stop(c[d]._id),this._webAudio||(this._clearSound(c[d]._node),
c[d]._node.removeEventListener("error",c[d]._errorFn,!1),c[d]._node.removeEventListener(b._canPlayEvent,c[d]._loadFn,!1),b._releaseHtml5Audio(c[d]._node)),delete c[d]._node,this._clearTimer(c[d]._id);d=b._howls.indexOf(this);0<=d&&b._howls.splice(d,1);c=!0;for(d=0;d<b._howls.length;d++)if(b._howls[d]._src===this._src||0<=this._src.indexOf(b._howls[d]._src)){c=!1;break}j&&c&&delete j[this._src];b.noAudio=!1;this._state="unloaded";this._sounds=[];return null},on:function(b,c,d,e){b=this["_on"+b];"function"===
typeof c&&b.push(e?{id:d,fn:c,once:e}:{id:d,fn:c});return this},off:function(b,c,d){var e=this["_on"+b],g=0;"number"===typeof c&&(d=c,c=null);if(c||d)for(g=0;g<e.length;g++){if(b=d===e[g].id,c===e[g].fn&&b||!c&&b){e.splice(g,1);break}}else if(b)this["_on"+b]=[];else{c=Object.keys(this);for(g=0;g<c.length;g++)0===c[g].indexOf("_on")&&Array.isArray(this[c[g]])&&(this[c[g]]=[])}return this},once:function(b,c,d){this.on(b,c,d,1);return this},_emit:function(b,c,d){for(var e=this["_on"+b],g=e.length-1;0<=
g;g--)if(!e[g].id||e[g].id===c||"load"===b)setTimeout(function(b){b.call(this,c,d)}.bind(this,e[g].fn),0),e[g].once&&this.off(b,e[g].fn,e[g].id);this._loadQueue(b);return this},_loadQueue:function(b){if(0<this._queue.length){var c=this._queue[0];c.event===b&&(this._queue.shift(),this._loadQueue());b||c.action()}return this},_ended:function(c){var d=c._sprite;if(!this._webAudio&&c._node&&!c._node.paused&&!c._node.ended&&c._node.currentTime<c._stop)return setTimeout(this._ended.bind(this,c),100),this;
d=!(!c._loop&&!this._sprite[d][2]);this._emit("end",c._id);!this._webAudio&&d&&this.stop(c._id,!0).play(c._id);if(this._webAudio&&d){this._emit("play",c._id);c._seek=c._start||0;c._rateSeek=0;c._playStart=b.ctx.currentTime;var e=1E3*(c._stop-c._start)/Math.abs(c._rate);this._endTimers[c._id]=setTimeout(this._ended.bind(this,c),e)}this._webAudio&&!d&&(c._paused=!0,c._ended=!0,c._seek=c._start||0,c._rateSeek=0,this._clearTimer(c._id),this._cleanBuffer(c._node),b._autoSuspend());!this._webAudio&&!d&&
this.stop(c._id,!0);return this},_clearTimer:function(b){if(this._endTimers[b]){if("function"!==typeof this._endTimers[b])clearTimeout(this._endTimers[b]);else{var c=this._soundById(b);c&&c._node&&c._node.removeEventListener("ended",this._endTimers[b],!1)}delete this._endTimers[b]}return this},_soundById:function(b){for(var c=0;c<this._sounds.length;c++)if(b===this._sounds[c]._id)return this._sounds[c];return null},_inactiveSound:function(){this._drain();for(var b=0;b<this._sounds.length;b++)if(this._sounds[b]._ended)return this._sounds[b].reset();
return new d(this)},_drain:function(){var b=this._pool,c=0,d=0;if(!(this._sounds.length<b)){for(d=0;d<this._sounds.length;d++)this._sounds[d]._ended&&c++;for(d=this._sounds.length-1;0<=d&&!(c<=b);d--)this._sounds[d]._ended&&(this._webAudio&&this._sounds[d]._node&&this._sounds[d]._node.disconnect(0),this._sounds.splice(d,1),c--)}},_getSoundIds:function(b){if("undefined"===typeof b){b=[];for(var c=0;c<this._sounds.length;c++)b.push(this._sounds[c]._id);return b}return[b]},_refreshBuffer:function(c){c._node.bufferSource=
b.ctx.createBufferSource();c._node.bufferSource.buffer=j[this._src];c._panner?c._node.bufferSource.connect(c._panner):c._node.bufferSource.connect(c._node);if(c._node.bufferSource.loop=c._loop)c._node.bufferSource.loopStart=c._start||0,c._node.bufferSource.loopEnd=c._stop||0;c._node.bufferSource.playbackRate.setValueAtTime(c._rate,b.ctx.currentTime);return this},_cleanBuffer:function(c){var d=b._navigator&&0<=b._navigator.vendor.indexOf("Apple");if(b._scratchBuffer&&c.bufferSource&&(c.bufferSource.onended=
null,c.bufferSource.disconnect(0),d))try{c.bufferSource.buffer=b._scratchBuffer}catch(e){}c.bufferSource=null;return this},_clearSound:function(c){/MSIE |Trident\//.test(b._navigator&&b._navigator.userAgent)||(c.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var d=function(b){this._parent=b;this.init()};d.prototype={init:function(){var c=this._parent;this._muted=c._muted;this._loop=c._loop;this._volume=c._volume;this._rate=c._rate;this._seek=0;this._ended=
this._paused=!0;this._sprite="__default";this._id=++b._counter;c._sounds.push(this);this.create();return this},create:function(){var c=this._parent,d=b._muted||this._muted||this._parent._muted?0:this._volume;c._webAudio?(this._node="undefined"===typeof b.ctx.createGain?b.ctx.createGainNode():b.ctx.createGain(),this._node.gain.setValueAtTime(d,b.ctx.currentTime),this._node.paused=!0,this._node.connect(b.masterGain)):b.noAudio||(this._node=b._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),
this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(b._canPlayEvent,this._loadFn,!1),this._node.src=c._src,this._node.preload=!0===c._preload?"auto":c._preload,this._node.volume=d*b.volume(),this._node.load());return this},reset:function(){var c=this._parent;this._muted=c._muted;this._loop=c._loop;this._volume=c._volume;this._rate=c._rate;this._rateSeek=this._seek=0;this._ended=this._paused=!0;this._sprite="__default";this._id=
++b._counter;return this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0);this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var c=this._parent;c._duration=Math.ceil(10*this._node.duration)/10;0===Object.keys(c._sprite).length&&(c._sprite={__default:[0,1E3*c._duration]});"loaded"!==c._state&&(c._state="loaded",c._emit("load"),c._loadQueue());this._node.removeEventListener(b._canPlayEvent,this._loadFn,!1)}};
var j={},g=function(c,d){var e=function(){d._emit("loaderror",null,"Decoding audio data failed.")},g=function(b){b&&0<d._sounds.length?(j[d._src]=b,p(d,b)):e()};"undefined"!==typeof Promise&&1===b.ctx.decodeAudioData.length?b.ctx.decodeAudioData(c).then(g).catch(e):b.ctx.decodeAudioData(c,g,e)},p=function(b,c){c&&!b._duration&&(b._duration=c.duration);0===Object.keys(b._sprite).length&&(b._sprite={__default:[0,1E3*b._duration]});"loaded"!==b._state&&(b._state="loaded",b._emit("load"),b._loadQueue())},
m=function(){if(b.usingWebAudio){try{"undefined"!==typeof AudioContext?b.ctx=new AudioContext:"undefined"!==typeof webkitAudioContext?b.ctx=new webkitAudioContext:b.usingWebAudio=!1}catch(c){b.usingWebAudio=!1}b.ctx||(b.usingWebAudio=!1);var d=/iP(hone|od|ad)/.test(b._navigator&&b._navigator.platform),e=b._navigator&&b._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),e=e?parseInt(e[1],10):null;d&&(e&&9>e)&&(d=/safari/.test(b._navigator&&b._navigator.userAgent.toLowerCase()),b._navigator&&!d&&
(b.usingWebAudio=!1));b.usingWebAudio&&(b.masterGain="undefined"===typeof b.ctx.createGain?b.ctx.createGainNode():b.ctx.createGain(),b.masterGain.gain.setValueAtTime(b._muted?0:b._volume,b.ctx.currentTime),b.masterGain.connect(b.ctx.destination));b._setup()}};"function"===typeof define&&define.amd&&define([],function(){return{Howler:b,Howl:e}});"undefined"!==typeof exports&&(exports.Howler=b,exports.Howl=e);"undefined"!==typeof global?(global.HowlerGlobal=c,global.Howler=b,global.Howl=e,global.Sound=
d):"undefined"!==typeof window&&(window.HowlerGlobal=c,window.Howler=b,window.Howl=e,window.Sound=d)})();
(function(){HowlerGlobal.prototype._pos=[0,0,0];HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0];HowlerGlobal.prototype.stereo=function(b){if(!this.ctx||!this.ctx.listener)return this;for(var c=this._howls.length-1;0<=c;c--)this._howls[c].stereo(b);return this};HowlerGlobal.prototype.pos=function(b,c,d){if(!this.ctx||!this.ctx.listener)return this;c="number"!==typeof c?this._pos[1]:c;d="number"!==typeof d?this._pos[2]:d;if("number"===typeof b)this._pos=[b,c,d],"undefined"!==typeof this.ctx.listener.positionX?
(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,0.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,0.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,0.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]);else return this._pos;return this};HowlerGlobal.prototype.orientation=function(b,c,d,e,f,n){if(!this.ctx||!this.ctx.listener)return this;var l=this._orientation;c="number"!==
typeof c?l[1]:c;d="number"!==typeof d?l[2]:d;e="number"!==typeof e?l[3]:e;f="number"!==typeof f?l[4]:f;n="number"!==typeof n?l[5]:n;if("number"===typeof b)this._orientation=[b,c,d,e,f,n],"undefined"!==typeof this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(b,Howler.ctx.currentTime,0.1),this.ctx.listener.forwardY.setTargetAtTime(c,Howler.ctx.currentTime,0.1),this.ctx.listener.forwardZ.setTargetAtTime(d,Howler.ctx.currentTime,0.1),this.ctx.listener.upX.setTargetAtTime(e,Howler.ctx.currentTime,
0.1),this.ctx.listener.upY.setTargetAtTime(f,Howler.ctx.currentTime,0.1),this.ctx.listener.upZ.setTargetAtTime(n,Howler.ctx.currentTime,0.1)):this.ctx.listener.setOrientation(b,c,d,e,f,n);else return l;return this};var c=Howl.prototype.init;Howl.prototype.init=function(b){this._orientation=b.orientation||[1,0,0];this._stereo=b.stereo||null;this._pos=b.pos||null;this._pannerAttr={coneInnerAngle:"undefined"!==typeof b.coneInnerAngle?b.coneInnerAngle:360,coneOuterAngle:"undefined"!==typeof b.coneOuterAngle?
b.coneOuterAngle:360,coneOuterGain:"undefined"!==typeof b.coneOuterGain?b.coneOuterGain:0,distanceModel:"undefined"!==typeof b.distanceModel?b.distanceModel:"inverse",maxDistance:"undefined"!==typeof b.maxDistance?b.maxDistance:1E4,panningModel:"undefined"!==typeof b.panningModel?b.panningModel:"HRTF",refDistance:"undefined"!==typeof b.refDistance?b.refDistance:1,rolloffFactor:"undefined"!==typeof b.rolloffFactor?b.rolloffFactor:1};this._onstereo=b.onstereo?[{fn:b.onstereo}]:[];this._onpos=b.onpos?
[{fn:b.onpos}]:[];this._onorientation=b.onorientation?[{fn:b.onorientation}]:[];return c.call(this,b)};Howl.prototype.stereo=function(b,c){var e=this;if(!e._webAudio)return e;if("loaded"!==e._state)return e._queue.push({event:"stereo",action:function(){e.stereo(b,c)}}),e;var m="undefined"===typeof Howler.ctx.createStereoPanner?"spatial":"stereo";if("undefined"===typeof c)if("number"===typeof b)e._stereo=b,e._pos=[b,0,0];else return e._stereo;for(var f=e._getSoundIds(c),n=0;n<f.length;n++){var l=e._soundById(f[n]);
if(l)if("number"===typeof b)l._stereo=b,l._pos=[b,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&d(l,m),"spatial"===m?"undefined"!==typeof l._panner.positionX?(l._panner.positionX.setValueAtTime(b,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(b,0,0):l._panner.pan.setValueAtTime(b,Howler.ctx.currentTime)),e._emit("stereo",l._id);else return l._stereo}return e};
Howl.prototype.pos=function(b,c,e,m){var f=this;if(!f._webAudio)return f;if("loaded"!==f._state)return f._queue.push({event:"pos",action:function(){f.pos(b,c,e,m)}}),f;c="number"!==typeof c?0:c;e="number"!==typeof e?-0.5:e;if("undefined"===typeof m)if("number"===typeof b)f._pos=[b,c,e];else return f._pos;for(var n=f._getSoundIds(m),l=0;l<n.length;l++){var r=f._soundById(n[l]);if(r)if("number"===typeof b)r._pos=[b,c,e],r._node&&((!r._panner||r._panner.pan)&&d(r,"spatial"),"undefined"!==typeof r._panner.positionX?
(r._panner.positionX.setValueAtTime(b,Howler.ctx.currentTime),r._panner.positionY.setValueAtTime(c,Howler.ctx.currentTime),r._panner.positionZ.setValueAtTime(e,Howler.ctx.currentTime)):r._panner.setPosition(b,c,e)),f._emit("pos",r._id);else return r._pos}return f};Howl.prototype.orientation=function(b,c,e,m){var f=this;if(!f._webAudio)return f;if("loaded"!==f._state)return f._queue.push({event:"orientation",action:function(){f.orientation(b,c,e,m)}}),f;c="number"!==typeof c?f._orientation[1]:c;e=
"number"!==typeof e?f._orientation[2]:e;if("undefined"===typeof m)if("number"===typeof b)f._orientation=[b,c,e];else return f._orientation;for(var n=f._getSoundIds(m),l=0;l<n.length;l++){var r=f._soundById(n[l]);if(r)if("number"===typeof b)r._orientation=[b,c,e],r._node&&(r._panner||(r._pos||(r._pos=f._pos||[0,0,-0.5]),d(r,"spatial")),"undefined"!==typeof r._panner.orientationX?(r._panner.orientationX.setValueAtTime(b,Howler.ctx.currentTime),r._panner.orientationY.setValueAtTime(c,Howler.ctx.currentTime),
r._panner.orientationZ.setValueAtTime(e,Howler.ctx.currentTime)):r._panner.setOrientation(b,c,e)),f._emit("orientation",r._id);else return r._orientation}return f};Howl.prototype.pannerAttr=function(){var b=arguments,c,e;if(!this._webAudio)return this;if(0===b.length)return this._pannerAttr;if(1===b.length)if("object"===typeof b[0])c=b[0],"undefined"===typeof e&&(c.pannerAttr||(c.pannerAttr={coneInnerAngle:c.coneInnerAngle,coneOuterAngle:c.coneOuterAngle,coneOuterGain:c.coneOuterGain,distanceModel:c.distanceModel,
maxDistance:c.maxDistance,refDistance:c.refDistance,rolloffFactor:c.rolloffFactor,panningModel:c.panningModel}),this._pannerAttr={coneInnerAngle:"undefined"!==typeof c.pannerAttr.coneInnerAngle?c.pannerAttr.coneInnerAngle:this._coneInnerAngle,coneOuterAngle:"undefined"!==typeof c.pannerAttr.coneOuterAngle?c.pannerAttr.coneOuterAngle:this._coneOuterAngle,coneOuterGain:"undefined"!==typeof c.pannerAttr.coneOuterGain?c.pannerAttr.coneOuterGain:this._coneOuterGain,distanceModel:"undefined"!==typeof c.pannerAttr.distanceModel?
c.pannerAttr.distanceModel:this._distanceModel,maxDistance:"undefined"!==typeof c.pannerAttr.maxDistance?c.pannerAttr.maxDistance:this._maxDistance,refDistance:"undefined"!==typeof c.pannerAttr.refDistance?c.pannerAttr.refDistance:this._refDistance,rolloffFactor:"undefined"!==typeof c.pannerAttr.rolloffFactor?c.pannerAttr.rolloffFactor:this._rolloffFactor,panningModel:"undefined"!==typeof c.pannerAttr.panningModel?c.pannerAttr.panningModel:this._panningModel});else return(b=this._soundById(parseInt(b[0],
10)))?b._pannerAttr:this._pannerAttr;else 2===b.length&&(c=b[0],e=parseInt(b[1],10));e=this._getSoundIds(e);for(var m=0;m<e.length;m++)if(b=this._soundById(e[m])){var f=b._pannerAttr,f={coneInnerAngle:"undefined"!==typeof c.coneInnerAngle?c.coneInnerAngle:f.coneInnerAngle,coneOuterAngle:"undefined"!==typeof c.coneOuterAngle?c.coneOuterAngle:f.coneOuterAngle,coneOuterGain:"undefined"!==typeof c.coneOuterGain?c.coneOuterGain:f.coneOuterGain,distanceModel:"undefined"!==typeof c.distanceModel?c.distanceModel:
f.distanceModel,maxDistance:"undefined"!==typeof c.maxDistance?c.maxDistance:f.maxDistance,refDistance:"undefined"!==typeof c.refDistance?c.refDistance:f.refDistance,rolloffFactor:"undefined"!==typeof c.rolloffFactor?c.rolloffFactor:f.rolloffFactor,panningModel:"undefined"!==typeof c.panningModel?c.panningModel:f.panningModel},n=b._panner;n?(n.coneInnerAngle=f.coneInnerAngle,n.coneOuterAngle=f.coneOuterAngle,n.coneOuterGain=f.coneOuterGain,n.distanceModel=f.distanceModel,n.maxDistance=f.maxDistance,
n.refDistance=f.refDistance,n.rolloffFactor=f.rolloffFactor,n.panningModel=f.panningModel):(b._pos||(b._pos=this._pos||[0,0,-0.5]),d(b,"spatial"))}return this};var b=Sound.prototype.init;Sound.prototype.init=function(){var c=this._parent;this._orientation=c._orientation;this._stereo=c._stereo;this._pos=c._pos;this._pannerAttr=c._pannerAttr;b.call(this);this._stereo?c.stereo(this._stereo):this._pos&&c.pos(this._pos[0],this._pos[1],this._pos[2],this._id)};var e=Sound.prototype.reset;Sound.prototype.reset=
function(){var b=this._parent;this._orientation=b._orientation;this._stereo=b._stereo;this._pos=b._pos;this._pannerAttr=b._pannerAttr;this._stereo?b.stereo(this._stereo):this._pos?b.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,b._refreshBuffer(this));return e.call(this)};var d=function(b,c){"spatial"===(c||"spatial")?(b._panner=Howler.ctx.createPanner(),b._panner.coneInnerAngle=b._pannerAttr.coneInnerAngle,b._panner.coneOuterAngle=
b._pannerAttr.coneOuterAngle,b._panner.coneOuterGain=b._pannerAttr.coneOuterGain,b._panner.distanceModel=b._pannerAttr.distanceModel,b._panner.maxDistance=b._pannerAttr.maxDistance,b._panner.refDistance=b._pannerAttr.refDistance,b._panner.rolloffFactor=b._pannerAttr.rolloffFactor,b._panner.panningModel=b._pannerAttr.panningModel,"undefined"!==typeof b._panner.positionX?(b._panner.positionX.setValueAtTime(b._pos[0],Howler.ctx.currentTime),b._panner.positionY.setValueAtTime(b._pos[1],Howler.ctx.currentTime),
b._panner.positionZ.setValueAtTime(b._pos[2],Howler.ctx.currentTime)):b._panner.setPosition(b._pos[0],b._pos[1],b._pos[2]),"undefined"!==typeof b._panner.orientationX?(b._panner.orientationX.setValueAtTime(b._orientation[0],Howler.ctx.currentTime),b._panner.orientationY.setValueAtTime(b._orientation[1],Howler.ctx.currentTime),b._panner.orientationZ.setValueAtTime(b._orientation[2],Howler.ctx.currentTime)):b._panner.setOrientation(b._orientation[0],b._orientation[1],b._orientation[2])):(b._panner=
Howler.ctx.createStereoPanner(),b._panner.pan.setValueAtTime(b._stereo,Howler.ctx.currentTime));b._panner.connect(b._node);b._paused||b._parent.pause(b._id,!0).play(b._id,!0)}})();!function(c,b){"object"==typeof exports&&"undefined"!=typeof module?b():"function"==typeof define&&define.amd?define(b):b()}(0,function(){function c(b){var c=this.constructor;return this.then(function(d){return c.resolve(b()).then(function(){return d})},function(d){return c.resolve(b()).then(function(){return c.reject(d)})})}function b(){}function e(b){if(!(this instanceof e))throw new TypeError("Promises must be constructed via new");if("function"!=typeof b)throw new TypeError("not a function");
this._state=0;this._handled=!1;this._value=void 0;this._deferreds=[];m(b,this)}function d(b,c){for(;3===b._state;)b=b._value;0!==b._state?(b._handled=!0,e._immediateFn(function(){var d=1===b._state?c.onFulfilled:c.onRejected;if(null!==d){var e;try{e=d(b._value)}catch(f){return void g(c.promise,f)}j(c.promise,e)}else(1===b._state?j:g)(c.promise,b._value)})):b._deferreds.push(c)}function j(b,c){try{if(c===b)throw new TypeError("A promise cannot be resolved with itself.");if(c&&("object"==typeof c||
"function"==typeof c)){var d=c.then;if(c instanceof e)return b._state=3,b._value=c,void p(b);if("function"==typeof d)return void m(function(){d.apply(c,arguments)},b)}b._state=1;b._value=c;p(b)}catch(f){g(b,f)}}function g(b,c){b._state=2;b._value=c;p(b)}function p(b){2===b._state&&0===b._deferreds.length&&e._immediateFn(function(){b._handled||e._unhandledRejectionFn(b._value)});for(var c=0,f=b._deferreds.length;f>c;c++)d(b,b._deferreds[c]);b._deferreds=null}function m(b,c){var d=!1;try{b(function(b){d||
(d=!0,j(c,b))},function(b){d||(d=!0,g(c,b))})}catch(e){d||(d=!0,g(c,e))}}var f=setTimeout;e.prototype["catch"]=function(b){return this.then(null,b)};e.prototype.then=function(c,e){var f=new this.constructor(b);return d(this,new function(b,c,d){this.onFulfilled="function"==typeof b?b:null;this.onRejected="function"==typeof c?c:null;this.promise=d}(c,e,f)),f};e.prototype["finally"]=c;e.all=function(b){return new e(function(c,d){function e(b,j){try{if(j&&("object"==typeof j||"function"==typeof j)){var l=
j.then;if("function"==typeof l)return void l.call(j,function(c){e(b,c)},d)}f[b]=j;0==--g&&c(f)}catch(m){d(m)}}if(!b||"undefined"==typeof b.length)throw new TypeError("Promise.all accepts an array");var f=Array.prototype.slice.call(b);if(0===f.length)return c([]);for(var g=f.length,j=0;f.length>j;j++)e(j,f[j])})};e.resolve=function(b){return b&&"object"==typeof b&&b.constructor===e?b:new e(function(c){c(b)})};e.reject=function(b){return new e(function(c,d){d(b)})};e.race=function(b){return new e(function(c,
d){for(var e=0,f=b.length;f>e;e++)b[e].then(c,d)})};e._immediateFn="function"==typeof setImmediate&&function(b){setImmediate(b)}||function(b){f(b,0)};e._unhandledRejectionFn=function(b){void 0!==console&&console&&console.warn("Possible Unhandled Promise Rejection:",b)};var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("unable to locate global object");}();"Promise"in n?n.Promise.prototype["finally"]||
(n.Promise.prototype["finally"]=c):n.Promise=e});(function(){function c(b,c){document.addEventListener?b.addEventListener("scroll",c,!1):b.attachEvent("scroll",c)}function b(b){this.a=document.createElement("div");this.a.setAttribute("aria-hidden","true");this.a.appendChild(document.createTextNode(b));this.b=document.createElement("span");this.c=document.createElement("span");this.h=document.createElement("span");this.f=document.createElement("span");this.g=-1;this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";
this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;";this.b.appendChild(this.h);this.c.appendChild(this.f);this.a.appendChild(this.b);this.a.appendChild(this.c)}function e(b,c){b.a.style.cssText=
"max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+c+";"}function d(b){var c=b.a.offsetWidth,d=c+100;b.f.style.width=d+"px";b.c.scrollLeft=d;b.b.scrollLeft=b.b.scrollWidth+100;return b.g!==c?(b.g=c,!0):!1}function j(b,e){function f(){var b=g;d(b)&&b.a.parentNode&&e(b.g)}var g=b;c(b.b,f);c(b.c,f);d(b)}function g(b,c){var d=c||{};this.family=b;this.style=d.style||
"normal";this.weight=d.weight||"normal";this.stretch=d.stretch||"normal"}function p(){null===s&&(s=!!document.fonts);return s}function m(){if(null===r){var b=document.createElement("div");try{b.style.font="condensed 100px sans-serif"}catch(c){}r=""!==b.style.font}return r}function f(b,c){return[b.style,b.weight,m()?b.stretch:"","100px",c].join(" ")}var n=null,l=null,r=null,s=null;g.prototype.load=function(c,d){var g=this,m=c||"BESbswy",r=0,s=d||3E3,A=(new Date).getTime();return new Promise(function(c,
d){var t;if(t=p())null===l&&(p()&&/Apple/.test(window.navigator.vendor)?(t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),l=!!t&&603>parseInt(t[1],10)):l=!1),t=!l;if(t){t=new Promise(function(b,c){function d(){(new Date).getTime()-A>=s?c(Error(""+s+"ms timeout exceeded")):document.fonts.load(f(g,'"'+g.family+'"'),m).then(function(c){1<=c.length?b():setTimeout(d,25)},c)}d()});var u=new Promise(function(b,c){r=setTimeout(function(){c(Error(""+s+"ms timeout exceeded"))},
s)});Promise.race([u,t]).then(function(){clearTimeout(r);c(g)},d)}else{var I=function(){function l(){var b;if(b=-1!=C&&-1!=F||-1!=C&&-1!=J||-1!=F&&-1!=J)(b=C!=F&&C!=J&&F!=J)||(null===n&&(b=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),n=!!b&&(536>parseInt(b[1],10)||536===parseInt(b[1],10)&&11>=parseInt(b[2],10))),b=n&&(C==I&&F==I&&J==I||C==T&&F==T&&J==T||C==L&&F==L&&J==L)),b=!b;b&&(U.parentNode&&U.parentNode.removeChild(U),clearTimeout(r),c(g))}function p(){if((new Date).getTime()-
A>=s)U.parentNode&&U.parentNode.removeChild(U),d(Error(""+s+"ms timeout exceeded"));else{var b=document.hidden;if(!0===b||void 0===b)C=t.a.offsetWidth,F=u.a.offsetWidth,J=y.a.offsetWidth,l();r=setTimeout(p,50)}}var t=new b(m),u=new b(m),y=new b(m),C=-1,F=-1,J=-1,I=-1,T=-1,L=-1,U=document.createElement("div");U.dir="ltr";e(t,f(g,"sans-serif"));e(u,f(g,"serif"));e(y,f(g,"monospace"));U.appendChild(t.a);U.appendChild(u.a);U.appendChild(y.a);document.body.appendChild(U);I=t.a.offsetWidth;T=u.a.offsetWidth;
L=y.a.offsetWidth;p();j(t,function(b){C=b;l()});e(t,f(g,'"'+g.family+'",sans-serif'));j(u,function(b){F=b;l()});e(u,f(g,'"'+g.family+'",serif'));j(y,function(b){J=b;l()});e(y,f(g,'"'+g.family+'",monospace'))};document.body?I():document.addEventListener?document.addEventListener("DOMContentLoaded",function P(){document.removeEventListener("DOMContentLoaded",P);I()}):document.attachEvent("onreadystatechange",function N(){if("interactive"==document.readyState||"complete"==document.readyState)document.detachEvent("onreadystatechange",
N),I()})}})};"object"===typeof module?module.exports=g:(window.FontFaceObserver=g,window.FontFaceObserver.prototype.load=g.prototype.load)})();(function(c){Number.prototype.map=function(b,c,d,e){return d+(e-d)*((this-b)/(c-b))};Number.prototype.limit=function(b,c){return Math.min(c,Math.max(b,this))};Number.prototype.round=function(b){b=Math.pow(10,b||0);return Math.round(this*b)/b};Number.prototype.floor=function(){return Math.floor(this)};Number.prototype.ceil=function(){return Math.ceil(this)};Number.prototype.toInt=function(){return this|0};Number.prototype.toRad=function(){return this/180*Math.PI};Number.prototype.toDeg=function(){return 180*
this/Math.PI};Array.prototype.erase=function(b){for(var c=this.length;c--;)this[c]===b&&this.splice(c,1);return this};Array.prototype.random=function(){return this[Math.floor(Math.random()*this.length)]};Function.prototype.bind=Function.prototype.bind||function(b){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var c=Array.prototype.slice.call(arguments,1),d=this,e=function(){},g=function(){return d.apply(this instanceof e&&b?
this:b,c.concat(Array.prototype.slice.call(arguments)))};e.prototype=this.prototype;g.prototype=new e;return g};c.ig={game:null,debug:null,version:"1.23",global:c,modules:{},resources:[],ready:!1,baked:!1,nocache:"",ua:{},prefix:c.ImpactPrefix||"",lib:"lib/",_current:null,_loadQueue:[],_waitForOnload:0,$:function(b){return"#"==b.charAt(0)?document.getElementById(b.substr(1)):document.getElementsByTagName(b)},$new:function(b){return document.createElement(b)},copy:function(b){if(!b||"object"!=typeof b||
b instanceof HTMLElement||b instanceof ig.Class)return b;if(b instanceof Array)for(var c=[],d=0,e=b.length;d<e;d++)c[d]=ig.copy(b[d]);else for(d in c={},b)c[d]=ig.copy(b[d]);return c},merge:function(b,c){for(var d in c)if(!("_mesh"===d||"_camera"===d)){var e=c[d];if("object"!=typeof e||e instanceof HTMLElement||e instanceof ig.Class||null===e)b[d]=e;else{if(!b[d]||"object"!=typeof b[d])b[d]=e instanceof Array?[]:{};ig.merge(b[d],e)}}return b},ksort:function(b){if(!b||"object"!=typeof b)return[];var c=
[],d=[],e;for(e in b)c.push(e);c.sort();for(e=0;e<c.length;e++)d.push(b[c[e]]);return d},setVendorAttribute:function(b,c,d){var e=c.charAt(0).toUpperCase()+c.substr(1);b[c]="undefined"!==typeof b.imageSmoothingEnabled?b["ms"+e]=b["moz"+e]=b["o"+e]=d:b["ms"+e]=b["moz"+e]=b["webkit"+e]=b["o"+e]=d},getVendorAttribute:function(b,c){var d=c.charAt(0).toUpperCase()+c.substr(1);return"undefined"!==typeof b.imageSmoothingEnabled?b[c]||b["ms"+d]||b["moz"+d]||b["o"+d]:b[c]||b["ms"+d]||b["moz"+d]||b["webkit"+
d]||b["o"+d]},normalizeVendorAttribute:function(b,c){var d=ig.getVendorAttribute(b,c);!b[c]&&d&&(b[c]=d)},getImagePixels:function(b,c,d,e,g){var j=ig.$new("canvas");j.width=b.width;j.height=b.height;var p=j.getContext("2d");ig.System.SCALE.CRISP(j,p);var u=ig.getVendorAttribute(p,"backingStorePixelRatio")||1;ig.normalizeVendorAttribute(p,"getImageDataHD");var v=b.width/u,z=b.height/u;j.width=Math.ceil(v);j.height=Math.ceil(z);p.drawImage(b,0,0,v,z);return 1===u?p.getImageData(c,d,e,g):p.getImageDataHD(c,
d,e,g)},module:function(b){if(ig._current)throw"Module '"+ig._current.name+"' defines nothing";if(ig.modules[b]&&ig.modules[b].body)throw"Module '"+b+"' is already defined";ig._current={name:b,requires:[],loaded:!1,body:null};ig.modules[b]=ig._current;ig._loadQueue.push(ig._current);return ig},requires:function(){ig._current.requires=Array.prototype.slice.call(arguments);return ig},defines:function(b){ig._current.body=b;ig._current=null;ig._initDOMReady()},addResource:function(b){ig.resources.push(b)},
setNocache:function(b){ig.nocache=b?"?"+Date.now():""},log:function(){},assert:function(){},show:function(){},mark:function(){},_loadScript:function(b,c){ig.modules[b]={name:b,requires:[],loaded:!1,body:null};ig._waitForOnload++;var d=ig.prefix+ig.lib+b.replace(/\./g,"/")+".js"+ig.nocache,e=ig.$new("script");e.type="text/javascript";e.src=d;e.onload=function(){ig._waitForOnload--;ig._execModules()};e.onerror=function(){throw"Failed to load module "+b+" at "+d+" required from "+c;};ig.$("head")[0].appendChild(e)},
_execModules:function(){for(var b=!1,c=0;c<ig._loadQueue.length;c++){for(var d=ig._loadQueue[c],e=!0,g=0;g<d.requires.length;g++){var j=d.requires[g];ig.modules[j]?ig.modules[j].loaded||(e=!1):(e=!1,ig._loadScript(j,d.name))}e&&d.body&&(ig._loadQueue.splice(c,1),d.loaded=!0,d.body(),b=!0,c--)}if(b)ig._execModules();else if(!ig.baked&&0==ig._waitForOnload&&0!=ig._loadQueue.length){b=[];for(c=0;c<ig._loadQueue.length;c++){e=[];j=ig._loadQueue[c].requires;for(g=0;g<j.length;g++)d=ig.modules[j[g]],(!d||
!d.loaded)&&e.push(j[g]);b.push(ig._loadQueue[c].name+" (requires: "+e.join(", ")+")")}throw"Unresolved (or circular?) dependencies. Most likely there's a name/path mismatch for one of the listed modules or a previous syntax error prevents a module from loading:\n"+b.join("\n");}},_DOMReady:function(){if(!ig.modules["dom.ready"].loaded){if(!document.body)return setTimeout(ig._DOMReady,13);ig.modules["dom.ready"].loaded=!0;ig._waitForOnload--;ig._execModules()}return 0},_boot:function(){document.location.href.match(/\?nocache/)&&
ig.setNocache(!0);ig.ua.pixelRatio=c.devicePixelRatio||1;ig.ua.viewport={width:c.innerWidth,height:c.innerHeight};ig.ua.screen={width:c.screen.availWidth*ig.ua.pixelRatio,height:c.screen.availHeight*ig.ua.pixelRatio};ig.ua.iPhone=/iPhone/i.test(navigator.userAgent);ig.ua.iPhone4=ig.ua.iPhone&&2==ig.ua.pixelRatio;ig.ua.iPad=/iPad/i.test(navigator.userAgent);ig.ua.android=/android/i.test(navigator.userAgent);ig.ua.winPhone=/Windows Phone/i.test(navigator.userAgent);ig.ua.is_uiwebview=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);
ig.ua.is_safari_or_uiwebview=/(iPhone|iPod|iPad).*AppleWebKit/i.test(navigator.userAgent);ig.ua.iOS=ig.ua.iPhone||ig.ua.iPad;ig.ua.iOS6_tag=/OS 6_/i.test(navigator.userAgent);ig.ua.iOS6=(ig.ua.iPhone||ig.ua.iPad)&&ig.ua.iOS6_tag;ig.ua.iOSgt5=ig.ua.iOS&&5<parseInt(navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/)[1]);ig.ua.HTCONE=/HTC_One/i.test(navigator.userAgent);ig.ua.winPhone=/Windows Phone/i.test(navigator.userAgent);ig.ua.Kindle=/Silk/i.test(navigator.userAgent);ig.ua.touchDevice="ontouchstart"in
c||c.navigator.msMaxTouchPoints;ig.ua.mobile=ig.ua.iOS||ig.ua.android||ig.ua.iOS6||ig.ua.winPhone||ig.ua.Kindle||/mobile/i.test(navigator.userAgent)},_initDOMReady:function(){ig.modules["dom.ready"]?ig._execModules():(ig._boot(),ig.modules["dom.ready"]={requires:[],loaded:!1,body:null},ig._waitForOnload++,"complete"===document.readyState?ig._DOMReady():(document.addEventListener("DOMContentLoaded",ig._DOMReady,!1),c.addEventListener("load",ig._DOMReady,!1)))}};ig.normalizeVendorAttribute(c,"requestAnimationFrame");
if(c.requestAnimationFrame){var b=1,e={};c.ig.setAnimation=function(d){var f=b++;e[f]=!0;var g=function(){e[f]&&(c.requestAnimationFrame(g),d())};c.requestAnimationFrame(g);return f};c.ig.clearAnimation=function(b){delete e[b]}}else c.ig.setAnimation=function(b){return c.setInterval(b,1E3/60)},c.ig.clearAnimation=function(b){c.clearInterval(b)};var d=!1,j=/xyz/.test(function(){xyz})?/\bparent\b/:/.*/,g=0;c.ig.Class=function(){};var p=function(b){var c=this.prototype,d={},e;for(e in b)"function"==
typeof b[e]&&"function"==typeof c[e]&&j.test(b[e])?(d[e]=c[e],c[e]=function(b,c){return function(){var e=this.parent;this.parent=d[b];var f=c.apply(this,arguments);this.parent=e;return f}}(e,b[e])):c[e]=b[e]};c.ig.Class.extend=function(b){function e(){if(!d){if(this.staticInstantiate){var b=this.staticInstantiate.apply(this,arguments);if(b)return b}for(var c in this)"object"==typeof this[c]&&(this[c]=ig.copy(this[c]));this.init&&this.init.apply(this,arguments)}return this}var n=this.prototype;d=!0;
var l=new this;d=!1;for(var r in b)l[r]="function"==typeof b[r]&&"function"==typeof n[r]&&j.test(b[r])?function(b,c){return function(){var d=this.parent;this.parent=n[b];var e=c.apply(this,arguments);this.parent=d;return e}}(r,b[r]):b[r];e.prototype=l;e.prototype.constructor=e;e.extend=c.ig.Class.extend;e.inject=p;e.classId=l.classId=++g;return e};c.ImpactMixin&&ig.merge(ig,c.ImpactMixin)})(window);ig.baked=!0;
ig.module("impact.image").defines(function(){ig.Image=ig.Class.extend({data:null,width:0,height:0,loaded:!1,failed:!1,loadCallback:null,path:"",staticInstantiate:function(c){return ig.Image.cache[c]||null},init:function(c){this.path=c;this.load()},load:function(c){this.loaded?c&&c(this.path,!0):(!this.loaded&&ig.ready?(this.loadCallback=c||null,this.data=new Image,this.data.onload=this.onload.bind(this),this.data.onerror=this.onerror.bind(this),this.data.src=ig.prefix+this.path+ig.nocache):ig.addResource(this),
ig.Image.cache[this.path]=this)},reload:function(){this.loaded=!1;this.data=new Image;this.data.onload=this.onload.bind(this);this.data.src=this.path+"?"+Date.now()},onload:function(){this.width=this.data.width;this.height=this.data.height;this.loaded=!0;1!=ig.system.scale&&this.resize(ig.system.scale);this.loadCallback&&this.loadCallback(this.path,!0)},onerror:function(){this.failed=!0;this.loadCallback&&this.loadCallback(this.path,!1)},resize:function(c){var b=ig.getImagePixels(this.data,0,0,this.width,
this.height),e=this.width*c,d=this.height*c,j=ig.$new("canvas");j.width=e;j.height=d;for(var g=j.getContext("2d"),p=g.getImageData(0,0,e,d),m=0;m<d;m++)for(var f=0;f<e;f++){var n=4*(Math.floor(m/c)*this.width+Math.floor(f/c)),l=4*(m*e+f);p.data[l]=b.data[n];p.data[l+1]=b.data[n+1];p.data[l+2]=b.data[n+2];p.data[l+3]=b.data[n+3]}g.putImageData(p,0,0);this.data=j},draw:function(c,b,e,d,j,g){if(this.loaded){var p=ig.system.scale;j=(j?j:this.width)*p;g=(g?g:this.height)*p;ig.system.context.drawImage(this.data,
e?e*p:0,d?d*p:0,j,g,ig.system.getDrawPos(c),ig.system.getDrawPos(b),j,g);ig.Image.drawCount++}},drawTile:function(c,b,e,d,j,g,p){j=j?j:d;if(this.loaded&&!(d>this.width||j>this.height)){var m=ig.system.scale,f=Math.floor(d*m),n=Math.floor(j*m),l=g?-1:1,r=p?-1:1;if(g||p)ig.system.context.save(),ig.system.context.scale(l,r);ig.system.context.drawImage(this.data,Math.floor(e*d)%this.width*m,Math.floor(e*d/this.width)*j*m,f,n,ig.system.getDrawPos(c)*l-(g?f:0),ig.system.getDrawPos(b)*r-(p?n:0),f,n);(g||
p)&&ig.system.context.restore();ig.Image.drawCount++}}});ig.Image.drawCount=0;ig.Image.cache={};ig.Image.reloadCache=function(){for(var c in ig.Image.cache)ig.Image.cache[c].reload()}});ig.baked=!0;
ig.module("impact.font").requires("impact.image").defines(function(){ig.Font=ig.Image.extend({widthMap:[],indices:[],firstChar:32,alpha:1,letterSpacing:1,lineSpacing:0,onload:function(c){this._loadMetrics(this.data);this.parent(c)},widthForString:function(c){if(-1!==c.indexOf("\n")){c=c.split("\n");for(var b=0,e=0;e<c.length;e++)b=Math.max(b,this._widthForLine(c[e]));return b}return this._widthForLine(c)},_widthForLine:function(c){for(var b=0,e=0;e<c.length;e++)b+=this.widthMap[c.charCodeAt(e)-this.firstChar]+
this.letterSpacing;return b},heightForString:function(c){return c.split("\n").length*(this.height+this.lineSpacing)},draw:function(c,b,e,d){"string"!=typeof c&&(c=c.toString());if(-1!==c.indexOf("\n")){c=c.split("\n");for(var j=this.height+this.lineSpacing,g=0;g<c.length;g++)this.draw(c[g],b,e+g*j,d)}else{if(d==ig.Font.ALIGN.RIGHT||d==ig.Font.ALIGN.CENTER)g=this._widthForLine(c),b-=d==ig.Font.ALIGN.CENTER?g/2:g;1!==this.alpha&&(ig.system.context.globalAlpha=this.alpha);for(g=0;g<c.length;g++)d=c.charCodeAt(g),
b+=this._drawChar(d-this.firstChar,b,e);1!==this.alpha&&(ig.system.context.globalAlpha=1);ig.Image.drawCount+=c.length}},_drawChar:function(c,b,e){if(!this.loaded||0>c||c>=this.indices.length)return 0;var d=ig.system.scale,j=this.widthMap[c]*d,g=(this.height-2)*d;ig.system.context.drawImage(this.data,this.indices[c]*d,0,j,g,ig.system.getDrawPos(b),ig.system.getDrawPos(e),j,g);return this.widthMap[c]+this.letterSpacing},_loadMetrics:function(c){this.height=c.height-1;this.widthMap=[];this.indices=
[];for(var b=ig.getImagePixels(c,0,c.height-1,c.width,1),e=0,d=0,j=0;j<c.width;j++){var g=4*j+3;127<b.data[g]?d++:128>b.data[g]&&d&&(this.widthMap.push(d),this.indices.push(j-d),e++,d=0)}this.widthMap.push(d);this.indices.push(j-d)}});ig.Font.ALIGN={LEFT:0,RIGHT:1,CENTER:2}});ig.baked=!0;
ig.module("impact.sound").defines(function(){ig.SoundManager=ig.Class.extend({clips:{},volume:1,format:null,init:function(){if(!ig.Sound.enabled||!window.Audio)ig.Sound.enabled=!1;else{for(var c=new Audio,b=0;b<ig.Sound.use.length;b++){var e=ig.Sound.use[b];if(c.canPlayType(e.mime)){this.format=e;break}}this.format||(ig.Sound.enabled=!1)}},load:function(c,b,e){var d=ig.prefix+c.replace(/[^\.]+$/,this.format.ext)+ig.nocache;if(this.clips[c]){if(b&&this.clips[c].length<ig.Sound.channels)for(b=this.clips[c].length;b<
ig.Sound.channels;b++){var j=new Audio(d);j.load();this.clips[c].push(j)}return this.clips[c][0]}var g=new Audio(d);e&&(g.addEventListener("canplaythrough",function m(b){g.removeEventListener("canplaythrough",m,!1);e(c,!0,b)},!1),g.addEventListener("error",function(b){e(c,!1,b)},!1));g.preload="auto";g.load();this.clips[c]=[g];if(b)for(b=1;b<ig.Sound.channels;b++)j=new Audio(d),j.load(),this.clips[c].push(j);return g},get:function(c){c=this.clips[c];for(var b=0,e;e=c[b++];)if(e.paused||e.ended)return e.ended&&
(e.currentTime=0),e;c[0].pause();c[0].currentTime=0;return c[0]}});ig.Music=ig.Class.extend({tracks:[],namedTracks:{},currentTrack:null,currentIndex:0,random:!1,_volume:1,_loop:!1,_fadeInterval:0,_fadeTimer:null,_endedCallbackBound:null,init:function(){this._endedCallbackBound=this._endedCallback.bind(this);Object.defineProperty?(Object.defineProperty(this,"volume",{get:this.getVolume.bind(this),set:this.setVolume.bind(this)}),Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)})):
this.__defineGetter__&&(this.__defineGetter__("volume",this.getVolume.bind(this)),this.__defineSetter__("volume",this.setVolume.bind(this)),this.__defineGetter__("loop",this.getLooping.bind(this)),this.__defineSetter__("loop",this.setLooping.bind(this)))},add:function(c,b){if(ig.Sound.enabled){var e=ig.soundManager.load(c instanceof ig.Sound?c.path:c,!1);e.loop=this._loop;e.volume=this._volume;e.addEventListener("ended",this._endedCallbackBound,!1);this.tracks.push(e);b&&(this.namedTracks[b]=e);this.currentTrack||
(this.currentTrack=e)}},next:function(){this.tracks.length&&(this.stop(),this.currentIndex=this.random?Math.floor(Math.random()*this.tracks.length):(this.currentIndex+1)%this.tracks.length,this.currentTrack=this.tracks[this.currentIndex],this.play())},pause:function(){this.currentTrack&&this.currentTrack.pause()},stop:function(){this.currentTrack&&(this.currentTrack.pause(),this.currentTrack.currentTime=0)},play:function(c){if(c&&this.namedTracks[c])c=this.namedTracks[c],c!=this.currentTrack&&(this.stop(),
this.currentTrack=c);else if(!this.currentTrack)return;this.currentTrack.play()},getLooping:function(){return this._loop},setLooping:function(c){this._loop=c;for(var b in this.tracks)this.tracks[b].loop=c},getVolume:function(){return this._volume},setVolume:function(c){this._volume=c.limit(0,1);for(var b in this.tracks)this.tracks[b].volume=this._volume},fadeOut:function(c){this.currentTrack&&(clearInterval(this._fadeInterval),this.fadeTimer=new ig.Timer(c),this._fadeInterval=setInterval(this._fadeStep.bind(this),
50))},_fadeStep:function(){var c=this.fadeTimer.delta().map(-this.fadeTimer.target,0,1,0).limit(0,1)*this._volume;0.01>=c?(this.stop(),this.currentTrack.volume=this._volume,clearInterval(this._fadeInterval)):this.currentTrack.volume=c},_endedCallback:function(){this._loop?this.play():this.next()}});ig.Sound=ig.Class.extend({path:"",volume:1,currentClip:null,multiChannel:!0,init:function(c,b){this.path=c;this.multiChannel=!1!==b;this.load()},load:function(c){ig.Sound.enabled?ig.ready?ig.soundManager.load(this.path,
this.multiChannel,c):ig.addResource(this):c&&c(this.path,!0)},play:function(){ig.Sound.enabled&&(this.currentClip=ig.soundManager.get(this.path),this.currentClip.volume=ig.soundManager.volume*this.volume,this.currentClip.play())},stop:function(){this.currentClip&&(this.currentClip.pause(),this.currentClip.currentTime=0)}});ig.Sound.FORMAT={MP3:{ext:"mp3",mime:"audio/mpeg"},M4A:{ext:"m4a",mime:"audio/mp4; codecs=mp4a"},OGG:{ext:"ogg",mime:"audio/ogg; codecs=vorbis"},WEBM:{ext:"webm",mime:"audio/webm; codecs=vorbis"},
CAF:{ext:"caf",mime:"audio/x-caf"}};ig.Sound.use=[ig.Sound.FORMAT.OGG,ig.Sound.FORMAT.MP3];ig.Sound.channels=4;ig.Sound.enabled=!0});ig.baked=!0;
ig.module("impact.loader").requires("impact.image","impact.font","impact.sound").defines(function(){ig.Loader=ig.Class.extend({resources:[],gameClass:null,status:0,done:!1,_unloaded:[],_drawStatus:0,_intervalId:0,_loadCallbackBound:null,init:function(c,b){this.gameClass=c;this.resources=b;this._loadCallbackBound=this._loadCallback.bind(this);for(var e=0;e<this.resources.length;e++)this._unloaded.push(this.resources[e].path)},load:function(){ig.system.clear("#000");if(this.resources.length){for(var c=
0;c<this.resources.length;c++)this.loadResource(this.resources[c]);this._intervalId=setInterval(this.draw.bind(this),16)}else this.end()},loadResource:function(c){c.load(this._loadCallbackBound)},end:function(){this.done||(this.done=!0,clearInterval(this._intervalId))},draw:function(){},_loadCallback:function(c,b){if(b)this._unloaded.erase(c);else throw"Failed to load resource: "+c;this.status=1-this._unloaded.length/this.resources.length;0==this._unloaded.length&&setTimeout(this.end.bind(this),250)}})});
ig.baked=!0;
ig.module("impact.timer").defines(function(){ig.Timer=ig.Class.extend({target:0,base:0,last:0,pausedAt:0,init:function(c){this.last=this.base=ig.Timer.time;this.target=c||0},set:function(c){this.target=c||0;this.base=ig.Timer.time;this.pausedAt=0},reset:function(){this.base=ig.Timer.time;this.pausedAt=0},tick:function(){var c=ig.Timer.time-this.last;this.last=ig.Timer.time;return this.pausedAt?0:c},delta:function(){return(this.pausedAt||ig.Timer.time)-this.base-this.target},pause:function(){this.pausedAt||(this.pausedAt=
ig.Timer.time)},unpause:function(){this.pausedAt&&(this.base+=ig.Timer.time-this.pausedAt,this.pausedAt=0)}});ig.Timer._last=0;ig.Timer.time=Number.MIN_VALUE;ig.Timer.timeScale=1;ig.Timer.maxStep=0.05;ig.Timer.step=function(){var c=Date.now();ig.Timer.time+=Math.min((c-ig.Timer._last)/1E3,ig.Timer.maxStep)*ig.Timer.timeScale;ig.Timer._last=c}});ig.baked=!0;
ig.module("impact.system").requires("impact.timer","impact.image").defines(function(){ig.System=ig.Class.extend({fps:30,width:320,height:240,realWidth:320,realHeight:240,scale:1,tick:0,animationId:0,newGameClass:null,running:!1,delegate:null,clock:null,canvas:null,context:null,init:function(c,b,e,d,j){this.fps=b;this.clock=new ig.Timer;this.canvas=ig.$(c);this.resize(e,d,j);this.context=this.canvas.getContext("2d");this.getDrawPos=ig.System.drawMode;1!=this.scale&&(ig.System.scaleMode=ig.System.SCALE.CRISP);
ig.System.scaleMode(this.canvas,this.context)},resize:function(c,b,e){this.width=c;this.height=b;this.scale=e||this.scale;this.realWidth=this.width*this.scale;this.realHeight=this.height*this.scale;this.canvas.width=this.realWidth;this.canvas.height=this.realHeight},setGame:function(c){this.running?this.newGameClass=c:this.setGameNow(c)},setGameNow:function(c){ig.game=new c;ig.system.setDelegate(ig.game)},setDelegate:function(c){if("function"==typeof c.run)this.delegate=c,this.startRunLoop();else throw"System.setDelegate: No run() function in object";
},stopRunLoop:function(){ig.clearAnimation(this.animationId);this.running=!1},startRunLoop:function(){this.stopRunLoop();this.animationId=ig.setAnimation(this.run.bind(this));this.running=!0},clear:function(c){this.context.fillStyle=c;this.context.fillRect(0,0,this.realWidth,this.realHeight)},run:function(){ig.Timer.step();this.tick=this.clock.tick();this.delegate.run();ig.input.clearPressed();this.newGameClass&&(this.setGameNow(this.newGameClass),this.newGameClass=null)},getDrawPos:null});ig.System.DRAW=
{AUTHENTIC:function(c){return Math.round(c)*this.scale},SMOOTH:function(c){return Math.round(c*this.scale)},SUBPIXEL:function(c){return c*this.scale}};ig.System.drawMode=ig.System.DRAW.SMOOTH;ig.System.SCALE={CRISP:function(c,b){ig.setVendorAttribute(b,"imageSmoothingEnabled",!1);c.style.imageRendering="-moz-crisp-edges";c.style.imageRendering="-o-crisp-edges";c.style.imageRendering="-webkit-optimize-contrast";c.style.imageRendering="crisp-edges";c.style.msInterpolationMode="nearest-neighbor"},SMOOTH:function(c,
b){ig.setVendorAttribute(b,"imageSmoothingEnabled",!0);c.style.imageRendering="";c.style.msInterpolationMode=""}};ig.System.scaleMode=ig.System.SCALE.SMOOTH});ig.baked=!0;
ig.module("impact.input").defines(function(){ig.KEY={MOUSE1:-1,MOUSE2:-3,MWHEEL_UP:-4,MWHEEL_DOWN:-5,BACKSPACE:8,TAB:9,ENTER:13,PAUSE:19,CAPS:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,_0:48,_1:49,_2:50,_3:51,_4:52,_5:53,_6:54,_7:55,_8:56,_9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,
NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SHIFT:16,CTRL:17,ALT:18,PLUS:187,COMMA:188,MINUS:189,PERIOD:190};ig.Input=ig.Class.extend({bindings:{},actions:{},presses:{},locks:{},delayedKeyup:{},isUsingMouse:!1,isUsingKeyboard:!1,isUsingAccelerometer:!1,mouse:{x:0,y:0},accel:{x:0,y:0,z:0},initMouse:function(){if(!this.isUsingMouse){this.isUsingMouse=
!0;var c=this.mousewheel.bind(this);ig.system.canvas.addEventListener("wheel",c,!1);ig.system.canvas.addEventListener("mousewheel",c,!1);ig.system.canvas.addEventListener("DOMMouseScroll",c,!1);ig.system.canvas.addEventListener("contextmenu",this.contextmenu.bind(this),!1);ig.system.canvas.addEventListener("mousedown",this.keydown.bind(this),!1);ig.system.canvas.addEventListener("mouseup",this.keyup.bind(this),!1);ig.system.canvas.addEventListener("mousemove",this.mousemove.bind(this),!1);ig.ua.touchDevice&&
(ig.system.canvas.addEventListener("touchstart",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.mousemove.bind(this),!1),ig.system.canvas.addEventListener("MSPointerDown",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("MSPointerUp",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",this.mousemove.bind(this),!1),ig.system.canvas.style.msTouchAction="none")}},
initKeyboard:function(){this.isUsingKeyboard||(this.isUsingKeyboard=!0,window.addEventListener("keydown",this.keydown.bind(this),!1),window.addEventListener("keyup",this.keyup.bind(this),!1))},initAccelerometer:function(){this.isUsingAccelerometer||window.addEventListener("devicemotion",this.devicemotion.bind(this),!1)},mousewheel:function(c){var b=this.bindings[0<(c.wheelDelta?c.wheelDelta:-1*c.detail)?ig.KEY.MWHEEL_UP:ig.KEY.MWHEEL_DOWN];b&&(this.actions[b]=!0,this.presses[b]=!0,this.delayedKeyup[b]=
!0,c.stopPropagation(),c.preventDefault())},mousemove:function(c){var b=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth;ig.ua.mobile&&(b=ig.system.realWidth);var b=ig.system.scale*(b/ig.system.realWidth),e={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());c=c.touches?c.touches[0]:c;this.mouse.x=(c.clientX-e.left)/b;this.mouse.y=(c.clientY-e.top)/b},contextmenu:function(c){this.bindings[ig.KEY.MOUSE2]&&(c.stopPropagation(),c.preventDefault())},
keydown:function(c){var b=c.target.tagName;"INPUT"==b||"TEXTAREA"==b||(b="keydown"==c.type?c.keyCode:2==c.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1,("touchstart"==c.type||"mousedown"==c.type)&&this.mousemove(c),b=this.bindings[b],console.log(b),b&&(this.actions[b]=!0,this.locks[b]||(this.presses[b]=!0,this.locks[b]=!0),c.stopPropagation(),c.preventDefault()))},keyup:function(c){var b=c.target.tagName;if(!("INPUT"==b||"TEXTAREA"==b))if(b=this.bindings["keyup"==c.type?c.keyCode:2==c.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1])this.delayedKeyup[b]=
!0,c.stopPropagation(),c.preventDefault()},devicemotion:function(c){this.accel=c.accelerationIncludingGravity},bind:function(c,b){0>c?this.initMouse():0<c&&this.initKeyboard();this.bindings[c]=b},bindTouch:function(c,b){var e=ig.$(c),d=this;e.addEventListener("touchstart",function(c){d.touchStart(c,b)},!1);e.addEventListener("touchend",function(c){d.touchEnd(c,b)},!1);e.addEventListener("MSPointerDown",function(c){d.touchStart(c,b)},!1);e.addEventListener("MSPointerUp",function(c){d.touchEnd(c,b)},
!1)},unbind:function(c){this.delayedKeyup[this.bindings[c]]=!0;this.bindings[c]=null},unbindAll:function(){this.bindings={};this.actions={};this.presses={};this.locks={};this.delayedKeyup={}},state:function(c){return this.actions[c]},pressed:function(c){return this.presses[c]},released:function(c){return!!this.delayedKeyup[c]},clearPressed:function(){for(var c in this.delayedKeyup)this.actions[c]=!1,this.locks[c]=!1;this.delayedKeyup={};this.presses={}},touchStart:function(c,b){this.actions[b]=!0;
this.presses[b]=!0;c.stopPropagation();c.preventDefault();return!1},touchEnd:function(c,b){this.delayedKeyup[b]=!0;c.stopPropagation();c.preventDefault();return!1}})});ig.baked=!0;ig.module("impact.impact").requires("dom.ready","impact.loader","impact.system","impact.input","impact.sound").defines(function(){ig.main=function(c,b,e,d,j,g,p){ig.system=new ig.System(c,e,d,j,g||1);ig.input=new ig.Input;ig.soundManager=new ig.SoundManager;ig.music=new ig.Music;ig.ready=!0;(new (p||ig.Loader)(b,ig.resources)).load()}});
ig.baked=!0;
ig.module("impact.animation").requires("impact.timer","impact.image").defines(function(){ig.AnimationSheet=ig.Class.extend({width:8,height:8,image:null,init:function(c,b,e){this.width=b;this.height=e;this.image=new ig.Image(c)}});ig.Animation=ig.Class.extend({sheet:null,timer:null,sequence:[],flip:{x:!1,y:!1},pivot:{x:0,y:0},frame:0,tile:0,loopCount:0,alpha:1,angle:0,init:function(c,b,e,d){this.sheet=c;this.pivot={x:c.width/2,y:c.height/2};this.timer=new ig.Timer;this.frameTime=b;this.sequence=e;
this.stop=!!d;this.tile=this.sequence[0]},rewind:function(){this.timer.set();this.frame=this.loopCount=0;this.tile=this.sequence[0];return this},gotoFrame:function(c){this.timer.set(this.frameTime*-c-1E-4);this.update()},gotoRandomFrame:function(){this.gotoFrame(Math.floor(Math.random()*this.sequence.length))},update:function(){var c=Math.floor(this.timer.delta()/this.frameTime);this.loopCount=Math.floor(c/this.sequence.length);this.frame=this.stop&&0<this.loopCount?this.sequence.length-1:c%this.sequence.length;
this.tile=this.sequence[this.frame]},draw:function(c,b){var e=Math.max(this.sheet.width,this.sheet.height);c>ig.system.width||(b>ig.system.height||0>c+e||0>b+e)||(1!=this.alpha&&(ig.system.context.globalAlpha=this.alpha),0==this.angle?this.sheet.image.drawTile(c,b,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y):(ig.system.context.save(),ig.system.context.translate(ig.system.getDrawPos(c+this.pivot.x),ig.system.getDrawPos(b+this.pivot.y)),ig.system.context.rotate(this.angle),
this.sheet.image.drawTile(-this.pivot.x,-this.pivot.y,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y),ig.system.context.restore()),1!=this.alpha&&(ig.system.context.globalAlpha=1))}})});ig.baked=!0;
ig.module("impact.entity").requires("impact.animation","impact.impact").defines(function(){ig.Entity=ig.Class.extend({id:0,settings:{},size:{x:16,y:16},offset:{x:0,y:0},pos:{x:0,y:0},last:{x:0,y:0},vel:{x:0,y:0},accel:{x:0,y:0},friction:{x:0,y:0},maxVel:{x:100,y:100},zIndex:0,gravityFactor:1,standing:!1,bounciness:0,minBounceVelocity:40,anims:{},animSheet:null,currentAnim:null,health:10,type:0,checkAgainst:0,collides:0,_killed:!1,slopeStanding:{min:(44).toRad(),max:(136).toRad()},init:function(c,
b,e){this.id=++ig.Entity._lastId;this.pos.x=this.last.x=c;this.pos.y=this.last.y=b;ig.merge(this,e)},reset:function(c,b,e){var d=this.constructor.prototype;this.pos.x=c;this.pos.y=b;this.last.x=c;this.last.y=b;this.vel.x=d.vel.x;this.vel.y=d.vel.y;this.accel.x=d.accel.x;this.accel.y=d.accel.y;this.health=d.health;this._killed=d._killed;this.standing=d.standing;this.type=d.type;this.checkAgainst=d.checkAgainst;this.collides=d.collides;ig.merge(this,e)},addAnim:function(c,b,e,d){if(!this.animSheet)throw"No animSheet to add the animation "+
c+" to.";b=new ig.Animation(this.animSheet,b,e,d);this.anims[c]=b;this.currentAnim||(this.currentAnim=b);return b},update:function(){this.last.x=this.pos.x;this.last.y=this.pos.y;this.vel.y+=ig.game.gravity*ig.system.tick*this.gravityFactor;this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x);this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y,this.friction.y,this.maxVel.y);var c=ig.game.collisionMap.trace(this.pos.x,this.pos.y,this.vel.x*ig.system.tick,this.vel.y*
ig.system.tick,this.size.x,this.size.y);this.handleMovementTrace(c);this.currentAnim&&this.currentAnim.update()},getNewVelocity:function(c,b,e,d){return b?(c+b*ig.system.tick).limit(-d,d):e?(b=e*ig.system.tick,0<c-b?c-b:0>c+b?c+b:0):c.limit(-d,d)},handleMovementTrace:function(c){this.standing=!1;c.collision.y&&(0<this.bounciness&&Math.abs(this.vel.y)>this.minBounceVelocity?this.vel.y*=-this.bounciness:(0<this.vel.y&&(this.standing=!0),this.vel.y=0));c.collision.x&&(this.vel.x=0<this.bounciness&&Math.abs(this.vel.x)>
this.minBounceVelocity?this.vel.x*-this.bounciness:0);if(c.collision.slope){var b=c.collision.slope;if(0<this.bounciness){var e=this.vel.x*b.nx+this.vel.y*b.ny;this.vel.x=(this.vel.x-2*b.nx*e)*this.bounciness;this.vel.y=(this.vel.y-2*b.ny*e)*this.bounciness}else e=(this.vel.x*b.x+this.vel.y*b.y)/(b.x*b.x+b.y*b.y),this.vel.x=b.x*e,this.vel.y=b.y*e,b=Math.atan2(b.x,b.y),b>this.slopeStanding.min&&b<this.slopeStanding.max&&(this.standing=!0)}this.pos=c.pos},draw:function(){this.currentAnim&&this.currentAnim.draw(this.pos.x-
this.offset.x-ig.game._rscreen.x,this.pos.y-this.offset.y-ig.game._rscreen.y)},kill:function(){ig.game.removeEntity(this)},receiveDamage:function(c){this.health-=c;0>=this.health&&this.kill()},touches:function(c){return!(this.pos.x>=c.pos.x+c.size.x||this.pos.x+this.size.x<=c.pos.x||this.pos.y>=c.pos.y+c.size.y||this.pos.y+this.size.y<=c.pos.y)},distanceTo:function(c){var b=this.pos.x+this.size.x/2-(c.pos.x+c.size.x/2);c=this.pos.y+this.size.y/2-(c.pos.y+c.size.y/2);return Math.sqrt(b*b+c*c)},angleTo:function(c){return Math.atan2(c.pos.y+
c.size.y/2-(this.pos.y+this.size.y/2),c.pos.x+c.size.x/2-(this.pos.x+this.size.x/2))},check:function(){},collideWith:function(){},ready:function(){},erase:function(){}});ig.Entity._lastId=0;ig.Entity.COLLIDES={NEVER:0,LITE:1,PASSIVE:2,ACTIVE:4,FIXED:8};ig.Entity.TYPE={NONE:0,A:1,B:2,BOTH:3};ig.Entity.checkPair=function(c,b){c.checkAgainst&b.type&&c.check(b);b.checkAgainst&c.type&&b.check(c);c.collides&&(b.collides&&c.collides+b.collides>ig.Entity.COLLIDES.ACTIVE)&&ig.Entity.solveCollision(c,b)};ig.Entity.solveCollision=
function(c,b){var e=null;if(c.collides==ig.Entity.COLLIDES.LITE||b.collides==ig.Entity.COLLIDES.FIXED)e=c;else if(b.collides==ig.Entity.COLLIDES.LITE||c.collides==ig.Entity.COLLIDES.FIXED)e=b;c.last.x+c.size.x>b.last.x&&c.last.x<b.last.x+b.size.x?(c.last.y<b.last.y?ig.Entity.seperateOnYAxis(c,b,e):ig.Entity.seperateOnYAxis(b,c,e),c.collideWith(b,"y"),b.collideWith(c,"y")):c.last.y+c.size.y>b.last.y&&c.last.y<b.last.y+b.size.y&&(c.last.x<b.last.x?ig.Entity.seperateOnXAxis(c,b,e):ig.Entity.seperateOnXAxis(b,
c,e),c.collideWith(b,"x"),b.collideWith(c,"x"))};ig.Entity.seperateOnXAxis=function(c,b,e){var d=c.pos.x+c.size.x-b.pos.x;e?(e.vel.x=-e.vel.x*e.bounciness+(c===e?b:c).vel.x,b=ig.game.collisionMap.trace(e.pos.x,e.pos.y,e==c?-d:d,0,e.size.x,e.size.y),e.pos.x=b.pos.x):(e=(c.vel.x-b.vel.x)/2,c.vel.x=-e,b.vel.x=e,e=ig.game.collisionMap.trace(c.pos.x,c.pos.y,-d/2,0,c.size.x,c.size.y),c.pos.x=Math.floor(e.pos.x),c=ig.game.collisionMap.trace(b.pos.x,b.pos.y,d/2,0,b.size.x,b.size.y),b.pos.x=Math.ceil(c.pos.x))};
ig.Entity.seperateOnYAxis=function(c,b,e){var d=c.pos.y+c.size.y-b.pos.y;if(e){b=c===e?b:c;e.vel.y=-e.vel.y*e.bounciness+b.vel.y;var j=0;e==c&&Math.abs(e.vel.y-b.vel.y)<e.minBounceVelocity&&(e.standing=!0,j=b.vel.x*ig.system.tick);c=ig.game.collisionMap.trace(e.pos.x,e.pos.y,j,e==c?-d:d,e.size.x,e.size.y);e.pos.y=c.pos.y;e.pos.x=c.pos.x}else ig.game.gravity&&(b.standing||0<c.vel.y)?(e=ig.game.collisionMap.trace(c.pos.x,c.pos.y,0,-(c.pos.y+c.size.y-b.pos.y),c.size.x,c.size.y),c.pos.y=e.pos.y,0<c.bounciness&&
c.vel.y>c.minBounceVelocity?c.vel.y*=-c.bounciness:(c.standing=!0,c.vel.y=0)):(e=(c.vel.y-b.vel.y)/2,c.vel.y=-e,b.vel.y=e,j=b.vel.x*ig.system.tick,e=ig.game.collisionMap.trace(c.pos.x,c.pos.y,j,-d/2,c.size.x,c.size.y),c.pos.y=e.pos.y,c=ig.game.collisionMap.trace(b.pos.x,b.pos.y,0,d/2,b.size.x,b.size.y),b.pos.y=c.pos.y)}});ig.baked=!0;
ig.module("impact.map").defines(function(){ig.Map=ig.Class.extend({tilesize:8,width:1,height:1,data:[[]],name:null,init:function(c,b){this.tilesize=c;this.data=b;this.height=b.length;this.width=b[0].length;this.pxWidth=this.width*this.tilesize;this.pxHeight=this.height*this.tilesize},getTile:function(c,b){var e=Math.floor(c/this.tilesize),d=Math.floor(b/this.tilesize);return 0<=e&&e<this.width&&0<=d&&d<this.height?this.data[d][e]:0},setTile:function(c,b,e){c=Math.floor(c/this.tilesize);b=Math.floor(b/
this.tilesize);0<=c&&c<this.width&&(0<=b&&b<this.height)&&(this.data[b][c]=e)}})});ig.baked=!0;
ig.module("impact.collision-map").requires("impact.map").defines(function(){ig.CollisionMap=ig.Map.extend({lastSlope:1,tiledef:null,init:function(b,c,j){this.parent(b,c);this.tiledef=j||ig.CollisionMap.defaultTileDef;for(var g in this.tiledef)g|0>this.lastSlope&&(this.lastSlope=g|0)},trace:function(b,c,j,g,p,m){var f={collision:{x:!1,y:!1,slope:!1},pos:{x:b,y:c},tile:{x:0,y:0}},n=Math.ceil(Math.max(Math.abs(j),Math.abs(g))/this.tilesize);if(1<n)for(var l=j/n,r=g/n,s=0;s<n&&(l||r)&&!(this._traceStep(f,
b,c,l,r,p,m,j,g,s),b=f.pos.x,c=f.pos.y,f.collision.x&&(j=l=0),f.collision.y&&(g=r=0),f.collision.slope);s++);else this._traceStep(f,b,c,j,g,p,m,j,g,0);return f},_traceStep:function(b,c,j,g,p,m,f,n,l,r){b.pos.x+=g;b.pos.y+=p;var s=0;if(g){var t=0<g?m:0,u=0>g?this.tilesize:0,s=Math.max(Math.floor(j/this.tilesize),0),v=Math.min(Math.ceil((j+f)/this.tilesize),this.height);g=Math.floor((b.pos.x+t)/this.tilesize);var z=Math.floor((c+t)/this.tilesize);if(0<r||g==z||0>z||z>=this.width)z=-1;if(0<=g&&g<this.width)for(var x=
s;x<v&&!(-1!=z&&(s=this.data[x][z],1<s&&s<=this.lastSlope&&this._checkTileDef(b,s,c,j,n,l,m,f,z,x)));x++)if(s=this.data[x][g],1==s||s>this.lastSlope||1<s&&this._checkTileDef(b,s,c,j,n,l,m,f,g,x)){if(1<s&&s<=this.lastSlope&&b.collision.slope)break;b.collision.x=!0;b.tile.x=s;c=b.pos.x=g*this.tilesize-t+u;n=0;break}}if(p){t=0<p?f:0;p=0>p?this.tilesize:0;s=Math.max(Math.floor(b.pos.x/this.tilesize),0);u=Math.min(Math.ceil((b.pos.x+m)/this.tilesize),this.width);x=Math.floor((b.pos.y+t)/this.tilesize);
v=Math.floor((j+t)/this.tilesize);if(0<r||x==v||0>v||v>=this.height)v=-1;if(0<=x&&x<this.height)for(g=s;g<u&&!(-1!=v&&(s=this.data[v][g],1<s&&s<=this.lastSlope&&this._checkTileDef(b,s,c,j,n,l,m,f,g,v)));g++)if(s=this.data[x][g],1==s||s>this.lastSlope||1<s&&this._checkTileDef(b,s,c,j,n,l,m,f,g,x)){if(1<s&&s<=this.lastSlope&&b.collision.slope)break;b.collision.y=!0;b.tile.y=s;b.pos.y=x*this.tilesize-t+p;break}}},_checkTileDef:function(b,c,j,g,p,m,f,n,l,r){var s=this.tiledef[c];if(!s)return!1;c=(s[2]-
s[0])*this.tilesize;var t=(s[3]-s[1])*this.tilesize,u=s[4];f=j+p+(0>t?f:0)-(l+s[0])*this.tilesize;n=g+m+(0<c?n:0)-(r+s[1])*this.tilesize;if(0<c*n-t*f){if(0>p*-t+m*c)return u;l=Math.sqrt(c*c+t*t);r=t/l;l=-c/l;var v=f*r+n*l,s=r*v,v=l*v;if(s*s+v*v>=p*p+m*m)return u||0.5>c*(n-m)-t*(f-p);b.pos.x=j+p-s;b.pos.y=g+m-v;b.collision.slope={x:c,y:t,nx:r,ny:l};return!0}return!1}});var c=1/3,b=2/3;ig.CollisionMap.defaultTileDef={5:[0,1,1,b,!0],6:[0,b,1,c,!0],7:[0,c,1,0,!0],3:[0,1,1,0.5,!0],4:[0,0.5,1,0,!0],2:[0,
1,1,0,!0],10:[0.5,1,1,0,!0],21:[0,1,0.5,0,!0],32:[b,1,1,0,!0],43:[c,1,b,0,!0],54:[0,1,c,0,!0],27:[0,0,1,c,!0],28:[0,c,1,b,!0],29:[0,b,1,1,!0],25:[0,0,1,0.5,!0],26:[0,0.5,1,1,!0],24:[0,0,1,1,!0],11:[0,0,0.5,1,!0],22:[0.5,0,1,1,!0],33:[0,0,c,1,!0],44:[c,0,b,1,!0],55:[b,0,1,1,!0],16:[1,c,0,0,!0],17:[1,b,0,c,!0],18:[1,1,0,b,!0],14:[1,0.5,0,0,!0],15:[1,1,0,0.5,!0],13:[1,1,0,0,!0],8:[0.5,1,0,0,!0],19:[1,1,0.5,0,!0],30:[c,1,0,0,!0],41:[b,1,c,0,!0],52:[1,1,b,0,!0],38:[1,b,0,1,!0],39:[1,c,0,b,!0],40:[1,0,
0,c,!0],36:[1,0.5,0,1,!0],37:[1,0,0,0.5,!0],35:[1,0,0,1,!0],9:[1,0,0.5,1,!0],20:[0.5,0,0,1,!0],31:[1,0,b,1,!0],42:[b,0,c,1,!0],53:[c,0,0,1,!0],12:[0,0,1,0,!1],23:[1,1,0,1,!1],34:[1,0,1,1,!1],45:[0,1,0,0,!1]};ig.CollisionMap.staticNoCollision={trace:function(b,c,j,g){return{collision:{x:!1,y:!1,slope:!1},pos:{x:b+j,y:c+g},tile:{x:0,y:0}}}}});ig.baked=!0;
ig.module("impact.background-map").requires("impact.map","impact.image").defines(function(){ig.BackgroundMap=ig.Map.extend({tiles:null,scroll:{x:0,y:0},distance:1,repeat:!1,tilesetName:"",foreground:!1,enabled:!0,preRender:!1,preRenderedChunks:null,chunkSize:512,debugChunks:!1,anims:{},init:function(c,b,e){this.parent(c,b);this.setTileset(e)},setTileset:function(c){this.tilesetName=c instanceof ig.Image?c.path:c;this.tiles=new ig.Image(this.tilesetName);this.preRenderedChunks=null},setScreenPos:function(c,
b){this.scroll.x=c/this.distance;this.scroll.y=b/this.distance},preRenderMapToChunks:function(){var c=this.width*this.tilesize*ig.system.scale,b=this.height*this.tilesize*ig.system.scale;this.chunkSize=Math.min(Math.max(c,b),this.chunkSize);var e=Math.ceil(c/this.chunkSize),d=Math.ceil(b/this.chunkSize);this.preRenderedChunks=[];for(var j=0;j<d;j++){this.preRenderedChunks[j]=[];for(var g=0;g<e;g++)this.preRenderedChunks[j][g]=this.preRenderChunk(g,j,g==e-1?c-g*this.chunkSize:this.chunkSize,j==d-1?
b-j*this.chunkSize:this.chunkSize)}},preRenderChunk:function(c,b,e,d){var j=e/this.tilesize/ig.system.scale+1,g=d/this.tilesize/ig.system.scale+1,p=c*this.chunkSize/ig.system.scale%this.tilesize,m=b*this.chunkSize/ig.system.scale%this.tilesize;c=Math.floor(c*this.chunkSize/this.tilesize/ig.system.scale);b=Math.floor(b*this.chunkSize/this.tilesize/ig.system.scale);var f=ig.$new("canvas");f.width=e;f.height=d;f.retinaResolutionEnabled=!1;d=f.getContext("2d");ig.System.scaleMode(f,d);e=ig.system.context;
ig.system.context=d;for(d=0;d<j;d++)for(var n=0;n<g;n++)if(d+c<this.width&&n+b<this.height){var l=this.data[n+b][d+c];l&&this.tiles.drawTile(d*this.tilesize-p,n*this.tilesize-m,l-1,this.tilesize)}ig.system.context=e;return f},draw:function(){this.tiles.loaded&&this.enabled&&(this.preRender?this.drawPreRendered():this.drawTiled())},drawPreRendered:function(){this.preRenderedChunks||this.preRenderMapToChunks();var c=ig.system.getDrawPos(this.scroll.x),b=ig.system.getDrawPos(this.scroll.y);if(this.repeat)var e=
this.width*this.tilesize*ig.system.scale,c=(c%e+e)%e,e=this.height*this.tilesize*ig.system.scale,b=(b%e+e)%e;var e=Math.max(Math.floor(c/this.chunkSize),0),d=Math.max(Math.floor(b/this.chunkSize),0),j=Math.ceil((c+ig.system.realWidth)/this.chunkSize),g=Math.ceil((b+ig.system.realHeight)/this.chunkSize),p=this.preRenderedChunks[0].length,m=this.preRenderedChunks.length;this.repeat||(j=Math.min(j,p),g=Math.min(g,m));for(var f=0;d<g;d++){for(var n=0,l=e;l<j;l++){var r=this.preRenderedChunks[d%m][l%p],
s=-c+l*this.chunkSize-n,t=-b+d*this.chunkSize-f;ig.system.context.drawImage(r,s,t);ig.Image.drawCount++;this.debugChunks&&(ig.system.context.strokeStyle="#f0f",ig.system.context.strokeRect(s,t,this.chunkSize,this.chunkSize));this.repeat&&(r.width<this.chunkSize&&s+r.width<ig.system.realWidth)&&(n+=this.chunkSize-r.width,j++)}this.repeat&&(r.height<this.chunkSize&&t+r.height<ig.system.realHeight)&&(f+=this.chunkSize-r.height,g++)}},drawTiled:function(){for(var c=0,b=null,e=(this.scroll.x/this.tilesize).toInt(),
d=(this.scroll.y/this.tilesize).toInt(),j=this.scroll.x%this.tilesize,g=this.scroll.y%this.tilesize,p=-j-this.tilesize,j=ig.system.width+this.tilesize-j,m=ig.system.height+this.tilesize-g,f=-1,g=-g-this.tilesize;g<m;f++,g+=this.tilesize){var n=f+d;if(n>=this.height||0>n){if(!this.repeat)continue;n=(n%this.height+this.height)%this.height}for(var l=-1,r=p;r<j;l++,r+=this.tilesize){c=l+e;if(c>=this.width||0>c){if(!this.repeat)continue;c=(c%this.width+this.width)%this.width}if(c=this.data[n][c])(b=this.anims[c-
1])?b.draw(r,g):this.tiles.drawTile(r,g,c-1,this.tilesize)}}}})});ig.baked=!0;
ig.module("impact.game").requires("impact.impact","impact.entity","impact.collision-map","impact.background-map").defines(function(){ig.Game=ig.Class.extend({clearColor:"#000000",gravity:0,screen:{x:0,y:0},_rscreen:{x:0,y:0},entities:[],namedEntities:{},collisionMap:ig.CollisionMap.staticNoCollision,backgroundMaps:[],backgroundAnims:{},autoSort:!1,sortBy:null,cellSize:64,_deferredKill:[],_levelToLoad:null,_doSortEntities:!1,staticInstantiate:function(){this.sortBy=this.sortBy||ig.Game.SORT.Z_INDEX;
ig.game=this;return null},loadLevel:function(c){this.screen={x:0,y:0};this.entities=[];this.namedEntities={};for(var b=0;b<c.entities.length;b++){var e=c.entities[b];this.spawnEntity(e.type,e.x,e.y,e.settings)}this.sortEntities();this.collisionMap=ig.CollisionMap.staticNoCollision;this.backgroundMaps=[];for(b=0;b<c.layer.length;b++)if(e=c.layer[b],"collision"==e.name)this.collisionMap=new ig.CollisionMap(e.tilesize,e.data);else{var d=new ig.BackgroundMap(e.tilesize,e.data,e.tilesetName);d.anims=this.backgroundAnims[e.tilesetName]||
{};d.repeat=e.repeat;d.distance=e.distance;d.foreground=!!e.foreground;d.preRender=!!e.preRender;d.name=e.name;this.backgroundMaps.push(d)}for(b=0;b<this.entities.length;b++)this.entities[b].ready()},loadLevelDeferred:function(c){this._levelToLoad=c},getMapByName:function(c){if("collision"==c)return this.collisionMap;for(var b=0;b<this.backgroundMaps.length;b++)if(this.backgroundMaps[b].name==c)return this.backgroundMaps[b];return null},getEntityByName:function(c){return this.namedEntities[c]},getEntitiesByType:function(c){c=
"string"===typeof c?ig.global[c]:c;for(var b=[],e=0;e<this.entities.length;e++){var d=this.entities[e];d instanceof c&&!d._killed&&b.push(d)}return b},spawnEntity:function(c,b,e,d){var j="string"===typeof c?ig.global[c]:c;if(!j)throw"Can't spawn entity of type "+c;c=new j(b,e,d||{});this.entities.push(c);c.name&&(this.namedEntities[c.name]=c);return c},sortEntities:function(){this.entities.sort(this.sortBy)},sortEntitiesDeferred:function(){this._doSortEntities=!0},removeEntity:function(c){c.name&&
delete this.namedEntities[c.name];c._killed=!0;c.type=ig.Entity.TYPE.NONE;c.checkAgainst=ig.Entity.TYPE.NONE;c.collides=ig.Entity.COLLIDES.NEVER;this._deferredKill.push(c)},run:function(){this.update();this.draw()},update:function(){this._levelToLoad&&(this.loadLevel(this._levelToLoad),this._levelToLoad=null);this.updateEntities();this.checkEntities();for(var c=0;c<this._deferredKill.length;c++)this._deferredKill[c].erase(),this.entities.erase(this._deferredKill[c]);this._deferredKill=[];if(this._doSortEntities||
this.autoSort)this.sortEntities(),this._doSortEntities=!1;for(var b in this.backgroundAnims){var c=this.backgroundAnims[b],e;for(e in c)c[e].update()}},updateEntities:function(){for(var c=0;c<this.entities.length;c++){var b=this.entities[c];b._killed||b.update()}},draw:function(){this.clearColor&&ig.system.clear(this.clearColor);this._rscreen.x=ig.system.getDrawPos(this.screen.x)/ig.system.scale;this._rscreen.y=ig.system.getDrawPos(this.screen.y)/ig.system.scale;var c;for(c=0;c<this.backgroundMaps.length;c++){var b=
this.backgroundMaps[c];if(b.foreground)break;b.setScreenPos(this.screen.x,this.screen.y);b.draw()}this.drawEntities();for(c;c<this.backgroundMaps.length;c++)b=this.backgroundMaps[c],b.setScreenPos(this.screen.x,this.screen.y),b.draw()},drawEntities:function(){for(var c=0;c<this.entities.length;c++)this.entities[c].draw()},checkEntities:function(){for(var c={},b=0;b<this.entities.length;b++){var e=this.entities[b];if(!(e.type==ig.Entity.TYPE.NONE&&e.checkAgainst==ig.Entity.TYPE.NONE&&e.collides==ig.Entity.COLLIDES.NEVER))for(var d=
{},j=Math.floor(e.pos.y/this.cellSize),g=Math.floor((e.pos.x+e.size.x)/this.cellSize)+1,p=Math.floor((e.pos.y+e.size.y)/this.cellSize)+1,m=Math.floor(e.pos.x/this.cellSize);m<g;m++)for(var f=j;f<p;f++)if(c[m])if(c[m][f]){for(var n=c[m][f],l=0;l<n.length;l++)e.touches(n[l])&&!d[n[l].id]&&(d[n[l].id]=!0,ig.Entity.checkPair(e,n[l]));n.push(e)}else c[m][f]=[e];else c[m]={},c[m][f]=[e]}}});ig.Game.SORT={Z_INDEX:function(c,b){return c.zIndex-b.zIndex},POS_X:function(c,b){return c.pos.x+c.size.x-(b.pos.x+
b.size.x)},POS_Y:function(c,b){return c.pos.y+c.size.y-(b.pos.y+b.size.y)}}});ig.baked=!0;
ig.module("impact.debug.menu").requires("dom.ready","impact.system").defines(function(){ig.System.inject({run:function(){ig.debug.beforeRun();this.parent();ig.debug.afterRun()},setGameNow:function(c){this.parent(c);ig.debug.ready()}});ig.Debug=ig.Class.extend({options:{},panels:{},numbers:{},container:null,panelMenu:null,activePanel:null,debugTime:0,debugTickAvg:0.016,debugRealTime:Date.now(),init:function(){var c=ig.$new("link");c.rel="stylesheet";c.type="text/css";c.href=ig.prefix+"lib/impact/debug/debug.css";
ig.$("body")[0].appendChild(c);this.container=ig.$new("div");this.container.className="ig_debug";ig.$("body")[0].appendChild(this.container);this.panelMenu=ig.$new("div");this.panelMenu.innerHTML='<div class="ig_debug_head">Impact.Debug:</div>';this.panelMenu.className="ig_debug_panel_menu";this.container.appendChild(this.panelMenu);this.numberContainer=ig.$new("div");this.numberContainer.className="ig_debug_stats";this.panelMenu.appendChild(this.numberContainer);window.console&&(window.console.log&&
window.console.assert)&&(ig.log=console.log.bind?console.log.bind(console):console.log,ig.assert=console.assert.bind?console.assert.bind(console):console.assert);ig.show=this.showNumber.bind(this)},addNumber:function(c){var b=ig.$new("span");this.numberContainer.appendChild(b);this.numberContainer.appendChild(document.createTextNode(c));this.numbers[c]=b},showNumber:function(c,b,e){this.numbers[c]||this.addNumber(c,e);this.numbers[c].textContent=b},addPanel:function(c){var b=new c.type(c.name,c.label);
if(c.options)for(var e=0;e<c.options.length;e++){var d=c.options[e];b.addOption(new ig.DebugOption(d.name,d.object,d.property))}this.panels[b.name]=b;b.container.style.display="none";this.container.appendChild(b.container);c=ig.$new("div");c.className="ig_debug_menu_item";c.textContent=b.label;c.addEventListener("click",function(){this.togglePanel(b)}.bind(this),!1);b.menuItem=c;d=!1;for(e=1;e<this.panelMenu.childNodes.length;e++){var j=this.panelMenu.childNodes[e];if(j.textContent>b.label){this.panelMenu.insertBefore(c,
j);d=!0;break}}d||this.panelMenu.appendChild(c)},showPanel:function(c){this.togglePanel(this.panels[c])},togglePanel:function(c){c!=this.activePanel&&this.activePanel&&(this.activePanel.toggle(!1),this.activePanel.menuItem.className="ig_debug_menu_item",this.activePanel=null);var b="block"!=c.container.style.display;c.toggle(b);c.menuItem.className="ig_debug_menu_item"+(b?" active":"");b&&(this.activePanel=c)},ready:function(){for(var c in this.panels)this.panels[c].ready()},beforeRun:function(){var c=
Date.now();this.debugTickAvg=0.8*this.debugTickAvg+0.2*(c-this.debugRealTime);this.debugRealTime=c;this.activePanel&&this.activePanel.beforeRun()},afterRun:function(){var c=Date.now()-this.debugRealTime;this.debugTime=0.8*this.debugTime+0.2*c;this.activePanel&&this.activePanel.afterRun();this.showNumber("ms",this.debugTime.toFixed(2));this.showNumber("fps",Math.round(1E3/this.debugTickAvg));this.showNumber("draws",ig.Image.drawCount);ig.game&&ig.game.entities&&this.showNumber("entities",ig.game.entities.length);
ig.Image.drawCount=0}});ig.DebugPanel=ig.Class.extend({active:!1,container:null,options:[],panels:[],label:"",name:"",init:function(c,b){this.name=c;this.label=b;this.container=ig.$new("div");this.container.className="ig_debug_panel "+this.name},toggle:function(c){this.active=c;this.container.style.display=c?"block":"none"},addPanel:function(c){this.panels.push(c);this.container.appendChild(c.container)},addOption:function(c){this.options.push(c);this.container.appendChild(c.container)},ready:function(){},
beforeRun:function(){},afterRun:function(){}});ig.DebugOption=ig.Class.extend({name:"",labelName:"",className:"ig_debug_option",label:null,mark:null,container:null,active:!1,colors:{enabled:"#fff",disabled:"#444"},init:function(c,b,e){this.name=c;this.object=b;this.property=e;this.active=this.object[this.property];this.container=ig.$new("div");this.container.className="ig_debug_option";this.label=ig.$new("span");this.label.className="ig_debug_label";this.label.textContent=this.name;this.mark=ig.$new("span");
this.mark.className="ig_debug_label_mark";this.container.appendChild(this.mark);this.container.appendChild(this.label);this.container.addEventListener("click",this.click.bind(this),!1);this.setLabel()},setLabel:function(){this.mark.style.backgroundColor=this.active?this.colors.enabled:this.colors.disabled},click:function(c){this.active=!this.active;this.object[this.property]=this.active;this.setLabel();c.stopPropagation();c.preventDefault();return!1}});ig.debug=new ig.Debug});ig.baked=!0;
ig.module("impact.debug.entities-panel").requires("impact.debug.menu","impact.entity").defines(function(){ig.Entity.inject({colors:{names:"#fff",velocities:"#0f0",boxes:"#f00"},pos:{x:0,y:0},draw:function(){this.parent();ig.Entity._debugShowBoxes&&(ig.system.context.strokeStyle=this.colors.boxes,ig.system.context.lineWidth=1,ig.system.context.strokeRect(ig.system.getDrawPos(this.pos.x.round()-ig.game.screen.x)-0.5,ig.system.getDrawPos(this.pos.y.round()-ig.game.screen.y)-0.5,this.size.x*ig.system.scale,
this.size.y*ig.system.scale));if(ig.Entity._debugShowVelocities){var c=this.pos.x+this.size.x/2,b=this.pos.y+this.size.y/2;this._debugDrawLine(this.colors.velocities,c,b,c+this.vel.x,b+this.vel.y)}if(ig.Entity._debugShowNames&&(this.name&&(ig.system.context.fillStyle=this.colors.names,ig.system.context.fillText(this.name,ig.system.getDrawPos(this.pos.x-ig.game.screen.x),ig.system.getDrawPos(this.pos.y-ig.game.screen.y))),"object"==typeof this.target))for(var e in this.target)(c=ig.game.getEntityByName(this.target[e]))&&
this._debugDrawLine(this.colors.names,this.pos.x+this.size.x/2,this.pos.y+this.size.y/2,c.pos.x+c.size.x/2,c.pos.y+c.size.y/2)},_debugDrawLine:function(c,b,e,d,j){ig.system.context.strokeStyle=c;ig.system.context.lineWidth=1;ig.system.context.beginPath();ig.system.context.moveTo(ig.system.getDrawPos(b-ig.game.screen.x),ig.system.getDrawPos(e-ig.game.screen.y));ig.system.context.lineTo(ig.system.getDrawPos(d-ig.game.screen.x),ig.system.getDrawPos(j-ig.game.screen.y));ig.system.context.stroke();ig.system.context.closePath()}});
ig.Entity._debugEnableChecks=!0;ig.Entity._debugShowBoxes=!1;ig.Entity._debugShowVelocities=!1;ig.Entity._debugShowNames=!1;ig.Entity.oldCheckPair=ig.Entity.checkPair;ig.Entity.checkPair=function(c,b){ig.Entity._debugEnableChecks&&ig.Entity.oldCheckPair(c,b)};ig.debug.addPanel({type:ig.DebugPanel,name:"entities",label:"Entities",options:[{name:"Checks & Collisions",object:ig.Entity,property:"_debugEnableChecks"},{name:"Show Collision Boxes",object:ig.Entity,property:"_debugShowBoxes"},{name:"Show Velocities",
object:ig.Entity,property:"_debugShowVelocities"},{name:"Show Names & Targets",object:ig.Entity,property:"_debugShowNames"}]})});ig.baked=!0;
ig.module("impact.debug.maps-panel").requires("impact.debug.menu","impact.game","impact.background-map").defines(function(){ig.Game.inject({loadLevel:function(c){this.parent(c);ig.debug.panels.maps.load(this)}});ig.DebugMapsPanel=ig.DebugPanel.extend({maps:[],mapScreens:[],init:function(c,b){this.parent(c,b);this.load()},load:function(c){this.options=[];this.panels=[];if(!c||!c.backgroundMaps.length)this.container.innerHTML="<em>No Maps Loaded</em>";else{this.maps=c.backgroundMaps;this.mapScreens=
[];this.container.innerHTML="";for(c=0;c<this.maps.length;c++){var b=this.maps[c],e=new ig.DebugPanel(c,"Layer "+c),d=new ig.$new("strong");d.textContent=c+": "+b.tiles.path;e.container.appendChild(d);e.addOption(new ig.DebugOption("Enabled",b,"enabled"));e.addOption(new ig.DebugOption("Pre Rendered",b,"preRender"));e.addOption(new ig.DebugOption("Show Chunks",b,"debugChunks"));this.generateMiniMap(e,b,c);this.addPanel(e)}}},generateMiniMap:function(c,b,e){var d=ig.system.scale,j=ig.$new("canvas"),
g=j.getContext("2d"),p=b.tiles.width*d,m=b.tiles.height*d,f=p/b.tilesize,n=m/b.tilesize;j.width=f;j.height=n;g.drawImage(b.tiles.data,0,0,p,m,0,0,f,n);g=ig.$new("canvas");g.width=b.width*d;g.height=b.height*d;n=g.getContext("2d");ig.game.clearColor&&(n.fillStyle=ig.game.clearColor,n.fillRect(0,0,p,m));for(m=p=0;m<b.width;m++)for(var l=0;l<b.height;l++)(p=b.data[l][m])&&n.drawImage(j,Math.floor((p-1)*d%f),Math.floor((p-1)*d/f)*d,d,d,m*d,l*d,d,d);j=ig.$new("div");j.className="ig_debug_map_container";
j.style.width=b.width*d+"px";j.style.height=b.height*d+"px";f=ig.$new("div");f.className="ig_debug_map_screen";f.style.width=ig.system.width/b.tilesize*d-2+"px";f.style.height=ig.system.height/b.tilesize*d-2+"px";this.mapScreens[e]=f;j.appendChild(g);j.appendChild(f);c.container.appendChild(j)},afterRun:function(){for(var c=ig.system.scale,b=0;b<this.maps.length;b++){var e=this.maps[b],d=this.mapScreens[b];if(e&&d){var j=e.scroll.x/e.tilesize,g=e.scroll.y/e.tilesize;e.repeat&&(j%=e.width,g%=e.height);
d.style.left=j*c+"px";d.style.top=g*c+"px"}}}});ig.debug.addPanel({type:ig.DebugMapsPanel,name:"maps",label:"Background Maps"})});ig.baked=!0;
ig.module("impact.debug.graph-panel").requires("impact.debug.menu","impact.system","impact.game","impact.image").defines(function(){ig.Game.inject({draw:function(){ig.graph.beginClock("draw");this.parent();ig.graph.endClock("draw")},update:function(){ig.graph.beginClock("update");this.parent();ig.graph.endClock("update")},checkEntities:function(){ig.graph.beginClock("checks");this.parent();ig.graph.endClock("checks")}});ig.DebugGraphPanel=ig.DebugPanel.extend({clocks:{},marks:[],textY:0,height:128,
ms:64,timeBeforeRun:0,init:function(c,b){this.parent(c,b);this.mark16ms=(this.height-16*(this.height/this.ms)).round();this.mark33ms=(this.height-33*(this.height/this.ms)).round();this.msHeight=this.height/this.ms;this.graph=ig.$new("canvas");this.graph.width=window.innerWidth;this.graph.height=this.height;this.container.appendChild(this.graph);this.ctx=this.graph.getContext("2d");this.ctx.fillStyle="#444";this.ctx.fillRect(0,this.mark16ms,this.graph.width,1);this.ctx.fillRect(0,this.mark33ms,this.graph.width,
1);this.addGraphMark("16ms",this.mark16ms);this.addGraphMark("33ms",this.mark33ms);this.addClock("draw","Draw","#13baff");this.addClock("update","Entity Update","#bb0fff");this.addClock("checks","Entity Checks & Collisions","#a2e908");this.addClock("lag","System Lag","#f26900");ig.mark=this.mark.bind(this);ig.graph=this},addGraphMark:function(c,b){var e=ig.$new("span");e.className="ig_debug_graph_mark";e.textContent=c;e.style.top=b.round()+"px";this.container.appendChild(e)},addClock:function(c,b,
e){var d=ig.$new("span");d.className="ig_debug_legend_color";d.style.backgroundColor=e;var j=ig.$new("span");j.className="ig_debug_legend_number";j.appendChild(document.createTextNode("0"));var g=ig.$new("span");g.className="ig_debug_legend";g.appendChild(d);g.appendChild(document.createTextNode(b+" ("));g.appendChild(j);g.appendChild(document.createTextNode("ms)"));this.container.appendChild(g);this.clocks[c]={description:b,color:e,current:0,start:Date.now(),avg:0,html:j}},beginClock:function(c,
b){this.clocks[c].start=Date.now()+(b||0)},endClock:function(c){c=this.clocks[c];c.current=Math.round(Date.now()-c.start);c.avg=0.8*c.avg+0.2*c.current},mark:function(c,b){this.active&&this.marks.push({msg:c,color:b||"#fff"})},beforeRun:function(){this.endClock("lag");this.timeBeforeRun=Date.now()},afterRun:function(){var c=Date.now()-this.timeBeforeRun;this.beginClock("lag",Math.max(1E3/ig.system.fps-c,0));var c=this.graph.width-1,b=this.height;this.ctx.drawImage(this.graph,-1,0);this.ctx.fillStyle=
"#000";this.ctx.fillRect(c,0,1,this.height);this.ctx.fillStyle="#444";this.ctx.fillRect(c,this.mark16ms,1,1);this.ctx.fillStyle="#444";this.ctx.fillRect(c,this.mark33ms,1,1);for(var e in this.clocks){var d=this.clocks[e];d.html.textContent=d.avg.toFixed(2);if(d.color&&0<d.current){this.ctx.fillStyle=d.color;var j=d.current*this.msHeight,b=b-j;this.ctx.fillRect(c,b,1,j);d.current=0}}this.ctx.textAlign="right";this.ctx.textBaseline="top";this.ctx.globalAlpha=0.5;for(e=0;e<this.marks.length;e++)b=this.marks[e],
this.ctx.fillStyle=b.color,this.ctx.fillRect(c,0,1,this.height),b.msg&&(this.ctx.fillText(b.msg,c-1,this.textY),this.textY=(this.textY+8)%32);this.ctx.globalAlpha=1;this.marks=[]}});ig.debug.addPanel({type:ig.DebugGraphPanel,name:"graph",label:"Performance"})});ig.baked=!0;ig.module("impact.debug.debug").requires("impact.debug.entities-panel","impact.debug.maps-panel","impact.debug.graph-panel").defines(function(){});ig.baked=!0;
ig.module("plugins.patches.user-agent-patch").defines(function(){ig.ua.touchDevice="ontouchstart"in window||window.navigator.msMaxTouchPoints||window.navigator.maxTouchPoints;ig.ua.is_mac="MacIntel"===navigator.platform;ig.ua.iOS=ig.ua.touchDevice&&ig.ua.is_mac||ig.ua.iOS;ig.ua.mobile=ig.ua.iOS||ig.ua.mobile});ig.baked=!0;
ig.module("plugins.patches.webkit-image-smoothing-patch").defines(function(){ig.System&&(ig.System.SCALE={CRISP:function(c,b){b.imageSmoothingEnabled=b.msImageSmoothingEnabled=b.mozImageSmoothingEnabled=b.oImageSmoothingEnabled=!1;c.style.imageRendering="-moz-crisp-edges";c.style.imageRendering="-o-crisp-edges";c.style.imageRendering="-webkit-optimize-contrast";c.style.imageRendering="crisp-edges";c.style.msInterpolationMode="nearest-neighbor"},SMOOTH:function(c,b){b.imageSmoothingEnabled=b.msImageSmoothingEnabled=
b.mozImageSmoothingEnabled=b.oImageSmoothingEnabled=!0;c.style.imageRendering="";c.style.msInterpolationMode=""}},ig.System.scaleMode=ig.System.SCALE.SMOOTH)});ig.baked=!0;
ig.module("plugins.patches.windowfocus-onMouseDown-patch").defines(function(){var c=!1;try{c=window.self!==window.top,!1===c&&(c=0<window.frames.length)}catch(b){c=!0}ig.Input.inject({keydown:function(b){var d=b.target.tagName;if(!("INPUT"==d||"TEXTAREA"==d))if(d="keydown"==b.type?b.keyCode:2==b.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1,c&&0>d&&window.focus(),("touchstart"==b.type||"mousedown"==b.type)&&this.mousemove(b),d=this.bindings[d])this.actions[d]=!0,this.locks[d]||(this.presses[d]=!0,this.locks[d]=
!0),b.stopPropagation(),b.preventDefault()}})});ig.baked=!0;
ig.module("plugins.patches.input-patch").defines(function(){ig.Input.inject({move:new BABYLON.Vector2(0,0),initMouse:function(){if(!this.isUsingMouse){this.isUsingMouse=!0;var c=this.mousewheel.bind(this);ig.system.canvas.addEventListener("mousewheel",c,!1);ig.system.canvas.addEventListener("DOMMouseScroll",c,!1);ig.system.canvas.addEventListener("contextmenu",this.contextmenu.bind(this),!1);ig.system.canvas.addEventListener("mousedown",this.keydown.bind(this),!1);ig.system.canvas.addEventListener("mouseup",
this.keyup.bind(this),!1);ig.system.canvas.addEventListener("mousemove",this.mousemove.bind(this),!1);ig.ua.touchDevice&&(ig.system.canvas.addEventListener("touchstart",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.mousemove.bind(this),!1),ig.system.canvas.addEventListener("MSPointerDown",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("MSPointerUp",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",
this.mousemove.bind(this),!1),ig.system.canvas.style.msTouchAction="none")}},mousemove:function(c){var b=parseInt(wgl.system.canvas.offsetWidth);parseInt(wgl.system.canvas.offsetHeight);ig.ua.mobile&&(b=ig.system.realWidth);var b=ig.system.scale*(b/ig.system.realWidth),e={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());var d=c.touches?c.touches[0]:c;this.mouse.x=(d.clientX-e.left)/b;this.mouse.y=(d.clientY-e.top)/b;void 0!==typeof c.movementX?(this.move.x=
c.movementX,this.move.y=c.movementY):(this.move.x=0,this.move.y=0);try{ig.soundHandler.unlockWebAudio()}catch(j){}},keyup:function(c){var b=c.target.tagName;if(!("INPUT"==b||"TEXTAREA"==b)){if(b=this.bindings["keyup"==c.type?c.keyCode:2==c.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1])this.delayedKeyup[b]=!0,c.stopPropagation(),c.preventDefault();if(ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(e){}}}})});ig.baked=!0;
ig.module("plugins.font.font-info").requires("impact.impact").defines(function(){ig.FontInfo=ig.Class.extend({fonts:[{name:"montserrat",source:"media/fonts/montserrat"}],init:function(){this.registerCssFont()},getKeys:function(){for(var c={},b=0;b<this.fonts.length;b++){for(var e=this.fonts[b].name,d=e.split("-"),j="",g=0;g<d.length;g++)j+=d[g];c[j]=e}return c},registerCssFont:function(){if(0<this.fonts.length){var c=document.createElement("style");c.type="text/css";for(var b="",e=0;e<this.fonts.length;e++)var d=
this.fonts[e],b=b+("@font-face {font-family: '"+d.name+"';src: url('"+d.source+".eot');src: url('"+d.source+".eot?#iefix') format('embedded-opentype'),url('"+d.source+".woff2') format('woff2'),url('"+d.source+".woff') format('woff'),url('"+d.source+".ttf') format('truetype'),url('"+d.source+".svg#svgFontName') format('svg')}");c.appendChild(document.createTextNode(b));document.head.appendChild(c)}},isValid:function(){for(var c=0;c<this.fonts.length;c++)if(!this._isValidName(this.fonts[c].source))return!1;
return!0},_isValidName:function(c){return-1==c.search(/^[a-z0-9-\/]+$/)?!1:!0}})});ig.baked=!0;
ig.module("plugins.font.font-loader").requires("impact.impact","plugins.font.font-info","impact.loader").defines(function(){ig.FontLoader=ig.Class.extend({fontInfo:new ig.FontInfo,onload:!1,onerror:!1,init:function(c,b){this.onload=c;this.onerror=b},load:function(){this.fontInfo.isValid()?this._loadByLib():console.error("Only lowercased alphanumeric and dash are allowed for font file name!. Please check the font path")},_loadByLib:function(){for(var c=[],b=0;b<this.fontInfo.fonts.length;b++){var e=
new FontFaceObserver(this.fontInfo.fonts[b].name);c.push(e.load())}Promise.all(c).then(this.onload).catch(this.onerror)}});ig.Loader.inject({parentLoad:!1,load:function(){this.parentLoad=this.parent;this.fontLoader=(new ig.FontLoader(this.onFontLoad.bind(this),this.onFontError.bind(this))).load()},onFontLoad:function(){this.parentLoad()},onFontError:function(){console.error("Font is not loaded")}})});ig.baked=!0;
ig.module("plugins.handlers.dom-handler").defines(function(){ig.DomHandler=ig.Class.extend({JQUERYAVAILABLE:!1,init:function(){this.JQUERYAVAILABLE=this._jqueryAvailable()},_jqueryAvailable:function(){return"undefined"!==typeof jQuery},addEvent:function(c,b,e,d){if(this.JQUERYAVAILABLE)c.on(b,e);else c.addEventListener(b,e,d)},create:function(c){return this.JQUERYAVAILABLE?$("<"+c+">"):ig.$new(c)},getElementByClass:function(c){return this.JQUERYAVAILABLE?$("."+c):document.getElementsByClassName(c)},
getElementById:function(c){return this.JQUERYAVAILABLE?0<$(c).length?$(c):null:ig.$(c)},appendChild:function(c,b){this.JQUERYAVAILABLE?c.append(b):c.appendChild(b)},appendToBody:function(c){this.JQUERYAVAILABLE?$("body").append(c):document.body.appendChild(c)},resize:function(c,b,e){if(this.JQUERYAVAILABLE)c.width(b.toFixed(2)),c.height(e.toFixed(2));else{var d=c.style.visibility;b="width:"+b.toFixed(2)+"px; height:"+e.toFixed(2)+"px;";this.attr(c,"style",b);c.style.visibility=d}},resizeOffsetLeft:function(c,
b,e,d){if(this.JQUERYAVAILABLE)c.width(b.toFixed(2)),c.height(e.toFixed(2)),c.css("left",d);else{var j=c.style.visibility;b="width:"+b.toFixed(2)+"px; height:"+e.toFixed(2)+"px; left: "+d.toFixed(2)+"px;";this.attr(c,"style",b);c.style.visibility=j}},resizeOffset:function(c,b,e,d,j){if(this.JQUERYAVAILABLE)c.width(b.toFixed(2)),c.height(e.toFixed(2)),c.css("left",d),c.css("top",j);else{var g=c.style.visibility;b="width:"+b.toFixed(2)+"px; height:"+e.toFixed(2)+"px; left: "+d.toFixed(2)+"px; top: "+
j.toFixed(2)+"px;";this.attr(c,"style",b);c.style.visibility=g}},css:function(c,b){if(this.JQUERYAVAILABLE)c.css(b);else{var e="",d;for(d in b)e+=d+":"+b[d]+";";this.attr(c,"style",e)}},getOffsets:function(c){return this.JQUERYAVAILABLE?(c=c.offset(),{left:c.left,top:c.top}):{left:c.offsetLeft,top:c.offsetTop}},attr:function(c,b,e){if("undefined"===typeof e)return this.JQUERYAVAILABLE?c.attr(b):c.getAttribute(b);this.JQUERYAVAILABLE?c.attr(b,e):c.setAttribute(b,e)},show:function(c){this.JQUERYAVAILABLE?
(c.show(),c.css("visibility","visible")):c&&(c.style?c.style.visibility="visible":c[0]&&(c[0].style.visibility="visible"))},hide:function(c){this.JQUERYAVAILABLE?(c.hide(),c.css("visibility","hidden")):c&&(c.style?c.style.visibility="hidden":c[0]&&(c[0].style.visibility="hidden"))},getQueryVariable:function(c){for(var b=window.location.search.substring(1).split("&"),e=0;e<b.length;e++){var d=b[e].match(/([^=]+?)=(.+)/);if(d&&decodeURIComponent(d[1])==c)return decodeURIComponent(d[2])}},forcedDeviceDetection:function(){var c=
this.getQueryVariable("device");if(c)switch(c){case "mobile":console.log("serving mobile version ...");ig.ua.mobile=!0;break;case "desktop":console.log("serving desktop version ...");ig.ua.mobile=!1;break;default:console.log("serving universal version ...")}else console.log("serving universal version ...")},forcedDeviceRotation:function(){var c=this.getQueryVariable("force-rotate");if(c)switch(c){case "portrait":console.log("force rotate to portrait");window.orientation=0;break;case "landscape":console.log("force rotate to horizontal");
window.orientation=90;break;default:alert("wrong command/type in param force-rotate. Defaulting value to portrait"),window.orientation=0}},setZIndex:function(c,b){this.JQUERYAVAILABLE?c.css("zIndex",b):c&&(c.style?c.style.zIndex=b:c[0]&&(c[0].style.zIndex=b))}})});ig.baked=!0;
ig.module("plugins.handlers.size-handler").defines(function(){ig.SizeHandler=ig.Class.extend({portraitMode:!0,disableStretchToFitOnMobileFlag:!1,enableStretchToFitOnAntiPortraitModeFlag:!0,enableScalingLimitsOnMobileFlag:!1,minScalingOnMobile:0,maxScalingOnMobile:1,enableStretchToFitOnDesktopFlag:!1,enableScalingLimitsOnDesktopFlag:!1,minScalingOnDesktop:0,maxScalingOnDesktop:1,desktop:{actualSize:new BABYLON.Vector2(window.innerWidth,window.innerHeight),actualResolution:new BABYLON.Vector2(540,960)},
mobile:{actualSize:new BABYLON.Vector2(window.innerWidth,window.innerHeight),actualResolution:new BABYLON.Vector2(540,960)},windowSize:new BABYLON.Vector2(window.innerWidth,window.innerHeight),scaleRatioMultiplier:new BABYLON.Vector2(1,1),sizeRatio:new BABYLON.Vector2(1,1),scale:1,domHandler:null,dynamicClickableEntityDivs:{},coreDivsToResize:["#webglcanvas","#canvas","#play","#orientate"],adsToResize:{MobileAdInGamePreroll:{"box-width":_SETTINGS.Ad.Mobile.Preroll.Width+2,"box-height":_SETTINGS.Ad.Mobile.Preroll.Height+
20},MobileAdInGameEnd:{"box-width":_SETTINGS.Ad.Mobile.End.Width+2,"box-height":_SETTINGS.Ad.Mobile.End.Height+20},MobileAdInGamePreroll2:{"box-width":_SETTINGS.Ad.Mobile.Preroll.Width+2,"box-height":_SETTINGS.Ad.Mobile.Preroll.Height+20},MobileAdInGameEnd2:{"box-width":_SETTINGS.Ad.Mobile.End.Width+2,"box-height":_SETTINGS.Ad.Mobile.End.Height+20},MobileAdInGamePreroll3:{"box-width":_SETTINGS.Ad.Mobile.Preroll.Width+2,"box-height":_SETTINGS.Ad.Mobile.Preroll.Height+20},MobileAdInGameEnd3:{"box-width":_SETTINGS.Ad.Mobile.End.Width+
2,"box-height":_SETTINGS.Ad.Mobile.End.Height+20}},init:function(c){this.domHandler=c;if("undefined"===typeof c)throw"undefined Dom Handler for Size Handler";this.sizeCalcs();this.eventListenerSetup();this.samsungFix()},sizeCalcs:function(){this.windowSize=new Vector2(window.innerWidth,window.innerHeight);if(ig.ua.mobile){this.mobile.actualSize=new Vector2(window.innerWidth,window.innerHeight);var c=new Vector2(this.mobile.actualResolution.x,this.mobile.actualResolution.y);this.scaleRatioMultiplier=
new Vector2(this.mobile.actualSize.x/c.x,this.mobile.actualSize.y/c.y);if(this.disableStretchToFitOnMobileFlag){var b=Math.min(this.scaleRatioMultiplier.x,this.scaleRatioMultiplier.y);this.enableScalingLimitsOnMobileFlag&&(b=b.limit(this.minScalingOnMobile,this.maxScalingOnMobile));this.mobile.actualSize.x=c.x*b;this.mobile.actualSize.y=c.y*b;this.scaleRatioMultiplier.x=b;this.scaleRatioMultiplier.y=b}else this.sizeRatio.x=this.scaleRatioMultiplier.x,this.sizeRatio.y=this.scaleRatioMultiplier.y,this.scaleRatioMultiplier.x=
1,this.scaleRatioMultiplier.y=1}else this.desktop.actualSize=new Vector2(window.innerWidth,window.innerHeight),c=new Vector2(this.desktop.actualResolution.x,this.desktop.actualResolution.y),this.scaleRatioMultiplier=new Vector2(this.desktop.actualSize.x/c.x,this.desktop.actualSize.y/c.y),this.enableStretchToFitOnDesktopFlag?(this.sizeRatio.x=this.scaleRatioMultiplier.x,this.sizeRatio.y=this.scaleRatioMultiplier.y,this.scaleRatioMultiplier.x=1,this.scaleRatioMultiplier.y=1):(b=Math.min(this.scaleRatioMultiplier.x,
this.scaleRatioMultiplier.y),this.enableScalingLimitsOnDesktopFlag&&(b=b.limit(this.minScalingOnDesktop,this.maxScalingOnDesktop)),this.desktop.actualSize.x=c.x*b,this.desktop.actualSize.y=c.y*b,this.scaleRatioMultiplier.x=b,this.scaleRatioMultiplier.y=b)},resizeLayers:function(){for(var c=0;c<this.coreDivsToResize.length;c++){var b=ig.domHandler.getElementById(this.coreDivsToResize[c]);if(ig.ua.mobile)if(this.disableStretchToFitOnMobileFlag){var e=Math.floor(ig.sizeHandler.windowSize.x/2-ig.sizeHandler.mobile.actualSize.x/
2),d=Math.floor(ig.sizeHandler.windowSize.y/2-ig.sizeHandler.mobile.actualSize.y/2);0>e&&(e=0);0>d&&(d=0);ig.domHandler.resizeOffset(b,Math.floor(ig.sizeHandler.mobile.actualSize.x),Math.floor(ig.sizeHandler.mobile.actualSize.y),e,d);var j=!1;if(j=this.portraitMode?window.innerHeight<window.innerWidth:window.innerHeight>window.innerWidth)if(this.enableStretchToFitOnAntiPortraitModeFlag)ig.domHandler.resizeOffset(b,Math.floor(window.innerWidth),Math.floor(window.innerHeight),0,0);else{var j=new Vector2(window.innerWidth/
this.mobile.actualResolution.y,window.innerHeight/this.mobile.actualResolution.x),e=Math.min(j.x,j.y),j=this.mobile.actualResolution.y*e,g=this.mobile.actualResolution.x*e,e=Math.floor(ig.sizeHandler.windowSize.x/2-j/2),d=Math.floor(ig.sizeHandler.windowSize.y/2-g/2);0>e&&(e=0);0>d&&(d=0);ig.domHandler.resizeOffset(b,Math.floor(j),Math.floor(g),e,d)}}else ig.domHandler.resize(b,Math.floor(ig.sizeHandler.mobile.actualSize.x),Math.floor(ig.sizeHandler.mobile.actualSize.y));else this.enableStretchToFitOnDesktopFlag?
ig.domHandler.resize(b,Math.floor(ig.sizeHandler.desktop.actualSize.x),Math.floor(ig.sizeHandler.desktop.actualSize.y)):(e=Math.floor(ig.sizeHandler.windowSize.x/2-ig.sizeHandler.desktop.actualSize.x/2),d=Math.floor(ig.sizeHandler.windowSize.y/2-ig.sizeHandler.desktop.actualSize.y/2),0>e&&(e=0),0>d&&(d=0),ig.domHandler.resizeOffset(b,Math.floor(ig.sizeHandler.desktop.actualSize.x),Math.floor(ig.sizeHandler.desktop.actualSize.y),e,d))}for(var p in this.adsToResize)c=ig.domHandler.getElementById("#"+
p),b=ig.domHandler.getElementById("#"+p+"-Box"),j=(window.innerWidth-this.adsToResize[p]["box-width"])/2+"px",e=(window.innerHeight-this.adsToResize[p]["box-height"])/2+"px",c&&ig.domHandler.css(c,{width:window.innerWidth,height:window.innerHeight}),b&&ig.domHandler.css(b,{left:j,top:e});c=ig.domHandler.getElementById("#canvas");b=ig.domHandler.getOffsets(c);c=b.left;b=b.top;j=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);for(p in this.dynamicClickableEntityDivs){e=
ig.domHandler.getElementById("#"+p);if(ig.ua.mobile){var g=this.dynamicClickableEntityDivs[p].entity_pos_x,m=this.dynamicClickableEntityDivs[p].entity_pos_y,f=this.dynamicClickableEntityDivs[p].width,d=this.dynamicClickableEntityDivs[p].height;this.disableStretchToFitOnMobileFlag?(g=Math.floor(c+g*this.scaleRatioMultiplier.x)+"px",m=Math.floor(b+m*this.scaleRatioMultiplier.y)+"px",f=Math.floor(f*this.scaleRatioMultiplier.x)+"px",d=Math.floor(d*this.scaleRatioMultiplier.y)+"px"):(g=Math.floor(g*this.sizeRatio.x)+
"px",m=Math.floor(m*this.sizeRatio.y)+"px",f=Math.floor(f*this.sizeRatio.x)+"px",d=Math.floor(d*this.sizeRatio.y)+"px")}else g=this.dynamicClickableEntityDivs[p].entity_pos_x,m=this.dynamicClickableEntityDivs[p].entity_pos_y,f=this.dynamicClickableEntityDivs[p].width,d=this.dynamicClickableEntityDivs[p].height,this.enableStretchToFitOnDesktopFlag?(g=Math.floor(g*this.sizeRatio.x)+"px",m=Math.floor(m*this.sizeRatio.y)+"px",f=Math.floor(f*this.sizeRatio.x)+"px",d=Math.floor(d*this.sizeRatio.y)+"px"):
(g=Math.floor(c+g*this.scaleRatioMultiplier.x)+"px",m=Math.floor(b+m*this.scaleRatioMultiplier.y)+"px",f=Math.floor(f*this.scaleRatioMultiplier.x)+"px",d=Math.floor(d*this.scaleRatioMultiplier.y)+"px");ig.domHandler.css(e,{"float":"left",position:"absolute",left:g,top:m,width:f,height:d,"z-index":3});this.dynamicClickableEntityDivs[p]["font-size"]&&ig.domHandler.css(e,{"font-size":this.dynamicClickableEntityDivs[p]["font-size"]*j+"px"})}$("#ajaxbar").width(this.windowSize.x);$("#ajaxbar").height(this.windowSize.y)},
resize:function(){this.sizeCalcs();this.resizeLayers()},reorient:function(){console.log("changing orientation ...");if(ig.ua.mobile){var c=!1,c=this.portraitMode?window.innerHeight<window.innerWidth:window.innerHeight>window.innerWidth,b=this.domHandler.getElementById("#orientate"),e=this.domHandler.getElementById("#game");c?(this.domHandler.show(b),this.domHandler.hide(e),console.log("portrait"+window.innerWidth+","+window.innerHeight)):(this.domHandler.show(e),this.domHandler.hide(b),console.log("landscape"+
window.innerWidth+","+window.innerHeight))}ig.ua.mobile?(this.resize(),this.resizeAds()):this.resize()},resizeAds:function(){for(var c in this.adsToResize){var b=ig.domHandler.getElementById("#"+c),e=ig.domHandler.getElementById("#"+c+"-Box"),d=(window.innerWidth-this.adsToResize[c]["box-width"]>>1)+"px",j=(window.innerHeight-this.adsToResize[c]["box-height"]>>1)+"px";b&&ig.domHandler.css(b,{width:window.innerWidth,height:window.innerHeight});e&&ig.domHandler.css(e,{left:d,top:j})}},samsungFix:function(){ig.ua.android&&
(!(4.2>parseFloat(navigator.userAgent.slice(navigator.userAgent.indexOf("Android")+8,navigator.userAgent.indexOf("Android")+11)))&&!(0>navigator.userAgent.indexOf("GT"))&&!(0<navigator.userAgent.indexOf("Chrome"))&&!(0<navigator.userAgent.indexOf("Firefox")))&&(document.addEventListener("touchstart",function(c){c.preventDefault();return!1},!1),document.addEventListener("touchmove",function(c){c.preventDefault();return!1},!1),document.addEventListener("touchend",function(c){c.preventDefault();return!1},
!1))},orientationInterval:null,orientationTimeout:null,orientationHandler:function(){this.reorient();window.scrollTo(0,1)},orientationDelayHandler:function(){null==this.orientationInterval&&(this.orientationInterval=window.setInterval(this.orientationHandler.bind(this),100));null==this.orientationTimeout&&(this.orientationTimeout=window.setTimeout(function(){this.clearAllIntervals()}.bind(this),2E3))},clearAllIntervals:function(){window.clearInterval(this.orientationInterval);this.orientationInterval=
null;window.clearTimeout(this.orientationTimeout);this.orientationTimeout=null},eventListenerSetup:function(){ig.isXiaomiBrowser=/XiaoMi/i.test(navigator.userAgent)||/MiuiBrowser/i.test(navigator.userAgent)||/Mint/i.test(navigator.userAgent);ig.ua.iOS||ig.isXiaomiBrowser?(window.addEventListener("orientationchange",this.orientationDelayHandler.bind(this)),window.addEventListener("resize",this.orientationDelayHandler.bind(this))):(window.addEventListener("orientationchange",this.orientationHandler.bind(this)),
window.addEventListener("resize",this.orientationHandler.bind(this)));document.ontouchmove=function(){window.scrollTo(0,1)};this.chromePullDownRefreshFix()},chromePullDownRefreshFix:function(){var c=window.chrome||navigator.userAgent.match("CriOS"),b="ontouchstart"in document.documentElement;if(c&&b){var e=c=!1,d=0,j=!1;try{CSS.supports("overscroll-behavior-y","contain")&&(c=!0)}catch(g){}try{if(c)return document.body.style.overscrollBehaviorY="contain"}catch(p){}c=document.head||document.body;b=
document.createElement("style");b.type="text/css";b.styleSheet?b.styleSheet.cssText="\n      ::-webkit-scrollbar {\n        width: 500x;\n      }\n      ::-webkit-scrollbar-thumb {\n        border-radius: 500px;\n        background-color: rgba(0, 0, 0, 0.2);\n      }\n      body {\n        -webkit-overflow-scrolling: auto!important;\n      }\n    ":b.appendChild(document.createTextNode("\n      ::-webkit-scrollbar {\n        width: 500px;\n      }\n      ::-webkit-scrollbar-thumb {\n        border-radius: 500px;\n        background-color: rgba(0, 0, 0, 0.2);\n      }\n      body {\n        -webkit-overflow-scrolling: auto!important;\n      }\n    "));
c.appendChild(b);try{addEventListener("test",null,{get passive(){e=!0}})}catch(m){}document.addEventListener("touchstart",function(b){1===b.touches.length&&(d=b.touches[0].clientY,j=0===window.pageYOffset)},!!e&&{passive:!0});document.addEventListener("touchmove",function(b){var c;if(c=j){j=!1;c=b.touches[0].clientY;var e=c-d;c=(d=c,0<e)}if(c)return b.preventDefault()},!!e&&{passive:!1})}}})});ig.baked=!0;
ig.module("plugins.handlers.api-handler").defines(function(){ig.ApiHandler=ig.Class.extend({apiAvailable:{MJSPreroll:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS&&_SETTINGS.Ad.Mobile.Preroll.Enabled&&MobileAdInGamePreroll.Initialize()},MJSHeader:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS.Ad.Mobile.Header.Enabled&&MobileAdInGameHeader.Initialize()},MJSFooter:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS.Ad.Mobile.Footer.Enabled&&MobileAdInGameFooter.Initialize()},
MJSEnd:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS.Ad.Mobile.End.Enabled&&MobileAdInGameEnd.Initialize()}},run:function(c,b){if(this.apiAvailable[c])this.apiAvailable[c](b)}})});ig.baked=!0;
ig.module("plugins.audio.sound-player").defines(function(){SoundPlayer=ig.Class.extend({tagName:"SoundPlayer",stayMuteFlag:!1,debug:!1,init:function(){this.debug&&console.log(this.tagName)},play:function(c){this.debug&&console.log("play sound ",c)},stop:function(){this.debug&&console.log("stop sound ")},volume:function(){this.debug&&console.log("set volume")},mute:function(c){this.debug&&console.log("mute");"undefined"===typeof c?this.stayMuteFlag=!0:c&&(this.stayMuteFlag=!0)},unmute:function(c){this.debug&&
console.log("unmute");"undefined"===typeof c?this.stayMuteFlag=!1:c&&(this.stayMuteFlag=!1)}})});ig.baked=!0;
ig.module("plugins.audio.impact-music-player").requires("plugins.audio.sound-player").defines(function(){ImpactMusicPlayer=SoundPlayer.extend({tagName:"ImpactMusicPlayer",bgmPlaying:!1,soundList:{},init:function(c,b){this.parent(c,b);for(var e in c)this.soundList[e]=e,ig.music.add(c[e].path+".*",e);b&&b.loop&&(ig.music.loop=b.loop)},play:function(c){this.stayMuteFlag||(this.bgmPlaying=!0,"undefined"===typeof c?ig.music.play(c):ig.music.play())},stop:function(){this.bgmPlaying=!1;ig.music.pause()},
volume:function(c){console.log("impactmusic:",c);ig.music.volume=0>c?0:isNaN(c)?1:1<c?1:c},getVolume:function(){return ig.music.volume},mute:function(c){this.parent(c);this.bgmPlaying&&this.stop()},unmute:function(c){this.parent(c);this.play()}})});ig.baked=!0;
ig.module("plugins.audio.impact-sound-player").requires("plugins.audio.sound-player").defines(function(){ImpactSoundPlayer=SoundPlayer.extend({tagName:"ImpactSoundPlayer",soundList:{},init:function(c,b){this.parent(c,b);for(var e in c){var d=new ig.Sound(c[e].path+".*");this.soundList[e]=d}},play:function(c){this.stayMuteFlag||("object"===typeof c?(console.log(c+" exists"),c.play()):"string"===typeof c&&this.soundList[c].play())},stop:function(c){this.parent(c);c.stop()},volume:function(c){ig.soundManager.volume=
0>c?0:isNaN(c)?1:1<c?1:c},getVolume:function(){return ig.soundManager.volume},mute:function(c){this.parent(c);ig.Sound.enabled=!1},unmute:function(c){this.parent(c);ig.Sound.enabled=!0}})});ig.baked=!0;
ig.module("plugins.audio.howler-player").requires("plugins.audio.sound-player").defines(function(){HowlerPlayer=SoundPlayer.extend({tagName:"HowlerPlayer",soundList:{},init:function(c,b){this.parent(c,b);for(var e in c){var d=c[e].path,d=new Howl({src:[d+"."+ig.Sound.FORMAT.OGG.ext,d+"."+ig.Sound.FORMAT.MP3.ext]});this.soundList[e]=d}},play:function(c){if(Howler.ctx&&"running"!==Howler.ctx.state)return Howler.ctx.resume();this.stayMuteFlag||("object"===typeof c?c.play():"string"===typeof c&&this.soundList[c].play())},
stop:function(c){this.parent(c);"object"===typeof c?c.stop():"string"===typeof c&&this.soundList[c].stop()},volume:function(c){for(var b in this.soundList){if(0>c){this.soundList[b].volume(0);break}isNaN(c)?this.soundList[b].volume(1):1<c?this.soundList[b].volume(1):this.soundList[b].volume(c)}},getVolume:function(){for(var c in this.soundList)return this.soundList[c].volume()},mute:function(c){this.parent(c);Howler.mute(!0)},unmute:function(c){this.parent(c);Howler.mute(!1)}})});ig.baked=!0;
ig.module("plugins.audio.howler-music-player").requires("plugins.audio.sound-player").defines(function(){HowlerMusicPlayer=SoundPlayer.extend({tagName:"HowlerMusicPlayer",bgmPlaying:!1,soundList:{},init:function(c,b){this.parent(c,b);for(var e in c){var d=c[e].path,d=new Howl({src:[d+"."+ig.Sound.FORMAT.OGG.ext,d+"."+ig.Sound.FORMAT.MP3.ext],loop:!0,autoplay:!1,onend:function(){}.bind(this)});this.soundList[e]=d}},play:function(c){if(!this.stayMuteFlag&&!this.bgmPlaying)if("object"===typeof c)this.bgmPlaying=
!0,c.play();else if("string"===typeof c)this.bgmPlaying=!0,this.soundList[c].play();else for(var b in this.soundList){this.soundList[b].play();this.bgmPlaying=!0;break}},stop:function(c){this.parent(c);if(this.bgmPlaying){for(var b in this.soundList)this.soundList[b].stop();this.bgmPlaying=!1}},volume:function(c){for(var b in this.soundList){if(0>c){this.soundList[b].volume(0);break}isNaN(c)?this.soundList[b].volume(1):1<c?this.soundList[b].volume(1):this.soundList[b].volume(c)}},getVolume:function(){for(var c in this.soundList)return this.soundList[c].volume()},
mute:function(c){this.parent(c);Howler.mute(!0)},unmute:function(c){this.parent(c);Howler.mute(!1)}})});ig.baked=!0;
ig.module("plugins.audio.jukebox-player").requires("plugins.audio.sound-player").defines(function(){JukeboxPlayer=SoundPlayer.extend({tagName:"JukeboxPlayer",bgmPlaying:!1,soundList:{},jukeboxPlayer:null,pausePosition:0,premuteVolume:0,minVolume:0.001,init:function(c,b){this.parent(c,b);for(var e in c){this.soundList[e]=e;var d=c[e].path;this.jukeboxPlayer=new jukebox.Player({resources:[d+"."+ig.Sound.FORMAT.OGG.ext,d+"."+ig.Sound.FORMAT.MP3.ext],autoplay:!1,spritemap:{music:{start:c[e].startMp3,
end:c[e].endMp3,loop:!0}}})}},play:function(){this.stayMuteFlag||(this.bgmPlaying=!0,this.pausePosition?(console.log("resume"),this.jukeboxPlayer.resume(this.pausePosition)):(console.log("play"),this.jukeboxPlayer.play(this.jukeboxPlayer.settings.spritemap.music.start,!0)),this.premuteVolume=this.getVolume())},stop:function(){this.bgmPlaying=!1;this.pausePosition=this.jukeboxPlayer.pause()},volume:function(c){console.log("jukebox:",c);0>=c?this.jukeboxPlayer.setVolume(this.minVolume):isNaN(c)?this.jukeboxPlayer.setVolume(1):
1<c?this.jukeboxPlayer.setVolume(1):this.jukeboxPlayer.setVolume(c)},getVolume:function(){return this.jukeboxPlayer.getVolume()},mute:function(c){this.parent(c);this.bgmPlaying&&(console.log("jukebox",this.premuteVolume),this.stayMuteFlag||(this.premuteVolume=this.getVolume()),this.jukeboxPlayer.pause(),this.jukeboxPlayer.setVolume(this.minVolume))},unmute:function(c){this.parent(c);this.stayMuteFlag||(console.log("jukebox",this.premuteVolume),this.jukeboxPlayer.setVolume(this.premuteVolume),this.jukeboxPlayer.resume())}})});
ig.baked=!0;
ig.module("plugins.audio.webaudio-music-player").requires("plugins.audio.sound-player").defines(function(){WebaudioMusicPlayer=SoundPlayer.extend({tagName:"WebaudioMusicPlayer",bgmPlaying:!1,isSupported:!1,muteFlag:!1,pausedTime:0,webaudio:null,useHTML5Audio:!1,audio:null,inactiveAudio:null,codecs:null,reinitOnPlay:!1,inputList:null,_volume:1,soundList:{},init:function(c){this.webaudio={compatibility:{},gainNode:null,buffer:null,source_loop:{},source_once:{}};try{Howler&&Howler.ctx?this.webaudio.context=Howler.ctx:
ig&&ig.webaudio_ctx?this.webaudio.context=ig.webaudio_ctx:(this.AudioContext=window.AudioContext||window.webkitAudioContext,this.webaudio.context=new this.AudioContext,ig.webaudio_ctx=this.webaudio.context),this.isSupported=!0}catch(b){console.log("Web Audio API not supported in this browser."),this.webaudio=null,this.useHTML5Audio=!0}if(this.useHTML5Audio)if("undefined"!==typeof Audio)try{new Audio}catch(e){this.useHTML5Audio=!1}else this.useHTML5Audio=!1;this.useHTML5Audio&&(this.audio=new Audio,
this.isSupported=!0,this.initHTML5Audio(c));if(!this.isSupported)return null;this.webaudio&&(this.inputList=c,this.initWebAudio(c))},initWebAudio:function(c){ig.ua.iOS&&this.initIOSWebAudioUnlock();this.webaudio.gainNode=this.webaudio.context.createGain();this.webaudio.gainNode.connect(this.webaudio.context.destination);this.webaudio.gainNode.gain.value=this._volume;this.webaudio.buffer=null;var b="start",e="stop",d=this.webaudio.context.createBufferSource();"function"!==typeof d.start&&(b="noteOn");
this.webaudio.compatibility.start=b;"function"!==typeof d.stop&&(e="noteOff");this.webaudio.compatibility.stop=e;for(var j in c){this.soundList[j]=j;var e=c[j].path,b=e+"."+ig.Sound.FORMAT.MP3.ext,g=e+"."+ig.Sound.FORMAT.OGG.ext;ig.ua.mobile?ig.ua.iOS&&(g=b):(e=navigator.userAgent.toLowerCase(),-1!=e.indexOf("safari")&&-1>=e.indexOf("chrome")&&(g=b),e.indexOf("win64")&&(g=b));var p=new XMLHttpRequest;p.open("GET",g,!0);p.responseType="arraybuffer";p.onload=function(){this.webaudio.context.decodeAudioData(p.response,
function(b){this.webaudio.buffer=b;this.webaudio.source_loop={};this.bgmPlaying?this.play(null,!0):this.stop()}.bind(this),function(){console.log('Error decoding audio "'+g+'".')})}.bind(this);p.send();if(4==p.readyState&&"undefined"!==typeof Audio){this.useHTML5Audio=!0;try{new Audio}catch(m){this.useHTML5Audio=!1}this.useHTML5Audio&&(console.log("Using HTML5 Audio"),this.webaudio=null,this.audio=new Audio,this.isSupported=!0,this.initHTML5Audio(c))}break}},initIOSWebAudioUnlock:function(){if(this.webaudio){webaudio=
this.webaudio;var c=function(){var b=webaudio.context,e=b.createBuffer(1,1,22050),d=b.createBufferSource();d.buffer=e;d.connect(b.destination);"undefined"===typeof d.start?d.noteOn(0):d.start(0);setTimeout(function(){(d.playbackState===d.PLAYING_STATE||d.playbackState===d.FINISHED_STATE)&&window.removeEventListener("touchend",c,!1)}.bind(this),0)};window.addEventListener("touchend",c,!1)}},initHTML5Audio:function(c){if(this.useHTML5Audio&&this.audio){var b=this.audio;this.codecs={};this.codecs={mp3:!!b.canPlayType("audio/mpeg;").replace(/^no$/,
""),opus:!!b.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!b.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!b.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!b.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(b.canPlayType("audio/x-m4a;")||b.canPlayType("audio/m4a;")||b.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(b.canPlayType("audio/x-mp4;")||b.canPlayType("audio/mp4;")||b.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!b.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,
"")};this.is={ff:Boolean(null!=window.mozInnerScreenX&&/firefox/.test(navigator.userAgent.toLowerCase())),ie:Boolean(document.all&&!window.opera),opera:Boolean(window.opera),chrome:Boolean(window.chrome),safari:Boolean(!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase())&&window.getComputedStyle&&!window.globalStorage&&!window.opera)};this.playDelay=-60;this.stopDelay=30;this.is.chrome&&(this.playDelay=-25);this.is.chrome&&(this.stopDelay=25);this.is.ff&&(this.playDelay=-25);this.is.ff&&
(this.stopDelay=85);this.is.opera&&(this.playDelay=5);this.is.opera&&(this.stopDelay=0);for(var e in c){this.soundList[e]=e;var d=c[e].path,b=d+"."+ig.Sound.FORMAT.OGG.ext,d=d+"."+ig.Sound.FORMAT.MP3.ext,j=null;this.codecs[ig.Sound.FORMAT.OGG.ext.toLowerCase()]?j=b:this.codecs[ig.Sound.FORMAT.MP3.ext.toLowerCase()]&&(j=d);if(j){ig.ua.mobile?ig.ua.iOS&&(j=d):(c=navigator.userAgent.toLowerCase(),-1!=c.indexOf("safari")&&-1>=c.indexOf("chrome")&&(j=d));this.audio.addEventListener("error",function(){this.audio.error&&
4===this.audio.error.code&&(this.isSupported=!1)},!1);this.audio.src=j;this.audio._pos=0;this.audio.preload="auto";this.audio.volume=this._volume;this.inactiveAudio=new Audio;this.inactiveAudio.src=j;this.inactiveAudio._pos=0;this.inactiveAudio.preload="auto";this.inactiveAudio.volume=this._volume;this.inactiveAudio.load();var g=function(){this._duration=this.audio.duration;this._loaded||(this._loaded=!0);this.bgmPlaying?this.play(null,!0):this.stop();this.audio.removeEventListener("canplaythrough",
g,!1)}.bind(this);this.audio.addEventListener("canplaythrough",g,!1);this.audio.load();break}}}},play:function(c,b){if(this.isSupported)if(this.bgmPlaying=!0,this.webaudio){if(!b&&this.reinitOnPlay&&this.webaudio.source_loop.buffer==this.webaudio.buffer){if(this.webaudio.source_loop._playing&&(this.webaudio.source_loop[this.webaudio.compatibility.stop](0),this.webaudio.source_loop._playing=!1,this.pausedTime+=this.webaudio.context.currentTime-this.webaudio.source_loop._startTime,this.pausedTime%=
this.webaudio.source_loop.buffer.duration,this.webaudio.source_loop._startTime=0,"noteOn"===this.webaudio.compatibility.start))this.webaudio.source_once[this.webaudio.compatibility.stop](0);try{this.webaudio.context.close();this.webaudio.context=new this.AudioContext;this.webaudio.gainNode=this.webaudio.context.createGain();this.webaudio.gainNode.connect(this.webaudio.context.destination);this.webaudio.gainNode.gain.value=this._volume;var e="start",d="stop",j=this.webaudio.context.createBufferSource();
"function"!==typeof j.start&&(e="noteOn");this.webaudio.compatibility.start=e;"function"!==typeof j.stop&&(d="noteOff");this.webaudio.compatibility.stop=d;this.webaudio.source_loop={};this.play(null,!0)}catch(g){}}if(this.webaudio.buffer){if(!this.muteFlag&&(this.bgmPlaying=!0,!this.webaudio.source_loop._playing)){this.webaudio.source_loop=this.webaudio.context.createBufferSource();this.webaudio.source_loop.buffer=this.webaudio.buffer;this.webaudio.source_loop.loop=!0;this.webaudio.source_loop.connect(this.webaudio.gainNode);
if(null==c||isNaN(c))c=0,this.pausedTime&&(c=this.pausedTime);this.webaudio.source_loop._startTime=this.webaudio.context.currentTime;if("noteOn"===this.webaudio.compatibility.start)this.webaudio.source_once=this.webaudio.context.createBufferSource(),this.webaudio.source_once.buffer=this.webaudio.buffer,this.webaudio.source_once.connect(this.webaudio.gainNode),this.webaudio.source_once.noteGrainOn(0,c,this.webaudio.buffer.duration-c),this.webaudio.source_loop[this.webaudio.compatibility.start](this.webaudio.context.currentTime+
(this.webaudio.buffer.duration-c));else this.webaudio.source_loop[this.webaudio.compatibility.start](0,c);this.webaudio.source_loop._playing=!0}}else this.bgmPlaying=!0}else if(this.audio){var p=this.audio;if(!this.muteFlag)if(this.bgmPlaying=!0,isNaN(c)&&(c=0,this.pausedTime&&(c=this.pausedTime)),e=this._duration-c,this._onEndTimer&&(clearTimeout(this._onEndTimer),this._onEndTimer=null),this._onEndTimer=setTimeout(function(){this.audio.currentTime=0;this.audio.pause();this.pausedTime=0;if(this.inactiveAudio){var b=
this.audio;this.audio=this.inactiveAudio;this.inactiveAudio=b}this.play()}.bind(this),1E3*e+this.playDelay),4===p.readyState||!p.readyState&&navigator.isCocoonJS)p.readyState=4,p.currentTime=c,p.muted=this.muteFlag||p.muted,p.volume=this._volume,setTimeout(function(){p.play()},0);else{clearTimeout(this._onEndTimer);this._onEndTimer=null;var m=function(){typeof("function"==this.play)&&(this.play(),p.removeEventListener("canplaythrough",m,!1))}.bind(this);p.addEventListener("canplaythrough",m,!1)}}},
stop:function(){this.bgmPlaying=!1;if(this.isSupported)if(this.webaudio){if(this.webaudio.source_loop._playing&&(this.webaudio.source_loop[this.webaudio.compatibility.stop](0),this.webaudio.source_loop._playing=!1,this.pausedTime+=this.webaudio.context.currentTime-this.webaudio.source_loop._startTime,this.pausedTime%=this.webaudio.source_loop.buffer.duration,this.webaudio.source_loop._startTime=0,"noteOn"===this.webaudio.compatibility.start))this.webaudio.source_once[this.webaudio.compatibility.stop](0)}else if(this.audio){var c=
this.audio;4==c.readyState&&(this.pausedTime=c.currentTime,c.currentTime=0,c.pause(),clearTimeout(this._onEndTimer),this._onEndTimer=null)}},volume:function(c){if(isNaN(c)||null==c)return this.getVolume();this.isSupported&&(this._volume=c,0>this._volume?this._volume=0:1<this._volume&&(this._volume=1),this.webaudio?this.webaudio.gainNode&&(this.webaudio.gainNode.gain.value=this._volume):this.audio&&(this.audio.volume=this._volume,this.inactiveAudio&&(this.inactiveAudio.volume=this._volume)))},getVolume:function(){return!this.isSupported?
0:this._volume},mute:function(c){this.parent(c);!1==this.muteFlag&&(this.muteFlag=!0,this.bgmPlaying&&(this.stop(),this.bgmPlaying=!0))},unmute:function(c){this.parent(c);!this.stayMuteFlag&&!0==this.muteFlag&&(this.muteFlag=!1,this.bgmPlaying&&this.play())}})});ig.baked=!0;
ig.module("plugins.audio.sound-info").defines(function(){SoundInfo=ig.Class.extend({FORMATS:{OGG:".ogg",MP3:".mp3"},sfx:{kittyopeningSound:{path:"media/audio/opening/kittyopening"},staticSound:{path:"media/audio/play/static"},openingSound:{path:"media/audio/opening/opening"}},bgm:{background:{path:"media/audio/bgm",startOgg:0,endOgg:21.463,startMp3:0,endMp3:21.463}}})});ig.baked=!0;
ig.module("plugins.audio.sound-handler").requires("plugins.audio.impact-music-player","plugins.audio.impact-sound-player","plugins.audio.howler-player","plugins.audio.howler-music-player","plugins.audio.jukebox-player","plugins.audio.webaudio-music-player","plugins.audio.sound-info").defines(function(){ig.SoundHandler=ig.Class.extend({bgmPlayer:null,sfxPlayer:null,focusBlurMute:!1,soundInfo:new SoundInfo,init:function(){console.log("Initiating sound handler");this.sfxPlayer=new HowlerPlayer(this.soundInfo.sfx);
ig.ua.mobile?(this.initPowerButtonFix(),this.bgmPlayer=new WebaudioMusicPlayer(this.soundInfo.bgm,{loop:!0}),this.bgmPlayer.isSupported||(this.bgmPlayer=new JukeboxPlayer(this.soundInfo.bgm,{loop:!0}))):(this.bgmPlayer=new WebaudioMusicPlayer(this.soundInfo.bgm,{loop:!0}),this.bgmPlayer.isSupported||(this.bgmPlayer=new ImpactMusicPlayer(this.soundInfo.bgm,{loop:!0})))},unlockWebAudio:function(){Howler&&(Howler.ctx&&"running"!==Howler.ctx.state&&Howler.ctx.resume(),Howler._audioUnlocked||"function"===
typeof Howler._unlockAudio&&Howler._unlockAudio());ig&&ig.webaudio_ctx&&ig.webaudio_ctx.state&&"running"!==ig.webaudio_ctx.state&&ig.webaudio_ctx.resume();this.bgmPlayer.webaudio&&this.bgmPlayer.webaudio.context&&this.bgmPlayer.webaudio.context.state&&"running"!==this.bgmPlayer.webaudio.context.state&&this.bgmPlayer.webaudio.context.resume()},checkBGM:function(){return this.bgmPlayer.stayMuteFlag},checkSFX:function(){return this.sfxPlayer.stayMuteFlag},muteSFX:function(c){this.sfxPlayer&&this.sfxPlayer.mute(c)},
muteBGM:function(c){this.bgmPlayer&&this.bgmPlayer.mute(c)},unmuteSFX:function(c){this.sfxPlayer&&this.sfxPlayer.unmute(c)},unmuteBGM:function(c){this.bgmPlayer&&this.bgmPlayer.unmute(c)},muteAll:function(c){this.muteSFX(c);this.muteBGM(c)},unmuteAll:function(c){this.unlockWebAudio();this.unmuteSFX(c);this.unmuteBGM(c)},forceMuteAll:function(){this.focusBlurMute||this.muteAll(!1);this.focusBlurMute=!0},forceUnMuteAll:function(){this.focusBlurMute&&(this.unmuteAll(!1),this.focusBlurMute=!1)},initWindowHandler:function(){"true"===
ig.domHandler.getQueryVariable("webview")?($(window).focus(function(){wgl.system&&wgl.system.startRender();ig.soundHandler&&ig.soundHandler.forceUnMuteAll()}),$(window).blur(function(){wgl.system&&wgl.system.stopRender();ig.soundHandler&&ig.soundHandler.forceMuteAll()})):(window.onfocus=function(){wgl.system&&wgl.system.startRender();ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},window.onblur=function(){wgl.system&&wgl.system.stopRender();ig.soundHandler&&ig.soundHandler.forceMuteAll()})},initPowerButtonFix:function(){var c=
this.getHiddenProp();c&&(c=c.replace(/[H|h]idden/,"")+"visibilitychange",document.addEventListener(c,this.visChange));window.addEventListener("pagehide",function(){ig.soundHandler&&ig.soundHandler.forceMuteAll()},!1);window.addEventListener("pageshow",function(){ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},!1)},getHiddenProp:function(){var c=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var b=0;b<c.length;b++)if(c[b]+"Hidden"in document)return c[b]+"Hidden";return null},
isHidden:function(){var c=this.getHiddenProp();return!c?!1:document[c]},visChange:function(){ig.soundHandler.isHidden()?ig.soundHandler&&ig.soundHandler.forceMuteAll():ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},saveVolume:function(){this.sfxPlayer&&ig.game.io.storageSet("soundVolume",this.sfxPlayer.getVolume());this.bgmPlayer&&ig.game.io.storageSet("musicVolume",this.bgmPlayer.getVolume())},forceLoopBGM:function(){var c;if(!this.focusBlurMute&&this.bgmPlayer.bgmPlaying&&this.bgmPlayer){var b=
this.bgmPlayer.jukeboxPlayer;if(b){null!=window.mozInnerScreenX&&/firefox/.test(navigator.userAgent.toLowerCase());c=Boolean(window.chrome);!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase());var e=0.1;ig.ua.mobile&&(e=0.115,ig.ua.android&&(e=0.45,c&&(e=0.3)));b.settings.spritemap.music&&(c=b.settings.spritemap.music.end-e,b.getCurrentTime()>=c&&(c=b.settings.spritemap.music.start,ig.ua.android?this.forcelooped||(b.play(c,!0),this.forcelooped=!0,setTimeout(function(){ig.soundHandler.forcelooped=
!1},e)):b.setCurrentTime(c)))}else"ImpactMusicPlayer"==this.bgmPlayer.tagName&&(null!=window.mozInnerScreenX&&/firefox/.test(navigator.userAgent.toLowerCase()),c=Boolean(window.chrome),!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase()),e=0.1,ig.ua.mobile&&(e=0.115,ig.ua.android&&(e=0.45,c&&(e=0.3))),b=0,"mp3"==ig.soundManager.format.ext&&(b=0.05),ig.music.currentTrack&&(c=ig.music.currentTrack.duration-e,ig.music.currentTrack.currentTime>=c&&(ig.ua.android?this.forcelooped||(ig.music.currentTrack.pause(),
ig.music.currentTrack.currentTime=b,ig.music.currentTrack.play(),this.forcelooped=!0,setTimeout(function(){ig.soundHandler.forcelooped=!1},e)):ig.music.currentTrack.currentTime=b)))}}})});ig.baked=!0;
ig.module("plugins.handlers.visibility-handler").requires("plugins.audio.sound-handler").defines(function(){ig.VisibilityHandler=ig.Class.extend({version:"1.0.2",config:{allowResumeWithoutFocus:{desktop:!0,mobile:{kaios:!1,"default":!0}},handlerDelay:{desktop:0,mobile:{kaios:0,"default":0}},autoFocusOnResume:{desktop:!0,mobile:{kaios:!1,"default":!0}},autoFocusAfterResume:{desktop:!0,mobile:{kaios:!1,"default":!0}}},browserPrefixes:["o","ms","moz","webkit"],browserPrefix:null,hiddenPropertyName:null,
visibilityEventName:null,visibilityStateName:null,isShowingOverlay:!1,isFocused:!1,isPaused:!1,init:function(){this.initVisibilityHandler();this.initFocusHandler();this.initPageTransitionHandler();ig.visibilityHandler=this},pauseHandler:function(){ig.game&&ig.game.pauseGame();wgl.system&&wgl.system.stopRender();ig.soundHandler&&ig.soundHandler.forceMuteAll()},resumeHandler:function(){ig.game&&ig.game.resumeGame();wgl.system&&wgl.system.startRender();ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},
initVisibilityHandler:function(){this.browserPrefix=this.getBrowserPrefix();this.hiddenPropertyName=this.getHiddenPropertyName(this.browserPrefix);this.visibilityEventName=this.getVisibilityEventName(this.browserPrefix);this.visibilityStateName=this.getVisibilityStateName(this.browserPrefix);this.visibilityEventName&&document.addEventListener(this.visibilityEventName,this.onChange.bind(this),!0)},initFocusHandler:function(){window.addEventListener("blur",this.onChange.bind(this),!0);document.addEventListener("blur",
this.onChange.bind(this),!0);document.addEventListener("focusout",this.onChange.bind(this),!0);window.addEventListener("focus",this.onChange.bind(this),!0);document.addEventListener("focus",this.onChange.bind(this),!0);document.addEventListener("focusin",this.onChange.bind(this),!0)},initPageTransitionHandler:function(){window.addEventListener("pagehide",this.onChange.bind(this),!0);window.addEventListener("pageshow",this.onChange.bind(this),!0)},getBrowserPrefix:function(){var c=null;this.browserPrefixes.forEach(function(b){if(this.getHiddenPropertyName(b)in
document)return c=b}.bind(this));return c},getHiddenPropertyName:function(c){return c?c+"Hidden":"hidden"},getVisibilityEventName:function(c){return(c?c:"")+"visibilitychange"},getVisibilityStateName:function(c){return c?c+"VisibilityState":"visibilityState"},hasView:function(){return!(document[this.hiddenPropertyName]||"visible"!==document[this.visibilityStateName])},hasFocus:function(){return document.hasFocus()||this.isFocused},onOverlayShow:function(){this.systemPaused();this.isShowingOverlay=
!0},onOverlayHide:function(){this.isShowingOverlay=!1;this.systemResumed()},systemPaused:function(){if(this.isPaused)return!1;this.pauseHandler();return this.isPaused=!0},systemResumed:function(){if(!this.isPaused||!this.hasView()||this.isShowingOverlay)return!1;if(!this.hasFocus())if(ig.ua.mobile)if(this.isKaiOS()){if(!this.config.allowResumeWithoutFocus.mobile.kaios)return!1}else{if(!this.config.allowResumeWithoutFocus.mobile.default)return!1}else if(!this.config.allowResumeWithoutFocus.desktop)return!1;
this.focusOnResume();this.resumeHandler();this.focusAfterResume();this.isPaused=!1;return!0},isKaiOS:function(){return/KAIOS/.test(navigator.userAgent)||!1},focusOnResume:function(){var c=!1;return c=ig.ua.mobile?this.isKaiOS()?this.config.autoFocusOnResume.mobile.kaios:this.config.autoFocusOnResume.mobile.default:this.config.autoFocusOnResume.desktop},focusAfterResume:function(){var c=!1;return c=ig.ua.mobile?this.isKaiOS()?this.config.autoFocusAfterResume.mobile.kaios:this.config.autoFocusAfterResume.mobile.default:
this.config.autoFocusAfterResume.desktop},focus:function(c){window.focus&&c&&window.focus()},handleDelayedEvent:function(c){if(!this.hasView()||"pause"===c.type||"pageHide"===c.type||"blur"===c.type||"focusout"===c.type){if("blur"===c.type||"focusout"===c.type)this.isFocused=!1;return this.systemPaused(c)}if("focus"===c.type||"focusin"===c.type)this.isFocused=!0;return this.systemResumed(c)},startDelayedEventHandler:function(c){ig.ua.mobile?this.isKaiOS()?0<this.config.handlerDelay.mobile.kaios?window.setTimeout(function(b){this.handleDelayedEvent(b)}.bind(this,
c),this.config.handlerDelay.mobile):this.handleDelayedEvent(c):0<this.config.handlerDelay.mobile.default?window.setTimeout(function(b){this.handleDelayedEvent(b)}.bind(this,c),this.config.handlerDelay.mobile):this.handleDelayedEvent(c):0<this.config.handlerDelay.desktop?window.setTimeout(function(b){this.handleDelayedEvent(b)}.bind(this,c),this.config.handlerDelay.desktop):this.handleDelayedEvent(c)},onChange:function(c){this.startDelayedEventHandler(c)}})});ig.baked=!0;
ig.module("plugins.io.storage").defines(function(){ig.Storage=ig.Class.extend({staticInstantiate:function(){return!ig.Storage.instance?null:ig.Storage.instance},init:function(){ig.Storage.instance=this},isCapable:function(){return"undefined"!==typeof window.localStorage},isSet:function(c){return null!==this.get(c)},initUnset:function(c,b){null===this.get(c)&&this.set(c,b)},get:function(c){if(!this.isCapable())return null;try{return JSON.parse(localStorage.getItem(c))}catch(b){return window.localStorage.getItem(c)}},
getInt:function(c){return~~this.get(c)},getFloat:function(c){return parseFloat(this.get(c))},getBool:function(c){return!!this.get(c)},key:function(c){return this.isCapable()?window.localStorage.key(c):null},set:function(c,b){if(!this.isCapable())return null;try{window.localStorage.setItem(c,JSON.stringify(b))}catch(e){console.log(e)}},setHighest:function(c,b){b>this.getFloat(c)&&this.set(c,b)},remove:function(c){if(!this.isCapable())return null;window.localStorage.removeItem(c)},clear:function(){if(!this.isCapable())return null;
window.localStorage.clear()}})});ig.baked=!0;
ig.module("plugins.io.mouse").defines(function(){Mouse=ig.Class.extend({bindings:{click:[ig.KEY.MOUSE1]},pos:new BABYLON.Vector2.Zero,init:function(){ig.input.initMouse();for(var c in this.bindings){this[c]=c;for(var b=0;b<this.bindings[c].length;b++)ig.input.bind(this.bindings[c][b],c)}},getWglPos:function(){var c=ig.sizeHandler.mobile.actualResolution.x,b=ig.sizeHandler.mobile.actualResolution.y,e=wgl.system.engine.getRenderWidth(),d=wgl.system.engine.getRenderHeight(),c=e/c,b=d/b,d=ig.game.io.getClickPos();
ig.ua.mobile?(c=d.x*ig.sizeHandler.sizeRatio.x,b=d.y*ig.sizeHandler.sizeRatio.y):(c*=d.x,b*=d.y);return new BABYLON.Vector2(c,b)},getLast:function(){return this.pos},getPos:function(){if(ig.ua.mobile)var c=ig.input.mouse.x/ig.sizeHandler.scaleRatioMultiplier.x,b=ig.input.mouse.y/ig.sizeHandler.scaleRatioMultiplier.y;else c=ig.input.mouse.x,b=ig.input.mouse.y;this.pos=new BABYLON.Vector2(c,b);return this.pos.clone()}})});ig.baked=!0;
ig.module("plugins.io.keyboard").defines(function(){Keyboard=ig.Class.extend({bindings:{up:[ig.KEY.W,ig.KEY.UP_ARROW],right:[ig.KEY.D,ig.KEY.RIGHT_ARROW],left:[ig.KEY.A,ig.KEY.LEFT_ARROW],down:[ig.KEY.S,ig.KEY.DOWN_ARROW,ig.KEY.SPACE]},init:function(){for(var c in this.bindings){this[c]=c;for(var b=0;b<this.bindings[c].length;b++)ig.input.bind(this.bindings[c][b],c)}}})});ig.baked=!0;
ig.module("plugins.io.gamepad-input").defines(function(){ig.PADKEY={BUTTON_0:0,PADBUTTON_1:1,BUTTON_2:2,BUTTON_3:3,BUTTON_LEFT_BUMPER:4,BUTTON_RIGHT_BUMPER:5,BUTTON_LEFT_TRIGGER:6,BUTTON_RIGHT_TRIGGER:7,BUTTON_LEFT_JOYSTICK:10,BUTTON_RIGHT_JOYSTICK:11,BUTTON_DPAD_UP:12,BUTTON_DPAD_DOWN:13,BUTTON_DPAD_LEFT:14,BUTTON_DPAD_RIGHT:15,BUTTON_MENU:16,AXIS_LEFT_JOYSTICK_X:0,AXIS_LEFT_JOYSTICK_Y:1,AXIS_RIGHT_JOYSTICK_X:2,AXIS_RIGHT_JOYSTICK_Y:3};ig.GamepadInput=ig.Class.extend({isInit:!1,isSupported:!1,list:[],
bindings:{},states:{},presses:{},releases:{},downLocks:{},upLocks:{},leftStick:{x:0,y:0},rightStick:{x:0,y:0},start:function(){if(!this.isInit){this.isInit=!0;var c=navigator.getGamepads||navigator.webkitGetGamepads;c&&(!navigator.getGamepads&&navigator.webkitGetGamepads&&(navigator.getGamepads=navigator.webkitGetGamepads),this.list=navigator.getGamepads());this.isSupported=c}},isAvailable:function(){return this.isInit&&this.isSupported},buttonPressed:function(c){return"object"==typeof c?c.pressed:
1==c},buttonDown:function(c){if(c=this.bindings[c])this.states[c]=!0,this.downLocks[c]||(this.presses[c]=!0,this.downLocks[c]=!0)},buttonUp:function(c){if((c=this.bindings[c])&&this.downLocks[c]&&!this.upLocks[c])this.states[c]=!1,this.releases[c]=!0,this.upLocks[c]=!0},clearPressed:function(){for(var c in this.releases)this.states[c]=!1,this.downLocks[c]=!1;this.releases={};this.presses={};this.upLocks={}},bind:function(c,b){this.bindings[c]=b},unbind:function(c){this.releases[this.bindings[c]]=
!0;this.bindings[c]=null},unbindAll:function(){this.bindings={};this.states={};this.presses={};this.releases={};this.downLocks={};this.upLocks={}},state:function(c){return this.states[c]},pressed:function(c){return this.presses[c]},released:function(c){return this.releases[c]},clamp:function(c,b,e){return c<b?b:c>e?e:c},pollGamepads:function(){if(this.isSupported){this.leftStick.x=0;this.leftStick.y=0;this.rightStick.x=0;this.rightStick.y=0;this.list=navigator.getGamepads();for(var c in this.bindings){for(var b=
!1,e=0;e<this.list.length;e++){var d=this.list[e];if(d&&d.buttons&&this.buttonPressed(d.buttons[c])){b=!0;break}}b?this.buttonDown(c):this.buttonUp(c)}for(e=0;e<this.list.length;e++)if((d=this.list[e])&&d.axes){c=d.axes[ig.GAMEPADINPUT.AXIS_LEFT_JOYSTICK_X];var b=d.axes[ig.GAMEPADINPUT.AXIS_LEFT_JOYSTICK_Y],j=d.axes[ig.GAMEPADINPUT.AXIS_RIGHT_JOYSTICK_X],d=d.axes[ig.GAMEPADINPUT.AXIS_RIGHT_JOYSTICK_Y];this.leftStick.x+=isNaN(c)?0:c;this.leftStick.y+=isNaN(b)?0:b;this.rightStick.x+=isNaN(j)?0:j;this.rightStick.y+=
isNaN(d)?0:d}0<this.list.length&&(this.leftStick.x=this.clamp(this.leftStick.x,-1,1),this.leftStick.y=this.clamp(this.leftStick.y,-1,1),this.rightStick.x=this.clamp(this.rightStick.x,-1,1),this.rightStick.y=this.clamp(this.rightStick.y,-1,1))}}})});ig.baked=!0;
ig.module("plugins.io.gamepad").requires("plugins.io.gamepad-input").defines(function(){Gamepad=ig.Class.extend({bindings:{padJump:[ig.PADKEY.BUTTON_0]},init:function(){ig.gamepadInput.start();for(var c in this.bindings)for(var b=0;b<this.bindings[c].length;b++)ig.gamepadInput.bind(this.bindings[c][b],c)},press:function(){},held:function(){},release:function(){}})});ig.baked=!0;
ig.module("plugins.io.multitouch").defines(function(){Multitouch=ig.Class.extend({init:function(){ig.multitouchInput.start()},getTouchesPos:function(){if(ig.ua.mobile){if(0<ig.multitouchInput.touches.length){for(var c=[],b=0;b<ig.multitouchInput.touches.length;b++){var e=ig.multitouchInput.touches[b];c.push({x:e.x,y:e.y})}return c}return null}}})});ig.baked=!0;
ig.module("plugins.io.multitouch-input").defines(function(){ig.MultitouchInput=ig.Class.extend({isStart:!1,touches:{},pressed:[],state:[],released:[],multitouchCapable:!1,lastEventUp:null,internalWidth:1,internalHeight:1,scaleX:1,scaleY:1,start:function(){this.isStart||(this.isStart=!0,navigator.maxTouchPoints&&1<navigator.maxTouchPoints&&(this.multitouchCapable=!0),ig.ua.touchDevice&&(window.navigator.msPointerEnabled&&(ig.system.canvas.addEventListener("MSPointerDown",this.touchdown.bind(this),
!1),ig.system.canvas.addEventListener("MSPointerUp",this.touchup.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",this.touchmove.bind(this),!1),ig.system.canvas.style.msContentZooming="none",ig.system.canvas.style.msTouchAction="none"),ig.system.canvas.addEventListener("touchstart",this.touchdown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.touchup.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.touchmove.bind(this),!1)))},touchdown:function(c){if(ig.ua.touchDevice)if(this.updateSizeProperties(),
window.navigator.msPointerEnabled)this.windowKeyDown(c);else if(c.touches){this.pollMultitouch(c.touches.length);this.updateSizeProperties();var b={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(b=ig.system.canvas.getBoundingClientRect());for(var e=[],d=0;d<c.touches.length;d++)e.push(c.touches[d]);this.spliceFromArray(e,this.pressed);this.spliceFromArray(e,this.state);this.spliceFromArray(e,this.released);for(d=0;d<e.length;d++)c=e[d],this.pressed.push({identifier:c.identifier,x:(c.clientX-
b.left)/this.scaleX,y:(c.clientY-b.top)/this.scaleY})}},touchmove:function(c){if(ig.ua.touchDevice){this.updateSizeProperties();if(window.navigator.msPointerEnabled)this.windowMove(c);else if(c.touches){this.pollMultitouch(c.touches.length);for(var b=0;b<c.touches.length;b++){var e=c.touches[b];this.upgrade(this.pressed,this.state,e);this.updateArray(this.state,e)}}try{ig.soundHandler.unlockWebAudio()}catch(d){}}},touchup:function(c){if(ig.ua.touchDevice){this.updateSizeProperties();if(window.navigator.msPointerEnabled)this.windowKeyUp(c);
else if(this.lastEventUp=c,c.touches)for(var b=0;b<c.changedTouches.length;b++){var e=c.changedTouches[b];this.upgrade(this.state,this.released,e);this.upgrade(this.pressed,this.released,e)}if(ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(d){}}},windowKeyDown:function(c){c=c.changedTouches?c.changedTouches:[c];this.pollMultitouch(c.length);this.updateSizeProperties();for(var b=[],e=0;e<c.length;e++)b.push(c[e]);var d={left:0,top:0};ig.system.canvas.getBoundingClientRect&&
(d=ig.system.canvas.getBoundingClientRect());this.spliceFromArray(b,this.pressed);this.spliceFromArray(b,this.state);this.spliceFromArray(b,this.released);for(e=0;e<b.length;e++){var j=c[e];this.pressed.push({identifier:"undefined"!=typeof j.identifier?j.identifier:"undefined"!=typeof j.pointerId?j.pointerId:1,x:(j.clientX-d.left)/this.scaleX,y:(j.clientY-d.top)/this.scaleY})}},windowKeyUp:function(c){this.lastEventUp=c;c=c.changedTouches?c.changedTouches:[c];for(var b=0;b<c.length;b++){var e=c[b],
e={identifier:"undefined"!=typeof e.identifier?e.identifier:"undefined"!=typeof e.pointerId?e.pointerId:1,clientX:e.clientX,clientY:e.clientY};this.upgrade(this.state,this.released,e);this.upgrade(this.pressed,this.released,e)}if(ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(d){}},windowMove:function(c){c=c.changedTouches?c.changedTouches:[c];this.pollMultitouch(c.length);for(var b=0;b<c.length;b++){var e=c[b],e={identifier:e.pointerId,clientX:e.clientX,
clientY:e.clientY};this.upgrade(this.pressed,this.state,e);this.updateArray(this.state,e)}try{ig.soundHandler.unlockWebAudio()}catch(d){}},clear:function(){for(var c=0;c<this.released.length;++c)this.released[c]&&(this.released.splice(c,1),c--)},pollMultitouch:function(c){!this.multitouchCapable&&1<c&&(this.multitouchCapable=!0)},spliceFromArray:function(c,b){for(var e=0;e<b.length;e++)for(var d=0;d<c.length;d++)c[d].identifier===b[e].identifier&&(c.splice(d,1),d--)},updateSizeProperties:function(){var c=
parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth,b=parseInt(ig.system.canvas.offsetHeight)||ig.system.realHeight;this.scaleX=ig.system.scale*(c/ig.system.realWidth);this.scaleY=ig.system.scale*(b/ig.system.realHeight)},upgrade:function(c,b,e){var d={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(d=ig.system.canvas.getBoundingClientRect());for(var j=(e.clientX-d.left)/this.scaleX,d=(e.clientY-d.top)/this.scaleY,g=0;g<c.length;g++)if(void 0!==typeof c[g].identifier&&void 0!==typeof e.identifier&&
e.identifier===c[g].identifier){c.splice(g,1);b.push({identifier:e.identifier,x:j,y:d});break}},updateArray:function(c,b){var e={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());for(var d=(b.clientX-e.left)/this.scaleX,e=(b.clientY-e.top)/this.scaleY,j=0;j<c.length;j++)if(void 0!==typeof c[j].identifier&&void 0!==typeof b.identifier&&b.identifier===c[j].identifier){c[j].x=d;c[j].y=e;break}}})});ig.baked=!0;
ig.module("plugins.io.fake-storage").requires("impact.game").defines(function(){ig.FakeStorage=ig.Class.extend({tempData:{},init:function(){ig.FakeStorage.instance=this},initUnset:function(c,b){null===this.get(c)&&this.set(c,b)},set:function(c,b){this.tempData[c]=JSON.stringify(b)},setHighest:function(c,b){b>this.getFloat(c)&&this.set(c,b)},get:function(c){return"undefined"==typeof this.tempData[c]?null:JSON.parse(this.tempData[c])},getInt:function(c){return~~this.get(c)},getFloat:function(c){return parseFloat(this.get(c))},
getBool:function(c){return!!this.get(c)},isSet:function(c){return null!==this.get(c)},remove:function(c){delete this.tempData[c]},clear:function(){this.tempData={}}})});ig.baked=!0;
ig.module("plugins.io.io-manager").requires("plugins.io.storage","plugins.io.mouse","plugins.io.keyboard","plugins.io.gamepad","plugins.io.multitouch","plugins.io.multitouch-input","plugins.io.gamepad-input","plugins.io.fake-storage").defines(function(){IoManager=ig.Class.extend({version:"1.0.0",storage:null,localStorageSupport:!1,mouse:null,keyboard:null,multitouch:null,gamepad:null,init:function(){ig.multitouchInput=new ig.MultitouchInput;ig.gamepadInput=new ig.GamepadInput;this.unbindAll();this.initStorage();
this.initMouse();this.initKeyboard()},unbindAll:function(){ig.input.unbindAll();ig.gamepadInput.unbindAll()},initStorage:function(){try{window.localStorage.setItem("test","test"),window.localStorage.removeItem("test"),this.storage=new ig.Storage}catch(c){console.log("using fake storage"),this.storage=new ig.FakeStorage}},initMouse:function(){this.mouse=new Mouse},initKeyboard:function(){this.keyboard=new Keyboard},initMultitouch:function(){this.multitouch=new Multitouch},initGamepad:function(){this.gamepad=
new Gamepad},press:function(c){return ig.input.pressed(c)||this.gamepad&&this.gamepad.press(c)?!0:!1},held:function(c){return ig.input.state(c)||this.gamepad&&this.gamepad.state(c)?!0:!1},release:function(c){return ig.input.released(c)||this.gamepad&&this.gamepad.released(c)?!0:!1},getClickPos:function(){return this.mouse.getPos()},getLastClickPos:function(){return this.mouse.getLast()},getTouchesPos:function(){return this.multitouch.getTouchesPos()},checkOverlap:function(c,b,e,d,j){return c.x>b+
d||c.x<b||c.y>e+j||c.y<e?!1:!0},clear:function(){ig.multitouchInput.clear()},_supportsLocalStorage:function(){try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),this.localStorageSupport="localStorage"in window&&null!==window.localStorage}catch(c){return this.localStorageSupport}},storageIsSet:function(c){return"function"===typeof this.storage.isSet?this.storage.isSet(c):null},storageGet:function(c){return"function"===typeof this.storage.get?this.storage.get(c):null},storageSet:function(c,
b){return"function"===typeof this.storage.set?this.storage.set(c,b):null},assert:function(c,b,e){if(b!==e)throw"actualValue:"+b+" not equal to testValue:"+e+" at "+c;}})});ig.baked=!0;
ig.module("plugins.io.storage-manager").requires("impact.game","plugins.io.io-manager").defines(function(){ig.Game.prototype.name="MJS-Game";ig.Game.prototype.version="1.0";ig.Game.prototype.sessionData={};ig.Game.prototype.initData=function(){return this.sessionData={sound:0.5,music:0.5,level:1,score:0}};ig.Game.prototype.setupStorageManager=function(){"undefined"===typeof this.name?console.error("Cannot found Game Name, Storage Manager Cancelled."):"undefined"===typeof this.version?console.error("Cannot found Game Version, Storage Manager Cancelled."):
(this.io||(this.io=new IoManager,console.log("IO Manager doesn't existed. Initialize...")),console.log("Plug in Storage Manager"),this.storage=this.io.storage,this.storageName=this.name+"-v"+this.version,this.loadAll())};ig.Game.prototype.loadAll=function(){var c=this.storage.get(this.storageName);if(null===c||"undefined"===typeof c)c=this.initData();for(var b in c)this.sessionData[b]=c[b];this.storage.set(this.storageName,c)};ig.Game.prototype.saveAll=function(){var c=this.storage.get(this.storageName),
b;for(b in c)c[b]=this.sessionData[b];this.storage.set(this.storageName,c)};ig.Game.prototype.load=function(c){return this.storage.get(this.storageName)[c]};ig.Game.prototype.save=function(c,b){var e=this.storage.get(this.storageName);e[c]=b;this.storage.set(this.storageName,e)}});ig.baked=!0;
ig.module("plugins.splash-loader").requires("impact.loader","impact.animation").defines(function(){ig.SplashLoader=ig.Loader.extend({desktopCoverDIVID:"play-desktop",splashDesktop:new ig.Image("media/graphics/splash/desktop/cover.jpg"),splashMobile:new ig.Image("media/graphics/splash/mobile/cover.jpg"),customAnim:new ig.AnimationSheet("media/graphics/splash/loading/anim.png",256,160),init:function(c,b){this.parent(c,b);this.setupCustomAnimation();var e=ig.domHandler.getElementById("#game"),d=ig.domHandler.getElementById("#webgl");
ig.domHandler.setZIndex(e,1);ig.domHandler.setZIndex(d,0);ig.apiHandler.run("MJSPreroll")},end:function(){this.parent();this._drawStatus=1;this.draw();_SETTINGS.TapToStartAudioUnlock.Enabled?this.tapToStartDiv(function(){ig.system.setGame(MyGame)}):ig.system.setGame(MyGame)},tapToStartDiv:function(c){this.desktopCoverDIV=document.getElementById(this.desktopCoverDIVID);if(!this.desktopCoverDIV){this.desktopCoverDIV=document.createElement("div");this.desktopCoverDIV.id=this.desktopCoverDIVID;this.desktopCoverDIV.setAttribute("class",
"play");this.desktopCoverDIV.setAttribute("style","position: absolute; display: block; z-index: 999999; background-color: rgba(23, 32, 53, 0.7); visibility: visible; font-size: 10vmin; text-align: center; vertical-align: middle; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;");this.desktopCoverDIV.innerHTML="<div style='color:white;background-color: rgba(255, 255, 255, 0.3); border: 2px solid #fff; font-size:20px; border-radius: 5px; position: relative; float: left; top: 50%; left: 50%; transform: translate(-50%, -50%);'><div style='padding:20px 50px; font-family: montserrat;'>"+
_STRINGS.Splash.TapToStart+"</div></div>";(document.getElementById("play").parentNode||document.getElementById("ajaxbar")).appendChild(this.desktopCoverDIV);try{"undefined"!==typeof ig.sizeHandler?"undefined"!==typeof ig.sizeHandler.coreDivsToResize&&(ig.sizeHandler.coreDivsToResize.push("#"+this.desktopCoverDIVID),"function"===typeof ig.sizeHandler.reorient&&ig.sizeHandler.reorient()):"undefined"!==typeof coreDivsToResize&&(coreDivsToResize.push(this.desktopCoverDIVID),"function"===typeof sizeHandler&&
sizeHandler())}catch(b){console.log(b)}this.desktopCoverDIV.addEventListener("click",function(){ig.soundHandler.unlockWebAudio();this.setAttribute("style","visibility: hidden;");"function"===typeof c&&c()})}},setupCustomAnimation:function(){this.animHeight=this.customAnim.height;this.animWidth=this.customAnim.width;this.customAnim=new ig.Animation(this.customAnim,0.025,[0,1,2,3,4,5,6,7])},animate:function(){this.customAnim.currentFrame<this.customAnim.sequence.length?this.customAnim.currentFrame++:
this.customAnim.currentFrame=0;this.customAnim.gotoFrame(this.customAnim.currentFrame)},draw:function(){this._drawStatus+=(this.status-this._drawStatus)/5;1===this.drawCheck&&console.log("Font should be loaded before loader draw loop");2>this.drawCheck&&this.drawCheck++;ig.system.context.fillStyle="#000";ig.system.context.fillRect(0,0,ig.system.width,ig.system.height);var c=ig.system.scale,b,e,d,j;ig.ua.mobile?(b=180,e=24,d=0.5*ig.system.width-b/2,j=0.67*ig.system.height,this.splashMobile.draw(0,
0)):(b=250,e=30,d=0.5*ig.system.width-b/2,j=0.67*ig.system.height,this.splashDesktop.draw(0,0));ig.system.context.fillStyle="#fff";ig.system.context.fillRect(d*c,j*c,b*c,e*c);ig.system.context.fillStyle="#000";ig.system.context.fillRect(d*c+c,j*c+c,b*c-c-c,e*c-c-c);ig.system.context.fillStyle="#A00A2D";ig.system.context.fillRect(d*c,j*c,b*c*this._drawStatus,e*c);this.animate();this.customAnim.draw(d*c+b*c*this._drawStatus-this.animWidth+20,j*c+c-0.5*this.animHeight+42);ig.system.context.fillStyle=
"#ffffff";ig.system.context.font="16px montserrat";b=_STRINGS.Splash.Loading;e=ig.system.width/2-ig.system.context.measureText(b).width/2;ig.system.context.fillText(b,e,j*c+18);ig.system.context.font="bold 14px montserrat";ig.system.context.fillStyle="#000000";b=_STRINGS.Splash.LogoLine1;e=ig.system.width/2-ig.system.context.measureText(b).width/2;c=0.6*ig.system.height;ig.system.context.font="bold 12px montserrat";ig.system.context.fillText(b,e,c);b=_STRINGS.Splash.LogoLine2;e=ig.system.width/2-
ig.system.context.measureText(b).width/2;c=0.6*ig.system.height+15;ig.system.context.font="bold 12px montserrat";ig.system.context.fillText(b,e,c)}})});ig.baked=!0;
ig.module("plugins.tween").requires("impact.entity").defines(function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(c){for(var b=0;b<this.length;++b)if(this[b]===c)return b;return-1});ig.Entity.prototype.tweens=[];ig.Entity.prototype._preTweenUpdate=ig.Entity.prototype.update;ig.Entity.prototype.update=function(){this._preTweenUpdate();if(0<this.tweens.length){for(var c=[],b=0;b<this.tweens.length;b++)this.tweens[b].update(),this.tweens[b].complete||c.push(this.tweens[b]);this.tweens=
c}};ig.Entity.prototype.tween=function(c,b,e){c=new ig.Tween(this,c,b,e);this.tweens.push(c);return c};ig.Entity.prototype.pauseTweens=function(){for(var c=0;c<this.tweens.length;c++)this.tweens[c].pause()};ig.Entity.prototype.resumeTweens=function(){for(var c=0;c<this.tweens.length;c++)this.tweens[c].resume()};ig.Entity.prototype.stopTweens=function(c){for(var b=0;b<this.tweens.length;b++)this.tweens[b].stop(c)};ig.Tween=function(c,b,e,d){var j={},g={},p={},m=0,f=!1,n=!1,l=!1;this.duration=e;this.paused=
this.complete=!1;this.easing=ig.Tween.Easing.Linear.EaseNone;this.onComplete=!1;this.loop=this.delay=0;this.loopCount=-1;ig.merge(this,d);this.loopNum=this.loopCount;this.chain=function(b){l=b};this.initEnd=function(b,c,d){if("object"!==typeof c[b])d[b]=c[b];else for(subprop in c[b])d[b]||(d[b]={}),this.initEnd(subprop,c[b],d[b])};this.initStart=function(b,c,d,e){if("object"!==typeof d[b])"undefined"!==typeof c[b]&&(e[b]=d[b]);else for(subprop in d[b])e[b]||(e[b]={}),"undefined"!==typeof c[b]&&this.initStart(subprop,
c[b],d[b],e[b])};this.start=function(){this.paused=this.complete=!1;this.loopNum=this.loopCount;m=0;-1==c.tweens.indexOf(this)&&c.tweens.push(this);n=!0;f=new ig.Timer;for(var d in b)this.initEnd(d,b,g);for(d in g)this.initStart(d,g,c,j),this.initDelta(d,p,c,g)};this.initDelta=function(b,c,d,e){if("object"!==typeof e[b])c[b]=e[b]-d[b];else for(subprop in e[b])c[b]||(c[b]={}),this.initDelta(subprop,c[b],d[b],e[b])};this.propUpdate=function(b,c,d,e,f){if("object"!==typeof d[b])c[b]="undefined"!=typeof d[b]?
d[b]+e[b]*f:c[b];else for(subprop in d[b])this.propUpdate(subprop,c[b],d[b],e[b],f)};this.propSet=function(b,c,d){if("object"!==typeof c[b])d[b]=c[b];else for(subprop in c[b])d[b]||(d[b]={}),this.propSet(subprop,c[b],d[b])};this.update=function(){if(!n)return!1;if(this.delay){if(f.delta()<this.delay)return;this.delay=0;f.reset()}if(this.paused||this.complete)return!1;var b=(f.delta()+m)/this.duration,b=1<b?1:b,d=this.easing(b);for(property in p)this.propUpdate(property,c,j,p,d);if(1<=b){if(0==this.loopNum||
!this.loop){this.complete=!0;if(this.onComplete)this.onComplete();l&&l.start();return!1}if(this.loop==ig.Tween.Loop.Revert){for(property in j)this.propSet(property,j,c);m=0;f.reset();-1!=this.loopNum&&this.loopNum--}else if(this.loop==ig.Tween.Loop.Reverse){b={};d={};ig.merge(b,g);ig.merge(d,j);ig.merge(j,b);ig.merge(g,d);for(property in g)this.initDelta(property,p,c,g);m=0;f.reset();-1!=this.loopNum&&this.loopNum--}}};this.pause=function(){this.paused=!0;f&&f.delta&&(m+=f.delta())};this.resume=function(){this.paused=
!1;f&&f.reset&&f.reset()};this.stop=function(b){b&&(this.loop=this.complete=this.paused=!1,m+=e,this.update());this.complete=!0}};ig.Tween.Loop={Revert:1,Reverse:2};ig.Tween.Easing={Linear:{},Quadratic:{},Cubic:{},Quartic:{},Quintic:{},Sinusoidal:{},Exponential:{},Circular:{},Elastic:{},Back:{},Bounce:{}};ig.Tween.Easing.Linear.EaseNone=function(c){return c};ig.Tween.Easing.Quadratic.EaseIn=function(c){return c*c};ig.Tween.Easing.Quadratic.EaseOut=function(c){return-c*(c-2)};ig.Tween.Easing.Quadratic.EaseInOut=
function(c){return 1>(c*=2)?0.5*c*c:-0.5*(--c*(c-2)-1)};ig.Tween.Easing.Cubic.EaseIn=function(c){return c*c*c};ig.Tween.Easing.Cubic.EaseOut=function(c){return--c*c*c+1};ig.Tween.Easing.Cubic.EaseInOut=function(c){return 1>(c*=2)?0.5*c*c*c:0.5*((c-=2)*c*c+2)};ig.Tween.Easing.Quartic.EaseIn=function(c){return c*c*c*c};ig.Tween.Easing.Quartic.EaseOut=function(c){return-(--c*c*c*c-1)};ig.Tween.Easing.Quartic.EaseInOut=function(c){return 1>(c*=2)?0.5*c*c*c*c:-0.5*((c-=2)*c*c*c-2)};ig.Tween.Easing.Quintic.EaseIn=
function(c){return c*c*c*c*c};ig.Tween.Easing.Quintic.EaseOut=function(c){return(c-=1)*c*c*c*c+1};ig.Tween.Easing.Quintic.EaseInOut=function(c){return 1>(c*=2)?0.5*c*c*c*c*c:0.5*((c-=2)*c*c*c*c+2)};ig.Tween.Easing.Sinusoidal.EaseIn=function(c){return-Math.cos(c*Math.PI/2)+1};ig.Tween.Easing.Sinusoidal.EaseOut=function(c){return Math.sin(c*Math.PI/2)};ig.Tween.Easing.Sinusoidal.EaseInOut=function(c){return-0.5*(Math.cos(Math.PI*c)-1)};ig.Tween.Easing.Exponential.EaseIn=function(c){return 0==c?0:Math.pow(2,
10*(c-1))};ig.Tween.Easing.Exponential.EaseOut=function(c){return 1==c?1:-Math.pow(2,-10*c)+1};ig.Tween.Easing.Exponential.EaseInOut=function(c){return 0==c?0:1==c?1:1>(c*=2)?0.5*Math.pow(2,10*(c-1)):0.5*(-Math.pow(2,-10*(c-1))+2)};ig.Tween.Easing.Circular.EaseIn=function(c){return-(Math.sqrt(1-c*c)-1)};ig.Tween.Easing.Circular.EaseOut=function(c){return Math.sqrt(1- --c*c)};ig.Tween.Easing.Circular.EaseInOut=function(c){return 1>(c/=0.5)?-0.5*(Math.sqrt(1-c*c)-1):0.5*(Math.sqrt(1-(c-=2)*c)+1)};ig.Tween.Easing.Elastic.EaseIn=
function(c){var b,e=0.1,d=0.4;if(0==c)return 0;if(1==c)return 1;d||(d=0.3);!e||1>e?(e=1,b=d/4):b=d/(2*Math.PI)*Math.asin(1/e);return-(e*Math.pow(2,10*(c-=1))*Math.sin((c-b)*2*Math.PI/d))};ig.Tween.Easing.Elastic.EaseOut=function(c){var b,e=0.1,d=0.4;if(0==c)return 0;if(1==c)return 1;d||(d=0.3);!e||1>e?(e=1,b=d/4):b=d/(2*Math.PI)*Math.asin(1/e);return e*Math.pow(2,-10*c)*Math.sin((c-b)*2*Math.PI/d)+1};ig.Tween.Easing.Elastic.EaseInOut=function(c){var b,e=0.1,d=0.4;if(0==c)return 0;if(1==c)return 1;
d||(d=0.3);!e||1>e?(e=1,b=d/4):b=d/(2*Math.PI)*Math.asin(1/e);return 1>(c*=2)?-0.5*e*Math.pow(2,10*(c-=1))*Math.sin((c-b)*2*Math.PI/d):0.5*e*Math.pow(2,-10*(c-=1))*Math.sin((c-b)*2*Math.PI/d)+1};ig.Tween.Easing.Back.EaseIn=function(c){return c*c*(2.70158*c-1.70158)};ig.Tween.Easing.Back.EaseOut=function(c){return(c-=1)*c*(2.70158*c+1.70158)+1};ig.Tween.Easing.Back.EaseInOut=function(c){return 1>(c*=2)?0.5*c*c*(3.5949095*c-2.5949095):0.5*((c-=2)*c*(3.5949095*c+2.5949095)+2)};ig.Tween.Easing.Bounce.EaseIn=
function(c){return 1-ig.Tween.Easing.Bounce.EaseOut(1-c)};ig.Tween.Easing.Bounce.EaseOut=function(c){return(c/=1)<1/2.75?7.5625*c*c:c<2/2.75?7.5625*(c-=1.5/2.75)*c+0.75:c<2.5/2.75?7.5625*(c-=2.25/2.75)*c+0.9375:7.5625*(c-=2.625/2.75)*c+0.984375};ig.Tween.Easing.Bounce.EaseInOut=function(c){return 0.5>c?0.5*ig.Tween.Easing.Bounce.EaseIn(2*c):0.5*ig.Tween.Easing.Bounce.EaseOut(2*c-1)+0.5};ig.Tween.Interpolation={Linear:function(c,b){var e=c.length-1,d=e*b,j=Math.floor(d),g=TWEEN.Interpolation.Utils.Linear;
return 0>b?g(c[0],c[1],d):1<b?g(c[e],c[e-1],e-d):g(c[j],c[j+1>e?e:j+1],d-j)}}});ig.baked=!0;
ig.module("plugins.patches.entity-patch").requires("impact.entity").defines(function(){ig.Entity.inject({handleMovementTrace:function(c){this.standing=!1;c.collision.y&&(0<this.bounciness&&Math.abs(this.vel.y)>this.minBounceVelocity?this.vel.y*=-this.bounciness:(0<this.vel.y&&(this.standing=!0),this.vel.y=0));c.collision.x&&(this.vel.x=0<this.bounciness&&Math.abs(this.vel.x)>this.minBounceVelocity?this.vel.x*-this.bounciness:0);if(c.collision.slope){var b=c.collision.slope;if(0<this.bounciness){var e=
this.vel.x*b.nx+this.vel.y*b.ny;this.vel.x=(this.vel.x-2*b.nx*e)*this.bounciness;this.vel.y=(this.vel.y-2*b.ny*e)*this.bounciness}else e=(this.vel.x*b.x+this.vel.y*b.y)/(b.x*b.x+b.y*b.y),this.vel.x=b.x*e,this.vel.y=b.y*e,b=Math.atan2(b.x,b.y),b>this.slopeStanding.min&&b<this.slopeStanding.max&&(this.standing=!0)}this.pos.x=c.pos.x;this.pos.y=c.pos.y}})});ig.baked=!0;
ig.module("plugins.tweens-handler").requires("impact.entity","plugins.tween","plugins.patches.entity-patch").defines(function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(b){for(var c=0;c<this.length;++c)if(this[c]===b)return c;return-1});ig.TweensHandler=ig.Class.extend({_tweens:[],_systemPausedTweens:[],init:function(){},getAll:function(){return this._tweens},removeAll:function(){this._tweens=[]},add:function(b){this._tweens.push(b)},remove:function(b){b=this._tweens.indexOf(b);
-1!==b&&this._tweens.splice(b,1)},onSystemPause:function(){if(0===this._tweens.length)return!1;for(var b=0,c=null;b<this._tweens.length;)c=this._tweens[b],c._isPlaying&&(this._systemPausedTweens.push(c),c.pause()),b++;return!0},onSystemResume:function(){if(0===this._systemPausedTweens.length)return!1;for(var b=0;b<this._systemPausedTweens.length;)this._systemPausedTweens[b].resume(),b++;this._systemPausedTweens=[];return!0},update:function(b,c){if(0===this._tweens.length)return!1;var d=0;for(b=void 0!==
b?b:ig.game.tweens.now();d<this._tweens.length;)this._tweens[d].update(b)||c?d++:this._tweens.splice(d,1);return!0},now:function(){return Date.now()}});ig.TweenDef=ig.Class.extend({_ent:null,_valuesStart:{},_valuesEnd:{},_valuesStartRepeat:{},_duration:1E3,_repeat:0,_yoyo:!1,_isPlaying:!1,_reversed:!1,_delayTime:0,_startTime:null,_pauseTime:null,_easingFunction:ig.Tween.Easing.Linear.EaseNone,_interpolationFunction:ig.Tween.Interpolation.Linear,_chainedTweens:[],_onStartCallback:null,_onStartCallbackFired:!1,
_onUpdateCallback:null,_onCompleteCallback:null,_onStopCallback:null,_onPauseCallback:null,_onResumeCallback:null,_currentElapsed:0,init:function(b){this._object=b},to:function(b,c){this._valuesEnd=b;void 0!==c&&(this._duration=c);return this},start:function(b){if(this._isPlaying)return this;ig.game.tweens.add(this);this._isPlaying=!0;this._onStartCallbackFired=!1;this._startTime=void 0!==b?b:ig.game.tweens.now();this._startTime+=this._delayTime;for(var c in this._valuesEnd){if(this._valuesEnd[c]instanceof
Array){if(0===this._valuesEnd[c].length)continue;this._valuesEnd[c]=[this._object[c]].concat(this._valuesEnd[c])}void 0!==this._object[c]&&(this._valuesStart[c]=this._object[c],!1===this._valuesStart[c]instanceof Array&&(this._valuesStart[c]*=1),this._valuesStartRepeat[c]=this._valuesStart[c]||0)}return this},stop:function(){if(!this._isPlaying)return this;ig.game.tweens.remove(this);this._isPlaying=!1;null!==this._onStopCallback&&this._onStopCallback.call(this._object,this._object);this.stopChainedTweens();
return this},pause:function(){if(!this._isPlaying)return this;ig.game.tweens.remove(this);this._isPlaying=!1;this._pauseTime=ig.game.tweens.now();null!==this._onPauseCallback&&this._onPauseCallback.call(this._object,this._object);return this},resume:function(){if(this._isPlaying||!this._pauseTime)return this;var b=ig.game.tweens.now()-this._pauseTime;this._startTime+=b;ig.game.tweens.add(this);this._isPlaying=!0;null!==this._onResumeCallback&&this._onResumeCallback.call(this._object,this._object);
this._pauseTime=null;return this},end:function(){this.update(this._startTime+this._duration);return this},stopChainedTweens:function(){for(var b=0,c=this._chainedTweens.length;b<c;b++)this._chainedTweens[b].stop()},delay:function(b){this._delayTime=b;return this},repeat:function(b){this._repeat=b;return this},repeatDelay:function(b){this._repeatDelayTime=b;return this},yoyo:function(b){this._yoyo=b;return this},easing:function(b){this._easingFunction=b;return this},interpolation:function(b){this._interpolationFunction=
b;return this},chain:function(){this._chainedTweens=arguments;return this},onStart:function(b){this._onStartCallback=b;return this},onUpdate:function(b){this._onUpdateCallback=b;return this},onComplete:function(b){this._onCompleteCallback=b;return this},onStop:function(b){this._onStopCallback=b;return this},onPause:function(b){this._onPauseCallback=b;return this},onResume:function(b){this._onResumeCallback=b;return this},update:function(b){var c,d,j;if(b<this._startTime)return!0;!1===this._onStartCallbackFired&&
(null!==this._onStartCallback&&this._onStartCallback.call(this._object,this._object),this._onStartCallbackFired=!0);d=(b-this._startTime)/this._duration;this._currentElapsed=d=1<d?1:d;j=this._easingFunction(d);for(c in this._valuesEnd)if(void 0!==this._valuesStart[c]){var g=this._valuesStart[c]||0,p=this._valuesEnd[c];p instanceof Array?this._object[c]=this._interpolationFunction(p,j):("string"===typeof p&&(p="+"===p.charAt(0)||"-"===p.charAt(0)?g+parseFloat(p):parseFloat(p)),"number"===typeof p&&
(this._object[c]=g+(p-g)*j))}null!==this._onUpdateCallback&&this._onUpdateCallback.call(this._object,this._object,j);if(1===d)if(0<this._repeat){isFinite(this._repeat)&&this._repeat--;for(c in this._valuesStartRepeat)"string"===typeof this._valuesEnd[c]&&(this._valuesStartRepeat[c]=_valuesStartRepeat[c]+parseFloat(_valuesEnd[c])),this._yoyo&&(d=this._valuesStartRepeat[c],this._valuesStartRepeat[c]=this._valuesEnd[c],this._valuesEnd[c]=d),this._valuesStart[c]=this._valuesStartRepeat[c];this._yoyo&&
(this._reversed=!this._reversed);this._startTime=void 0!==this._repeatDelayTime?b+this._repeatDelayTime:b+this._delayTime}else{null!==this._onCompleteCallback&&this._onCompleteCallback.call(this._object,this._object);b=0;for(c=this._chainedTweens.length;b<c;b++)this._chainedTweens[b].start(this._startTime+this._duration);return!1}return!0}});var c=[1];ig.Tween.Interpolation={Linear:function(b,c){var d=b.length-1,j=d*c,g=Math.floor(j),p=ig.Tween.Interpolation.Utils.Linear;return 0>c?p(b[0],b[1],j):
1<c?p(b[d],b[d-1],d-j):p(b[g],b[g+1>d?d:g+1],j-g)},Bezier:function(b,c){for(var d=0,j=b.length-1,g=Math.pow,p=ig.Tween.Interpolation.Utils.Bernstein,m=0;m<=j;m++)d+=g(1-c,j-m)*g(c,m)*b[m]*p(j,m);return d},CatmullRom:function(b,c){var d=b.length-1,j=d*c,g=Math.floor(j),p=ig.Tween.Interpolation.Utils.CatmullRom;return b[0]===b[d]?(0>c&&(g=Math.floor(j=d*(1+c))),p(b[(g-1+d)%d],b[g],b[(g+1)%d],b[(g+2)%d],j-g)):0>c?b[0]-(p(b[0],b[0],b[1],b[1],-j)-b[0]):1<c?b[d]-(p(b[d],b[d],b[d-1],b[d-1],j-d)-b[d]):p(b[g?
g-1:0],b[g],b[d<g+1?d:g+1],b[d<g+2?d:g+2],j-g)},Utils:{Linear:function(b,c,d){return(c-b)*d+b},Bernstein:function(b,c){var d=ig.Tween.Interpolation.Utils.Factorial;return d(b)/d(c)/d(b-c)},Factorial:function(b){var e=1;if(c[b])return c[b];for(var d=b;1<d;d--)e*=d;return c[b]=e},CatmullRom:function(b,c,d,j,g){b=0.5*(d-b);j=0.5*(j-c);var p=g*g;return(2*c-2*d+b+j)*g*p+(-3*c+3*d-2*b-j)*p+b*g+c}}}});ig.baked=!0;
ig.module("plugins.url-parameters").defines(function(){ig.UrlParameters=ig.Class.extend({init:function(){switch(getQueryVariable("iphone")){case "true":ig.ua.iPhone=!0,console.log("iPhone mode")}var c=getQueryVariable("webview");if(c)switch(c){case "true":ig.ua.is_uiwebview=!0,console.log("webview mode")}if(c=getQueryVariable("debug"))switch(c){case "true":ig.game.showDebugMenu(),console.log("debug mode")}if(c=getQueryVariable("debugwgl"))switch(c){case "true":wgl.debug.debug=!0,console.log("wgl debug mode")}switch(getQueryVariable("view")){case "stats":ig.game.resetPlayerStats(),
ig.game.endGame()}getQueryVariable("ad")}})});ig.baked=!0;
ig.module("plugins.director").requires("impact.impact").defines(function(){ig.Director=ig.Class.extend({init:function(c,b){this.game=c;this.levels=[];this.currentLevel=0;this.append(b)},loadLevel:function(c){for(var b in ig.sizeHandler.dynamicClickableEntityDivs){var e=ig.domHandler.getElementById("#"+b);ig.domHandler.hide(e)}this.currentLevel=c;this.game.loadLevel(this.levels[c]);return!0},loadLevelWithoutEntities:function(c){this.currentLevel=c;this.game.loadLevelWithoutEntities(this.levels[c]);
return!0},append:function(c){newLevels=[];return"object"===typeof c?(c.constructor===[].constructor?newLevels=c:newLevels[0]=c,this.levels=this.levels.concat(newLevels),!0):!1},nextLevel:function(){return this.currentLevel+1<this.levels.length?this.loadLevel(this.currentLevel+1):!1},previousLevel:function(){return 0<=this.currentLevel-1?this.loadLevel(this.currentLevel-1):!1},jumpTo:function(c){var b=null;for(i=0;i<this.levels.length;i++)this.levels[i]==c&&(b=i);return 0<=b?this.loadLevel(b):!1},
firstLevel:function(){return this.loadLevel(0)},lastLevel:function(){return this.loadLevel(this.levels.length-1)},reloadLevel:function(){return this.loadLevel(this.currentLevel)}})});ig.baked=!0;
ig.module("plugins.impact-storage").requires("impact.game").defines(function(){ig.Storage=ig.Class.extend({staticInstantiate:function(){return!ig.Storage.instance?null:ig.Storage.instance},init:function(){ig.Storage.instance=this},isCapable:function(){return"undefined"!==typeof window.localStorage},isSet:function(c){return null!==this.get(c)},initUnset:function(c,b){null===this.get(c)&&this.set(c,b)},get:function(c){if(!this.isCapable())return null;try{return JSON.parse(localStorage.getItem(c))}catch(b){return window.localStorage.getItem(c)}},
getInt:function(c){return~~this.get(c)},getFloat:function(c){return parseFloat(this.get(c))},getBool:function(c){return!!this.get(c)},key:function(c){return this.isCapable()?window.localStorage.key(c):null},set:function(c,b){if(!this.isCapable())return null;try{window.localStorage.setItem(c,JSON.stringify(b))}catch(e){console.log(e)}},setHighest:function(c,b){b>this.getFloat(c)&&this.set(c,b)},remove:function(c){if(!this.isCapable())return null;window.localStorage.removeItem(c)},clear:function(){if(!this.isCapable())return null;
window.localStorage.clear()}})});ig.baked=!0;
ig.module("plugins.responsive.responsive-utils").requires("impact.system").defines(function(){ig.responsive={width:0,height:0,halfWidth:0,halfHeight:0,originalWidth:0,originalHeight:0,fillScale:1,scaleX:1,scaleY:1,toAnchor:function(c,b,e){switch(e){case "top-left":case "left-top":return this.toAnchorTopLeft(c,b);case "top-center":case "center-top":case "top":return this.toAnchorTopCenter(c,b);case "top-right":case "right-top":return this.toAnchorTopRight(c,b);case "left-middle":case "middle-left":case "left":return this.toAnchorLeftMiddle(c,
b);case "center-middle":case "middle-center":case "middle":case "center":return this.toAnchorCenterMiddle(c,b);case "right-middle":case "middle-right":case "right":return toAnchorRightMiddle(c,b);case "bottom-left":case "left-bottom":return this.toAnchorBottomLeft(c,b);case "bottom-center":case "center-bottom":case "bottom":return this.toAnchorBottomCenter(c,b);case "bottom-right":case "right-bottom":return this.toAnchorBottomRight(c,b);default:return this.toAnchorDefault(c,b)}},toAnchorDefault:function(c,
b){return{x:c+(this.width-this.originalWidth)/2,y:b+(this.height-this.originalHeight)/2}},toAnchorCenterMiddle:function(c,b){return{x:c+this.halfWidth,y:b+this.halfHeight}},toAnchorLeftMiddle:function(c,b){return{x:c,y:b+this.halfHeight}},toAnchorTopCenter:function(c,b){return{x:c+this.halfWidth,y:b}},toAnchorRightMiddle:function(c,b){return{x:c+this.width,y:b+this.halfHeight}},toAnchorBottomCenter:function(c,b){return{x:c+this.halfWidth,y:b+this.height}},toAnchorTopLeft:function(c,b){return{x:c,
y:b}},toAnchorBottomLeft:function(c,b){return{x:c,y:b+this.height}},toAnchorTopRight:function(c,b){return{x:c+this.width,y:b}},toAnchorBottomRight:function(c,b){return{x:c+this.width,y:b+this.height}},drawScaledImage:function(c,b,e,d,j,g,p){g||(g=0);p||(p=0);var m=ig.system.context;m.save();m.translate(b,e);(1!=d||1!=j)&&m.scale(d,j);c.draw(-c.width*g,-c.height*p);m.restore()}}});ig.baked=!0;
ig.module("plugins.responsive.responsive-plugin").requires("impact.system","impact.entity","plugins.handlers.size-handler","plugins.responsive.responsive-utils").defines(function(){ig.SizeHandler.inject({resize:function(){this.parent()},sizeCalcs:function(){this.originalResolution||(this.originalResolution=new BABYLON.Vector2(this.desktop.actualResolution.x,this.desktop.actualResolution.y),ig.responsive.originalWidth=this.desktop.actualResolution.x,ig.responsive.originalHeight=this.desktop.actualResolution.y);
var c=window.innerWidth,b=window.innerHeight,e=c/b,d=this.originalResolution.x/this.originalResolution.y,j=0,g=0;this.windowSize=new BABYLON.Vector2(c,b);e<d?(j=this.originalResolution.x,g=j/e,ig.responsive.scaleX=1,ig.responsive.scaleY=g/this.originalResolution.y):(g=this.originalResolution.y,j=g*e,ig.responsive.scaleX=j/this.originalResolution.x,ig.responsive.scaleY=1);this.scaleRatioMultiplier=new BABYLON.Vector2(c/j,b/g);this.desktop.actualResolution=new BABYLON.Vector2(j,g);this.mobile.actualResolution=
new BABYLON.Vector2(j,g);this.desktop.actualSize=new BABYLON.Vector2(c,b);this.mobile.actualSize=new BABYLON.Vector2(c,b);ig.responsive.width=j;ig.responsive.height=g;ig.responsive.halfWidth=j/2;ig.responsive.halfHeight=g/2;ig.responsive.fillScale=Math.max(ig.responsive.scaleX,ig.responsive.scaleY)},resizeLayers:function(){ig.system.resize(ig.sizeHandler.desktop.actualResolution.x,ig.sizeHandler.desktop.actualResolution.y);for(var c=0;c<this.coreDivsToResize.length;c++){var b=ig.domHandler.getElementById(this.coreDivsToResize[c]),
e=Math.floor(ig.sizeHandler.windowSize.x/2-ig.sizeHandler.desktop.actualSize.x/2),d=Math.floor(ig.sizeHandler.windowSize.y/2-ig.sizeHandler.desktop.actualSize.y/2);0>e&&(e=0);0>d&&(d=0);ig.domHandler.resizeOffset(b,Math.floor(ig.sizeHandler.desktop.actualSize.x),Math.floor(ig.sizeHandler.desktop.actualSize.y),e,d)}for(var j in this.adsToResize)c=ig.domHandler.getElementById("#"+j),b=ig.domHandler.getElementById("#"+j+"-Box"),e=(window.innerWidth-this.adsToResize[j]["box-width"])/2+"px",d=(window.innerHeight-
this.adsToResize[j]["box-height"])/2+"px",c&&ig.domHandler.css(c,{width:window.innerWidth,height:window.innerHeight}),b&&ig.domHandler.css(b,{left:e,top:d});c=ig.domHandler.getElementById("#canvas");b=ig.domHandler.getOffsets(c);c=b.left;b=b.top;e=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);for(j in this.dynamicClickableEntityDivs)d=ig.domHandler.getElementById("#"+j),ig.domHandler.css(d,{"float":"left",position:"absolute",left:Math.floor(c+this.dynamicClickableEntityDivs[j].entity_pos_x*
this.scaleRatioMultiplier.x)+"px",top:Math.floor(b+this.dynamicClickableEntityDivs[j].entity_pos_y*this.scaleRatioMultiplier.y)+"px",width:Math.floor(this.dynamicClickableEntityDivs[j].width*this.scaleRatioMultiplier.x)+"px",height:Math.floor(this.dynamicClickableEntityDivs[j].height*this.scaleRatioMultiplier.y)+"px","z-index":3}),this.dynamicClickableEntityDivs[j]["font-size"]&&ig.domHandler.css(d,{"font-size":this.dynamicClickableEntityDivs[j]["font-size"]*e+"px"});$("#ajaxbar").width(this.windowSize.x);
$("#ajaxbar").height(this.windowSize.y)},reorient:function(){ig.ua.mobile?(this.resize(),this.resizeAds()):this.resize();this.resizeBabylon();ig.game&&(ig.game.update(),ig.game.draw())},resizeBabylon:function(){var c=window.innerWidth,b=window.innerHeight,e=c/b,d=ig.responsive.originalWidth,j=ig.responsive.originalHeight,g=d/j,p=Math.max(d,j);ig.ua.mobile&&(p=640);minSize=Math.min(d,j);e>g?(b>j&&(b=j),c=Math.floor(window.innerWidth/window.innerHeight*b),c>p&&(c=p),b=Math.floor(window.innerHeight/
window.innerWidth*c)):(c>d&&(c=d),b=Math.floor(window.innerHeight/window.innerWidth*c),b>p&&(b=p),c=Math.floor(window.innerWidth/window.innerHeight*b));d=e=1;window.innerWidth>p&&(e=window.innerWidth/p);window.innerHeight>p&&(d=window.innerHeight/p);wgl.system.engine.setSize(c,b);wgl.system.engine.resize();wgl.system.engine.setHardwareScalingLevel(Math.max(e,d));console.log("babylon renderSize : ",wgl.system.engine.getRenderWidth(),wgl.system.engine.getRenderHeight(),"hwScalingLevel : ",wgl.system.engine.getHardwareScalingLevel())}});
ig.Entity.inject({init:function(c,b,e){this.parent(c,b,e);this.anchorType="none";this.anchoredPositionX=c;this.anchoredPositionY=b},setAnchoredPosition:function(c,b,e){e||(e="default");this.anchorType=e;this.anchoredPositionX=c;this.anchoredPositionY=b},update:function(){this.parent();if(""!=this.anchorType&&"none"!=this.anchorType){var c=ig.responsive.toAnchor(this.anchoredPositionX,this.anchoredPositionY,this.anchorType);this.pos.x=c.x;this.pos.y=c.y}}})});this.START_BRANDING_SPLASH;ig.baked=!0;
ig.module("plugins.branding.splash").requires("impact.impact","impact.entity").defines(function(){ig.BrandingSplash=ig.Class.extend({init:function(){ig.game.spawnEntity(EntityBranding,0,0)}});EntityBranding=ig.Entity.extend({gravityFactor:0,size:{x:32,y:32},splash:new ig.Image("branding/splash1.png"),init:function(c,b,e){this.parent(c,b,e);320>=ig.system.width?(this.size.x=320,this.size.y=200):(this.size.x=480,this.size.y=240);this.pos.x=(ig.system.width-this.size.x)/2;this.pos.y=-this.size.y-200;
this.endPosY=(ig.system.height-this.size.y)/2;c=this.tween({pos:{y:this.endPosY}},0.5,{easing:ig.Tween.Easing.Bounce.EaseIn});b=this.tween({},2.5,{onComplete:function(){ig.game.director.loadLevel(ig.game.director.currentLevel)}});c.chain(b);c.start();this.currentAnim=this.anims.idle},createClickableLayer:function(){console.log("Build clickable layer");this.checkClickableLayer("branding-splash",_SETTINGS.Branding.Logo.Link,_SETTINGS.Branding.Logo.NewWindow)},doesClickableLayerExist:function(c){for(k in dynamicClickableEntityDivs)if(k==
c)return!0;return!1},checkClickableLayer:function(c,b,e){"undefined"==typeof wm&&(this.doesClickableLayerExist(c)?(ig.game.showOverlay([c]),$("#"+c).find("[href]").attr("href",b)):this.createClickableOutboundLayer(c,b,"media/graphics/misc/invisible.png",e))},createClickableOutboundLayer:function(c,b,e,d){var j=ig.$new("div");j.id=c;document.body.appendChild(j);j=$("#"+j.id);j.css("float","left");j.css("position","absolute");if(ig.ua.mobile){var g=window.innerHeight/mobileHeight,p=window.innerWidth/
mobileWidth;j.css("left",this.pos.x*p);j.css("top",this.pos.y*g);j.css("width",this.size.x*p);j.css("height",this.size.y*g)}else g=w/2-destW/2,p=h/2-destH/2,console.log(g,p),j.css("left",g+this.pos.x*multiplier),j.css("top",p+this.pos.y*multiplier),j.css("width",this.size.x*multiplier),j.css("height",this.size.y*multiplier);d?j.html("<a target='_blank' href='"+b+"'><img style='width:100%;height:100%' src='"+e+"'></a>"):j.html("<a href='"+b+"'><img style='width:100%;height:100%' src='"+e+"'></a>");
dynamicClickableEntityDivs[c]={};dynamicClickableEntityDivs[c].width=this.size.x*multiplier;dynamicClickableEntityDivs[c].height=this.size.y*multiplier;dynamicClickableEntityDivs[c].entity_pos_x=this.pos.x;dynamicClickableEntityDivs[c].entity_pos_y=this.pos.y},draw:function(){ig.system.context.fillStyle="#ffffff";ig.system.context.fillRect(0,0,ig.system.width,ig.system.height);ig.system.context.fillStyle="#000";ig.system.context.font="12px Arial";ig.system.context.textAlign="left";320>=ig.system.width?
ig.system.context.fillText("powered by MarketJS.com",ig.system.width-150,ig.system.height-15):ig.system.context.fillText("powered by MarketJS.com",ig.system.width-160,ig.system.height-15);this.parent();this.splash&&ig.system.context.drawImage(this.splash.data,0,0,this.splash.data.width,this.splash.data.height,this.pos.x,this.pos.y,this.size.x,this.size.y)}})});this.END_BRANDING_SPLASH;ig.baked=!0;
ig.module("plugins.datastructure.binary-heap").defines(function(){BinaryHeap=ig.Class.extend({content:[],getValue:null,minHeap:!0,tagName:"BinaryHeap",init:function(c,b){this.getValue=c;b&&(this.minHeap=!1)},push:function(c){this.content.push(c);this.sinkDown(this.content.length-1)},pop:function(){var c=this.content[0],b=this.content.pop();0<this.content.length&&(this.content[0]=b,this.bubbleUp(0));return c},remove:function(c){var b=this.content.indexOf(c),e=this.content.pop();b!==this.content.length-
1&&(this.content[b]=e,this.minHeap?this.getValue(e)<this.getValue(c)?this.sinkDown(b):this.bubbleUp(b):this.getValue(e)>this.getValue(c)?this.sinkDown(b):this.bubbleUp(b))},size:function(){return this.content.length},rescoreElement:function(c){this.sinkDown(this.content.indexOf(c))},sinkDown:function(c){for(var b=this.content[c];0<c;){var e=(c+1>>1)-1,d=this.content[e];if(this.minHeap)if(this.getValue(b)<this.getValue(d))this.content[e]=b,this.content[c]=d,c=e;else break;else if(this.getValue(b)>
this.getValue(d))this.content[e]=b,this.content[c]=d,c=e;else break}},bubbleUp:function(c){for(var b=this.content.length,e=this.content[c],d=this.getValue(e);;){var j=c+1<<1,g=j-1,p=null,m;g<b&&(m=this.getValue(this.content[g]),this.minHeap?m<d&&(p=g):m>d&&(p=g));if(j<b)if(g=this.getValue(this.content[j]),this.minHeap){if(g<(null===p?d:m))p=j}else if(g>(null===p?d:m))p=j;if(null!==p)this.content[c]=this.content[p],this.content[p]=e,c=p;else break}},empty:function(){for(;0<this.content.length;)this.content.pop()}})});
ig.baked=!0;
ig.module("game.entities.buttons.button").requires("impact.entity").defines(function(){EntityButton=ig.Entity.extend({collides:ig.Entity.COLLIDES.NEVER,type:ig.Entity.TYPE.A,size:new BABYLON.Vector2(48,48),fillColor:null,zIndex:95E3,pos:{x:0,y:0},name:"button",init:function(c,b,e){this.parent(c,b,e);!ig.global.wm&&(e&&!isNaN(e.zIndex))&&(this.zIndex=e.zIndex);c=Math.floor(256*Math.random());b=Math.floor(256*Math.random());e=Math.floor(256*Math.random());this.fillColor="rgba("+c+","+e+","+b+",1)"},
clicked:function(){throw"no implementation on clicked()";},clicking:function(){throw"no implementation on clicking()";},released:function(){throw"no implementation on released()";}})});ig.baked=!0;
ig.module("plugins.clickable-div-layer").defines(function(){ClickableDivLayer=ig.Class.extend({pos:new BABYLON.Vector2(0,0),size:new BABYLON.Vector2(0,0),identifier:null,invisImagePath:"media/graphics/misc/invisible.png",init:function(c){this.pos=new BABYLON.Vector2(c.pos.x,c.pos.y);this.size=new BABYLON.Vector2(c.size.x,c.size.y);var b="more-games",e="www.google.com",d=!1;c.div_layer_name&&(b=c.div_layer_name);c.link&&(e=c.link);c.newWindow&&(d=c.newWindow);this.createClickableLayer(b,e,d)},createClickableLayer:function(c,
b,e){this.identifier=c;var d=ig.domHandler.getElementById("#"+c);d?(ig.domHandler.show(d),ig.domHandler.attr(d,"href",b)):this.createClickableOutboundLayer(c,b,this.invisImagePath,e)},update:function(c,b,e,d){this.pos.x==c&&this.pos.y==b||(this.pos.x=c,this.pos.y=b,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier]={},ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].width=e,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].height=d,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].entity_pos_x=
this.pos.x,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].entity_pos_y=this.pos.y,ig.sizeHandler.resizeLayers())},createClickableOutboundLayer:function(c,b,e,d){var j=ig.domHandler.create("div");ig.domHandler.attr(j,"id",c);var g=ig.domHandler.create("a");ig.domHandler.addEvent(j,"mousedown",function(b){b.preventDefault()});d?(ig.domHandler.attr(g,"href",b),ig.domHandler.attr(g,"target","_blank")):ig.domHandler.attr(g,"href",b);b=ig.domHandler.create("img");ig.domHandler.css(b,{width:"100%",
height:"100%"});ig.domHandler.attr(b,"src",e);e=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);if(ig.ua.mobile){d=Math.floor(this.pos.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px";var p=Math.floor(this.pos.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px",m=Math.floor(this.size.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px";e=Math.floor(this.size.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px"}else d=ig.domHandler.getElementById("#canvas"),d=ig.domHandler.getOffsets(d),
p=d.top,d=Math.floor(d.left+this.pos.x*e)+"px",p=Math.floor(p+this.pos.y*e)+"px",m=Math.floor(this.size.x*e)+"px",e=Math.floor(this.size.y*e)+"px";ig.domHandler.css(j,{"float":"left",position:"absolute",left:d,top:p,width:m,height:e,"z-index":3});ig.domHandler.addEvent(j,"mousemove",ig.input.mousemove.bind(ig.input),!1);ig.domHandler.appendChild(g,b);ig.domHandler.appendChild(j,g);ig.domHandler.appendToBody(j);ig.sizeHandler.dynamicClickableEntityDivs[c]={};ig.sizeHandler.dynamicClickableEntityDivs[c].width=
this.size.x;ig.sizeHandler.dynamicClickableEntityDivs[c].height=this.size.y;ig.sizeHandler.dynamicClickableEntityDivs[c].entity_pos_x=this.pos.x;ig.sizeHandler.dynamicClickableEntityDivs[c].entity_pos_y=this.pos.y}})});ig.baked=!0;
ig.module("game.entities.buttons.button-branding-logo").requires("game.entities.buttons.button","plugins.clickable-div-layer").defines(function(){EntityButtonBrandingLogo=EntityButton.extend({type:ig.Entity.TYPE.A,gravityFactor:0,logo:new ig.AnimationSheet("branding/logo.png",_SETTINGS.Branding.Logo.Width,_SETTINGS.Branding.Logo.Height),zIndex:10001,size:{x:64,y:66},clickableLayer:null,link:null,newWindow:!1,div_layer_name:"branding-logo",name:"brandinglogo",init:function(c,b,e){this.parent(c,b,e);
if(!ig.global.wm){ig.responsive&&(this.anchorType="default");if("undefined"==typeof wm)if(_SETTINGS.Branding.Logo.Enabled)this.size.x=_SETTINGS.Branding.Logo.Width,this.size.y=_SETTINGS.Branding.Logo.Height,this.anims.idle=new ig.Animation(this.logo,0,[0],!0),this.currentAnim=this.anims.idle,e&&e.centralize&&(this.pos.x=(ig.system.width>>>1)-(this.size.x>>>1),console.log("centralize true ... centering branded logo ...")),_SETTINGS.Branding.Logo.LinkEnabled&&(this.link=_SETTINGS.Branding.Logo.Link,
this.newWindow=_SETTINGS.Branding.Logo.NewWindow,this.clickableLayer=new ClickableDivLayer(this));else{this.kill();return}this.div_layer_name=e.div_layer_name?e.div_layer_name:"branding-logo"}},show:function(){var c=ig.domHandler.getElementById("#"+this.div_layer_name);ig.domHandler.show(c)},hide:function(){var c=ig.domHandler.getElementById("#"+this.div_layer_name);ig.domHandler.hide(c)},clicked:function(){},clicking:function(){},released:function(){}})});ig.baked=!0;
ig.module("game.entities.branding-logo-placeholder").requires("impact.entity","game.entities.buttons.button-branding-logo").defines(function(){EntityBrandingLogoPlaceholder=ig.Entity.extend({gravityFactor:0,size:{x:32,y:32},_wmDrawBox:!0,_wmBoxColor:"rgba(0, 0, 255, 0.7)",init:function(c,b,e){this.parent(c,b,e);ig.responsive&&(this.anchorType="default");if(e)switch(console.log("settings found ... using that div layer name"),c=e.div_layer_name,console.log("settings.centralize:",e.centralize),e.centralize){case "true":console.log("centralize true");
centralize=!0;break;case "false":console.log("centralize false");centralize=!1;break;default:console.log("default ... centralize false"),centralize=!1}else c="branding-logo",centralize=!1;if("undefined"==typeof wm){if(_SETTINGS.Branding.Logo.Enabled)try{ig.game.spawnEntity(EntityButtonBrandingLogo,this.pos.x,this.pos.y,{div_layer_name:c,centralize:centralize})}catch(d){console.log(d)}this.kill()}}})});ig.baked=!0;
ig.module("game.entities.buttons.button-more-games").requires("game.entities.buttons.button","plugins.clickable-div-layer").defines(function(){EntityButtonMoreGames=EntityButton.extend({type:ig.Entity.TYPE.A,gravityFactor:0,logo:new ig.AnimationSheet("media/graphics/sprites/btn_more_games.png",64,66),size:{x:64,y:66},zIndex:750,clickableLayer:null,link:null,newWindow:!1,div_layer_name:"more-games",name:"moregames",init:function(c,b,e){this.parent(c,b,e);ig.global.wm||(ig.responsive&&(this.anchorType=
"default"),this.div_layer_name=e.div_layer_name?e.div_layer_name:"more-games",_SETTINGS.MoreGames.Enabled?(this.anims.idle=new ig.Animation(this.logo,0,[0],!0),this.currentAnim=this.anims.idle,_SETTINGS.MoreGames.Link&&(this.link=_SETTINGS.MoreGames.Link),_SETTINGS.MoreGames.NewWindow&&(this.newWindow=_SETTINGS.MoreGames.NewWindow),this.clickableLayer=new ClickableDivLayer(this)):this.kill())},update:function(){this.parent();this.clickableLayer.update(this.pos.x,this.pos.y,this.size.x,this.size.y)},
show:function(){var c=ig.domHandler.getElementById("#"+this.div_layer_name);ig.domHandler.show(c)},hide:function(){var c=ig.domHandler.getElementById("#"+this.div_layer_name);ig.domHandler.hide(c)},clicked:function(){},clicking:function(){},released:function(){}})});ig.baked=!0;
ig.module("game.entities.opening-shield").requires("impact.entity").defines(function(){EntityOpeningShield=ig.Entity.extend({size:{x:48,y:48},move:0,mIconAnim:0,shieldAnim:0,titleAnim:0,shieldImage:new ig.Image("media/graphics/opening/shield.png"),mIconImage:new ig.Image("media/graphics/opening/m_icon.png"),titleImage:new ig.Image("media/graphics/opening/title.png"),init:function(c,b,e){this.parent(c,b,e)},ready:function(){if(!ig.wm)if(_SETTINGS.DeveloperBranding.Splash.Enabled){this.initTimer=new ig.Timer(0.1);
try{ig.soundHandler.playSound(ig.soundHandler.SOUNDID.openingSound)}catch(c){console.log(c)}}else ig.game.director.nextLevel(),ig.system.context.globalAlpha=1,this.kill()},update:function(){this.parent();this.updateOriginalShieldOpening()},draw:function(){this.parent();ig.global.wm||(this.nextLevelTimer&&0>this.nextLevelTimer.delta()&&(ig.system.context.globalAlpha=-this.nextLevelTimer.delta()),this.drawOriginalShieldOpening())},updateOriginalShieldOpening:function(){this.initTimer&&0<this.initTimer.delta()&&
(this.initTimer=null,this.sheildTimer=new ig.Timer(0.05));this.sheildTimer&&0<this.sheildTimer.delta()&&(3>this.shieldAnim?(this.shieldAnim++,this.sheildTimer.reset()):(this.sheildTimer=null,this.moveTimer=new ig.Timer(0.001),this.mIconTimer=new ig.Timer(0.05),this.titleTimer=new ig.Timer(0.15)));this.moveTimer&&0<this.moveTimer.delta()&&(this.move+=0.3,this.moveTimer.reset());this.mIconTimer&&0<this.mIconTimer.delta()&&(12>this.mIconAnim?(this.mIconAnim++,this.moveTimer.reset()):this.mIconTimer=
null);this.titleTimer&&0<this.titleTimer.delta()&&(11>this.titleAnim?(this.titleAnim++,this.titleTimer.reset()):(this.titleTimer=null,this.nextLevelTimer=new ig.Timer(1)));this.nextLevelTimer&&0<this.nextLevelTimer.delta()&&(this.nextLevelTimer=null,ig.game.director.nextLevel(),ig.system.context.globalAlpha=1)},drawOriginalShieldOpening:function(){if(this.moveTimer){var c=ig.system.context;c.save();var b=ig.system.width/2,e=ig.system.height/2;c.translate(b,e);c.rotate(this.move*Math.PI/180);c.beginPath();
c.moveTo(0,0);for(var d=0,j=1;48>=j;j+=1)c.lineTo(0+800*Math.cos(2*j*Math.PI/48),0+800*Math.sin(2*j*Math.PI/48)),d++,2==d&&(d=0,c.lineTo(0,0));c.translate(-b,-e);b=c.createRadialGradient(b,e,100,b,e,250);b.addColorStop(0,"rgba(255,255,255,0.1)");b.addColorStop(1,"rgba(0,0,0,0)");c.fillStyle=b;c.fill();c.restore()}this.shieldImage.drawTile(ig.system.width/2-91,0-(768-ig.system.height)/2,this.shieldAnim,182,768);this.moveTimer&&(this.mIconImage.drawTile(ig.system.width/2-96,ig.system.height/2-70,this.mIconAnim,
166,160),this.titleImage.drawTile(ig.system.width/2-204,ig.system.height/2+100,this.titleAnim,409,76));ig.system.context.globalAlpha=1}})});ig.baked=!0;
ig.module("game.entities.opening-kitty").requires("impact.entity").defines(function(){EntityOpeningKitty=ig.Entity.extend({size:{x:48,y:48},kittyAnim:-1,kittyImage:new ig.Image("media/graphics/opening/kitty.png"),kittyTitleImage:new ig.Image("media/graphics/opening/kittytitle.png"),soundKey:"kittyopeningSound",init:function(c,b,e){this.parent(c,b,e)},ready:function(){ig.wm||(_SETTINGS.DeveloperBranding.Splash.Enabled?this.initTimer=new ig.Timer(0.1):(ig.game.director.nextLevel(),ig.system.context.globalAlpha=
1,this.kill()))},update:function(){this.parent();this.updateKittyOpening();this.unlockWebAudio()},unlockWebAudio:function(){if(ig.input.released("click"))try{ig.soundHandler.unlockWebAudio()}catch(c){}},draw:function(){this.parent();ig.global.wm||(this.nextLevelTimer&&0>this.nextLevelTimer.delta()&&(ig.system.context.globalAlpha=-this.nextLevelTimer.delta()),this.drawKittyOpening())},updateKittyOpening:function(){if(this.initTimer&&0<this.initTimer.delta()){this.initTimer=null;try{ig.soundHandler.sfxPlayer.play(this.soundKey)}catch(c){console.log(c)}this.kittyTimer=
new ig.Timer(0.15)}this.kittyTimer&&0<this.kittyTimer.delta()&&(7>this.kittyAnim?(this.kittyAnim++,this.kittyTimer.reset()):(this.kittyTimer=null,this.nextLevelTimer=new ig.Timer(2)));this.nextLevelTimer&&0<this.nextLevelTimer.delta()&&(this.nextLevelTimer=null,ig.game.director.nextLevel(),ig.system.context.globalAlpha=1)},drawKittyOpening:function(){var c=ig.system.context.createLinearGradient(0,0,0,ig.system.height);c.addColorStop(0,"#ffed94");c.addColorStop(1,"#ffcd85");ig.system.context.fillStyle=
c;ig.system.context.fillRect(0,0,ig.system.width,ig.system.height);0<=this.kittyAnim&&(this.kittyImage.drawTile((ig.system.width>>>1)-(this.kittyImage.width>>>3),(ig.system.height>>>1)-(this.kittyImage.height>>>2),this.kittyAnim,218,325),this.kittyTitleImage.drawTile((ig.system.width>>>1)-(this.kittyTitleImage.width>>>1),(ig.system.height>>>1)+(this.kittyImage.height>>>2)+10,this.kittyAnim,380,37));ig.system.context.globalAlpha=1}})});ig.baked=!0;
ig.module("game.entities.pointer").requires("impact.entity").defines(function(){EntityPointer=ig.Entity.extend({checkAgainst:ig.Entity.TYPE.BOTH,isFirstPressed:!1,isPressed:!1,isReleased:!1,isHovering:!1,hoveringItem:null,objectArray:[],clickedObjectList:[],ignorePause:!0,zIndex:5E3,name:"pointer",check:function(c){this.objectArray.push(c)},clickObject:function(c){this.isFirstPressed&&"function"==typeof c.clicked&&(c.clicked(),this.addToClickedObjectList(c));this.isPressed&&!this.isReleased&&"function"==
typeof c.clicking&&c.clicking();this.isReleased&&"function"==typeof c.released&&(c.released(),this.removeFromClickedObjectList(c))},refreshPos:function(){this.pos=ig.game.io.getClickPos()},update:function(){this.parent();this.refreshPos();var c=null,b=-1;for(a=this.objectArray.length-1;-1<a;a--)this.objectArray[a].zIndex>b&&(b=this.objectArray[a].zIndex,c=this.objectArray[a]);if(null!=c)null!=this.hoveringItem?this.hoveringItem!=c&&("function"==typeof this.hoveringItem.leave&&this.hoveringItem.leave(),
"function"==typeof c.over&&c.over()):"function"==typeof c.over&&c.over(),this.hoveringItem=this.lastEnt=c,this.clickObject(c),this.objectArray=[];else if(null!=this.hoveringItem&&"function"==typeof this.hoveringItem.leave&&(this.hoveringItem.leave(),this.hoveringItem=null),this.isReleased){for(c=0;c<this.clickedObjectList.length;c++)b=this.clickedObjectList[c],"function"==typeof b.releasedOutside&&b.releasedOutside();this.lastEnt&&(this.lastEnt.released&&this.lastEnt.released(),this.lastEnt=null);
this.clickedObjectList=[]}this.isFirstPressed=ig.input.pressed("click");this.isReleased=ig.input.released("click");this.isPressed=ig.input.state("click")},addToClickedObjectList:function(c){this.clickedObjectList.push(c)},removeFromClickedObjectList:function(c){for(var b=[],e=0;e<this.clickedObjectList.length;e++){var d=this.clickedObjectList[e];d!=c&&b.push(d)}this.clickedObjectList=b}})});ig.baked=!0;
ig.module("game.entities.pointer-selector").requires("game.entities.pointer").defines(function(){EntityPointerSelector=EntityPointer.extend({zIndex:1E3,_wmDrawBox:!0,_wmBoxColor:"rgba(0, 0, 255, 0.7)",size:{x:20,y:20},init:function(c,b,e){this.parent(c,b,e)}})});ig.baked=!0;
ig.module("game.entities.select").requires("impact.entity").defines(function(){EntitySelect=ig.Entity.extend({type:ig.Entity.TYPE.B,checkAgainst:ig.Entity.TYPE.A,collides:ig.Entity.COLLIDES.NEVER,canSelect:!1,canSelectTimerDuration:0.35,zIndex:99999,isHovering:!1,isSelected:!1,init:function(c,b,e){this.parent(c,b,e);this.canSelectTimer=new ig.Timer(this.canSelectTimerDuration)},doesClickableLayerExist:function(c){for(k in dynamicClickableEntityDivs)if(k==c)return!0;return!1},checkClickableLayer:function(c,
b,e){"undefined"==typeof wm&&(this.doesClickableLayerExist(c)?(ig.game.showOverlay([c]),$("#"+c).find("[href]").attr("href",b)):this.createClickableOutboundLayer(c,b,"media/graphics/misc/invisible.png",e))},createClickableOutboundLayer:function(c,b,e,d){var j=ig.$new("div");j.id=c;document.body.appendChild(j);$("#"+j.id).css("float","left");$("#"+j.id).css("width",this.size.x*multiplier);$("#"+j.id).css("height",this.size.y*multiplier);$("#"+j.id).css("position","absolute");var g=w/2-destW/2,p=h/
2-destH/2;w==mobileWidth?($("#"+j.id).css("left",this.pos.x),$("#"+j.id).css("top",this.pos.y)):($("#"+j.id).css("left",g+this.pos.x*multiplier),$("#"+j.id).css("top",p+this.pos.y*multiplier));d?$("#"+j.id).html("<a target='_blank' href='"+b+"'><img style='width:100%;height:100%' src='"+e+"'></a>"):$("#"+j.id).html("<a href='"+b+"'><img style='width:100%;height:100%' src='"+e+"'></a>");dynamicClickableEntityDivs[c]={};dynamicClickableEntityDivs[c].width=$("#"+j.id).width();dynamicClickableEntityDivs[c].height=
$("#"+j.id).height();dynamicClickableEntityDivs[c].entity_pos_x=this.pos.x;dynamicClickableEntityDivs[c].entity_pos_y=this.pos.y},hovered:function(){this.isHovering=!0;this.dehoverOthers()},dehoverOthers:function(){var c=ig.game.getEntitiesByType(EntitySelect);for(i=0;i<c.length;i++)c[i]!=this&&(c[i].isHovering=!1)},deselectOthers:function(){var c=ig.game.getEntitiesByType(EntitySelect);for(i=0;i<c.length;i++)c[i]!=this&&(c[i].isSelected=!1)},update:function(){this.parent();this.canSelectTimer&&0<
this.canSelectTimer.delta()&&(this.canSelect=!0,this.canSelectTimer=null)}})});ig.baked=!0;ig.module("game.levels.opening").requires("impact.image","game.entities.opening-kitty").defines(function(){LevelOpening={entities:[{type:"EntityOpeningKitty",x:520,y:212}],layer:[]}});ig.baked=!0;
ig.module("game.entities.buttons.button-start").requires("game.entities.buttons.button").defines(function(){EntityButtonStart=EntityButton.extend({oriColor:"rgba(255,255,0,1)",altColor:"rgba(255,0,0,1)",fillColor:"rgba(255,0,0,1)",textColor:"rgba(255,255,255,1)",size:new BABYLON.Vector2(64,66),text:"Start",init:function(c,b,e){this.parent(c,b,e);ig.responsive&&(this.anchorType="default")},update:function(){this.parent()},draw:function(){this.parent();var c=ig.system.context;c.fillStyle=this.fillColor;
c.fillRect(this.pos.x,this.pos.y,this.size.x,this.size.y);c.textAlign="center";c.fillStyle=this.textColor;c.fillText(this.text,this.pos.x+(this.size.y>>>1),this.pos.y+(this.size.y>>>1));c.textAlign="start"},clicked:function(){this.fillColor=this.altColor;wgl.game.reloadLevel();ig.game.director.jumpTo(LevelWebglGame)},clicking:function(){},released:function(){this.fillColor=this.oriColor}})});ig.baked=!0;
ig.module("game.entities.controllers.main-menu-controller").requires("impact.entity").defines(function(){EntityMainMenuController=ig.Entity.extend({zIndex:0,init:function(c,b,e){this.parent(c,b,e);ig.global.wm||wgl.game.reloadLevel()},update:function(){this.parent()},draw:function(){this.parent();ig.global.wm||ig.system.context.clearRect(0,0,ig.system.width,ig.system.height)}})});ig.baked=!0;
ig.module("game.levels.main-menu").requires("impact.image","game.entities.branding-logo-placeholder","game.entities.buttons.button-more-games","game.entities.pointer","game.entities.buttons.button-start","game.entities.controllers.main-menu-controller").defines(function(){LevelMainMenu={entities:[{type:"EntityMainMenuController",x:0,y:0},{type:"EntityBrandingLogoPlaceholder",x:190,y:700,settings:{div_layer_name:"layer_mainmenu",centralize:"true"}},{type:"EntityButtonMoreGames",x:320,y:300,settings:{div_layer_name:"layer_moregames_mainmenu"}},
{type:"EntityPointer",x:0,y:0},{type:"EntityButtonStart",x:160,y:300}],layer:[{name:"background",width:9,height:16,linkWithCollision:!1,visible:1,tilesetName:"media/graphics/backgrounds/desktop/background.jpg",repeat:!1,preRender:!0,distance:"1",tilesize:60,foreground:!1,data:[[2,3,4,5,6,7,8,9,10],[18,19,20,21,22,23,24,25,26],[34,35,36,37,38,39,40,41,42],[50,51,52,53,54,55,56,57,58],[66,67,68,69,70,71,72,73,74],[82,83,84,85,86,87,88,89,90],[98,99,100,101,102,103,104,105,106],[114,115,116,117,118,
119,120,121,122],[129,130,131,132,133,134,135,136,137],[1,2,3,4,5,6,7,8,9],[17,18,19,20,21,22,23,24,25],[33,34,35,36,37,38,39,40,41],[49,50,51,52,53,54,55,56,57],[65,66,67,68,69,70,71,72,73],[81,82,83,84,85,86,87,88,89],[97,98,99,100,101,102,103,104,105]]}]};LevelMainMenuResources=[new ig.Image("media/graphics/backgrounds/desktop/background.jpg")]});ig.baked=!0;
ig.module("game.entities.buttons.button-pause").requires("game.entities.buttons.button").defines(function(){EntityButtonPause=EntityButton.extend({oriColor:"rgba(255,255,0,1)",altColor:"rgba(255,0,0,1)",fillColor:"rgba(255,0,0,1)",textColor:"rgba(255,255,255,1)",ignorePause:!0,size:new BABYLON.Vector2(50,50),text:"Pause",init:function(c,b,e){this.parent(c,b,e);ig.responsive&&(this.anchorType="default")},update:function(){this.parent()},draw:function(){this.parent();var c=ig.system.context;c.fillStyle=
this.fillColor;c.fillRect(this.pos.x,this.pos.y,this.size.x,this.size.y);c.textAlign="center";c.fillStyle=this.textColor;c.fillText(this.text,this.pos.x+(this.size.y>>>1),this.pos.y+(this.size.y>>>1));c.textAlign="start"},clicked:function(){this.fillColor=this.altColor;console.log("clicked");ig.game.paused=!ig.game.paused;ig.game.paused?wgl.system.stopRender():wgl.system.startRender()},clicking:function(){},released:function(){this.fillColor=this.oriColor;console.log("released")}})});ig.baked=!0;
ig.module("plugins.io.virtual-joystick").defines(function(){VirtualJoystick=ig.Class.extend({pos:new BABYLON.Vector2(0,0),start:new BABYLON.Vector2(0,0),last:new BABYLON.Vector2(0,0),deltaPos:new BABYLON.Vector3(0,0,0),deltaVector:new BABYLON.Vector2(0,0),axis:{x:0,y:1,z:2},reverseDirections:[!1,!1],rotationspeed:25,inverseRotationspeed:25,sensibility:25,inversedSensibility:25,deltaPosition:new BABYLON.Vector3.Zero,touches:[],rotateOnAxisRelativeToMesh:!1,pressed:!1,color:"cyan",pointerID:-1,axisTarget:{leftright:0,
updown:1},identifier:null,drawVirtualStick:!1,camera:null,pressed:!1,init:function(c){this.camera=c;this.deltaPos=new BABYLON.Vector3.Zero;this.inversedSensibility=1/(this.sensibility/1E3);this.inverseRotationspeed=1/(this.rotationspeed/1E3);this.axisTarget.leftright=this.axis.x;this.axisTarget.updown=this.axis.y;this.rotateOnAxisRelativeToMesh=!1},initialPos:function(c){null!==this.identifier?this.identifier===c.identifier&&(this.drawVirtualStick=!0,this.start=new BABYLON.Vector2(c.x+0,c.y+0),this.pos=
this.start.clone(),this.last=this.start.clone(),this.deltaVector.x=0,this.deltaVector.y=0,this.pressed=!0):(this.drawVirtualStick=!0,this.identifier=c.identifier,this.start=new BABYLON.Vector2(c.x+0,c.y+0),this.pos=this.start.clone(),this.last=this.start.clone(),this.deltaVector.x=0,this.deltaVector.y=0,this.pressed=!0)},updatePos:function(c){if(c.identifier===this.identifier){this.pos.x=c.x;this.pos.y=c.y;this.deltaVector=this.pos.clone();this.deltaVector=this.deltaVector.subtract(this.start);c=
(this.reverseDirections[1]?-1:1)*this.deltaVector.x/this.inversedSensibility;switch(this.axisTarget.leftright){case this.axis.x:this.deltaPos.x=Math.min(1,Math.max(-1,c));break;case this.axis.y:this.deltaPos.y=Math.min(1,Math.max(-1,c));break;case this.axis.z:this.deltaPos.z=Math.min(1,Math.max(-1,c))}c=(this.reverseDirections[0]?1:-1)*this.deltaVector.y/this.inversedSensibility;switch(this.axisTarget.updown){case this.axis.x:this.deltaPos.x=Math.min(1,Math.max(-1,c));break;case this.axis.y:this.deltaPos.y=
Math.min(1,Math.max(-1,c));break;case this.axis.z:this.deltaPos.z=Math.min(1,Math.max(-1,c))}}this.action()},release:function(c,b){"undefined"!==typeof b?b&&(this.drawVirtualStick=!1,this.deltaVector.x=0,this.deltaVector.y=0,this.identifier=null,this.pressed=!1):c.identifier===this.identifier&&(this.drawVirtualStick=!1,this.deltaVector.x=0,this.deltaVector.y=0,this.identifier=null,this.pressed=!1)},action:function(){},debugText:function(c,b){var e=ig.system.context;e.fillStyle="rgba(255,255,0,1)";
e.fillText(":"+this.deltaVector.x+" , "+this.deltaVector.y,c,b);e.fillText(":"+this.deltaPos.x+" , "+this.deltaPos.y+" , "+this.deltaPos.z,c,b+30)},draw:function(){var c=ig.system.context;this.drawVirtualStick&&(c.beginPath(),c.lineWidth=6,c.strokeStyle=this.color,c.arc(this.start.x,this.start.y,40,0,2*Math.PI,!0),c.stroke(),c.closePath(),c.beginPath(),c.strokeStyle=this.color,c.lineWidth=2,c.arc(this.start.x,this.start.y,60,0,2*Math.PI,!0),c.stroke(),c.closePath(),c.beginPath(),c.strokeStyle=this.color,
c.arc(this.pos.x,this.pos.y,40,0,2*Math.PI,!0),c.stroke(),c.closePath())},setSensibility:function(c){this.sensibility=c;this.inversedSensibility=1/(this.sensibility/1E3)}})});ig.baked=!0;
ig.module("plugins.handlers.webgl-virtual-joystick-handler").requires("plugins.io.virtual-joystick").defines(function(){ig.WebglVirtualJoystickHandler=ig.Class.extend({leftJoystick:null,rightJoystick:null,camera:null,init:function(c){this.camera=c;this.setupLeftJoystick();this.setupRightJoystick()},setupLeftJoystick:function(){this.leftJoystick=new VirtualJoystick(this.camera);this.leftJoystick.color="yellow";this.leftJoystick.axisTarget.updown=this.leftJoystick.axis.z;this.leftJoystick.axisTarget.leftright=
this.leftJoystick.axis.x;this.leftJoystick.setSensibility(0.15);this.leftJoystick.action=function(){var c=this.camera,b=50*c._computeLocalCameraSpeed(),e=BABYLON.Matrix.RotationYawPitchRoll(c.rotation.y,c.rotation.x,0),b=BABYLON.Vector3.TransformCoordinates(new BABYLON.Vector3(this.deltaPos.x*b,this.deltaPos.y*b,this.deltaPos.z*b),e);c.cameraDirection=c.cameraDirection.add(b);this.pressed||(this.deltaPos=this.deltaPos.scale(0.9))}.bind(this.leftJoystick)},setupRightJoystick:function(){this.rightJoystick=
new VirtualJoystick(this.camera);this.rightJoystick.color="cyan";this.rightJoystick.axisTarget.updown=this.rightJoystick.axis.x;this.rightJoystick.axisTarget.leftright=this.rightJoystick.axis.y;this.rightJoystick.reverseDirections[0]=!0;this.rightJoystick.setSensibility(0.05);this.rightJoystick.action=function(){var c=this.camera;c.cameraRotation=c.cameraRotation.addVector3(this.deltaPos);this.pressed||(this.deltaPos=this.deltaPos.scale(0.9))}.bind(this.rightJoystick)},update:function(){this.resolveLeftRight(ig.multitouchInput.pressed,
this.leftJoystick.initialPos.bind(this.leftJoystick),this.rightJoystick.initialPos.bind(this.rightJoystick));this.resolveLeftRight(ig.multitouchInput.state,this.leftJoystick.updatePos.bind(this.leftJoystick),this.rightJoystick.updatePos.bind(this.rightJoystick));this.resolveLeftRight(ig.multitouchInput.released,this.leftJoystick.release.bind(this.leftJoystick),this.rightJoystick.release.bind(this.rightJoystick));var c=ig.multitouchInput.released.length;if(0>=c+ig.multitouchInput.state.length+ig.multitouchInput.pressed.length)this.leftJoystick.release(null,
!0),this.rightJoystick.release(null,!0);else if(0<c)for(c=0;c<ig.multitouchInput.released.length;c++){var b=ig.multitouchInput.released[c];this.leftJoystick.release(b);this.rightJoystick.release(b)}},resolveLeftRight:function(c,b,e){for(var d=0;d<c.length;d++){var j=c[d];j.x>ig.system.width>>>1?e(j):b(j)}},draw:function(){var c=ig.system.context;this.leftJoystick.draw();this.rightJoystick.draw();if(wgl.debug.debug){this.leftJoystick.debugText(20,100);c.fillText(ig.multitouchInput.pressed.length+";"+
ig.multitouchInput.state.length+";"+ig.multitouchInput.released.length,20,200);for(var b=0;b<ig.multitouchInput.pressed.length;b++){var e=ig.multitouchInput.pressed[b].x,d=ig.multitouchInput.pressed[b].y,j=ig.multitouchInput.pressed[b].identifier;c.fillText(j+";"+e+";"+d,20,250+50*b)}for(b=0;b<ig.multitouchInput.state.length;b++)e=ig.multitouchInput.state[b].x,d=ig.multitouchInput.state[b].y,j=ig.multitouchInput.state[b].identifier,c.fillText(j+";"+e+";"+d,100,250+50*b);for(b=0;b<ig.multitouchInput.released.length;b++)e=
ig.multitouchInput.released[b].x,d=ig.multitouchInput.released[b].y,j=ig.multitouchInput.released[b].identifier,c.fillText(j+";"+e+";"+d,180,250+50*b)}}})});ig.baked=!0;
ig.module("plugins.handlers.webgl-mouse-handler").defines(function(){ig.WebglMouseHandler=ig.Class.extend({camera:null,angularSensibility:2E3,init:function(c){this.camera=c},update:function(){ig.input.pressed("click")&&ig.game.io.getClickPos();if(ig.input.state("click")){var c=ig.game.io.getLastClickPos(),b=ig.game.io.getClickPos(),e=b.y-c.y;this.camera.cameraRotation.y+=(b.x-c.x)/this.angularSensibility;this.camera.cameraRotation.x+=e/this.angularSensibility}},draw:function(){}})});ig.baked=!0;
ig.module("game.entities.webgl.webgl-control-game").requires("impact.entity","game.entities.buttons.button-pause","game.entities.pointer","plugins.handlers.webgl-virtual-joystick-handler","plugins.handlers.webgl-mouse-handler").defines(function(){EntityWebglControlGame=ig.Entity.extend({alpha:0,dAlpha:0.05,size:{x:10,y:10},pos:{x:0,y:0},name:"webgl control game",control:null,laserSpawner:null,camera:null,menuButton:null,pointer:null,ignorePause:!0,hitTimer:null,scoreTimer:null,levelTimer:null,lifebar:15,
levelTime:120,collidedWithLaserBeam:!1,lifebarColors:{healthy:"rgba(0,200,0,0.8)"},collidedColor:"rgba(255,0,0,0.5)",metricColor:"rgba(0,255,255,0.8)",metricText:{time:"Time left:",score:"Score:"},init:function(c,b,e){this.parent(c,b,e);ig.global.wm||(this.metricText.time=_STRINGS.Game.metricTimeLeft,this.metricText.score=_STRINGS.Game.metricScore,this.scoreTimer=new ig.Timer,this.levelTimer=new ig.Timer,this.pauseButton=ig.game.spawnEntity(EntityButtonPause,20,20),this.pointer=ig.game.spawnEntity(EntityPointer,
0,0))},update:function(){this.parent();if(!1!==wgl.game.ready)if(null===this.camera)this.camera=wgl.game.getEntityByName("Camera")[0];else if(null===this.laserSpawner)this.laserSpawner=wgl.game.getEntityByName("LaserSpawner")[0];else if(null===this.control)ig.ua.touchDevice?wgl.game.currentScene&&(this.control=new ig.WebglVirtualJoystickHandler(wgl.game.currentScene.activeCamera)):wgl.game.currentScene&&(this.control=new ig.WebglMouseHandler(wgl.game.currentScene.activeCamera),this.control.angularSensibility=
500);else if(ig.game.paused)this.levelTimer.pause(),this.scoreTimer.pause();else if(this.levelTimer.unpause(),this.scoreTimer.unpause(),0>=this.lifebar)this.endGame();else{this.control.update();if(this.levelTimer)if(2<this.levelTimer.delta())this.laserSpawner&&this.laserSpawner.start();else if(this.levelTimer.delta()>this.levelTime)return;this.scoreTimer&&0.1<this.scoreTimer.delta()&&(ig.game.score+=1,this.scoreTimer.reset());if(this.hitTimer)0.5<this.hitTimer.delta()&&(this.hitTimer=null,this.collidedWithLaserBeam=
!1);else if(this.laserSpawner)for(var c=0;c<this.laserSpawner.laserArray.length;c++){var b=this.laserSpawner.laserArray[c];if(b.meshes[0]&&(this.collidedWithLaserBeam=b.meshes[0].intersectsMesh(this.camera.hitbox,!0))){this.lifebar-=5;this.hitTimer=new ig.Timer;break}}}},endGame:function(){this.camera.camera.detachControl(window);this.gameover=!0;ig.game.director.jumpTo(LevelEnd)},miss:function(){this.alpha+=this.dAlpha;0.01>this.alpha?(wgl.game.miss=!1,this.dAlpha=0.05,this.alpha=0.02):0.5<this.alpha&&
(this.dAlpha=-0.05)},draw:function(){this.parent();if(!ig.global.wm){var c=ig.system.context;c.clearRect(0,0,ig.system.width,ig.system.height);this.drawLifebar(c);this.drawCollision(c);this.drawMetric(c);this.control&&this.control.draw()}},drawMetric:function(c){c.fillStyle=this.metricColor;c.textAlign="center";c.fillText(this.metricText.score+ig.game.score,ig.system.width>>>1,50);c.fillText("Survive as long as possible",ig.system.width>>>1,70);c.textAlign="start"},drawCollision:function(c){this.collidedWithLaserBeam&&
(c=ig.system.context,c.fillStyle=this.collidedColor,c.fillRect(0,0,ig.system.width,ig.system.height))},drawLifebar:function(c){0>this.lifebar&&(this.lifebar=0);c.fillStyle=this.lifebarColors.healthy;c.fillRect((ig.system.width>>>1)-(this.lifebar>>>1),20,this.lifebar,10)}})});ig.baked=!0;ig.module("game.levels.webgl-game").requires("impact.image","game.entities.webgl.webgl-control-game").defines(function(){LevelWebglGame={entities:[{type:"EntityWebglControlGame",x:0,y:0}],layer:[]}});ig.baked=!0;
ig.module("game.entities.controllers.level-end-controller").requires("impact.entity").defines(function(){EntityLevelEndController=ig.Entity.extend({size:{x:40,y:40},pos:{x:1,y:1},name:"LevelEndController",endText:"Thank you for playing",fontSetting:"Arial 20px",endColor:"rgba(255,255,255,1)",init:function(c,b,e){this.parent(c,b,e);c=ig.game.score;null===ig.game.scorelist?ig.game.scorelist=new BinaryHeap(function(b){return b.val},!0):3>ig.game.scorelist.size()||ig.game.scorelist.content.pop();ig.game.scorelist.push({val:c})},
update:function(){this.parent()},draw:function(){this.parent();ig.global.wm||(ig.system.context.clearRect(0,0,ig.system.width,ig.system.height),this.drawEnd(ig.system.context))},drawEnd:function(c){var b=c.font+"";c.font=this.fontSetting;c.fillStyle=this.endColor;c.textAlign="center";var e=ig.system.width>>>1,d=ig.system.height>>>1;c.fillText("High Score Board",e,d-(d>>>1)-20);for(var j=0;j<ig.game.scorelist.size();j++)c.fillText(ig.game.scorelist.content[j].val,e,d-(d>>>1)+20*j);c.fillText(this.endText,
e,d);c.fillText(ig.game.score,e,d+20);c.textAlign="start";c.font=b}})});ig.baked=!0;
ig.module("game.entities.buttons.button-retry").requires("game.entities.buttons.button").defines(function(){EntityButtonRetry=EntityButton.extend({fillColor:"rgba(255,255,0,1)",altColor:"rgba(255,255,0,1)",textColor:"rgba(255,255,255,1)",size:new BABYLON.Vector2(50,50),text:"Retry",init:function(c,b,e){this.parent(c,b,e);ig.responsive&&(this.anchorType="default")},update:function(){this.parent()},draw:function(){this.parent();var c=ig.system.context;c.fillStyle=this.fillColor;c.fillRect(this.pos.x,
this.pos.y,this.size.x,this.size.y);c.textAlign="center";c.fillStyle=this.textColor;c.fillText(this.text,this.pos.x+(this.size.y>>>1),this.pos.y+(this.size.y>>>1));c.textAlign="start"},clicked:function(){this.fillColor=this.altColor;ig.game.score=0;console.log("clicked");wgl.game.reloadLevel();ig.game.director.jumpTo(LevelWebglGame)},clicking:function(){},released:function(){this.fillColor=this.oriColor;console.log("released")}})});ig.baked=!0;
ig.module("game.levels.end").requires("impact.image","game.entities.controllers.level-end-controller","game.entities.pointer","game.entities.buttons.button-retry").defines(function(){LevelEnd={entities:[{type:"EntityLevelEndController",x:0,y:0},{type:"EntityPointer",x:316,y:80},{type:"EntityButtonRetry",x:245,y:296}],layer:[]}});ig.baked=!0;
ig.module("babylon.plugins.wgl-game").defines(function(){wgl.Game=ig.Class.extend({entities:[],ready:!1,init:function(){},update:function(){this.entitiesIndexToKill=[];for(var c=0;c<this.entities.length;c++)this.entities[c]&&(this.entities[c].update(),this.entities[c]._killed&&this.entitiesIndexToKill.push(c));for(c=this.entitiesIndexToKill.length-1;0<=c;c--)this.entities.splice(this.entitiesIndexToKill[c],1)},render:function(){this.currentScene&&this.currentScene.render()},spawnEntity:function(c,
b,e,d,j){c=new c(b,e,d,j);this.entities.push(c);return c},getEntityByName:function(c){for(var b=[],e=0;e<this.entities.length;e++)console.log(this.entities[e].name),this.entities[e].name===c&&b.push(this.entities[e]);return b},getMeshByName:function(c){for(var b=0;b<this.currentScene.meshes.length;b++)if(this.currentScene.meshes[b].name===c)return this.currentScene.meshes[b];return null},resizeAll:function(){for(var c=0;c<this.entities.length;c++)this.entities[c].resize()}})});ig.baked=!0;
ig.module("babylon.plugins.wgl-timer").defines(function(){wgl.Timer=ig.Class.extend({target:0,base:0,last:0,pausedAt:0,init:function(c){this.last=this.base=wgl.Timer.time;this.target=c||0},set:function(c){this.target=c||0;this.base=wgl.Timer.time;this.pausedAt=0},reset:function(){this.base=wgl.Timer.time;this.pausedAt=0},tick:function(){var c=wgl.Timer.time-this.last;this.last=wgl.Timer.time;return this.pausedAt?0:c},delta:function(){return(this.pausedAt||wgl.Timer.time)-this.base-this.target},pause:function(){this.pausedAt||
(this.pausedAt=wgl.Timer.time)},unpause:function(){this.pausedAt&&(this.base+=wgl.Timer.time-this.pausedAt,this.pausedAt=0)}});wgl.Timer._last=0;wgl.Timer.time=Number.MIN_VALUE;wgl.Timer.timeScale=1;wgl.Timer.maxStep=0.05;wgl.Timer.step=function(){var c=Date.now();wgl.Timer.time+=Math.min((c-wgl.Timer._last)/1E3,wgl.Timer.maxStep)*wgl.Timer.timeScale;wgl.Timer._last=c}});ig.baked=!0;
ig.module("babylon.plugins.wgl-system").requires("babylon.plugins.wgl-timer").defines(function(){wgl.System=ig.Class.extend({fps:null,tick:0,loader:null,assets:{},canvas:null,engine:null,progress:0,babylonJSSupport:!1,finishLoadFunctions:[],finishSceneReadyFunctions:[],tempNewScene:null,canvas:null,started:!1,init:function(c,b){this.fps=b;this.canvas=ig.$(c);if(BABYLON.Engine.isSupported())this.engine=new BABYLON.Engine(this.canvas,!1),this.babylonJSSupport=!0;else throw"BabylonJS not supported";
},loadScene:function(c,b){wgl.game.ready=!1;if(this.babylonJSSupport)BABYLON.SceneLoader.Load(c,b,this.engine,this.onLoadSuccess.bind(this),this.progressCallback.bind(this),this.onLoadError.bind(this));else throw"Unable to load scene because BabylonJS is not supported";},progressCallback:function(c){this.progress=c;console.log("Progress:",c.loaded,"out of: "+c.total)},onLoadSuccess:function(c){console.log("load scene success");wgl.game.currentScene&&wgl.game.currentScene.dispose();wgl.game.currentScene=
c;for(c=0;c<this.finishLoadFunctions.length;c++)this.finishLoadFunctions[c]();this.loader=new BABYLON.AssetsManager(wgl.game.currentScene);wgl.game.currentScene.executeWhenReady(this.onSceneReady.bind(this))},onLoadError:function(c){console.log("ERROR:");console.log(c)},onSceneReady:function(){wgl.debug.debug&&wgl.debug.enableDebug();this.loadCameras();this.loadMeshes();this.registerBeforeRender();for(var c=0;c<this.finishSceneReadyFunctions.length;c++)this.finishSceneReadyFunctions[c]();wgl.system.engine.hideLoadingUI();
wgl.game.ready=!0},registerBeforeRender:function(){wgl.game.currentScene.registerBeforeRender(this.advanceTime.bind(this));wgl.game.currentScene.registerBeforeRender(wgl.game.update.bind(wgl.game));this.startRender()},startRender:function(){this.engine.runRenderLoop(wgl.game.render.bind(wgl.game))},stopRender:function(){this.engine.stopRenderLoop()},unregisterBeforeRender:function(){wgl.game.currentScene&&(wgl.game.currentScene.unregisterBeforeRender(this.advanceTime.bind(this)),wgl.game.currentScene.unregisterBeforeRender(wgl.game.update.bind(wgl.game)),
wgl.game.currentScene.onBeforeRenderObservable.clear(),this.stopRender())},loadMeshes:function(){for(var c=wgl.game.currentScene.meshes,b=0;b<c.length;b++){var e=c[b].name.split(":");if(1<e.length){c[b].id=e[0];c[b].name=e[0];for(var d="",e=e[1].split("."),e=e[0].split("-"),j=0;j<e.length;j++)var g=""+e[j],g=g.charAt(0).toUpperCase()+g.slice(1),d=d+g;0<d.length&&wgl.game.entities.push(new wgl.modules[d](c[b].position.x,c[b].position.y,c[b].position.z,{_mesh:c[b]}))}}},loadCameras:function(){for(var c=
wgl.game.currentScene.cameras,b=0;b<c.length;b++){var e=c[b].name.split(":");if(1<e.length){c[b].id=e[0];c[b].name=e[0];for(var d="",e=e[1].split("."),e=e[0].split("-"),j=0;j<e.length;j++)var g=""+e[j],g=g.charAt(0).toUpperCase()+g.slice(1),d=d+g;wgl.game.entities.push(new wgl.modules[d](c[b].position.x,c[b].position.y,c[b].position.z,{_camera:c[b]}))}}},advanceTime:function(){wgl.Timer.step();this.tick=this.engine.getDeltaTime()}})});ig.baked=!0;
ig.module("babylon.plugins.wgl-debug").defines(function(){wgl.Debug=ig.Class.extend({debug:!1,init:function(){},enableDebug:function(){wgl.game.currentScene.debugLayer.show()},axis2:function(c,b){var e=BABYLON.Mesh.CreateCylinder("x",b,0.1,0.1,6,4,c,!1);e.material=new BABYLON.StandardMaterial("xColor",c);e.material.diffuseColor=new BABYLON.Color3(1,0,0);e.position=new BABYLON.Vector3(b/2,0,0);e.rotation.z=Math.PI>>>1;e=BABYLON.Mesh.CreateCylinder("y",b,0.1,0.1,6,4,c,!1);e.material=new BABYLON.StandardMaterial("yColor",
c);e.material.diffuseColor=new BABYLON.Color3(0,1,0);e.position=new BABYLON.Vector3(0,b/2,0);e=BABYLON.Mesh.CreateCylinder("z",b,0.1,0.1,6,4,c,!1);e.material=new BABYLON.StandardMaterial("zColor",c);e.material.diffuseColor=new BABYLON.Color3(0,0,1);e.position=new BABYLON.Vector3(0,0,b/2);e.rotation.x=Math.PI>>>1}})});ig.baked=!0;
ig.module("babylon.plugins.wgl-entity").defines(function(){wgl.Entity=ig.Class.extend({pos:null,vel:null,acc:null,meshes:[],_killed:!1,init:function(c,b,e,d){ig.merge(this,d);this.pos=new BABYLON.Vector3(0,0,0);this.vel=new BABYLON.Vector3(0,0,0);this.acc=new BABYLON.Vector3(0,0,0);d&&d._mesh&&this.meshes.push(d._mesh);isNaN(c)||(this.pos.x=c);isNaN(b)||(this.pos.y=b);isNaN(e)||(this.pos.z=e)},update:function(){},render:function(){},kill:function(){for(var c=0;c<this.meshes.length;c++){var b=this.meshes[c];
wgl.game.currentScene.stopAnimation(b);b.dispose();this.meshes.splice(c,1);c--}this._killed=!0},reset:function(){},resize:function(){}})});ig.baked=!0;
ig.module("babylon.entities.game-camera").requires("babylon.plugins.wgl-entity").defines(function(){wgl.modules.GameCamera=wgl.Entity.extend({camera:null,controlEnabled:!1,name:"Camera",cameraCounter:null,addedDebugDraw:!1,hitbox:null,MOVEKEYS:{UP:1,DOWN:2,LEFT:3,RIGHT:4},init:function(c,b,e,d){this.parent(c,b,e,d);ig.merge(this,d);d._camera&&(this.camera=d._camera,wgl.game.camera=this.camera);ig.ua.touchDevice?(b=wgl.game.currentScene,c=b.activeCamera,b.activeCamera=c,c.attachControl(window),c.ellipsoid=
new BABYLON.Vector3(2,2,2),wgl.game.currentScene.collisionsEnabled=!0,c.checkCollisions=!0,b=wgl.game.getMeshByName("LaserSpawner:laser-spawner.js"),b.checkCollisions=!0,this.camera=c):(b=wgl.game.currentScene,c=b.activeCamera,wgl.system.engine.getRenderingCanvas(),b=b._inputManager,c.attachControl(window),window.addEventListener("keydown",b._onKeyDown,!1),window.addEventListener("keyup",b._onKeyUp,!1),c.ellipsoid=new BABYLON.Vector3(2,2,2),wgl.game.currentScene.collisionsEnabled=!0,c.checkCollisions=
!0,b=wgl.game.getMeshByName("LaserSpawner:laser-spawner.js"),b.checkCollisions=!0,this.camera=c,this.camera.keysUp.push(ig.KEY.W),this.camera.keysDown.push(ig.KEY.S),this.camera.keysLeft.push(ig.KEY.A));this.camera.keysRight.push(ig.KEY.D);this.camera.fov=1.1;this.camera.minZ=0.1;this.camera.maxZ=1E3;this.camera.angularSensibility=2E3;this.camera.inertia=0.8;this.camera.speed=4;this.setupHitbox()},setupHitbox:function(){this.hitbox=BABYLON.Mesh.CreateBox("box",10,wgl.game.currentScene);this.hitbox.parent=
this.camera},update:function(){this.parent();if(wgl.debug.debug){if(!this.addedDebugDraw){var c=function(){ig.system.context.fillText("FOV:"+this.camera.fov+" minZ: "+this.camera.minZ+" maxZ: "+this.camera.maxZ+" innertia: "+this.camera.inertia+" fovMode: "+this.camera.fovMode+" speed: "+this.camera.speed+" angularSensibility: "+this.camera.angularSensibility,20,100)}.bind(this);ig.game.lastDraw.push(c)}this.addedDebugDraw=!0}},kill:function(){this.parent();var c=wgl.game.currentScene._inputManager;
window.removeEventListener("keydown",c._onKeyDown,!1);window.removeEventListener("keyup",c._onKeyUp,!1);this.hitbox.dispose();this.camera.dispose()}})});ig.baked=!0;
ig.module("babylon.entities.laser").requires("babylon.plugins.wgl-entity").defines(function(){wgl.modules.Laser=wgl.Entity.extend({lifeTimer:null,lifeTime:10,indexID:null,deltaRotation:new BABYLON.Vector3.Zero,laserMaterial:null,array:null,init:function(c,b,e,d){this.parent(c,b,e,d);this.lifeTimer=new ig.Timer;this.meshes.push(BABYLON.MeshBuilder.CreatePlane("pl",{width:2,height:50},wgl.game.currentScene));this.meshes[0].position=new BABYLON.Vector3.Zero;this.laserMaterial=new BABYLON.StandardMaterial("texture1",
wgl.game.currentScene);this.laserMaterial.emissiveColor=new BABYLON.Color3(1,0.2,0.7);this.laserMaterial.backFaceCulling=!1;this.meshes[0].material=this.laserMaterial;this.meshes[0].position=this.pos;d.indexID&&(this.indexID=d.indexID);d.array&&(this.array=d.array);c=1*Math.random();this.deltaRotation.x=0.5>c?10*Math.random():-10*Math.random();c=1*Math.random();this.deltaRotation.y=0.5>c?10*Math.random():-10*Math.random();c=1*Math.random();this.deltaRotation.z=0.5>c?10*Math.random():-10*Math.random()},
update:function(){this.parent();this.lifeTimer&&this.lifeTimer.delta()>this.lifeTime?this.kill():(this.meshes[0].rotation.x+=this.deltaRotation.x*ig.system.tick,this.meshes[0].rotation.y+=this.deltaRotation.y*ig.system.tick,this.meshes[0].rotation.z+=this.deltaRotation.z*ig.system.tick)},kill:function(){this.parent();this.array.splice(this.indexID,1)}})});ig.baked=!0;
ig.module("babylon.entities.laser-spawner").requires("babylon.plugins.wgl-entity","babylon.entities.laser").defines(function(){wgl.modules.LaserSpawner=wgl.Entity.extend({laserArray:[],laserLength:50,laserPattern:null,laserTimer:null,spawnTime:3,spawnLimit:3,name:"LaserSpawner",startSpawn:!1,init:function(c,b,e,d){this.parent(c,b,e,d);this.laserTimer=new ig.Timer},update:function(){this.parent();this.laserTimer&&(this.startSpawn||this.laserTimer.reset(),this.laserTimer.delta()>this.spawnTime&&this.laserArray.length<
this.spawnLimit&&(this.spawnLaser(),this.laserTimer.reset()))},start:function(){this.startSpawn=!0},spawnLaser:function(){this.laserArray.push(wgl.game.spawnEntity(wgl.modules.Laser,0,0,0,{indexID:this.laserArray.length,array:this.laserArray}))},kill:function(){this.parent()}})});ig.baked=!0;
ig.module("babylon.game.wgl-main").requires("babylon.plugins.wgl-game","babylon.plugins.wgl-system","babylon.plugins.wgl-debug","babylon.plugins.wgl-game","babylon.entities.game-camera","babylon.entities.laser-spawner","babylon.entities.laser").defines(function(){MyWGLGame=wgl.Game.extend({gameover:!1,score:0,debug:!1,levels:{game:"game3.babylon"},root:"media/scenes/",init:function(){},reloadLevel:function(){for(wgl.system.unregisterBeforeRender();0<this.entities.length;)this.entities.pop();this.gameover=
!1;wgl.system.loadScene(this.root,this.levels.game)}});wgl.webglmain=function(c,b){wgl.debug=new wgl.Debug;wgl.system=new wgl.System(c,b);wgl.game=new MyWGLGame}});ig.baked=!0;
ig.module("plugins.fullscreen").requires("impact.entity","plugins.handlers.size-handler","plugins.director").defines(function(){ig.Fullscreen={enableFullscreenButton:!0,_isEnabled:"notChecked",isEnabled:function(){"notChecked"==this._isEnabled&&(this._isEnabled=document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled?!0:!1);return this._isEnabled},isFullscreen:function(){return ig.Fullscreen.isEnabled()&&(document.fullscreenElement||
document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)?!0:!1},toggleFullscreen:function(){ig.Fullscreen.isFullscreen()?ig.Fullscreen.exitFullscreen():ig.Fullscreen.requestFullscreen();ig.sizeHandler.orientationDelayHandler();if(ig&&ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(c){}},requestFullscreen:function(){var c=document.documentElement;c.requestFullscreen?c.requestFullscreen():c.webkitRequestFullscreen?
c.webkitRequestFullscreen():c.mozRequestFullScreen?c.mozRequestFullScreen():c.msRequestFullscreen?c.msRequestFullscreen():console.log("no request fullscreen method available")},exitFullscreen:function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():console.log("no exit fullscreen method available")},divs:{}};ig.Director.inject({loadLevel:function(c){var b=
ig.Fullscreen.divs,e;for(e in b)b=ig.domHandler.getElementById("#"+e),ig.domHandler.hide(b);return this.parent(c)}});ig.SizeHandler.inject({resize:function(){this.parent();var c=ig.Fullscreen.divs,b;for(b in c){var e=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y),d=ig.domHandler.getElementById("#"+b),j=c[b].entity_pos_x,g=c[b].entity_pos_y,p=c[b].width,m=c[b].height,f=ig.domHandler.getElementById("#canvas"),f=ig.domHandler.getOffsets(f);ig.domHandler.css(d,{"float":"left",
position:"absolute",left:Math.floor(f.left+j*e)+"px",top:Math.floor(f.top+g*e)+"px",width:Math.floor(p*e)+"px",height:Math.floor(m*e)+"px","z-index":3})}}});ig.FullscreenButton=ig.Entity.extend({enterImage:null,exitImage:null,isReady:!1,zIndex:999999,identifier:null,prevPos:{x:0,y:0},invisImagePath:"media/graphics/misc/invisible.png",init:function(c,b,e){this.parent(c,b,e);ig.Fullscreen.isEnabled()&&ig.Fullscreen.enableFullscreenButton?this.enterImage.loaded?this.initSize():this.enterImage.loadCallback=
function(){this.initSize()}.bind(this):this.kill()},kill:function(){this.parent()},destroy:function(){this.parent();console.log("destroy")},initSize:function(){this.size.x=this.enterImage.width;this.size.y=this.enterImage.height;this.createClickableLayer();this.isReady=!0},createClickableLayer:function(){this.identifier="fullscreen-button-layer";var c=ig.domHandler.getElementById("#"+this.identifier);c?(ig.domHandler.show(c),ig.domHandler.attr(c,"onclick","ig.Fullscreen.toggleFullscreen()")):this.createClickableOutboundLayer()},
update:function(c,b){this.parent();c=this.pos.x;b=this.pos.y;this.isReady&&!(this.prevPos.x==c&&this.prevPos.y==b)&&(console.log(c,b),this.prevPos.x=c,this.prevPos.y=b,ig.Fullscreen.divs[this.identifier]={},ig.Fullscreen.divs[this.identifier].width=this.size.x,ig.Fullscreen.divs[this.identifier].height=this.size.y,ig.Fullscreen.divs[this.identifier].entity_pos_x=this.pos.x,ig.Fullscreen.divs[this.identifier].entity_pos_y=this.pos.y,ig.sizeHandler.resize())},draw:function(){this.isReady&&(ig.Fullscreen.isFullscreen()?
this.exitImage.draw(this.pos.x,this.pos.y):this.enterImage.draw(this.pos.x,this.pos.y))},createClickableOutboundLayer:function(){var c=this.identifier,b=this.invisImagePath,e=ig.domHandler.create("div");ig.domHandler.attr(e,"id",c);ig.domHandler.attr(e,"onclick","ig.Fullscreen.toggleFullscreen()");var d=ig.domHandler.create("a"),j=ig.domHandler.create("img");ig.domHandler.css(j,{width:"100%",height:"100%"});ig.domHandler.attr(j,"src",b);b=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);
if(ig.ua.mobile){var g=ig.domHandler.getElementById("#canvas"),g=ig.domHandler.getOffsets(g),p=g.left,m=g.top;console.log(g.left);ig.sizeHandler.disableStretchToFitOnMobileFlag?(g=Math.floor(p+this.pos.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px",m=Math.floor(m+this.pos.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px",p=Math.floor(this.size.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px",b=Math.floor(this.size.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px"):(g=Math.floor(this.pos.x*ig.sizeHandler.sizeRatio.x)+
"px",m=Math.floor(this.pos.y*ig.sizeHandler.sizeRatio.y)+"px",p=Math.floor(this.size.x*ig.sizeHandler.sizeRatio.x)+"px",b=Math.floor(this.size.y*ig.sizeHandler.sizeRatio.y)+"px")}else g=ig.domHandler.getElementById("#canvas"),g=ig.domHandler.getOffsets(g),p=g.left,m=g.top,ig.sizeHandler.enableStretchToFitOnDesktopFlag?(g=Math.floor(p+this.pos.x*ig.sizeHandler.sizeRatio.x)+"px",m=Math.floor(m+this.pos.y*ig.sizeHandler.sizeRatio.y)+"px",p=Math.floor(this.size.x*ig.sizeHandler.sizeRatio.x)+"px",b=Math.floor(this.size.y*
ig.sizeHandler.sizeRatio.y)+"px"):(g=Math.floor(p+this.pos.x*b)+"px",m=Math.floor(m+this.pos.y*b)+"px",p=Math.floor(this.size.x*b)+"px",b=Math.floor(this.size.y*b)+"px");ig.domHandler.css(e,{"float":"left",position:"absolute",left:g,top:m,width:p,height:b,"z-index":3});ig.domHandler.addEvent(e,"mousemove",ig.input.mousemove.bind(ig.input),!1);ig.domHandler.appendChild(d,j);ig.domHandler.appendChild(e,d);ig.domHandler.appendToBody(e);ig.Fullscreen.divs[c]={};ig.Fullscreen.divs[c].width=this.size.x;
ig.Fullscreen.divs[c].height=this.size.y;ig.Fullscreen.divs[c].entity_pos_x=this.pos.x;ig.Fullscreen.divs[c].entity_pos_y=this.pos.y}})});ig.baked=!0;
ig.module("game.main").requires("impact.game","impact.debug.debug","plugins.patches.user-agent-patch","plugins.patches.webkit-image-smoothing-patch","plugins.patches.windowfocus-onMouseDown-patch","plugins.patches.input-patch","plugins.font.font-loader","plugins.handlers.dom-handler","plugins.handlers.size-handler","plugins.handlers.api-handler","plugins.handlers.visibility-handler","plugins.audio.sound-handler","plugins.io.io-manager","plugins.io.storage-manager","plugins.splash-loader","plugins.tween",
"plugins.tweens-handler","plugins.url-parameters","plugins.director","plugins.impact-storage","plugins.responsive.responsive-plugin","plugins.branding.splash","plugins.datastructure.binary-heap","game.entities.branding-logo-placeholder","game.entities.buttons.button-more-games","game.entities.opening-shield","game.entities.opening-kitty","game.entities.pointer","game.entities.pointer-selector","game.entities.select","game.levels.opening","game.levels.main-menu","game.levels.webgl-game","game.levels.end",
"babylon.game.wgl-main","plugins.fullscreen").defines(function(){this.START_OBFUSCATION;this.FRAMEBREAKER;MyGame=ig.Game.extend({name:"MJS-WebGL-Game",version:"1.0.0",frameworkVersion:"1.4.2",io:null,paused:!1,lastDraw:[],scorelist:null,score:0,init:function(){this.tweens=new ig.TweensHandler;this.io=new IoManager;this.setupUrlParams=new ig.UrlParameters;this.removeLoadingWheel();this.setupStorageManager();this.finalize()},finalize:function(){this.start();ig.sizeHandler.reorient()},removeLoadingWheel:function(){try{$("#ajaxbar").css("background",
"none")}catch(c){console.log(c)}},showDebugMenu:function(){console.log("showing debug menu ...");ig.Entity._debugShowBoxes=!0;$(".ig_debug").show()},start:function(){this.resetPlayerStats();this.director=new ig.Director(this,[LevelOpening,LevelMainMenu,LevelWebglGame,LevelEnd]);if(_SETTINGS.Branding.Splash.Enabled)try{this.branding=new ig.BrandingSplash}catch(c){console.log(c),console.log("Loading original levels ..."),this.director.loadLevel(this.director.currentLevel)}else this.director.loadLevel(this.director.currentLevel);
this.spawnEntity(EntityPointerSelector,50,50)},fpsCount:function(){this.fpsTimer||(this.fpsTimer=new ig.Timer(1));this.fpsTimer&&0>this.fpsTimer.delta()?null!=this.fpsCounter?this.fpsCounter++:this.fpsCounter=0:(ig.game.fps=this.fpsCounter,this.fpsCounter=0,this.fpsTimer.reset())},endGame:function(){console.log("End game");ig.soundHandler.bgmPlayer.stop();ig.apiHandler.run("MJSEnd")},resetPlayerStats:function(){ig.log("resetting player stats ...");this.playerStats={id:this.playerStats?this.playerStats.id:
null}},splashClick:function(){var c=ig.domHandler.getElementById("#play");ig.domHandler.hide(c);ig.apiHandler.run("MJSFooter");ig.apiHandler.run("MJSHeader");ig.game.start()},pauseGame:function(){ig.system.stopRunLoop.call(ig.system);ig.game.tweens.onSystemPause();console.log("Game Paused")},resumeGame:function(){ig.system.startRunLoop.call(ig.system);ig.game.tweens.onSystemResume();console.log("Game Resumed")},showOverlay:function(c){for(i=0;i<c.length;i++)$("#"+c[i])&&$("#"+c[i]).show(),document.getElementById(c[i])&&
(document.getElementById(c[i]).style.visibility="visible")},hideOverlay:function(c){for(i=0;i<c.length;i++)$("#"+c[i])&&$("#"+c[i]).hide(),document.getElementById(c[i])&&(document.getElementById(c[i]).style.visibility="hidden")},currentBGMVolume:1,addition:0.1,update:function(){this.paused?(this.updateWhilePaused(),this.checkEntities()):(this.parent(),ig.ua.mobile&&ig.soundHandler&&ig.soundHandler.forceLoopBGM());this.io.clear()},updateWhilePaused:function(){for(var c=0;c<this.entities.length;c++)this.entities[c].ignorePause&&
this.entities[c].update()},draw:function(){this.parent();this.drawFPS();for(var c=0;c<this.lastDraw.length;c++)this.lastDraw[c]();this.dctf()},dctf:function(){this.COPYRIGHT},drawFPS:function(){var c=Math.round(1E3/ig.debug.debugTickAvg);ig.system.context.fillText("FPS:"+c,500,50);this.fillStrokeText("[ WEBGL "+wgl.system.engine.webGLVersion+" ][ FPS C "+c+" ][ FPS B "+wgl.system.engine.performanceMonitor.averageFPS.toFixed()+" ]",5,953)},fillStrokeText:function(c,b,e){var d=ig.system.context,j=d.measureText(c).width;
d.fillStyle="#333333";d.fillRect(b,e-14,j,16);d.fillStyle="#ffffff";d.fillText(c,b,e)},clearCanvas:function(c,b,e){var d=c.canvas;c.clearRect(0,0,b,e);d.style.display="none";d.offsetHeight;d.style.display="inherit"},drawDebug:function(){if(!ig.global.wm&&(this.debugEnable(),this.viewDebug&&(ig.system.context.fillStyle="#000000",ig.system.context.globalAlpha=0.35,ig.system.context.fillRect(0,0,ig.system.width/4,ig.system.height),ig.system.context.globalAlpha=1,this.debug&&0<this.debug.length)))for(i=
0;i<this.debug.length;i++)ig.system.context.font="10px Arial",ig.system.context.fillStyle="#ffffff",ig.system.context.fillText(this.debugLine-this.debug.length+i+": "+this.debug[i],10,50+10*i)},debugCL:function(c){this.debug?(50>this.debug.length||this.debug.splice(0,1),this.debug.push(c),this.debugLine++):(this.debug=[],this.debugLine=1,this.debug.push(c));console.log(c)},debugEnable:function(){ig.input.pressed("click")&&(this.debugEnableTimer=new ig.Timer(2));this.debugEnableTimer&&0>this.debugEnableTimer.delta()?
ig.input.released("click")&&(this.debugEnableTimer=null):this.debugEnableTimer&&0<this.debugEnableTimer.delta()&&(this.debugEnableTimer=null,this.viewDebug=this.viewDebug?!1:!0)}});ig.babylonJSSupport=!0;ig.domHandler=null;ig.domHandler=new ig.DomHandler;ig.domHandler.forcedDeviceDetection();ig.domHandler.forcedDeviceRotation();ig.apiHandler=new ig.ApiHandler;ig.sizeHandler=new ig.SizeHandler(ig.domHandler);ig.visibilityHandler=new ig.VisibilityHandler;ig.soundHandler=null;ig.soundHandler=new ig.SoundHandler;
ig.fontInfo=null;ig.fontInfo=new ig.FontInfo;ig.main("#canvas",MyGame,60,ig.sizeHandler.desktop.actualResolution.x,ig.sizeHandler.desktop.actualResolution.y,ig.sizeHandler.scale,ig.SplashLoader);wgl.webglmain("#webglcanvas",60);ig.sizeHandler.reorient();this.DOMAINLOCK_BREAKOUT_ATTEMPT;this.END_OBFUSCATION});
